<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="zh">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>source: Module Algorithm</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">source
   </div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="搜索" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- 制作者 Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('_module_algorithm.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">载入中...</div>
<div class="SRStatus" id="Searching">搜索中...</div>
<div class="SRStatus" id="NoMatches">未找到</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Module Algorithm</div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>目录</h3>
<ul>
  <li class="level1">
    <a href="#ModuleAlgorithmInclude">Include the Header</a>
  </li>
  <li class="level1">
    <a href="#WhatIsAModuleTask">What is a Module Task</a>
  </li>
  <li class="level1">
    <a href="#CreateAModuleTaskOverACustomGraph">Create a Module Task over a Custom Graph</a>
  </li>
</ul>
</div>
<div class="textblock"><p>Taskflow provides template methods that let users create reusable building blocks called <em>modules</em>. Users can connect modules together to build more complex parallel algorithms.</p>
<h1><a class="anchor" id="ModuleAlgorithmInclude"></a>
Include the Header</h1>
<p>You need to include the header file, <code><a class="el" href="module_8hpp.html">taskflow/algorithm/module.hpp</a></code>, for creating a module task over a schedulable graph target.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="module_8hpp.html">taskflow/algorithm/module.hpp</a>&gt;</span></div>
<div class="ttc" id="amodule_8hpp_html"><div class="ttname"><a href="module_8hpp.html">module.hpp</a></div></div>
</div><!-- fragment --><h1><a class="anchor" id="WhatIsAModuleTask"></a>
What is a Module Task</h1>
<p>Similar to <a class="el" href="_composable_tasking.html">Composable Tasking</a>, but in a more generic setting, the template function, <a class="el" href="namespacetf.html#a767288f0f103fec9a849237865198627" title="creates a module task using the given target">tf::make_module_task</a>, allows you to create a task over a taskflow graph that can be executed by an executor. This provides a flexible way to encapsulate and reuse complex task logic within your Taskflow applications. The example below demonstrates how to create and launch multiple taskflows in parallel using asynchronous tasking:</p>
<div class="fragment"><div class="line"><a class="code hl_class" href="classtf_1_1_executor.html">tf::Executor</a> <a class="code hl_variable" href="thread__pool_8cpp.html#a543e564a8407bbeac15cb2d929fec755">executor</a>;</div>
<div class="line"> </div>
<div class="line"><a class="code hl_class" href="classtf_1_1_taskflow.html">tf::Taskflow</a> <a class="code hl_typedef" href="bench__gemm_8cpp.html#addc86e8508f14411ec98f521c520f875">A</a>;</div>
<div class="line"><a class="code hl_class" href="classtf_1_1_taskflow.html">tf::Taskflow</a> <a class="code hl_typedef" href="bench__gemm_8cpp.html#a37a83060ac796961b44991c836f083f7">B</a>;</div>
<div class="line"><a class="code hl_class" href="classtf_1_1_taskflow.html">tf::Taskflow</a> <a class="code hl_define" href="test__buffer__node_8cpp.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>;</div>
<div class="line"><a class="code hl_class" href="classtf_1_1_taskflow.html">tf::Taskflow</a> <a class="code hl_variable" href="_eigen_solver___eigen_solver___matrix_type_8cpp.html#a925331f9b6e4844293d36a8df2256d38">D</a>;</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="bench__gemm_8cpp.html#addc86e8508f14411ec98f521c520f875">A</a>.emplace([](){ <a class="code hl_function" href="printf_8h.html#aee3ed3a831f25f07e7be3919fff2203a">printf</a>(<span class="stringliteral">&quot;Taskflow A\n&quot;</span>); }); </div>
<div class="line"><a class="code hl_typedef" href="bench__gemm_8cpp.html#a37a83060ac796961b44991c836f083f7">B</a>.emplace([](){ <a class="code hl_function" href="printf_8h.html#aee3ed3a831f25f07e7be3919fff2203a">printf</a>(<span class="stringliteral">&quot;Taskflow B\n&quot;</span>); }); </div>
<div class="line"><a class="code hl_define" href="test__buffer__node_8cpp.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>.emplace([](){ <a class="code hl_function" href="printf_8h.html#aee3ed3a831f25f07e7be3919fff2203a">printf</a>(<span class="stringliteral">&quot;Taskflow C\n&quot;</span>); }); </div>
<div class="line"><a class="code hl_variable" href="_eigen_solver___eigen_solver___matrix_type_8cpp.html#a925331f9b6e4844293d36a8df2256d38">D</a>.emplace([](){ <a class="code hl_function" href="printf_8h.html#aee3ed3a831f25f07e7be3919fff2203a">printf</a>(<span class="stringliteral">&quot;Taskflow D\n&quot;</span>); }); </div>
<div class="line"> </div>
<div class="line"><span class="comment">// launch the four taskflows using asynchronous tasking</span></div>
<div class="line"><a class="code hl_variable" href="thread__pool_8cpp.html#a543e564a8407bbeac15cb2d929fec755">executor</a>.<a class="code hl_function" href="classtf_1_1_executor.html#af960048056f7c6b5bc71f4f526f05df7">async</a>(<a class="code hl_function" href="namespacetf.html#a767288f0f103fec9a849237865198627">tf::make_module_task</a>(<a class="code hl_typedef" href="bench__gemm_8cpp.html#addc86e8508f14411ec98f521c520f875">A</a>));</div>
<div class="line"><a class="code hl_variable" href="thread__pool_8cpp.html#a543e564a8407bbeac15cb2d929fec755">executor</a>.<a class="code hl_function" href="classtf_1_1_executor.html#af960048056f7c6b5bc71f4f526f05df7">async</a>(<a class="code hl_function" href="namespacetf.html#a767288f0f103fec9a849237865198627">tf::make_module_task</a>(<a class="code hl_typedef" href="bench__gemm_8cpp.html#a37a83060ac796961b44991c836f083f7">B</a>));</div>
<div class="line"><a class="code hl_variable" href="thread__pool_8cpp.html#a543e564a8407bbeac15cb2d929fec755">executor</a>.<a class="code hl_function" href="classtf_1_1_executor.html#af960048056f7c6b5bc71f4f526f05df7">async</a>(<a class="code hl_function" href="namespacetf.html#a767288f0f103fec9a849237865198627">tf::make_module_task</a>(<a class="code hl_define" href="test__buffer__node_8cpp.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>));</div>
<div class="line"><a class="code hl_variable" href="thread__pool_8cpp.html#a543e564a8407bbeac15cb2d929fec755">executor</a>.<a class="code hl_function" href="classtf_1_1_executor.html#af960048056f7c6b5bc71f4f526f05df7">async</a>(<a class="code hl_function" href="namespacetf.html#a767288f0f103fec9a849237865198627">tf::make_module_task</a>(<a class="code hl_variable" href="_eigen_solver___eigen_solver___matrix_type_8cpp.html#a925331f9b6e4844293d36a8df2256d38">D</a>));</div>
<div class="line"><a class="code hl_variable" href="thread__pool_8cpp.html#a543e564a8407bbeac15cb2d929fec755">executor</a>.<a class="code hl_function" href="classtf_1_1_executor.html#ab9aa252f70e9a40020a1e5a89d485b85">wait_for_all</a>();  </div>
<div class="ttc" id="a_eigen_solver___eigen_solver___matrix_type_8cpp_html_a925331f9b6e4844293d36a8df2256d38"><div class="ttname"><a href="_eigen_solver___eigen_solver___matrix_type_8cpp.html#a925331f9b6e4844293d36a8df2256d38">D</a></div><div class="ttdeci">MatrixXcd D</div><div class="ttdef"><b>定义</b> EigenSolver_EigenSolver_MatrixType.cpp:14</div></div>
<div class="ttc" id="abench__gemm_8cpp_html_a37a83060ac796961b44991c836f083f7"><div class="ttname"><a href="bench__gemm_8cpp.html#a37a83060ac796961b44991c836f083f7">B</a></div><div class="ttdeci">Matrix&lt; SCALARB, Dynamic, Dynamic &gt; B</div><div class="ttdef"><b>定义</b> bench_gemm.cpp:36</div></div>
<div class="ttc" id="abench__gemm_8cpp_html_addc86e8508f14411ec98f521c520f875"><div class="ttname"><a href="bench__gemm_8cpp.html#addc86e8508f14411ec98f521c520f875">A</a></div><div class="ttdeci">Matrix&lt; SCALARA, Dynamic, Dynamic &gt; A</div><div class="ttdef"><b>定义</b> bench_gemm.cpp:35</div></div>
<div class="ttc" id="aclasstf_1_1_executor_html"><div class="ttname"><a href="classtf_1_1_executor.html">tf::Executor</a></div><div class="ttdoc">class to create an executor for running a taskflow graph</div><div class="ttdef"><b>定义</b> executor-dl.hpp:51</div></div>
<div class="ttc" id="aclasstf_1_1_executor_html_ab9aa252f70e9a40020a1e5a89d485b85"><div class="ttname"><a href="classtf_1_1_executor.html#ab9aa252f70e9a40020a1e5a89d485b85">tf::Executor::wait_for_all</a></div><div class="ttdeci">void wait_for_all()</div><div class="ttdoc">waits for all tasks to complete</div><div class="ttdef"><b>定义</b> executor-dl.hpp:2237</div></div>
<div class="ttc" id="aclasstf_1_1_executor_html_af960048056f7c6b5bc71f4f526f05df7"><div class="ttname"><a href="classtf_1_1_executor.html#af960048056f7c6b5bc71f4f526f05df7">tf::Executor::async</a></div><div class="ttdeci">auto async(P &amp;&amp;params, F &amp;&amp;func)</div><div class="ttdoc">creates a parameterized asynchronous task to run the given function</div><div class="ttdef"><b>定义</b> async.hpp:15</div></div>
<div class="ttc" id="aclasstf_1_1_taskflow_html"><div class="ttname"><a href="classtf_1_1_taskflow.html">tf::Taskflow</a></div><div class="ttdoc">class to create a taskflow object</div><div class="ttdef"><b>定义</b> taskflow.hpp:67</div></div>
<div class="ttc" id="anamespacetf_html_a767288f0f103fec9a849237865198627"><div class="ttname"><a href="namespacetf.html#a767288f0f103fec9a849237865198627">tf::make_module_task</a></div><div class="ttdeci">auto make_module_task(T &amp;&amp;target)</div><div class="ttdoc">creates a module task using the given target</div><div class="ttdef"><b>定义</b> module.hpp:77</div></div>
<div class="ttc" id="aprintf_8h_html_aee3ed3a831f25f07e7be3919fff2203a"><div class="ttname"><a href="printf_8h.html#aee3ed3a831f25f07e7be3919fff2203a">printf</a></div><div class="ttdeci">auto printf(string_view fmt, const T &amp;... args) -&gt; int</div><div class="ttdef"><b>定义</b> printf.h:621</div></div>
<div class="ttc" id="atest__buffer__node_8cpp_html_ac4cf4b2ab929bd23951a8676eeac086b"><div class="ttname"><a href="test__buffer__node_8cpp.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a></div><div class="ttdeci">#define C</div><div class="ttdef"><b>定义</b> test_buffer_node.cpp:28</div></div>
<div class="ttc" id="athread__pool_8cpp_html_a543e564a8407bbeac15cb2d929fec755"><div class="ttname"><a href="thread__pool_8cpp.html#a543e564a8407bbeac15cb2d929fec755">executor</a></div><div class="ttdeci">tf::Executor executor</div><div class="ttdef"><b>定义</b> thread_pool.cpp:6</div></div>
</div><!-- fragment --><p>Since the four taskflows are launched asynchronously without any dependencies between them, we can observe any order of the output message:</p>
<div class="fragment"><div class="line">{.shell-session} </div>
<div class="line"><span class="preprocessor"># one possible output</span></div>
<div class="line">Taskflow <a class="code hl_typedef" href="bench__gemm_8cpp.html#a37a83060ac796961b44991c836f083f7">B</a></div>
<div class="line">Taskflow <a class="code hl_define" href="test__buffer__node_8cpp.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a></div>
<div class="line">Taskflow <a class="code hl_typedef" href="bench__gemm_8cpp.html#addc86e8508f14411ec98f521c520f875">A</a></div>
<div class="line">Taskflow <a class="code hl_variable" href="_eigen_solver___eigen_solver___matrix_type_8cpp.html#a925331f9b6e4844293d36a8df2256d38">D</a></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor"># another possible output</span></div>
<div class="line">Taskflow <a class="code hl_variable" href="_eigen_solver___eigen_solver___matrix_type_8cpp.html#a925331f9b6e4844293d36a8df2256d38">D</a></div>
<div class="line">Taskflow <a class="code hl_typedef" href="bench__gemm_8cpp.html#addc86e8508f14411ec98f521c520f875">A</a></div>
<div class="line">Taskflow <a class="code hl_typedef" href="bench__gemm_8cpp.html#a37a83060ac796961b44991c836f083f7">B</a></div>
<div class="line">Taskflow <a class="code hl_define" href="test__buffer__node_8cpp.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a></div>
</div><!-- fragment --><p>If you need to enforce dependencies among these four taskflows, you can use dependent-async tasks. The example below launches the four taskflows one by one in sequential:</p>
<div class="fragment"><div class="line"><a class="code hl_class" href="classtf_1_1_executor.html">tf::Executor</a> <a class="code hl_variable" href="thread__pool_8cpp.html#a543e564a8407bbeac15cb2d929fec755">executor</a>;</div>
<div class="line"> </div>
<div class="line"><a class="code hl_class" href="classtf_1_1_taskflow.html">tf::Taskflow</a> <a class="code hl_typedef" href="bench__gemm_8cpp.html#addc86e8508f14411ec98f521c520f875">A</a>;</div>
<div class="line"><a class="code hl_class" href="classtf_1_1_taskflow.html">tf::Taskflow</a> <a class="code hl_typedef" href="bench__gemm_8cpp.html#a37a83060ac796961b44991c836f083f7">B</a>;</div>
<div class="line"><a class="code hl_class" href="classtf_1_1_taskflow.html">tf::Taskflow</a> <a class="code hl_define" href="test__buffer__node_8cpp.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>;</div>
<div class="line"><a class="code hl_class" href="classtf_1_1_taskflow.html">tf::Taskflow</a> <a class="code hl_variable" href="_eigen_solver___eigen_solver___matrix_type_8cpp.html#a925331f9b6e4844293d36a8df2256d38">D</a>;</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="bench__gemm_8cpp.html#addc86e8508f14411ec98f521c520f875">A</a>.emplace([](){ <a class="code hl_function" href="printf_8h.html#aee3ed3a831f25f07e7be3919fff2203a">printf</a>(<span class="stringliteral">&quot;Taskflow A\n&quot;</span>); }); </div>
<div class="line"><a class="code hl_typedef" href="bench__gemm_8cpp.html#a37a83060ac796961b44991c836f083f7">B</a>.emplace([](){ <a class="code hl_function" href="printf_8h.html#aee3ed3a831f25f07e7be3919fff2203a">printf</a>(<span class="stringliteral">&quot;Taskflow B\n&quot;</span>); }); </div>
<div class="line"><a class="code hl_define" href="test__buffer__node_8cpp.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>.emplace([](){ <a class="code hl_function" href="printf_8h.html#aee3ed3a831f25f07e7be3919fff2203a">printf</a>(<span class="stringliteral">&quot;Taskflow C\n&quot;</span>); }); </div>
<div class="line"><a class="code hl_variable" href="_eigen_solver___eigen_solver___matrix_type_8cpp.html#a925331f9b6e4844293d36a8df2256d38">D</a>.emplace([](){ <a class="code hl_function" href="printf_8h.html#aee3ed3a831f25f07e7be3919fff2203a">printf</a>(<span class="stringliteral">&quot;Taskflow D\n&quot;</span>); }); </div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> TA = <a class="code hl_variable" href="thread__pool_8cpp.html#a543e564a8407bbeac15cb2d929fec755">executor</a>.<a class="code hl_function" href="classtf_1_1_executor.html#a0e2d792f28136b8227b413d0c27d5c7f">silent_dependent_async</a>(<a class="code hl_function" href="namespacetf.html#a767288f0f103fec9a849237865198627">tf::make_module_task</a>(<a class="code hl_typedef" href="bench__gemm_8cpp.html#addc86e8508f14411ec98f521c520f875">A</a>));</div>
<div class="line"><span class="keyword">auto</span> TB = <a class="code hl_variable" href="thread__pool_8cpp.html#a543e564a8407bbeac15cb2d929fec755">executor</a>.<a class="code hl_function" href="classtf_1_1_executor.html#a0e2d792f28136b8227b413d0c27d5c7f">silent_dependent_async</a>(<a class="code hl_function" href="namespacetf.html#a767288f0f103fec9a849237865198627">tf::make_module_task</a>(<a class="code hl_typedef" href="bench__gemm_8cpp.html#a37a83060ac796961b44991c836f083f7">B</a>), TA);</div>
<div class="line"><span class="keyword">auto</span> TC = <a class="code hl_variable" href="thread__pool_8cpp.html#a543e564a8407bbeac15cb2d929fec755">executor</a>.<a class="code hl_function" href="classtf_1_1_executor.html#a0e2d792f28136b8227b413d0c27d5c7f">silent_dependent_async</a>(<a class="code hl_function" href="namespacetf.html#a767288f0f103fec9a849237865198627">tf::make_module_task</a>(<a class="code hl_define" href="test__buffer__node_8cpp.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>), TB);</div>
<div class="line"><span class="keyword">auto</span> [TD, FD] = <a class="code hl_variable" href="thread__pool_8cpp.html#a543e564a8407bbeac15cb2d929fec755">executor</a>.<a class="code hl_function" href="classtf_1_1_executor.html#aee02b63d3a91ad5ca5a1c0e71f3e128f">dependent_async</a>(<a class="code hl_function" href="namespacetf.html#a767288f0f103fec9a849237865198627">tf::make_module_task</a>(<a class="code hl_variable" href="_eigen_solver___eigen_solver___matrix_type_8cpp.html#a925331f9b6e4844293d36a8df2256d38">D</a>), TC);</div>
<div class="line">FD.get();</div>
<div class="ttc" id="aclasstf_1_1_executor_html_a0e2d792f28136b8227b413d0c27d5c7f"><div class="ttname"><a href="classtf_1_1_executor.html#a0e2d792f28136b8227b413d0c27d5c7f">tf::Executor::silent_dependent_async</a></div><div class="ttdeci">tf::AsyncTask silent_dependent_async(F &amp;&amp;func, Tasks &amp;&amp;... tasks)</div><div class="ttdoc">runs the given function asynchronously when the given dependents finish</div><div class="ttdef"><b>定义</b> async.hpp:85</div></div>
<div class="ttc" id="aclasstf_1_1_executor_html_aee02b63d3a91ad5ca5a1c0e71f3e128f"><div class="ttname"><a href="classtf_1_1_executor.html#aee02b63d3a91ad5ca5a1c0e71f3e128f">tf::Executor::dependent_async</a></div><div class="ttdeci">auto dependent_async(F &amp;&amp;func, Tasks &amp;&amp;... tasks)</div><div class="ttdoc">runs the given function asynchronously when the given dependents finish</div><div class="ttdef"><b>定义</b> async.hpp:148</div></div>
</div><!-- fragment --><div class="fragment"><div class="line">{.shell-session} </div>
<div class="line"><span class="preprocessor"># dependent-async tasks enforce a sequential execution of the four taskflows</span></div>
<div class="line">Taskflow <a class="code hl_typedef" href="bench__gemm_8cpp.html#addc86e8508f14411ec98f521c520f875">A</a></div>
<div class="line">Taskflow <a class="code hl_typedef" href="bench__gemm_8cpp.html#a37a83060ac796961b44991c836f083f7">B</a></div>
<div class="line">Taskflow <a class="code hl_define" href="test__buffer__node_8cpp.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a></div>
<div class="line">Taskflow <a class="code hl_variable" href="_eigen_solver___eigen_solver___matrix_type_8cpp.html#a925331f9b6e4844293d36a8df2256d38">D</a></div>
</div><!-- fragment --><p>The module task maker, <a class="el" href="namespacetf.html#a767288f0f103fec9a849237865198627" title="creates a module task using the given target">tf::make_module_task</a>, functions basically similar to <a class="el" href="classtf_1_1_flow_builder.html#ac6f22228d4c2ea2e643c4b0d42c0e92a" title="creates a module task for the target object">tf::Taskflow::composed_of</a> but provides a more generic interface that can be used beyond Taskflow. Specifically, the following two approaches achieve the same functionality.</p>
<div class="fragment"><div class="line"><span class="comment">// approach 1: composition using composed_of</span></div>
<div class="line"><a class="code hl_class" href="classtf_1_1_task.html">tf::Task</a> <a class="code hl_variable" href="_i_o_format_8cpp.html#ade6f22163da3c189aade978b48a8bb74">m1</a> = taskflow1.composed_of(taskflow2);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// approach 2: composition using make_module_task</span></div>
<div class="line"><a class="code hl_class" href="classtf_1_1_task.html">tf::Task</a> <a class="code hl_variable" href="_i_o_format_8cpp.html#ade6f22163da3c189aade978b48a8bb74">m1</a> = taskflow1.emplace(<a class="code hl_function" href="namespacetf.html#a767288f0f103fec9a849237865198627">tf::make_module_task</a>(taskflow2));</div>
<div class="ttc" id="a_i_o_format_8cpp_html_ade6f22163da3c189aade978b48a8bb74"><div class="ttname"><a href="_i_o_format_8cpp.html#ade6f22163da3c189aade978b48a8bb74">m1</a></div><div class="ttdeci">Matrix3d m1</div><div class="ttdef"><b>定义</b> IOFormat.cpp:2</div></div>
<div class="ttc" id="aclasstf_1_1_task_html"><div class="ttname"><a href="classtf_1_1_task.html">tf::Task</a></div><div class="ttdoc">class to create a task handle over a node in a taskflow graph</div><div class="ttdef"><b>定义</b> task.hpp:150</div></div>
</div><!-- fragment --><dl class="section attention"><dt>注意</dt><dd>Similar to <a class="el" href="classtf_1_1_flow_builder.html#ac6f22228d4c2ea2e643c4b0d42c0e92a" title="creates a module task for the target object">tf::Taskflow::composed_of</a>, <a class="el" href="namespacetf.html#a767288f0f103fec9a849237865198627" title="creates a module task using the given target">tf::make_module_task</a> does not assume ownership of the provided taskflow but a soft reference. You are responsible for ensuring that the encapsulated taskflow remains valid throughout its execution.</dd></dl>
<h1><a class="anchor" id="CreateAModuleTaskOverACustomGraph"></a>
Create a Module Task over a Custom Graph</h1>
<p>In addition to encapsulate taskflow graphs, you can create a module task to schedule a custom graph target. <a class="el" href="bench__gemm_8cpp.html#addc86e8508f14411ec98f521c520f875">A</a> schedulable target (of type <code>T</code>) must define the method <code>T::graph()</code> that returns a reference to the <a class="el" href="classtf_1_1_graph.html" title="class to create a graph object">tf::Graph</a> object managed by <code>T</code>. The following example defines a custom graph that can be scheduled through making module tasks:</p>
<div class="fragment"><div class="line"><span class="keyword">struct </span>CustomGraph {</div>
<div class="line">  <a class="code hl_class" href="classtf_1_1_graph.html">tf::Graph</a> graph;</div>
<div class="line">  CustomGraph() {</div>
<div class="line">    <span class="comment">// use flow builder to inherit all task creation methods in tf::Taskflow</span></div>
<div class="line">    <a class="code hl_class" href="classtf_1_1_flow_builder.html">tf::FlowBuilder</a> builder(graph);</div>
<div class="line">    <a class="code hl_class" href="classtf_1_1_task.html">tf::Task</a> <a class="code hl_define" href="test__partitioner__whitebox_8h.html#a5c4cf3d37a4eee22275de22cb9619863">task</a> = builder.emplace([](){</div>
<div class="line">      std::cout &lt;&lt; <span class="stringliteral">&quot;a task\n&quot;</span>;  <span class="comment">// static task</span></div>
<div class="line">    });</div>
<div class="line">  }</div>
<div class="line">  <span class="comment">// returns a reference to the graph for taskflow composition</span></div>
<div class="line">  <a class="code hl_class" href="class_graph.html">Graph</a>&amp; graph() { <span class="keywordflow">return</span> graph; }</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">CustomGraph target;</div>
<div class="line"><a class="code hl_variable" href="thread__pool_8cpp.html#a543e564a8407bbeac15cb2d929fec755">executor</a>.<a class="code hl_function" href="classtf_1_1_executor.html#af960048056f7c6b5bc71f4f526f05df7">async</a>(<a class="code hl_function" href="namespacetf.html#a767288f0f103fec9a849237865198627">tf::make_module_task</a>(target));</div>
<div class="ttc" id="aclass_graph_html"><div class="ttname"><a href="class_graph.html">Graph</a></div><div class="ttdoc">A directed graph where the vertices are Cells.</div><div class="ttdef"><b>定义</b> Graph.h:67</div></div>
<div class="ttc" id="aclasstf_1_1_flow_builder_html"><div class="ttname"><a href="classtf_1_1_flow_builder.html">tf::FlowBuilder</a></div><div class="ttdoc">class to build a task dependency graph</div><div class="ttdef"><b>定义</b> flow_builder.hpp:22</div></div>
<div class="ttc" id="aclasstf_1_1_graph_html"><div class="ttname"><a href="classtf_1_1_graph.html">tf::Graph</a></div><div class="ttdoc">class to create a graph object</div><div class="ttdef"><b>定义</b> graph.hpp:50</div></div>
<div class="ttc" id="atest__partitioner__whitebox_8h_html_a5c4cf3d37a4eee22275de22cb9619863"><div class="ttname"><a href="test__partitioner__whitebox_8h.html#a5c4cf3d37a4eee22275de22cb9619863">task</a></div><div class="ttdeci">#define task</div><div class="ttdef"><b>定义</b> test_partitioner_whitebox.h:76</div></div>
</div><!-- fragment --><dl class="section attention"><dt>注意</dt><dd>Users are responsible for ensuring the given custom graph remains valid throughout its execution. The executor does not assume ownership of the custom graph. </dd></dl>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">制作者 <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
