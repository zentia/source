\doxysection{lock\+\_\+array.\+h}
\hypertarget{lock__array_8h_source}{}\label{lock__array_8h_source}\index{external/libcds/cds/sync/lock\_array.h@{external/libcds/cds/sync/lock\_array.h}}
\mbox{\hyperlink{lock__array_8h}{浏览该文件的文档.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ Copyright\ (c)\ 2006-\/2018\ Maxim\ Khizhinsky}}
\DoxyCodeLine{00002\ \textcolor{comment}{//}}
\DoxyCodeLine{00003\ \textcolor{comment}{//\ Distributed\ under\ the\ Boost\ Software\ License,\ Version\ 1.0.\ (See\ accompanying}}
\DoxyCodeLine{00004\ \textcolor{comment}{//\ file\ LICENSE\ or\ copy\ at\ http://www.boost.org/LICENSE\_1\_0.txt)}}
\DoxyCodeLine{00005\ }
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#ifndef\ CDSLIB\_SYNC\_LOCK\_ARRAY\_H}}
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#define\ CDSLIB\_SYNC\_LOCK\_ARRAY\_H}}
\DoxyCodeLine{00008\ }
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#include\ <mutex>}\ \ \ \ \textcolor{comment}{//unique\_lock}}
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{external_2libcds_2cds_2details_2allocator_8h}{cds/details/allocator.h}}>}}
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{int__algo_8h}{cds/algo/int\_algo.h}}>}}
\DoxyCodeLine{00012\ }
\DoxyCodeLine{00013\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespacecds}{cds}}\ \{\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespacecds_1_1sync}{sync}}\ \{}
\DoxyCodeLine{00014\ }
\DoxyCodeLine{00016\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structcds_1_1sync_1_1trivial__select__policy}{trivial\_select\_policy}}}
\DoxyCodeLine{00017\ \ \ \ \ \{}
\DoxyCodeLine{00019\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{structcds_1_1sync_1_1trivial__select__policy_ad0a9e0714d6afc786db8ee74db3dc0dd}{operator()}}(\ \textcolor{keywordtype}{size\_t}\ nWhat,\ \textcolor{keywordtype}{size\_t}\ nCapacity\ )\textcolor{keyword}{\ const}}
\DoxyCodeLine{00020\ \textcolor{keyword}{\ \ \ \ \ \ \ \ }\{}
\DoxyCodeLine{00021\ \ \ \ \ \ \ \ \ \ \ \ \ assert(\ nWhat\ <\ nCapacity\ );}
\DoxyCodeLine{00022\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{details_2defs_8h_a782b7f1736e3581e010449d710517c25}{CDS\_UNUSED}}(\ nCapacity\ );}
\DoxyCodeLine{00023\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ nWhat;}
\DoxyCodeLine{00024\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00025\ }
\DoxyCodeLine{00027\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{structcds_1_1sync_1_1trivial__select__policy_a7ee6de5473ff853839b0a512b94804f7}{is\_capacity\_accepted}}(\ \textcolor{keywordtype}{size\_t}\ nCapacity\ )}
\DoxyCodeLine{00028\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00029\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{details_2defs_8h_a782b7f1736e3581e010449d710517c25}{CDS\_UNUSED}}(\ nCapacity\ );}
\DoxyCodeLine{00030\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00031\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00032\ \ \ \ \ \};}
\DoxyCodeLine{00033\ }
\DoxyCodeLine{00035\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structcds_1_1sync_1_1mod__select__policy}{mod\_select\_policy}}}
\DoxyCodeLine{00036\ \ \ \ \ \{}
\DoxyCodeLine{00038\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{structcds_1_1sync_1_1mod__select__policy_ab03bd4aafcb29386aa31a256b6979f1b}{operator()}}(\ \textcolor{keywordtype}{size\_t}\ nWhat,\ \textcolor{keywordtype}{size\_t}\ nCapacity\ )\textcolor{keyword}{\ const}}
\DoxyCodeLine{00039\ \textcolor{keyword}{\ \ \ \ \ \ \ \ }\{}
\DoxyCodeLine{00040\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ nWhat\ \%\ nCapacity;}
\DoxyCodeLine{00041\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00042\ }
\DoxyCodeLine{00044\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{structcds_1_1sync_1_1mod__select__policy_a216edf77faba1e2d07433a9efe7b0c85}{is\_capacity\_accepted}}(\ \textcolor{keywordtype}{size\_t}\ nCapacity\ )}
\DoxyCodeLine{00045\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00046\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ nCapacity\ >\ 0;}
\DoxyCodeLine{00047\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00048\ \ \ \ \ \};}
\DoxyCodeLine{00049\ }
\DoxyCodeLine{00051\ }
\DoxyCodeLine{00054\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structcds_1_1sync_1_1pow2__select__policy_a4db019858699e016de2afb11bdba06d9}{pow2\_select\_policy}}}
\DoxyCodeLine{00055\ \ \ \ \ \{}
\DoxyCodeLine{00056\ \ \ \ \ \ \ \ \ \textcolor{comment}{//@cond}}
\DoxyCodeLine{00057\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ \ \ \ m\_nMask;}
\DoxyCodeLine{00058\ \ \ \ \ \ \ \ \ \textcolor{comment}{//@endcond}}
\DoxyCodeLine{00059\ }
\DoxyCodeLine{00061\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structcds_1_1sync_1_1pow2__select__policy_a4db019858699e016de2afb11bdba06d9}{pow2\_select\_policy}}(\ \textcolor{keywordtype}{size\_t}\ nCapacity\ )}
\DoxyCodeLine{00062\ \ \ \ \ \ \ \ \ \ \ \ \ :\ m\_nMask(\ nCapacity\ -\/\ 1\ )}
\DoxyCodeLine{00063\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00064\ \ \ \ \ \ \ \ \ \ \ \ \ assert(\ \mbox{\hyperlink{structcds_1_1sync_1_1pow2__select__policy_a63c2bdc21b158d2dff27acb49b8bc358}{is\_capacity\_accepted}}(\ nCapacity\ ));}
\DoxyCodeLine{00065\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00066\ }
\DoxyCodeLine{00068\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structcds_1_1sync_1_1pow2__select__policy_a8284151a487cafc73d8b39b360a912d8}{pow2\_select\_policy}}(\ \mbox{\hyperlink{structcds_1_1sync_1_1pow2__select__policy_a4db019858699e016de2afb11bdba06d9}{pow2\_select\_policy}}\ \textcolor{keyword}{const}\&\ \mbox{\hyperlink{shortpath_8cpp_a8648ffe7342bea77e2698690589da3c1}{src}}\ )}
\DoxyCodeLine{00069\ \ \ \ \ \ \ \ \ \ \ \ \ :\ m\_nMask(\ \mbox{\hyperlink{shortpath_8cpp_a8648ffe7342bea77e2698690589da3c1}{src}}.m\_nMask\ )}
\DoxyCodeLine{00070\ \ \ \ \ \ \ \ \ \{\}}
\DoxyCodeLine{00071\ }
\DoxyCodeLine{00073\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structcds_1_1sync_1_1pow2__select__policy_a6a058c0e217958820e626459795c4be4}{pow2\_select\_policy}}(\ \mbox{\hyperlink{structcds_1_1sync_1_1pow2__select__policy_a4db019858699e016de2afb11bdba06d9}{pow2\_select\_policy}}\&\&\ \mbox{\hyperlink{shortpath_8cpp_a8648ffe7342bea77e2698690589da3c1}{src}}\ )}
\DoxyCodeLine{00074\ \ \ \ \ \ \ \ \ \ \ \ \ :\ m\_nMask(\ \mbox{\hyperlink{shortpath_8cpp_a8648ffe7342bea77e2698690589da3c1}{src}}.m\_nMask\ )}
\DoxyCodeLine{00075\ \ \ \ \ \ \ \ \ \{\}}
\DoxyCodeLine{00076\ }
\DoxyCodeLine{00078\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{structcds_1_1sync_1_1pow2__select__policy_a1db30c406168d4e5518c8b1339388782}{operator()}}(\ \textcolor{keywordtype}{size\_t}\ nWhat,\ \textcolor{keywordtype}{size\_t}\ )\textcolor{keyword}{\ const}}
\DoxyCodeLine{00079\ \textcolor{keyword}{\ \ \ \ \ \ \ \ }\{}
\DoxyCodeLine{00080\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ nWhat\ \&\ m\_nMask;}
\DoxyCodeLine{00081\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00082\ }
\DoxyCodeLine{00084\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{structcds_1_1sync_1_1pow2__select__policy_a63c2bdc21b158d2dff27acb49b8bc358}{is\_capacity\_accepted}}(\ \textcolor{keywordtype}{size\_t}\ nCapacity\ )}
\DoxyCodeLine{00085\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00086\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacecds_1_1beans_abd6ea1248f6516068a4d2963761e8c57}{cds::beans::is\_power2}}(\ nCapacity\ );}
\DoxyCodeLine{00087\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00088\ \ \ \ \ \};}
\DoxyCodeLine{00089\ }
\DoxyCodeLine{00091\ }
\DoxyCodeLine{00112\ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Lock}
\DoxyCodeLine{00113\ \ \ \ \ \ \ \ \ ,\ \textcolor{keyword}{typename}\ SelectPolicy\ =\ mod\_select\_policy}
\DoxyCodeLine{00114\ \ \ \ \ \ \ \ \ ,\ \textcolor{keyword}{class\ }Alloc\ =\ \mbox{\hyperlink{external_2libcds_2cds_2user__setup_2allocator_8h_ad5fb7e3cbe8cf24295f0ea3c165a2d82}{CDS\_DEFAULT\_ALLOCATOR}}}
\DoxyCodeLine{00115\ \ \ \ \ >}
\DoxyCodeLine{00116\ \ \ \ \ \textcolor{keyword}{class\ }\mbox{\hyperlink{classcds_1_1sync_1_1lock__array_a5f5e0c216fcaf96a54b338a23d61b74e}{lock\_array}}}
\DoxyCodeLine{00117\ \ \ \ \ \{}
\DoxyCodeLine{00118\ \ \ \ \ \ \ \ \ \textcolor{comment}{//@cond}}
\DoxyCodeLine{00119\ \ \ \ \ \ \ \ \ typedef\ ::cds::details::Allocator<\ Lock,\ Alloc\ >\ cxx\_allocator;}
\DoxyCodeLine{00120\ \ \ \ \ \ \ \ \ \textcolor{comment}{//@endcond}}
\DoxyCodeLine{00121\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00122\ \ \ \ \ \ \ \ \ \textcolor{keyword}{typedef}\ Lock\ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classcds_1_1sync_1_1lock__array_ae810e9067ba267f940d01de745e1fc27}{lock\_type}}\ \ \ \ \ \ \ \ \ \ \ ;\ \ \ }
\DoxyCodeLine{00123\ \ \ \ \ \ \ \ \ \textcolor{keyword}{typedef}\ SelectPolicy\ \ \ \ \mbox{\hyperlink{classcds_1_1sync_1_1lock__array_a7b1c889a1cf63052f0205b671a50fcbe}{select\_cell\_policy}}\ \ ;\ \ \ }
\DoxyCodeLine{00124\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{size\_t}\ \textcolor{keyword}{const}\ \ \ \ \ \mbox{\hyperlink{classcds_1_1sync_1_1lock__array_a1cdf8bb71d838e7e60779ddccc3fdad6}{c\_nUnspecifiedCell}}\ =\ (size\_t)\ -\/1\ ;\ \ }
\DoxyCodeLine{00125\ }
\DoxyCodeLine{00126\ \ \ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00127\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classcds_1_1sync_1_1lock__array_ae810e9067ba267f940d01de745e1fc27}{lock\_type}}\ *\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classcds_1_1sync_1_1lock__array_aebab256ff5156077e41c9cee628f47e1}{m\_arrLocks}}\ \ ;\ \ \ }
\DoxyCodeLine{00128\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \textcolor{keyword}{const}\ \ \ \ \ \ \ \ \mbox{\hyperlink{classcds_1_1sync_1_1lock__array_a6dfe36a8d6df4b1c7e3468f544e3d4f3}{m\_nCapacity}}\ ;\ \ \ }
\DoxyCodeLine{00129\ }
\DoxyCodeLine{00130\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classcds_1_1sync_1_1lock__array_a7b1c889a1cf63052f0205b671a50fcbe}{select\_cell\_policy}}\ \ \mbox{\hyperlink{classcds_1_1sync_1_1lock__array_a767853e8e1255dde4a38e0491a8a7150}{m\_SelectCellPolicy}}\ \ ;\ \ \ }
\DoxyCodeLine{00131\ }
\DoxyCodeLine{00132\ \ \ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00133\ \ \ \ \ \ \ \ \ \textcolor{comment}{//@cond}}
\DoxyCodeLine{00134\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{classcds_1_1sync_1_1lock__array_ae810e9067ba267f940d01de745e1fc27}{lock\_type}}\ *\ create\_lock\_array(\ \textcolor{keywordtype}{size\_t}\ nCapacity\ )}
\DoxyCodeLine{00135\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00136\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ cxx\_allocator().NewArray(\ nCapacity\ );}
\DoxyCodeLine{00137\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00138\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ delete\_lock\_array(\ \mbox{\hyperlink{classcds_1_1sync_1_1lock__array_ae810e9067ba267f940d01de745e1fc27}{lock\_type}}\ *\ pArr,\ \textcolor{keywordtype}{size\_t}\ nCapacity\ )}
\DoxyCodeLine{00139\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00140\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\ pArr\ )}
\DoxyCodeLine{00141\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cxx\_allocator().Delete(\ pArr,\ nCapacity\ );}
\DoxyCodeLine{00142\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00143\ }
\DoxyCodeLine{00144\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Only\ for\ internal\ use!!!}}
\DoxyCodeLine{00145\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classcds_1_1sync_1_1lock__array_a5f5e0c216fcaf96a54b338a23d61b74e}{lock\_array}}()}
\DoxyCodeLine{00146\ \ \ \ \ \ \ \ \ \ \ \ \ :\ \mbox{\hyperlink{classcds_1_1sync_1_1lock__array_aebab256ff5156077e41c9cee628f47e1}{m\_arrLocks}}(\ nullptr\ )}
\DoxyCodeLine{00147\ \ \ \ \ \ \ \ \ \ \ \ \ ,\ \mbox{\hyperlink{classcds_1_1sync_1_1lock__array_a6dfe36a8d6df4b1c7e3468f544e3d4f3}{m\_nCapacity}}(0)}
\DoxyCodeLine{00148\ \ \ \ \ \ \ \ \ \{\}}
\DoxyCodeLine{00149\ }
\DoxyCodeLine{00150\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classcds_1_1sync_1_1lock__array_a5f5e0c216fcaf96a54b338a23d61b74e}{lock\_array}}(\ \mbox{\hyperlink{classcds_1_1sync_1_1lock__array_a7b1c889a1cf63052f0205b671a50fcbe}{select\_cell\_policy}}\ \textcolor{keyword}{const}\&\ policy\ )}
\DoxyCodeLine{00151\ \ \ \ \ \ \ \ \ \ \ \ \ :\ \mbox{\hyperlink{classcds_1_1sync_1_1lock__array_aebab256ff5156077e41c9cee628f47e1}{m\_arrLocks}}(\ nullptr\ )}
\DoxyCodeLine{00152\ \ \ \ \ \ \ \ \ \ \ \ \ ,\ \mbox{\hyperlink{classcds_1_1sync_1_1lock__array_a6dfe36a8d6df4b1c7e3468f544e3d4f3}{m\_nCapacity}}(0)}
\DoxyCodeLine{00153\ \ \ \ \ \ \ \ \ \ \ \ \ ,\ \mbox{\hyperlink{classcds_1_1sync_1_1lock__array_a767853e8e1255dde4a38e0491a8a7150}{m\_SelectCellPolicy}}(\ policy\ )}
\DoxyCodeLine{00154\ \ \ \ \ \ \ \ \ \{\}}
\DoxyCodeLine{00155\ \ \ \ \ \ \ \ \ \textcolor{comment}{//@endcond}}
\DoxyCodeLine{00156\ }
\DoxyCodeLine{00157\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00159\ }
\DoxyCodeLine{00162\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classcds_1_1sync_1_1lock__array_a5f5e0c216fcaf96a54b338a23d61b74e}{lock\_array}}(}
\DoxyCodeLine{00163\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ nCapacity\ \ \ \ \ \ \ \ }
\DoxyCodeLine{00164\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{00165\ \ \ \ \ \ \ \ \ :\ \mbox{\hyperlink{classcds_1_1sync_1_1lock__array_aebab256ff5156077e41c9cee628f47e1}{m\_arrLocks}}(\ nullptr\ )}
\DoxyCodeLine{00166\ \ \ \ \ \ \ \ \ ,\ \mbox{\hyperlink{classcds_1_1sync_1_1lock__array_a6dfe36a8d6df4b1c7e3468f544e3d4f3}{m\_nCapacity}}(\ nCapacity\ )}
\DoxyCodeLine{00167\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00168\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classcds_1_1sync_1_1lock__array_aebab256ff5156077e41c9cee628f47e1}{m\_arrLocks}}\ =\ create\_lock\_array(\ nCapacity\ );}
\DoxyCodeLine{00169\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00170\ }
\DoxyCodeLine{00172\ }
\DoxyCodeLine{00175\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classcds_1_1sync_1_1lock__array_af52c2738dd39114d68058555155050b8}{lock\_array}}(}
\DoxyCodeLine{00176\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ nCapacity,\ \ \ \ \ \ \ }
\DoxyCodeLine{00177\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classcds_1_1sync_1_1lock__array_a7b1c889a1cf63052f0205b671a50fcbe}{select\_cell\_policy}}\ \textcolor{keyword}{const}\&\ policy\ \ \ \ }
\DoxyCodeLine{00178\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{00179\ \ \ \ \ \ \ \ \ :\ \mbox{\hyperlink{classcds_1_1sync_1_1lock__array_aebab256ff5156077e41c9cee628f47e1}{m\_arrLocks}}(\ nullptr\ )}
\DoxyCodeLine{00180\ \ \ \ \ \ \ \ \ ,\ \mbox{\hyperlink{classcds_1_1sync_1_1lock__array_a6dfe36a8d6df4b1c7e3468f544e3d4f3}{m\_nCapacity}}(\ nCapacity\ )}
\DoxyCodeLine{00181\ \ \ \ \ \ \ \ \ ,\ \mbox{\hyperlink{classcds_1_1sync_1_1lock__array_a767853e8e1255dde4a38e0491a8a7150}{m\_SelectCellPolicy}}(\ policy\ )}
\DoxyCodeLine{00182\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00183\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classcds_1_1sync_1_1lock__array_aebab256ff5156077e41c9cee628f47e1}{m\_arrLocks}}\ =\ create\_lock\_array(\ \mbox{\hyperlink{classcds_1_1sync_1_1lock__array_a6dfe36a8d6df4b1c7e3468f544e3d4f3}{m\_nCapacity}}\ );}
\DoxyCodeLine{00184\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00185\ }
\DoxyCodeLine{00187\ }
\DoxyCodeLine{00190\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classcds_1_1sync_1_1lock__array_ad9ba0f3745f9b8ebb7dc92202ed8de77}{lock\_array}}(}
\DoxyCodeLine{00191\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ nCapacity,\ \ \ \ \ \ \ }
\DoxyCodeLine{00192\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classcds_1_1sync_1_1lock__array_a7b1c889a1cf63052f0205b671a50fcbe}{select\_cell\_policy}}\&\&\ policy\ \ \ \ }
\DoxyCodeLine{00193\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{00194\ \ \ \ \ \ \ \ \ :\ \mbox{\hyperlink{classcds_1_1sync_1_1lock__array_aebab256ff5156077e41c9cee628f47e1}{m\_arrLocks}}(\ nullptr\ )}
\DoxyCodeLine{00195\ \ \ \ \ \ \ \ \ ,\ \mbox{\hyperlink{classcds_1_1sync_1_1lock__array_a6dfe36a8d6df4b1c7e3468f544e3d4f3}{m\_nCapacity}}(\ nCapacity\ )}
\DoxyCodeLine{00196\ \ \ \ \ \ \ \ \ ,\ \mbox{\hyperlink{classcds_1_1sync_1_1lock__array_a767853e8e1255dde4a38e0491a8a7150}{m\_SelectCellPolicy}}(\ \mbox{\hyperlink{namespacestd}{std}}::forward<\mbox{\hyperlink{classcds_1_1sync_1_1lock__array_a7b1c889a1cf63052f0205b671a50fcbe}{select\_cell\_policy}}>(\ policy\ ))}
\DoxyCodeLine{00197\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00198\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classcds_1_1sync_1_1lock__array_aebab256ff5156077e41c9cee628f47e1}{m\_arrLocks}}\ =\ create\_lock\_array(\ \mbox{\hyperlink{classcds_1_1sync_1_1lock__array_a6dfe36a8d6df4b1c7e3468f544e3d4f3}{m\_nCapacity}}\ );}
\DoxyCodeLine{00199\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00200\ }
\DoxyCodeLine{00202\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classcds_1_1sync_1_1lock__array_a1bca1688d9e2ff360eaea7261ff87da8}{\string~lock\_array}}()}
\DoxyCodeLine{00203\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00204\ \ \ \ \ \ \ \ \ \ \ \ \ delete\_lock\_array(\ \mbox{\hyperlink{classcds_1_1sync_1_1lock__array_aebab256ff5156077e41c9cee628f47e1}{m\_arrLocks}},\ \mbox{\hyperlink{classcds_1_1sync_1_1lock__array_a6dfe36a8d6df4b1c7e3468f544e3d4f3}{m\_nCapacity}}\ );}
\DoxyCodeLine{00205\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00206\ }
\DoxyCodeLine{00208\ }
\DoxyCodeLine{00214\ \ \ \ \ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Q>}
\DoxyCodeLine{00215\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classcds_1_1sync_1_1lock__array_a5341c7e8015b0b36a4132b33c96db953}{lock}}(\ \mbox{\hyperlink{_householder_q_r__householder_q_8cpp_a7e56035a736d269ad670f312496a0846}{Q}}\ \textcolor{keyword}{const}\&\ hint\ )}
\DoxyCodeLine{00216\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00217\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ nCell\ =\ \mbox{\hyperlink{classcds_1_1sync_1_1lock__array_a767853e8e1255dde4a38e0491a8a7150}{m\_SelectCellPolicy}}(\ hint,\ \mbox{\hyperlink{classcds_1_1sync_1_1lock__array_ac7cc42614f3383693df53b0f15d50cbd}{size}}());}
\DoxyCodeLine{00218\ \ \ \ \ \ \ \ \ \ \ \ \ assert(\ nCell\ <\ \mbox{\hyperlink{classcds_1_1sync_1_1lock__array_ac7cc42614f3383693df53b0f15d50cbd}{size}}());}
\DoxyCodeLine{00219\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classcds_1_1sync_1_1lock__array_aebab256ff5156077e41c9cee628f47e1}{m\_arrLocks}}[nCell].lock();}
\DoxyCodeLine{00220\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ nCell;}
\DoxyCodeLine{00221\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00222\ }
\DoxyCodeLine{00224\ }
\DoxyCodeLine{00230\ \ \ \ \ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Q>}
\DoxyCodeLine{00231\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classcds_1_1sync_1_1lock__array_a7ef5817da57d7fcbfa9f927346426960}{try\_lock}}(\ \mbox{\hyperlink{_householder_q_r__householder_q_8cpp_a7e56035a736d269ad670f312496a0846}{Q}}\ \textcolor{keyword}{const}\&\ hint\ )}
\DoxyCodeLine{00232\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00233\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ nCell\ =\ \mbox{\hyperlink{classcds_1_1sync_1_1lock__array_a767853e8e1255dde4a38e0491a8a7150}{m\_SelectCellPolicy}}(\ hint,\ \mbox{\hyperlink{classcds_1_1sync_1_1lock__array_ac7cc42614f3383693df53b0f15d50cbd}{size}}());}
\DoxyCodeLine{00234\ \ \ \ \ \ \ \ \ \ \ \ \ assert(\ nCell\ <\ \mbox{\hyperlink{classcds_1_1sync_1_1lock__array_ac7cc42614f3383693df53b0f15d50cbd}{size}}());}
\DoxyCodeLine{00235\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\ \mbox{\hyperlink{classcds_1_1sync_1_1lock__array_aebab256ff5156077e41c9cee628f47e1}{m\_arrLocks}}[nCell].\mbox{\hyperlink{classcds_1_1sync_1_1lock__array_a7ef5817da57d7fcbfa9f927346426960}{try\_lock}}())}
\DoxyCodeLine{00236\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ nCell;}
\DoxyCodeLine{00237\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classcds_1_1sync_1_1lock__array_a1cdf8bb71d838e7e60779ddccc3fdad6}{c\_nUnspecifiedCell}};}
\DoxyCodeLine{00238\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00239\ }
\DoxyCodeLine{00241\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classcds_1_1sync_1_1lock__array_a16d6e90d4fddd1178486ebde2420d54f}{unlock}}(\ \textcolor{keywordtype}{size\_t}\ nCell\ )}
\DoxyCodeLine{00242\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00243\ \ \ \ \ \ \ \ \ \ \ \ \ assert(\ nCell\ <\ \mbox{\hyperlink{classcds_1_1sync_1_1lock__array_ac7cc42614f3383693df53b0f15d50cbd}{size}}());}
\DoxyCodeLine{00244\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classcds_1_1sync_1_1lock__array_aebab256ff5156077e41c9cee628f47e1}{m\_arrLocks}}[nCell].unlock();}
\DoxyCodeLine{00245\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00246\ }
\DoxyCodeLine{00248\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classcds_1_1sync_1_1lock__array_ab509c32490ec7f113f94b38f870b7e9d}{lock\_all}}()}
\DoxyCodeLine{00249\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00250\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classcds_1_1sync_1_1lock__array_ae810e9067ba267f940d01de745e1fc27}{lock\_type}}\ *\ pLock\ =\ \mbox{\hyperlink{classcds_1_1sync_1_1lock__array_aebab256ff5156077e41c9cee628f47e1}{m\_arrLocks}};}
\DoxyCodeLine{00251\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\ \mbox{\hyperlink{classcds_1_1sync_1_1lock__array_ae810e9067ba267f940d01de745e1fc27}{lock\_type}}\ *\ pEnd\ =\ \mbox{\hyperlink{classcds_1_1sync_1_1lock__array_aebab256ff5156077e41c9cee628f47e1}{m\_arrLocks}}\ +\ \mbox{\hyperlink{classcds_1_1sync_1_1lock__array_ac7cc42614f3383693df53b0f15d50cbd}{size}}();\ pLock\ !=\ pEnd;\ ++pLock\ )}
\DoxyCodeLine{00252\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pLock-\/>lock();}
\DoxyCodeLine{00253\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00254\ }
\DoxyCodeLine{00256\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classcds_1_1sync_1_1lock__array_a78c23135ec340fb6ef489a8bbe45ed5b}{unlock\_all}}()}
\DoxyCodeLine{00257\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00258\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classcds_1_1sync_1_1lock__array_ae810e9067ba267f940d01de745e1fc27}{lock\_type}}\ *\ pLock\ =\ \mbox{\hyperlink{classcds_1_1sync_1_1lock__array_aebab256ff5156077e41c9cee628f47e1}{m\_arrLocks}};}
\DoxyCodeLine{00259\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\ \mbox{\hyperlink{classcds_1_1sync_1_1lock__array_ae810e9067ba267f940d01de745e1fc27}{lock\_type}}\ *\ pEnd\ =\ \mbox{\hyperlink{classcds_1_1sync_1_1lock__array_aebab256ff5156077e41c9cee628f47e1}{m\_arrLocks}}\ +\ \mbox{\hyperlink{classcds_1_1sync_1_1lock__array_ac7cc42614f3383693df53b0f15d50cbd}{size}}();\ pLock\ !=\ pEnd;\ ++pLock\ )}
\DoxyCodeLine{00260\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pLock-\/>unlock();}
\DoxyCodeLine{00261\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00262\ }
\DoxyCodeLine{00264\ }
\DoxyCodeLine{00267\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classcds_1_1sync_1_1lock__array_ae810e9067ba267f940d01de745e1fc27}{lock\_type}}\&\ \mbox{\hyperlink{classcds_1_1sync_1_1lock__array_abae8304f229292de1ca56d34ed8382ea}{at}}(\ \textcolor{keywordtype}{size\_t}\ nCell\ )\textcolor{keyword}{\ const}}
\DoxyCodeLine{00268\ \textcolor{keyword}{\ \ \ \ \ \ \ \ }\{}
\DoxyCodeLine{00269\ \ \ \ \ \ \ \ \ \ \ \ \ assert(\ nCell\ <\ \mbox{\hyperlink{classcds_1_1sync_1_1lock__array_ac7cc42614f3383693df53b0f15d50cbd}{size}}());}
\DoxyCodeLine{00270\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classcds_1_1sync_1_1lock__array_aebab256ff5156077e41c9cee628f47e1}{m\_arrLocks}}[\ nCell\ ];}
\DoxyCodeLine{00271\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00272\ }
\DoxyCodeLine{00274\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classcds_1_1sync_1_1lock__array_ac7cc42614f3383693df53b0f15d50cbd}{size}}()\textcolor{keyword}{\ const}}
\DoxyCodeLine{00275\ \textcolor{keyword}{\ \ \ \ \ \ \ \ }\{}
\DoxyCodeLine{00276\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classcds_1_1sync_1_1lock__array_a6dfe36a8d6df4b1c7e3468f544e3d4f3}{m\_nCapacity}};}
\DoxyCodeLine{00277\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00278\ \ \ \ \ \};}
\DoxyCodeLine{00279\ }
\DoxyCodeLine{00280\ \}\}\ \textcolor{comment}{//\ namespace\ cds::sync}}
\DoxyCodeLine{00281\ }
\DoxyCodeLine{00282\ \textcolor{comment}{//@cond}}
\DoxyCodeLine{00283\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespacestd}{std}}\ \{}
\DoxyCodeLine{00284\ }
\DoxyCodeLine{00286\ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Lock,\ \textcolor{keyword}{typename}\ SelectPolicy,\ \textcolor{keyword}{class}\ Alloc>}
\DoxyCodeLine{00287\ \ \ \ \ \textcolor{keyword}{class\ }unique\_lock<\ cds::sync::lock\_array<\ Lock,\ SelectPolicy,\ Alloc\ >\ >}
\DoxyCodeLine{00288\ \ \ \ \ \{}
\DoxyCodeLine{00289\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00290\ \ \ \ \ \ \ \ \ \textcolor{keyword}{typedef}\ cds::sync::lock\_array<\ Lock,\ SelectPolicy,\ Alloc\ >\ \ \ lock\_array\_type;\ \ \ }
\DoxyCodeLine{00291\ }
\DoxyCodeLine{00292\ \ \ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00293\ \ \ \ \ \ \ \ \ lock\_array\_type\&\ \ \ \ m\_arrLocks;}
\DoxyCodeLine{00294\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_nLockGuarded;}
\DoxyCodeLine{00295\ }
\DoxyCodeLine{00296\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ c\_nLockAll\ =\ \string~size\_t(\ 0\ );}
\DoxyCodeLine{00297\ }
\DoxyCodeLine{00298\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00300\ \ \ \ \ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Q>}
\DoxyCodeLine{00301\ \ \ \ \ \ \ \ \ unique\_lock(\ lock\_array\_type\&\ arrLocks,\ \mbox{\hyperlink{_householder_q_r__householder_q_8cpp_a7e56035a736d269ad670f312496a0846}{Q}}\ \textcolor{keyword}{const}\&\ hint\ )}
\DoxyCodeLine{00302\ \ \ \ \ \ \ \ \ \ \ \ \ :\ m\_arrLocks(\ arrLocks\ )}
\DoxyCodeLine{00303\ \ \ \ \ \ \ \ \ \ \ \ \ ,\ m\_nLockGuarded(\ arrLocks.\mbox{\hyperlink{ittnotify__static_8h_a46e8be2e3aadb2f6ee62e762a36b9243}{lock}}(\ hint\ ))}
\DoxyCodeLine{00304\ \ \ \ \ \ \ \ \ \{\}}
\DoxyCodeLine{00305\ }
\DoxyCodeLine{00307\ \ \ \ \ \ \ \ \ unique\_lock(\ lock\_array\_type\&\ arrLocks\ )}
\DoxyCodeLine{00308\ \ \ \ \ \ \ \ \ \ \ \ \ :\ m\_arrLocks(\ arrLocks\ )}
\DoxyCodeLine{00309\ \ \ \ \ \ \ \ \ \ \ \ \ ,\ m\_nLockGuarded(\ c\_nLockAll\ )}
\DoxyCodeLine{00310\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00311\ \ \ \ \ \ \ \ \ \ \ \ \ arrLocks.lock\_all();}
\DoxyCodeLine{00312\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00313\ }
\DoxyCodeLine{00314\ \ \ \ \ \ \ \ \ unique\_lock()\ =\ \textcolor{keyword}{delete};}
\DoxyCodeLine{00315\ \ \ \ \ \ \ \ \ unique\_lock(\ unique\_lock\ \textcolor{keyword}{const}\&\ )\ =\ \textcolor{keyword}{delete};}
\DoxyCodeLine{00316\ }
\DoxyCodeLine{00317\ \ \ \ \ \ \ \ \ \string~unique\_lock()}
\DoxyCodeLine{00318\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00319\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\ m\_nLockGuarded\ ==\ c\_nLockAll\ )}
\DoxyCodeLine{00320\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_arrLocks.unlock\_all();}
\DoxyCodeLine{00321\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00322\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_arrLocks.unlock(\ m\_nLockGuarded\ );}
\DoxyCodeLine{00323\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00324\ \ \ \ \ \};}
\DoxyCodeLine{00325\ \}\ \textcolor{comment}{//\ namespace\ std}}
\DoxyCodeLine{00326\ \textcolor{comment}{//@endcond}}
\DoxyCodeLine{00327\ }
\DoxyCodeLine{00328\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ \#ifndef\ CDSLIB\_SYNC\_LOCK\_ARRAY\_H}}

\end{DoxyCode}
