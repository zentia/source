\doxysection{tf\+::TFProf\+Observer类 参考}
\hypertarget{classtf_1_1_t_f_prof_observer}{}\label{classtf_1_1_t_f_prof_observer}\index{tf::TFProfObserver@{tf::TFProfObserver}}


class to create an observer based on the built-\/in taskflow profiler format  




{\ttfamily \#include $<$observer.\+hpp$>$}



类 tf\+::TFProf\+Observer 继承关系图\+:
% FIG 0


tf\+::TFProf\+Observer 的协作图\+:
% FIG 1
\doxysubsubsection*{类}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{structtf_1_1_t_f_prof_observer_1_1_summary}{Summary}}
\item 
struct \mbox{\hyperlink{structtf_1_1_t_f_prof_observer_1_1_task_summary}{Task\+Summary}}
\item 
struct \mbox{\hyperlink{structtf_1_1_t_f_prof_observer_1_1_worker_summary}{Worker\+Summary}}
\end{DoxyCompactItemize}
\doxysubsubsection*{Public 成员函数}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{ittnotify__static_8h_a61af67d9d838a9497ca5b188dabc1aa0}{void}} \mbox{\hyperlink{classtf_1_1_t_f_prof_observer_a9f1e839e2a8d3abd0b91ac454f0d078b}{dump}} (std\+::ostream \&\mbox{\hyperlink{doctest_8h_a116af65cb5e924b33ad9d9ecd7a783f3}{ostream}}) const
\begin{DoxyCompactList}\small\item\em dumps the timelines into a @\+TFProf format through an output stream \end{DoxyCompactList}\item 
std\+::string \mbox{\hyperlink{classtf_1_1_t_f_prof_observer_a59e82cb3f9b0ada38aa1ddea14f14d02}{dump}} () const
\begin{DoxyCompactList}\small\item\em dumps the timelines into a JSON string \end{DoxyCompactList}\item 
\mbox{\hyperlink{ittnotify__static_8h_a61af67d9d838a9497ca5b188dabc1aa0}{void}} \mbox{\hyperlink{classtf_1_1_t_f_prof_observer_a6102cedbaf2e40f8b8ff916827297198}{summary}} (std\+::ostream \&\mbox{\hyperlink{doctest_8h_a116af65cb5e924b33ad9d9ecd7a783f3}{ostream}}) const
\begin{DoxyCompactList}\small\item\em shows the summary report through an output stream \end{DoxyCompactList}\item 
std\+::string \mbox{\hyperlink{classtf_1_1_t_f_prof_observer_a6f12a927a328bd594cf6c3c3a6bfe992}{summary}} () const
\begin{DoxyCompactList}\small\item\em returns the summary report in a string \end{DoxyCompactList}\item 
\mbox{\hyperlink{ittnotify__static_8h_a61af67d9d838a9497ca5b188dabc1aa0}{void}} \mbox{\hyperlink{classtf_1_1_t_f_prof_observer_a5e1f63034a96a5a79cef6da412efd203}{clear}} ()
\begin{DoxyCompactList}\small\item\em clears the timeline data \end{DoxyCompactList}\item 
size\+\_\+t \mbox{\hyperlink{classtf_1_1_t_f_prof_observer_a8b3b0bee8762af654cfebd2bb2ee98ed}{num\+\_\+tasks}} () const
\begin{DoxyCompactList}\small\item\em queries the number of tasks observed \end{DoxyCompactList}\item 
size\+\_\+t \mbox{\hyperlink{classtf_1_1_t_f_prof_observer_a62ccf28199e35748903559848072fc29}{num\+\_\+workers}} () const
\begin{DoxyCompactList}\small\item\em queries the number of observed workers \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Public 成员函数 继承自 \mbox{\hyperlink{classtf_1_1_observer_interface}{tf\+::\+Observer\+Interface}}}
\begin{DoxyCompactItemize}
\item 
virtual \mbox{\hyperlink{classtf_1_1_observer_interface_adfd71c3af3ae2ea4f41eed26c1b6f604}{\texorpdfstring{$\sim$}{\string~}\+Observer\+Interface}} ()=\mbox{\hyperlink{sugar_8h_a6face89e97cccad5464dd9bb9c7efd23}{default}}
\begin{DoxyCompactList}\small\item\em virtual destructor \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Private 成员函数}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{ittnotify__static_8h_a61af67d9d838a9497ca5b188dabc1aa0}{void}} \mbox{\hyperlink{classtf_1_1_t_f_prof_observer_aa030d8154dd03aea3b8fa8ce42e1151b}{set\+\_\+up}} (size\+\_\+t \mbox{\hyperlink{classtf_1_1_t_f_prof_observer_a62ccf28199e35748903559848072fc29}{num\+\_\+workers}}) override final
\begin{DoxyCompactList}\small\item\em constructor-\/like method to call when the executor observer is fully created \end{DoxyCompactList}\item 
\mbox{\hyperlink{ittnotify__static_8h_a61af67d9d838a9497ca5b188dabc1aa0}{void}} \mbox{\hyperlink{classtf_1_1_t_f_prof_observer_a5debfce27f7e012d22872c134b261c63}{on\+\_\+entry}} (\mbox{\hyperlink{classtf_1_1_worker_view}{Worker\+View}}, \mbox{\hyperlink{classtf_1_1_task_view}{Task\+View}}) override final
\begin{DoxyCompactList}\small\item\em method to call before a worker thread executes a closure \end{DoxyCompactList}\item 
\mbox{\hyperlink{ittnotify__static_8h_a61af67d9d838a9497ca5b188dabc1aa0}{void}} \mbox{\hyperlink{classtf_1_1_t_f_prof_observer_af3a1630b5b1db5341a239a5d4c12c891}{on\+\_\+exit}} (\mbox{\hyperlink{classtf_1_1_worker_view}{Worker\+View}}, \mbox{\hyperlink{classtf_1_1_task_view}{Task\+View}}) override final
\begin{DoxyCompactList}\small\item\em method to call after a worker thread executed a closure \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Private 属性}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{structtf_1_1_timeline}{Timeline}} \mbox{\hyperlink{classtf_1_1_t_f_prof_observer_a38776d45d5d762b56c28c034d71170a9}{\+\_\+timeline}}
\item 
std\+::vector$<$ std\+::stack$<$ \mbox{\hyperlink{namespacetf_a9c8f07d1c11444ff4dc15c63aa54da8d}{observer\+\_\+stamp\+\_\+t}} $>$ $>$ \mbox{\hyperlink{classtf_1_1_t_f_prof_observer_a07f9db5edc30436d8ec55bdaecca5aaa}{\+\_\+stacks}}
\end{DoxyCompactItemize}
\doxysubsubsection*{友元}
\begin{DoxyCompactItemize}
\item 
class \mbox{\hyperlink{classtf_1_1_t_f_prof_observer_a763b2f90bc53f92d680a635fe28e858e}{Executor}}
\item 
class \mbox{\hyperlink{classtf_1_1_t_f_prof_observer_a7857257f009bf5cae6bda4505fffbd2d}{TFProf\+Manager}}
\end{DoxyCompactItemize}


\doxysubsection{详细描述}
class to create an observer based on the built-\/in taskflow profiler format 

\doxylink{bench__gemm_8cpp_addc86e8508f14411ec98f521c520f875}{A} \doxylink{classtf_1_1_t_f_prof_observer}{tf\+::\+TFProf\+Observer} inherits \doxylink{classtf_1_1_observer_interface}{tf\+::\+Observer\+Interface} and defines methods to dump the observed thread activities into a format that can be visualized through @\+TFProf.


\begin{DoxyCode}{0}
\DoxyCodeLine{tf::Taskflow\ \mbox{\hyperlink{poisson_8hpp_aa56fe360bb0ae38e0082f49e394ff825}{taskflow}};}
\DoxyCodeLine{tf::Executor\ \mbox{\hyperlink{thread__pool_8cpp_a543e564a8407bbeac15cb2d929fec755}{executor}};}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{//\ insert\ tasks\ into\ taskflow}}
\DoxyCodeLine{\textcolor{comment}{//\ ...}}
\DoxyCodeLine{\ \ }
\DoxyCodeLine{\textcolor{comment}{//\ create\ a\ custom\ observer}}
\DoxyCodeLine{std::shared\_ptr<tf::TFProfObserver>\ \mbox{\hyperlink{test__basics_8cpp_ae362ef40752341c76d5edd1d99e46918}{observer}}\ =\ \mbox{\hyperlink{thread__pool_8cpp_a543e564a8407bbeac15cb2d929fec755}{executor}}.\mbox{\hyperlink{classtf_1_1_executor_aff77def96ae740d648dd84e571237c83}{make\_observer}}<tf::TFProfObserver>();}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{//\ run\ the\ taskflow}}
\DoxyCodeLine{\mbox{\hyperlink{thread__pool_8cpp_a543e564a8407bbeac15cb2d929fec755}{executor}}.\mbox{\hyperlink{classtf_1_1_executor_a519777f5783981d534e9e53b99712069}{run}}(\mbox{\hyperlink{poisson_8hpp_aa56fe360bb0ae38e0082f49e394ff825}{taskflow}}).wait();}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{//\ dump\ the\ thread\ activities\ to\ Taskflow\ Profiler\ format.}}
\DoxyCodeLine{\mbox{\hyperlink{test__basics_8cpp_ae362ef40752341c76d5edd1d99e46918}{observer}}-\/>dump(std::cout);}

\end{DoxyCode}
 

\doxysubsection{成员函数说明}
\Hypertarget{classtf_1_1_t_f_prof_observer_a5e1f63034a96a5a79cef6da412efd203}\index{tf::TFProfObserver@{tf::TFProfObserver}!clear@{clear}}
\index{clear@{clear}!tf::TFProfObserver@{tf::TFProfObserver}}
\doxysubsubsection{\texorpdfstring{clear()}{clear()}}
{\footnotesize\ttfamily \label{classtf_1_1_t_f_prof_observer_a5e1f63034a96a5a79cef6da412efd203} 
\mbox{\hyperlink{ittnotify__static_8h_a61af67d9d838a9497ca5b188dabc1aa0}{void}} tf\+::\+TFProf\+Observer\+::clear (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



clears the timeline data 

\Hypertarget{classtf_1_1_t_f_prof_observer_a59e82cb3f9b0ada38aa1ddea14f14d02}\index{tf::TFProfObserver@{tf::TFProfObserver}!dump@{dump}}
\index{dump@{dump}!tf::TFProfObserver@{tf::TFProfObserver}}
\doxysubsubsection{\texorpdfstring{dump()}{dump()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily \label{classtf_1_1_t_f_prof_observer_a59e82cb3f9b0ada38aa1ddea14f14d02} 
std\+::string tf\+::\+TFProf\+Observer\+::dump (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



dumps the timelines into a JSON string 

函数调用图\+:
% FIG 2
\Hypertarget{classtf_1_1_t_f_prof_observer_a9f1e839e2a8d3abd0b91ac454f0d078b}\index{tf::TFProfObserver@{tf::TFProfObserver}!dump@{dump}}
\index{dump@{dump}!tf::TFProfObserver@{tf::TFProfObserver}}
\doxysubsubsection{\texorpdfstring{dump()}{dump()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily \label{classtf_1_1_t_f_prof_observer_a9f1e839e2a8d3abd0b91ac454f0d078b} 
\mbox{\hyperlink{ittnotify__static_8h_a61af67d9d838a9497ca5b188dabc1aa0}{void}} tf\+::\+TFProf\+Observer\+::dump (\begin{DoxyParamCaption}\item[{std\+::ostream \&}]{ostream}{}\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



dumps the timelines into a @\+TFProf format through an output stream 

函数调用图\+:
% FIG 3
\Hypertarget{classtf_1_1_t_f_prof_observer_a8b3b0bee8762af654cfebd2bb2ee98ed}\index{tf::TFProfObserver@{tf::TFProfObserver}!num\_tasks@{num\_tasks}}
\index{num\_tasks@{num\_tasks}!tf::TFProfObserver@{tf::TFProfObserver}}
\doxysubsubsection{\texorpdfstring{num\_tasks()}{num\_tasks()}}
{\footnotesize\ttfamily \label{classtf_1_1_t_f_prof_observer_a8b3b0bee8762af654cfebd2bb2ee98ed} 
size\+\_\+t tf\+::\+TFProf\+Observer\+::num\+\_\+tasks (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



queries the number of tasks observed 

\Hypertarget{classtf_1_1_t_f_prof_observer_a62ccf28199e35748903559848072fc29}\index{tf::TFProfObserver@{tf::TFProfObserver}!num\_workers@{num\_workers}}
\index{num\_workers@{num\_workers}!tf::TFProfObserver@{tf::TFProfObserver}}
\doxysubsubsection{\texorpdfstring{num\_workers()}{num\_workers()}}
{\footnotesize\ttfamily \label{classtf_1_1_t_f_prof_observer_a62ccf28199e35748903559848072fc29} 
size\+\_\+t tf\+::\+TFProf\+Observer\+::num\+\_\+workers (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



queries the number of observed workers 

\Hypertarget{classtf_1_1_t_f_prof_observer_a5debfce27f7e012d22872c134b261c63}\index{tf::TFProfObserver@{tf::TFProfObserver}!on\_entry@{on\_entry}}
\index{on\_entry@{on\_entry}!tf::TFProfObserver@{tf::TFProfObserver}}
\doxysubsubsection{\texorpdfstring{on\_entry()}{on\_entry()}}
{\footnotesize\ttfamily \label{classtf_1_1_t_f_prof_observer_a5debfce27f7e012d22872c134b261c63} 
\mbox{\hyperlink{ittnotify__static_8h_a61af67d9d838a9497ca5b188dabc1aa0}{void}} tf\+::\+TFProf\+Observer\+::on\+\_\+entry (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classtf_1_1_worker_view}{Worker\+View}}}]{wv}{, }\item[{\mbox{\hyperlink{classtf_1_1_task_view}{Task\+View}}}]{task\+\_\+view}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [final]}, {\ttfamily [override]}, {\ttfamily [private]}, {\ttfamily [virtual]}}



method to call before a worker thread executes a closure 


\begin{DoxyParams}{参数}
{\em wv} & an immutable view of this worker thread \\
\hline
{\em task\+\_\+view} & a constant wrapper object to the task \\
\hline
\end{DoxyParams}


实现了 \mbox{\hyperlink{classtf_1_1_observer_interface_a8225fcacb03089677a1efc4b16b734cc}{tf\+::\+Observer\+Interface}}.

函数调用图\+:
% FIG 4
\Hypertarget{classtf_1_1_t_f_prof_observer_af3a1630b5b1db5341a239a5d4c12c891}\index{tf::TFProfObserver@{tf::TFProfObserver}!on\_exit@{on\_exit}}
\index{on\_exit@{on\_exit}!tf::TFProfObserver@{tf::TFProfObserver}}
\doxysubsubsection{\texorpdfstring{on\_exit()}{on\_exit()}}
{\footnotesize\ttfamily \label{classtf_1_1_t_f_prof_observer_af3a1630b5b1db5341a239a5d4c12c891} 
\mbox{\hyperlink{ittnotify__static_8h_a61af67d9d838a9497ca5b188dabc1aa0}{void}} tf\+::\+TFProf\+Observer\+::on\+\_\+exit (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classtf_1_1_worker_view}{Worker\+View}}}]{wv}{, }\item[{\mbox{\hyperlink{classtf_1_1_task_view}{Task\+View}}}]{task\+\_\+view}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [final]}, {\ttfamily [override]}, {\ttfamily [private]}, {\ttfamily [virtual]}}



method to call after a worker thread executed a closure 


\begin{DoxyParams}{参数}
{\em wv} & an immutable view of this worker thread \\
\hline
{\em task\+\_\+view} & a constant wrapper object to the task \\
\hline
\end{DoxyParams}


实现了 \mbox{\hyperlink{classtf_1_1_observer_interface_aa22f5378154653f08d9a58326bda4754}{tf\+::\+Observer\+Interface}}.

函数调用图\+:
% FIG 5
\Hypertarget{classtf_1_1_t_f_prof_observer_aa030d8154dd03aea3b8fa8ce42e1151b}\index{tf::TFProfObserver@{tf::TFProfObserver}!set\_up@{set\_up}}
\index{set\_up@{set\_up}!tf::TFProfObserver@{tf::TFProfObserver}}
\doxysubsubsection{\texorpdfstring{set\_up()}{set\_up()}}
{\footnotesize\ttfamily \label{classtf_1_1_t_f_prof_observer_aa030d8154dd03aea3b8fa8ce42e1151b} 
\mbox{\hyperlink{ittnotify__static_8h_a61af67d9d838a9497ca5b188dabc1aa0}{void}} tf\+::\+TFProf\+Observer\+::set\+\_\+up (\begin{DoxyParamCaption}\item[{size\+\_\+t}]{num\+\_\+workers}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [final]}, {\ttfamily [override]}, {\ttfamily [private]}, {\ttfamily [virtual]}}



constructor-\/like method to call when the executor observer is fully created 


\begin{DoxyParams}{参数}
{\em num\+\_\+workers} & the number of the worker threads in the executor \\
\hline
\end{DoxyParams}


实现了 \mbox{\hyperlink{classtf_1_1_observer_interface_a41e6e62f12bf9d9dc4fa74632f6825d9}{tf\+::\+Observer\+Interface}}.

函数调用图\+:
% FIG 6
\Hypertarget{classtf_1_1_t_f_prof_observer_a6f12a927a328bd594cf6c3c3a6bfe992}\index{tf::TFProfObserver@{tf::TFProfObserver}!summary@{summary}}
\index{summary@{summary}!tf::TFProfObserver@{tf::TFProfObserver}}
\doxysubsubsection{\texorpdfstring{summary()}{summary()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily \label{classtf_1_1_t_f_prof_observer_a6f12a927a328bd594cf6c3c3a6bfe992} 
std\+::string tf\+::\+TFProf\+Observer\+::summary (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



returns the summary report in a string 

函数调用图\+:
% FIG 7
\Hypertarget{classtf_1_1_t_f_prof_observer_a6102cedbaf2e40f8b8ff916827297198}\index{tf::TFProfObserver@{tf::TFProfObserver}!summary@{summary}}
\index{summary@{summary}!tf::TFProfObserver@{tf::TFProfObserver}}
\doxysubsubsection{\texorpdfstring{summary()}{summary()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily \label{classtf_1_1_t_f_prof_observer_a6102cedbaf2e40f8b8ff916827297198} 
\mbox{\hyperlink{ittnotify__static_8h_a61af67d9d838a9497ca5b188dabc1aa0}{void}} tf\+::\+TFProf\+Observer\+::summary (\begin{DoxyParamCaption}\item[{std\+::ostream \&}]{ostream}{}\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



shows the summary report through an output stream 

函数调用图\+:
% FIG 8


\doxysubsection{友元及相关符号说明}
\Hypertarget{classtf_1_1_t_f_prof_observer_a763b2f90bc53f92d680a635fe28e858e}\index{tf::TFProfObserver@{tf::TFProfObserver}!Executor@{Executor}}
\index{Executor@{Executor}!tf::TFProfObserver@{tf::TFProfObserver}}
\doxysubsubsection{\texorpdfstring{Executor}{Executor}}
{\footnotesize\ttfamily \label{classtf_1_1_t_f_prof_observer_a763b2f90bc53f92d680a635fe28e858e} 
friend class \mbox{\hyperlink{classtf_1_1_executor}{Executor}}\hspace{0.3cm}{\ttfamily [friend]}}

\Hypertarget{classtf_1_1_t_f_prof_observer_a7857257f009bf5cae6bda4505fffbd2d}\index{tf::TFProfObserver@{tf::TFProfObserver}!TFProfManager@{TFProfManager}}
\index{TFProfManager@{TFProfManager}!tf::TFProfObserver@{tf::TFProfObserver}}
\doxysubsubsection{\texorpdfstring{TFProfManager}{TFProfManager}}
{\footnotesize\ttfamily \label{classtf_1_1_t_f_prof_observer_a7857257f009bf5cae6bda4505fffbd2d} 
friend class \mbox{\hyperlink{classtf_1_1_t_f_prof_manager}{TFProf\+Manager}}\hspace{0.3cm}{\ttfamily [friend]}}



\doxysubsection{类成员变量说明}
\Hypertarget{classtf_1_1_t_f_prof_observer_a07f9db5edc30436d8ec55bdaecca5aaa}\index{tf::TFProfObserver@{tf::TFProfObserver}!\_stacks@{\_stacks}}
\index{\_stacks@{\_stacks}!tf::TFProfObserver@{tf::TFProfObserver}}
\doxysubsubsection{\texorpdfstring{\_stacks}{\_stacks}}
{\footnotesize\ttfamily \label{classtf_1_1_t_f_prof_observer_a07f9db5edc30436d8ec55bdaecca5aaa} 
std\+::vector$<$std\+::stack$<$\mbox{\hyperlink{namespacetf_a9c8f07d1c11444ff4dc15c63aa54da8d}{observer\+\_\+stamp\+\_\+t}}$>$ $>$ tf\+::\+TFProf\+Observer\+::\+\_\+stacks\hspace{0.3cm}{\ttfamily [private]}}

\Hypertarget{classtf_1_1_t_f_prof_observer_a38776d45d5d762b56c28c034d71170a9}\index{tf::TFProfObserver@{tf::TFProfObserver}!\_timeline@{\_timeline}}
\index{\_timeline@{\_timeline}!tf::TFProfObserver@{tf::TFProfObserver}}
\doxysubsubsection{\texorpdfstring{\_timeline}{\_timeline}}
{\footnotesize\ttfamily \label{classtf_1_1_t_f_prof_observer_a38776d45d5d762b56c28c034d71170a9} 
\mbox{\hyperlink{structtf_1_1_timeline}{Timeline}} tf\+::\+TFProf\+Observer\+::\+\_\+timeline\hspace{0.3cm}{\ttfamily [private]}}



该类的文档由以下文件生成\+:\begin{DoxyCompactItemize}
\item 
external/taskflow/taskflow/core/\mbox{\hyperlink{observer_8hpp}{observer.\+hpp}}\end{DoxyCompactItemize}
