\doxysubsection{Using BLAS/\+LAPACK from Eigen}
\hypertarget{_topic_using_blas_lapack}{}\label{_topic_using_blas_lapack}\index{Using BLAS/LAPACK from \%Eigen@{Using BLAS/LAPACK from \%Eigen}}
Since Eigen version 3.\+3 and later, any F77 compatible BLAS or LAPACK libraries can be used as backends for dense matrix products and dense matrix decompositions. For instance, one can use \href{http://eigen.tuxfamily.org/Counter/redirect_to_mkl.php}{\texttt{ Intel® MKL}}, Apple\textquotesingle{}s Accelerate framework on OSX, \href{http://www.openblas.net/}{\texttt{ Open\+BLAS}}, \href{http://www.netlib.org/lapack}{\texttt{ Netlib LAPACK}}, etc.

Do not miss this \doxylink{_topic_using_intel_m_k_l}{page } for further discussions on the specific use of Intel® MKL (also includes VML, PARDISO, etc.)

In order to use an external BLAS and/or LAPACK library, you must link you own application to the respective libraries and their dependencies. For LAPACK, you must also link to the standard \href{http://www.netlib.org/lapack/lapacke.html}{\texttt{ Lapacke}} library, which is used as a convenient think layer between Eigen\textquotesingle{}s C++ code and LAPACK F77 interface. Then you must activate their usage by defining one or multiple of the following macros ({\bfseries{before}} including any Eigen\textquotesingle{}s header)\+:

\begin{DoxyNote}{注解}
For Mac users, in order to use the lapack version shipped with the Accelerate framework, you also need the lapacke library. Using \href{https://www.macports.org/}{\texttt{ Mac\+Ports}}, this is as easy as\+: 
\begin{DoxyCode}{0}
\DoxyCodeLine{sudo\ port\ install\ lapack}

\end{DoxyCode}
 and then use the following link flags\+: {\ttfamily -\/framework} {\ttfamily Accelerate} {\ttfamily /opt/local/lib/lapack/liblapacke}.dylib
\end{DoxyNote}
\tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{2}{|X[-1]}|}
\hline
{\ttfamily EIGEN\+\_\+\+USE\+\_\+\+BLAS} &Enables the use of external BLAS level 2 and 3 routines (compatible with any F77 BLAS interface) \\\cline{1-2}
{\ttfamily EIGEN\+\_\+\+USE\+\_\+\+LAPACKE} &Enables the use of external Lapack routines via the \href{http://www.netlib.org/lapack/lapacke.html}{\texttt{ Lapacke}} C interface to Lapack (compatible with any F77 LAPACK interface) \\\cline{1-2}
{\ttfamily EIGEN\+\_\+\+USE\+\_\+\+LAPACKE\+\_\+\+STRICT} &Same as {\ttfamily EIGEN\+\_\+\+USE\+\_\+\+LAPACKE} but algorithms of lower numerical robustness are disabled. ~\newline
 This currently concerns only \doxylink{class_eigen_1_1_jacobi_s_v_d}{Jacobi\+SVD} which otherwise would be replaced by {\ttfamily gesvd} that is less robust than Jacobi rotations. \\\cline{1-2}
\end{longtabu}


When doing so, a number of Eigen\textquotesingle{}s algorithms are silently substituted with calls to BLAS or LAPACK routines. These substitutions apply only for {\bfseries{Dynamic}} {\bfseries{or}} {\bfseries{large}} enough objects with one of the following four standard scalar types\+: {\ttfamily float}, {\ttfamily double}, {\ttfamily \doxylink{structcomplex}{complex$<$float$>$}}, and {\ttfamily \doxylink{structcomplex}{complex$<$double$>$}}. Operations on other scalar types or mixing reals and complexes will continue to use the built-\/in algorithms.

The breadth of Eigen functionality that can be substituted is listed in the table below. \tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{3}{|X[-1]}|}
\hline
\cellcolor{\tableheadbgcolor}\textbf{ Functional domain}&\cellcolor{\tableheadbgcolor}\textbf{ Code example}&\cellcolor{\tableheadbgcolor}\textbf{ BLAS/\+LAPACK routines }\\\cline{1-3}
\endfirsthead
\hline
\endfoot
\hline
\cellcolor{\tableheadbgcolor}\textbf{ Functional domain}&\cellcolor{\tableheadbgcolor}\textbf{ Code example}&\cellcolor{\tableheadbgcolor}\textbf{ BLAS/\+LAPACK routines }\\\cline{1-3}
\endhead
Matrix-\/matrix operations ~\newline
 {\ttfamily EIGEN\+\_\+\+USE\+\_\+\+BLAS} &
\begin{DoxyCode}{0}
\DoxyCodeLine{\mbox{\hyperlink{_i_o_format_8cpp_ade6f22163da3c189aade978b48a8bb74}{m1}}*\mbox{\hyperlink{_tutorial___map__using_8cpp_ab3a01b595d22393ace0d30d5fa299f76}{m2}}.transpose();}
\DoxyCodeLine{\mbox{\hyperlink{_i_o_format_8cpp_ade6f22163da3c189aade978b48a8bb74}{m1}}.selfadjointView<\mbox{\hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cdaf581029282d421eee5aae14238c6f749}{Lower}}>()*\mbox{\hyperlink{_tutorial___map__using_8cpp_ab3a01b595d22393ace0d30d5fa299f76}{m2}};}
\DoxyCodeLine{\mbox{\hyperlink{_i_o_format_8cpp_ade6f22163da3c189aade978b48a8bb74}{m1}}*\mbox{\hyperlink{_tutorial___map__using_8cpp_ab3a01b595d22393ace0d30d5fa299f76}{m2}}.triangularView<\mbox{\hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cdafca2ccebb604f171656deb53e8c083c1}{Upper}}>();}
\DoxyCodeLine{\mbox{\hyperlink{_i_o_format_8cpp_ade6f22163da3c189aade978b48a8bb74}{m1}}.selfadjointView<\mbox{\hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cdaf581029282d421eee5aae14238c6f749}{Lower}}>().rankUpdate(\mbox{\hyperlink{_tutorial___map__using_8cpp_ab3a01b595d22393ace0d30d5fa299f76}{m2}},1.0);}

\end{DoxyCode}
&
\begin{DoxyCode}{0}
\DoxyCodeLine{?\mbox{\hyperlink{bench__gemm_8cpp_a4e3341ba4cc101e5c46e8d6f201b21f9}{gemm}}}
\DoxyCodeLine{?\mbox{\hyperlink{level3__impl_8h_a3f6fae2e458ae4b980e090c1157fe7c9}{symm}}/?\mbox{\hyperlink{level3__impl_8h_a5aff6acb297c6a9e2bef06019ab38af8}{hemm}}}
\DoxyCodeLine{?\mbox{\hyperlink{level3__impl_8h_a498691136907ea5d5ebdc57af17c4008}{trmm}}}
\DoxyCodeLine{\mbox{\hyperlink{bench_2btl_2libs_2_b_l_a_s_2blas_8h_a73932102befff526efa7b6e022a6cba1}{dsyrk}}/\mbox{\hyperlink{bench_2btl_2libs_2_b_l_a_s_2blas_8h_aa90b7ccd042d06f19d3e6da3d240231a}{ssyrk}}}

\end{DoxyCode}
 \\\cline{1-3}
Matrix-\/vector operations ~\newline
 {\ttfamily EIGEN\+\_\+\+USE\+\_\+\+BLAS} &
\begin{DoxyCode}{0}
\DoxyCodeLine{\mbox{\hyperlink{_i_o_format_8cpp_ade6f22163da3c189aade978b48a8bb74}{m1}}.adjoint()*\mbox{\hyperlink{offscreen_8c_a846c9667e34d56c560bb7f0ac6e173f6}{b}};}
\DoxyCodeLine{\mbox{\hyperlink{_i_o_format_8cpp_ade6f22163da3c189aade978b48a8bb74}{m1}}.selfadjointView<\mbox{\hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cdaf581029282d421eee5aae14238c6f749}{Lower}}>()*\mbox{\hyperlink{offscreen_8c_a846c9667e34d56c560bb7f0ac6e173f6}{b}};}
\DoxyCodeLine{\mbox{\hyperlink{_i_o_format_8cpp_ade6f22163da3c189aade978b48a8bb74}{m1}}.triangularView<\mbox{\hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cdafca2ccebb604f171656deb53e8c083c1}{Upper}}>()*\mbox{\hyperlink{offscreen_8c_a846c9667e34d56c560bb7f0ac6e173f6}{b}};}

\end{DoxyCode}
&
\begin{DoxyCode}{0}
\DoxyCodeLine{?\mbox{\hyperlink{level2__impl_8h_ab0aa0d0afddafaa743a1068caf4569dc}{gemv}}}
\DoxyCodeLine{?\mbox{\hyperlink{level2__real__impl_8h_a100b5798dd6ed24dfda559538d38bc53}{symv}}/?\mbox{\hyperlink{level2__cplx__impl_8h_ad6e86c5ed84fff062ef4690fc9fb2d77}{hemv}}}
\DoxyCodeLine{?\mbox{\hyperlink{level2__impl_8h_a35f1f0646c91482e602319ce526f1fba}{trmv}}}

\end{DoxyCode}
 \\\cline{1-3}
LU decomposition ~\newline
 {\ttfamily EIGEN\+\_\+\+USE\+\_\+\+LAPACKE} ~\newline
 {\ttfamily EIGEN\+\_\+\+USE\+\_\+\+LAPACKE\+\_\+\+STRICT} &
\begin{DoxyCode}{0}
\DoxyCodeLine{\mbox{\hyperlink{_tutorial___reshape_mat2_vec_8cpp_a10bd710692c91bc238f2e1da77730678}{v1}}\ =\ \mbox{\hyperlink{_i_o_format_8cpp_ade6f22163da3c189aade978b48a8bb74}{m1}}.lu().solve(\mbox{\hyperlink{_tutorial___reshape_mat2_vec_8cpp_a3eb30a79de469336df46f4f5f0bfb84f}{v2}});}

\end{DoxyCode}
&
\begin{DoxyCode}{0}
\DoxyCodeLine{?getrf}

\end{DoxyCode}
 \\\cline{1-3}
Cholesky decomposition ~\newline
 {\ttfamily EIGEN\+\_\+\+USE\+\_\+\+LAPACKE} ~\newline
 {\ttfamily EIGEN\+\_\+\+USE\+\_\+\+LAPACKE\+\_\+\+STRICT} &
\begin{DoxyCode}{0}
\DoxyCodeLine{\mbox{\hyperlink{_tutorial___reshape_mat2_vec_8cpp_a10bd710692c91bc238f2e1da77730678}{v1}}\ =\ \mbox{\hyperlink{_tutorial___map__using_8cpp_ab3a01b595d22393ace0d30d5fa299f76}{m2}}.selfadjointView<\mbox{\hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cdafca2ccebb604f171656deb53e8c083c1}{Upper}}>().llt().solve(\mbox{\hyperlink{_tutorial___reshape_mat2_vec_8cpp_a3eb30a79de469336df46f4f5f0bfb84f}{v2}});}

\end{DoxyCode}
&
\begin{DoxyCode}{0}
\DoxyCodeLine{?potrf}

\end{DoxyCode}
 \\\cline{1-3}
QR decomposition ~\newline
 {\ttfamily EIGEN\+\_\+\+USE\+\_\+\+LAPACKE} ~\newline
 {\ttfamily EIGEN\+\_\+\+USE\+\_\+\+LAPACKE\+\_\+\+STRICT} &
\begin{DoxyCode}{0}
\DoxyCodeLine{\mbox{\hyperlink{_i_o_format_8cpp_ade6f22163da3c189aade978b48a8bb74}{m1}}.householderQr();}
\DoxyCodeLine{\mbox{\hyperlink{_i_o_format_8cpp_ade6f22163da3c189aade978b48a8bb74}{m1}}.colPivHouseholderQr();}

\end{DoxyCode}
&
\begin{DoxyCode}{0}
\DoxyCodeLine{?geqrf}
\DoxyCodeLine{?geqp3}

\end{DoxyCode}
 \\\cline{1-3}
Singular value decomposition ~\newline
 {\ttfamily EIGEN\+\_\+\+USE\+\_\+\+LAPACKE} &
\begin{DoxyCode}{0}
\DoxyCodeLine{\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d}{JacobiSVD<MatrixXd>}}\ \mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}};}
\DoxyCodeLine{\mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.compute(\mbox{\hyperlink{_i_o_format_8cpp_ade6f22163da3c189aade978b48a8bb74}{m1}},\ \mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a540036417bfecf2e791a70948c227f47}{ComputeThinV}});}

\end{DoxyCode}
&
\begin{DoxyCode}{0}
\DoxyCodeLine{?gesvd}

\end{DoxyCode}
 \\\cline{1-3}
Eigen-\/value decompositions ~\newline
 {\ttfamily EIGEN\+\_\+\+USE\+\_\+\+LAPACKE} ~\newline
 {\ttfamily EIGEN\+\_\+\+USE\+\_\+\+LAPACKE\+\_\+\+STRICT} &
\begin{DoxyCode}{0}
\DoxyCodeLine{\mbox{\hyperlink{class_eigen_1_1_eigen_solver}{EigenSolver<MatrixXd>}}\ \mbox{\hyperlink{_eigen_solver__compute_8cpp_a1eb615296caf62d46c5f9f4798b18a50}{es}}(\mbox{\hyperlink{_i_o_format_8cpp_ade6f22163da3c189aade978b48a8bb74}{m1}});}
\DoxyCodeLine{\mbox{\hyperlink{class_eigen_1_1_complex_eigen_solver}{ComplexEigenSolver<MatrixXcd>}}\ \mbox{\hyperlink{_complex_eigen_solver__compute_8cpp_afd8d05b91394834c8cdf175d9cadba9b}{ces}}(\mbox{\hyperlink{_i_o_format_8cpp_ade6f22163da3c189aade978b48a8bb74}{m1}});}
\DoxyCodeLine{\mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver}{SelfAdjointEigenSolver<MatrixXd>}}\ saes(\mbox{\hyperlink{_i_o_format_8cpp_ade6f22163da3c189aade978b48a8bb74}{m1}}+\mbox{\hyperlink{_i_o_format_8cpp_ade6f22163da3c189aade978b48a8bb74}{m1}}.transpose());}
\DoxyCodeLine{\mbox{\hyperlink{class_eigen_1_1_generalized_self_adjoint_eigen_solver}{GeneralizedSelfAdjointEigenSolver<MatrixXd>}}}
\DoxyCodeLine{\ \ \ \ gsaes(\mbox{\hyperlink{_i_o_format_8cpp_ade6f22163da3c189aade978b48a8bb74}{m1}}+\mbox{\hyperlink{_i_o_format_8cpp_ade6f22163da3c189aade978b48a8bb74}{m1}}.transpose(),\mbox{\hyperlink{_tutorial___map__using_8cpp_ab3a01b595d22393ace0d30d5fa299f76}{m2}}+\mbox{\hyperlink{_tutorial___map__using_8cpp_ab3a01b595d22393ace0d30d5fa299f76}{m2}}.transpose());}

\end{DoxyCode}
&
\begin{DoxyCode}{0}
\DoxyCodeLine{?gees}
\DoxyCodeLine{?gees}
\DoxyCodeLine{?syev/?heev}
\DoxyCodeLine{?syev/?heev,}
\DoxyCodeLine{?potrf}

\end{DoxyCode}
 \\\cline{1-3}
Schur decomposition ~\newline
 {\ttfamily EIGEN\+\_\+\+USE\+\_\+\+LAPACKE} ~\newline
 {\ttfamily EIGEN\+\_\+\+USE\+\_\+\+LAPACKE\+\_\+\+STRICT} &
\begin{DoxyCode}{0}
\DoxyCodeLine{\mbox{\hyperlink{class_eigen_1_1_real_schur}{RealSchur<MatrixXd>}}\ schurR(\mbox{\hyperlink{_i_o_format_8cpp_ade6f22163da3c189aade978b48a8bb74}{m1}});}
\DoxyCodeLine{\mbox{\hyperlink{class_eigen_1_1_complex_schur}{ComplexSchur<MatrixXcd>}}\ schurC(\mbox{\hyperlink{_i_o_format_8cpp_ade6f22163da3c189aade978b48a8bb74}{m1}});}

\end{DoxyCode}
&
\begin{DoxyCode}{0}
\DoxyCodeLine{?gees}

\end{DoxyCode}
 \\\cline{1-3}
\end{longtabu}
In the examples, m1 and m2 are dense matrices and v1 and v2 are dense vectors. 