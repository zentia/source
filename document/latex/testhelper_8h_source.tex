\doxysection{testhelper.\+h}
\hypertarget{testhelper_8h_source}{}\label{testhelper_8h_source}\index{runtime/EASTL/packages/mimalloc/test/testhelper.h@{runtime/EASTL/packages/mimalloc/test/testhelper.h}}
\mbox{\hyperlink{testhelper_8h}{浏览该文件的文档.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{/*\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00002\ \textcolor{comment}{Copyright\ (c)\ 2018-\/2020,\ Microsoft\ Research,\ Daan\ Leijen}}
\DoxyCodeLine{00003\ \textcolor{comment}{This\ is\ free\ software;\ you\ can\ redistribute\ it\ and/or\ modify\ it\ under\ the}}
\DoxyCodeLine{00004\ \textcolor{comment}{terms\ of\ the\ MIT\ license.\ A\ copy\ of\ the\ license\ can\ be\ found\ in\ the\ file}}
\DoxyCodeLine{00005\ \textcolor{comment}{"{}LICENSE"{}\ at\ the\ root\ of\ this\ distribution.}}
\DoxyCodeLine{00006\ \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/*/}}
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#ifndef\ TESTHELPER\_H\_}}
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#define\ TESTHELPER\_H\_}}
\DoxyCodeLine{00009\ }
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#include\ <stdbool.h>}}
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#include\ <stdio.h>}}
\DoxyCodeLine{00012\ \textcolor{preprocessor}{\#include\ <errno.h>}}
\DoxyCodeLine{00013\ }
\DoxyCodeLine{00014\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00015\ \textcolor{comment}{//\ Test\ macros:\ CHECK(name,predicate)\ and\ CHECK\_BODY(name,body)}}
\DoxyCodeLine{00016\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00017\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{testhelper_8h_a047ea0d874e6802b9b6d08f6b50248e5}{ok}}\ =\ 0;}
\DoxyCodeLine{00018\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{testhelper_8h_ad4ec5aab9b62fbbe9b8fc2d8ac0a5989}{failed}}\ =\ 0;}
\DoxyCodeLine{00019\ }
\DoxyCodeLine{00020\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{testhelper_8h_abd9b57a853951275b427ad9b1c2d0407}{check\_result}}(\textcolor{keywordtype}{bool}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}},\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ testname,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ fname,\ \textcolor{keywordtype}{long}\ lineno)\ \{}
\DoxyCodeLine{00021\ \ \ \textcolor{keywordflow}{if}\ (!(\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}}))\ \{}
\DoxyCodeLine{00022\ \ \ \ \ \mbox{\hyperlink{testhelper_8h_ad4ec5aab9b62fbbe9b8fc2d8ac0a5989}{failed}}++;}
\DoxyCodeLine{00023\ \ \ \ \ \mbox{\hyperlink{printf_8h_a9f315126362cae9675de1642105e631e}{fprintf}}(stderr,\textcolor{stringliteral}{"{}\(\backslash\)n\ \ FAILED:\ \%s:\ \%s:\%ld\(\backslash\)n"{}},\ testname,\ fname,\ lineno);}
\DoxyCodeLine{00024\ \ \ \ \ \textcolor{comment}{/*\ exit(1);\ */}}
\DoxyCodeLine{00025\ \ \ \}}
\DoxyCodeLine{00026\ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00027\ \ \ \ \ \mbox{\hyperlink{testhelper_8h_a047ea0d874e6802b9b6d08f6b50248e5}{ok}}++;}
\DoxyCodeLine{00028\ \ \ \ \ \mbox{\hyperlink{printf_8h_a9f315126362cae9675de1642105e631e}{fprintf}}(stderr,\ \textcolor{stringliteral}{"{}ok.\(\backslash\)n"{}});}
\DoxyCodeLine{00029\ \ \ \}}
\DoxyCodeLine{00030\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00031\ \}}
\DoxyCodeLine{00032\ }
\DoxyCodeLine{00033\ \textcolor{preprocessor}{\#define\ CHECK\_BODY(name)\ \(\backslash\)}}
\DoxyCodeLine{00034\ \textcolor{preprocessor}{\ \ fprintf(stderr,"{}test:\ \%s...\ \ "{},\ name\ );\ \(\backslash\)}}
\DoxyCodeLine{00035\ \textcolor{preprocessor}{\ \ errno\ =\ 0;\ \(\backslash\)}}
\DoxyCodeLine{00036\ \textcolor{preprocessor}{\ \ for(bool\ done\ =\ false,\ result\ =\ true;\ !done;\ done\ =\ check\_result(result,name,\_\_FILE\_\_,\_\_LINE\_\_))}}
\DoxyCodeLine{00037\ }
\DoxyCodeLine{00038\ \textcolor{preprocessor}{\#define\ CHECK(name,expr)\ \ \ \ \ \ CHECK\_BODY(name)\{\ result\ =\ (expr);\ \}}}
\DoxyCodeLine{00039\ }
\DoxyCodeLine{00040\ \textcolor{comment}{//\ Print\ summary\ of\ test.\ Return\ value\ can\ be\ directly\ use\ as\ a\ return\ value\ for\ main().}}
\DoxyCodeLine{00041\ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{testhelper_8h_a5d41ed26e8668a460369ed1e1e48418d}{print\_test\_summary}}(\textcolor{keywordtype}{void})}
\DoxyCodeLine{00042\ \{}
\DoxyCodeLine{00043\ \ \ \mbox{\hyperlink{printf_8h_a9f315126362cae9675de1642105e631e}{fprintf}}(stderr,\textcolor{stringliteral}{"{}\(\backslash\)n\(\backslash\)n-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\(\backslash\)n"{}}}
\DoxyCodeLine{00044\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}succeeded:\ \%i\(\backslash\)n"{}}}
\DoxyCodeLine{00045\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}failed\ \ \ :\ \%i\(\backslash\)n\(\backslash\)n"{}},\ \mbox{\hyperlink{testhelper_8h_a047ea0d874e6802b9b6d08f6b50248e5}{ok}},\ \mbox{\hyperlink{testhelper_8h_ad4ec5aab9b62fbbe9b8fc2d8ac0a5989}{failed}});}
\DoxyCodeLine{00046\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{testhelper_8h_ad4ec5aab9b62fbbe9b8fc2d8ac0a5989}{failed}};}
\DoxyCodeLine{00047\ \}}
\DoxyCodeLine{00048\ }
\DoxyCodeLine{00049\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ TESTHELPER\_H\_}}

\end{DoxyCode}
