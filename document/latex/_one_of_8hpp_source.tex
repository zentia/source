\doxysection{One\+Of.\+hpp}
\hypertarget{_one_of_8hpp_source}{}\label{_one_of_8hpp_source}\index{external/reflect-\/cpp/include/rfl/OneOf.hpp@{external/reflect-\/cpp/include/rfl/OneOf.hpp}}
\mbox{\hyperlink{_one_of_8hpp}{浏览该文件的文档.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#ifndef\ RFL\_ONEOF\_HPP\_}}
\DoxyCodeLine{00002\ \textcolor{preprocessor}{\#define\ RFL\_ONEOF\_HPP\_}}
\DoxyCodeLine{00003\ }
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#include\ <sstream>}}
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#include\ <string>}}
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#include\ <utility>}}
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#include\ <vector>}}
\DoxyCodeLine{00008\ }
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{_result_8hpp}{Result.hpp}}"{}}}
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{_validation_type_8hpp}{parsing/schema/ValidationType.hpp}}"{}}}
\DoxyCodeLine{00011\ }
\DoxyCodeLine{00012\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespacerfl}{rfl}}\ \{}
\DoxyCodeLine{00013\ }
\DoxyCodeLine{00015\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class\ }\mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}},\ \textcolor{keyword}{class}...\ Cs>}
\DoxyCodeLine{00016\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structrfl_1_1_one_of}{OneOf}}\ \{}
\DoxyCodeLine{00017\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ T>}
\DoxyCodeLine{00018\ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{classrfl_1_1_result}{rfl::Result<T>}}\ \mbox{\hyperlink{structrfl_1_1_one_of_a990a71346e228fed1951962f3cd612dd}{validate}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}}\&\ \_value)\ \textcolor{keyword}{noexcept}\ \{}
\DoxyCodeLine{00019\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structrfl_1_1_one_of_a4762c75f3b6f74f0268968af79f7145d}{validate\_impl}}<\mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}},\ \mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}},\ Cs...>(\_value,\ \{\});}
\DoxyCodeLine{00020\ \ \ \}}
\DoxyCodeLine{00021\ }
\DoxyCodeLine{00022\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ T>}
\DoxyCodeLine{00023\ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{structrfl_1_1parsing_1_1schema_1_1_validation_type}{parsing::schema::ValidationType}}\ \mbox{\hyperlink{structrfl_1_1_one_of_a23d0bdd705aba3055c271a99574618f0}{to\_schema}}()\ \{}
\DoxyCodeLine{00024\ \ \ \ \ \textcolor{keyword}{using\ }ValidationType\ =\ \mbox{\hyperlink{structrfl_1_1parsing_1_1schema_1_1_validation_type}{parsing::schema::ValidationType}};}
\DoxyCodeLine{00025\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ \mbox{\hyperlink{test__deferred__pipelines_8cpp_aac53cc74cffcb6997a1dfb1ecce3d25b}{types}}\ =\ std::vector<ValidationType>(}
\DoxyCodeLine{00026\ \ \ \ \ \ \ \ \ \{C::template\ \mbox{\hyperlink{structrfl_1_1_one_of_a23d0bdd705aba3055c271a99574618f0}{to\_schema<T>}}(),\ Cs::template\ \mbox{\hyperlink{structrfl_1_1_one_of_a23d0bdd705aba3055c271a99574618f0}{to\_schema<T>}}()...\});}
\DoxyCodeLine{00027\ \ \ \ \ \textcolor{keywordflow}{return}\ ValidationType\{ValidationType::OneOf\{.types\_\ =\ \mbox{\hyperlink{test__deferred__pipelines_8cpp_aac53cc74cffcb6997a1dfb1ecce3d25b}{types}}\}\};}
\DoxyCodeLine{00028\ \ \ \}}
\DoxyCodeLine{00029\ }
\DoxyCodeLine{00030\ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00031\ \ \ \textcolor{keyword}{static}\ std::string\ \mbox{\hyperlink{structrfl_1_1_one_of_a0c0b00712bd304d66f76924be30577a8}{make\_error\_message}}(\textcolor{keyword}{const}\ std::vector<Error>\&\ \_errors)\ \{}
\DoxyCodeLine{00032\ \ \ \ \ std::stringstream\ stream;}
\DoxyCodeLine{00033\ \ \ \ \ stream\ <<\ \textcolor{stringliteral}{"{}Expected\ exactly\ 1\ out\ of\ "{}}\ <<\ \textcolor{keyword}{sizeof}...(Cs)\ +\ 1}
\DoxyCodeLine{00034\ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ validations\ to\ pass,\ but\ "{}}\ <<\ \textcolor{keyword}{sizeof}...(Cs)\ +\ 1\ -\/\ \_errors.size()}
\DoxyCodeLine{00035\ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ of\ them\ did.\ The\ following\ errors\ were\ generated:\ "{}};}
\DoxyCodeLine{00036\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ =\ 0;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ <\ \_errors.size();\ ++\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ \{}
\DoxyCodeLine{00037\ \ \ \ \ \ \ stream\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}}\ <<\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ +\ 1\ <<\ \textcolor{stringliteral}{"{})\ "{}}\ <<\ \_errors.at(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}).what();}
\DoxyCodeLine{00038\ \ \ \ \ \}}
\DoxyCodeLine{00039\ \ \ \ \ \textcolor{keywordflow}{return}\ stream.str();}
\DoxyCodeLine{00040\ \ \ \}}
\DoxyCodeLine{00041\ }
\DoxyCodeLine{00042\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{class\ }\mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}},\ \textcolor{keyword}{class\ }Head,\ \textcolor{keyword}{class}...\ Tail>}
\DoxyCodeLine{00043\ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{classrfl_1_1_result}{rfl::Result<T>}}\ \mbox{\hyperlink{structrfl_1_1_one_of_a4762c75f3b6f74f0268968af79f7145d}{validate\_impl}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}}\&\ \_value,}
\DoxyCodeLine{00044\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::vector<Error>\ \_errors)\ \{}
\DoxyCodeLine{00045\ \ \ \ \ \textcolor{keywordflow}{return}\ Head::validate(\_value)}
\DoxyCodeLine{00046\ \ \ \ \ \ \ \ \ .and\_then([\&](\textcolor{keyword}{auto}\&\&\ \_res)\ -\/>\ \mbox{\hyperlink{classrfl_1_1_result}{rfl::Result<T>}}\ \{}
\DoxyCodeLine{00047\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (\textcolor{keyword}{sizeof}...(Tail)\ ==\ 0)\ \{}
\DoxyCodeLine{00048\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_errors.size()\ ==\ \textcolor{keyword}{sizeof}...(Cs))\ \{}
\DoxyCodeLine{00049\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \_value;}
\DoxyCodeLine{00050\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00051\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacerfl_a6625864c6c297dfdc3d3c3ee3181dd8c}{error}}(\mbox{\hyperlink{structrfl_1_1_one_of_a0c0b00712bd304d66f76924be30577a8}{make\_error\_message}}(\_errors));}
\DoxyCodeLine{00052\ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00053\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structrfl_1_1_one_of_a4762c75f3b6f74f0268968af79f7145d}{validate\_impl}}<\mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}},\ Tail...>(\_value,\ std::move(\_errors));}
\DoxyCodeLine{00054\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00055\ \ \ \ \ \ \ \ \ \})}
\DoxyCodeLine{00056\ \ \ \ \ \ \ \ \ .or\_else([\&](\textcolor{keyword}{auto}\&\&\ \_err)\ -\/>\ \mbox{\hyperlink{classrfl_1_1_result}{rfl::Result<T>}}\ \{}
\DoxyCodeLine{00057\ \ \ \ \ \ \ \ \ \ \ \_errors.emplace\_back(std::move(\_err));}
\DoxyCodeLine{00058\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (\textcolor{keyword}{sizeof}...(Tail)\ ==\ 0)\ \{}
\DoxyCodeLine{00059\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacerfl_a6625864c6c297dfdc3d3c3ee3181dd8c}{error}}(\mbox{\hyperlink{structrfl_1_1_one_of_a0c0b00712bd304d66f76924be30577a8}{make\_error\_message}}(\_errors));}
\DoxyCodeLine{00060\ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00061\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structrfl_1_1_one_of_a4762c75f3b6f74f0268968af79f7145d}{validate\_impl}}<\mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}},\ Tail...>(\_value,\ std::move(\_errors));}
\DoxyCodeLine{00062\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00063\ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{00064\ \ \ \}}
\DoxyCodeLine{00065\ \};}
\DoxyCodeLine{00066\ }
\DoxyCodeLine{00067\ \}\ \ \textcolor{comment}{//\ namespace\ rfl}}
\DoxyCodeLine{00068\ }
\DoxyCodeLine{00069\ \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
