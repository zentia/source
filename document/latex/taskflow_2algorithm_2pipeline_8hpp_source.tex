\doxysection{pipeline.\+hpp}
\hypertarget{taskflow_2algorithm_2pipeline_8hpp_source}{}\label{taskflow_2algorithm_2pipeline_8hpp_source}\index{external/taskflow/taskflow/algorithm/pipeline.hpp@{external/taskflow/taskflow/algorithm/pipeline.hpp}}
\mbox{\hyperlink{taskflow_2algorithm_2pipeline_8hpp}{浏览该文件的文档.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00002\ }
\DoxyCodeLine{00003\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{taskflow_8hpp}{../taskflow.hpp}}"{}}}
\DoxyCodeLine{00004\ }
\DoxyCodeLine{00009\ }
\DoxyCodeLine{00010\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespacetf}{tf}}\ \{}
\DoxyCodeLine{00011\ }
\DoxyCodeLine{00012\ }
\DoxyCodeLine{00013\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00014\ \textcolor{comment}{//\ Structure\ Definition:\ DeferredPipeflow}}
\DoxyCodeLine{00015\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00016\ \textcolor{comment}{//\ For\ example:\ }}
\DoxyCodeLine{00017\ \textcolor{comment}{//\ 12.defer(7);\ 12.defer(16);}}
\DoxyCodeLine{00018\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \_\_\_\_\_}}
\DoxyCodeLine{00019\ \textcolor{comment}{//\ \ \ \ \ \ \ |\ \ \ \ \ |}}
\DoxyCodeLine{00020\ \textcolor{comment}{//\ \ \ \ \ \ \ v\ \ \ \ \ |}}
\DoxyCodeLine{00021\ \textcolor{comment}{//\ 7\ \ \ \ 12\ \ \ \ 16}}
\DoxyCodeLine{00022\ \textcolor{comment}{//\ |\ \ \ \ \ \string^}}
\DoxyCodeLine{00023\ \textcolor{comment}{//\ |\_\_\_\_\ |}}
\DoxyCodeLine{00024\ \textcolor{comment}{//}}
\DoxyCodeLine{00025\ \textcolor{comment}{//\ DeferredPipeflow\ dpf\ of\ 12\ :}}
\DoxyCodeLine{00026\ \textcolor{comment}{//\ dpf.\_token\ =\ 12;}}
\DoxyCodeLine{00027\ \textcolor{comment}{//\ dpf.\_num\_deferrals\ =\ 1;}}
\DoxyCodeLine{00028\ \textcolor{comment}{//\ dpf.\_dependents\ =\ std::list<size\_t>\{7,16\};}}
\DoxyCodeLine{00029\ \textcolor{comment}{//\ dpf.\_dependent\_satellites\ has\ following\ two\ entries}}
\DoxyCodeLine{00030\ \textcolor{comment}{//\ \{key:\ 7,\ value:\ dpf.\_dependents.begin()\}\ }}
\DoxyCodeLine{00031\ \textcolor{comment}{//\ \{key:\ 16,\ value:\ dpf.\_dependents.begin()+1\}}}
\DoxyCodeLine{00032\ \textcolor{comment}{//}}
\DoxyCodeLine{00034\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classtf_1_1_deferred_pipeflow_a0d872e94c733f69a25814f21f2e96791}{DeferredPipeflow}}\ \{}
\DoxyCodeLine{00035\ }
\DoxyCodeLine{00036\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}...\ Ps>}
\DoxyCodeLine{00037\ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classtf_1_1_deferred_pipeflow_af65467c6cb27f4ef42522207f03ab9cf}{Pipeline}};}
\DoxyCodeLine{00038\ \ \ }
\DoxyCodeLine{00039\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ P>}
\DoxyCodeLine{00040\ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classtf_1_1_deferred_pipeflow_af64ddb98831b893b2388af2a2302acea}{ScalablePipeline}};}
\DoxyCodeLine{00041\ \ \ }
\DoxyCodeLine{00042\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00043\ \ \ }
\DoxyCodeLine{00044\ \ \ \ \ \mbox{\hyperlink{classtf_1_1_deferred_pipeflow_a0d872e94c733f69a25814f21f2e96791}{DeferredPipeflow}}()\ =\ \textcolor{keywordflow}{default};}
\DoxyCodeLine{00045\ \ \ \ \ \mbox{\hyperlink{classtf_1_1_deferred_pipeflow_af7901bf11f47c8a18f4a975f9c3310b5}{DeferredPipeflow}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtf_1_1_deferred_pipeflow_a0d872e94c733f69a25814f21f2e96791}{DeferredPipeflow}}\&)\ =\ \textcolor{keyword}{delete};}
\DoxyCodeLine{00046\ \ \ \ \ \mbox{\hyperlink{classtf_1_1_deferred_pipeflow_af73af50f0d304ec6b51219c9f2f9babc}{DeferredPipeflow}}(\mbox{\hyperlink{classtf_1_1_deferred_pipeflow_a0d872e94c733f69a25814f21f2e96791}{DeferredPipeflow}}\&\&)\ =\ \textcolor{keyword}{delete};}
\DoxyCodeLine{00047\ \ \ }
\DoxyCodeLine{00048\ \ \ \ \ \mbox{\hyperlink{classtf_1_1_deferred_pipeflow_a2f54d8b4097235501de465000490e5d8}{DeferredPipeflow}}(\textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{boing_8c_a87accd1af8e0aff4b818d891374f7cec}{t}},\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}},\ std::unordered\_set<size\_t>\&\&\ dep)\ :\ }
\DoxyCodeLine{00049\ \ \ \ \ \ \ \mbox{\hyperlink{classtf_1_1_deferred_pipeflow_a980f82b352812b6113679176ae86cd06}{\_token}}\{\mbox{\hyperlink{boing_8c_a87accd1af8e0aff4b818d891374f7cec}{t}}\},\ \mbox{\hyperlink{classtf_1_1_deferred_pipeflow_af1c058902aa45aab8441df9ae6d3a8e8}{\_num\_deferrals}}\{\mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}\},\ \mbox{\hyperlink{classtf_1_1_deferred_pipeflow_ae6b4ab057aefe7b7dac6925f64026c9b}{\_dependents}}\{\mbox{\hyperlink{namespacestd}{std}}::move(dep)\}\ \{}
\DoxyCodeLine{00050\ \ \ \ \ \}}
\DoxyCodeLine{00051\ \ \ }
\DoxyCodeLine{00052\ \ \ \ \ \mbox{\hyperlink{classtf_1_1_deferred_pipeflow_a0d872e94c733f69a25814f21f2e96791}{DeferredPipeflow}}\&\ \mbox{\hyperlink{classtf_1_1_deferred_pipeflow_ae14d1b94bd45a08cd888632563efd459}{operator\ =\ }}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtf_1_1_deferred_pipeflow_a0d872e94c733f69a25814f21f2e96791}{DeferredPipeflow}}\&)\ =\ \textcolor{keyword}{delete};}
\DoxyCodeLine{00053\ \ \ \ \ \mbox{\hyperlink{classtf_1_1_deferred_pipeflow_a0d872e94c733f69a25814f21f2e96791}{DeferredPipeflow}}\&\ \mbox{\hyperlink{classtf_1_1_deferred_pipeflow_ae14d1b94bd45a08cd888632563efd459}{operator\ =\ }}(\mbox{\hyperlink{classtf_1_1_deferred_pipeflow_a0d872e94c733f69a25814f21f2e96791}{DeferredPipeflow}}\&\&)\ =\ \textcolor{keyword}{delete};}
\DoxyCodeLine{00054\ \ \ }
\DoxyCodeLine{00055\ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00056\ \ \ }
\DoxyCodeLine{00057\ \ \ \ \ \textcolor{comment}{//\ token\ id}}
\DoxyCodeLine{00058\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classtf_1_1_deferred_pipeflow_a980f82b352812b6113679176ae86cd06}{\_token}};}
\DoxyCodeLine{00059\ \ \ }
\DoxyCodeLine{00060\ \ \ \ \ \textcolor{comment}{//\ number\ of\ deferrals}}
\DoxyCodeLine{00061\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classtf_1_1_deferred_pipeflow_af1c058902aa45aab8441df9ae6d3a8e8}{\_num\_deferrals}};\ \ }
\DoxyCodeLine{00062\ \ \ }
\DoxyCodeLine{00063\ \ \ \ \ \textcolor{comment}{//\ dependents}}
\DoxyCodeLine{00064\ \ \ \ \ \textcolor{comment}{//\ For\ example,}}
\DoxyCodeLine{00065\ \ \ \ \ \textcolor{comment}{//\ 12.defer(7);\ 12.defer(16)}}
\DoxyCodeLine{00066\ \ \ \ \ \textcolor{comment}{//\ \_dependents\ =\ \{7,\ 16\}}}
\DoxyCodeLine{00067\ \ \ \ \ std::unordered\_set<size\_t>\ \mbox{\hyperlink{classtf_1_1_deferred_pipeflow_ae6b4ab057aefe7b7dac6925f64026c9b}{\_dependents}};}
\DoxyCodeLine{00068\ \};}
\DoxyCodeLine{00069\ }
\DoxyCodeLine{00070\ }
\DoxyCodeLine{00071\ }
\DoxyCodeLine{00072\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00073\ \textcolor{comment}{//\ Class\ Definition:\ Pipeflow}}
\DoxyCodeLine{00074\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00075\ }
\DoxyCodeLine{00102\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classtf_1_1_pipeflow_a801877443f7046b9e450160c05c26d7d}{Pipeflow}}\ \{}
\DoxyCodeLine{00103\ }
\DoxyCodeLine{00104\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}...\ Ps>}
\DoxyCodeLine{00105\ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classtf_1_1_pipeflow_af65467c6cb27f4ef42522207f03ab9cf}{Pipeline}};}
\DoxyCodeLine{00106\ }
\DoxyCodeLine{00107\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ P>}
\DoxyCodeLine{00108\ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classtf_1_1_pipeflow_af64ddb98831b893b2388af2a2302acea}{ScalablePipeline}};}
\DoxyCodeLine{00109\ }
\DoxyCodeLine{00110\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}...\ Ps>}
\DoxyCodeLine{00111\ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classtf_1_1_pipeflow_a576c05629fadf8120eb4db27cf28e659}{DataPipeline}};}
\DoxyCodeLine{00112\ }
\DoxyCodeLine{00113\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00114\ }
\DoxyCodeLine{00118\ \ \ \mbox{\hyperlink{classtf_1_1_pipeflow_a801877443f7046b9e450160c05c26d7d}{Pipeflow}}()\ =\ \textcolor{keywordflow}{default};}
\DoxyCodeLine{00119\ }
\DoxyCodeLine{00123\ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classtf_1_1_pipeflow_afee054e6a99965d4b3e36ff903227e6c}{line}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00124\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classtf_1_1_pipeflow_a082a1a549ab50360c7e6e55a0fd4477f}{\_line}};}
\DoxyCodeLine{00125\ \ \ \}}
\DoxyCodeLine{00126\ }
\DoxyCodeLine{00130\ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classtf_1_1_pipeflow_a4914c1f381a3016e98285b019cf60d6d}{pipe}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00131\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classtf_1_1_pipeflow_a597744cac4ef0dd9e31e1d694f71f7ec}{\_pipe}};}
\DoxyCodeLine{00132\ \ \ \}}
\DoxyCodeLine{00133\ }
\DoxyCodeLine{00137\ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classtf_1_1_pipeflow_a295e5d884665c076f4ef5d78139f7c51}{token}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00138\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classtf_1_1_pipeflow_a16275ecab224bf1ede060d9e24b4eb48}{\_token}};}
\DoxyCodeLine{00139\ \ \ \}}
\DoxyCodeLine{00140\ }
\DoxyCodeLine{00147\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtf_1_1_pipeflow_a830b7f204cb87fff17e8d424918d9453}{stop}}()\ \{}
\DoxyCodeLine{00148\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classtf_1_1_pipeflow_a597744cac4ef0dd9e31e1d694f71f7ec}{\_pipe}}\ !=\ 0)\ \{}
\DoxyCodeLine{00149\ \ \ \ \ \ \ \mbox{\hyperlink{error_8hpp_aecd66f17d01de60aeb9cae992c9dd4bf}{TF\_THROW}}(\textcolor{stringliteral}{"{}only\ the\ first\ pipe\ can\ stop\ the\ token"{}});}
\DoxyCodeLine{00150\ \ \ \ \ \}}
\DoxyCodeLine{00151\ \ \ \ \ \mbox{\hyperlink{classtf_1_1_pipeflow_a7474a98aa648d96011df53b085d53965}{\_stop}}\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00152\ \ \ \}}
\DoxyCodeLine{00153\ }
\DoxyCodeLine{00157\ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classtf_1_1_pipeflow_a2f909c75e15b6bdf83faf2c0b74c7a74}{num\_deferrals}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00158\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classtf_1_1_pipeflow_a669318dadb120d96c277529670a02588}{\_num\_deferrals}};}
\DoxyCodeLine{00159\ \ \ \}}
\DoxyCodeLine{00160\ }
\DoxyCodeLine{00167\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtf_1_1_pipeflow_a5fbd2326b68a69826423bf0528a7c961}{defer}}(\textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classtf_1_1_pipeflow_a295e5d884665c076f4ef5d78139f7c51}{token}})\ \{}
\DoxyCodeLine{00168\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classtf_1_1_pipeflow_a597744cac4ef0dd9e31e1d694f71f7ec}{\_pipe}}\ !=\ 0)\ \{}
\DoxyCodeLine{00169\ \ \ \ \ \ \ \mbox{\hyperlink{error_8hpp_aecd66f17d01de60aeb9cae992c9dd4bf}{TF\_THROW}}(\textcolor{stringliteral}{"{}only\ the\ first\ pipe\ can\ defer\ the\ current\ scheduling\ token"{}});}
\DoxyCodeLine{00170\ \ \ \ \ \}}
\DoxyCodeLine{00171\ \ \ \ \ \mbox{\hyperlink{classtf_1_1_pipeflow_a444746d10472b56b8e6cb52fd35e3d84}{\_dependents}}.insert(\mbox{\hyperlink{classtf_1_1_pipeflow_a295e5d884665c076f4ef5d78139f7c51}{token}});}
\DoxyCodeLine{00172\ \ \ \}}
\DoxyCodeLine{00173\ \ \ }
\DoxyCodeLine{00174\ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00175\ }
\DoxyCodeLine{00176\ \ \ \textcolor{comment}{//\ Regular\ data}}
\DoxyCodeLine{00177\ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classtf_1_1_pipeflow_a082a1a549ab50360c7e6e55a0fd4477f}{\_line}};}
\DoxyCodeLine{00178\ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classtf_1_1_pipeflow_a597744cac4ef0dd9e31e1d694f71f7ec}{\_pipe}};}
\DoxyCodeLine{00179\ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classtf_1_1_pipeflow_a16275ecab224bf1ede060d9e24b4eb48}{\_token}};}
\DoxyCodeLine{00180\ \ \ \textcolor{keywordtype}{bool}\ \ \ \mbox{\hyperlink{classtf_1_1_pipeflow_a7474a98aa648d96011df53b085d53965}{\_stop}};}
\DoxyCodeLine{00181\ \ \ }
\DoxyCodeLine{00182\ \ \ \textcolor{comment}{//\ Data\ field\ for\ token\ dependencies}}
\DoxyCodeLine{00183\ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classtf_1_1_pipeflow_a669318dadb120d96c277529670a02588}{\_num\_deferrals}};\ }
\DoxyCodeLine{00184\ \ \ std::unordered\_set<size\_t>\ \mbox{\hyperlink{classtf_1_1_pipeflow_a444746d10472b56b8e6cb52fd35e3d84}{\_dependents}};\ }
\DoxyCodeLine{00185\ }
\DoxyCodeLine{00186\ \};}
\DoxyCodeLine{00187\ }
\DoxyCodeLine{00188\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00189\ \textcolor{comment}{//\ Class\ Definition:\ PipeType}}
\DoxyCodeLine{00190\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00191\ }
\DoxyCodeLine{00197\ \textcolor{keyword}{enum\ class}\ \mbox{\hyperlink{namespacetf_abb7a11e41fd457f69e7ff45d4c769564}{PipeType}}\ :\ \textcolor{keywordtype}{int}\ \{}
\DoxyCodeLine{00199\ \ \ \mbox{\hyperlink{namespacetf_abb7a11e41fd457f69e7ff45d4c769564adf13a99b035d6f0bce4f44ab18eec8eb}{PARALLEL}}\ =\ 1,}
\DoxyCodeLine{00201\ \ \ \mbox{\hyperlink{namespacetf_abb7a11e41fd457f69e7ff45d4c769564a7b804a28d6154ab8007287532037f1d0}{SERIAL}}\ \ \ =\ 2}
\DoxyCodeLine{00202\ \};}
\DoxyCodeLine{00203\ }
\DoxyCodeLine{00204\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00205\ \textcolor{comment}{//\ Class\ Definition:\ Pipe}}
\DoxyCodeLine{00206\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00207\ }
\DoxyCodeLine{00227\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ C\ =\ std::function<\textcolor{keywordtype}{void}(tf::Pipeflow\&)>>}
\DoxyCodeLine{00228\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classtf_1_1_pipe_ad2c372074ba5daacb54811cb48141570}{Pipe}}\ \{}
\DoxyCodeLine{00229\ }
\DoxyCodeLine{00230\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}...\ Ps>}
\DoxyCodeLine{00231\ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classtf_1_1_pipe_af65467c6cb27f4ef42522207f03ab9cf}{Pipeline}};}
\DoxyCodeLine{00232\ }
\DoxyCodeLine{00233\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ P>}
\DoxyCodeLine{00234\ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classtf_1_1_pipe_af64ddb98831b893b2388af2a2302acea}{ScalablePipeline}};}
\DoxyCodeLine{00235\ }
\DoxyCodeLine{00236\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00237\ }
\DoxyCodeLine{00241\ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{classtf_1_1_pipe_aa3d034d90bc01d42d9dd55f82de1da2a}{callable\_t}}\ =\ \mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}};}
\DoxyCodeLine{00242\ }
\DoxyCodeLine{00246\ \ \ \mbox{\hyperlink{classtf_1_1_pipe_ad2c372074ba5daacb54811cb48141570}{Pipe}}()\ =\ \textcolor{keywordflow}{default};}
\DoxyCodeLine{00247\ }
\DoxyCodeLine{00265\ \ \ \mbox{\hyperlink{classtf_1_1_pipe_aebe1462048fa147ad8328fb13577cdf2}{Pipe}}(\mbox{\hyperlink{namespacetf_abb7a11e41fd457f69e7ff45d4c769564}{PipeType}}\ \mbox{\hyperlink{ittnotify__static_8h_a5f135fd1e66a03efd5275434478e0d97}{d}},\ \mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}}\&\&\ \mbox{\hyperlink{classtf_1_1_pipe_a43da5ae4ba56e35e4d0a705f7fa25686}{callable}})\ :}
\DoxyCodeLine{00266\ \ \ \ \ \mbox{\hyperlink{classtf_1_1_pipe_a2cb97697921ad55788a1d88feb338c8b}{\_type}}\{\mbox{\hyperlink{ittnotify__static_8h_a5f135fd1e66a03efd5275434478e0d97}{d}}\},\ \mbox{\hyperlink{classtf_1_1_pipe_a0337e2bbcf5cf7e204951a489dee7c30}{\_callable}}\{\mbox{\hyperlink{namespacestd}{std}}::forward<\mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}}>(\mbox{\hyperlink{classtf_1_1_pipe_a43da5ae4ba56e35e4d0a705f7fa25686}{callable}})\}\ \{}
\DoxyCodeLine{00267\ \ \ \}}
\DoxyCodeLine{00268\ }
\DoxyCodeLine{00274\ \ \ \mbox{\hyperlink{namespacetf_abb7a11e41fd457f69e7ff45d4c769564}{PipeType}}\ \mbox{\hyperlink{classtf_1_1_pipe_a0a8ad99dbb66ad0bca766da47ef11b21}{type}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00275\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classtf_1_1_pipe_a2cb97697921ad55788a1d88feb338c8b}{\_type}};}
\DoxyCodeLine{00276\ \ \ \}}
\DoxyCodeLine{00277\ }
\DoxyCodeLine{00283\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtf_1_1_pipe_ad939617c84a9e97ef1dd56ad56b84e33}{type}}(\mbox{\hyperlink{namespacetf_abb7a11e41fd457f69e7ff45d4c769564}{PipeType}}\ \mbox{\hyperlink{classtf_1_1_pipe_a0a8ad99dbb66ad0bca766da47ef11b21}{type}})\ \{}
\DoxyCodeLine{00284\ \ \ \ \ \mbox{\hyperlink{classtf_1_1_pipe_a2cb97697921ad55788a1d88feb338c8b}{\_type}}\ =\ \mbox{\hyperlink{classtf_1_1_pipe_a0a8ad99dbb66ad0bca766da47ef11b21}{type}};}
\DoxyCodeLine{00285\ \ \ \}}
\DoxyCodeLine{00286\ }
\DoxyCodeLine{00295\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ U>}
\DoxyCodeLine{00296\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtf_1_1_pipe_a43da5ae4ba56e35e4d0a705f7fa25686}{callable}}(U\&\&\ \mbox{\hyperlink{classtf_1_1_pipe_a43da5ae4ba56e35e4d0a705f7fa25686}{callable}})\ \{}
\DoxyCodeLine{00297\ \ \ \ \ \mbox{\hyperlink{classtf_1_1_pipe_a0337e2bbcf5cf7e204951a489dee7c30}{\_callable}}\ =\ std::forward<U>(\mbox{\hyperlink{classtf_1_1_pipe_a43da5ae4ba56e35e4d0a705f7fa25686}{callable}});}
\DoxyCodeLine{00298\ \ \ \}}
\DoxyCodeLine{00299\ }
\DoxyCodeLine{00300\ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00301\ }
\DoxyCodeLine{00302\ \ \ \mbox{\hyperlink{namespacetf_abb7a11e41fd457f69e7ff45d4c769564}{PipeType}}\ \mbox{\hyperlink{classtf_1_1_pipe_a2cb97697921ad55788a1d88feb338c8b}{\_type}};}
\DoxyCodeLine{00303\ }
\DoxyCodeLine{00304\ \ \ \mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}}\ \mbox{\hyperlink{classtf_1_1_pipe_a0337e2bbcf5cf7e204951a489dee7c30}{\_callable}};}
\DoxyCodeLine{00305\ \};}
\DoxyCodeLine{00306\ }
\DoxyCodeLine{00307\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00308\ \textcolor{comment}{//\ Class\ Definition:\ Pipeline}}
\DoxyCodeLine{00309\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00310\ }
\DoxyCodeLine{00403\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}...\ Ps>}
\DoxyCodeLine{00404\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classtf_1_1_pipeline_aad8735676e4f9fd8474ad1ac51b58f3e}{Pipeline}}\ \{}
\DoxyCodeLine{00405\ }
\DoxyCodeLine{00406\ \ \ \textcolor{keyword}{static\_assert}(\textcolor{keyword}{sizeof}...(Ps)>0,\ \textcolor{stringliteral}{"{}must\ have\ at\ least\ one\ pipe"{}});}
\DoxyCodeLine{00407\ }
\DoxyCodeLine{00411\ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structtf_1_1_pipeline_1_1_line}{Line}}\ \{}
\DoxyCodeLine{00412\ \ \ \ \ std::atomic<size\_t>\ \mbox{\hyperlink{structtf_1_1_pipeline_1_1_line_ae1ac04cb91bb360639e4e384e201011f}{join\_counter}};}
\DoxyCodeLine{00413\ \ \ \};}
\DoxyCodeLine{00414\ }
\DoxyCodeLine{00418\ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structtf_1_1_pipeline_1_1_pipe_meta}{PipeMeta}}\ \{}
\DoxyCodeLine{00419\ \ \ \ \ \mbox{\hyperlink{namespacetf_abb7a11e41fd457f69e7ff45d4c769564}{PipeType}}\ \mbox{\hyperlink{structtf_1_1_pipeline_1_1_pipe_meta_a9ff8f29a229bba87f9e08bbc1a86bb33}{type}};}
\DoxyCodeLine{00420\ \ \ \};}
\DoxyCodeLine{00421\ }
\DoxyCodeLine{00422\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00423\ }
\DoxyCodeLine{00435\ \ \ \mbox{\hyperlink{classtf_1_1_pipeline_aad8735676e4f9fd8474ad1ac51b58f3e}{Pipeline}}(\textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classtf_1_1_pipeline_a79f066bacd6c1abd28c26d8196955e95}{num\_lines}},\ Ps\&\&...\ \mbox{\hyperlink{level1__cplx__impl_8h_a6280e894a2fd5ef320bda62ca65dcb3f}{ps}});}
\DoxyCodeLine{00436\ }
\DoxyCodeLine{00448\ \ \ \mbox{\hyperlink{classtf_1_1_pipeline_aad8735676e4f9fd8474ad1ac51b58f3e}{Pipeline}}(\textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classtf_1_1_pipeline_a79f066bacd6c1abd28c26d8196955e95}{num\_lines}},\ std::tuple<Ps...>\&\&\ \mbox{\hyperlink{level1__cplx__impl_8h_a6280e894a2fd5ef320bda62ca65dcb3f}{ps}});}
\DoxyCodeLine{00449\ }
\DoxyCodeLine{00458\ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classtf_1_1_pipeline_a79f066bacd6c1abd28c26d8196955e95}{num\_lines}}()\ const\ noexcept;}
\DoxyCodeLine{00459\ }
\DoxyCodeLine{00466\ \ \ constexpr\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classtf_1_1_pipeline_adfef0c60f8f8ace267d7cd8548457ff3}{num\_pipes}}()\ const\ noexcept;}
\DoxyCodeLine{00467\ }
\DoxyCodeLine{00475\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtf_1_1_pipeline_a311d874b98de6f0def8a7d869e8d15bd}{reset}}();}
\DoxyCodeLine{00476\ }
\DoxyCodeLine{00483\ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classtf_1_1_pipeline_a89af6714b661ded59970cac4c73b3ef9}{num\_tokens}}()\ const\ noexcept;}
\DoxyCodeLine{00484\ }
\DoxyCodeLine{00491\ \ \ \mbox{\hyperlink{classtf_1_1_graph}{Graph}}\&\ \mbox{\hyperlink{classtf_1_1_pipeline_a4320bdd8b8cf05c9aac1b9fa000e4a35}{graph}}();}
\DoxyCodeLine{00492\ }
\DoxyCodeLine{00493\ }
\DoxyCodeLine{00494\ \ \ \mbox{\hyperlink{rml__server_8cpp_a6a1d6e1a12975a4e9a0b5b952e79eaad}{private}}:}
\DoxyCodeLine{00495\ }
\DoxyCodeLine{00496\ \ \ \mbox{\hyperlink{classtf_1_1_graph}{Graph}}\ \mbox{\hyperlink{classtf_1_1_pipeline_a1e3ad41a55de7fdc1f2ad40ee49a4d4a}{\_graph}};}
\DoxyCodeLine{00497\ }
\DoxyCodeLine{00498\ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classtf_1_1_pipeline_a9d9fe0c2e30331b1f7e40d2dc3c5a76f}{\_num\_tokens}};}
\DoxyCodeLine{00499\ }
\DoxyCodeLine{00500\ \ \ \mbox{\hyperlink{namespacestd}{std}}::\mbox{\hyperlink{classtuple}{tuple}}<Ps...>\ \mbox{\hyperlink{classtf_1_1_pipeline_a442f95439871ed72fd67edab10fc77a0}{\_pipes}};}
\DoxyCodeLine{00501\ \ \ \mbox{\hyperlink{namespacestd}{std}}::\mbox{\hyperlink{sugar_8h_af6228a2253f88b2affbe0c54d8b5b321}{array}}<\mbox{\hyperlink{structtf_1_1_pipeline_1_1_pipe_meta}{PipeMeta}},\ sizeof...(Ps)>\ \mbox{\hyperlink{classtf_1_1_pipeline_a836ee5a9505f07fc032ea69563063378}{\_meta}};}
\DoxyCodeLine{00502\ \ \ \mbox{\hyperlink{namespacestd}{std}}::\mbox{\hyperlink{ppc__define_8c_add93f942eb3d18a8f8e108404869156f}{vector}}<\mbox{\hyperlink{namespacestd}{std}}::\mbox{\hyperlink{sugar_8h_af6228a2253f88b2affbe0c54d8b5b321}{array}}<\mbox{\hyperlink{structtf_1_1_pipeline_1_1_line}{Line}},\ sizeof...(Ps)>>\ \mbox{\hyperlink{classtf_1_1_pipeline_a21eaa8e9904e9ebb9a1b1ea4a1e183de}{\_lines}};}
\DoxyCodeLine{00503\ \ \ \mbox{\hyperlink{namespacestd}{std}}::\mbox{\hyperlink{ppc__define_8c_add93f942eb3d18a8f8e108404869156f}{vector}}<\mbox{\hyperlink{classtf_1_1_task}{Task}}>\ \mbox{\hyperlink{classtf_1_1_pipeline_aba0c750fa328b21fcda5cb44801d6289}{\_tasks}};}
\DoxyCodeLine{00504\ \ \ \mbox{\hyperlink{namespacestd}{std}}::\mbox{\hyperlink{ppc__define_8c_add93f942eb3d18a8f8e108404869156f}{vector}}<\mbox{\hyperlink{classtf_1_1_pipeflow}{Pipeflow}}>\ \mbox{\hyperlink{classtf_1_1_pipeline_a8d0536148e5fdd373b4ed81965498749}{\_pipeflows}};}
\DoxyCodeLine{00505\ \ \ }
\DoxyCodeLine{00506\ \ \ \textcolor{comment}{//\ queue\ of\ ready\ tokens\ (paired\ with\ their\ deferral\ times)}}
\DoxyCodeLine{00507\ \ \ \textcolor{comment}{//\ For\ example,}}
\DoxyCodeLine{00508\ \ \ \textcolor{comment}{//\ when\ 12\ does\ not\ have\ any\ dependents,}}
\DoxyCodeLine{00509\ \ \ \textcolor{comment}{//\ we\ put\ 12\ in\ \_ready\_tokens\ queue}}
\DoxyCodeLine{00510\ \ \ \textcolor{comment}{//\ Assume\ num\_deferrals\ of\ 12\ is\ 1,}}
\DoxyCodeLine{00511\ \ \ \textcolor{comment}{//\ we\ push\ pair\{12,\ 1\}\ in\ the\ queue\ }}
\DoxyCodeLine{00512\ \ \ \mbox{\hyperlink{namespacestd}{std}}::\mbox{\hyperlink{namespacequeue}{queue}}<\mbox{\hyperlink{namespacestd}{std}}::pair<\textcolor{keywordtype}{size\_t},\ \textcolor{keywordtype}{size\_t}>>\ \mbox{\hyperlink{classtf_1_1_pipeline_a10499ef31797d4db31243e6f73fb2ee8}{\_ready\_tokens}};}
\DoxyCodeLine{00513\ }
\DoxyCodeLine{00514\ \ \ \textcolor{comment}{//\ unordered\_map\ of\ token\ dependencies}}
\DoxyCodeLine{00515\ \ \ \textcolor{comment}{//\ For\ example,}}
\DoxyCodeLine{00516\ \ \ \textcolor{comment}{//\ 12.defer(16);\ 13.defer(16);}}
\DoxyCodeLine{00517\ \ \ \textcolor{comment}{//\ \_token\_dependencies\ has\ the\ following\ entry}}
\DoxyCodeLine{00518\ \ \ \textcolor{comment}{//\ \{key:\ 16,\ value:\ std::vector\{12,\ 13\}\}.}}
\DoxyCodeLine{00519\ \ \ \mbox{\hyperlink{namespacestd}{std}}::unordered\_map<\textcolor{keywordtype}{size\_t},\ \mbox{\hyperlink{namespacestd}{std}}::\mbox{\hyperlink{ppc__define_8c_add93f942eb3d18a8f8e108404869156f}{vector}}<\textcolor{keywordtype}{size\_t}>>\ \mbox{\hyperlink{classtf_1_1_pipeline_ab19a3164e7584ce1d16ecbff975421a7}{\_token\_dependencies}};}
\DoxyCodeLine{00520\ \ \ }
\DoxyCodeLine{00521\ \ \ \textcolor{comment}{//\ unordered\_map\ of\ deferred\ tokens}}
\DoxyCodeLine{00522\ \ \ \textcolor{comment}{//\ For\ example,}}
\DoxyCodeLine{00523\ \ \ \textcolor{comment}{//\ 12.defer(16);\ 13.defer(16);}}
\DoxyCodeLine{00524\ \ \ \textcolor{comment}{//\ \_deferred\_tokens\ has\ the\ following\ two\ entries}}
\DoxyCodeLine{00525\ \ \ \textcolor{comment}{//\ \{key:\ 12,\ DeferredPipeflow\ of\ 12\}\ and}}
\DoxyCodeLine{00526\ \ \ \textcolor{comment}{//\ \{key:\ 13,\ DeferredPipeflow\ of\ 13\}}}
\DoxyCodeLine{00527\ \ \ \mbox{\hyperlink{namespacestd}{std}}::unordered\_map<\textcolor{keywordtype}{size\_t},\ \mbox{\hyperlink{classtf_1_1_deferred_pipeflow}{DeferredPipeflow}}>\ \mbox{\hyperlink{classtf_1_1_pipeline_a7ff727cd8c130fc9b606c01dbfa12f9d}{\_deferred\_tokens}};}
\DoxyCodeLine{00528\ \ \ }
\DoxyCodeLine{00529\ \ \ \textcolor{comment}{//\ variable\ to\ keep\ track\ of\ the\ longest\ deferred\ tokens}}
\DoxyCodeLine{00530\ \ \ \textcolor{comment}{//\ For\ example,}}
\DoxyCodeLine{00531\ \ \ \textcolor{comment}{//\ 2.defer(16)}}
\DoxyCodeLine{00532\ \ \ \textcolor{comment}{//\ 5.defer(19)}}
\DoxyCodeLine{00533\ \ \ \textcolor{comment}{//\ 5.defer(17),}}
\DoxyCodeLine{00534\ \ \ \textcolor{comment}{//\ \_longest\_deferral\ will\ be\ 19\ -\/\ after\ token\ 19\ the\ pipeline}}
\DoxyCodeLine{00535\ \ \ \textcolor{comment}{//\ has\ almost\ zero\ cost\ on\ handling\ deferred\ pipeflow}}
\DoxyCodeLine{00536\ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classtf_1_1_pipeline_aaee01340ac6e941a949931b7e478d83e}{\_longest\_deferral}}\ =\ 0;\ \ }
\DoxyCodeLine{00537\ \ \ }
\DoxyCodeLine{00538\ \ \ template\ <\textcolor{keywordtype}{size\_t}...\ I>}
\DoxyCodeLine{00539\ \ \ auto\ \mbox{\hyperlink{classtf_1_1_pipeline_a5c0604ba81fb2c8d0ba9c076df13ddda}{\_gen\_meta}}(\mbox{\hyperlink{namespacestd}{std}}::\mbox{\hyperlink{classtuple}{tuple}}<Ps...>\&\&,\ \mbox{\hyperlink{namespacestd}{std}}::index\_sequence<I...>);}
\DoxyCodeLine{00540\ }
\DoxyCodeLine{00541\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtf_1_1_pipeline_aa2e4a635ac4469754f2d922ea67151f9}{\_on\_pipe}}(\mbox{\hyperlink{classtf_1_1_pipeflow}{Pipeflow}}\&,\ \mbox{\hyperlink{classtf_1_1_runtime}{Runtime}}\&);}
\DoxyCodeLine{00542\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtf_1_1_pipeline_ad091bbd38c1538884aa83d488fdf40f2}{\_build}}();}
\DoxyCodeLine{00543\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtf_1_1_pipeline_afb16e7472b979f81a8d997eae134e1c9}{\_check\_dependents}}(\mbox{\hyperlink{classtf_1_1_pipeflow}{Pipeflow}}\&);}
\DoxyCodeLine{00544\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtf_1_1_pipeline_a2d90bf386da24e7913b021febbcb6809}{\_construct\_deferred\_tokens}}(\mbox{\hyperlink{classtf_1_1_pipeflow}{Pipeflow}}\&);}
\DoxyCodeLine{00545\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtf_1_1_pipeline_aa69993288e9ceefed489ff0c71ed1aca}{\_resolve\_token\_dependencies}}(\mbox{\hyperlink{classtf_1_1_pipeflow}{Pipeflow}}\&);\ }
\DoxyCodeLine{00546\ \};}
\DoxyCodeLine{00547\ }
\DoxyCodeLine{00548\ \textcolor{comment}{//\ constructor}}
\DoxyCodeLine{00549\ template\ <typename...\ Ps>}
\DoxyCodeLine{00550\ \mbox{\hyperlink{classtf_1_1_pipeline_aad8735676e4f9fd8474ad1ac51b58f3e}{Pipeline}}<Ps...>::\mbox{\hyperlink{classtf_1_1_pipeline_aad8735676e4f9fd8474ad1ac51b58f3e}{Pipeline}}(\textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classtf_1_1_pipeline_a79f066bacd6c1abd28c26d8196955e95}{num\_lines}},\ Ps\&\&...\ \mbox{\hyperlink{level1__cplx__impl_8h_a6280e894a2fd5ef320bda62ca65dcb3f}{ps}})\ :}
\DoxyCodeLine{00551\ \ \ \mbox{\hyperlink{classtf_1_1_pipeline_a442f95439871ed72fd67edab10fc77a0}{\_pipes}}\ \ \ \ \ \{std::make\_tuple(std::forward<Ps>(\mbox{\hyperlink{level1__cplx__impl_8h_a6280e894a2fd5ef320bda62ca65dcb3f}{ps}})...)\},}
\DoxyCodeLine{00552\ \ \ \mbox{\hyperlink{classtf_1_1_pipeline_a836ee5a9505f07fc032ea69563063378}{\_meta}}\ \ \ \ \ \ \{PipeMeta\{\mbox{\hyperlink{level1__cplx__impl_8h_a6280e894a2fd5ef320bda62ca65dcb3f}{ps}}.type()\}...\},}
\DoxyCodeLine{00553\ \ \ \mbox{\hyperlink{classtf_1_1_pipeline_a21eaa8e9904e9ebb9a1b1ea4a1e183de}{\_lines}}\ \ \ \ \ (\mbox{\hyperlink{classtf_1_1_pipeline_a79f066bacd6c1abd28c26d8196955e95}{num\_lines}}),}
\DoxyCodeLine{00554\ \ \ \mbox{\hyperlink{classtf_1_1_pipeline_aba0c750fa328b21fcda5cb44801d6289}{\_tasks}}\ \ \ \ \ (\mbox{\hyperlink{classtf_1_1_pipeline_a79f066bacd6c1abd28c26d8196955e95}{num\_lines}}\ +\ 1),}
\DoxyCodeLine{00555\ \ \ \mbox{\hyperlink{classtf_1_1_pipeline_a8d0536148e5fdd373b4ed81965498749}{\_pipeflows}}\ (\mbox{\hyperlink{classtf_1_1_pipeline_a79f066bacd6c1abd28c26d8196955e95}{num\_lines}})\ \{}
\DoxyCodeLine{00556\ }
\DoxyCodeLine{00557\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classtf_1_1_pipeline_a79f066bacd6c1abd28c26d8196955e95}{num\_lines}}\ ==\ 0)\ \{}
\DoxyCodeLine{00558\ \ \ \ \ \mbox{\hyperlink{error_8hpp_aecd66f17d01de60aeb9cae992c9dd4bf}{TF\_THROW}}(\textcolor{stringliteral}{"{}must\ have\ at\ least\ one\ line"{}});}
\DoxyCodeLine{00559\ \ \ \}}
\DoxyCodeLine{00560\ }
\DoxyCodeLine{00561\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{namespacestd_aae41d8280b7ccc3f0e0a0be2dab21c8f}{std::get<0>}}(\mbox{\hyperlink{classtf_1_1_pipeline_a442f95439871ed72fd67edab10fc77a0}{\_pipes}}).\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ae8396ff85d63082521e3324820df1009}{type}}()\ !=\ \mbox{\hyperlink{namespacetf_abb7a11e41fd457f69e7ff45d4c769564a7b804a28d6154ab8007287532037f1d0}{PipeType::SERIAL}})\ \{}
\DoxyCodeLine{00562\ \ \ \ \ \mbox{\hyperlink{error_8hpp_aecd66f17d01de60aeb9cae992c9dd4bf}{TF\_THROW}}(\textcolor{stringliteral}{"{}first\ pipe\ must\ be\ serial"{}});}
\DoxyCodeLine{00563\ \ \ \}}
\DoxyCodeLine{00564\ }
\DoxyCodeLine{00565\ \ \ \mbox{\hyperlink{classtf_1_1_pipeline_a311d874b98de6f0def8a7d869e8d15bd}{reset}}();}
\DoxyCodeLine{00566\ \ \ \mbox{\hyperlink{classtf_1_1_pipeline_ad091bbd38c1538884aa83d488fdf40f2}{\_build}}();}
\DoxyCodeLine{00567\ \}}
\DoxyCodeLine{00568\ }
\DoxyCodeLine{00569\ \textcolor{comment}{//\ constructor}}
\DoxyCodeLine{00570\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}...\ Ps>}
\DoxyCodeLine{00571\ \mbox{\hyperlink{classtf_1_1_pipeline_aad8735676e4f9fd8474ad1ac51b58f3e}{Pipeline<Ps...>::Pipeline}}(\textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classtf_1_1_pipeline_a79f066bacd6c1abd28c26d8196955e95}{num\_lines}},\ std::tuple<Ps...>\&\&\ \mbox{\hyperlink{level1__cplx__impl_8h_a6280e894a2fd5ef320bda62ca65dcb3f}{ps}})\ :}
\DoxyCodeLine{00572\ \ \ \mbox{\hyperlink{classtf_1_1_pipeline_a442f95439871ed72fd67edab10fc77a0}{\_pipes}}\ \ \ \ \ \{\mbox{\hyperlink{namespacestd}{std}}::forward<\mbox{\hyperlink{namespacestd}{std}}::\mbox{\hyperlink{classtuple}{tuple}}<Ps...>>(\mbox{\hyperlink{level1__cplx__impl_8h_a6280e894a2fd5ef320bda62ca65dcb3f}{ps}})\},}
\DoxyCodeLine{00573\ \ \ \mbox{\hyperlink{classtf_1_1_pipeline_a836ee5a9505f07fc032ea69563063378}{\_meta}}\ \ \ \ \ \ \{\mbox{\hyperlink{classtf_1_1_pipeline_a5c0604ba81fb2c8d0ba9c076df13ddda}{\_gen\_meta}}(}
\DoxyCodeLine{00574\ \ \ \ \ \mbox{\hyperlink{namespacestd}{std}}::forward<\mbox{\hyperlink{namespacestd}{std}}::\mbox{\hyperlink{classtuple}{tuple}}<Ps...>>(\mbox{\hyperlink{level1__cplx__impl_8h_a6280e894a2fd5ef320bda62ca65dcb3f}{ps}}),\ \mbox{\hyperlink{namespacestd}{std}}::make\_index\_sequence<sizeof...(Ps)>\{\}}
\DoxyCodeLine{00575\ \ \ )\},}
\DoxyCodeLine{00576\ \ \ \_lines\ \ \ \ \ (num\_lines),}
\DoxyCodeLine{00577\ \ \ \_tasks\ \ \ \ \ (num\_lines\ +\ 1),}
\DoxyCodeLine{00578\ \ \ \_pipeflows\ (num\_lines)\ \{}
\DoxyCodeLine{00579\ }
\DoxyCodeLine{00580\ \ \ \textcolor{keywordflow}{if}(num\_lines\ ==\ 0)\ \{}
\DoxyCodeLine{00581\ \ \ \ \ \mbox{\hyperlink{error_8hpp_aecd66f17d01de60aeb9cae992c9dd4bf}{TF\_THROW}}(\textcolor{stringliteral}{"{}must\ have\ at\ least\ one\ line"{}});}
\DoxyCodeLine{00582\ \ \ \}}
\DoxyCodeLine{00583\ }
\DoxyCodeLine{00584\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{namespacestd_aae41d8280b7ccc3f0e0a0be2dab21c8f}{std::get<0>}}(\_pipes).\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ae8396ff85d63082521e3324820df1009}{type}}()\ !=\ PipeType::SERIAL)\ \{}
\DoxyCodeLine{00585\ \ \ \ \ \mbox{\hyperlink{error_8hpp_aecd66f17d01de60aeb9cae992c9dd4bf}{TF\_THROW}}(\textcolor{stringliteral}{"{}first\ pipe\ must\ be\ serial"{}});}
\DoxyCodeLine{00586\ \ \ \}}
\DoxyCodeLine{00587\ }
\DoxyCodeLine{00588\ \ \ reset();}
\DoxyCodeLine{00589\ \ \ \_build();}
\DoxyCodeLine{00590\ \}}
\DoxyCodeLine{00591\ }
\DoxyCodeLine{00592\ \textcolor{comment}{//\ Function:\ \_get\_meta}}
\DoxyCodeLine{00593\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}...\ Ps>}
\DoxyCodeLine{00594\ \textcolor{keyword}{template}\ <\textcolor{keywordtype}{size\_t}...\ I>}
\DoxyCodeLine{00595\ \textcolor{keyword}{auto}\ \mbox{\hyperlink{classtf_1_1_pipeline_a5c0604ba81fb2c8d0ba9c076df13ddda}{Pipeline<Ps...>::\_gen\_meta}}(std::tuple<Ps...>\&\&\ \mbox{\hyperlink{level1__cplx__impl_8h_a6280e894a2fd5ef320bda62ca65dcb3f}{ps}},\ std::index\_sequence<I...>)\ \{}
\DoxyCodeLine{00596\ \ \ \textcolor{keywordflow}{return}\ std::array\{\mbox{\hyperlink{structtf_1_1_pipeline_1_1_pipe_meta}{PipeMeta}}\{\mbox{\hyperlink{namespacestd_aae41d8280b7ccc3f0e0a0be2dab21c8f}{std::get<I>}}(\mbox{\hyperlink{level1__cplx__impl_8h_a6280e894a2fd5ef320bda62ca65dcb3f}{ps}}).type()\}...\};}
\DoxyCodeLine{00597\ \}}
\DoxyCodeLine{00598\ }
\DoxyCodeLine{00599\ \textcolor{comment}{//\ Function:\ num\_lines}}
\DoxyCodeLine{00600\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}...\ Ps>}
\DoxyCodeLine{00601\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classtf_1_1_pipeline_a79f066bacd6c1abd28c26d8196955e95}{Pipeline<Ps...>::num\_lines}}()\ const\ noexcept\ \{}
\DoxyCodeLine{00602\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classtf_1_1_pipeline_a8d0536148e5fdd373b4ed81965498749}{\_pipeflows}}.size();}
\DoxyCodeLine{00603\ \}}
\DoxyCodeLine{00604\ }
\DoxyCodeLine{00605\ \textcolor{comment}{//\ Function:\ num\_pipes}}
\DoxyCodeLine{00606\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}...\ Ps>}
\DoxyCodeLine{00607\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classtf_1_1_pipeline_adfef0c60f8f8ace267d7cd8548457ff3}{Pipeline<Ps...>::num\_pipes}}()\ const\ noexcept\ \{}
\DoxyCodeLine{00608\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{sizeof}...(Ps);}
\DoxyCodeLine{00609\ \}}
\DoxyCodeLine{00610\ }
\DoxyCodeLine{00611\ \textcolor{comment}{//\ Function:\ num\_tokens}}
\DoxyCodeLine{00612\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}...\ Ps>}
\DoxyCodeLine{00613\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classtf_1_1_pipeline_a89af6714b661ded59970cac4c73b3ef9}{Pipeline<Ps...>::num\_tokens}}()\ const\ noexcept\ \{}
\DoxyCodeLine{00614\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classtf_1_1_pipeline_a9d9fe0c2e30331b1f7e40d2dc3c5a76f}{\_num\_tokens}};}
\DoxyCodeLine{00615\ \}}
\DoxyCodeLine{00616\ }
\DoxyCodeLine{00617\ \textcolor{comment}{//\ Function:\ graph}}
\DoxyCodeLine{00618\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}...\ Ps>}
\DoxyCodeLine{00619\ \mbox{\hyperlink{classtf_1_1_graph}{Graph}}\&\ \mbox{\hyperlink{classtf_1_1_pipeline_a4320bdd8b8cf05c9aac1b9fa000e4a35}{Pipeline<Ps...>::graph}}()\ \{}
\DoxyCodeLine{00620\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classtf_1_1_pipeline_a1e3ad41a55de7fdc1f2ad40ee49a4d4a}{\_graph}};}
\DoxyCodeLine{00621\ \}}
\DoxyCodeLine{00622\ }
\DoxyCodeLine{00623\ \textcolor{comment}{//\ Function:\ reset}}
\DoxyCodeLine{00624\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}...\ Ps>}
\DoxyCodeLine{00625\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtf_1_1_pipeline_a311d874b98de6f0def8a7d869e8d15bd}{Pipeline<Ps...>::reset}}()\ \{}
\DoxyCodeLine{00626\ }
\DoxyCodeLine{00627\ \ \ \mbox{\hyperlink{classtf_1_1_pipeline_a9d9fe0c2e30331b1f7e40d2dc3c5a76f}{\_num\_tokens}}\ =\ 0;}
\DoxyCodeLine{00628\ }
\DoxyCodeLine{00629\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ l\ =\ 0;\ l<\mbox{\hyperlink{classtf_1_1_pipeline_a79f066bacd6c1abd28c26d8196955e95}{num\_lines}}();\ l++)\ \{}
\DoxyCodeLine{00630\ \ \ \ \ \mbox{\hyperlink{classtf_1_1_pipeline_a8d0536148e5fdd373b4ed81965498749}{\_pipeflows}}[l].\_pipe\ =\ 0;}
\DoxyCodeLine{00631\ \ \ \ \ \mbox{\hyperlink{classtf_1_1_pipeline_a8d0536148e5fdd373b4ed81965498749}{\_pipeflows}}[l].\_line\ =\ l;}
\DoxyCodeLine{00632\ \ \ \ \ }
\DoxyCodeLine{00633\ \ \ \ \ \mbox{\hyperlink{classtf_1_1_pipeline_a8d0536148e5fdd373b4ed81965498749}{\_pipeflows}}[l].\_num\_deferrals\ =\ 0;}
\DoxyCodeLine{00634\ \ \ \ \ \mbox{\hyperlink{classtf_1_1_pipeline_a8d0536148e5fdd373b4ed81965498749}{\_pipeflows}}[l].\_dependents.clear();}
\DoxyCodeLine{00635\ \ \ \}}
\DoxyCodeLine{00636\ \ \ }
\DoxyCodeLine{00637\ \ \ assert(\mbox{\hyperlink{classtf_1_1_pipeline_a10499ef31797d4db31243e6f73fb2ee8}{\_ready\_tokens}}.empty()\ ==\ \textcolor{keyword}{true});}
\DoxyCodeLine{00638\ \ \ \mbox{\hyperlink{classtf_1_1_pipeline_ab19a3164e7584ce1d16ecbff975421a7}{\_token\_dependencies}}.clear();}
\DoxyCodeLine{00639\ \ \ \mbox{\hyperlink{classtf_1_1_pipeline_a7ff727cd8c130fc9b606c01dbfa12f9d}{\_deferred\_tokens}}.clear();}
\DoxyCodeLine{00640\ }
\DoxyCodeLine{00641\ \ \ \mbox{\hyperlink{classtf_1_1_pipeline_a21eaa8e9904e9ebb9a1b1ea4a1e183de}{\_lines}}[0][0].join\_counter.store(0,\ std::memory\_order\_relaxed);}
\DoxyCodeLine{00642\ }
\DoxyCodeLine{00643\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ l=1;\ l<\mbox{\hyperlink{classtf_1_1_pipeline_a79f066bacd6c1abd28c26d8196955e95}{num\_lines}}();\ l++)\ \{}
\DoxyCodeLine{00644\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{cxx11__tensor__map_8cpp_a7f507fea02198f6cb81c86640c7b1a4e}{f}}=1;\ \mbox{\hyperlink{cxx11__tensor__map_8cpp_a7f507fea02198f6cb81c86640c7b1a4e}{f}}<\mbox{\hyperlink{classtf_1_1_pipeline_adfef0c60f8f8ace267d7cd8548457ff3}{num\_pipes}}();\ \mbox{\hyperlink{cxx11__tensor__map_8cpp_a7f507fea02198f6cb81c86640c7b1a4e}{f}}++)\ \{}
\DoxyCodeLine{00645\ \ \ \ \ \ \ \mbox{\hyperlink{classtf_1_1_pipeline_a21eaa8e9904e9ebb9a1b1ea4a1e183de}{\_lines}}[l][\mbox{\hyperlink{cxx11__tensor__map_8cpp_a7f507fea02198f6cb81c86640c7b1a4e}{f}}].join\_counter.store(}
\DoxyCodeLine{00646\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{size\_t}\textcolor{keyword}{>}(\mbox{\hyperlink{classtf_1_1_pipeline_a836ee5a9505f07fc032ea69563063378}{\_meta}}[\mbox{\hyperlink{cxx11__tensor__map_8cpp_a7f507fea02198f6cb81c86640c7b1a4e}{f}}].\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ae8396ff85d63082521e3324820df1009}{type}}),\ std::memory\_order\_relaxed}
\DoxyCodeLine{00647\ \ \ \ \ \ \ );}
\DoxyCodeLine{00648\ \ \ \ \ \}}
\DoxyCodeLine{00649\ \ \ \}}
\DoxyCodeLine{00650\ }
\DoxyCodeLine{00651\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{cxx11__tensor__map_8cpp_a7f507fea02198f6cb81c86640c7b1a4e}{f}}=1;\ \mbox{\hyperlink{cxx11__tensor__map_8cpp_a7f507fea02198f6cb81c86640c7b1a4e}{f}}<\mbox{\hyperlink{classtf_1_1_pipeline_adfef0c60f8f8ace267d7cd8548457ff3}{num\_pipes}}();\ \mbox{\hyperlink{cxx11__tensor__map_8cpp_a7f507fea02198f6cb81c86640c7b1a4e}{f}}++)\ \{}
\DoxyCodeLine{00652\ \ \ \ \ \mbox{\hyperlink{classtf_1_1_pipeline_a21eaa8e9904e9ebb9a1b1ea4a1e183de}{\_lines}}[0][\mbox{\hyperlink{cxx11__tensor__map_8cpp_a7f507fea02198f6cb81c86640c7b1a4e}{f}}].join\_counter.store(1,\ std::memory\_order\_relaxed);}
\DoxyCodeLine{00653\ \ \ \}}
\DoxyCodeLine{00654\ }
\DoxyCodeLine{00655\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ l=1;\ l<\mbox{\hyperlink{classtf_1_1_pipeline_a79f066bacd6c1abd28c26d8196955e95}{num\_lines}}();\ l++)\ \{}
\DoxyCodeLine{00656\ \ \ \ \ \mbox{\hyperlink{classtf_1_1_pipeline_a21eaa8e9904e9ebb9a1b1ea4a1e183de}{\_lines}}[l][0].join\_counter.store(}
\DoxyCodeLine{00657\ \ \ \ \ \ \ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{size\_t}\textcolor{keyword}{>}(\mbox{\hyperlink{classtf_1_1_pipeline_a836ee5a9505f07fc032ea69563063378}{\_meta}}[0].\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ae8396ff85d63082521e3324820df1009}{type}})\ -\/\ 1,\ std::memory\_order\_relaxed}
\DoxyCodeLine{00658\ \ \ \ \ );}
\DoxyCodeLine{00659\ \ \ \}}
\DoxyCodeLine{00660\ \}}
\DoxyCodeLine{00661\ }
\DoxyCodeLine{00662\ \textcolor{comment}{//\ Procedure:\ \_on\_pipe}}
\DoxyCodeLine{00663\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}...\ Ps>}
\DoxyCodeLine{00664\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtf_1_1_pipeline_aa2e4a635ac4469754f2d922ea67151f9}{Pipeline<Ps...>::\_on\_pipe}}(\mbox{\hyperlink{classtf_1_1_pipeflow}{Pipeflow}}\&\ pf,\ \mbox{\hyperlink{classtf_1_1_runtime}{Runtime}}\&\ rt)\ \{}
\DoxyCodeLine{00665\ \ \ \mbox{\hyperlink{namespacetf_a9d16a1bfe2949da5f0751304dc4321f1}{visit\_tuple}}([\&](\textcolor{keyword}{auto}\&\&\ pipe)\{}
\DoxyCodeLine{00666\ \ \ \ \ \textcolor{keyword}{using\ }callable\_t\ =\ \textcolor{keyword}{typename}\ std::decay\_t<\textcolor{keyword}{decltype}(pipe)>::callable\_t;}
\DoxyCodeLine{00667\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_invocable\_v<callable\_t,\ Pipeflow\&>)\ \{}
\DoxyCodeLine{00668\ \ \ \ \ \ \ pipe.\_callable(pf);}
\DoxyCodeLine{00669\ \ \ \ \ \}}
\DoxyCodeLine{00670\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}(std::is\_invocable\_v<callable\_t,\ Pipeflow\&,\ Runtime\&>)\ \{}
\DoxyCodeLine{00671\ \ \ \ \ \ \ pipe.\_callable(pf,\ rt);}
\DoxyCodeLine{00672\ \ \ \ \ \}}
\DoxyCodeLine{00673\ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00674\ \ \ \ \ \ \ \textcolor{keyword}{static\_assert}(\mbox{\hyperlink{namespacetf_a036d82b3ab21beea2ed89611e2930db7}{dependent\_false\_v<callable\_t>}},\ \textcolor{stringliteral}{"{}un-\/supported\ pipe\ callable\ type"{}});}
\DoxyCodeLine{00675\ \ \ \ \ \}}
\DoxyCodeLine{00676\ \ \ \},\ \mbox{\hyperlink{classtf_1_1_pipeline_a442f95439871ed72fd67edab10fc77a0}{\_pipes}},\ pf.\mbox{\hyperlink{classtf_1_1_pipeflow_a597744cac4ef0dd9e31e1d694f71f7ec}{\_pipe}});}
\DoxyCodeLine{00677\ \}}
\DoxyCodeLine{00678\ }
\DoxyCodeLine{00679\ \textcolor{comment}{//\ Procedure:\ \_check\_dependents}}
\DoxyCodeLine{00680\ \textcolor{comment}{//\ Check\ and\ remove\ invalid\ dependents\ after\ on\_pipe}}
\DoxyCodeLine{00681\ \textcolor{comment}{//\ For\ example,\ users\ may\ defer\ a\ pipeflow\ to\ multiple\ tokens,}}
\DoxyCodeLine{00682\ \textcolor{comment}{//\ and\ we\ need\ to\ remove\ invalid\ tokens.}}
\DoxyCodeLine{00683\ \textcolor{comment}{//\ \ \ 12.defer(7);\ \ \ //\ valid\ only\ if\ 7\ is\ deferred,\ or\ invalid\ otherwise}}
\DoxyCodeLine{00684\ \textcolor{comment}{//\ \ \ 12.defer(16);\ \ //\ 16\ is\ valid\ }}
\DoxyCodeLine{00685\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}...\ Ps>}
\DoxyCodeLine{00686\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtf_1_1_pipeline_afb16e7472b979f81a8d997eae134e1c9}{Pipeline<Ps...>::\_check\_dependents}}(\mbox{\hyperlink{classtf_1_1_pipeflow}{Pipeflow}}\&\ pf)\ \{}
\DoxyCodeLine{00687\ \ \ \textcolor{comment}{//if\ (pf.\_dependents.size())\ \{}}
\DoxyCodeLine{00688\ \ \ ++pf.\mbox{\hyperlink{classtf_1_1_pipeflow_a669318dadb120d96c277529670a02588}{\_num\_deferrals}};}
\DoxyCodeLine{00689\ \ \ }
\DoxyCodeLine{00690\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ it\ =\ pf.\mbox{\hyperlink{classtf_1_1_pipeflow_a444746d10472b56b8e6cb52fd35e3d84}{\_dependents}}.begin();\ it\ !=\ pf.\mbox{\hyperlink{classtf_1_1_pipeflow_a444746d10472b56b8e6cb52fd35e3d84}{\_dependents}}.end();)\ \{}
\DoxyCodeLine{00691\ \ }
\DoxyCodeLine{00692\ \ \ \ \ \textcolor{comment}{//\ valid\ (e.g.,\ 12.defer(16))\ }}
\DoxyCodeLine{00693\ \ \ \ \ \textcolor{keywordflow}{if}\ (*it\ >=\ \mbox{\hyperlink{classtf_1_1_pipeline_a9d9fe0c2e30331b1f7e40d2dc3c5a76f}{\_num\_tokens}})\ \{}
\DoxyCodeLine{00694\ \ \ \ \ \ \ \mbox{\hyperlink{classtf_1_1_pipeline_ab19a3164e7584ce1d16ecbff975421a7}{\_token\_dependencies}}[*it].push\_back(pf.\mbox{\hyperlink{classtf_1_1_pipeflow_a16275ecab224bf1ede060d9e24b4eb48}{\_token}});}
\DoxyCodeLine{00695\ \ \ \ \ \ \ \mbox{\hyperlink{classtf_1_1_pipeline_aaee01340ac6e941a949931b7e478d83e}{\_longest\_deferral}}\ =\ std::max(\mbox{\hyperlink{classtf_1_1_pipeline_aaee01340ac6e941a949931b7e478d83e}{\_longest\_deferral}},\ *it);}
\DoxyCodeLine{00696\ \ \ \ \ \ \ ++it;}
\DoxyCodeLine{00697\ \ \ \ \ \}}
\DoxyCodeLine{00698\ \ \ \ \ \textcolor{comment}{//\ valid\ or\ invalid\ (e.g.,\ 12.defer(7))}}
\DoxyCodeLine{00699\ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00700\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ pit\ =\ \mbox{\hyperlink{classtf_1_1_pipeline_a7ff727cd8c130fc9b606c01dbfa12f9d}{\_deferred\_tokens}}.find(*it);}
\DoxyCodeLine{00701\ \ \ \ \ \ \ }
\DoxyCodeLine{00702\ \ \ \ \ \ \ \textcolor{comment}{//\ valid\ (e.g.,\ 7\ is\ deferred)}}
\DoxyCodeLine{00703\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (pit\ !=\ \mbox{\hyperlink{classtf_1_1_pipeline_a7ff727cd8c130fc9b606c01dbfa12f9d}{\_deferred\_tokens}}.end())\ \{}
\DoxyCodeLine{00704\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classtf_1_1_pipeline_ab19a3164e7584ce1d16ecbff975421a7}{\_token\_dependencies}}[*it].push\_back(pf.\mbox{\hyperlink{classtf_1_1_pipeflow_a16275ecab224bf1ede060d9e24b4eb48}{\_token}});}
\DoxyCodeLine{00705\ \ \ \ \ \ \ \ \ ++it;}
\DoxyCodeLine{00706\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00707\ }
\DoxyCodeLine{00708\ \ \ \ \ \ \ \textcolor{comment}{//\ invalid\ (e.g.,\ 7\ is\ finished\ -\/\ this\ this\ 12.defer(7)\ is\ dummy)}}
\DoxyCodeLine{00709\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00710\ \ \ \ \ \ \ \ \ it\ =\ pf.\mbox{\hyperlink{classtf_1_1_pipeflow_a444746d10472b56b8e6cb52fd35e3d84}{\_dependents}}.erase(it);}
\DoxyCodeLine{00711\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00712\ \ \ \ \ \}}
\DoxyCodeLine{00713\ \ \ \}}
\DoxyCodeLine{00714\ \}}
\DoxyCodeLine{00715\ }
\DoxyCodeLine{00716\ \textcolor{comment}{//\ Procedure:\ \_construct\_deferred\_tokens}}
\DoxyCodeLine{00717\ \textcolor{comment}{//\ Construct\ a\ data\ structure\ for\ a\ deferred\ token}}
\DoxyCodeLine{00718\ \textcolor{comment}{//\ }}
\DoxyCodeLine{00719\ \textcolor{comment}{//\ For\ example,\ }}
\DoxyCodeLine{00720\ \textcolor{comment}{//\ 12.defer(7);\ 12.defer(16);}}
\DoxyCodeLine{00721\ \textcolor{comment}{//\ After\ \_check\_dependents,\ 12\ needs\ to\ be\ deferred,}}
\DoxyCodeLine{00722\ \textcolor{comment}{//\ so\ we\ will\ construct\ a\ data\ structure\ for\ 12\ using\ hashmap:}}
\DoxyCodeLine{00723\ \textcolor{comment}{//\ \{key:\ 12,\ value:\ DeferredPipeflow\ of\ 12\}}}
\DoxyCodeLine{00724\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}...\ Ps>}
\DoxyCodeLine{00725\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtf_1_1_pipeline_a2d90bf386da24e7913b021febbcb6809}{Pipeline<Ps...>::\_construct\_deferred\_tokens}}(\mbox{\hyperlink{classtf_1_1_pipeflow}{Pipeflow}}\&\ pf)\ \{}
\DoxyCodeLine{00726\ \ \ }
\DoxyCodeLine{00727\ \ \ \textcolor{comment}{//auto\ res\ =\ \_deferred\_tokens.emplace(}}
\DoxyCodeLine{00728\ \ \ \textcolor{comment}{//\ \ pf.\_token,\ DeferredPipeflow\{pf.\_token,\ pf.\_num\_deferrals,\ std::move(pf.\_dependents)\}}}
\DoxyCodeLine{00729\ \ \ \textcolor{comment}{//);}}
\DoxyCodeLine{00730\ \ \ }
\DoxyCodeLine{00731\ \ \ \textcolor{comment}{//\ construct\ the\ deferred\ pipeflow\ with\ zero\ copy}}
\DoxyCodeLine{00732\ \ \ \textcolor{comment}{//auto\ res\ =\ \_deferred\_tokens.emplace(}}
\DoxyCodeLine{00733\ \ \ \mbox{\hyperlink{classtf_1_1_pipeline_a7ff727cd8c130fc9b606c01dbfa12f9d}{\_deferred\_tokens}}.emplace(}
\DoxyCodeLine{00734\ \ \ \ \ std::piecewise\_construct,}
\DoxyCodeLine{00735\ \ \ \ \ std::forward\_as\_tuple(pf.\mbox{\hyperlink{classtf_1_1_pipeflow_a16275ecab224bf1ede060d9e24b4eb48}{\_token}}),}
\DoxyCodeLine{00736\ \ \ \ \ std::forward\_as\_tuple(}
\DoxyCodeLine{00737\ \ \ \ \ \ \ pf.\mbox{\hyperlink{classtf_1_1_pipeflow_a16275ecab224bf1ede060d9e24b4eb48}{\_token}},\ pf.\mbox{\hyperlink{classtf_1_1_pipeflow_a669318dadb120d96c277529670a02588}{\_num\_deferrals}},\ std::move(pf.\mbox{\hyperlink{classtf_1_1_pipeflow_a444746d10472b56b8e6cb52fd35e3d84}{\_dependents}})}
\DoxyCodeLine{00738\ \ \ \ \ )}
\DoxyCodeLine{00739\ \ \ );}
\DoxyCodeLine{00740\ }
\DoxyCodeLine{00741\ \ \ \textcolor{comment}{//assert(res.second\ ==\ true);}}
\DoxyCodeLine{00742\ \}}
\DoxyCodeLine{00743\ }
\DoxyCodeLine{00744\ \textcolor{comment}{//\ Procedure:\ \_resolve\_token\_dependencies}}
\DoxyCodeLine{00745\ \textcolor{comment}{//\ Resolve\ dependencies\ for\ tokens\ that\ defer\ to\ current\ token}}
\DoxyCodeLine{00746\ \textcolor{comment}{//\ }}
\DoxyCodeLine{00747\ \textcolor{comment}{//\ For\ example,}}
\DoxyCodeLine{00748\ \textcolor{comment}{//\ 12.defer(16);}}
\DoxyCodeLine{00749\ \textcolor{comment}{//\ 13.defer(16);}}
\DoxyCodeLine{00750\ \textcolor{comment}{//\ \_token\_dependencies\ will\ have\ the\ entry}}
\DoxyCodeLine{00751\ \textcolor{comment}{//\ \{key:\ 16,\ value:\ std::vector\{12,\ 13\}\}\ }}
\DoxyCodeLine{00752\ \textcolor{comment}{//}}
\DoxyCodeLine{00753\ \textcolor{comment}{//\ When\ 16\ finishes,\ we\ need\ to\ remove\ 16\ from\ 12's\ and\ 13's\ }}
\DoxyCodeLine{00754\ \textcolor{comment}{//\ individual\_dependents}}
\DoxyCodeLine{00755\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}...\ Ps>}
\DoxyCodeLine{00756\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtf_1_1_pipeline_aa69993288e9ceefed489ff0c71ed1aca}{Pipeline<Ps...>::\_resolve\_token\_dependencies}}(\mbox{\hyperlink{classtf_1_1_pipeflow}{Pipeflow}}\&\ pf)\ \{}
\DoxyCodeLine{00757\ }
\DoxyCodeLine{00758\ \ \ \textcolor{keywordflow}{if}\ (\textcolor{keyword}{auto}\ it\ =\ \mbox{\hyperlink{classtf_1_1_pipeline_ab19a3164e7584ce1d16ecbff975421a7}{\_token\_dependencies}}.find(pf.\mbox{\hyperlink{classtf_1_1_pipeflow_a16275ecab224bf1ede060d9e24b4eb48}{\_token}});}
\DoxyCodeLine{00759\ \ \ \ \ \ \ it\ !=\ \mbox{\hyperlink{classtf_1_1_pipeline_ab19a3164e7584ce1d16ecbff975421a7}{\_token\_dependencies}}.end())\ \{}
\DoxyCodeLine{00760\ \ \ \ \ }
\DoxyCodeLine{00761\ \ \ \ \ \textcolor{comment}{//\ iterate\ tokens\ that\ defer\ to\ pf.\_token}}
\DoxyCodeLine{00762\ \ \ \ \ \textcolor{comment}{//\ (e.g.,\ 12\ and\ 13)}}
\DoxyCodeLine{00763\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ target\ :\ it-\/>second)\ \{}
\DoxyCodeLine{00764\ }
\DoxyCodeLine{00765\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ dpf\ =\ \mbox{\hyperlink{classtf_1_1_pipeline_a7ff727cd8c130fc9b606c01dbfa12f9d}{\_deferred\_tokens}}.find(target);}
\DoxyCodeLine{00766\ }
\DoxyCodeLine{00767\ \ \ \ \ \ \ assert(dpf\ !=\ \mbox{\hyperlink{classtf_1_1_pipeline_a7ff727cd8c130fc9b606c01dbfa12f9d}{\_deferred\_tokens}}.end());}
\DoxyCodeLine{00768\ }
\DoxyCodeLine{00769\ \ \ \ \ \ \ \textcolor{comment}{//\ erase\ pf.\_token\ from\ target's\ \_dependents}}
\DoxyCodeLine{00770\ \ \ \ \ \ \ \textcolor{comment}{//\ (e.g.,\ remove\ 16\ from\ 12's\ dependents)}}
\DoxyCodeLine{00771\ \ \ \ \ \ \ dpf-\/>second.\_dependents.erase(pf.\mbox{\hyperlink{classtf_1_1_pipeflow_a16275ecab224bf1ede060d9e24b4eb48}{\_token}});}
\DoxyCodeLine{00772\ \ \ \ \ \ \ \textcolor{comment}{//\ \ dpf-\/>second.\_dependent\_satellites[pf.\_token]}}
\DoxyCodeLine{00773\ \ \ \ \ \ \ \textcolor{comment}{//);}}
\DoxyCodeLine{00774\ }
\DoxyCodeLine{00775\ \ \ \ \ \ \ \textcolor{comment}{//\ target\ has\ no\ dependents}}
\DoxyCodeLine{00776\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (dpf-\/>second.\_dependents.empty())\ \{}
\DoxyCodeLine{00777\ }
\DoxyCodeLine{00778\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ push\ target\ into\ \_ready\_tokens\ queue}}
\DoxyCodeLine{00779\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classtf_1_1_pipeline_a10499ef31797d4db31243e6f73fb2ee8}{\_ready\_tokens}}.emplace(dpf-\/>second.\_token,\ dpf-\/>second.\_num\_deferrals);}
\DoxyCodeLine{00780\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\_ready\_tokens.push(}}
\DoxyCodeLine{00781\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ \ std::make\_pair(dpf-\/>second.\_token,\ dpf-\/>second.\_num\_deferrals)}}
\DoxyCodeLine{00782\ \ \ \ \ \ \ \ \ \textcolor{comment}{//);}}
\DoxyCodeLine{00783\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00784\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ erase\ target\ from\ \_deferred\_tokens}}
\DoxyCodeLine{00785\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classtf_1_1_pipeline_a7ff727cd8c130fc9b606c01dbfa12f9d}{\_deferred\_tokens}}.erase(dpf);}
\DoxyCodeLine{00786\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00787\ \ \ \ \ \}}
\DoxyCodeLine{00788\ }
\DoxyCodeLine{00789\ \ \ \ \ \textcolor{comment}{//\ remove\ pf.\_token\ from\ \_token\_dependencies}}
\DoxyCodeLine{00790\ \ \ \ \ \textcolor{comment}{//\ (e.g.,\ remove\ the\ entry}}
\DoxyCodeLine{00791\ \ \ \ \ \textcolor{comment}{//\ \{key:\ 16,\ value:\ std::vector\{12,\ 13\}\}\ from\ \_token\_dependencies)}}
\DoxyCodeLine{00792\ \ \ \ \ \mbox{\hyperlink{classtf_1_1_pipeline_ab19a3164e7584ce1d16ecbff975421a7}{\_token\_dependencies}}.erase(it);}
\DoxyCodeLine{00793\ \ \ \}}
\DoxyCodeLine{00794\ \}}
\DoxyCodeLine{00795\ }
\DoxyCodeLine{00796\ \textcolor{comment}{//\ Procedure:\ \_build}}
\DoxyCodeLine{00797\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}...\ Ps>}
\DoxyCodeLine{00798\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtf_1_1_pipeline_ad091bbd38c1538884aa83d488fdf40f2}{Pipeline<Ps...>::\_build}}()\ \{}
\DoxyCodeLine{00799\ }
\DoxyCodeLine{00800\ \ \ \textcolor{keyword}{using\ namespace\ }std::literals::string\_literals;}
\DoxyCodeLine{00801\ }
\DoxyCodeLine{00802\ \ \ \mbox{\hyperlink{classtf_1_1_flow_builder}{FlowBuilder}}\ fb(\mbox{\hyperlink{classtf_1_1_pipeline_a1e3ad41a55de7fdc1f2ad40ee49a4d4a}{\_graph}});}
\DoxyCodeLine{00803\ }
\DoxyCodeLine{00804\ \ \ \textcolor{comment}{//\ init\ task}}
\DoxyCodeLine{00805\ \ \ \mbox{\hyperlink{classtf_1_1_pipeline_aba0c750fa328b21fcda5cb44801d6289}{\_tasks}}[0]\ =\ fb.\mbox{\hyperlink{classtf_1_1_flow_builder_a60d7a666cab71ecfa3010b2efb0d6b57}{emplace}}([\textcolor{keyword}{this}]()\ \{}
\DoxyCodeLine{00806\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(\mbox{\hyperlink{classtf_1_1_pipeline_a9d9fe0c2e30331b1f7e40d2dc3c5a76f}{\_num\_tokens}}\ \%\ \mbox{\hyperlink{classtf_1_1_pipeline_a79f066bacd6c1abd28c26d8196955e95}{num\_lines}}());}
\DoxyCodeLine{00807\ \ \ \}).\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aab18cfce5ee7c6881ae04f18be70d94a}{name}}(\textcolor{stringliteral}{"{}cond"{}});}
\DoxyCodeLine{00808\ }
\DoxyCodeLine{00809\ \ \ \textcolor{comment}{//\ line\ task}}
\DoxyCodeLine{00810\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ l\ =\ 0;\ l\ <\ \mbox{\hyperlink{classtf_1_1_pipeline_a79f066bacd6c1abd28c26d8196955e95}{num\_lines}}();\ l++)\ \{}
\DoxyCodeLine{00811\ }
\DoxyCodeLine{00812\ \ \ \ \ \mbox{\hyperlink{classtf_1_1_pipeline_aba0c750fa328b21fcda5cb44801d6289}{\_tasks}}[l\ +\ 1]\ =\ fb.\mbox{\hyperlink{classtf_1_1_flow_builder_a60d7a666cab71ecfa3010b2efb0d6b57}{emplace}}([\textcolor{keyword}{this},\ l]\ (\mbox{\hyperlink{classtf_1_1_runtime}{tf::Runtime}}\&\ rt)\ \textcolor{keyword}{mutable}\ \{}
\DoxyCodeLine{00813\ }
\DoxyCodeLine{00814\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ pf\ =\ \&\mbox{\hyperlink{classtf_1_1_pipeline_a8d0536148e5fdd373b4ed81965498749}{\_pipeflows}}[l];}
\DoxyCodeLine{00815\ }
\DoxyCodeLine{00816\ \ \ \ \ \ \ pipeline:}
\DoxyCodeLine{00817\ }
\DoxyCodeLine{00818\ \ \ \ \ \ \ \mbox{\hyperlink{classtf_1_1_pipeline_a21eaa8e9904e9ebb9a1b1ea4a1e183de}{\_lines}}[pf-\/>\_line][pf-\/>\_pipe].join\_counter.store(}
\DoxyCodeLine{00819\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{size\_t}\textcolor{keyword}{>}(\mbox{\hyperlink{classtf_1_1_pipeline_a836ee5a9505f07fc032ea69563063378}{\_meta}}[pf-\/>\_pipe].type),\ std::memory\_order\_relaxed}
\DoxyCodeLine{00820\ \ \ \ \ \ \ );}
\DoxyCodeLine{00821\ \ \ \ \ \ \ }
\DoxyCodeLine{00822\ \ \ \ \ \ \ \textcolor{comment}{//\ First\ pipe\ does\ all\ jobs\ of\ initialization\ and\ token\ dependencies}}
\DoxyCodeLine{00823\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (pf-\/>\_pipe\ ==\ 0)\ \{}
\DoxyCodeLine{00824\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ \_ready\_tokens\ queue\ is\ not\ empty}}
\DoxyCodeLine{00825\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ substitute\ pf\ with\ the\ token\ at\ the\ front\ of\ the\ queue}}
\DoxyCodeLine{00826\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classtf_1_1_pipeline_a10499ef31797d4db31243e6f73fb2ee8}{\_ready\_tokens}}.empty())\ \{}
\DoxyCodeLine{00827\ \ \ \ \ \ \ \ \ \ \ pf-\/>\_token\ =\ \mbox{\hyperlink{classtf_1_1_pipeline_a10499ef31797d4db31243e6f73fb2ee8}{\_ready\_tokens}}.front().first;}
\DoxyCodeLine{00828\ \ \ \ \ \ \ \ \ \ \ pf-\/>\_num\_deferrals\ =\ \mbox{\hyperlink{classtf_1_1_pipeline_a10499ef31797d4db31243e6f73fb2ee8}{\_ready\_tokens}}.front().second;}
\DoxyCodeLine{00829\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classtf_1_1_pipeline_a10499ef31797d4db31243e6f73fb2ee8}{\_ready\_tokens}}.pop();}
\DoxyCodeLine{00830\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00831\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00832\ \ \ \ \ \ \ \ \ \ \ pf-\/>\_token\ =\ \mbox{\hyperlink{classtf_1_1_pipeline_a9d9fe0c2e30331b1f7e40d2dc3c5a76f}{\_num\_tokens}};}
\DoxyCodeLine{00833\ \ \ \ \ \ \ \ \ \ \ pf-\/>\_num\_deferrals\ =\ 0;}
\DoxyCodeLine{00834\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00835\ \ \ \ \ \ \ }
\DoxyCodeLine{00836\ \ \ \ \ \ \ handle\_token\_dependency:\ }
\DoxyCodeLine{00837\ }
\DoxyCodeLine{00838\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (pf-\/>\_stop\ =\ \textcolor{keyword}{false},\ \mbox{\hyperlink{classtf_1_1_pipeline_aa2e4a635ac4469754f2d922ea67151f9}{\_on\_pipe}}(*pf,\ rt);\ pf-\/>\_stop\ ==\ \textcolor{keyword}{true})\ \{}
\DoxyCodeLine{00839\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ here,\ the\ pipeline\ is\ not\ stopped\ yet\ because\ other}}
\DoxyCodeLine{00840\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ lines\ of\ tasks\ may\ still\ be\ running\ their\ last\ stages}}
\DoxyCodeLine{00841\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00842\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00843\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00844\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classtf_1_1_pipeline_a9d9fe0c2e30331b1f7e40d2dc3c5a76f}{\_num\_tokens}}\ ==\ pf-\/>\_token)\ \{}
\DoxyCodeLine{00845\ \ \ \ \ \ \ \ \ \ \ ++\mbox{\hyperlink{classtf_1_1_pipeline_a9d9fe0c2e30331b1f7e40d2dc3c5a76f}{\_num\_tokens}};}
\DoxyCodeLine{00846\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00847\ \ \ \ \ \ \ }
\DoxyCodeLine{00848\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (pf-\/>\_dependents.empty()\ ==\ \textcolor{keyword}{false})\{\ }
\DoxyCodeLine{00849\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ check\ if\ the\ pf-\/>\_dependents\ have\ valid\ dependents}}
\DoxyCodeLine{00850\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classtf_1_1_pipeline_afb16e7472b979f81a8d997eae134e1c9}{\_check\_dependents}}(*pf);\ }
\DoxyCodeLine{00851\ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00852\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ tokens\ in\ pf-\/>\_dependents\ are\ all\ valid\ dependents\ }}
\DoxyCodeLine{00853\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (pf-\/>\_dependents.size())\ \{}
\DoxyCodeLine{00854\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00855\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ construct\ a\ data\ structure\ for\ pf\ in\ \_deferred\_tokens\ }}
\DoxyCodeLine{00856\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classtf_1_1_pipeline_a2d90bf386da24e7913b021febbcb6809}{\_construct\_deferred\_tokens}}(*pf);}
\DoxyCodeLine{00857\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{goto}\ pipeline;}
\DoxyCodeLine{00858\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00859\ }
\DoxyCodeLine{00860\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ tokens\ in\ pf-\/>\_dependents\ are\ invalid\ dependents}}
\DoxyCodeLine{00861\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ directly\ goto\ on\_pipe\ on\ the\ same\ line}}
\DoxyCodeLine{00862\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00863\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{goto}\ handle\_token\_dependency;}
\DoxyCodeLine{00864\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00865\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00866\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00867\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Every\ token\ within\ the\ deferral\ range\ needs\ to\ check}}
\DoxyCodeLine{00868\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ if\ it\ can\ resolve\ dependencies\ on\ other\ tokens.}}
\DoxyCodeLine{00869\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (pf-\/>\_token\ <=\ \mbox{\hyperlink{classtf_1_1_pipeline_aaee01340ac6e941a949931b7e478d83e}{\_longest\_deferral}})\ \{}
\DoxyCodeLine{00870\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classtf_1_1_pipeline_aa69993288e9ceefed489ff0c71ed1aca}{\_resolve\_token\_dependencies}}(*pf);\ }
\DoxyCodeLine{00871\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00872\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00873\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00874\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classtf_1_1_pipeline_aa2e4a635ac4469754f2d922ea67151f9}{\_on\_pipe}}(*pf,\ rt);}
\DoxyCodeLine{00875\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00876\ }
\DoxyCodeLine{00877\ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ c\_f\ =\ pf-\/>\_pipe;}
\DoxyCodeLine{00878\ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ n\_f\ =\ (pf-\/>\_pipe\ +\ 1)\ \%\ \mbox{\hyperlink{classtf_1_1_pipeline_adfef0c60f8f8ace267d7cd8548457ff3}{num\_pipes}}();}
\DoxyCodeLine{00879\ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ n\_l\ =\ (pf-\/>\_line\ +\ 1)\ \%\ \mbox{\hyperlink{classtf_1_1_pipeline_a79f066bacd6c1abd28c26d8196955e95}{num\_lines}}();}
\DoxyCodeLine{00880\ }
\DoxyCodeLine{00881\ \ \ \ \ \ \ pf-\/>\_pipe\ =\ n\_f;}
\DoxyCodeLine{00882\ }
\DoxyCodeLine{00883\ \ \ \ \ \ \ \textcolor{comment}{//\ -\/-\/-\/-\/\ scheduling\ starts\ here\ -\/-\/-\/-\/}}
\DoxyCodeLine{00884\ \ \ \ \ \ \ \textcolor{comment}{//\ Notice\ that\ the\ shared\ variable\ f\ must\ not\ be\ changed\ after\ this}}
\DoxyCodeLine{00885\ \ \ \ \ \ \ \textcolor{comment}{//\ point\ because\ it\ can\ result\ in\ data\ race\ due\ to\ the\ following}}
\DoxyCodeLine{00886\ \ \ \ \ \ \ \textcolor{comment}{//\ condition:}}
\DoxyCodeLine{00887\ \ \ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00888\ \ \ \ \ \ \ \textcolor{comment}{//\ a\ -\/>\ b}}
\DoxyCodeLine{00889\ \ \ \ \ \ \ \textcolor{comment}{//\ |\ \ \ \ |}}
\DoxyCodeLine{00890\ \ \ \ \ \ \ \textcolor{comment}{//\ v\ \ \ \ v}}
\DoxyCodeLine{00891\ \ \ \ \ \ \ \textcolor{comment}{//\ c\ -\/>\ d}}
\DoxyCodeLine{00892\ \ \ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00893\ \ \ \ \ \ \ \textcolor{comment}{//\ d\ will\ be\ spawned\ by\ either\ c\ or\ b,\ so\ if\ c\ changes\ f\ but\ b\ spawns\ d}}
\DoxyCodeLine{00894\ \ \ \ \ \ \ \textcolor{comment}{//\ then\ data\ race\ on\ f\ will\ happen}}
\DoxyCodeLine{00895\ }
\DoxyCodeLine{00896\ \ \ \ \ \ \ std::array<int,\ 2>\ retval;}
\DoxyCodeLine{00897\ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}\ =\ 0;}
\DoxyCodeLine{00898\ }
\DoxyCodeLine{00899\ \ \ \ \ \ \ \textcolor{comment}{//\ downward\ dependency}}
\DoxyCodeLine{00900\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classtf_1_1_pipeline_a836ee5a9505f07fc032ea69563063378}{\_meta}}[c\_f].\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ae8396ff85d63082521e3324820df1009}{type}}\ ==\ \mbox{\hyperlink{namespacetf_abb7a11e41fd457f69e7ff45d4c769564a7b804a28d6154ab8007287532037f1d0}{PipeType::SERIAL}}\ \&\&}
\DoxyCodeLine{00901\ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classtf_1_1_pipeline_a21eaa8e9904e9ebb9a1b1ea4a1e183de}{\_lines}}[n\_l][c\_f].join\_counter.fetch\_sub(}
\DoxyCodeLine{00902\ \ \ \ \ \ \ \ \ \ \ \ 1,\ std::memory\_order\_acq\_rel)\ ==\ 1}
\DoxyCodeLine{00903\ \ \ \ \ \ \ \ \ )\ \{}
\DoxyCodeLine{00904\ \ \ \ \ \ \ \ \ retval[\mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}++]\ =\ 1;}
\DoxyCodeLine{00905\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00906\ }
\DoxyCodeLine{00907\ \ \ \ \ \ \ \textcolor{comment}{//\ forward\ dependency}}
\DoxyCodeLine{00908\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classtf_1_1_pipeline_a21eaa8e9904e9ebb9a1b1ea4a1e183de}{\_lines}}[pf-\/>\_line][n\_f].join\_counter.fetch\_sub(}
\DoxyCodeLine{00909\ \ \ \ \ \ \ \ \ \ \ 1,\ std::memory\_order\_acq\_rel)\ ==\ 1}
\DoxyCodeLine{00910\ \ \ \ \ \ \ \ \ )\ \{}
\DoxyCodeLine{00911\ \ \ \ \ \ \ \ \ retval[\mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}++]\ =\ 0;}
\DoxyCodeLine{00912\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00913\ \ \ \ \ \ \ }
\DoxyCodeLine{00914\ \ \ \ \ \ \ \textcolor{comment}{//\ notice\ that\ the\ task\ index\ starts\ from\ 1}}
\DoxyCodeLine{00915\ \ \ \ \ \ \ \textcolor{keywordflow}{switch}(\mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}})\ \{}
\DoxyCodeLine{00916\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ 2:\ \{}
\DoxyCodeLine{00917\ \ \ \ \ \ \ \ \ \ \ rt.\mbox{\hyperlink{classtf_1_1_runtime_aa7e72cc0f298475195b252c8f1793343}{schedule}}(\mbox{\hyperlink{classtf_1_1_pipeline_aba0c750fa328b21fcda5cb44801d6289}{\_tasks}}[n\_l+1]);}
\DoxyCodeLine{00918\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{goto}\ pipeline;}
\DoxyCodeLine{00919\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00920\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ 1:\ \{}
\DoxyCodeLine{00921\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ downward\ dependency\ }}
\DoxyCodeLine{00922\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (retval[0]\ ==\ 1)\ \{}
\DoxyCodeLine{00923\ \ \ \ \ \ \ \ \ \ \ \ \ pf\ =\ \&\mbox{\hyperlink{classtf_1_1_pipeline_a8d0536148e5fdd373b4ed81965498749}{\_pipeflows}}[n\_l];}
\DoxyCodeLine{00924\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00925\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ forward\ dependency}}
\DoxyCodeLine{00926\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{goto}\ pipeline;}
\DoxyCodeLine{00927\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00928\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00929\ \ \ \ \ \}).\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aab18cfce5ee7c6881ae04f18be70d94a}{name}}(\textcolor{stringliteral}{"{}rt-\/"{}}\mbox{\hyperlink{main-override_8cpp_a1384e7608274313a9433fa573868557b}{s}}\ +\ std::to\_string(l));}
\DoxyCodeLine{00930\ }
\DoxyCodeLine{00931\ \ \ \ \ \mbox{\hyperlink{classtf_1_1_pipeline_aba0c750fa328b21fcda5cb44801d6289}{\_tasks}}[0].precede(\mbox{\hyperlink{classtf_1_1_pipeline_aba0c750fa328b21fcda5cb44801d6289}{\_tasks}}[l+1]);}
\DoxyCodeLine{00932\ \ \ \}}
\DoxyCodeLine{00933\ \}}
\DoxyCodeLine{00934\ }
\DoxyCodeLine{00935\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00936\ \textcolor{comment}{//\ Class\ Definition:\ ScalablePipeline}}
\DoxyCodeLine{00937\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00938\ }
\DoxyCodeLine{01071\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ P>}
\DoxyCodeLine{01072\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classtf_1_1_scalable_pipeline_a26f5e7e768b77f9e95100c5d6467db71}{ScalablePipeline}}\ \{}
\DoxyCodeLine{01073\ }
\DoxyCodeLine{01077\ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structtf_1_1_scalable_pipeline_1_1_line}{Line}}\ \{}
\DoxyCodeLine{01078\ \ \ \ \ std::atomic<size\_t>\ \mbox{\hyperlink{structtf_1_1_scalable_pipeline_1_1_line_a777bd19b4440c77f9abc5e63debe1874}{join\_counter}};}
\DoxyCodeLine{01079\ \ \ \};}
\DoxyCodeLine{01080\ }
\DoxyCodeLine{01081\ }
\DoxyCodeLine{01082\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{01083\ }
\DoxyCodeLine{01087\ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{classtf_1_1_scalable_pipeline_af06cc645f8a7c4797ca53e274b0c7547}{pipe\_t}}\ =\ \textcolor{keyword}{typename}\ std::iterator\_traits<P>::value\_type;}
\DoxyCodeLine{01088\ }
\DoxyCodeLine{01092\ \ \ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a26f5e7e768b77f9e95100c5d6467db71}{ScalablePipeline}}()\ =\ \textcolor{keywordflow}{default};}
\DoxyCodeLine{01093\ }
\DoxyCodeLine{01103\ \ \ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a26f5e7e768b77f9e95100c5d6467db71}{ScalablePipeline}}(\textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a5a4dd65638e8e06e35cb4c5792d044cc}{num\_lines}});}
\DoxyCodeLine{01104\ }
\DoxyCodeLine{01121\ \ \ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a26f5e7e768b77f9e95100c5d6467db71}{ScalablePipeline}}(\textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a5a4dd65638e8e06e35cb4c5792d044cc}{num\_lines}},\ \mbox{\hyperlink{namespace_p}{P}}\ first,\ \mbox{\hyperlink{namespace_p}{P}}\ last);}
\DoxyCodeLine{01122\ }
\DoxyCodeLine{01126\ \ \ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a1a8898df4d2224d5f8bd2f3ad14c0ab9}{ScalablePipeline}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a26f5e7e768b77f9e95100c5d6467db71}{ScalablePipeline}}\&)\ =\ \textcolor{keyword}{delete};}
\DoxyCodeLine{01127\ }
\DoxyCodeLine{01136\ \ \ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a26f5e7e768b77f9e95100c5d6467db71}{ScalablePipeline}}(\mbox{\hyperlink{classtf_1_1_scalable_pipeline_a26f5e7e768b77f9e95100c5d6467db71}{ScalablePipeline}}\&\&\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}});}
\DoxyCodeLine{01137\ }
\DoxyCodeLine{01141\ \ \ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a26f5e7e768b77f9e95100c5d6467db71}{ScalablePipeline}}\&\ operator\ =\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a26f5e7e768b77f9e95100c5d6467db71}{ScalablePipeline}}\&)\ =\ \textcolor{keyword}{delete};}
\DoxyCodeLine{01142\ }
\DoxyCodeLine{01151\ \ \ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a26f5e7e768b77f9e95100c5d6467db71}{ScalablePipeline}}\&\ operator\ =\ (\mbox{\hyperlink{classtf_1_1_scalable_pipeline_a26f5e7e768b77f9e95100c5d6467db71}{ScalablePipeline}}\&\&\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}});}
\DoxyCodeLine{01152\ }
\DoxyCodeLine{01161\ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a5a4dd65638e8e06e35cb4c5792d044cc}{num\_lines}}()\ const\ noexcept;}
\DoxyCodeLine{01162\ }
\DoxyCodeLine{01169\ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a70c49f5219847681133d2a226c804da1}{num\_pipes}}()\ const\ noexcept;}
\DoxyCodeLine{01170\ }
\DoxyCodeLine{01177\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a940a8de7b53ac5cbd59c55091d88c88f}{reset}}();}
\DoxyCodeLine{01178\ }
\DoxyCodeLine{01194\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a940a8de7b53ac5cbd59c55091d88c88f}{reset}}(\mbox{\hyperlink{namespace_p}{P}}\ first,\ \mbox{\hyperlink{namespace_p}{P}}\ last);}
\DoxyCodeLine{01195\ }
\DoxyCodeLine{01213\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a940a8de7b53ac5cbd59c55091d88c88f}{reset}}(\textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a5a4dd65638e8e06e35cb4c5792d044cc}{num\_lines}},\ \mbox{\hyperlink{namespace_p}{P}}\ first,\ \mbox{\hyperlink{namespace_p}{P}}\ last);}
\DoxyCodeLine{01214\ }
\DoxyCodeLine{01221\ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a693a2ea53cfac9c0b220d5b3a28e6313}{num\_tokens}}()\ const\ noexcept;}
\DoxyCodeLine{01222\ }
\DoxyCodeLine{01229\ \ \ \mbox{\hyperlink{classtf_1_1_graph}{Graph}}\&\ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a2f45a4cb7116fbe9bbc54305f13c52a8}{graph}}();}
\DoxyCodeLine{01230\ }
\DoxyCodeLine{01231\ \ \ \mbox{\hyperlink{rml__server_8cpp_a6a1d6e1a12975a4e9a0b5b952e79eaad}{private}}:}
\DoxyCodeLine{01232\ }
\DoxyCodeLine{01233\ \ \ \mbox{\hyperlink{classtf_1_1_graph}{Graph}}\ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a22fa085403161f1054f7c06004a6ae0c}{\_graph}};}
\DoxyCodeLine{01234\ }
\DoxyCodeLine{01235\ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a29cfaffe5b328370e0fc5cabe242c9c9}{\_num\_tokens}}\{0\};}
\DoxyCodeLine{01236\ }
\DoxyCodeLine{01237\ \ \ std::vector<P>\ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a207985f26c6ddf57e7c286af5576b124}{\_pipes}};}
\DoxyCodeLine{01238\ \ \ std::vector<Task>\ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a66182f2b381be1f628da346b2e47c2ab}{\_tasks}};}
\DoxyCodeLine{01239\ \ \ std::vector<Pipeflow>\ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a879b367ce62ff667d00c16c18313021c}{\_pipeflows}};}
\DoxyCodeLine{01240\ \ \ std::unique\_ptr<Line[]>\ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a2d6a310af9e3a69efaea0e8002960062}{\_lines}};}
\DoxyCodeLine{01241\ }
\DoxyCodeLine{01242\ \ \ \textcolor{comment}{//\ chchiu}}
\DoxyCodeLine{01243\ \ \ std::queue<std::pair<size\_t,\ size\_t>>\ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a18a2b6051521959ee807c4f1899ec2f3}{\_ready\_tokens}};}
\DoxyCodeLine{01244\ \ \ std::unordered\_map<size\_t,\ std::vector<size\_t>>\ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a93c0b0ee2cff99ff3cdaabbb81592744}{\_token\_dependencies}};}
\DoxyCodeLine{01245\ \ \ std::unordered\_map<size\_t,\ DeferredPipeflow>\ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_aadda92015e28c2545014f7576078bddb}{\_deferred\_tokens}};}
\DoxyCodeLine{01246\ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_aaf2267b9dbb1173f533aee5a0a250cf3}{\_longest\_deferral}}\ =\ 0;}
\DoxyCodeLine{01247\ \ \ }
\DoxyCodeLine{01248\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a3cea771eaee545d4445114c824a3f6df}{\_check\_dependents}}(\mbox{\hyperlink{classtf_1_1_pipeflow}{Pipeflow}}\&);}
\DoxyCodeLine{01249\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a4583da84f07196c55c636e3556a1e5e3}{\_construct\_deferred\_tokens}}(\mbox{\hyperlink{classtf_1_1_pipeflow}{Pipeflow}}\&);}
\DoxyCodeLine{01250\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_ad210e4d59d58c79100a830df51d55b1f}{\_resolve\_token\_dependencies}}(\mbox{\hyperlink{classtf_1_1_pipeflow}{Pipeflow}}\&);}
\DoxyCodeLine{01251\ \ \ \textcolor{comment}{//\ chchiu}}
\DoxyCodeLine{01252\ }
\DoxyCodeLine{01253\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_aea457827353fe9d73ae069daec7fa512}{\_on\_pipe}}(\mbox{\hyperlink{classtf_1_1_pipeflow}{Pipeflow}}\&,\ \mbox{\hyperlink{classtf_1_1_runtime}{Runtime}}\&);}
\DoxyCodeLine{01254\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_ae695c9b1bbe3a5f65a5bb4217087c356}{\_build}}();}
\DoxyCodeLine{01255\ }
\DoxyCodeLine{01256\ \ \ \mbox{\hyperlink{structtf_1_1_scalable_pipeline_1_1_line}{Line}}\&\ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a81b18c25db2cba4c530d85c5ab413a6c}{\_line}}(\textcolor{keywordtype}{size\_t},\ \textcolor{keywordtype}{size\_t});}
\DoxyCodeLine{01257\ \};}
\DoxyCodeLine{01258\ }
\DoxyCodeLine{01259\ \textcolor{comment}{//\ constructor}}
\DoxyCodeLine{01260\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ P>}
\DoxyCodeLine{01261\ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a26f5e7e768b77f9e95100c5d6467db71}{ScalablePipeline<P>::ScalablePipeline}}(\textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a5a4dd65638e8e06e35cb4c5792d044cc}{num\_lines}})\ :}
\DoxyCodeLine{01262\ \ \ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a66182f2b381be1f628da346b2e47c2ab}{\_tasks}}\ \ \ \ \ (\mbox{\hyperlink{classtf_1_1_scalable_pipeline_a5a4dd65638e8e06e35cb4c5792d044cc}{num\_lines}}\ +\ 1),}
\DoxyCodeLine{01263\ \ \ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a879b367ce62ff667d00c16c18313021c}{\_pipeflows}}\ (\mbox{\hyperlink{classtf_1_1_scalable_pipeline_a5a4dd65638e8e06e35cb4c5792d044cc}{num\_lines}})\ \{}
\DoxyCodeLine{01264\ }
\DoxyCodeLine{01265\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classtf_1_1_scalable_pipeline_a5a4dd65638e8e06e35cb4c5792d044cc}{num\_lines}}\ ==\ 0)\ \{}
\DoxyCodeLine{01266\ \ \ \ \ \mbox{\hyperlink{error_8hpp_aecd66f17d01de60aeb9cae992c9dd4bf}{TF\_THROW}}(\textcolor{stringliteral}{"{}must\ have\ at\ least\ one\ line"{}});}
\DoxyCodeLine{01267\ \ \ \}}
\DoxyCodeLine{01268\ }
\DoxyCodeLine{01269\ \ \ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_ae695c9b1bbe3a5f65a5bb4217087c356}{\_build}}();}
\DoxyCodeLine{01270\ \}}
\DoxyCodeLine{01271\ }
\DoxyCodeLine{01272\ \textcolor{comment}{//\ constructor}}
\DoxyCodeLine{01273\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ P>}
\DoxyCodeLine{01274\ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a26f5e7e768b77f9e95100c5d6467db71}{ScalablePipeline<P>::ScalablePipeline}}(\textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a5a4dd65638e8e06e35cb4c5792d044cc}{num\_lines}},\ \mbox{\hyperlink{namespace_p}{P}}\ first,\ \mbox{\hyperlink{namespace_p}{P}}\ last)\ :}
\DoxyCodeLine{01275\ \ \ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a66182f2b381be1f628da346b2e47c2ab}{\_tasks}}\ \ \ \ \ (\mbox{\hyperlink{classtf_1_1_scalable_pipeline_a5a4dd65638e8e06e35cb4c5792d044cc}{num\_lines}}\ +\ 1),}
\DoxyCodeLine{01276\ \ \ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a879b367ce62ff667d00c16c18313021c}{\_pipeflows}}\ (\mbox{\hyperlink{classtf_1_1_scalable_pipeline_a5a4dd65638e8e06e35cb4c5792d044cc}{num\_lines}})\ \{}
\DoxyCodeLine{01277\ }
\DoxyCodeLine{01278\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classtf_1_1_scalable_pipeline_a5a4dd65638e8e06e35cb4c5792d044cc}{num\_lines}}\ ==\ 0)\ \{}
\DoxyCodeLine{01279\ \ \ \ \ \mbox{\hyperlink{error_8hpp_aecd66f17d01de60aeb9cae992c9dd4bf}{TF\_THROW}}(\textcolor{stringliteral}{"{}must\ have\ at\ least\ one\ line"{}});}
\DoxyCodeLine{01280\ \ \ \}}
\DoxyCodeLine{01281\ }
\DoxyCodeLine{01282\ \ \ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a940a8de7b53ac5cbd59c55091d88c88f}{reset}}(first,\ last);}
\DoxyCodeLine{01283\ \ \ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_ae695c9b1bbe3a5f65a5bb4217087c356}{\_build}}();}
\DoxyCodeLine{01284\ \}}
\DoxyCodeLine{01285\ }
\DoxyCodeLine{01286\ \textcolor{comment}{/*}}
\DoxyCodeLine{01287\ \textcolor{comment}{//\ move\ constructor}}
\DoxyCodeLine{01288\ \textcolor{comment}{template\ <typename\ P>}}
\DoxyCodeLine{01289\ \textcolor{comment}{ScalablePipeline<P>::ScalablePipeline(ScalablePipeline\&\&\ rhs)\ :}}
\DoxyCodeLine{01290\ \textcolor{comment}{\ \ \_graph\ \ \ \ \ \ \ \ \ \ \ \ \ \ \{std::move(rhs.\_graph)\},}}
\DoxyCodeLine{01291\ \textcolor{comment}{\ \ \_num\_tokens\ \ \ \ \ \ \ \ \ \{rhs.\_num\_tokens\},}}
\DoxyCodeLine{01292\ \textcolor{comment}{\ \ \_pipes\ \ \ \ \ \ \ \ \ \ \ \ \ \ \{std::move(rhs.\_pipes)\},}}
\DoxyCodeLine{01293\ \textcolor{comment}{\ \ \_tasks\ \ \ \ \ \ \ \ \ \ \ \ \ \ \{std::move(rhs.\_tasks)\},}}
\DoxyCodeLine{01294\ \textcolor{comment}{\ \ \_pipeflows\ \ \ \ \ \ \ \ \ \ \{std::move(rhs.\_pipeflows)\},}}
\DoxyCodeLine{01295\ \textcolor{comment}{\ \ \_lines\ \ \ \ \ \ \ \ \ \ \ \ \ \ \{std::move(rhs.\_lines)\},}}
\DoxyCodeLine{01296\ \textcolor{comment}{\ \ \_ready\_tokens\ \ \ \ \ \ \ \{std::move(rhs.\_ready\_tokens)\},}}
\DoxyCodeLine{01297\ \textcolor{comment}{\ \ \_token\_dependencies\ \{std::move(rhs.\_token\_dependencies)\},}}
\DoxyCodeLine{01298\ \textcolor{comment}{\ \ \_deferred\_tokens\ \ \ \ \{std::move(rhs.\_deferred\_tokens)\},}}
\DoxyCodeLine{01299\ \textcolor{comment}{\ \ \_longest\_deferral\ \ \ \{rhs.\_longest\_deferral\}\{}}
\DoxyCodeLine{01300\ \textcolor{comment}{}}
\DoxyCodeLine{01301\ \textcolor{comment}{\ \ rhs.\_longest\_deferral\ =\ 0;}}
\DoxyCodeLine{01302\ \textcolor{comment}{\ \ rhs.\_num\_tokens\ \ \ \ \ \ \ =\ 0;}}
\DoxyCodeLine{01303\ \textcolor{comment}{\ \ std::cout\ <<\ "{}scalable\ move\ constructor\(\backslash\)n"{};}}
\DoxyCodeLine{01304\ \textcolor{comment}{\}}}
\DoxyCodeLine{01305\ \textcolor{comment}{*/}}
\DoxyCodeLine{01306\ }
\DoxyCodeLine{01307\ \textcolor{comment}{//\ move\ constructor}}
\DoxyCodeLine{01308\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ P>}
\DoxyCodeLine{01309\ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a26f5e7e768b77f9e95100c5d6467db71}{ScalablePipeline<P>::ScalablePipeline}}(\mbox{\hyperlink{classtf_1_1_scalable_pipeline_a26f5e7e768b77f9e95100c5d6467db71}{ScalablePipeline}}\&\&\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}):}
\DoxyCodeLine{01310\ \ \ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a29cfaffe5b328370e0fc5cabe242c9c9}{\_num\_tokens}}\ \ \ \ \ \ \ \ \ \ \ \{\mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}.\mbox{\hyperlink{classtf_1_1_scalable_pipeline_a29cfaffe5b328370e0fc5cabe242c9c9}{\_num\_tokens}}\},}
\DoxyCodeLine{01311\ \ \ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a207985f26c6ddf57e7c286af5576b124}{\_pipes}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{\mbox{\hyperlink{namespacestd}{std}}::move(\mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}.\mbox{\hyperlink{classtf_1_1_scalable_pipeline_a207985f26c6ddf57e7c286af5576b124}{\_pipes}})\},}
\DoxyCodeLine{01312\ \ \ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a879b367ce62ff667d00c16c18313021c}{\_pipeflows}}\ \ \ \ \ \ \ \ \ \ \ \ \{\mbox{\hyperlink{namespacestd}{std}}::move(\mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}.\mbox{\hyperlink{classtf_1_1_scalable_pipeline_a879b367ce62ff667d00c16c18313021c}{\_pipeflows}})\},}
\DoxyCodeLine{01313\ \ \ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a2d6a310af9e3a69efaea0e8002960062}{\_lines}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{\mbox{\hyperlink{namespacestd}{std}}::move(\mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}.\mbox{\hyperlink{classtf_1_1_scalable_pipeline_a2d6a310af9e3a69efaea0e8002960062}{\_lines}})\},}
\DoxyCodeLine{01314\ \ \ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a18a2b6051521959ee807c4f1899ec2f3}{\_ready\_tokens}}\ \ \ \ \ \ \ \ \ \{\mbox{\hyperlink{namespacestd}{std}}::move(\mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}.\mbox{\hyperlink{classtf_1_1_scalable_pipeline_a18a2b6051521959ee807c4f1899ec2f3}{\_ready\_tokens}})\},}
\DoxyCodeLine{01315\ \ \ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a93c0b0ee2cff99ff3cdaabbb81592744}{\_token\_dependencies}}\ \ \ \{\mbox{\hyperlink{namespacestd}{std}}::move(\mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}.\mbox{\hyperlink{classtf_1_1_scalable_pipeline_a93c0b0ee2cff99ff3cdaabbb81592744}{\_token\_dependencies}})\},}
\DoxyCodeLine{01316\ \ \ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_aadda92015e28c2545014f7576078bddb}{\_deferred\_tokens}}\ \ \ \ \ \ \{\mbox{\hyperlink{namespacestd}{std}}::move(\mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}.\mbox{\hyperlink{classtf_1_1_scalable_pipeline_aadda92015e28c2545014f7576078bddb}{\_deferred\_tokens}})\},}
\DoxyCodeLine{01317\ \ \ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_aaf2267b9dbb1173f533aee5a0a250cf3}{\_longest\_deferral}}\ \ \ \ \ \{\mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}.\mbox{\hyperlink{classtf_1_1_scalable_pipeline_aaf2267b9dbb1173f533aee5a0a250cf3}{\_longest\_deferral}}\}\{}
\DoxyCodeLine{01318\ }
\DoxyCodeLine{01319\ }
\DoxyCodeLine{01320\ \ \ \textcolor{comment}{//\_num\_tokens\ =\ rhs.\_num\_tokens;}}
\DoxyCodeLine{01321\ }
\DoxyCodeLine{01322\ \ \ \textcolor{comment}{//\_pipes.resize(rhs.num\_pipes());}}
\DoxyCodeLine{01323\ \ \ \textcolor{comment}{//size\_t\ i=0;}}
\DoxyCodeLine{01324\ \ \ \textcolor{comment}{//for(auto\ itr\ =\ rhs.\_pipes.begin();\ itr\ !=\ rhs.\_pipes.end();\ itr++)\ \{}}
\DoxyCodeLine{01325\ \ \ \textcolor{comment}{//\ \ \_pipes[i++]\ =\ *itr;}}
\DoxyCodeLine{01326\ \ \ \textcolor{comment}{//\}}}
\DoxyCodeLine{01327\ }
\DoxyCodeLine{01328\ }
\DoxyCodeLine{01329\ \ \ \textcolor{comment}{//\_pipeflows.resize(rhs.num\_lines());}}
\DoxyCodeLine{01330\ \ \ \textcolor{comment}{//for(size\_t\ l\ =\ 0;\ l<rhs.num\_lines();\ l++)\ \{}}
\DoxyCodeLine{01331\ \ \ \textcolor{comment}{//\ \ \_pipeflows[l].\_pipe\ =\ rhs.\_pipeflows[l].\_pipe;}}
\DoxyCodeLine{01332\ \ \ \textcolor{comment}{//\ \ \_pipeflows[l].\_line\ =\ rhs.\_pipeflows[l].\_line;}}
\DoxyCodeLine{01333\ \ \ \textcolor{comment}{//\ \ \_pipeflows[l].\_num\_deferrals\ =\ 0;}}
\DoxyCodeLine{01334\ \ \ \textcolor{comment}{//\ \ \_pipeflows[l].\_dependents.clear();}}
\DoxyCodeLine{01335\ \ \ \textcolor{comment}{//\}}}
\DoxyCodeLine{01336\ }
\DoxyCodeLine{01337\ \ \ \textcolor{comment}{//\_lines\ =\ std::make\_unique<Line[]>(rhs.num\_lines()\ *\ rhs.\_pipes.size());}}
\DoxyCodeLine{01338\ \ \ \textcolor{comment}{//for(size\_t\ l=0;\ l<num\_lines();\ l++)\ \{}}
\DoxyCodeLine{01339\ \ \ \textcolor{comment}{//\ \ for(size\_t\ f=0;\ f<num\_pipes();\ f++)\ \{}}
\DoxyCodeLine{01340\ \ \ \textcolor{comment}{//\ \ \ \ \_line(l,\ f).join\_counter.store(}}
\DoxyCodeLine{01341\ \ \ \textcolor{comment}{//\ \ \ \ \ \ rhs.\_line(l,\ f).join\_counter,\ std::memory\_order\_relaxed}}
\DoxyCodeLine{01342\ \ \ \textcolor{comment}{//\ \ \ \ );}}
\DoxyCodeLine{01343\ \ \ \textcolor{comment}{//\ \ \}}}
\DoxyCodeLine{01344\ \ \ \textcolor{comment}{//\}}}
\DoxyCodeLine{01345\ \ }
\DoxyCodeLine{01346\ \ \ \textcolor{comment}{//\_ready\_tokens\ =\ std::move(rhs.\_ready\_tokens);}}
\DoxyCodeLine{01347\ \ \ \textcolor{comment}{//\_token\_dependencies\ =\ std::move(rhs.\_token\_dependencies);}}
\DoxyCodeLine{01348\ \ \ \textcolor{comment}{//\_deferred\_tokens\ =\ std::move(rhs.\_deferred\_tokens);}}
\DoxyCodeLine{01349\ }
\DoxyCodeLine{01350\ \ \ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a22fa085403161f1054f7c06004a6ae0c}{\_graph}}.clear();}
\DoxyCodeLine{01351\ \ \ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a66182f2b381be1f628da346b2e47c2ab}{\_tasks}}.resize(\mbox{\hyperlink{classtf_1_1_scalable_pipeline_a879b367ce62ff667d00c16c18313021c}{\_pipeflows}}.size()+1);}
\DoxyCodeLine{01352\ \ \ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}.\_longest\_deferral\ =\ 0;}
\DoxyCodeLine{01353\ \ \ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}.\_num\_tokens\ \ \ \ \ \ \ =\ 0;}
\DoxyCodeLine{01354\ \ \ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}.\_tasks.clear();}
\DoxyCodeLine{01355\ \ \ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_ae695c9b1bbe3a5f65a5bb4217087c356}{\_build}}();}
\DoxyCodeLine{01356\ \}}
\DoxyCodeLine{01357\ }
\DoxyCodeLine{01359\ \textcolor{comment}{//template\ <typename\ P>}}
\DoxyCodeLine{01360\ \textcolor{comment}{//ScalablePipeline<P>\&\ ScalablePipeline<P>::operator\ =\ (ScalablePipeline\&\&\ rhs)\ \{}}
\DoxyCodeLine{01361\ \textcolor{comment}{//\ \ \_graph\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ std::move(rhs.\_graph);}}
\DoxyCodeLine{01362\ \textcolor{comment}{//\ \ \_num\_tokens\ \ \ \ \ \ \ \ \ \ \ =\ rhs.\_num\_tokens;}}
\DoxyCodeLine{01363\ \textcolor{comment}{//\ \ \_pipes\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ std::move(rhs.\_pipes);}}
\DoxyCodeLine{01364\ \textcolor{comment}{//\ \ \_tasks\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ std::move(rhs.\_tasks);}}
\DoxyCodeLine{01365\ \textcolor{comment}{//\ \ \_pipeflows\ \ \ \ \ \ \ \ \ \ \ \ =\ std::move(rhs.\_pipeflows);}}
\DoxyCodeLine{01366\ \textcolor{comment}{//\ \ \_lines\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ std::move(rhs.\_lines);}}
\DoxyCodeLine{01367\ \textcolor{comment}{//\ \ rhs.\_num\_tokens\ \ \ \ \ \ \ =\ 0;}}
\DoxyCodeLine{01368\ \textcolor{comment}{//\ \ \_ready\_tokens\ \ \ \ \ \ \ \ \ =\ std::move(rhs.\_ready\_tokens);}}
\DoxyCodeLine{01369\ \textcolor{comment}{//\ \ \_token\_dependencies\ \ \ =\ std::move(rhs.\_token\_dependencies);}}
\DoxyCodeLine{01370\ \textcolor{comment}{//\ \ \_deferred\_tokens\ \ \ \ \ \ =\ std::move(rhs.\_deferred\_tokens);}}
\DoxyCodeLine{01371\ \textcolor{comment}{//\ \ \_longest\_deferral\ \ \ \ \ =\ rhs.\_longest\_deferral;}}
\DoxyCodeLine{01372\ \textcolor{comment}{//\ \ rhs.\_longest\_deferral\ =\ 0;}}
\DoxyCodeLine{01373\ \textcolor{comment}{//\ \ std::cout\ <<\ "{}scalable\ move\ assignment\(\backslash\)n"{};}}
\DoxyCodeLine{01374\ \textcolor{comment}{//\ \ return\ *this;}}
\DoxyCodeLine{01375\ \textcolor{comment}{//\}}}
\DoxyCodeLine{01376\ }
\DoxyCodeLine{01377\ \textcolor{comment}{//\ move\ assignment\ operator}}
\DoxyCodeLine{01378\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ P>}
\DoxyCodeLine{01379\ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a26f5e7e768b77f9e95100c5d6467db71}{ScalablePipeline<P>}}\&\ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a3019d8763337d434b4ef405f6d801a7b}{ScalablePipeline<P>::operator\ =\ }}(\mbox{\hyperlink{classtf_1_1_scalable_pipeline_a26f5e7e768b77f9e95100c5d6467db71}{ScalablePipeline}}\&\&\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}})\ \{}
\DoxyCodeLine{01380\ \ \ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a29cfaffe5b328370e0fc5cabe242c9c9}{\_num\_tokens}}\ \ \ \ \ \ \ \ \ =\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}.\_num\_tokens;}
\DoxyCodeLine{01381\ \ \ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a207985f26c6ddf57e7c286af5576b124}{\_pipes}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ std::move(\mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}.\_pipes);}
\DoxyCodeLine{01382\ \ \ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a879b367ce62ff667d00c16c18313021c}{\_pipeflows}}\ \ \ \ \ \ \ \ \ \ =\ std::move(\mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}.\_pipeflows);}
\DoxyCodeLine{01383\ \ \ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a2d6a310af9e3a69efaea0e8002960062}{\_lines}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ std::move(\mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}.\_lines);}
\DoxyCodeLine{01384\ \ \ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a18a2b6051521959ee807c4f1899ec2f3}{\_ready\_tokens}}\ \ \ \ \ \ \ =\ std::move(\mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}.\_ready\_tokens);}
\DoxyCodeLine{01385\ \ \ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a93c0b0ee2cff99ff3cdaabbb81592744}{\_token\_dependencies}}\ =\ std::move(\mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}.\_token\_dependencies);}
\DoxyCodeLine{01386\ \ \ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_aadda92015e28c2545014f7576078bddb}{\_deferred\_tokens}}\ \ \ \ =\ std::move(\mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}.\_deferred\_tokens);}
\DoxyCodeLine{01387\ \ \ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_aaf2267b9dbb1173f533aee5a0a250cf3}{\_longest\_deferral}}\ \ \ =\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}.\_longest\_deferral;}
\DoxyCodeLine{01388\ }
\DoxyCodeLine{01389\ \ \ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a22fa085403161f1054f7c06004a6ae0c}{\_graph}}.clear();}
\DoxyCodeLine{01390\ \ \ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a66182f2b381be1f628da346b2e47c2ab}{\_tasks}}.resize(\mbox{\hyperlink{classtf_1_1_scalable_pipeline_a879b367ce62ff667d00c16c18313021c}{\_pipeflows}}.size()+1);}
\DoxyCodeLine{01391\ }
\DoxyCodeLine{01392\ \ \ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}.\_longest\_deferral\ =\ 0;}
\DoxyCodeLine{01393\ \ \ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}.\_num\_tokens\ \ \ \ \ \ \ =\ 0;}
\DoxyCodeLine{01394\ \ \ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}.\_tasks.clear();}
\DoxyCodeLine{01395\ \ \ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_ae695c9b1bbe3a5f65a5bb4217087c356}{\_build}}();}
\DoxyCodeLine{01396\ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{01397\ \}}
\DoxyCodeLine{01398\ }
\DoxyCodeLine{01399\ \textcolor{comment}{//\ Function:\ num\_lines}}
\DoxyCodeLine{01400\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ P>}
\DoxyCodeLine{01401\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a5a4dd65638e8e06e35cb4c5792d044cc}{ScalablePipeline<P>::num\_lines}}()\ const\ noexcept\ \{}
\DoxyCodeLine{01402\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a879b367ce62ff667d00c16c18313021c}{\_pipeflows}}.size();}
\DoxyCodeLine{01403\ \}}
\DoxyCodeLine{01404\ }
\DoxyCodeLine{01405\ \textcolor{comment}{//\ Function:\ num\_pipes}}
\DoxyCodeLine{01406\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ P>}
\DoxyCodeLine{01407\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a70c49f5219847681133d2a226c804da1}{ScalablePipeline<P>::num\_pipes}}()\ const\ noexcept\ \{}
\DoxyCodeLine{01408\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a207985f26c6ddf57e7c286af5576b124}{\_pipes}}.size();}
\DoxyCodeLine{01409\ \}}
\DoxyCodeLine{01410\ }
\DoxyCodeLine{01411\ \textcolor{comment}{//\ Function:\ num\_tokens}}
\DoxyCodeLine{01412\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ P>}
\DoxyCodeLine{01413\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a693a2ea53cfac9c0b220d5b3a28e6313}{ScalablePipeline<P>::num\_tokens}}()\ const\ noexcept\ \{}
\DoxyCodeLine{01414\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a29cfaffe5b328370e0fc5cabe242c9c9}{\_num\_tokens}};}
\DoxyCodeLine{01415\ \}}
\DoxyCodeLine{01416\ }
\DoxyCodeLine{01417\ \textcolor{comment}{//\ Function:\ graph}}
\DoxyCodeLine{01418\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ P>}
\DoxyCodeLine{01419\ \mbox{\hyperlink{classtf_1_1_graph}{Graph}}\&\ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a2f45a4cb7116fbe9bbc54305f13c52a8}{ScalablePipeline<P>::graph}}()\ \{}
\DoxyCodeLine{01420\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a22fa085403161f1054f7c06004a6ae0c}{\_graph}};}
\DoxyCodeLine{01421\ \}}
\DoxyCodeLine{01422\ }
\DoxyCodeLine{01423\ \textcolor{comment}{//\ Function:\ \_line}}
\DoxyCodeLine{01424\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ P>}
\DoxyCodeLine{01425\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{structtf_1_1_scalable_pipeline_1_1_line}{ScalablePipeline<P>::Line}}\&\ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a81b18c25db2cba4c530d85c5ab413a6c}{ScalablePipeline<P>::\_line}}(\textcolor{keywordtype}{size\_t}\ l,\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}})\ \{}
\DoxyCodeLine{01426\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a2d6a310af9e3a69efaea0e8002960062}{\_lines}}[l*\mbox{\hyperlink{classtf_1_1_scalable_pipeline_a70c49f5219847681133d2a226c804da1}{num\_pipes}}()\ +\ \mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}}];}
\DoxyCodeLine{01427\ \}}
\DoxyCodeLine{01428\ }
\DoxyCodeLine{01429\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ P>}
\DoxyCodeLine{01430\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a940a8de7b53ac5cbd59c55091d88c88f}{ScalablePipeline<P>::reset}}(\textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a5a4dd65638e8e06e35cb4c5792d044cc}{num\_lines}},\ \mbox{\hyperlink{namespace_p}{P}}\ first,\ \mbox{\hyperlink{namespace_p}{P}}\ last)\ \{}
\DoxyCodeLine{01431\ }
\DoxyCodeLine{01432\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classtf_1_1_scalable_pipeline_a5a4dd65638e8e06e35cb4c5792d044cc}{num\_lines}}\ ==\ 0)\ \{}
\DoxyCodeLine{01433\ \ \ \ \ \mbox{\hyperlink{error_8hpp_aecd66f17d01de60aeb9cae992c9dd4bf}{TF\_THROW}}(\textcolor{stringliteral}{"{}must\ have\ at\ least\ one\ line"{}});}
\DoxyCodeLine{01434\ \ \ \}}
\DoxyCodeLine{01435\ }
\DoxyCodeLine{01436\ \ \ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a22fa085403161f1054f7c06004a6ae0c}{\_graph}}.clear();}
\DoxyCodeLine{01437\ \ \ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a66182f2b381be1f628da346b2e47c2ab}{\_tasks}}.resize(\mbox{\hyperlink{classtf_1_1_scalable_pipeline_a5a4dd65638e8e06e35cb4c5792d044cc}{num\_lines}}\ +\ 1);}
\DoxyCodeLine{01438\ \ \ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a879b367ce62ff667d00c16c18313021c}{\_pipeflows}}.resize(\mbox{\hyperlink{classtf_1_1_scalable_pipeline_a5a4dd65638e8e06e35cb4c5792d044cc}{num\_lines}});}
\DoxyCodeLine{01439\ }
\DoxyCodeLine{01440\ \ \ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a940a8de7b53ac5cbd59c55091d88c88f}{reset}}(first,\ last);}
\DoxyCodeLine{01441\ }
\DoxyCodeLine{01442\ \ \ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_ae695c9b1bbe3a5f65a5bb4217087c356}{\_build}}();}
\DoxyCodeLine{01443\ \}}
\DoxyCodeLine{01444\ }
\DoxyCodeLine{01445\ \textcolor{comment}{//\ Function:\ reset}}
\DoxyCodeLine{01446\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ P>}
\DoxyCodeLine{01447\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a940a8de7b53ac5cbd59c55091d88c88f}{ScalablePipeline<P>::reset}}(\mbox{\hyperlink{namespace_p}{P}}\ first,\ \mbox{\hyperlink{namespace_p}{P}}\ last)\ \{}
\DoxyCodeLine{01448\ }
\DoxyCodeLine{01449\ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a70c49f5219847681133d2a226c804da1}{num\_pipes}}\ =\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{size\_t}\textcolor{keyword}{>}(std::distance(first,\ last));}
\DoxyCodeLine{01450\ }
\DoxyCodeLine{01451\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classtf_1_1_scalable_pipeline_a70c49f5219847681133d2a226c804da1}{num\_pipes}}\ ==\ 0)\ \{}
\DoxyCodeLine{01452\ \ \ \ \ \mbox{\hyperlink{error_8hpp_aecd66f17d01de60aeb9cae992c9dd4bf}{TF\_THROW}}(\textcolor{stringliteral}{"{}pipeline\ cannot\ be\ empty"{}});}
\DoxyCodeLine{01453\ \ \ \}}
\DoxyCodeLine{01454\ }
\DoxyCodeLine{01455\ \ \ \textcolor{keywordflow}{if}(first-\/>type()\ !=\ \mbox{\hyperlink{namespacetf_abb7a11e41fd457f69e7ff45d4c769564a7b804a28d6154ab8007287532037f1d0}{PipeType::SERIAL}})\ \{}
\DoxyCodeLine{01456\ \ \ \ \ \mbox{\hyperlink{error_8hpp_aecd66f17d01de60aeb9cae992c9dd4bf}{TF\_THROW}}(\textcolor{stringliteral}{"{}first\ pipe\ must\ be\ serial"{}});}
\DoxyCodeLine{01457\ \ \ \}}
\DoxyCodeLine{01458\ }
\DoxyCodeLine{01459\ \ \ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a207985f26c6ddf57e7c286af5576b124}{\_pipes}}.resize(\mbox{\hyperlink{classtf_1_1_scalable_pipeline_a70c49f5219847681133d2a226c804da1}{num\_pipes}});}
\DoxyCodeLine{01460\ }
\DoxyCodeLine{01461\ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}=0;}
\DoxyCodeLine{01462\ \ \ \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}\ itr\ =\ first;\ itr\ !=\ last;\ itr++)\ \{}
\DoxyCodeLine{01463\ \ \ \ \ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a207985f26c6ddf57e7c286af5576b124}{\_pipes}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}++]\ =\ itr;}
\DoxyCodeLine{01464\ \ \ \}}
\DoxyCodeLine{01465\ }
\DoxyCodeLine{01466\ \ \ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a2d6a310af9e3a69efaea0e8002960062}{\_lines}}\ =\ std::make\_unique<Line[]>(\mbox{\hyperlink{classtf_1_1_scalable_pipeline_a5a4dd65638e8e06e35cb4c5792d044cc}{num\_lines}}()\ *\ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a207985f26c6ddf57e7c286af5576b124}{\_pipes}}.size());}
\DoxyCodeLine{01467\ }
\DoxyCodeLine{01468\ \ \ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a940a8de7b53ac5cbd59c55091d88c88f}{reset}}();}
\DoxyCodeLine{01469\ \}}
\DoxyCodeLine{01470\ }
\DoxyCodeLine{01471\ \textcolor{comment}{//\ Function:\ reset}}
\DoxyCodeLine{01472\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ P>}
\DoxyCodeLine{01473\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a940a8de7b53ac5cbd59c55091d88c88f}{ScalablePipeline<P>::reset}}()\ \{}
\DoxyCodeLine{01474\ }
\DoxyCodeLine{01475\ \ \ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a29cfaffe5b328370e0fc5cabe242c9c9}{\_num\_tokens}}\ =\ 0;}
\DoxyCodeLine{01476\ }
\DoxyCodeLine{01477\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ l\ =\ 0;\ l<\mbox{\hyperlink{classtf_1_1_scalable_pipeline_a5a4dd65638e8e06e35cb4c5792d044cc}{num\_lines}}();\ l++)\ \{}
\DoxyCodeLine{01478\ \ \ \ \ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a879b367ce62ff667d00c16c18313021c}{\_pipeflows}}[l].\_pipe\ =\ 0;}
\DoxyCodeLine{01479\ \ \ \ \ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a879b367ce62ff667d00c16c18313021c}{\_pipeflows}}[l].\_line\ =\ l;}
\DoxyCodeLine{01480\ \ \ \ \ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a879b367ce62ff667d00c16c18313021c}{\_pipeflows}}[l].\_num\_deferrals\ =\ 0;}
\DoxyCodeLine{01481\ \ \ \ \ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a879b367ce62ff667d00c16c18313021c}{\_pipeflows}}[l].\_dependents.clear();}
\DoxyCodeLine{01482\ \ \ \}}
\DoxyCodeLine{01483\ }
\DoxyCodeLine{01484\ \ \ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a81b18c25db2cba4c530d85c5ab413a6c}{\_line}}(0,\ 0).join\_counter.store(0,\ std::memory\_order\_relaxed);}
\DoxyCodeLine{01485\ }
\DoxyCodeLine{01486\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ l=1;\ l<\mbox{\hyperlink{classtf_1_1_scalable_pipeline_a5a4dd65638e8e06e35cb4c5792d044cc}{num\_lines}}();\ l++)\ \{}
\DoxyCodeLine{01487\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{cxx11__tensor__map_8cpp_a7f507fea02198f6cb81c86640c7b1a4e}{f}}=1;\ \mbox{\hyperlink{cxx11__tensor__map_8cpp_a7f507fea02198f6cb81c86640c7b1a4e}{f}}<\mbox{\hyperlink{classtf_1_1_scalable_pipeline_a70c49f5219847681133d2a226c804da1}{num\_pipes}}();\ \mbox{\hyperlink{cxx11__tensor__map_8cpp_a7f507fea02198f6cb81c86640c7b1a4e}{f}}++)\ \{}
\DoxyCodeLine{01488\ \ \ \ \ \ \ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a81b18c25db2cba4c530d85c5ab413a6c}{\_line}}(l,\ \mbox{\hyperlink{cxx11__tensor__map_8cpp_a7f507fea02198f6cb81c86640c7b1a4e}{f}}).join\_counter.store(}
\DoxyCodeLine{01489\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{size\_t}\textcolor{keyword}{>}(\mbox{\hyperlink{classtf_1_1_scalable_pipeline_a207985f26c6ddf57e7c286af5576b124}{\_pipes}}[\mbox{\hyperlink{cxx11__tensor__map_8cpp_a7f507fea02198f6cb81c86640c7b1a4e}{f}}]-\/>\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ae8396ff85d63082521e3324820df1009}{type}}()),\ std::memory\_order\_relaxed}
\DoxyCodeLine{01490\ \ \ \ \ \ \ );}
\DoxyCodeLine{01491\ \ \ \ \ \}}
\DoxyCodeLine{01492\ \ \ \}}
\DoxyCodeLine{01493\ }
\DoxyCodeLine{01494\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{cxx11__tensor__map_8cpp_a7f507fea02198f6cb81c86640c7b1a4e}{f}}=1;\ \mbox{\hyperlink{cxx11__tensor__map_8cpp_a7f507fea02198f6cb81c86640c7b1a4e}{f}}<\mbox{\hyperlink{classtf_1_1_scalable_pipeline_a70c49f5219847681133d2a226c804da1}{num\_pipes}}();\ \mbox{\hyperlink{cxx11__tensor__map_8cpp_a7f507fea02198f6cb81c86640c7b1a4e}{f}}++)\ \{}
\DoxyCodeLine{01495\ \ \ \ \ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a81b18c25db2cba4c530d85c5ab413a6c}{\_line}}(0,\ \mbox{\hyperlink{cxx11__tensor__map_8cpp_a7f507fea02198f6cb81c86640c7b1a4e}{f}}).join\_counter.store(1,\ std::memory\_order\_relaxed);}
\DoxyCodeLine{01496\ \ \ \}}
\DoxyCodeLine{01497\ }
\DoxyCodeLine{01498\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ l=1;\ l<\mbox{\hyperlink{classtf_1_1_scalable_pipeline_a5a4dd65638e8e06e35cb4c5792d044cc}{num\_lines}}();\ l++)\ \{}
\DoxyCodeLine{01499\ \ \ \ \ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a81b18c25db2cba4c530d85c5ab413a6c}{\_line}}(l,\ 0).join\_counter.store(}
\DoxyCodeLine{01500\ \ \ \ \ \ \ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{size\_t}\textcolor{keyword}{>}(\mbox{\hyperlink{classtf_1_1_scalable_pipeline_a207985f26c6ddf57e7c286af5576b124}{\_pipes}}[0]-\/>\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ae8396ff85d63082521e3324820df1009}{type}}())\ -\/\ 1,\ std::memory\_order\_relaxed}
\DoxyCodeLine{01501\ \ \ \ \ );}
\DoxyCodeLine{01502\ \ \ \}}
\DoxyCodeLine{01503\ \ \ }
\DoxyCodeLine{01504\ \ \ assert(\mbox{\hyperlink{classtf_1_1_scalable_pipeline_a18a2b6051521959ee807c4f1899ec2f3}{\_ready\_tokens}}.empty()\ ==\ \textcolor{keyword}{true});}
\DoxyCodeLine{01505\ \ \ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a93c0b0ee2cff99ff3cdaabbb81592744}{\_token\_dependencies}}.clear();}
\DoxyCodeLine{01506\ \ \ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_aadda92015e28c2545014f7576078bddb}{\_deferred\_tokens}}.clear();}
\DoxyCodeLine{01507\ \}}
\DoxyCodeLine{01508\ }
\DoxyCodeLine{01509\ \textcolor{comment}{//\ Procedure:\ \_on\_pipe}}
\DoxyCodeLine{01510\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ P>}
\DoxyCodeLine{01511\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_aea457827353fe9d73ae069daec7fa512}{ScalablePipeline<P>::\_on\_pipe}}(\mbox{\hyperlink{classtf_1_1_pipeflow}{Pipeflow}}\&\ pf,\ \mbox{\hyperlink{classtf_1_1_runtime}{Runtime}}\&\ rt)\ \{}
\DoxyCodeLine{01512\ \ \ \ \ }
\DoxyCodeLine{01513\ \ \ \textcolor{keyword}{using\ }callable\_t\ =\ \textcolor{keyword}{typename}\ pipe\_t::callable\_t;}
\DoxyCodeLine{01514\ }
\DoxyCodeLine{01515\ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_invocable\_v<callable\_t,\ Pipeflow\&>)\ \{}
\DoxyCodeLine{01516\ \ \ \ \ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a207985f26c6ddf57e7c286af5576b124}{\_pipes}}[pf.\mbox{\hyperlink{classtf_1_1_pipeflow_a597744cac4ef0dd9e31e1d694f71f7ec}{\_pipe}}]-\/>\_callable(pf);}
\DoxyCodeLine{01517\ \ \ \}}
\DoxyCodeLine{01518\ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}(std::is\_invocable\_v<callable\_t,\ Pipeflow\&,\ Runtime\&>)\ \{}
\DoxyCodeLine{01519\ \ \ \ \ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a207985f26c6ddf57e7c286af5576b124}{\_pipes}}[pf.\mbox{\hyperlink{classtf_1_1_pipeflow_a597744cac4ef0dd9e31e1d694f71f7ec}{\_pipe}}]-\/>\_callable(pf,\ rt);}
\DoxyCodeLine{01520\ \ \ \}}
\DoxyCodeLine{01521\ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01522\ \ \ \ \ \textcolor{keyword}{static\_assert}(\mbox{\hyperlink{namespacetf_a036d82b3ab21beea2ed89611e2930db7}{dependent\_false\_v<callable\_t>}},\ \textcolor{stringliteral}{"{}un-\/supported\ pipe\ callable\ type"{}});}
\DoxyCodeLine{01523\ \ \ \}}
\DoxyCodeLine{01524\ \}}
\DoxyCodeLine{01525\ }
\DoxyCodeLine{01526\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ P>}
\DoxyCodeLine{01527\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a3cea771eaee545d4445114c824a3f6df}{ScalablePipeline<P>::\_check\_dependents}}(\mbox{\hyperlink{classtf_1_1_pipeflow}{Pipeflow}}\&\ pf)\ \{}
\DoxyCodeLine{01528\ \ \ ++pf.\mbox{\hyperlink{classtf_1_1_pipeflow_a669318dadb120d96c277529670a02588}{\_num\_deferrals}};}
\DoxyCodeLine{01529\ \ \ }
\DoxyCodeLine{01530\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ it\ =\ pf.\mbox{\hyperlink{classtf_1_1_pipeflow_a444746d10472b56b8e6cb52fd35e3d84}{\_dependents}}.begin();\ it\ !=\ pf.\mbox{\hyperlink{classtf_1_1_pipeflow_a444746d10472b56b8e6cb52fd35e3d84}{\_dependents}}.end();)\ \{}
\DoxyCodeLine{01531\ \ }
\DoxyCodeLine{01532\ \ \ \ \ \textcolor{comment}{//\ valid\ (e.g.,\ 12.defer(16))\ }}
\DoxyCodeLine{01533\ \ \ \ \ \textcolor{keywordflow}{if}\ (*it\ >=\ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a29cfaffe5b328370e0fc5cabe242c9c9}{\_num\_tokens}})\ \{}
\DoxyCodeLine{01534\ \ \ \ \ \ \ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a93c0b0ee2cff99ff3cdaabbb81592744}{\_token\_dependencies}}[*it].push\_back(pf.\mbox{\hyperlink{classtf_1_1_pipeflow_a16275ecab224bf1ede060d9e24b4eb48}{\_token}});}
\DoxyCodeLine{01535\ \ \ \ \ \ \ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_aaf2267b9dbb1173f533aee5a0a250cf3}{\_longest\_deferral}}\ =\ std::max(\mbox{\hyperlink{classtf_1_1_scalable_pipeline_aaf2267b9dbb1173f533aee5a0a250cf3}{\_longest\_deferral}},\ *it);}
\DoxyCodeLine{01536\ \ \ \ \ \ \ ++it;}
\DoxyCodeLine{01537\ \ \ \ \ \}}
\DoxyCodeLine{01538\ \ \ \ \ \textcolor{comment}{//\ valid\ or\ invalid\ (e.g.,\ 12.defer(7))}}
\DoxyCodeLine{01539\ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01540\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ pit\ =\ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_aadda92015e28c2545014f7576078bddb}{\_deferred\_tokens}}.find(*it);}
\DoxyCodeLine{01541\ \ \ \ \ \ \ }
\DoxyCodeLine{01542\ \ \ \ \ \ \ \textcolor{comment}{//\ valid\ (e.g.,\ 7\ is\ deferred)}}
\DoxyCodeLine{01543\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (pit\ !=\ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_aadda92015e28c2545014f7576078bddb}{\_deferred\_tokens}}.end())\ \{}
\DoxyCodeLine{01544\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a93c0b0ee2cff99ff3cdaabbb81592744}{\_token\_dependencies}}[*it].push\_back(pf.\mbox{\hyperlink{classtf_1_1_pipeflow_a16275ecab224bf1ede060d9e24b4eb48}{\_token}});}
\DoxyCodeLine{01545\ \ \ \ \ \ \ \ \ ++it;}
\DoxyCodeLine{01546\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01547\ }
\DoxyCodeLine{01548\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01549\ \ \ \ \ \ \ \ \ it\ =\ pf.\mbox{\hyperlink{classtf_1_1_pipeflow_a444746d10472b56b8e6cb52fd35e3d84}{\_dependents}}.erase(it);}
\DoxyCodeLine{01550\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01551\ \ \ \ \ \}}
\DoxyCodeLine{01552\ \ \ \}}
\DoxyCodeLine{01553\ \}}
\DoxyCodeLine{01554\ }
\DoxyCodeLine{01555\ \textcolor{comment}{//\ Procedure:\ \_construct\_deferred\_tokens}}
\DoxyCodeLine{01556\ \textcolor{comment}{//\ Construct\ a\ data\ structure\ for\ a\ deferred\ token}}
\DoxyCodeLine{01557\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ P>}
\DoxyCodeLine{01558\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a4583da84f07196c55c636e3556a1e5e3}{ScalablePipeline<P>::\_construct\_deferred\_tokens}}(\mbox{\hyperlink{classtf_1_1_pipeflow}{Pipeflow}}\&\ pf)\ \{}
\DoxyCodeLine{01559\ \ \ }
\DoxyCodeLine{01560\ \ \ \textcolor{comment}{//\ construct\ the\ deferred\ pipeflow\ with\ zero\ copy}}
\DoxyCodeLine{01561\ \ \ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_aadda92015e28c2545014f7576078bddb}{\_deferred\_tokens}}.emplace(}
\DoxyCodeLine{01562\ \ \ \ \ std::piecewise\_construct,}
\DoxyCodeLine{01563\ \ \ \ \ std::forward\_as\_tuple(pf.\mbox{\hyperlink{classtf_1_1_pipeflow_a16275ecab224bf1ede060d9e24b4eb48}{\_token}}),}
\DoxyCodeLine{01564\ \ \ \ \ std::forward\_as\_tuple(}
\DoxyCodeLine{01565\ \ \ \ \ \ \ pf.\mbox{\hyperlink{classtf_1_1_pipeflow_a16275ecab224bf1ede060d9e24b4eb48}{\_token}},\ pf.\mbox{\hyperlink{classtf_1_1_pipeflow_a669318dadb120d96c277529670a02588}{\_num\_deferrals}},\ std::move(pf.\mbox{\hyperlink{classtf_1_1_pipeflow_a444746d10472b56b8e6cb52fd35e3d84}{\_dependents}})}
\DoxyCodeLine{01566\ \ \ \ \ )}
\DoxyCodeLine{01567\ \ \ );}
\DoxyCodeLine{01568\ \}}
\DoxyCodeLine{01569\ }
\DoxyCodeLine{01570\ \textcolor{comment}{//\ Procedure:\ \_resolve\_token\_dependencies}}
\DoxyCodeLine{01571\ \textcolor{comment}{//\ Resolve\ dependencies\ for\ tokens\ that\ defer\ to\ current\ token}}
\DoxyCodeLine{01572\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ P>}
\DoxyCodeLine{01573\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_ad210e4d59d58c79100a830df51d55b1f}{ScalablePipeline<P>::\_resolve\_token\_dependencies}}(\mbox{\hyperlink{classtf_1_1_pipeflow}{Pipeflow}}\&\ pf)\ \{}
\DoxyCodeLine{01574\ }
\DoxyCodeLine{01575\ \ \ \textcolor{keywordflow}{if}\ (\textcolor{keyword}{auto}\ it\ =\ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a93c0b0ee2cff99ff3cdaabbb81592744}{\_token\_dependencies}}.find(pf.\mbox{\hyperlink{classtf_1_1_pipeflow_a16275ecab224bf1ede060d9e24b4eb48}{\_token}});}
\DoxyCodeLine{01576\ \ \ \ \ \ \ it\ !=\ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a93c0b0ee2cff99ff3cdaabbb81592744}{\_token\_dependencies}}.end())\ \{}
\DoxyCodeLine{01577\ \ \ \ \ }
\DoxyCodeLine{01578\ \ \ \ \ \textcolor{comment}{//\ iterate\ tokens\ that\ defer\ to\ pf.\_token}}
\DoxyCodeLine{01579\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ target\ :\ it-\/>second)\ \{}
\DoxyCodeLine{01580\ }
\DoxyCodeLine{01581\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ dpf\ =\ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_aadda92015e28c2545014f7576078bddb}{\_deferred\_tokens}}.find(target);}
\DoxyCodeLine{01582\ }
\DoxyCodeLine{01583\ \ \ \ \ \ \ assert(dpf\ !=\ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_aadda92015e28c2545014f7576078bddb}{\_deferred\_tokens}}.end());}
\DoxyCodeLine{01584\ }
\DoxyCodeLine{01585\ \ \ \ \ \ \ \textcolor{comment}{//\ erase\ pf.\_token\ from\ target's\ \_dependents}}
\DoxyCodeLine{01586\ \ \ \ \ \ \ dpf-\/>second.\_dependents.erase(pf.\mbox{\hyperlink{classtf_1_1_pipeflow_a16275ecab224bf1ede060d9e24b4eb48}{\_token}});}
\DoxyCodeLine{01587\ \ \ \ \ \ \ }
\DoxyCodeLine{01588\ \ \ \ \ \ \ \textcolor{comment}{//\ target\ has\ no\ dependents}}
\DoxyCodeLine{01589\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (dpf-\/>second.\_dependents.empty())\ \{}
\DoxyCodeLine{01590\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a18a2b6051521959ee807c4f1899ec2f3}{\_ready\_tokens}}.emplace(dpf-\/>second.\_token,\ dpf-\/>second.\_num\_deferrals);}
\DoxyCodeLine{01591\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_aadda92015e28c2545014f7576078bddb}{\_deferred\_tokens}}.erase(dpf);}
\DoxyCodeLine{01592\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01593\ \ \ \ \ \}}
\DoxyCodeLine{01594\ }
\DoxyCodeLine{01595\ \ \ \ \ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a93c0b0ee2cff99ff3cdaabbb81592744}{\_token\_dependencies}}.erase(it);}
\DoxyCodeLine{01596\ \ \ \}}
\DoxyCodeLine{01597\ \}}
\DoxyCodeLine{01598\ }
\DoxyCodeLine{01599\ \textcolor{comment}{//\ Procedure:\ \_build}}
\DoxyCodeLine{01600\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ P>}
\DoxyCodeLine{01601\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_ae695c9b1bbe3a5f65a5bb4217087c356}{ScalablePipeline<P>::\_build}}()\ \{}
\DoxyCodeLine{01602\ }
\DoxyCodeLine{01603\ \ \ \textcolor{keyword}{using\ namespace\ }std::literals::string\_literals;}
\DoxyCodeLine{01604\ }
\DoxyCodeLine{01605\ \ \ \mbox{\hyperlink{classtf_1_1_flow_builder}{FlowBuilder}}\ fb(\mbox{\hyperlink{classtf_1_1_scalable_pipeline_a22fa085403161f1054f7c06004a6ae0c}{\_graph}});}
\DoxyCodeLine{01606\ \ \ }
\DoxyCodeLine{01607\ \ \ \textcolor{comment}{//\ init\ task}}
\DoxyCodeLine{01608\ \ \ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a66182f2b381be1f628da346b2e47c2ab}{\_tasks}}[0]\ =\ fb.\mbox{\hyperlink{classtf_1_1_flow_builder_a60d7a666cab71ecfa3010b2efb0d6b57}{emplace}}([\textcolor{keyword}{this}]()\ \{}
\DoxyCodeLine{01609\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(\mbox{\hyperlink{classtf_1_1_scalable_pipeline_a29cfaffe5b328370e0fc5cabe242c9c9}{\_num\_tokens}}\ \%\ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a5a4dd65638e8e06e35cb4c5792d044cc}{num\_lines}}());}
\DoxyCodeLine{01610\ \ \ \}).\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aab18cfce5ee7c6881ae04f18be70d94a}{name}}(\textcolor{stringliteral}{"{}cond"{}});}
\DoxyCodeLine{01611\ }
\DoxyCodeLine{01612\ \ \ \textcolor{comment}{//\ line\ task}}
\DoxyCodeLine{01613\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ l\ =\ 0;\ l\ <\ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a5a4dd65638e8e06e35cb4c5792d044cc}{num\_lines}}();\ l++)\ \{}
\DoxyCodeLine{01614\ \ \ \ \ }
\DoxyCodeLine{01615\ \ \ \ \ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a66182f2b381be1f628da346b2e47c2ab}{\_tasks}}[l\ +\ 1]\ =\ fb.\mbox{\hyperlink{classtf_1_1_flow_builder_a60d7a666cab71ecfa3010b2efb0d6b57}{emplace}}([\textcolor{keyword}{this},\ l]\ (\mbox{\hyperlink{classtf_1_1_runtime}{tf::Runtime}}\&\ rt)\ \textcolor{keyword}{mutable}\ \{}
\DoxyCodeLine{01616\ }
\DoxyCodeLine{01617\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ pf\ =\ \&\mbox{\hyperlink{classtf_1_1_scalable_pipeline_a879b367ce62ff667d00c16c18313021c}{\_pipeflows}}[l];}
\DoxyCodeLine{01618\ }
\DoxyCodeLine{01619\ \ \ \ \ \ \ pipeline:}
\DoxyCodeLine{01620\ }
\DoxyCodeLine{01621\ \ \ \ \ \ \ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a81b18c25db2cba4c530d85c5ab413a6c}{\_line}}(pf-\/>\_line,\ pf-\/>\_pipe).join\_counter.store(}
\DoxyCodeLine{01622\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{size\_t}\textcolor{keyword}{>}(\mbox{\hyperlink{classtf_1_1_scalable_pipeline_a207985f26c6ddf57e7c286af5576b124}{\_pipes}}[pf-\/>\_pipe]-\/>type()),\ std::memory\_order\_relaxed}
\DoxyCodeLine{01623\ \ \ \ \ \ \ );}
\DoxyCodeLine{01624\ }
\DoxyCodeLine{01625\ \ \ \ \ \ \ \textcolor{comment}{//\ First\ pipe\ does\ all\ jobs\ of\ initialization\ and\ token\ dependencies}}
\DoxyCodeLine{01626\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (pf-\/>\_pipe\ ==\ 0)\ \{}
\DoxyCodeLine{01627\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ \_ready\_tokens\ queue\ is\ not\ empty}}
\DoxyCodeLine{01628\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ substitute\ pf\ with\ the\ token\ at\ the\ front\ of\ the\ queue}}
\DoxyCodeLine{01629\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classtf_1_1_scalable_pipeline_a18a2b6051521959ee807c4f1899ec2f3}{\_ready\_tokens}}.empty())\ \{}
\DoxyCodeLine{01630\ \ \ \ \ \ \ \ \ \ \ pf-\/>\_token\ =\ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a18a2b6051521959ee807c4f1899ec2f3}{\_ready\_tokens}}.front().first;}
\DoxyCodeLine{01631\ \ \ \ \ \ \ \ \ \ \ pf-\/>\_num\_deferrals\ =\ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a18a2b6051521959ee807c4f1899ec2f3}{\_ready\_tokens}}.front().second;}
\DoxyCodeLine{01632\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a18a2b6051521959ee807c4f1899ec2f3}{\_ready\_tokens}}.pop();}
\DoxyCodeLine{01633\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01634\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01635\ \ \ \ \ \ \ \ \ \ \ pf-\/>\_token\ =\ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a29cfaffe5b328370e0fc5cabe242c9c9}{\_num\_tokens}};}
\DoxyCodeLine{01636\ \ \ \ \ \ \ \ \ \ \ pf-\/>\_num\_deferrals\ =\ 0;}
\DoxyCodeLine{01637\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01638\ \ \ \ \ \ \ }
\DoxyCodeLine{01639\ \ \ \ \ \ \ handle\_token\_dependency:\ }
\DoxyCodeLine{01640\ }
\DoxyCodeLine{01641\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (pf-\/>\_stop\ =\ \textcolor{keyword}{false},\ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_aea457827353fe9d73ae069daec7fa512}{\_on\_pipe}}(*pf,\ rt);\ pf-\/>\_stop\ ==\ \textcolor{keyword}{true})\ \{}
\DoxyCodeLine{01642\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ here,\ the\ pipeline\ is\ not\ stopped\ yet\ because\ other}}
\DoxyCodeLine{01643\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ lines\ of\ tasks\ may\ still\ be\ running\ their\ last\ stages}}
\DoxyCodeLine{01644\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{01645\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01646\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{01647\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classtf_1_1_scalable_pipeline_a29cfaffe5b328370e0fc5cabe242c9c9}{\_num\_tokens}}\ ==\ pf-\/>\_token)\ \{}
\DoxyCodeLine{01648\ \ \ \ \ \ \ \ \ \ \ ++\mbox{\hyperlink{classtf_1_1_scalable_pipeline_a29cfaffe5b328370e0fc5cabe242c9c9}{\_num\_tokens}};}
\DoxyCodeLine{01649\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01650\ \ \ \ \ \ \ }
\DoxyCodeLine{01651\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (pf-\/>\_dependents.empty()\ ==\ \textcolor{keyword}{false})\{\ }
\DoxyCodeLine{01652\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ check\ if\ the\ pf-\/>\_dependents\ have\ valid\ dependents}}
\DoxyCodeLine{01653\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a3cea771eaee545d4445114c824a3f6df}{\_check\_dependents}}(*pf);\ }
\DoxyCodeLine{01654\ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{01655\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ tokens\ in\ pf-\/>\_dependents\ are\ all\ valid\ dependents\ }}
\DoxyCodeLine{01656\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (pf-\/>\_dependents.size())\ \{}
\DoxyCodeLine{01657\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{01658\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ construct\ a\ data\ structure\ for\ pf\ in\ \_deferred\_tokens\ }}
\DoxyCodeLine{01659\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a4583da84f07196c55c636e3556a1e5e3}{\_construct\_deferred\_tokens}}(*pf);}
\DoxyCodeLine{01660\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{goto}\ pipeline;}
\DoxyCodeLine{01661\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01662\ }
\DoxyCodeLine{01663\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ tokens\ in\ pf-\/>\_dependents\ are\ invalid\ dependents}}
\DoxyCodeLine{01664\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ directly\ goto\ on\_pipe\ on\ the\ same\ line}}
\DoxyCodeLine{01665\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01666\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{goto}\ handle\_token\_dependency;}
\DoxyCodeLine{01667\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01668\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01669\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{01670\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Every\ token\ within\ the\ deferral\ range\ needs\ to\ check}}
\DoxyCodeLine{01671\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ if\ it\ can\ resolve\ dependencies\ on\ other\ tokens.}}
\DoxyCodeLine{01672\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (pf-\/>\_token\ <=\ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_aaf2267b9dbb1173f533aee5a0a250cf3}{\_longest\_deferral}})\ \{}
\DoxyCodeLine{01673\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_ad210e4d59d58c79100a830df51d55b1f}{\_resolve\_token\_dependencies}}(*pf);\ }
\DoxyCodeLine{01674\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01675\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01676\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01677\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_aea457827353fe9d73ae069daec7fa512}{\_on\_pipe}}(*pf,\ rt);}
\DoxyCodeLine{01678\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01679\ \ \ \ \ \ \ }
\DoxyCodeLine{01680\ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ c\_f\ =\ pf-\/>\_pipe;}
\DoxyCodeLine{01681\ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ n\_f\ =\ (pf-\/>\_pipe\ +\ 1)\ \%\ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a70c49f5219847681133d2a226c804da1}{num\_pipes}}();}
\DoxyCodeLine{01682\ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ n\_l\ =\ (pf-\/>\_line\ +\ 1)\ \%\ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a5a4dd65638e8e06e35cb4c5792d044cc}{num\_lines}}();}
\DoxyCodeLine{01683\ \ \ \ \ \ \ }
\DoxyCodeLine{01684\ \ \ \ \ \ \ pf-\/>\_pipe\ =\ n\_f;}
\DoxyCodeLine{01685\ }
\DoxyCodeLine{01686\ \ \ \ \ \ \ \textcolor{comment}{//\ -\/-\/-\/-\/\ scheduling\ starts\ here\ -\/-\/-\/-\/}}
\DoxyCodeLine{01687\ \ \ \ \ \ \ \textcolor{comment}{//\ Notice\ that\ the\ shared\ variable\ f\ must\ not\ be\ changed\ after\ this}}
\DoxyCodeLine{01688\ \ \ \ \ \ \ \textcolor{comment}{//\ point\ because\ it\ can\ result\ in\ data\ race\ due\ to\ the\ following}}
\DoxyCodeLine{01689\ \ \ \ \ \ \ \textcolor{comment}{//\ condition:}}
\DoxyCodeLine{01690\ \ \ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{01691\ \ \ \ \ \ \ \textcolor{comment}{//\ a\ -\/>\ b}}
\DoxyCodeLine{01692\ \ \ \ \ \ \ \textcolor{comment}{//\ |\ \ \ \ |}}
\DoxyCodeLine{01693\ \ \ \ \ \ \ \textcolor{comment}{//\ v\ \ \ \ v}}
\DoxyCodeLine{01694\ \ \ \ \ \ \ \textcolor{comment}{//\ c\ -\/>\ d}}
\DoxyCodeLine{01695\ \ \ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{01696\ \ \ \ \ \ \ \textcolor{comment}{//\ d\ will\ be\ spawned\ by\ either\ c\ or\ b,\ so\ if\ c\ changes\ f\ but\ b\ spawns\ d}}
\DoxyCodeLine{01697\ \ \ \ \ \ \ \textcolor{comment}{//\ then\ data\ race\ on\ f\ will\ happen}}
\DoxyCodeLine{01698\ }
\DoxyCodeLine{01699\ \ \ \ \ \ \ std::array<int,\ 2>\ retval;}
\DoxyCodeLine{01700\ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}\ =\ 0;}
\DoxyCodeLine{01701\ }
\DoxyCodeLine{01702\ \ \ \ \ \ \ \textcolor{comment}{//\ downward\ dependency}}
\DoxyCodeLine{01703\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classtf_1_1_scalable_pipeline_a207985f26c6ddf57e7c286af5576b124}{\_pipes}}[c\_f]-\/>\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ae8396ff85d63082521e3324820df1009}{type}}()\ ==\ \mbox{\hyperlink{namespacetf_abb7a11e41fd457f69e7ff45d4c769564a7b804a28d6154ab8007287532037f1d0}{PipeType::SERIAL}}\ \&\&}
\DoxyCodeLine{01704\ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a81b18c25db2cba4c530d85c5ab413a6c}{\_line}}(n\_l,\ c\_f).join\_counter.fetch\_sub(}
\DoxyCodeLine{01705\ \ \ \ \ \ \ \ \ \ \ \ 1,\ std::memory\_order\_acq\_rel)\ ==\ 1}
\DoxyCodeLine{01706\ \ \ \ \ \ \ \ \ )\ \{}
\DoxyCodeLine{01707\ \ \ \ \ \ \ \ \ retval[\mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}++]\ =\ 1;}
\DoxyCodeLine{01708\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01709\ }
\DoxyCodeLine{01710\ \ \ \ \ \ \ \textcolor{comment}{//\ forward\ dependency}}
\DoxyCodeLine{01711\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classtf_1_1_scalable_pipeline_a81b18c25db2cba4c530d85c5ab413a6c}{\_line}}(pf-\/>\_line,\ n\_f).join\_counter.fetch\_sub(}
\DoxyCodeLine{01712\ \ \ \ \ \ \ \ \ \ \ 1,\ std::memory\_order\_acq\_rel)\ ==\ 1}
\DoxyCodeLine{01713\ \ \ \ \ \ \ \ \ )\ \{}
\DoxyCodeLine{01714\ \ \ \ \ \ \ \ \ retval[\mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}++]\ =\ 0;}
\DoxyCodeLine{01715\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01716\ }
\DoxyCodeLine{01717\ \ \ \ \ \ \ \textcolor{comment}{//\ notice\ that\ the\ task\ index\ starts\ from\ 1}}
\DoxyCodeLine{01718\ \ \ \ \ \ \ \textcolor{keywordflow}{switch}(\mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}})\ \{}
\DoxyCodeLine{01719\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ 2:\ \{}
\DoxyCodeLine{01720\ \ \ \ \ \ \ \ \ \ \ rt.\mbox{\hyperlink{classtf_1_1_runtime_aa7e72cc0f298475195b252c8f1793343}{schedule}}(\mbox{\hyperlink{classtf_1_1_scalable_pipeline_a66182f2b381be1f628da346b2e47c2ab}{\_tasks}}[n\_l+1]);}
\DoxyCodeLine{01721\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{goto}\ pipeline;}
\DoxyCodeLine{01722\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01723\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ 1:\ \{}
\DoxyCodeLine{01724\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (retval[0]\ ==\ 1)\ \{}
\DoxyCodeLine{01725\ \ \ \ \ \ \ \ \ \ \ \ \ pf\ =\ \&\mbox{\hyperlink{classtf_1_1_scalable_pipeline_a879b367ce62ff667d00c16c18313021c}{\_pipeflows}}[n\_l];}
\DoxyCodeLine{01726\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01727\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{goto}\ pipeline;}
\DoxyCodeLine{01728\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01729\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01730\ \ \ \ \ \}).\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aab18cfce5ee7c6881ae04f18be70d94a}{name}}(\textcolor{stringliteral}{"{}rt-\/"{}}\mbox{\hyperlink{main-override_8cpp_a1384e7608274313a9433fa573868557b}{s}}\ +\ std::to\_string(l));}
\DoxyCodeLine{01731\ }
\DoxyCodeLine{01732\ \ \ \ \ \mbox{\hyperlink{classtf_1_1_scalable_pipeline_a66182f2b381be1f628da346b2e47c2ab}{\_tasks}}[0].precede(\mbox{\hyperlink{classtf_1_1_scalable_pipeline_a66182f2b381be1f628da346b2e47c2ab}{\_tasks}}[l+1]);}
\DoxyCodeLine{01733\ \ \ \}}
\DoxyCodeLine{01734\ \}}
\DoxyCodeLine{01735\ }
\DoxyCodeLine{01736\ \}\ \ \textcolor{comment}{//\ end\ of\ namespace\ tf\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{01737\ }
\DoxyCodeLine{01738\ }
\DoxyCodeLine{01739\ }
\DoxyCodeLine{01740\ }
\DoxyCodeLine{01741\ }

\end{DoxyCode}
