\doxysection{external/taskflow/3rd-\/party/ff/allocator.hpp 文件参考}
\hypertarget{allocator_8hpp}{}\label{allocator_8hpp}\index{external/taskflow/3rd-\/party/ff/allocator.hpp@{external/taskflow/3rd-\/party/ff/allocator.hpp}}


Implementations of the Fast\+Flow\textquotesingle{}s lock-\/free allocator.  


{\ttfamily \#include $<$assert.\+h$>$}\newline
{\ttfamily \#include $<$algorithm$>$}\newline
{\ttfamily \#include $<$ff/platforms/platform.\+h$>$}\newline
{\ttfamily \#include $<$atomic$>$}\newline
{\ttfamily \#include $<$ff/ubuffer.\+hpp$>$}\newline
{\ttfamily \#include $<$ff/spin-\/lock.\+hpp$>$}\newline
{\ttfamily \#include $<$ff/svector.\+hpp$>$}\newline
{\ttfamily \#include $<$ff/utils.\+hpp$>$}\newline
allocator.\+hpp 的引用(Include)关系图\+:
% FIG 0
此图展示该文件被哪些文件直接或间接地引用了\+:
% FIG 1
\doxysubsubsection*{类}
\begin{DoxyCompactItemize}
\item 
class \mbox{\hyperlink{classff_1_1_segment_allocator}{ff\+::\+Segment\+Allocator}}
\item 
struct \mbox{\hyperlink{structff_1_1_buf__ctl}{ff\+::\+Buf\+\_\+ctl}}
\item 
struct \mbox{\hyperlink{structff_1_1_seg__ctl}{ff\+::\+Seg\+\_\+ctl}}
\item 
struct \mbox{\hyperlink{structff_1_1x_thread_data}{ff\+::x\+Thread\+Data}}
\item 
class \mbox{\hyperlink{classff_1_1_slab_cache}{ff\+::\+Slab\+Cache}}
\item 
class \mbox{\hyperlink{classff_1_1ff__allocator}{ff\+::ff\+\_\+allocator}}
\begin{DoxyCompactList}\small\item\em The \doxylink{classff_1_1ff__allocator}{ff\+\_\+allocator}, based on the idea of the \href{http://www.ibm.com/developerworks/linux/library/l-linux-slab-allocator/}{\texttt{ Slab allocator}} \end{DoxyCompactList}\item 
class \mbox{\hyperlink{classff_1_1ffa__wrapper}{ff\+::ffa\+\_\+wrapper}}
\item 
struct \mbox{\hyperlink{structff_1_1_f_f_ax_thread_data}{ff\+::\+FFAx\+Thread\+Data}}
\item 
class \mbox{\hyperlink{classff_1_1_f_f_allocator}{ff\+::\+FFAllocator}}
\begin{DoxyCompactList}\small\item\em \doxylink{bench__gemm_8cpp_addc86e8508f14411ec98f521c520f875}{A} user-\/space parallel allocator (process-\/wide) \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{命名空间}
\begin{DoxyCompactItemize}
\item 
namespace \mbox{\hyperlink{namespaceff}{ff}}
\end{DoxyCompactItemize}
\doxysubsubsection*{宏定义}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{allocator_8hpp_ad33d37230e2f3c601bc29fc619adde35}{DBG}}(\mbox{\hyperlink{icosphere_8cpp_a207fd5507206d307cd63f95374fcd00d}{X}})
\item 
\#define \mbox{\hyperlink{allocator_8hpp_a2fbd97af3a198200b674b6658fb90a50}{ALLSTATS}}(\mbox{\hyperlink{icosphere_8cpp_a207fd5507206d307cd63f95374fcd00d}{X}})
\end{DoxyCompactItemize}
\doxysubsubsection*{枚举}
\begin{DoxyCompactItemize}
\item 
enum \{ \mbox{\hyperlink{namespaceff_ac70617c84eb066a57e5d904bf5c3e62da9b057b825c2a8d1ab94ef55519344dd1}{ff\+::\+N\+\_\+\+SLABBUFFER}} =9
, \mbox{\hyperlink{namespaceff_ac70617c84eb066a57e5d904bf5c3e62dac4e03297ac4c5065b5b8690d0c651dae}{ff\+::\+MAX\+\_\+\+SLABBUFFER\+\_\+\+SIZE}} =8192
 \}
\end{DoxyCompactItemize}
\doxysubsubsection*{函数}
\begin{DoxyCompactItemize}
\item 
static \mbox{\hyperlink{sugar_8h_abb452686968e48b67397da5f97445f5b}{bool}} \mbox{\hyperlink{namespaceff_a94e8617a117c5ad8c4ce0d196c1413da}{ff\+::is\+Power\+Of\+Two\+Multiple}} (size\+\_\+t alignment, size\+\_\+t multiple)
\item 
static \mbox{\hyperlink{ittnotify__static_8h_a61af67d9d838a9497ca5b188dabc1aa0}{void}} \mbox{\hyperlink{namespaceff_a7ce928bba667c9a4c80178bf1d10e8ea}{ff\+::\+FFAkey\+Destructor\+Handler}} (\mbox{\hyperlink{ittnotify__static_8h_a61af67d9d838a9497ca5b188dabc1aa0}{void}} \texorpdfstring{$\ast$}{*}kv)
\item 
static \mbox{\hyperlink{ittnotify__static_8h_a61af67d9d838a9497ca5b188dabc1aa0}{void}} \mbox{\hyperlink{namespaceff_ab0944ddc87ac43b2b29fa77c9c435361}{ff\+::kill\+Myself}} (\mbox{\hyperlink{classff_1_1ffa__wrapper}{ffa\+\_\+wrapper}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}})
\item 
static \mbox{\hyperlink{ittnotify__static_8h_a61af67d9d838a9497ca5b188dabc1aa0}{void}} \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{namespaceff_a51a2593e7c0dcaef7e36d2ce733bc5bc}{ff\+::ff\+\_\+malloc}} (size\+\_\+t \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}})
\item 
static \mbox{\hyperlink{ittnotify__static_8h_a61af67d9d838a9497ca5b188dabc1aa0}{void}} \mbox{\hyperlink{namespaceff_a5e79b0a002e32d63c4049995f1e38a44}{ff\+::ff\+\_\+free}} (\mbox{\hyperlink{ittnotify__static_8h_a61af67d9d838a9497ca5b188dabc1aa0}{void}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}})
\item 
static \mbox{\hyperlink{ittnotify__static_8h_a61af67d9d838a9497ca5b188dabc1aa0}{void}} \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{namespaceff_a94dc33d45aea6301a545275f0b226cca}{ff\+::ff\+\_\+realloc}} (\mbox{\hyperlink{ittnotify__static_8h_a61af67d9d838a9497ca5b188dabc1aa0}{void}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}}, size\+\_\+t newsize)
\item 
static \mbox{\hyperlink{sugar_8h_ae4f82344f573c70aa1066a2394bba345}{int}} \mbox{\hyperlink{namespaceff_a79a7a00587aeb4226a0ff161eed08271}{ff\+::ff\+\_\+posix\+\_\+memalign}} (\mbox{\hyperlink{ittnotify__static_8h_a61af67d9d838a9497ca5b188dabc1aa0}{void}} \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}memptr, size\+\_\+t alignment, size\+\_\+t \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}})
\end{DoxyCompactItemize}
\doxysubsubsection*{变量}
\begin{DoxyCompactItemize}
\item 
static const \mbox{\hyperlink{sugar_8h_ae4f82344f573c70aa1066a2394bba345}{int}} \mbox{\hyperlink{namespaceff_aa1f1e3ae7276d8194e9cd91e2dffd9eb}{ff\+::\+POW2\+\_\+\+MIN}} = 5
\item 
static const \mbox{\hyperlink{sugar_8h_ae4f82344f573c70aa1066a2394bba345}{int}} \mbox{\hyperlink{namespaceff_acb06e7498e7fd41e08de493ee51261aa}{ff\+::\+POW2\+\_\+\+MAX}} = 13
\item 
static const \mbox{\hyperlink{sugar_8h_ae4f82344f573c70aa1066a2394bba345}{int}} \mbox{\hyperlink{namespaceff_adc84d5e813921475f8f9ec164561309d}{ff\+::buffersize}} \mbox{[}\mbox{\hyperlink{namespaceff_ac70617c84eb066a57e5d904bf5c3e62da9b057b825c2a8d1ab94ef55519344dd1}{N\+\_\+\+SLABBUFFER}}\mbox{]}
\item 
static const \mbox{\hyperlink{sugar_8h_ae4f82344f573c70aa1066a2394bba345}{int}} \mbox{\hyperlink{namespaceff_aa1467f40b1c3300221f6918c5478d0bb}{ff\+::nslabs\+\_\+default}} \mbox{[}\mbox{\hyperlink{namespaceff_ac70617c84eb066a57e5d904bf5c3e62da9b057b825c2a8d1ab94ef55519344dd1}{N\+\_\+\+SLABBUFFER}}\mbox{]}
\end{DoxyCompactItemize}


\doxysubsection{详细描述}
Implementations of the Fast\+Flow\textquotesingle{}s lock-\/free allocator. 

Here we defined the \doxylink{classff_1_1ff__allocator}{ff\+::ff\+\_\+allocator} (1) and the \doxylink{classff_1_1_f_f_allocator}{ff\+::\+FFAllocator} (2).


\begin{DoxyEnumerate}
\item The ff\+\_\+allocator allocates only large chunks of memory, slicing them up into little chunks all with the same size. Only one thread can perform malloc operations while any number of threads may perform frees using the ff\+\_\+allocator.

The ff\+\_\+allocator is based on the idea of Slab Allocator, for more details about Slab Allocator please see\+: Bonwick, Jeff. "{}\+The Slab Allocator\+: An Object-\/\+Caching Kernel Memory     Allocator."{} Boston USENIX Proceedings, 1994.
\item Based on the ff\+\_\+allocator, the FFAllocator has been implemented. It might be used by any number of threads to dynamically allocate/deallocate memory. You have to include \doxylink{allocator_8hpp}{allocator.\+hpp} and just use {\ttfamily  \doxylink{namespaceff_a51a2593e7c0dcaef7e36d2ce733bc5bc}{ff\+::ff\+\_\+malloc}, \doxylink{namespaceff_a5e79b0a002e32d63c4049995f1e38a44}{ff\+::ff\+\_\+free()}, \doxylink{namespaceff_a94dc33d45aea6301a545275f0b226cca}{ff\+::ff\+\_\+realloc}, \doxylink{namespaceff_a79a7a00587aeb4226a0ff161eed08271}{ff\+::ff\+\_\+posix\+\_\+memalign} }
\end{DoxyEnumerate}

\begin{DoxyNote}{注解}
In all the cases it is possible, it is better to use the ff\+\_\+allocator as it allows more control and is more efficient. 
\end{DoxyNote}


\doxysubsection{宏定义说明}
\Hypertarget{allocator_8hpp_a2fbd97af3a198200b674b6658fb90a50}\index{allocator.hpp@{allocator.hpp}!ALLSTATS@{ALLSTATS}}
\index{ALLSTATS@{ALLSTATS}!allocator.hpp@{allocator.hpp}}
\doxysubsubsection{\texorpdfstring{ALLSTATS}{ALLSTATS}}
{\footnotesize\ttfamily \label{allocator_8hpp_a2fbd97af3a198200b674b6658fb90a50} 
\#define ALLSTATS(\begin{DoxyParamCaption}\item[{}]{\mbox{\hyperlink{icosphere_8cpp_a207fd5507206d307cd63f95374fcd00d}{X}}}{}\end{DoxyParamCaption})}

\Hypertarget{allocator_8hpp_ad33d37230e2f3c601bc29fc619adde35}\index{allocator.hpp@{allocator.hpp}!DBG@{DBG}}
\index{DBG@{DBG}!allocator.hpp@{allocator.hpp}}
\doxysubsubsection{\texorpdfstring{DBG}{DBG}}
{\footnotesize\ttfamily \label{allocator_8hpp_ad33d37230e2f3c601bc29fc619adde35} 
\#define DBG(\begin{DoxyParamCaption}\item[{}]{\mbox{\hyperlink{icosphere_8cpp_a207fd5507206d307cd63f95374fcd00d}{X}}}{}\end{DoxyParamCaption})}

