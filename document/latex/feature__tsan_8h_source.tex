\doxysection{feature\+\_\+tsan.\+h}
\hypertarget{feature__tsan_8h_source}{}\label{feature__tsan_8h_source}\index{external/libcds/cds/compiler/feature\_tsan.h@{external/libcds/cds/compiler/feature\_tsan.h}}
\mbox{\hyperlink{feature__tsan_8h}{浏览该文件的文档.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ Copyright\ (c)\ 2006-\/2018\ Maxim\ Khizhinsky}}
\DoxyCodeLine{00002\ \textcolor{comment}{//}}
\DoxyCodeLine{00003\ \textcolor{comment}{//\ Distributed\ under\ the\ Boost\ Software\ License,\ Version\ 1.0.\ (See\ accompanying}}
\DoxyCodeLine{00004\ \textcolor{comment}{//\ file\ LICENSE\ or\ copy\ at\ http://www.boost.org/LICENSE\_1\_0.txt)}}
\DoxyCodeLine{00005\ }
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#ifndef\ CDSLIB\_COMPILER\_FEATURE\_TSAN\_H}}
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#define\ CDSLIB\_COMPILER\_FEATURE\_TSAN\_H}}
\DoxyCodeLine{00008\ }
\DoxyCodeLine{00009\ \textcolor{comment}{//\ Thread\ Sanitizer\ annotations.}}
\DoxyCodeLine{00010\ \textcolor{comment}{//\ From\ http://llvm.org/viewvc/llvm-\/project/compiler-\/rt/trunk/test/tsan/annotate\_happens\_before.cc?view=markup}}
\DoxyCodeLine{00011\ }
\DoxyCodeLine{00012\ \textcolor{comment}{//@cond}}
\DoxyCodeLine{00013\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#ifdef\ CDS\_THREAD\_SANITIZER\_ENABLED}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#\ \ \ define\ CDS\_TSAN\_ANNOTATE\_HAPPENS\_BEFORE(addr)\ \ \ AnnotateHappensBefore(\_\_FILE\_\_,\ \_\_LINE\_\_,\ reinterpret\_cast<void*>(addr))}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#\ \ \ define\ CDS\_TSAN\_ANNOTATE\_HAPPENS\_AFTER(addr)\ \ \ \ AnnotateHappensAfter(\_\_FILE\_\_,\ \_\_LINE\_\_,\ reinterpret\_cast<void*>(addr))}}
\DoxyCodeLine{00017\ }
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#\ \ \ define\ CDS\_TSAN\_ANNOTATE\_IGNORE\_READS\_BEGIN\ \ \ \ \ AnnotateIgnoreReadsBegin(\_\_FILE\_\_,\ \_\_LINE\_\_)}}
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#\ \ \ define\ CDS\_TSAN\_ANNOTATE\_IGNORE\_READS\_END\ \ \ \ \ \ \ AnnotateIgnoreReadsEnd(\_\_FILE\_\_,\ \_\_LINE\_\_)}}
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#\ \ \ define\ CDS\_TSAN\_ANNOTATE\_IGNORE\_WRITES\_BEGIN\ \ \ \ AnnotateIgnoreWritesBegin(\_\_FILE\_\_,\ \_\_LINE\_\_)}}
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#\ \ \ define\ CDS\_TSAN\_ANNOTATE\_IGNORE\_WRITES\_END\ \ \ \ \ \ AnnotateIgnoreWritesEnd(\_\_FILE\_\_,\ \_\_LINE\_\_)}}
\DoxyCodeLine{00022\ \textcolor{preprocessor}{\#\ \ \ define\ CDS\_TSAN\_ANNOTATE\_IGNORE\_RW\_BEGIN\ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00023\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ CDS\_TSAN\_ANNOTATE\_IGNORE\_READS\_BEGIN;\ \(\backslash\)}}
\DoxyCodeLine{00024\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ CDS\_TSAN\_ANNOTATE\_IGNORE\_WRITES\_BEGIN}}
\DoxyCodeLine{00025\ \textcolor{preprocessor}{\#\ \ \ define\ CDS\_TSAN\_ANNOTATE\_IGNORE\_RW\_END\ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00026\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ CDS\_TSAN\_ANNOTATE\_IGNORE\_WRITES\_END;\(\backslash\)}}
\DoxyCodeLine{00027\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ CDS\_TSAN\_ANNOTATE\_IGNORE\_READS\_END}}
\DoxyCodeLine{00028\ \textcolor{preprocessor}{\#\ \ \ define\ CDS\_TSAN\_ANNOTATE\_NEW\_MEMORY(\ addr,\ sz\ )\ AnnotateNewMemory(\ \_\_FILE\_\_,\ \_\_LINE\_\_,\ reinterpret\_cast<void\ *>(addr),\ sz\ )}}
\DoxyCodeLine{00029\ }
\DoxyCodeLine{00030\ \textcolor{comment}{//\ Publish/unpublish\ -\/\ DEPRECATED}}
\DoxyCodeLine{00031\ \textcolor{preprocessor}{\#if\ 0}}
\DoxyCodeLine{00032\ \textcolor{preprocessor}{\#\ \ \ define\ CDS\_TSAN\_ANNOTATE\_PUBLISH\_MEMORY\_RANGE(\ addr,\ sz\ )\ AnnotatePublishMemoryRange(\ \_\_FILE\_\_,\ \_\_LINE\_\_,\ reinterpret\_cast<void\ *>(addr),\ sz\ )}}
\DoxyCodeLine{00033\ \textcolor{preprocessor}{\#\ \ \ define\ CDS\_TSAN\_ANNOTATE\_UNPUBLISH\_MEMORY\_RANGE(\ addr,\ sz\ )\ AnnotateUnpublishMemoryRange(\ \_\_FILE\_\_,\ \_\_LINE\_\_,\ reinterpret\_cast<void\ *>(addr),\ sz\ )}}
\DoxyCodeLine{00034\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00035\ }
\DoxyCodeLine{00036\ \textcolor{preprocessor}{\#\ \ \ define\ CDS\_TSAN\_ANNOTATE\_MUTEX\_CREATE(\ addr\ )\ \ \ \ AnnotateRWLockCreate(\ \_\_FILE\_\_,\ \_\_LINE\_\_,\ reinterpret\_cast<void\ *>(addr))}}
\DoxyCodeLine{00037\ \textcolor{preprocessor}{\#\ \ \ define\ CDS\_TSAN\_ANNOTATE\_MUTEX\_DESTROY(\ addr\ )\ \ \ AnnotateRWLockDestroy(\ \_\_FILE\_\_,\ \_\_LINE\_\_,\ reinterpret\_cast<void\ *>(addr))}}
\DoxyCodeLine{00038\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ must\ be\ called\ after\ actual\ acquire}}
\DoxyCodeLine{00039\ \textcolor{preprocessor}{\#\ \ \ define\ CDS\_TSAN\_ANNOTATE\_MUTEX\_ACQUIRED(\ addr\ )\ \ AnnotateRWLockAcquired(\ \_\_FILE\_\_,\ \_\_LINE\_\_,\ reinterpret\_cast<void\ *>(addr),\ 1\ )}}
\DoxyCodeLine{00040\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ must\ be\ called\ before\ actual\ release}}
\DoxyCodeLine{00041\ \textcolor{preprocessor}{\#\ \ \ define\ CDS\_TSAN\_ANNOTATE\_MUTEX\_RELEASED(\ addr\ )\ \ AnnotateRWLockReleased(\ \_\_FILE\_\_,\ \_\_LINE\_\_,\ reinterpret\_cast<void\ *>(addr),\ 1\ )}}
\DoxyCodeLine{00042\ }
\DoxyCodeLine{00043\ \ \ \ \ \textcolor{comment}{//\ provided\ by\ TSan}}
\DoxyCodeLine{00044\ \ \ \ \ \textcolor{keyword}{extern}\ \textcolor{stringliteral}{"{}C"{}}\ \{}
\DoxyCodeLine{00045\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ AnnotateHappensBefore(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *\mbox{\hyperlink{cxx11__tensor__map_8cpp_a7f507fea02198f6cb81c86640c7b1a4e}{f}},\ \textcolor{keywordtype}{int}\ l,\ \textcolor{keywordtype}{void}\ *\mbox{\hyperlink{ittnotify__static_8h_a5a45e81e22c3c12a69b24c775466de97}{addr}});}
\DoxyCodeLine{00046\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ AnnotateHappensAfter(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *\mbox{\hyperlink{cxx11__tensor__map_8cpp_a7f507fea02198f6cb81c86640c7b1a4e}{f}},\ \textcolor{keywordtype}{int}\ l,\ \textcolor{keywordtype}{void}\ *\mbox{\hyperlink{ittnotify__static_8h_a5a45e81e22c3c12a69b24c775466de97}{addr}});}
\DoxyCodeLine{00047\ }
\DoxyCodeLine{00048\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ AnnotateIgnoreReadsBegin(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *\mbox{\hyperlink{cxx11__tensor__map_8cpp_a7f507fea02198f6cb81c86640c7b1a4e}{f}},\ \textcolor{keywordtype}{int}\ l);}
\DoxyCodeLine{00049\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ AnnotateIgnoreReadsEnd(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *\mbox{\hyperlink{cxx11__tensor__map_8cpp_a7f507fea02198f6cb81c86640c7b1a4e}{f}},\ \textcolor{keywordtype}{int}\ l);}
\DoxyCodeLine{00050\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ AnnotateIgnoreWritesBegin(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *\mbox{\hyperlink{cxx11__tensor__map_8cpp_a7f507fea02198f6cb81c86640c7b1a4e}{f}},\ \textcolor{keywordtype}{int}\ l);}
\DoxyCodeLine{00051\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ AnnotateIgnoreWritesEnd(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *\mbox{\hyperlink{cxx11__tensor__map_8cpp_a7f507fea02198f6cb81c86640c7b1a4e}{f}},\ \textcolor{keywordtype}{int}\ l);}
\DoxyCodeLine{00052\ }
\DoxyCodeLine{00053\ \textcolor{preprocessor}{\#if\ 0}}
\DoxyCodeLine{00054\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ AnnotatePublishMemoryRange(\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *\mbox{\hyperlink{cxx11__tensor__map_8cpp_a7f507fea02198f6cb81c86640c7b1a4e}{f}},\ \textcolor{keywordtype}{int}\ l,\ \textcolor{keywordtype}{void}\ *\ mem,\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}}\ );}
\DoxyCodeLine{00055\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ AnnotateUnpublishMemoryRange(\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *\mbox{\hyperlink{cxx11__tensor__map_8cpp_a7f507fea02198f6cb81c86640c7b1a4e}{f}},\ \textcolor{keywordtype}{int}\ l,\ \textcolor{keywordtype}{void}\ *\ \mbox{\hyperlink{ittnotify__static_8h_a5a45e81e22c3c12a69b24c775466de97}{addr}},\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}}\ );}
\DoxyCodeLine{00056\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00057\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ AnnotateNewMemory(\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *\mbox{\hyperlink{cxx11__tensor__map_8cpp_a7f507fea02198f6cb81c86640c7b1a4e}{f}},\ \textcolor{keywordtype}{int}\ l,\ \textcolor{keywordtype}{void}\ *\ mem,\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}}\ );}
\DoxyCodeLine{00058\ }
\DoxyCodeLine{00059\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ AnnotateRWLockCreate(\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *\mbox{\hyperlink{cxx11__tensor__map_8cpp_a7f507fea02198f6cb81c86640c7b1a4e}{f}},\ \textcolor{keywordtype}{int}\ l,\ \textcolor{keywordtype}{void}*\ \mbox{\hyperlink{_angle_axis__mimic__euler_8cpp_ab3cd915d758008bd19d0f2428fbb354a}{m}}\ );}
\DoxyCodeLine{00060\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ AnnotateRWLockDestroy(\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *\mbox{\hyperlink{cxx11__tensor__map_8cpp_a7f507fea02198f6cb81c86640c7b1a4e}{f}},\ \textcolor{keywordtype}{int}\ l,\ \textcolor{keywordtype}{void}*\ \mbox{\hyperlink{_angle_axis__mimic__euler_8cpp_ab3cd915d758008bd19d0f2428fbb354a}{m}}\ );}
\DoxyCodeLine{00061\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ AnnotateRWLockAcquired(\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *\mbox{\hyperlink{cxx11__tensor__map_8cpp_a7f507fea02198f6cb81c86640c7b1a4e}{f}},\ \textcolor{keywordtype}{int}\ l,\ \textcolor{keywordtype}{void}\ *\mbox{\hyperlink{_angle_axis__mimic__euler_8cpp_ab3cd915d758008bd19d0f2428fbb354a}{m}},\ \textcolor{keywordtype}{long}\ is\_w\ );}
\DoxyCodeLine{00062\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ AnnotateRWLockReleased(\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *\mbox{\hyperlink{cxx11__tensor__map_8cpp_a7f507fea02198f6cb81c86640c7b1a4e}{f}},\ \textcolor{keywordtype}{int}\ l,\ \textcolor{keywordtype}{void}\ *\mbox{\hyperlink{_angle_axis__mimic__euler_8cpp_ab3cd915d758008bd19d0f2428fbb354a}{m}},\ \textcolor{keywordtype}{long}\ is\_w\ );}
\DoxyCodeLine{00063\ \ \ \ \ \}}
\DoxyCodeLine{00064\ }
\DoxyCodeLine{00065\ \textcolor{preprocessor}{\#else\ }\textcolor{comment}{//\ CDS\_THREAD\_SANITIZER\_ENABLED}}
\DoxyCodeLine{00066\ }
\DoxyCodeLine{00067\ \textcolor{preprocessor}{\#\ \ \ define\ CDS\_TSAN\_ANNOTATE\_HAPPENS\_BEFORE(addr)}}
\DoxyCodeLine{00068\ \textcolor{preprocessor}{\#\ \ \ define\ CDS\_TSAN\_ANNOTATE\_HAPPENS\_AFTER(addr)}}
\DoxyCodeLine{00069\ }
\DoxyCodeLine{00070\ \textcolor{preprocessor}{\#\ \ \ define\ CDS\_TSAN\_ANNOTATE\_IGNORE\_READS\_BEGIN}}
\DoxyCodeLine{00071\ \textcolor{preprocessor}{\#\ \ \ define\ CDS\_TSAN\_ANNOTATE\_IGNORE\_READS\_END}}
\DoxyCodeLine{00072\ \textcolor{preprocessor}{\#\ \ \ define\ CDS\_TSAN\_ANNOTATE\_IGNORE\_WRITES\_BEGIN}}
\DoxyCodeLine{00073\ \textcolor{preprocessor}{\#\ \ \ define\ CDS\_TSAN\_ANNOTATE\_IGNORE\_WRITES\_END}}
\DoxyCodeLine{00074\ \textcolor{preprocessor}{\#\ \ \ define\ CDS\_TSAN\_ANNOTATE\_IGNORE\_RW\_BEGIN}}
\DoxyCodeLine{00075\ \textcolor{preprocessor}{\#\ \ \ define\ CDS\_TSAN\_ANNOTATE\_IGNORE\_RW\_END}}
\DoxyCodeLine{00076\ }
\DoxyCodeLine{00077\ \textcolor{preprocessor}{\#if\ 0}}
\DoxyCodeLine{00078\ \textcolor{preprocessor}{\#\ \ \ define\ CDS\_TSAN\_ANNOTATE\_PUBLISH\_MEMORY\_RANGE(\ addr,\ sz\ )}}
\DoxyCodeLine{00079\ \textcolor{preprocessor}{\#\ \ \ define\ CDS\_TSAN\_ANNOTATE\_UNPUBLISH\_MEMORY\_RANGE(\ addr,\ sz\ )}}
\DoxyCodeLine{00080\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00081\ \textcolor{preprocessor}{\#\ \ \ define\ CDS\_TSAN\_ANNOTATE\_NEW\_MEMORY(\ addr,\ sz\ )}}
\DoxyCodeLine{00082\ }
\DoxyCodeLine{00083\ \textcolor{preprocessor}{\#\ \ \ define\ CDS\_TSAN\_ANNOTATE\_MUTEX\_CREATE(\ addr\ )}}
\DoxyCodeLine{00084\ \textcolor{preprocessor}{\#\ \ \ define\ CDS\_TSAN\_ANNOTATE\_MUTEX\_DESTROY(\ addr\ )}}
\DoxyCodeLine{00085\ \textcolor{preprocessor}{\#\ \ \ define\ CDS\_TSAN\_ANNOTATE\_MUTEX\_ACQUIRED(\ addr\ )}}
\DoxyCodeLine{00086\ \textcolor{preprocessor}{\#\ \ \ define\ CDS\_TSAN\_ANNOTATE\_MUTEX\_RELEASED(\ addr\ )}}
\DoxyCodeLine{00087\ }
\DoxyCodeLine{00088\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00089\ }
\DoxyCodeLine{00090\ \textcolor{comment}{//@endcond}}
\DoxyCodeLine{00091\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ \#ifndef\ CDSLIB\_COMPILER\_FEATURE\_TSAN\_H}}

\end{DoxyCode}
