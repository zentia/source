\doxysection{rml\+\_\+base.\+h}
\hypertarget{rml__base_8h_source}{}\label{rml__base_8h_source}\index{external/taskflow/3rd-\/party/tbb/src/rml/include/rml\_base.h@{external/taskflow/3rd-\/party/tbb/src/rml/include/rml\_base.h}}
\mbox{\hyperlink{rml__base_8h}{浏览该文件的文档.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{/*}}
\DoxyCodeLine{00002\ \textcolor{comment}{\ \ \ \ Copyright\ (c)\ 2005-\/2020\ Intel\ Corporation}}
\DoxyCodeLine{00003\ \textcolor{comment}{}}
\DoxyCodeLine{00004\ \textcolor{comment}{\ \ \ \ Licensed\ under\ the\ Apache\ License,\ Version\ 2.0\ (the\ "{}License"{});}}
\DoxyCodeLine{00005\ \textcolor{comment}{\ \ \ \ you\ may\ not\ use\ this\ file\ except\ in\ compliance\ with\ the\ License.}}
\DoxyCodeLine{00006\ \textcolor{comment}{\ \ \ \ You\ may\ obtain\ a\ copy\ of\ the\ License\ at}}
\DoxyCodeLine{00007\ \textcolor{comment}{}}
\DoxyCodeLine{00008\ \textcolor{comment}{\ \ \ \ \ \ \ \ http://www.apache.org/licenses/LICENSE-\/2.0}}
\DoxyCodeLine{00009\ \textcolor{comment}{}}
\DoxyCodeLine{00010\ \textcolor{comment}{\ \ \ \ Unless\ required\ by\ applicable\ law\ or\ agreed\ to\ in\ writing,\ software}}
\DoxyCodeLine{00011\ \textcolor{comment}{\ \ \ \ distributed\ under\ the\ License\ is\ distributed\ on\ an\ "{}AS\ IS"{}\ BASIS,}}
\DoxyCodeLine{00012\ \textcolor{comment}{\ \ \ \ WITHOUT\ WARRANTIES\ OR\ CONDITIONS\ OF\ ANY\ KIND,\ either\ express\ or\ implied.}}
\DoxyCodeLine{00013\ \textcolor{comment}{\ \ \ \ See\ the\ License\ for\ the\ specific\ language\ governing\ permissions\ and}}
\DoxyCodeLine{00014\ \textcolor{comment}{\ \ \ \ limitations\ under\ the\ License.}}
\DoxyCodeLine{00015\ \textcolor{comment}{*/}}
\DoxyCodeLine{00016\ }
\DoxyCodeLine{00017\ \textcolor{comment}{//\ Header\ guard\ and\ namespace\ names\ follow\ rml\ conventions.}}
\DoxyCodeLine{00018\ }
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#ifndef\ \_\_RML\_rml\_base\_H}}
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#define\ \_\_RML\_rml\_base\_H}}
\DoxyCodeLine{00021\ }
\DoxyCodeLine{00022\ \textcolor{preprocessor}{\#include\ <cstddef>}}
\DoxyCodeLine{00023\ }
\DoxyCodeLine{00024\ \textcolor{preprocessor}{\#if\ \_WIN32||\_WIN64}}
\DoxyCodeLine{00025\ \textcolor{preprocessor}{\#include\ <windows.h>}}
\DoxyCodeLine{00026\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{/*\ \_WIN32||\_WIN64\ */}\textcolor{preprocessor}{}}
\DoxyCodeLine{00027\ }
\DoxyCodeLine{00028\ \textcolor{preprocessor}{\#ifdef\ RML\_PURE\_VIRTUAL\_HANDLER}}
\DoxyCodeLine{00029\ \textcolor{preprocessor}{\#define\ RML\_PURE(T)\ \{RML\_PURE\_VIRTUAL\_HANDLER();\ return\ (T)0;\}}}
\DoxyCodeLine{00030\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00031\ \textcolor{preprocessor}{\#define\ RML\_PURE(T)\ =\ 0;}}
\DoxyCodeLine{00032\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00033\ }
\DoxyCodeLine{00034\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespacerml}{rml}}\ \{}
\DoxyCodeLine{00035\ }
\DoxyCodeLine{00037\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classrml_1_1no__copy_adbb018e7590081e605775922df7af61d}{no\_copy}}\ \{}
\DoxyCodeLine{00038\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1no__copy_a6a46142281205756dcae8850d02cadd2}{operator=}}(\ \mbox{\hyperlink{classrml_1_1no__copy_adbb018e7590081e605775922df7af61d}{no\_copy}}\&\ );}
\DoxyCodeLine{00039\ \ \ \ \ \mbox{\hyperlink{classrml_1_1no__copy_adbb018e7590081e605775922df7af61d}{no\_copy}}(\ \mbox{\hyperlink{classrml_1_1no__copy_adbb018e7590081e605775922df7af61d}{no\_copy}}\&\ );}
\DoxyCodeLine{00040\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00041\ \ \ \ \ \mbox{\hyperlink{classrml_1_1no__copy_a3374ec4e128b34d86188af29225da503}{no\_copy}}()\ \{\}}
\DoxyCodeLine{00042\ \};}
\DoxyCodeLine{00043\ }
\DoxyCodeLine{00044\ \textcolor{keyword}{class\ }server;}
\DoxyCodeLine{00045\ }
\DoxyCodeLine{00046\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classrml_1_1versioned__object}{versioned\_object}}\ \{}
\DoxyCodeLine{00047\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00049\ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{classrml_1_1versioned__object_a759650010b271238ef9433442730c423}{version\_type}};}
\DoxyCodeLine{00050\ \ \ \ \ }
\DoxyCodeLine{00052\ }
\DoxyCodeLine{00054\ \ \ \ \ \textcolor{keyword}{virtual}\ \mbox{\hyperlink{classrml_1_1versioned__object_a759650010b271238ef9433442730c423}{version\_type}}\ version()\ const\ \mbox{\hyperlink{rml__base_8h_a4ed20a063cd3c001902fe1b5b821f8b9}{RML\_PURE}}(\mbox{\hyperlink{classrml_1_1versioned__object_a759650010b271238ef9433442730c423}{version\_type}})}
\DoxyCodeLine{00055\ \};}
\DoxyCodeLine{00056\ }
\DoxyCodeLine{00058\ }
\DoxyCodeLine{00060\ class\ \mbox{\hyperlink{classrml_1_1job}{job}}\ \{}
\DoxyCodeLine{00061\ \ \ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classrml_1_1job_a8bf6e2cf871b0a2131f73727ffbf94cb}{server}};}
\DoxyCodeLine{00062\ }
\DoxyCodeLine{00064\ }
\DoxyCodeLine{00066\ \ \ \ \ \textcolor{keywordtype}{void}*\ \mbox{\hyperlink{classrml_1_1job_a40183a75b74590c62e78d1a43b7223f8}{scratch\_ptr}};}
\DoxyCodeLine{00067\ \};}
\DoxyCodeLine{00068\ }
\DoxyCodeLine{00070\ }
\DoxyCodeLine{00071\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classrml_1_1client}{client}}:\ \textcolor{keyword}{public}\ \mbox{\hyperlink{classrml_1_1versioned__object}{versioned\_object}}\ \{}
\DoxyCodeLine{00072\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00074\ \ \ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{classrml_1_1job}{::rml::job}}\ \mbox{\hyperlink{classrml_1_1client_a684e4fee23d24f9d9d150eb38f2d254f}{job}};}
\DoxyCodeLine{00075\ }
\DoxyCodeLine{00077\ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{classrml_1_1client_a0dc06ede570f7ee6d3021862cb71119f}{size\_type}};}
\DoxyCodeLine{00078\ }
\DoxyCodeLine{00080\ }
\DoxyCodeLine{00081\ \ \ \ \ \textcolor{keyword}{virtual}\ \mbox{\hyperlink{classrml_1_1client_a0dc06ede570f7ee6d3021862cb71119f}{size\_type}}\ max\_job\_count()\ const\ \mbox{\hyperlink{rml__base_8h_a4ed20a063cd3c001902fe1b5b821f8b9}{RML\_PURE}}(\mbox{\hyperlink{classrml_1_1client_a0dc06ede570f7ee6d3021862cb71119f}{size\_type}})}
\DoxyCodeLine{00082\ }
\DoxyCodeLine{00084\ \ \ \ \ virtual\ \mbox{\hyperlink{namespacestd}{std}}::\textcolor{keywordtype}{size\_t}\ min\_stack\_size()\ const\ \mbox{\hyperlink{rml__base_8h_a4ed20a063cd3c001902fe1b5b821f8b9}{RML\_PURE}}(\mbox{\hyperlink{namespacestd}{std}}::\textcolor{keywordtype}{size\_t})}
\DoxyCodeLine{00085\ }
\DoxyCodeLine{00087\ \ \ \ \ virtual\ \mbox{\hyperlink{classrml_1_1client_a684e4fee23d24f9d9d150eb38f2d254f}{job}}*\ create\_one\_job()\ \mbox{\hyperlink{rml__base_8h_a4ed20a063cd3c001902fe1b5b821f8b9}{RML\_PURE}}(\mbox{\hyperlink{classrml_1_1client_a684e4fee23d24f9d9d150eb38f2d254f}{job}}*)}
\DoxyCodeLine{00088\ }
\DoxyCodeLine{00090\ }
\DoxyCodeLine{00092\ \ \ \ \ virtual\ \textcolor{keywordtype}{void}\ acknowledge\_close\_connection()\ \mbox{\hyperlink{rml__base_8h_a4ed20a063cd3c001902fe1b5b821f8b9}{RML\_PURE}}(\textcolor{keywordtype}{void})}
\DoxyCodeLine{00093\ }
\DoxyCodeLine{00094\ \ \ \ \ enum\ policy\_type\ \{turnaround,\mbox{\hyperlink{structthroughput}{throughput}}\};}
\DoxyCodeLine{00095\ }
\DoxyCodeLine{00097\ \ \ \ \ \textcolor{keyword}{virtual}\ policy\_type\ policy()\ const\ \mbox{\hyperlink{rml__base_8h_a4ed20a063cd3c001902fe1b5b821f8b9}{RML\_PURE}}(policy\_type)}
\DoxyCodeLine{00098\ }
\DoxyCodeLine{00100\ }
\DoxyCodeLine{00103\ \ \ \ \ virtual\ \textcolor{keywordtype}{void}\ cleanup(\ \mbox{\hyperlink{classrml_1_1job}{job}}\&\ )\ \mbox{\hyperlink{rml__base_8h_a4ed20a063cd3c001902fe1b5b821f8b9}{RML\_PURE}}(\textcolor{keywordtype}{void})}
\DoxyCodeLine{00104\ }
\DoxyCodeLine{00105\ \ \ \ \ \textcolor{comment}{//\ In\ general,\ we\ should\ not\ add\ new\ virtual\ methods,\ because\ that\ would\ }}
\DoxyCodeLine{00106\ \ \ \ \ \textcolor{comment}{//\ break\ derived\ classes.\ \ Think\ about\ reserving\ some\ vtable\ slots.\ \ }}
\DoxyCodeLine{00107\ \};}
\DoxyCodeLine{00108\ }
\DoxyCodeLine{00109\ \textcolor{comment}{//\ Information\ that\ server\ provides\ to\ client.}}
\DoxyCodeLine{00110\ \textcolor{comment}{//\ Virtual\ functions\ are\ routines\ provided\ by\ the\ server\ for\ the\ client\ to\ call.\ }}
\DoxyCodeLine{00111\ class\ \mbox{\hyperlink{classrml_1_1server}{server}}:\ public\ \mbox{\hyperlink{classrml_1_1versioned__object}{versioned\_object}}\ \{}
\DoxyCodeLine{00112\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00114\ \ \ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{classrml_1_1job}{::rml::job}}\ \mbox{\hyperlink{classrml_1_1server_ac812e52a5bb3de275e624c36997eac0e}{job}};}
\DoxyCodeLine{00115\ }
\DoxyCodeLine{00116\ \textcolor{preprocessor}{\#if\ \_WIN32||\_WIN64}}
\DoxyCodeLine{00117\ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keywordtype}{void}*\ execution\_resource\_t;}
\DoxyCodeLine{00118\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00119\ }
\DoxyCodeLine{00121\ }
\DoxyCodeLine{00129\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1server_a3119d8d6c2d17932610653f6fda4f87a}{request\_close\_connection}}(\ \textcolor{keywordtype}{bool}\ exiting\ =\ \textcolor{keyword}{false}\ )\ =\ 0;}
\DoxyCodeLine{00130\ }
\DoxyCodeLine{00132\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1server_a53e1efc4cb441f962e14af14e49b9fba}{yield}}()\ =\ 0;}
\DoxyCodeLine{00133\ }
\DoxyCodeLine{00135\ }
\DoxyCodeLine{00139\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1server_a45154e61e7c6b60b51d53dacd1d03c2f}{independent\_thread\_number\_changed}}(\ \textcolor{keywordtype}{int}\ delta\ )\ =\ 0;}
\DoxyCodeLine{00140\ }
\DoxyCodeLine{00142\ }
\DoxyCodeLine{00144\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{classrml_1_1server_ab724107e297226ef26538315091a50b1}{default\_concurrency}}()\ \textcolor{keyword}{const}\ =\ 0;}
\DoxyCodeLine{00145\ }
\DoxyCodeLine{00146\ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00147\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}*\&\ \mbox{\hyperlink{classrml_1_1server_a47652c7b5e9f14341264bdf5b5fa7aca}{scratch\_ptr}}(\ \mbox{\hyperlink{classrml_1_1server_ac812e52a5bb3de275e624c36997eac0e}{job}}\&\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}\ )\ \{\textcolor{keywordflow}{return}\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}.scratch\_ptr;\}}
\DoxyCodeLine{00148\ \};}
\DoxyCodeLine{00149\ }
\DoxyCodeLine{00150\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classrml_1_1factory}{factory}}\ \{}
\DoxyCodeLine{00151\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00153\ \ \ \ \ \textcolor{keyword}{enum}\ \mbox{\hyperlink{classrml_1_1factory_a4c1de6c79581a01b37d4ff16340e44c9}{status\_type}}\ \{}
\DoxyCodeLine{00154\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1factory_a4c1de6c79581a01b37d4ff16340e44c9ab17cc17f8e8e7c38d2f2504455530c02}{st\_success}}=0,}
\DoxyCodeLine{00155\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1factory_a4c1de6c79581a01b37d4ff16340e44c9ababbc974b5ca88b3f23d62d264efdeda}{st\_connection\_exists}},}
\DoxyCodeLine{00156\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1factory_a4c1de6c79581a01b37d4ff16340e44c9a6500bb84354675cd3058c07cab66e337}{st\_not\_found}},}
\DoxyCodeLine{00157\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1factory_a4c1de6c79581a01b37d4ff16340e44c9a040447afa0dd0d2a28aa7fb1b75e2fe7}{st\_incompatible}}}
\DoxyCodeLine{00158\ \ \ \ \ \};}
\DoxyCodeLine{00159\ }
\DoxyCodeLine{00161\ \ \ \ \ \textcolor{keywordtype}{void}*\ \mbox{\hyperlink{classrml_1_1factory_a777c37aa94b84c7a7a3cdfa584361523}{scratch\_ptr}};}
\DoxyCodeLine{00162\ }
\DoxyCodeLine{00163\ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00165\ \ \ \ \ \mbox{\hyperlink{classrml_1_1factory_a4c1de6c79581a01b37d4ff16340e44c9}{status\_type}}\ (*\mbox{\hyperlink{classrml_1_1factory_ac6b17e29d9a1ca3a2934ca8eab9deeaa}{my\_wait\_to\_close\_routine}})(\ \mbox{\hyperlink{classrml_1_1factory}{factory}}\&\ );}
\DoxyCodeLine{00166\ }
\DoxyCodeLine{00167\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00169\ \textcolor{preprocessor}{\#if\ \_WIN32||\_WIN64}}
\DoxyCodeLine{00170\ \ \ \ \ HMODULE\ \mbox{\hyperlink{classrml_1_1factory_a51d29a39a9a8fb6b9a4b5939daa96c0b}{library\_handle}};}
\DoxyCodeLine{00171\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00172\ \ \ \ \ \textcolor{keywordtype}{void}*\ \mbox{\hyperlink{classrml_1_1factory_a51d29a39a9a8fb6b9a4b5939daa96c0b}{library\_handle}};}
\DoxyCodeLine{00173\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{/*\ \_WIN32||\_WIN64\ */}\textcolor{preprocessor}{\ }}
\DoxyCodeLine{00174\ }
\DoxyCodeLine{00176\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ std::size\_t\ \mbox{\hyperlink{classrml_1_1factory_af2a2bf036a274ad5d7f5d8fc1709ad16}{c\_dont\_unload}}\ =\ 1;}
\DoxyCodeLine{00177\ \};}
\DoxyCodeLine{00178\ }
\DoxyCodeLine{00180\ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{ittnotify__static_8h_a61af67d9d838a9497ca5b188dabc1aa0}{void}}\ (*\mbox{\hyperlink{namespacerml_a752ed261dc96cd6835d603ae74fb37ff}{server\_info\_callback\_t}})(\ \textcolor{keywordtype}{void}*\ \mbox{\hyperlink{mimalloc_8h_ac9ca0390aa991912667416f6baf99e51}{arg}},\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ server\_info\ );}
\DoxyCodeLine{00181\ }
\DoxyCodeLine{00182\ \}\ \textcolor{comment}{//\ namespace\ rml}}
\DoxyCodeLine{00183\ }
\DoxyCodeLine{00184\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{/*\ \_\_RML\_rml\_base\_H\ */}\textcolor{preprocessor}{}}

\end{DoxyCode}
