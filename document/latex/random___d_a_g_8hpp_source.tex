\doxysection{random\+\_\+\+DAG.\+hpp}
\hypertarget{random___d_a_g_8hpp_source}{}\label{random___d_a_g_8hpp_source}\index{external/taskflow/unittests/cuda/details/random\_DAG.hpp@{external/taskflow/unittests/cuda/details/random\_DAG.hpp}}
\mbox{\hyperlink{random___d_a_g_8hpp}{浏览该文件的文档.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00002\ }
\DoxyCodeLine{00003\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{graph__base_8hpp}{./graph\_base.hpp}}"{}}}
\DoxyCodeLine{00004\ }
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#include\ <random>}}
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#include\ <algorithm>}}
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#include\ <vector>}}
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#include\ <cstring>}}
\DoxyCodeLine{00009\ }
\DoxyCodeLine{00010\ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00011\ \textcolor{comment}{//RandomDAG}}
\DoxyCodeLine{00012\ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00013\ }
\DoxyCodeLine{00014\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_random_d_a_g_aa6733c65cb8ff49fbe871fc033442c34}{RandomDAG}}:\ \textcolor{keyword}{public}\ \mbox{\hyperlink{class_graph_adf9c0d1e8f062e76cd0786031e20c259}{Graph}}\ \{}
\DoxyCodeLine{00015\ }
\DoxyCodeLine{00016\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00017\ }
\DoxyCodeLine{00018\ \ \ \ \ \mbox{\hyperlink{class_random_d_a_g_aa6733c65cb8ff49fbe871fc033442c34}{RandomDAG}}(}
\DoxyCodeLine{00019\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a2b536fca24f51d6a849aed325793e661}{level}},\ \textcolor{keywordtype}{size\_t}\ max\_nodes\_per\_level,\ \textcolor{keywordtype}{size\_t}\ max\_edges\_per\_node}
\DoxyCodeLine{00020\ \ \ \ \ );}
\DoxyCodeLine{00021\ }
\DoxyCodeLine{00022\ \ \ \ \ \mbox{\hyperlink{class_random_d_a_g_a614f411724001b667113884084bc882d}{\string~RandomDAG}}();}
\DoxyCodeLine{00023\ }
\DoxyCodeLine{00024\ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{class_random_d_a_g_a8802ae798a51407535169b6ceaa9179d}{num\_nodes}}()\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{class_graph_a5019f117fb94382e737a11127d161ab1}{\_num\_nodes}};\ \}}
\DoxyCodeLine{00025\ }
\DoxyCodeLine{00026\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_random_d_a_g_ae84ebe43b8bced772e287d29c7d9ae3d}{draw\_task\_graph}}(\mbox{\hyperlink{classtf_1_1_taskflow}{tf::Taskflow}}\&\ \mbox{\hyperlink{poisson_8hpp_aa56fe360bb0ae38e0082f49e394ff825}{taskflow}},\ \textcolor{keywordtype}{int}\ dev\_id);}
\DoxyCodeLine{00027\ }
\DoxyCodeLine{00028\ \ \ \ \ \textcolor{comment}{//inline\ void\ print\_graph(std::ostream\&\ os);}}
\DoxyCodeLine{00029\ }
\DoxyCodeLine{00030\ \ \ \ \ \textcolor{comment}{//inline\ bool\ traversed();}}
\DoxyCodeLine{00031\ }
\DoxyCodeLine{00032\ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00033\ }
\DoxyCodeLine{00034\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{class_random_d_a_g_a1d2d0fce5343d447368bb4841dcb6f66}{\_max\_nodes\_per\_level}};}
\DoxyCodeLine{00035\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{class_random_d_a_g_ac20978497a3fa1aaa888ebd0a4123979}{\_max\_edges\_per\_node}};}
\DoxyCodeLine{00036\ }
\DoxyCodeLine{00037\ \};}
\DoxyCodeLine{00038\ }
\DoxyCodeLine{00039\ \mbox{\hyperlink{class_random_d_a_g_aa6733c65cb8ff49fbe871fc033442c34}{RandomDAG::RandomDAG}}(}
\DoxyCodeLine{00040\ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a2b536fca24f51d6a849aed325793e661}{level}},\ \textcolor{keywordtype}{size\_t}\ max\_nodes\_per\_level,\ \textcolor{keywordtype}{size\_t}\ max\_edges\_per\_node}
\DoxyCodeLine{00041\ )}
\DoxyCodeLine{00042\ :\ \mbox{\hyperlink{class_graph_adf9c0d1e8f062e76cd0786031e20c259}{Graph}}\{\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a2b536fca24f51d6a849aed325793e661}{level}}\},\ \mbox{\hyperlink{class_random_d_a_g_a1d2d0fce5343d447368bb4841dcb6f66}{\_max\_nodes\_per\_level}}\{max\_nodes\_per\_level\},}
\DoxyCodeLine{00043\ \ \ \mbox{\hyperlink{class_random_d_a_g_ac20978497a3fa1aaa888ebd0a4123979}{\_max\_edges\_per\_node}}\{max\_edges\_per\_node\}}
\DoxyCodeLine{00044\ \{}
\DoxyCodeLine{00045\ }
\DoxyCodeLine{00046\ \ \ std::random\_device\ device;}
\DoxyCodeLine{00047\ \ \ std::mt19937\ gen(device());}
\DoxyCodeLine{00048\ \ \ std::srand(0);}
\DoxyCodeLine{00049\ \ \ std::uniform\_int\_distribution<int>\ dist(1,\ \mbox{\hyperlink{class_random_d_a_g_a1d2d0fce5343d447368bb4841dcb6f66}{\_max\_nodes\_per\_level}});}
\DoxyCodeLine{00050\ }
\DoxyCodeLine{00051\ \ \ \textcolor{keywordtype}{size\_t}\ cur\_num\_nodes\ =\ 1;\ \textcolor{comment}{//\ root}}
\DoxyCodeLine{00052\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ l\ =\ 0;\ l\ <\ \mbox{\hyperlink{class_graph_ad98d872f739b1870738fa4b8a59718b7}{\_level}};\ ++l)\ \{}
\DoxyCodeLine{00053\ \ \ \ \ std::vector<Node>\ cur\_nodes;}
\DoxyCodeLine{00054\ \ \ \ \ cur\_nodes.reserve(cur\_num\_nodes);\ \textcolor{comment}{//\ number\ of\ nodes\ at\ current\ level}}
\DoxyCodeLine{00055\ }
\DoxyCodeLine{00056\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ next\_num\_nodes\ =\ dist(gen);\ \textcolor{comment}{//number\ of\ nodes\ at\ next\ level}}
\DoxyCodeLine{00057\ }
\DoxyCodeLine{00058\ \ \ \ \ std::vector<int>\ next\_level\_nodes(next\_num\_nodes);}
\DoxyCodeLine{00059\ \ \ \ \ std::iota(next\_level\_nodes.begin(),\ next\_level\_nodes.end(),\ 0);}
\DoxyCodeLine{00060\ }
\DoxyCodeLine{00061\ \ \ \ \ \textcolor{comment}{//create\ edges\ for\ each\ node}}
\DoxyCodeLine{00062\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ =\ 0;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ <\ cur\_num\_nodes;\ ++\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ \{}
\DoxyCodeLine{00063\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(l\ !=\ \mbox{\hyperlink{class_graph_ad98d872f739b1870738fa4b8a59718b7}{\_level}}\ -\/\ 1)\ \{}
\DoxyCodeLine{00064\ \ \ \ \ \ \ \ \ std::shuffle(next\_level\_nodes.begin(),\ next\_level\_nodes.end(),\ gen);}
\DoxyCodeLine{00065\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{class_graph_a28d19ea9c7d111f55fee78331abe88bd}{edges}}\ =\ std::rand()\ \%\ \mbox{\hyperlink{class_random_d_a_g_ac20978497a3fa1aaa888ebd0a4123979}{\_max\_edges\_per\_node}}\ +\ 1;}
\DoxyCodeLine{00066\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{class_graph_a28d19ea9c7d111f55fee78331abe88bd}{edges}}\ >\ next\_num\_nodes)\ \{}
\DoxyCodeLine{00067\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_graph_a28d19ea9c7d111f55fee78331abe88bd}{edges}}\ =\ next\_num\_nodes;}
\DoxyCodeLine{00068\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00069\ }
\DoxyCodeLine{00070\ \ \ \ \ \ \ \ \ std::vector<size\_t>\ out\_nodes(}
\DoxyCodeLine{00071\ \ \ \ \ \ \ \ \ \ \ next\_level\_nodes.begin(),}
\DoxyCodeLine{00072\ \ \ \ \ \ \ \ \ \ \ next\_level\_nodes.begin()\ +\ \mbox{\hyperlink{class_graph_a28d19ea9c7d111f55fee78331abe88bd}{edges}}}
\DoxyCodeLine{00073\ \ \ \ \ \ \ \ \ );}
\DoxyCodeLine{00074\ }
\DoxyCodeLine{00075\ \ \ \ \ \ \ \ \ cur\_nodes.emplace\_back(l,\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}},\ out\_nodes);}
\DoxyCodeLine{00076\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00077\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00078\ \ \ \ \ \ \ \ \ std::vector<size\_t>\ empty;}
\DoxyCodeLine{00079\ \ \ \ \ \ \ \ \ cur\_nodes.emplace\_back(l,\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}},\ empty);}
\DoxyCodeLine{00080\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00081\ \ \ \ \ \}}
\DoxyCodeLine{00082\ }
\DoxyCodeLine{00083\ \ \ \ \ \mbox{\hyperlink{class_graph_ad31b4023e0497e3cf4a7b7cacc9703c4}{\_graph}}.emplace\_back(std::move(cur\_nodes));}
\DoxyCodeLine{00084\ }
\DoxyCodeLine{00085\ \ \ \ \ \mbox{\hyperlink{class_graph_a5019f117fb94382e737a11127d161ab1}{\_num\_nodes}}\ +=\ cur\_num\_nodes;}
\DoxyCodeLine{00086\ }
\DoxyCodeLine{00087\ \ \ \ \ cur\_num\_nodes\ =\ next\_num\_nodes;}
\DoxyCodeLine{00088\ \ \ \}}
\DoxyCodeLine{00089\ }
\DoxyCodeLine{00090\ \ \ \mbox{\hyperlink{class_graph_ab04de48a23a9b38ebc95338a51b8a9a4}{allocate\_nodes}}();}
\DoxyCodeLine{00091\ \}}
\DoxyCodeLine{00092\ }
\DoxyCodeLine{00093\ \mbox{\hyperlink{class_random_d_a_g_a614f411724001b667113884084bc882d}{RandomDAG::\string~RandomDAG}}()\ \{}
\DoxyCodeLine{00094\ \ \ \mbox{\hyperlink{class_graph_a46587f0979df055735aa838a56bedbab}{free\_nodes}}();}
\DoxyCodeLine{00095\ \}}
\DoxyCodeLine{00096\ }

\end{DoxyCode}
