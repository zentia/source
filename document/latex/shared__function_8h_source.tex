\doxysection{shared\+\_\+function.\+h}
\hypertarget{shared__function_8h_source}{}\label{shared__function_8h_source}\index{runtime/core/shared\_function.h@{runtime/core/shared\_function.h}}
\mbox{\hyperlink{shared__function_8h}{浏览该文件的文档.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00002\ }
\DoxyCodeLine{00003\ \textcolor{preprocessor}{\#include\ <atomic>}}
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#include\ <luisa/core/stl/memory.h>}}
\DoxyCodeLine{00005\ }
\DoxyCodeLine{00006\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespaceluisa}{luisa}}\ \{}
\DoxyCodeLine{00007\ }
\DoxyCodeLine{00008\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ Func>}
\DoxyCodeLine{00009\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classluisa_1_1_shared_function}{SharedFunction}};}
\DoxyCodeLine{00010\ }
\DoxyCodeLine{00011\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ Ret,\ \textcolor{keyword}{typename}...\ Args>}
\DoxyCodeLine{00012\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classluisa_1_1_shared_function_3_01_ret_07_args_8_8_8_08_4_a324081aebd52ef72ddf519b692ad7e50}{SharedFunction}}<Ret(Args...)>\ \{}
\DoxyCodeLine{00013\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structluisa_1_1_shared_function_3_01_ret_07_args_8_8_8_08_4_1_1_shared_function_base}{SharedFunctionBase}}\ \{}
\DoxyCodeLine{00014\ \ \ \ \ \ \ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{structluisa_1_1_shared_function_3_01_ret_07_args_8_8_8_08_4_1_1_shared_function_base_a104c9f26cd1320a9070e2cae7b482bc1}{dtor\_type}}\ =\ \mbox{\hyperlink{mimalloc_8h_a9d6d8aef94ac19034a5f163606f84830}{void}}\ (*)(\textcolor{keywordtype}{void}\ *);}
\DoxyCodeLine{00015\ \ \ \ \ \ \ \ \ std::atomic\_uint32\_t\ \mbox{\hyperlink{structluisa_1_1_shared_function_3_01_ret_07_args_8_8_8_08_4_1_1_shared_function_base_a35a313915b500e7500d66cfc7145792f}{ref}}\{1\};}
\DoxyCodeLine{00016\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{eabase_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t}}\ \mbox{\hyperlink{structluisa_1_1_shared_function_3_01_ret_07_args_8_8_8_08_4_1_1_shared_function_base_a3298b1fa9a65cb59a99ebd6d849173ec}{align}}\{\};}
\DoxyCodeLine{00017\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structluisa_1_1_shared_function_3_01_ret_07_args_8_8_8_08_4_1_1_shared_function_base_a104c9f26cd1320a9070e2cae7b482bc1}{dtor\_type}}\ \mbox{\hyperlink{structluisa_1_1_shared_function_3_01_ret_07_args_8_8_8_08_4_1_1_shared_function_base_a5d15e8c17fa855eb741ffd5d04c79737}{dtor}}\{\textcolor{keyword}{nullptr}\};}
\DoxyCodeLine{00018\ \ \ \ \ \};}
\DoxyCodeLine{00019\ \ \ \ \ \mbox{\hyperlink{structluisa_1_1_shared_function_3_01_ret_07_args_8_8_8_08_4_1_1_shared_function_base}{SharedFunctionBase}}\ *\mbox{\hyperlink{classluisa_1_1_shared_function_3_01_ret_07_args_8_8_8_08_4_afa83fed7c986f0adb24ced137c18b760}{\_base}};}
\DoxyCodeLine{00020\ \ \ \ \ Ret\ (*\mbox{\hyperlink{classluisa_1_1_shared_function_3_01_ret_07_args_8_8_8_08_4_a4c1e74242179c11d61e0a7b45e9926f2}{\_func\_ptr}})(\textcolor{keywordtype}{void}\ *,\ Args\ \&\&...);}
\DoxyCodeLine{00021\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classluisa_1_1_shared_function_3_01_ret_07_args_8_8_8_08_4_a01339e19ee261d2b7c46e89c66077ed8}{\_dispose}}()\ noexcept\ \{}
\DoxyCodeLine{00022\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classluisa_1_1_shared_function_3_01_ret_07_args_8_8_8_08_4_afa83fed7c986f0adb24ced137c18b760}{\_base}})\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00023\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (-\/-\/\mbox{\hyperlink{classluisa_1_1_shared_function_3_01_ret_07_args_8_8_8_08_4_afa83fed7c986f0adb24ced137c18b760}{\_base}}-\/>ref\ ==\ 0)\ \{}
\DoxyCodeLine{00024\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classluisa_1_1_shared_function_3_01_ret_07_args_8_8_8_08_4_afa83fed7c986f0adb24ced137c18b760}{\_base}}-\/>dtor)\ \{}
\DoxyCodeLine{00025\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classluisa_1_1_shared_function_3_01_ret_07_args_8_8_8_08_4_afa83fed7c986f0adb24ced137c18b760}{\_base}}-\/>dtor(\mbox{\hyperlink{classluisa_1_1_shared_function_3_01_ret_07_args_8_8_8_08_4_afa83fed7c986f0adb24ced137c18b760}{\_base}});}
\DoxyCodeLine{00026\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00027\ \ \ \ \ \ \ \ \ \ \ \ \ luisa::detail::allocator\_deallocate(\mbox{\hyperlink{classluisa_1_1_shared_function_3_01_ret_07_args_8_8_8_08_4_afa83fed7c986f0adb24ced137c18b760}{\_base}},\ \mbox{\hyperlink{classluisa_1_1_shared_function_3_01_ret_07_args_8_8_8_08_4_afa83fed7c986f0adb24ced137c18b760}{\_base}}-\/>align);}
\DoxyCodeLine{00028\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00029\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classluisa_1_1_shared_function_3_01_ret_07_args_8_8_8_08_4_afa83fed7c986f0adb24ced137c18b760}{\_base}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00030\ \ \ \ \ \}}
\DoxyCodeLine{00031\ }
\DoxyCodeLine{00032\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00033\ \ \ \ \ \mbox{\hyperlink{classluisa_1_1_shared_function_3_01_ret_07_args_8_8_8_08_4_a324081aebd52ef72ddf519b692ad7e50}{SharedFunction}}()\ noexcept\ :\ \mbox{\hyperlink{classluisa_1_1_shared_function_3_01_ret_07_args_8_8_8_08_4_afa83fed7c986f0adb24ced137c18b760}{\_base}}\{\textcolor{keyword}{nullptr}\},\ \_func\_ptr\{\}\ \{\}}
\DoxyCodeLine{00034\ \ \ \ \ \mbox{\hyperlink{classluisa_1_1_shared_function_3_01_ret_07_args_8_8_8_08_4_a99235d96e5a347d27c040263418fd816}{\string~SharedFunction}}()\ noexcept\ \{\ \mbox{\hyperlink{classluisa_1_1_shared_function_3_01_ret_07_args_8_8_8_08_4_a01339e19ee261d2b7c46e89c66077ed8}{\_dispose}}();\ \}}
\DoxyCodeLine{00035\ \ \ \ \ Ret\ \mbox{\hyperlink{classluisa_1_1_shared_function_3_01_ret_07_args_8_8_8_08_4_af1a48ffd3f815e988c599ec0afa69112}{operator()}}(Args...\ args)\ \textcolor{keyword}{const}\ \textcolor{keyword}{noexcept}\ \{}
\DoxyCodeLine{00036\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{intrin_8h_ad351e4b2eb5b3ef179845c849a96efac}{LUISA\_ASSUME}}(\mbox{\hyperlink{classluisa_1_1_shared_function_3_01_ret_07_args_8_8_8_08_4_afa83fed7c986f0adb24ced137c18b760}{\_base}});}
\DoxyCodeLine{00037\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_same\_v<Ret,\ void>)\ \{}
\DoxyCodeLine{00038\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classluisa_1_1_shared_function_3_01_ret_07_args_8_8_8_08_4_a4c1e74242179c11d61e0a7b45e9926f2}{\_func\_ptr}}(\mbox{\hyperlink{classluisa_1_1_shared_function_3_01_ret_07_args_8_8_8_08_4_afa83fed7c986f0adb24ced137c18b760}{\_base}},\ std::forward<Args>(args)...);}
\DoxyCodeLine{00039\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00040\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classluisa_1_1_shared_function_3_01_ret_07_args_8_8_8_08_4_a4c1e74242179c11d61e0a7b45e9926f2}{\_func\_ptr}}(\mbox{\hyperlink{classluisa_1_1_shared_function_3_01_ret_07_args_8_8_8_08_4_afa83fed7c986f0adb24ced137c18b760}{\_base}},\ std::forward<Args>(args)...);}
\DoxyCodeLine{00041\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00042\ \ \ \ \ \}}
\DoxyCodeLine{00043\ \ \ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ F>}
\DoxyCodeLine{00044\ \ \ \ \ \ \ \ \ \textcolor{keyword}{requires}((!std::is\_same\_v<std::remove\_cvref\_t<F>,\ \mbox{\hyperlink{classluisa_1_1_shared_function}{SharedFunction}}>)\ \&\&\ (std::is\_invocable\_r\_v<Ret,\ F,\ Args\ \&\&\ ...>))}
\DoxyCodeLine{00045\ \ \ \ \ \mbox{\hyperlink{classluisa_1_1_shared_function_3_01_ret_07_args_8_8_8_08_4_a045ad7860819dc6ed6a4d1bbd64a3fa9}{SharedFunction}}(F\ \&\&f)\ \textcolor{keyword}{noexcept}\ \{}
\DoxyCodeLine{00046\ \ \ \ \ \ \ \ \ \textcolor{keyword}{struct\ }SharedFunctionDerive\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{structluisa_1_1_shared_function_3_01_ret_07_args_8_8_8_08_4_1_1_shared_function_base}{SharedFunctionBase}}\ \{}
\DoxyCodeLine{00047\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespaceluisa_a0ab69af3fd99602533adaa5292eb784e}{luisa::aligned\_storage\_t}}<\textcolor{keyword}{sizeof}(F),\ \textcolor{keyword}{alignof}(F)>\ storage;}
\DoxyCodeLine{00048\ \ \ \ \ \ \ \ \ \};}
\DoxyCodeLine{00049\ \ \ \ \ \ \ \ \ \textcolor{keyword}{using\ }Func\ =\ std::remove\_cvref\_t<F>;}
\DoxyCodeLine{00050\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ derive\ =\ \textcolor{keyword}{new}\ (luisa::detail::allocator\_allocate(\textcolor{keyword}{sizeof}(SharedFunctionDerive),\ \textcolor{keyword}{alignof}(SharedFunctionDerive)))\ SharedFunctionDerive();}
\DoxyCodeLine{00051\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classluisa_1_1_shared_function_3_01_ret_07_args_8_8_8_08_4_afa83fed7c986f0adb24ced137c18b760}{\_base}}\ =\ derive;}
\DoxyCodeLine{00052\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classluisa_1_1_shared_function_3_01_ret_07_args_8_8_8_08_4_afa83fed7c986f0adb24ced137c18b760}{\_base}}-\/>align\ =\ \textcolor{keyword}{alignof}(SharedFunctionDerive);}
\DoxyCodeLine{00053\ \ \ \ \ \ \ \ \ \textcolor{keyword}{new}\ (\&derive-\/>storage)\ Func(std::forward<F>(f));}
\DoxyCodeLine{00054\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_trivially\_destructible\_v<Func>)\ \{}
\DoxyCodeLine{00055\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classluisa_1_1_shared_function_3_01_ret_07_args_8_8_8_08_4_afa83fed7c986f0adb24ced137c18b760}{\_base}}-\/>dtor\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00056\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00057\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classluisa_1_1_shared_function_3_01_ret_07_args_8_8_8_08_4_afa83fed7c986f0adb24ced137c18b760}{\_base}}-\/>dtor\ =\ [](\textcolor{keywordtype}{void}\ *\mbox{\hyperlink{spdlog_2include_2spdlog_2fmt_2bundled_2format_8h_adb6e274f8eb0b74b2865215e1b49c535}{ptr}})\ \textcolor{keyword}{noexcept}\ -\/>\ \textcolor{keywordtype}{void}\ \{}
\DoxyCodeLine{00058\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{reinterpret\_cast<}Func\ *\textcolor{keyword}{>}(\&(\textcolor{keyword}{reinterpret\_cast<}SharedFunctionDerive\ *\textcolor{keyword}{>}(\mbox{\hyperlink{spdlog_2include_2spdlog_2fmt_2bundled_2format_8h_adb6e274f8eb0b74b2865215e1b49c535}{ptr}})-\/>storage))-\/>\string~Func();}
\DoxyCodeLine{00059\ \ \ \ \ \ \ \ \ \ \ \ \ \};}
\DoxyCodeLine{00060\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00061\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classluisa_1_1_shared_function_3_01_ret_07_args_8_8_8_08_4_a4c1e74242179c11d61e0a7b45e9926f2}{\_func\_ptr}}\ =\ [](\textcolor{keywordtype}{void}\ *\mbox{\hyperlink{spdlog_2include_2spdlog_2fmt_2bundled_2format_8h_adb6e274f8eb0b74b2865215e1b49c535}{ptr}},\ Args\ \&\&...args)\ \textcolor{keyword}{noexcept}\ -\/>\ Ret\ \{}
\DoxyCodeLine{00062\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ \&\&func\ =\ \textcolor{keyword}{reinterpret\_cast<}Func\ \&\textcolor{keyword}{>}((\textcolor{keyword}{reinterpret\_cast<}SharedFunctionDerive\ *\textcolor{keyword}{>}(\mbox{\hyperlink{spdlog_2include_2spdlog_2fmt_2bundled_2format_8h_adb6e274f8eb0b74b2865215e1b49c535}{ptr}})-\/>storage));}
\DoxyCodeLine{00063\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_same\_v<Ret,\ void>)\ \{}
\DoxyCodeLine{00064\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ func(std::forward<Args>(args)...);}
\DoxyCodeLine{00065\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00066\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ func(std::forward<Args>(args)...);}
\DoxyCodeLine{00067\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00068\ \ \ \ \ \ \ \ \ \};}
\DoxyCodeLine{00069\ \ \ \ \ \}}
\DoxyCodeLine{00070\ \ \ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ F>}
\DoxyCodeLine{00071\ \ \ \ \ \ \ \ \ \textcolor{keyword}{requires}(std::is\_invocable\_r\_v<Ret,\ F,\ Args\ \&\&\ ...>)}
\DoxyCodeLine{00072\ \ \ \ \ \mbox{\hyperlink{classluisa_1_1_shared_function_3_01_ret_07_args_8_8_8_08_4_a324081aebd52ef72ddf519b692ad7e50}{SharedFunction}}\ \&\textcolor{keyword}{operator}=(F\ \&\&f)\ \textcolor{keyword}{noexcept}\ \{}
\DoxyCodeLine{00073\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classluisa_1_1_shared_function_3_01_ret_07_args_8_8_8_08_4_a01339e19ee261d2b7c46e89c66077ed8}{\_dispose}}();}
\DoxyCodeLine{00074\ \ \ \ \ \ \ \ \ std::construct\_at(\textcolor{keyword}{this},\ std::forward<F>(f));}
\DoxyCodeLine{00075\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{00076\ \ \ \ \ \}}
\DoxyCodeLine{00077\ \ \ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ FuncPtr\_Ret,\ \textcolor{keyword}{typename}...\ FuncPtr\_Args>}
\DoxyCodeLine{00078\ \ \ \ \ \ \ \ \ \textcolor{keyword}{requires}(std::is\_invocable\_r\_v<Ret,\ FuncPtr\_Ret\ (*)(FuncPtr\_Args...),\ Args\ \&\&\ ...>)}
\DoxyCodeLine{00079\ \ \ \ \ \mbox{\hyperlink{classluisa_1_1_shared_function_3_01_ret_07_args_8_8_8_08_4_a8c9eacf68fda94ba769be8d684dc37e7}{SharedFunction}}(FuncPtr\_Ret\ (*func\_ptr)(FuncPtr\_Args...))\ \textcolor{keyword}{noexcept}\ \{}
\DoxyCodeLine{00080\ \ \ \ \ \ \ \ \ \textcolor{keyword}{using\ }FuncPtr\ =\ \textcolor{keyword}{decltype}(func\_ptr);}
\DoxyCodeLine{00081\ \ \ \ \ \ \ \ \ \textcolor{keyword}{struct\ }SharedFunctionDerive\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{structluisa_1_1_shared_function_3_01_ret_07_args_8_8_8_08_4_1_1_shared_function_base}{SharedFunctionBase}}\ \{}
\DoxyCodeLine{00082\ \ \ \ \ \ \ \ \ \ \ \ \ FuncPtr\ derive\_func\_ptr;}
\DoxyCodeLine{00083\ \ \ \ \ \ \ \ \ \};}
\DoxyCodeLine{00084\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ derive\ =\ \textcolor{keyword}{new}\ (luisa::detail::allocator\_allocate(\textcolor{keyword}{sizeof}(SharedFunctionDerive),\ \textcolor{keyword}{alignof}(SharedFunctionDerive)))\ SharedFunctionDerive();}
\DoxyCodeLine{00085\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classluisa_1_1_shared_function_3_01_ret_07_args_8_8_8_08_4_afa83fed7c986f0adb24ced137c18b760}{\_base}}\ =\ derive;}
\DoxyCodeLine{00086\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classluisa_1_1_shared_function_3_01_ret_07_args_8_8_8_08_4_afa83fed7c986f0adb24ced137c18b760}{\_base}}-\/>align\ =\ \textcolor{keyword}{alignof}(SharedFunctionDerive);}
\DoxyCodeLine{00087\ \ \ \ \ \ \ \ \ derive-\/>derive\_func\_ptr\ =\ func\_ptr;}
\DoxyCodeLine{00088\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classluisa_1_1_shared_function_3_01_ret_07_args_8_8_8_08_4_afa83fed7c986f0adb24ced137c18b760}{\_base}}-\/>dtor\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00089\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classluisa_1_1_shared_function_3_01_ret_07_args_8_8_8_08_4_a4c1e74242179c11d61e0a7b45e9926f2}{\_func\_ptr}}\ =\ [](\textcolor{keywordtype}{void}\ *\mbox{\hyperlink{spdlog_2include_2spdlog_2fmt_2bundled_2format_8h_adb6e274f8eb0b74b2865215e1b49c535}{ptr}},\ Args\ \&\&...args)\ \textcolor{keyword}{noexcept}\ -\/>\ Ret\ \{}
\DoxyCodeLine{00090\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ func\ =\ \textcolor{keyword}{reinterpret\_cast<}SharedFunctionDerive\ *\textcolor{keyword}{>}(\mbox{\hyperlink{spdlog_2include_2spdlog_2fmt_2bundled_2format_8h_adb6e274f8eb0b74b2865215e1b49c535}{ptr}})-\/>derive\_func\_ptr;}
\DoxyCodeLine{00091\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_same\_v<Ret,\ void>)\ \{}
\DoxyCodeLine{00092\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ func(std::forward<Args>(args)...);}
\DoxyCodeLine{00093\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00094\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ func(std::forward<Args>(args)...);}
\DoxyCodeLine{00095\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00096\ \ \ \ \ \ \ \ \ \};}
\DoxyCodeLine{00097\ \ \ \ \ \}}
\DoxyCodeLine{00098\ \ \ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ FuncPtr\_Ret,\ \textcolor{keyword}{typename}...\ FuncPtr\_Args>}
\DoxyCodeLine{00099\ \ \ \ \ \ \ \ \ \textcolor{keyword}{requires}(std::is\_invocable\_r\_v<Ret,\ FuncPtr\_Ret\ (*)(FuncPtr\_Args...),\ Args\ \&\&\ ...>)}
\DoxyCodeLine{00100\ \ \ \ \ \mbox{\hyperlink{classluisa_1_1_shared_function_3_01_ret_07_args_8_8_8_08_4_a324081aebd52ef72ddf519b692ad7e50}{SharedFunction}}\ \&\textcolor{keyword}{operator}=(FuncPtr\_Ret\ (*func\_ptr)(FuncPtr\_Args...))\ \textcolor{keyword}{noexcept}\ \{}
\DoxyCodeLine{00101\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classluisa_1_1_shared_function_3_01_ret_07_args_8_8_8_08_4_a01339e19ee261d2b7c46e89c66077ed8}{\_dispose}}();}
\DoxyCodeLine{00102\ \ \ \ \ \ \ \ \ std::construct\_at(\textcolor{keyword}{this},\ func\_ptr);}
\DoxyCodeLine{00103\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{00104\ \ \ \ \ \}}
\DoxyCodeLine{00105\ \ \ \ \ \mbox{\hyperlink{classluisa_1_1_shared_function_3_01_ret_07_args_8_8_8_08_4_a0433739e0331f982f20ed1004114ebc2}{SharedFunction}}(\mbox{\hyperlink{classluisa_1_1_shared_function_3_01_ret_07_args_8_8_8_08_4_a324081aebd52ef72ddf519b692ad7e50}{SharedFunction}}\ \textcolor{keyword}{const}\ \&\mbox{\hyperlink{offscreen_8c_ad0da36b2558901e21e7a30f6c227a45e}{x}})\ \textcolor{keyword}{noexcept}\ \{}
\DoxyCodeLine{00106\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{offscreen_8c_ad0da36b2558901e21e7a30f6c227a45e}{x}}.\_base)\ \{}
\DoxyCodeLine{00107\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classluisa_1_1_shared_function_3_01_ret_07_args_8_8_8_08_4_afa83fed7c986f0adb24ced137c18b760}{\_base}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00108\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00109\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00110\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classluisa_1_1_shared_function_3_01_ret_07_args_8_8_8_08_4_afa83fed7c986f0adb24ced137c18b760}{\_base}}\ =\ \mbox{\hyperlink{offscreen_8c_ad0da36b2558901e21e7a30f6c227a45e}{x}}.\_base;}
\DoxyCodeLine{00111\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classluisa_1_1_shared_function_3_01_ret_07_args_8_8_8_08_4_a4c1e74242179c11d61e0a7b45e9926f2}{\_func\_ptr}}\ =\ \mbox{\hyperlink{offscreen_8c_ad0da36b2558901e21e7a30f6c227a45e}{x}}.\_func\_ptr;}
\DoxyCodeLine{00112\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classluisa_1_1_shared_function_3_01_ret_07_args_8_8_8_08_4_afa83fed7c986f0adb24ced137c18b760}{\_base}}-\/>ref++;}
\DoxyCodeLine{00113\ \ \ \ \ \}}
\DoxyCodeLine{00114\ \ \ \ \ \mbox{\hyperlink{classluisa_1_1_shared_function_3_01_ret_07_args_8_8_8_08_4_a0398d85ca4e82723d58a023f4e36e666}{SharedFunction}}(\mbox{\hyperlink{classluisa_1_1_shared_function_3_01_ret_07_args_8_8_8_08_4_a324081aebd52ef72ddf519b692ad7e50}{SharedFunction}}\ \&\&\mbox{\hyperlink{offscreen_8c_ad0da36b2558901e21e7a30f6c227a45e}{x}})\ \textcolor{keyword}{noexcept}\ \{}
\DoxyCodeLine{00115\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classluisa_1_1_shared_function_3_01_ret_07_args_8_8_8_08_4_afa83fed7c986f0adb24ced137c18b760}{\_base}}\ =\ \mbox{\hyperlink{offscreen_8c_ad0da36b2558901e21e7a30f6c227a45e}{x}}.\_base;}
\DoxyCodeLine{00116\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classluisa_1_1_shared_function_3_01_ret_07_args_8_8_8_08_4_a4c1e74242179c11d61e0a7b45e9926f2}{\_func\_ptr}}\ =\ \mbox{\hyperlink{offscreen_8c_ad0da36b2558901e21e7a30f6c227a45e}{x}}.\_func\_ptr;}
\DoxyCodeLine{00117\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{offscreen_8c_ad0da36b2558901e21e7a30f6c227a45e}{x}}.\_base\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00118\ \ \ \ \ \}}
\DoxyCodeLine{00119\ \ \ \ \ \mbox{\hyperlink{classluisa_1_1_shared_function_3_01_ret_07_args_8_8_8_08_4_a324081aebd52ef72ddf519b692ad7e50}{SharedFunction}}\ \&\mbox{\hyperlink{classluisa_1_1_shared_function_3_01_ret_07_args_8_8_8_08_4_a1f5f0808f6ca9bb226bf05d7aa074091}{operator=}}(\mbox{\hyperlink{classluisa_1_1_shared_function_3_01_ret_07_args_8_8_8_08_4_a324081aebd52ef72ddf519b692ad7e50}{SharedFunction}}\ \textcolor{keyword}{const}\ \&\mbox{\hyperlink{offscreen_8c_ad0da36b2558901e21e7a30f6c227a45e}{x}})\ \textcolor{keyword}{noexcept}\ \{}
\DoxyCodeLine{00120\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\&\mbox{\hyperlink{offscreen_8c_ad0da36b2558901e21e7a30f6c227a45e}{x}}\ ==\ \textcolor{keyword}{this})\ [[unlikely]]}
\DoxyCodeLine{00121\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{00122\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classluisa_1_1_shared_function_3_01_ret_07_args_8_8_8_08_4_a01339e19ee261d2b7c46e89c66077ed8}{\_dispose}}();}
\DoxyCodeLine{00123\ \ \ \ \ \ \ \ \ std::destroy\_at(\textcolor{keyword}{this});}
\DoxyCodeLine{00124\ \ \ \ \ \ \ \ \ std::construct\_at(\textcolor{keyword}{this},\ \mbox{\hyperlink{offscreen_8c_ad0da36b2558901e21e7a30f6c227a45e}{x}});}
\DoxyCodeLine{00125\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{00126\ \ \ \ \ \}}
\DoxyCodeLine{00127\ \ \ \ \ \mbox{\hyperlink{classluisa_1_1_shared_function_3_01_ret_07_args_8_8_8_08_4_a324081aebd52ef72ddf519b692ad7e50}{SharedFunction}}\ \&\mbox{\hyperlink{classluisa_1_1_shared_function_3_01_ret_07_args_8_8_8_08_4_a262489b477352cd3e77661112f12b7e5}{operator=}}(\mbox{\hyperlink{classluisa_1_1_shared_function_3_01_ret_07_args_8_8_8_08_4_a324081aebd52ef72ddf519b692ad7e50}{SharedFunction}}\ \&\&\mbox{\hyperlink{offscreen_8c_ad0da36b2558901e21e7a30f6c227a45e}{x}})\ \textcolor{keyword}{noexcept}\ \{}
\DoxyCodeLine{00128\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classluisa_1_1_shared_function_3_01_ret_07_args_8_8_8_08_4_a01339e19ee261d2b7c46e89c66077ed8}{\_dispose}}();}
\DoxyCodeLine{00129\ \ \ \ \ \ \ \ \ std::construct\_at(\textcolor{keyword}{this},\ std::move(\mbox{\hyperlink{offscreen_8c_ad0da36b2558901e21e7a30f6c227a45e}{x}}));}
\DoxyCodeLine{00130\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{00131\ \ \ \ \ \}}
\DoxyCodeLine{00132\ \};}
\DoxyCodeLine{00133\ }
\DoxyCodeLine{00134\ \}\textcolor{comment}{//\ namespace\ luisa}}

\end{DoxyCode}
