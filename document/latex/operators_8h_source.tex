\doxysection{operators.\+h}
\hypertarget{operators_8h_source}{}\label{operators_8h_source}\index{runtime/dsl/operators.h@{runtime/dsl/operators.h}}
\mbox{\hyperlink{operators_8h}{浏览该文件的文档.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00002\ }
\DoxyCodeLine{00003\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{basic__types_8h}{runtime/core/basic\_types.h}}>}}
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{expr__traits_8h}{runtime/dsl/expr\_traits.h}}>}}
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{expr_8h}{runtime/dsl/expr.h}}>}}
\DoxyCodeLine{00006\ }
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#define\ LUISA\_MAKE\_GLOBAL\_DSL\_UNARY\_OP(op,\ op\_tag)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\ \ \ \ template<typename\ T>\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ requires\ luisa::compute::is\_dsl\_v<T>\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\ \ \ \ [[nodiscard]]\ inline\ auto\ operator\ op(T\ \&\&expr)\ noexcept\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00012\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ using\ R\ =\ std::remove\_cvref\_t<\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00013\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ decltype(op\ std::declval<luisa::compute::expr\_value\_t<T>>())>;\ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ return\ luisa::compute::dsl::def<R>(\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ luisa::compute::detail::FunctionBuilder::current()-\/>unary(\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ luisa::compute::Type::of<R>(),\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ luisa::compute::UnaryOp::op\_tag,\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ luisa::compute::detail::extract\_expression(std::forward<T>(expr))));\ \(\backslash\)}}
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\ \ \ \ \}}}
\DoxyCodeLine{00020\ \mbox{\hyperlink{operators_8h_a49731cc099102730d496087b3e9b4cb1}{LUISA\_MAKE\_GLOBAL\_DSL\_UNARY\_OP}}(+,\ PLUS)}
\DoxyCodeLine{00021\ \mbox{\hyperlink{operators_8h_a49731cc099102730d496087b3e9b4cb1}{LUISA\_MAKE\_GLOBAL\_DSL\_UNARY\_OP}}(-\/,\ MINUS)}
\DoxyCodeLine{00022\ \mbox{\hyperlink{operators_8h_a49731cc099102730d496087b3e9b4cb1}{LUISA\_MAKE\_GLOBAL\_DSL\_UNARY\_OP}}(!,\ NOT)}
\DoxyCodeLine{00023\ \mbox{\hyperlink{operators_8h_a49731cc099102730d496087b3e9b4cb1}{LUISA\_MAKE\_GLOBAL\_DSL\_UNARY\_OP}}(\string~,\ BIT\_NOT)}
\DoxyCodeLine{00024\ \textcolor{preprocessor}{\#undef\ LUISA\_MAKE\_GLOBAL\_DSL\_UNARY\_OP}}
\DoxyCodeLine{00025\ }
\DoxyCodeLine{00026\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespaceluisa_1_1compute_1_1detail}{luisa::compute::detail}}\ \{}
\DoxyCodeLine{00027\ }
\DoxyCodeLine{00028\ \textcolor{keyword}{template}<\textcolor{keyword}{typename},\ \textcolor{keyword}{typename}>\textcolor{comment}{//\ for\ better\ warning\ messages}}
\DoxyCodeLine{00029\ [[deprecated(}
\DoxyCodeLine{00030\ \ \ \ \ \textcolor{stringliteral}{"{}\(\backslash\)n\(\backslash\)n"{}}}
\DoxyCodeLine{00031\ \ \ \ \ \textcolor{stringliteral}{"{}Implicit\ conversion\ between\ floating-\/point\ and\ integral\ values\ detected.\(\backslash\)n"{}}}
\DoxyCodeLine{00032\ \ \ \ \ \textcolor{stringliteral}{"{}LuisaCompute\ DSL\ will\ automatically\ insert\ type\ conversions\ to\ make\ the\(\backslash\)n"{}}}
\DoxyCodeLine{00033\ \ \ \ \ \textcolor{stringliteral}{"{}code\ compile,\ but\ this\ is\ not\ recommended\ and\ could\ be\ error\ prone.\(\backslash\)n"{}}}
\DoxyCodeLine{00034\ \ \ \ \ \textcolor{stringliteral}{"{}Please\ consider\ explicitly\ casting\ the\ operands\ of\ the\ binary\ operator.\(\backslash\)n"{}}}
\DoxyCodeLine{00035\ \ \ \ \ \textcolor{stringliteral}{"{}\(\backslash\)n"{}})]]}
\DoxyCodeLine{00036\ \textcolor{comment}{//\ empty\ function\ to\ generate\ a\ warning}}
\DoxyCodeLine{00037\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}}
\DoxyCodeLine{00038\ \mbox{\hyperlink{namespaceluisa_1_1compute_1_1detail_abfd4098c904a816cc9d5cbe2f278cd5d}{dsl\_binary\_op\_fp\_integral\_implicit\_conversion\_detected}}()\ noexcept\ \{\}}
\DoxyCodeLine{00039\ }
\DoxyCodeLine{00040\ \textcolor{keyword}{template}<BinaryOp\ op,\ \textcolor{keyword}{typename}\ Lhs,\ \textcolor{keyword}{typename}\ Rhs>}
\DoxyCodeLine{00041\ \textcolor{keyword}{constexpr}\ \textcolor{keyword}{auto}\textcolor{comment}{//\ (ret,\ lhs\_cast,\ rhs\_cast)}}
\DoxyCodeLine{00042\ \mbox{\hyperlink{namespaceluisa_1_1compute_1_1detail_a4182774544e0d34092908af90cc91969}{dsl\_binary\_op\_return\_type\_helper}}()\ noexcept\ \{}
\DoxyCodeLine{00043\ }
\DoxyCodeLine{00044\ \ \ \ \ \textcolor{keyword}{static\_assert}(!\mbox{\hyperlink{namespaceluisa_1_1compute_a89874f92249c728674ee00b5a88e6bc7}{any\_dsl\_v<Lhs,\ Rhs>}});}
\DoxyCodeLine{00045\ }
\DoxyCodeLine{00046\ \ \ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keyword}{auto}\ lhs\_is\_scalar\ =\ luisa::is\_scalar\_v<Lhs>;}
\DoxyCodeLine{00047\ \ \ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keyword}{auto}\ rhs\_is\_scalar\ =\ luisa::is\_scalar\_v<Rhs>;}
\DoxyCodeLine{00048\ \ \ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keyword}{auto}\ lhs\_is\_vector\ =\ luisa::is\_vector\_v<Lhs>;}
\DoxyCodeLine{00049\ \ \ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keyword}{auto}\ rhs\_is\_vector\ =\ luisa::is\_vector\_v<Rhs>;}
\DoxyCodeLine{00050\ \ \ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keyword}{auto}\ lhs\_is\_matrix\ =\ luisa::is\_matrix\_v<Lhs>;}
\DoxyCodeLine{00051\ \ \ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keyword}{auto}\ rhs\_is\_matrix\ =\ luisa::is\_matrix\_v<Rhs>;}
\DoxyCodeLine{00052\ \ \ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keyword}{auto}\ lhs\_is\_integral\ =\ luisa::is\_integral\_or\_vector\_v<Lhs>;}
\DoxyCodeLine{00053\ \ \ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keyword}{auto}\ rhs\_is\_integral\ =\ luisa::is\_integral\_or\_vector\_v<Rhs>;}
\DoxyCodeLine{00054\ \ \ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keyword}{auto}\ lhs\_is\_boolean\ =\ luisa::is\_boolean\_or\_vector\_v<Lhs>;}
\DoxyCodeLine{00055\ \ \ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keyword}{auto}\ rhs\_is\_boolean\ =\ luisa::is\_boolean\_or\_vector\_v<Rhs>;}
\DoxyCodeLine{00056\ \ \ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keyword}{auto}\ lhs\_is\_fp\ =\ \mbox{\hyperlink{namespaceluisa_a9d92e26211174f2bfc1f4ec838f3b2ea}{is\_floating\_point\_or\_vector\_v<Lhs>}}\ ||\ \mbox{\hyperlink{namespaceluisa_a25fea374296bcd8c68f7eeb2d87cea28}{is\_matrix\_v<Lhs>}};}
\DoxyCodeLine{00057\ \ \ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keyword}{auto}\ rhs\_is\_fp\ =\ \mbox{\hyperlink{namespaceluisa_a9d92e26211174f2bfc1f4ec838f3b2ea}{is\_floating\_point\_or\_vector\_v<Rhs>}}\ ||\ \mbox{\hyperlink{namespaceluisa_a25fea374296bcd8c68f7eeb2d87cea28}{is\_matrix\_v<Rhs>}};}
\DoxyCodeLine{00058\ }
\DoxyCodeLine{00059\ \ \ \ \ \textcolor{keyword}{using\ }lhs\_elem\ =\ std::conditional\_t<lhs\_is\_matrix,\ float,\ vector\_element\_t<Lhs>>;}
\DoxyCodeLine{00060\ \ \ \ \ \textcolor{keyword}{using\ }rhs\_elem\ =\ std::conditional\_t<rhs\_is\_matrix,\ float,\ vector\_element\_t<Rhs>>;}
\DoxyCodeLine{00061\ \ \ \ \ \textcolor{comment}{//\ we\ only\ allow\ implicit\ conversion\ between}}
\DoxyCodeLine{00062\ \ \ \ \ \textcolor{comment}{//\ \ -\/\ scalars\ and\ vectors\ with\ the\ same\ element\ type}}
\DoxyCodeLine{00063\ \ \ \ \ \textcolor{comment}{//\ \ -\/\ integral\ and\ floating-\/point\ scalars}}
\DoxyCodeLine{00064\ \ \ \ \ \textcolor{comment}{//\ \ -\/\ equally\ sized\ integral\ scalars}}
\DoxyCodeLine{00065\ \ \ \ \ \textcolor{comment}{//\ \ -\/\ for\ SHL/SHR,\ rhs\ can\ be\ any\ integral\ scalar\ and\ will\ be\ cast\ to\ the\ same\ element\ type\ of\ lhs}}
\DoxyCodeLine{00066\ \ \ \ \ \textcolor{comment}{//\ \ to\ avoid\ unexpected\ (and\ typically\ expensive)\ behaviors}}
\DoxyCodeLine{00067\ \ \ \ \ \textcolor{keyword}{static\_assert}(}
\DoxyCodeLine{00068\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ no\ conversion;\ or\ scalars\ and\ vectors\ with\ the\ same\ element\ type}}
\DoxyCodeLine{00069\ \ \ \ \ \ \ \ \ std::is\_same\_v<lhs\_elem,\ rhs\_elem>\ ||}
\DoxyCodeLine{00070\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ integral\ and\ floating-\/point\ scalars}}
\DoxyCodeLine{00071\ \ \ \ \ \ \ \ \ \ \ \ \ (lhs\_is\_scalar\ \&\&\ rhs\_is\_scalar\ \&\&}
\DoxyCodeLine{00072\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ((lhs\_is\_integral\ \&\&\ rhs\_is\_fp)\ ||}
\DoxyCodeLine{00073\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (lhs\_is\_fp\ \&\&\ rhs\_is\_integral)\ ||}
\DoxyCodeLine{00074\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (lhs\_is\_integral\ \&\&\ rhs\_is\_integral\ \&\&}
\DoxyCodeLine{00075\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{sizeof}(lhs\_elem)\ ==\ \textcolor{keyword}{sizeof}(rhs\_elem)))\ ||}
\DoxyCodeLine{00076\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ for\ SHL/SHR,\ the\ rhs\ might\ be\ any\ unsigned\ integer}}
\DoxyCodeLine{00077\ \ \ \ \ \ \ \ \ \ \ \ \ \ ((op\ ==\ \mbox{\hyperlink{namespaceluisa_1_1compute_ab147b12fd5f4243b787f9c14c2afdb08abb0b9165d75b1fd27d0a869b036baa3c}{BinaryOp::SHL}}\ ||\ op\ ==\ \mbox{\hyperlink{namespaceluisa_1_1compute_ab147b12fd5f4243b787f9c14c2afdb08a10ab606ab9efe239a011d327d9301edd}{BinaryOp::SHR}})\ \&\&}
\DoxyCodeLine{00078\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lhs\_is\_integral\ \&\&\ rhs\_is\_scalar\ \&\&\ rhs\_is\_integral)),}
\DoxyCodeLine{00079\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Binary\ operator\ requires\ operands\ "{}}}
\DoxyCodeLine{00080\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}of\ the\ same\ element\ type."{}});}
\DoxyCodeLine{00081\ }
\DoxyCodeLine{00082\ \ \ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keyword}{auto}\ lhs\ =\ \mbox{\hyperlink{namespaceluisa_1_1compute_a97a30acfe72da21925e80a2861d53c9b}{expr\_value\_t<Lhs>}}\{\};}
\DoxyCodeLine{00083\ \ \ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keyword}{auto}\ rhs\ =\ \mbox{\hyperlink{namespaceluisa_1_1compute_a97a30acfe72da21925e80a2861d53c9b}{expr\_value\_t<Rhs>}}\{\};}
\DoxyCodeLine{00084\ }
\DoxyCodeLine{00085\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (op\ ==\ \mbox{\hyperlink{namespaceluisa_1_1compute_ab147b12fd5f4243b787f9c14c2afdb08a9eeb52badb613229884838847294b90d}{BinaryOp::ADD}}\ ||}
\DoxyCodeLine{00086\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ op\ ==\ \mbox{\hyperlink{namespaceluisa_1_1compute_ab147b12fd5f4243b787f9c14c2afdb08a241dd841abade20fcb27b8a9f494e1eb}{BinaryOp::SUB}}\ ||}
\DoxyCodeLine{00087\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ op\ ==\ \mbox{\hyperlink{namespaceluisa_1_1compute_ab147b12fd5f4243b787f9c14c2afdb08a2cdf52a55876063ec93b7d18bc741f6c}{BinaryOp::MUL}}\ ||}
\DoxyCodeLine{00088\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ op\ ==\ \mbox{\hyperlink{namespaceluisa_1_1compute_ab147b12fd5f4243b787f9c14c2afdb08a29bbf66f7f8529ec47e394fb5a36c646}{BinaryOp::DIV}})\ \{}
\DoxyCodeLine{00089\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static\_assert}((lhs\_is\_integral\ ||\ lhs\_is\_fp)\ \&\&}
\DoxyCodeLine{00090\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (rhs\_is\_integral\ ||\ rhs\_is\_fp),}
\DoxyCodeLine{00091\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Arithmetic\ operator\ requires\ integral\ "{}}}
\DoxyCodeLine{00092\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}or\ floating-\/point\ operands."{}});}
\DoxyCodeLine{00093\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (lhs\_is\_scalar\ \&\&\ rhs\_is\_scalar)\ \{}
\DoxyCodeLine{00094\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (lhs\_is\_integral\ \&\&\ rhs\_is\_fp)\ \{}
\DoxyCodeLine{00095\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespaceluisa_1_1compute_1_1detail_abfd4098c904a816cc9d5cbe2f278cd5d}{dsl\_binary\_op\_fp\_integral\_implicit\_conversion\_detected<Lhs,\ Rhs>}}();}
\DoxyCodeLine{00096\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ std::make\_tuple(rhs,\ rhs,\ rhs);}
\DoxyCodeLine{00097\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (lhs\_is\_fp\ \&\&\ rhs\_is\_integral)\ \{}
\DoxyCodeLine{00098\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespaceluisa_1_1compute_1_1detail_abfd4098c904a816cc9d5cbe2f278cd5d}{dsl\_binary\_op\_fp\_integral\_implicit\_conversion\_detected<Lhs,\ Rhs>}}();}
\DoxyCodeLine{00099\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ std::make\_tuple(lhs,\ lhs,\ lhs);}
\DoxyCodeLine{00100\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00101\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ ret\ =\ \textcolor{keyword}{decltype}(lhs\ *\ rhs)\{\};}
\DoxyCodeLine{00102\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ std::make\_tuple(ret,\ ret,\ ret);}
\DoxyCodeLine{00103\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00104\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00105\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ ret\ =\ \textcolor{keyword}{decltype}(lhs\ *\ rhs)\{\};}
\DoxyCodeLine{00106\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ std::make\_tuple(ret,\ lhs,\ rhs);}
\DoxyCodeLine{00107\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00108\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (op\ ==\ \mbox{\hyperlink{namespaceluisa_1_1compute_ab147b12fd5f4243b787f9c14c2afdb08ac5a28f4b35a2884fa3277150ac5d0967}{BinaryOp::MOD}})\ \{}
\DoxyCodeLine{00109\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static\_assert}(lhs\_is\_integral\ \&\&\ rhs\_is\_integral,}
\DoxyCodeLine{00110\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Modulo\ operator\ requires\ integral\ operands."{}});}
\DoxyCodeLine{00111\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ std::make\_tuple(\textcolor{keyword}{decltype}(lhs\ \%\ rhs)\{\},\ lhs,\ rhs);}
\DoxyCodeLine{00112\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (op\ ==\ \mbox{\hyperlink{namespaceluisa_1_1compute_ab147b12fd5f4243b787f9c14c2afdb08a969f331a87d8c958473c32b4d0e61a44}{BinaryOp::EQUAL}}\ ||}
\DoxyCodeLine{00113\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ op\ ==\ \mbox{\hyperlink{namespaceluisa_1_1compute_ab147b12fd5f4243b787f9c14c2afdb08a4ea2d378cdec20f59330f113297bc1ce}{BinaryOp::NOT\_EQUAL}}\ ||}
\DoxyCodeLine{00114\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ op\ ==\ \mbox{\hyperlink{namespaceluisa_1_1compute_ab147b12fd5f4243b787f9c14c2afdb08a1798e8c3621ca53d9e3a80d257306000}{BinaryOp::LESS}}\ ||}
\DoxyCodeLine{00115\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ op\ ==\ \mbox{\hyperlink{namespaceluisa_1_1compute_ab147b12fd5f4243b787f9c14c2afdb08a8b4a5cd69b217bf93b054ada7f49abd4}{BinaryOp::LESS\_EQUAL}}\ ||}
\DoxyCodeLine{00116\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ op\ ==\ \mbox{\hyperlink{namespaceluisa_1_1compute_ab147b12fd5f4243b787f9c14c2afdb08ae7e72355289e404b762d4cf88824d23b}{BinaryOp::GREATER}}\ ||}
\DoxyCodeLine{00117\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ op\ ==\ \mbox{\hyperlink{namespaceluisa_1_1compute_ab147b12fd5f4243b787f9c14c2afdb08a87e6b203bf40967d37a33f9a4438561a}{BinaryOp::GREATER\_EQUAL}})\ \{}
\DoxyCodeLine{00118\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (lhs\_is\_scalar\ \&\&\ rhs\_is\_scalar)\ \{}
\DoxyCodeLine{00119\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (lhs\_is\_integral\ \&\&\ rhs\_is\_fp)\ \{}
\DoxyCodeLine{00120\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespaceluisa_1_1compute_1_1detail_abfd4098c904a816cc9d5cbe2f278cd5d}{dsl\_binary\_op\_fp\_integral\_implicit\_conversion\_detected<Lhs,\ Rhs>}}();}
\DoxyCodeLine{00121\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ std::make\_tuple(\textcolor{keywordtype}{bool}\{\},\ rhs,\ rhs);}
\DoxyCodeLine{00122\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (lhs\_is\_fp\ \&\&\ rhs\_is\_integral)\ \{}
\DoxyCodeLine{00123\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespaceluisa_1_1compute_1_1detail_abfd4098c904a816cc9d5cbe2f278cd5d}{dsl\_binary\_op\_fp\_integral\_implicit\_conversion\_detected<Lhs,\ Rhs>}}();}
\DoxyCodeLine{00124\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ std::make\_tuple(\textcolor{keywordtype}{bool}\{\},\ lhs,\ lhs);}
\DoxyCodeLine{00125\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00126\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ std::make\_tuple(\textcolor{keywordtype}{bool}\{\},\ lhs,\ rhs);}
\DoxyCodeLine{00127\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00128\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00129\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ ret\ =\ \textcolor{keyword}{decltype}(lhs\ ==\ rhs)\{\};}
\DoxyCodeLine{00130\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ std::make\_tuple(ret,\ lhs,\ rhs);}
\DoxyCodeLine{00131\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00132\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (op\ ==\ \mbox{\hyperlink{namespaceluisa_1_1compute_ab147b12fd5f4243b787f9c14c2afdb08a4bece6f4e59c0e3f185e3003dfd37b1d}{BinaryOp::BIT\_AND}}\ ||}
\DoxyCodeLine{00133\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ op\ ==\ \mbox{\hyperlink{namespaceluisa_1_1compute_ab147b12fd5f4243b787f9c14c2afdb08a377da01fa3eaa9e9d6a69a2fa415fe7b}{BinaryOp::BIT\_OR}}\ ||}
\DoxyCodeLine{00134\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ op\ ==\ \mbox{\hyperlink{namespaceluisa_1_1compute_ab147b12fd5f4243b787f9c14c2afdb08a0d1fc5cbb9845767bfbcc53f97e1cff0}{BinaryOp::BIT\_XOR}})\ \{}
\DoxyCodeLine{00135\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static\_assert}((lhs\_is\_integral\ \&\&\ rhs\_is\_integral)\ ||}
\DoxyCodeLine{00136\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (lhs\_is\_scalar\ \&\&\ lhs\_is\_boolean\ \&\&}
\DoxyCodeLine{00137\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ rhs\_is\_scalar\ \&\&\ rhs\_is\_boolean),}
\DoxyCodeLine{00138\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Bitwise\ operator\ requires\ integral\ or\ boolean\ operands."{}});}
\DoxyCodeLine{00139\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (lhs\_is\_integral)\ \{}
\DoxyCodeLine{00140\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ std::make\_tuple(\textcolor{keyword}{decltype}(lhs\ \&\ rhs)\{\},\ lhs,\ rhs);}
\DoxyCodeLine{00141\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00142\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ std::make\_tuple(\textcolor{keyword}{decltype}(lhs\ \&\&\ rhs)\{\},\ lhs,\ rhs);}
\DoxyCodeLine{00143\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00144\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (op\ ==\ \mbox{\hyperlink{namespaceluisa_1_1compute_ab147b12fd5f4243b787f9c14c2afdb08a558ffc8f5770d8e4f95f51d822685532}{BinaryOp::AND}}\ ||}
\DoxyCodeLine{00145\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ op\ ==\ \mbox{\hyperlink{namespaceluisa_1_1compute_ab147b12fd5f4243b787f9c14c2afdb08a1d00e7dce692e8dc3f6877f035e3a616}{BinaryOp::OR}})\ \{}
\DoxyCodeLine{00146\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static\_assert}(lhs\_is\_vector\ \&\&\ rhs\_is\_vector\ \&\&}
\DoxyCodeLine{00147\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lhs\_is\_boolean\ \&\&\ rhs\_is\_boolean,}
\DoxyCodeLine{00148\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Logical\ operator\ requires\ boolean\ vector\ operands.\ To\ perform\ "{}}}
\DoxyCodeLine{00149\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}logical\ operations\ on\ scalars,\ please\ use\ the\ bitwise\ operators\ "{}}}
\DoxyCodeLine{00150\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}and\ note\ that\ the\ short-\/circuit\ evaluation\ is\ not\ supported."{}});}
\DoxyCodeLine{00151\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ std::make\_tuple(\textcolor{keyword}{decltype}(lhs\ \&\&\ rhs)\{\},\ lhs,\ rhs);}
\DoxyCodeLine{00152\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (op\ ==\ \mbox{\hyperlink{namespaceluisa_1_1compute_ab147b12fd5f4243b787f9c14c2afdb08abb0b9165d75b1fd27d0a869b036baa3c}{BinaryOp::SHL}}\ ||}
\DoxyCodeLine{00153\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ op\ ==\ \mbox{\hyperlink{namespaceluisa_1_1compute_ab147b12fd5f4243b787f9c14c2afdb08a10ab606ab9efe239a011d327d9301edd}{BinaryOp::SHR}})\ \{}
\DoxyCodeLine{00154\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static\_assert}(lhs\_is\_integral\ \&\&\ rhs\_is\_integral,}
\DoxyCodeLine{00155\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Shift\ operator\ requires\ integral\ operands."{}});}
\DoxyCodeLine{00156\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (rhs\_is\_scalar)\ \{}
\DoxyCodeLine{00157\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ rhs\_cast\ =\ lhs\_elem\{\};}
\DoxyCodeLine{00158\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ ret\ =\ \textcolor{keyword}{decltype}(lhs\ <<\ rhs\_cast)\{\};}
\DoxyCodeLine{00159\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ std::make\_tuple(ret,\ lhs,\ rhs\_cast);}
\DoxyCodeLine{00160\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00161\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ ret\ =\ \textcolor{keyword}{decltype}(lhs\ <<\ rhs)\{\};}
\DoxyCodeLine{00162\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ std::make\_tuple(ret,\ lhs,\ rhs);}
\DoxyCodeLine{00163\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00164\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00165\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static\_assert}(\mbox{\hyperlink{namespaceluisa_a8c7f286c84142da9a0aca4e38c58ce59}{always\_false\_v<Lhs>}});}
\DoxyCodeLine{00166\ \ \ \ \ \}}
\DoxyCodeLine{00167\ \}}
\DoxyCodeLine{00168\ }
\DoxyCodeLine{00169\ \}\textcolor{comment}{//\ namespace\ luisa::compute::detail}}
\DoxyCodeLine{00170\ }
\DoxyCodeLine{00172\ \textcolor{preprocessor}{\#define\ LUISA\_MAKE\_GLOBAL\_DSL\_BINARY\_OP(op,\ op\_tag\_name)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00173\ \textcolor{preprocessor}{\ \ \ \ template<typename\ LhsT,\ typename\ RhsT>\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00174\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ requires\ luisa::compute::any\_dsl\_v<LhsT,\ RhsT>\ \&\&\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00175\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ luisa::is\_basic\_v<luisa::compute::expr\_value\_t<LhsT>>\ \&\&\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00176\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ luisa::is\_basic\_v<luisa::compute::expr\_value\_t<RhsT>>\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00177\ \textcolor{preprocessor}{\ \ \ \ [[nodiscard]]\ inline\ auto\ operator\ op(LhsT\ \&\&lhs,\ RhsT\ \&\&rhs)\ noexcept\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00178\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ using\ Lhs\ =\ luisa::compute::expr\_value\_t<LhsT>;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00179\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ using\ Rhs\ =\ luisa::compute::expr\_value\_t<RhsT>;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00180\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ auto\ [ret,\ lhs\_cast,\ rhs\_cast]\ =\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00181\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ luisa::compute::detail::dsl\_binary\_op\_return\_type\_helper<\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00182\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ luisa::compute::BinaryOp::op\_tag\_name,\ Lhs,\ Rhs>();\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00183\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ using\ Ret\ =\ decltype(ret);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00184\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ using\ LhsCast\ =\ decltype(lhs\_cast);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00185\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ using\ RhsCast\ =\ decltype(rhs\_cast);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00186\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ auto\ lhs\_expr\ =\ luisa::compute::detail::extract\_expression(std::forward<LhsT>(lhs));\ \(\backslash\)}}
\DoxyCodeLine{00187\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ auto\ rhs\_expr\ =\ luisa::compute::detail::extract\_expression(std::forward<RhsT>(rhs));\ \(\backslash\)}}
\DoxyCodeLine{00188\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ auto\ fb\ =\ luisa::compute::detail::FunctionBuilder::current();\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00189\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ if\ constexpr\ (!std::is\_same\_v<LhsCast,\ Lhs>)\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00190\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ lhs\_expr\ =\ fb-\/>cast(luisa::compute::Type::of<LhsCast>(),\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00191\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ luisa::compute::CastOp::STATIC,\ lhs\_expr);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00192\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00193\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ if\ constexpr\ (!std::is\_same\_v<RhsCast,\ Rhs>)\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00194\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ rhs\_expr\ =\ fb-\/>cast(luisa::compute::Type::of<RhsCast>(),\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00195\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ luisa::compute::CastOp::STATIC,\ rhs\_expr);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00196\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00197\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ return\ luisa::compute::dsl::def<Ret>(fb-\/>binary(\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00198\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ luisa::compute::Type::of<Ret>(),\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00199\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ luisa::compute::BinaryOp::op\_tag\_name,\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00200\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ lhs\_expr,\ rhs\_expr));\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00201\ \textcolor{preprocessor}{\ \ \ \ \}}}
\DoxyCodeLine{00202\ \mbox{\hyperlink{operators_8h_ac3355c6be89346dfe3e9be7540fed8f1}{LUISA\_MAKE\_GLOBAL\_DSL\_BINARY\_OP}}(+,\ ADD)}
\DoxyCodeLine{00203\ \mbox{\hyperlink{operators_8h_ac3355c6be89346dfe3e9be7540fed8f1}{LUISA\_MAKE\_GLOBAL\_DSL\_BINARY\_OP}}(-\/,\ SUB)}
\DoxyCodeLine{00204\ \mbox{\hyperlink{operators_8h_ac3355c6be89346dfe3e9be7540fed8f1}{LUISA\_MAKE\_GLOBAL\_DSL\_BINARY\_OP}}(*,\ MUL)}
\DoxyCodeLine{00205\ \mbox{\hyperlink{operators_8h_ac3355c6be89346dfe3e9be7540fed8f1}{LUISA\_MAKE\_GLOBAL\_DSL\_BINARY\_OP}}(/,\ DIV)}
\DoxyCodeLine{00206\ \mbox{\hyperlink{operators_8h_ac3355c6be89346dfe3e9be7540fed8f1}{LUISA\_MAKE\_GLOBAL\_DSL\_BINARY\_OP}}(\%,\ MOD)}
\DoxyCodeLine{00207\ \mbox{\hyperlink{operators_8h_ac3355c6be89346dfe3e9be7540fed8f1}{LUISA\_MAKE\_GLOBAL\_DSL\_BINARY\_OP}}(\&,\ BIT\_AND)}
\DoxyCodeLine{00208\ \mbox{\hyperlink{operators_8h_ac3355c6be89346dfe3e9be7540fed8f1}{LUISA\_MAKE\_GLOBAL\_DSL\_BINARY\_OP}}(|,\ BIT\_OR)}
\DoxyCodeLine{00209\ \mbox{\hyperlink{operators_8h_ac3355c6be89346dfe3e9be7540fed8f1}{LUISA\_MAKE\_GLOBAL\_DSL\_BINARY\_OP}}(\string^,\ BIT\_XOR)}
\DoxyCodeLine{00210\ \mbox{\hyperlink{operators_8h_ac3355c6be89346dfe3e9be7540fed8f1}{LUISA\_MAKE\_GLOBAL\_DSL\_BINARY\_OP}}(<<,\ SHL)}
\DoxyCodeLine{00211\ \mbox{\hyperlink{operators_8h_ac3355c6be89346dfe3e9be7540fed8f1}{LUISA\_MAKE\_GLOBAL\_DSL\_BINARY\_OP}}(>>,\ SHR)}
\DoxyCodeLine{00212\ \mbox{\hyperlink{operators_8h_ac3355c6be89346dfe3e9be7540fed8f1}{LUISA\_MAKE\_GLOBAL\_DSL\_BINARY\_OP}}(\&\&,\ AND)}
\DoxyCodeLine{00213\ \mbox{\hyperlink{operators_8h_ac3355c6be89346dfe3e9be7540fed8f1}{LUISA\_MAKE\_GLOBAL\_DSL\_BINARY\_OP}}(||,\ OR)}
\DoxyCodeLine{00214\ \mbox{\hyperlink{operators_8h_ac3355c6be89346dfe3e9be7540fed8f1}{LUISA\_MAKE\_GLOBAL\_DSL\_BINARY\_OP}}(==,\ EQUAL)}
\DoxyCodeLine{00215\ \mbox{\hyperlink{operators_8h_ac3355c6be89346dfe3e9be7540fed8f1}{LUISA\_MAKE\_GLOBAL\_DSL\_BINARY\_OP}}(!=,\ NOT\_EQUAL)}
\DoxyCodeLine{00216\ \mbox{\hyperlink{operators_8h_ac3355c6be89346dfe3e9be7540fed8f1}{LUISA\_MAKE\_GLOBAL\_DSL\_BINARY\_OP}}(<,\ LESS)}
\DoxyCodeLine{00217\ \mbox{\hyperlink{operators_8h_ac3355c6be89346dfe3e9be7540fed8f1}{LUISA\_MAKE\_GLOBAL\_DSL\_BINARY\_OP}}(<=,\ LESS\_EQUAL)}
\DoxyCodeLine{00218\ \mbox{\hyperlink{operators_8h_ac3355c6be89346dfe3e9be7540fed8f1}{LUISA\_MAKE\_GLOBAL\_DSL\_BINARY\_OP}}(>,\ GREATER)}
\DoxyCodeLine{00219\ \mbox{\hyperlink{operators_8h_ac3355c6be89346dfe3e9be7540fed8f1}{LUISA\_MAKE\_GLOBAL\_DSL\_BINARY\_OP}}(>=,\ GREATER\_EQUAL)}
\DoxyCodeLine{00220\ \textcolor{preprocessor}{\#undef\ LUISA\_MAKE\_GLOBAL\_DSL\_BINARY\_OP}}
\DoxyCodeLine{00221\ }
\DoxyCodeLine{00223\ \textcolor{preprocessor}{\#define\ LUISA\_MAKE\_GLOBAL\_DSL\_ASSIGN\_OP(op)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00224\ \textcolor{preprocessor}{\ \ \ \ template<typename\ T,\ typename\ U>\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00225\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ requires\ std::same\_as<decltype(std::declval<luisa::compute::Var<T>\ \&>()\ \ \(\backslash\)}}
\DoxyCodeLine{00226\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ op\ std::declval<U\ \&>()),\ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00227\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ luisa::compute::Var<T>>\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00228\ \textcolor{preprocessor}{\ \ \ \ const\ auto\ \&operator\ op\#\#=(luisa::compute::Var<T>\ \&lhs,\ U\ \&\&\ rhs)\ noexcept\ \{\ \(\backslash\)}}
\DoxyCodeLine{00229\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ auto\ x\ =\ lhs\ op\ std::forward<U>(rhs);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00230\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ luisa::compute::detail::FunctionBuilder::current()-\/>assign(\ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00231\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ lhs.expression(),\ x.expression());\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00232\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ return\ lhs;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00233\ \textcolor{preprocessor}{\ \ \ \ \}}}
\DoxyCodeLine{00234\ \mbox{\hyperlink{operators_8h_a86a105a2882731fc1f965c14f842f230}{LUISA\_MAKE\_GLOBAL\_DSL\_ASSIGN\_OP}}(+)}
\DoxyCodeLine{00235\ \mbox{\hyperlink{operators_8h_a86a105a2882731fc1f965c14f842f230}{LUISA\_MAKE\_GLOBAL\_DSL\_ASSIGN\_OP}}(-\/)}
\DoxyCodeLine{00236\ \mbox{\hyperlink{operators_8h_a86a105a2882731fc1f965c14f842f230}{LUISA\_MAKE\_GLOBAL\_DSL\_ASSIGN\_OP}}(*)}
\DoxyCodeLine{00237\ \mbox{\hyperlink{operators_8h_a86a105a2882731fc1f965c14f842f230}{LUISA\_MAKE\_GLOBAL\_DSL\_ASSIGN\_OP}}(/)}
\DoxyCodeLine{00238\ \mbox{\hyperlink{operators_8h_a86a105a2882731fc1f965c14f842f230}{LUISA\_MAKE\_GLOBAL\_DSL\_ASSIGN\_OP}}(\%)}
\DoxyCodeLine{00239\ \mbox{\hyperlink{operators_8h_a86a105a2882731fc1f965c14f842f230}{LUISA\_MAKE\_GLOBAL\_DSL\_ASSIGN\_OP}}(\&)}
\DoxyCodeLine{00240\ \mbox{\hyperlink{operators_8h_a86a105a2882731fc1f965c14f842f230}{LUISA\_MAKE\_GLOBAL\_DSL\_ASSIGN\_OP}}(|)}
\DoxyCodeLine{00241\ \mbox{\hyperlink{operators_8h_a86a105a2882731fc1f965c14f842f230}{LUISA\_MAKE\_GLOBAL\_DSL\_ASSIGN\_OP}}(\string^)}
\DoxyCodeLine{00242\ \mbox{\hyperlink{operators_8h_a86a105a2882731fc1f965c14f842f230}{LUISA\_MAKE\_GLOBAL\_DSL\_ASSIGN\_OP}}(<<)}
\DoxyCodeLine{00243\ \mbox{\hyperlink{operators_8h_a86a105a2882731fc1f965c14f842f230}{LUISA\_MAKE\_GLOBAL\_DSL\_ASSIGN\_OP}}(>>)}
\DoxyCodeLine{00244\ \textcolor{preprocessor}{\#undef\ LUISA\_MAKE\_GLOBAL\_DSL\_ASSIGN\_OP}}
\DoxyCodeLine{00245\ }
\DoxyCodeLine{00246\ \textcolor{preprocessor}{\#define\ LUISA\_DISABLE\_DSL\_ADDRESS\_OF\_MESSAGE\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00247\ \textcolor{preprocessor}{\ \ \ \ "{}\(\backslash\)n"{}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00248\ \textcolor{preprocessor}{\ \ \ \ "{}Address-\/of\ operator\ is\ not\ allowed\ for\ DSL\ objects,\(\backslash\)n"{}\ \ \(\backslash\)}}
\DoxyCodeLine{00249\ \textcolor{preprocessor}{\ \ \ \ "{}as\ it\ is\ only\ valid\ during\ the\ AST\ recording\ phrase\(\backslash\)n"{}\ \ \(\backslash\)}}
\DoxyCodeLine{00250\ \textcolor{preprocessor}{\ \ \ \ "{}and\ will\ not\ behave\ as\ expected\ like\ a\ real\ pointer\(\backslash\)n"{}\ \ \(\backslash\)}}
\DoxyCodeLine{00251\ \textcolor{preprocessor}{\ \ \ \ "{}during\ kernel\ execution.\(\backslash\)n"{}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00252\ \textcolor{preprocessor}{\ \ \ \ "{}\(\backslash\)n"{}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00253\ \textcolor{preprocessor}{\ \ \ \ "{}For\ example,\ if\ allowed,\ the\ following\ code\(\backslash\)n"{}\ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00254\ \textcolor{preprocessor}{\ \ \ \ "{}\`{}\`{}\`{}\(\backslash\)n"{}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00255\ \textcolor{preprocessor}{\ \ \ \ "{}UInt\ *a\ =\ nullptr;\(\backslash\)n"{}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00256\ \textcolor{preprocessor}{\ \ \ \ "{}\$if\ (cond)\ \{\(\backslash\)n"{}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00257\ \textcolor{preprocessor}{\ \ \ \ "{}\ \ a\ =\ \&b;\(\backslash\)n"{}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00258\ \textcolor{preprocessor}{\ \ \ \ "{}\}\ \$else\ \{\(\backslash\)n"{}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00259\ \textcolor{preprocessor}{\ \ \ \ "{}\ \ a\ =\ \&c;\(\backslash\)n"{}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00260\ \textcolor{preprocessor}{\ \ \ \ "{}\};\(\backslash\)n"{}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00261\ \textcolor{preprocessor}{\ \ \ \ "{}\`{}\`{}\`{}\(\backslash\)n"{}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00262\ \textcolor{preprocessor}{\ \ \ \ "{}will\ make\ \`{}a`\ **always**\ pointing\ to\ \`{}c`.\(\backslash\)n"{}\ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00263\ \textcolor{preprocessor}{\ \ \ \ "{}\(\backslash\)n"{}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00264\ \textcolor{preprocessor}{\ \ \ \ "{}Please\ use\ references\ to\ pass\ variables\ between\(\backslash\)n"{}\ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00265\ \textcolor{preprocessor}{\ \ \ \ "{}functions.\ Or,\ if\ you\ fully\ understand\ the\ semantics\(\backslash\)n"{}\ \(\backslash\)}}
\DoxyCodeLine{00266\ \textcolor{preprocessor}{\ \ \ \ "{}and\ effects,\ please\ use\ \`{}std::addressof`\ instead\ for\(\backslash\)n"{}\ \(\backslash\)}}
\DoxyCodeLine{00267\ \textcolor{preprocessor}{\ \ \ \ "{}advanced\ usage.\(\backslash\)n"{}}}
\DoxyCodeLine{00268\ }
\DoxyCodeLine{00269\ \textcolor{comment}{//\ disable\ the\ address-\/of\ operator\ for\ dsl\ objects}}
\DoxyCodeLine{00270\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00271\ \ \ \ \ requires\ ::luisa::compute::is\_dsl\_v<T>}
\DoxyCodeLine{00272\ [[nodiscard]]\ \textcolor{keyword}{inline}\ T\ *\mbox{\hyperlink{operators_8h_a2ad60c3922e3e1b64f58b7142b0a745a}{operator\&}}(T\ \&\&)\ noexcept\ \{}
\DoxyCodeLine{00273\ \ \ \ \ \textcolor{keyword}{static\_assert}(::luisa::always\_false\_v<T>,}
\DoxyCodeLine{00274\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{operators_8h_af66a2435321b88ca0089b72b34e3f686}{LUISA\_DISABLE\_DSL\_ADDRESS\_OF\_MESSAGE}});}
\DoxyCodeLine{00275\ \ \ \ \ std::abort();}
\DoxyCodeLine{00276\ \}}
\DoxyCodeLine{00277\ }
\DoxyCodeLine{00278\ \textcolor{comment}{//\ convenience\ macro\ to\ disable\ the\ address-\/of\ operator\ for\ specific\ types}}
\DoxyCodeLine{00279\ \textcolor{preprocessor}{\#define\ LUISA\_DISABLE\_DSL\_ADDRESS\_OF\_OPERATOR(...)\ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00280\ \textcolor{preprocessor}{\ \ \ \ template<typename\ T>\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00281\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ requires\ std::same\_as<T,\ \_\_VA\_ARGS\_\_>\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00282\ \textcolor{preprocessor}{\ \ \ \ [[nodiscard]]\ inline\ T\ *operator\&(T\ \&\&)\ noexcept\ \{\ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00283\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ static\_assert(::luisa::always\_false\_v<T>,\ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00284\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ LUISA\_DISABLE\_DSL\_ADDRESS\_OF\_MESSAGE);\ \(\backslash\)}}
\DoxyCodeLine{00285\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ std::abort();\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00286\ \textcolor{preprocessor}{\ \ \ \ \}}}

\end{DoxyCode}
