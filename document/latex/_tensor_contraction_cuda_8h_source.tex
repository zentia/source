\doxysection{Tensor\+Contraction\+Cuda.\+h}
\hypertarget{_tensor_contraction_cuda_8h_source}{}\label{_tensor_contraction_cuda_8h_source}\index{external/taskflow/3rd-\/party/eigen-\/3.3.7/unsupported/Eigen/CXX11/src/Tensor/TensorContractionCuda.h@{external/taskflow/3rd-\/party/eigen-\/3.3.7/unsupported/Eigen/CXX11/src/Tensor/TensorContractionCuda.h}}
\mbox{\hyperlink{_tensor_contraction_cuda_8h}{浏览该文件的文档.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ This\ file\ is\ part\ of\ Eigen,\ a\ lightweight\ C++\ template\ library}}
\DoxyCodeLine{00002\ \textcolor{comment}{//\ for\ linear\ algebra.}}
\DoxyCodeLine{00003\ \textcolor{comment}{//}}
\DoxyCodeLine{00004\ \textcolor{comment}{//\ Copyright\ (C)\ 2014-\/2015\ Benoit\ Steiner\ <benoit.steiner.goog@gmail.com>}}
\DoxyCodeLine{00005\ \textcolor{comment}{//\ Copyright\ (C)\ 2015\ Navdeep\ Jaitly\ <ndjaitly@google.com>}}
\DoxyCodeLine{00006\ \textcolor{comment}{//\ Copyright\ (C)\ 2014\ Eric\ Martin\ <eric@ericmart.in>}}
\DoxyCodeLine{00007\ \textcolor{comment}{//}}
\DoxyCodeLine{00008\ \textcolor{comment}{//\ This\ Source\ Code\ Form\ is\ subject\ to\ the\ terms\ of\ the\ Mozilla}}
\DoxyCodeLine{00009\ \textcolor{comment}{//\ Public\ License\ v.\ 2.0.\ If\ a\ copy\ of\ the\ MPL\ was\ not\ distributed}}
\DoxyCodeLine{00010\ \textcolor{comment}{//\ with\ this\ file,\ You\ can\ obtain\ one\ at\ http://mozilla.org/MPL/2.0/.}}
\DoxyCodeLine{00011\ }
\DoxyCodeLine{00012\ \textcolor{preprocessor}{\#ifndef\ EIGEN\_CXX11\_TENSOR\_TENSOR\_CONTRACTION\_CUDA\_H}}
\DoxyCodeLine{00013\ \textcolor{preprocessor}{\#define\ EIGEN\_CXX11\_TENSOR\_TENSOR\_CONTRACTION\_CUDA\_H}}
\DoxyCodeLine{00014\ }
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#if\ defined(EIGEN\_USE\_GPU)\ \&\&\ defined(\_\_CUDACC\_\_)}}
\DoxyCodeLine{00016\ }
\DoxyCodeLine{00017\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespace_eigen}{Eigen}}\ \{}
\DoxyCodeLine{00018\ }
\DoxyCodeLine{00019\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ \mbox{\hyperlink{class_eigen_1_1_product}{Scalar}},\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}},\ \textcolor{keyword}{typename}\ LhsMapper,}
\DoxyCodeLine{00020\ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{typename}\ RhsMapper,\ \textcolor{keyword}{typename}\ OutputMapper,\ \textcolor{keywordtype}{bool}\ needs\_edge\_check>}
\DoxyCodeLine{00021\ \_\_device\_\_\ \mbox{\hyperlink{eigen-3_83_87_2_eigen_2src_2_core_2util_2_macros_8h_af2b60117c00a6e75812de43bfe7db3b1}{EIGEN\_STRONG\_INLINE}}\ \textcolor{keywordtype}{void}}
\DoxyCodeLine{00022\ EigenContractionKernelInternal(\textcolor{keyword}{const}\ LhsMapper\ lhs,\ \textcolor{keyword}{const}\ RhsMapper\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}},}
\DoxyCodeLine{00023\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ OutputMapper\ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}},\ \mbox{\hyperlink{class_eigen_1_1_product}{Scalar}}*\ lhs\_shmem,\ \mbox{\hyperlink{class_eigen_1_1_product}{Scalar}}*\ rhs\_shmem,}
\DoxyCodeLine{00024\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ m\_size,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ n\_size,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ k\_size)\ \{}
\DoxyCodeLine{00025\ }
\DoxyCodeLine{00026\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ m\_block\_idx\ =\ \mbox{\hyperlink{cuda__common_8h_ab30e5f6958c9264d3c5235d463eb2b57}{blockIdx}}.x;}
\DoxyCodeLine{00027\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ n\_block\_idx\ =\ \mbox{\hyperlink{cuda__common_8h_ab30e5f6958c9264d3c5235d463eb2b57}{blockIdx}}.y;}
\DoxyCodeLine{00028\ }
\DoxyCodeLine{00029\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ base\_m\ =\ 64\ *\ m\_block\_idx;}
\DoxyCodeLine{00030\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ base\_n\ =\ 64\ *\ n\_block\_idx;}
\DoxyCodeLine{00031\ }
\DoxyCodeLine{00032\ \ \ \textcolor{comment}{//\ declare\ and\ initialize\ 64\ registers\ for\ output\ 8x8\ block}}
\DoxyCodeLine{00033\ }
\DoxyCodeLine{00034\ \ \ \textcolor{comment}{//\ prefetch\ registers}}
\DoxyCodeLine{00035\ \ \ \mbox{\hyperlink{class_eigen_1_1_product}{Scalar}}\ lhs\_pf0;}
\DoxyCodeLine{00036\ \ \ \mbox{\hyperlink{class_eigen_1_1_product}{Scalar}}\ lhs\_pf1;}
\DoxyCodeLine{00037\ \ \ \mbox{\hyperlink{class_eigen_1_1_product}{Scalar}}\ lhs\_pf2;}
\DoxyCodeLine{00038\ \ \ \mbox{\hyperlink{class_eigen_1_1_product}{Scalar}}\ lhs\_pf3;}
\DoxyCodeLine{00039\ \ \ \mbox{\hyperlink{class_eigen_1_1_product}{Scalar}}\ lhs\_pf4;}
\DoxyCodeLine{00040\ \ \ \mbox{\hyperlink{class_eigen_1_1_product}{Scalar}}\ lhs\_pf5;}
\DoxyCodeLine{00041\ \ \ \mbox{\hyperlink{class_eigen_1_1_product}{Scalar}}\ lhs\_pf6;}
\DoxyCodeLine{00042\ \ \ \mbox{\hyperlink{class_eigen_1_1_product}{Scalar}}\ lhs\_pf7;}
\DoxyCodeLine{00043\ }
\DoxyCodeLine{00044\ \ \ \mbox{\hyperlink{class_eigen_1_1_product}{Scalar}}\ rhs\_pf0;}
\DoxyCodeLine{00045\ \ \ \mbox{\hyperlink{class_eigen_1_1_product}{Scalar}}\ rhs\_pf1;}
\DoxyCodeLine{00046\ \ \ \mbox{\hyperlink{class_eigen_1_1_product}{Scalar}}\ rhs\_pf2;}
\DoxyCodeLine{00047\ \ \ \mbox{\hyperlink{class_eigen_1_1_product}{Scalar}}\ rhs\_pf3;}
\DoxyCodeLine{00048\ \ \ \mbox{\hyperlink{class_eigen_1_1_product}{Scalar}}\ rhs\_pf4;}
\DoxyCodeLine{00049\ \ \ \mbox{\hyperlink{class_eigen_1_1_product}{Scalar}}\ rhs\_pf5;}
\DoxyCodeLine{00050\ \ \ \mbox{\hyperlink{class_eigen_1_1_product}{Scalar}}\ rhs\_pf6;}
\DoxyCodeLine{00051\ \ \ \mbox{\hyperlink{class_eigen_1_1_product}{Scalar}}\ rhs\_pf7;}
\DoxyCodeLine{00052\ }
\DoxyCodeLine{00053\ \ \ \textcolor{comment}{//\ shared\ memory\ is\ formatted}}
\DoxyCodeLine{00054\ \ \ \textcolor{comment}{//\ (contract\ idx\ in\ block,\ nocontract\ idx\ in\ block,\ block\ idx)}}
\DoxyCodeLine{00055\ \ \ \textcolor{comment}{//\ where\ block\ idx\ is\ column\ major.\ This\ transposition\ limits\ the\ number\ of}}
\DoxyCodeLine{00056\ \ \ \textcolor{comment}{//\ bank\ conflicts\ when\ reading\ the\ LHS.\ The\ core\ idea\ is\ that\ since\ the\ contracting}}
\DoxyCodeLine{00057\ \ \ \textcolor{comment}{//\ index\ is\ shared\ by\ both\ sides,\ then\ the\ contracting\ index\ should\ be\ in\ threadIdx.x.}}
\DoxyCodeLine{00058\ }
\DoxyCodeLine{00059\ \ \ \textcolor{comment}{//\ On\ the\ LHS,\ we\ pad\ each\ row\ inside\ of\ each\ block\ with\ an\ extra\ element.\ This\ makes}}
\DoxyCodeLine{00060\ \ \ \textcolor{comment}{//\ each\ block\ 8\ rows\ of\ 9\ elements,\ which\ is\ 72\ elements.\ This\ gives\ no\ bank\ conflicts}}
\DoxyCodeLine{00061\ \ \ \textcolor{comment}{//\ on\ writes\ and\ very\ few\ 2-\/way\ conflicts\ on\ reads.\ There\ is\ an\ 8x8\ grid\ of\ these\ blocks.}}
\DoxyCodeLine{00062\ }
\DoxyCodeLine{00063\ \ \ \textcolor{comment}{//\ On\ the\ RHS\ we\ just\ add\ 8\ padding\ elements\ to\ the\ end\ of\ each\ block.\ This\ gives\ no\ bank}}
\DoxyCodeLine{00064\ \ \ \textcolor{comment}{//\ conflicts\ on\ writes\ and\ also\ none\ on\ reads.}}
\DoxyCodeLine{00065\ }
\DoxyCodeLine{00066\ \ \ \textcolor{comment}{//\ storage\ indices}}
\DoxyCodeLine{00067\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ lhs\_store\_idx\_base\ =\ \mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y\ *\ 72\ +\ \mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.x\ *\ 9\ +\ \mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.z;}
\DoxyCodeLine{00068\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ rhs\_store\_idx\_base\ =\ \mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y\ *\ 72\ +\ \mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.z\ *\ 8\ +\ \mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.x;}
\DoxyCodeLine{00069\ }
\DoxyCodeLine{00070\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ lhs\_store\_idx\_0\ =\ lhs\_store\_idx\_base\ +\ 576\ *\ 0;}
\DoxyCodeLine{00071\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ lhs\_store\_idx\_1\ =\ lhs\_store\_idx\_base\ +\ 576\ *\ 1;}
\DoxyCodeLine{00072\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ lhs\_store\_idx\_2\ =\ lhs\_store\_idx\_base\ +\ 576\ *\ 2;}
\DoxyCodeLine{00073\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ lhs\_store\_idx\_3\ =\ lhs\_store\_idx\_base\ +\ 576\ *\ 3;}
\DoxyCodeLine{00074\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ lhs\_store\_idx\_4\ =\ lhs\_store\_idx\_base\ +\ 576\ *\ 4;}
\DoxyCodeLine{00075\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ lhs\_store\_idx\_5\ =\ lhs\_store\_idx\_base\ +\ 576\ *\ 5;}
\DoxyCodeLine{00076\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ lhs\_store\_idx\_6\ =\ lhs\_store\_idx\_base\ +\ 576\ *\ 6;}
\DoxyCodeLine{00077\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ lhs\_store\_idx\_7\ =\ lhs\_store\_idx\_base\ +\ 576\ *\ 7;}
\DoxyCodeLine{00078\ }
\DoxyCodeLine{00079\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ rhs\_store\_idx\_0\ =\ rhs\_store\_idx\_base\ +\ 576\ *\ 0;}
\DoxyCodeLine{00080\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ rhs\_store\_idx\_1\ =\ rhs\_store\_idx\_base\ +\ 576\ *\ 1;}
\DoxyCodeLine{00081\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ rhs\_store\_idx\_2\ =\ rhs\_store\_idx\_base\ +\ 576\ *\ 2;}
\DoxyCodeLine{00082\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ rhs\_store\_idx\_3\ =\ rhs\_store\_idx\_base\ +\ 576\ *\ 3;}
\DoxyCodeLine{00083\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ rhs\_store\_idx\_4\ =\ rhs\_store\_idx\_base\ +\ 576\ *\ 4;}
\DoxyCodeLine{00084\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ rhs\_store\_idx\_5\ =\ rhs\_store\_idx\_base\ +\ 576\ *\ 5;}
\DoxyCodeLine{00085\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ rhs\_store\_idx\_6\ =\ rhs\_store\_idx\_base\ +\ 576\ *\ 6;}
\DoxyCodeLine{00086\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ rhs\_store\_idx\_7\ =\ rhs\_store\_idx\_base\ +\ 576\ *\ 7;}
\DoxyCodeLine{00087\ }
\DoxyCodeLine{00088\ \ \ \textcolor{comment}{//\ in\ the\ loading\ code,\ the\ following\ variables\ are\ important:}}
\DoxyCodeLine{00089\ \ \ \textcolor{comment}{//\ threadIdx.x:\ the\ vertical\ position\ in\ an\ 8x8\ block}}
\DoxyCodeLine{00090\ \ \ \textcolor{comment}{//\ threadIdx.y:\ the\ vertical\ index\ of\ the\ 8x8\ block\ in\ the\ grid}}
\DoxyCodeLine{00091\ \ \ \textcolor{comment}{//\ threadIdx.z:\ the\ horizontal\ position\ in\ an\ 8x8\ block}}
\DoxyCodeLine{00092\ \ \ \textcolor{comment}{//\ k:\ the\ horizontal\ index\ of\ the\ 8x8\ block\ in\ the\ grid}}
\DoxyCodeLine{00093\ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00094\ \ \ \textcolor{comment}{//\ The\ k\ parameter\ is\ implicit\ (it\ was\ the\ loop\ counter\ for\ a\ loop\ that\ went}}
\DoxyCodeLine{00095\ \ \ \textcolor{comment}{//\ from\ 0\ to\ <8,\ but\ now\ that\ loop\ is\ unrolled\ in\ the\ below\ code.}}
\DoxyCodeLine{00096\ }
\DoxyCodeLine{00097\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ load\_idx\_vert\ =\ \mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.x\ +\ 8\ *\ \mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y;}
\DoxyCodeLine{00098\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ lhs\_vert\ =\ base\_m\ +\ load\_idx\_vert;}
\DoxyCodeLine{00099\ }
\DoxyCodeLine{00100\ \textcolor{preprocessor}{\#define\ prefetchIntoRegisters(base\_k)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00101\ \textcolor{preprocessor}{\ \ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00102\ \textcolor{preprocessor}{\ \ \ \ lhs\_pf0\ =\ conv(0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00103\ \textcolor{preprocessor}{\ \ \ \ lhs\_pf1\ =\ conv(0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00104\ \textcolor{preprocessor}{\ \ \ \ lhs\_pf2\ =\ conv(0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00105\ \textcolor{preprocessor}{\ \ \ \ lhs\_pf3\ =\ conv(0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00106\ \textcolor{preprocessor}{\ \ \ \ lhs\_pf4\ =\ conv(0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00107\ \textcolor{preprocessor}{\ \ \ \ lhs\_pf5\ =\ conv(0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00108\ \textcolor{preprocessor}{\ \ \ \ lhs\_pf6\ =\ conv(0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00109\ \textcolor{preprocessor}{\ \ \ \ lhs\_pf7\ =\ conv(0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00110\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00111\ \textcolor{preprocessor}{\ \ \ \ rhs\_pf0\ =\ conv(0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00112\ \textcolor{preprocessor}{\ \ \ \ rhs\_pf1\ =\ conv(0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00113\ \textcolor{preprocessor}{\ \ \ \ rhs\_pf2\ =\ conv(0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00114\ \textcolor{preprocessor}{\ \ \ \ rhs\_pf3\ =\ conv(0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00115\ \textcolor{preprocessor}{\ \ \ \ rhs\_pf4\ =\ conv(0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00116\ \textcolor{preprocessor}{\ \ \ \ rhs\_pf5\ =\ conv(0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00117\ \textcolor{preprocessor}{\ \ \ \ rhs\_pf6\ =\ conv(0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00118\ \textcolor{preprocessor}{\ \ \ \ rhs\_pf7\ =\ conv(0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00119\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00120\ \textcolor{preprocessor}{\ \ \ \ if\ (!needs\_edge\_check\ ||\ lhs\_vert\ <\ m\_size)\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00121\ \textcolor{preprocessor}{\ \ \ \ \ \ const\ Index\ lhs\_horiz\_0\ =\ base\_k\ +\ threadIdx.z\ +\ 0\ *\ 8;\ \ \ \(\backslash\)}}
\DoxyCodeLine{00122\ \textcolor{preprocessor}{\ \ \ \ \ \ const\ Index\ lhs\_horiz\_1\ =\ base\_k\ +\ threadIdx.z\ +\ 1\ *\ 8;\ \ \ \(\backslash\)}}
\DoxyCodeLine{00123\ \textcolor{preprocessor}{\ \ \ \ \ \ const\ Index\ lhs\_horiz\_2\ =\ base\_k\ +\ threadIdx.z\ +\ 2\ *\ 8;\ \ \ \(\backslash\)}}
\DoxyCodeLine{00124\ \textcolor{preprocessor}{\ \ \ \ \ \ const\ Index\ lhs\_horiz\_3\ =\ base\_k\ +\ threadIdx.z\ +\ 3\ *\ 8;\ \ \ \(\backslash\)}}
\DoxyCodeLine{00125\ \textcolor{preprocessor}{\ \ \ \ \ \ const\ Index\ lhs\_horiz\_4\ =\ base\_k\ +\ threadIdx.z\ +\ 4\ *\ 8;\ \ \ \(\backslash\)}}
\DoxyCodeLine{00126\ \textcolor{preprocessor}{\ \ \ \ \ \ const\ Index\ lhs\_horiz\_5\ =\ base\_k\ +\ threadIdx.z\ +\ 5\ *\ 8;\ \ \ \(\backslash\)}}
\DoxyCodeLine{00127\ \textcolor{preprocessor}{\ \ \ \ \ \ const\ Index\ lhs\_horiz\_6\ =\ base\_k\ +\ threadIdx.z\ +\ 6\ *\ 8;\ \ \ \(\backslash\)}}
\DoxyCodeLine{00128\ \textcolor{preprocessor}{\ \ \ \ \ \ const\ Index\ lhs\_horiz\_7\ =\ base\_k\ +\ threadIdx.z\ +\ 7\ *\ 8;\ \ \ \(\backslash\)}}
\DoxyCodeLine{00129\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00130\ \textcolor{preprocessor}{\ \ \ \ \ \ if\ (!needs\_edge\_check\ ||\ lhs\_horiz\_7\ <\ k\_size)\ \{\ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00131\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ lhs\_pf0\ =\ lhs(lhs\_vert,\ lhs\_horiz\_0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00132\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ lhs\_pf1\ =\ lhs(lhs\_vert,\ lhs\_horiz\_1);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00133\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ lhs\_pf2\ =\ lhs(lhs\_vert,\ lhs\_horiz\_2);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00134\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ lhs\_pf3\ =\ lhs(lhs\_vert,\ lhs\_horiz\_3);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00135\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ lhs\_pf4\ =\ lhs(lhs\_vert,\ lhs\_horiz\_4);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00136\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ lhs\_pf5\ =\ lhs(lhs\_vert,\ lhs\_horiz\_5);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00137\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ lhs\_pf6\ =\ lhs(lhs\_vert,\ lhs\_horiz\_6);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00138\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ lhs\_pf7\ =\ lhs(lhs\_vert,\ lhs\_horiz\_7);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00139\ \textcolor{preprocessor}{\ \ \ \ \ \ \}\ else\ if\ (lhs\_horiz\_6\ <\ k\_size)\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00140\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ lhs\_pf0\ =\ lhs(lhs\_vert,\ lhs\_horiz\_0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00141\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ lhs\_pf1\ =\ lhs(lhs\_vert,\ lhs\_horiz\_1);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00142\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ lhs\_pf2\ =\ lhs(lhs\_vert,\ lhs\_horiz\_2);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00143\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ lhs\_pf3\ =\ lhs(lhs\_vert,\ lhs\_horiz\_3);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00144\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ lhs\_pf4\ =\ lhs(lhs\_vert,\ lhs\_horiz\_4);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00145\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ lhs\_pf5\ =\ lhs(lhs\_vert,\ lhs\_horiz\_5);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00146\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ lhs\_pf6\ =\ lhs(lhs\_vert,\ lhs\_horiz\_6);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00147\ \textcolor{preprocessor}{\ \ \ \ \ \ \}\ else\ if\ (lhs\_horiz\_5\ <\ k\_size)\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00148\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ lhs\_pf0\ =\ lhs(lhs\_vert,\ lhs\_horiz\_0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00149\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ lhs\_pf1\ =\ lhs(lhs\_vert,\ lhs\_horiz\_1);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00150\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ lhs\_pf2\ =\ lhs(lhs\_vert,\ lhs\_horiz\_2);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00151\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ lhs\_pf3\ =\ lhs(lhs\_vert,\ lhs\_horiz\_3);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00152\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ lhs\_pf4\ =\ lhs(lhs\_vert,\ lhs\_horiz\_4);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00153\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ lhs\_pf5\ =\ lhs(lhs\_vert,\ lhs\_horiz\_5);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00154\ \textcolor{preprocessor}{\ \ \ \ \ \ \}\ else\ if\ (lhs\_horiz\_4\ <\ k\_size)\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00155\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ lhs\_pf0\ =\ lhs(lhs\_vert,\ lhs\_horiz\_0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00156\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ lhs\_pf1\ =\ lhs(lhs\_vert,\ lhs\_horiz\_1);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00157\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ lhs\_pf2\ =\ lhs(lhs\_vert,\ lhs\_horiz\_2);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00158\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ lhs\_pf3\ =\ lhs(lhs\_vert,\ lhs\_horiz\_3);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00159\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ lhs\_pf4\ =\ lhs(lhs\_vert,\ lhs\_horiz\_4);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00160\ \textcolor{preprocessor}{\ \ \ \ \ \ \}\ else\ if\ (lhs\_horiz\_3\ <\ k\_size)\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00161\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ lhs\_pf0\ =\ lhs(lhs\_vert,\ lhs\_horiz\_0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00162\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ lhs\_pf1\ =\ lhs(lhs\_vert,\ lhs\_horiz\_1);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00163\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ lhs\_pf2\ =\ lhs(lhs\_vert,\ lhs\_horiz\_2);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00164\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ lhs\_pf3\ =\ lhs(lhs\_vert,\ lhs\_horiz\_3);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00165\ \textcolor{preprocessor}{\ \ \ \ \ \ \}\ else\ if\ (lhs\_horiz\_2\ <\ k\_size)\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00166\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ lhs\_pf0\ =\ lhs(lhs\_vert,\ lhs\_horiz\_0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00167\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ lhs\_pf1\ =\ lhs(lhs\_vert,\ lhs\_horiz\_1);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00168\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ lhs\_pf2\ =\ lhs(lhs\_vert,\ lhs\_horiz\_2);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00169\ \textcolor{preprocessor}{\ \ \ \ \ \ \}\ else\ if\ (lhs\_horiz\_1\ <\ k\_size)\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00170\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ lhs\_pf0\ =\ lhs(lhs\_vert,\ lhs\_horiz\_0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00171\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ lhs\_pf1\ =\ lhs(lhs\_vert,\ lhs\_horiz\_1);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00172\ \textcolor{preprocessor}{\ \ \ \ \ \ \}\ else\ if\ (lhs\_horiz\_0\ <\ k\_size)\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00173\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ lhs\_pf0\ =\ lhs(lhs\_vert,\ lhs\_horiz\_0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00174\ \textcolor{preprocessor}{\ \ \ \ \ \ \}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00175\ \textcolor{preprocessor}{\ \ \ \ \}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00176\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00177\ \textcolor{preprocessor}{\ \ \ \ const\ Index\ rhs\_vert\ =\ base\_k\ +\ load\_idx\_vert;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00178\ \textcolor{preprocessor}{\ \ \ \ if\ (!needs\_edge\_check\ ||\ rhs\_vert\ <\ k\_size)\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00179\ \textcolor{preprocessor}{\ \ \ \ \ \ const\ Index\ rhs\_horiz\_0\ =\ base\_n\ +\ threadIdx.z\ +\ 0\ *\ 8;\ \ \ \(\backslash\)}}
\DoxyCodeLine{00180\ \textcolor{preprocessor}{\ \ \ \ \ \ const\ Index\ rhs\_horiz\_1\ =\ base\_n\ +\ threadIdx.z\ +\ 1\ *\ 8;\ \ \ \(\backslash\)}}
\DoxyCodeLine{00181\ \textcolor{preprocessor}{\ \ \ \ \ \ const\ Index\ rhs\_horiz\_2\ =\ base\_n\ +\ threadIdx.z\ +\ 2\ *\ 8;\ \ \ \(\backslash\)}}
\DoxyCodeLine{00182\ \textcolor{preprocessor}{\ \ \ \ \ \ const\ Index\ rhs\_horiz\_3\ =\ base\_n\ +\ threadIdx.z\ +\ 3\ *\ 8;\ \ \ \(\backslash\)}}
\DoxyCodeLine{00183\ \textcolor{preprocessor}{\ \ \ \ \ \ const\ Index\ rhs\_horiz\_4\ =\ base\_n\ +\ threadIdx.z\ +\ 4\ *\ 8;\ \ \ \(\backslash\)}}
\DoxyCodeLine{00184\ \textcolor{preprocessor}{\ \ \ \ \ \ const\ Index\ rhs\_horiz\_5\ =\ base\_n\ +\ threadIdx.z\ +\ 5\ *\ 8;\ \ \ \(\backslash\)}}
\DoxyCodeLine{00185\ \textcolor{preprocessor}{\ \ \ \ \ \ const\ Index\ rhs\_horiz\_6\ =\ base\_n\ +\ threadIdx.z\ +\ 6\ *\ 8;\ \ \ \(\backslash\)}}
\DoxyCodeLine{00186\ \textcolor{preprocessor}{\ \ \ \ \ \ const\ Index\ rhs\_horiz\_7\ =\ base\_n\ +\ threadIdx.z\ +\ 7\ *\ 8;\ \ \ \(\backslash\)}}
\DoxyCodeLine{00187\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00188\ \textcolor{preprocessor}{\ \ \ \ \ \ if\ (rhs\_horiz\_7\ <\ n\_size)\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00189\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ rhs\_pf0\ =\ rhs(rhs\_vert,\ rhs\_horiz\_0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00190\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ rhs\_pf1\ =\ rhs(rhs\_vert,\ rhs\_horiz\_1);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00191\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ rhs\_pf2\ =\ rhs(rhs\_vert,\ rhs\_horiz\_2);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00192\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ rhs\_pf3\ =\ rhs(rhs\_vert,\ rhs\_horiz\_3);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00193\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ rhs\_pf4\ =\ rhs(rhs\_vert,\ rhs\_horiz\_4);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00194\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ rhs\_pf5\ =\ rhs(rhs\_vert,\ rhs\_horiz\_5);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00195\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ rhs\_pf6\ =\ rhs(rhs\_vert,\ rhs\_horiz\_6);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00196\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ rhs\_pf7\ =\ rhs(rhs\_vert,\ rhs\_horiz\_7);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00197\ \textcolor{preprocessor}{\ \ \ \ \ \ \}\ else\ if\ (rhs\_horiz\_6\ <\ n\_size)\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00198\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ rhs\_pf0\ =\ rhs(rhs\_vert,\ rhs\_horiz\_0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00199\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ rhs\_pf1\ =\ rhs(rhs\_vert,\ rhs\_horiz\_1);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00200\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ rhs\_pf2\ =\ rhs(rhs\_vert,\ rhs\_horiz\_2);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00201\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ rhs\_pf3\ =\ rhs(rhs\_vert,\ rhs\_horiz\_3);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00202\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ rhs\_pf4\ =\ rhs(rhs\_vert,\ rhs\_horiz\_4);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00203\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ rhs\_pf5\ =\ rhs(rhs\_vert,\ rhs\_horiz\_5);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00204\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ rhs\_pf6\ =\ rhs(rhs\_vert,\ rhs\_horiz\_6);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00205\ \textcolor{preprocessor}{\ \ \ \ \ \ \}\ else\ if\ (rhs\_horiz\_5\ <\ n\_size)\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00206\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ rhs\_pf0\ =\ rhs(rhs\_vert,\ rhs\_horiz\_0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00207\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ rhs\_pf1\ =\ rhs(rhs\_vert,\ rhs\_horiz\_1);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00208\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ rhs\_pf2\ =\ rhs(rhs\_vert,\ rhs\_horiz\_2);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00209\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ rhs\_pf3\ =\ rhs(rhs\_vert,\ rhs\_horiz\_3);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00210\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ rhs\_pf4\ =\ rhs(rhs\_vert,\ rhs\_horiz\_4);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00211\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ rhs\_pf5\ =\ rhs(rhs\_vert,\ rhs\_horiz\_5);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00212\ \textcolor{preprocessor}{\ \ \ \ \ \ \}\ else\ if\ (rhs\_horiz\_4\ <\ n\_size)\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00213\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ rhs\_pf0\ =\ rhs(rhs\_vert,\ rhs\_horiz\_0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00214\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ rhs\_pf1\ =\ rhs(rhs\_vert,\ rhs\_horiz\_1);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00215\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ rhs\_pf2\ =\ rhs(rhs\_vert,\ rhs\_horiz\_2);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00216\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ rhs\_pf3\ =\ rhs(rhs\_vert,\ rhs\_horiz\_3);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00217\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ rhs\_pf4\ =\ rhs(rhs\_vert,\ rhs\_horiz\_4);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00218\ \textcolor{preprocessor}{\ \ \ \ \ \ \}\ else\ if\ (rhs\_horiz\_3\ <\ n\_size)\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00219\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ rhs\_pf0\ =\ rhs(rhs\_vert,\ rhs\_horiz\_0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00220\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ rhs\_pf1\ =\ rhs(rhs\_vert,\ rhs\_horiz\_1);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00221\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ rhs\_pf2\ =\ rhs(rhs\_vert,\ rhs\_horiz\_2);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00222\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ rhs\_pf3\ =\ rhs(rhs\_vert,\ rhs\_horiz\_3);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00223\ \textcolor{preprocessor}{\ \ \ \ \ \ \}\ else\ if\ (rhs\_horiz\_2\ <\ n\_size)\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00224\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ rhs\_pf0\ =\ rhs(rhs\_vert,\ rhs\_horiz\_0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00225\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ rhs\_pf1\ =\ rhs(rhs\_vert,\ rhs\_horiz\_1);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00226\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ rhs\_pf2\ =\ rhs(rhs\_vert,\ rhs\_horiz\_2);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00227\ \textcolor{preprocessor}{\ \ \ \ \ \ \}\ else\ if\ (rhs\_horiz\_1\ <\ n\_size)\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00228\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ rhs\_pf0\ =\ rhs(rhs\_vert,\ rhs\_horiz\_0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00229\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ rhs\_pf1\ =\ rhs(rhs\_vert,\ rhs\_horiz\_1);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00230\ \textcolor{preprocessor}{\ \ \ \ \ \ \}\ else\ if\ (rhs\_horiz\_0\ <\ n\_size)\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00231\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ rhs\_pf0\ =\ rhs(rhs\_vert,\ rhs\_horiz\_0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00232\ \textcolor{preprocessor}{\ \ \ \ \ \ \}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00233\ \textcolor{preprocessor}{\ \ \ \ \}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00234\ \textcolor{preprocessor}{\ \ \}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00235\ \textcolor{preprocessor}{}}
\DoxyCodeLine{00236\ \textcolor{preprocessor}{\#define\ writeRegToShmem(\_)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00237\ \textcolor{preprocessor}{\ \ lhs\_shmem[lhs\_store\_idx\_0]\ =\ lhs\_pf0;\ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00238\ \textcolor{preprocessor}{\ \ rhs\_shmem[rhs\_store\_idx\_0]\ =\ rhs\_pf0;\ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00239\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00240\ \textcolor{preprocessor}{\ \ lhs\_shmem[lhs\_store\_idx\_1]\ =\ lhs\_pf1;\ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00241\ \textcolor{preprocessor}{\ \ rhs\_shmem[rhs\_store\_idx\_1]\ =\ rhs\_pf1;\ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00242\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00243\ \textcolor{preprocessor}{\ \ lhs\_shmem[lhs\_store\_idx\_2]\ =\ lhs\_pf2;\ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00244\ \textcolor{preprocessor}{\ \ rhs\_shmem[rhs\_store\_idx\_2]\ =\ rhs\_pf2;\ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00245\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00246\ \textcolor{preprocessor}{\ \ lhs\_shmem[lhs\_store\_idx\_3]\ =\ lhs\_pf3;\ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00247\ \textcolor{preprocessor}{\ \ rhs\_shmem[rhs\_store\_idx\_3]\ =\ rhs\_pf3;\ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00248\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00249\ \textcolor{preprocessor}{\ \ lhs\_shmem[lhs\_store\_idx\_4]\ =\ lhs\_pf4;\ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00250\ \textcolor{preprocessor}{\ \ rhs\_shmem[rhs\_store\_idx\_4]\ =\ rhs\_pf4;\ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00251\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00252\ \textcolor{preprocessor}{\ \ lhs\_shmem[lhs\_store\_idx\_5]\ =\ lhs\_pf5;\ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00253\ \textcolor{preprocessor}{\ \ rhs\_shmem[rhs\_store\_idx\_5]\ =\ rhs\_pf5;\ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00254\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00255\ \textcolor{preprocessor}{\ \ lhs\_shmem[lhs\_store\_idx\_6]\ =\ lhs\_pf6;\ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00256\ \textcolor{preprocessor}{\ \ rhs\_shmem[rhs\_store\_idx\_6]\ =\ rhs\_pf6;\ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00257\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00258\ \textcolor{preprocessor}{\ \ lhs\_shmem[lhs\_store\_idx\_7]\ =\ lhs\_pf7;\ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00259\ \textcolor{preprocessor}{\ \ rhs\_shmem[rhs\_store\_idx\_7]\ =\ rhs\_pf7;\ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00260\ \textcolor{preprocessor}{}}
\DoxyCodeLine{00261\ \ \ \textcolor{comment}{//\ declare\ and\ initialize\ result\ array}}
\DoxyCodeLine{00262\ \textcolor{preprocessor}{\#define\ res(i,\ j)\ \_res\_\#\#i\#\#j}}
\DoxyCodeLine{00263\ \textcolor{preprocessor}{\#define\ initResultRow(i)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00264\ \textcolor{preprocessor}{\ \ Scalar\ res(i,\ 0)\ =\ conv(0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00265\ \textcolor{preprocessor}{\ \ Scalar\ res(i,\ 1)\ =\ conv(0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00266\ \textcolor{preprocessor}{\ \ Scalar\ res(i,\ 2)\ =\ conv(0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00267\ \textcolor{preprocessor}{\ \ Scalar\ res(i,\ 3)\ =\ conv(0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00268\ \textcolor{preprocessor}{\ \ Scalar\ res(i,\ 4)\ =\ conv(0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00269\ \textcolor{preprocessor}{\ \ Scalar\ res(i,\ 5)\ =\ conv(0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00270\ \textcolor{preprocessor}{\ \ Scalar\ res(i,\ 6)\ =\ conv(0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00271\ \textcolor{preprocessor}{\ \ Scalar\ res(i,\ 7)\ =\ conv(0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00272\ \textcolor{preprocessor}{}}
\DoxyCodeLine{00273\ \ \ \mbox{\hyperlink{struct_eigen_1_1internal_1_1scalar__cast__op}{internal::scalar\_cast\_op<int,\ Scalar>}}\ conv;}
\DoxyCodeLine{00274\ \ \ initResultRow(0);}
\DoxyCodeLine{00275\ \ \ initResultRow(1);}
\DoxyCodeLine{00276\ \ \ initResultRow(2);}
\DoxyCodeLine{00277\ \ \ initResultRow(3);}
\DoxyCodeLine{00278\ \ \ initResultRow(4);}
\DoxyCodeLine{00279\ \ \ initResultRow(5);}
\DoxyCodeLine{00280\ \ \ initResultRow(6);}
\DoxyCodeLine{00281\ \ \ initResultRow(7);}
\DoxyCodeLine{00282\ \textcolor{preprocessor}{\#undef\ initResultRow}}
\DoxyCodeLine{00283\ }
\DoxyCodeLine{00284\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ base\_k\ =\ 0;\ base\_k\ <\ k\_size;\ base\_k\ +=\ 64)\ \{}
\DoxyCodeLine{00285\ \ \ \ \ \textcolor{comment}{//\ wait\ for\ previous\ iteration\ to\ finish\ with\ shmem.\ Despite\ common\ sense,}}
\DoxyCodeLine{00286\ \ \ \ \ \textcolor{comment}{//\ the\ code\ is\ a\ bit\ faster\ with\ this\ here\ then\ at\ bottom\ of\ loop}}
\DoxyCodeLine{00287\ \ \ \ \ \_\_syncthreads();}
\DoxyCodeLine{00288\ }
\DoxyCodeLine{00289\ \ \ \ \ prefetchIntoRegisters(base\_k);}
\DoxyCodeLine{00290\ \ \ \ \ writeRegToShmem();}
\DoxyCodeLine{00291\ }
\DoxyCodeLine{00292\ \textcolor{preprocessor}{\ \ \ \ \#undef\ prefetchIntoRegisters}}
\DoxyCodeLine{00293\ \textcolor{preprocessor}{\ \ \ \ \#undef\ writeRegToShmem}}
\DoxyCodeLine{00294\ }
\DoxyCodeLine{00295\ \ \ \ \ \textcolor{comment}{//\ wait\ for\ shared\ mem\ packing\ to\ be\ done\ before\ starting\ computation}}
\DoxyCodeLine{00296\ \ \ \ \ \_\_syncthreads();}
\DoxyCodeLine{00297\ }
\DoxyCodeLine{00298\ \ \ \ \ \textcolor{comment}{//\ compute\ 8x8\ matrix\ product\ by\ outer\ product.\ This\ involves\ packing\ one\ column}}
\DoxyCodeLine{00299\ \ \ \ \ \textcolor{comment}{//\ of\ LHS\ and\ one\ row\ of\ RHS\ into\ registers\ (takes\ 16\ registers).}}
\DoxyCodeLine{00300\ }
\DoxyCodeLine{00301\ \textcolor{preprocessor}{\#define\ lcol(i)\ \_lcol\#\#i}}
\DoxyCodeLine{00302\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_product}{Scalar}}\ lcol(0);}
\DoxyCodeLine{00303\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_product}{Scalar}}\ lcol(1);}
\DoxyCodeLine{00304\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_product}{Scalar}}\ lcol(2);}
\DoxyCodeLine{00305\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_product}{Scalar}}\ lcol(3);}
\DoxyCodeLine{00306\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_product}{Scalar}}\ lcol(4);}
\DoxyCodeLine{00307\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_product}{Scalar}}\ lcol(5);}
\DoxyCodeLine{00308\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_product}{Scalar}}\ lcol(6);}
\DoxyCodeLine{00309\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_product}{Scalar}}\ lcol(7);}
\DoxyCodeLine{00310\ }
\DoxyCodeLine{00311\ \textcolor{preprocessor}{\#define\ rrow(j)\ \_rrow\#\#j}}
\DoxyCodeLine{00312\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_product}{Scalar}}\ rrow(0);}
\DoxyCodeLine{00313\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_product}{Scalar}}\ rrow(1);}
\DoxyCodeLine{00314\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_product}{Scalar}}\ rrow(2);}
\DoxyCodeLine{00315\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_product}{Scalar}}\ rrow(3);}
\DoxyCodeLine{00316\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_product}{Scalar}}\ rrow(4);}
\DoxyCodeLine{00317\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_product}{Scalar}}\ rrow(5);}
\DoxyCodeLine{00318\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_product}{Scalar}}\ rrow(6);}
\DoxyCodeLine{00319\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_product}{Scalar}}\ rrow(7);}
\DoxyCodeLine{00320\ }
\DoxyCodeLine{00321\ \ \ \ \ \textcolor{comment}{//\ Now\ x\ corresponds\ to\ k,\ y\ to\ m,\ and\ z\ to\ n}}
\DoxyCodeLine{00322\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_product}{Scalar}}*\ lhs\_block\ =\ \&lhs\_shmem[\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.x\ +\ 9\ *\ \mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y];}
\DoxyCodeLine{00323\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_product}{Scalar}}*\ rhs\_block\ =\ \&rhs\_shmem[\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.x\ +\ 8\ *\ \mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.z];}
\DoxyCodeLine{00324\ }
\DoxyCodeLine{00325\ \textcolor{preprocessor}{\#define\ lhs\_element(i,\ j)\ lhs\_block[72\ *\ ((i)\ +\ 8\ *\ (j))]}}
\DoxyCodeLine{00326\ \textcolor{preprocessor}{\#define\ rhs\_element(i,\ j)\ rhs\_block[72\ *\ ((i)\ +\ 8\ *\ (j))]}}
\DoxyCodeLine{00327\ }
\DoxyCodeLine{00328\ \textcolor{preprocessor}{\#define\ loadData(i,\ j)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00329\ \textcolor{preprocessor}{\ \ \ \ lcol(0)\ =\ lhs\_element(0,\ j);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00330\ \textcolor{preprocessor}{\ \ \ \ rrow(0)\ =\ rhs\_element(i,\ 0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00331\ \textcolor{preprocessor}{\ \ \ \ lcol(1)\ =\ lhs\_element(1,\ j);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00332\ \textcolor{preprocessor}{\ \ \ \ rrow(1)\ =\ rhs\_element(i,\ 1);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00333\ \textcolor{preprocessor}{\ \ \ \ lcol(2)\ =\ lhs\_element(2,\ j);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00334\ \textcolor{preprocessor}{\ \ \ \ rrow(2)\ =\ rhs\_element(i,\ 2);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00335\ \textcolor{preprocessor}{\ \ \ \ lcol(3)\ =\ lhs\_element(3,\ j);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00336\ \textcolor{preprocessor}{\ \ \ \ rrow(3)\ =\ rhs\_element(i,\ 3);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00337\ \textcolor{preprocessor}{\ \ \ \ lcol(4)\ =\ lhs\_element(4,\ j);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00338\ \textcolor{preprocessor}{\ \ \ \ rrow(4)\ =\ rhs\_element(i,\ 4);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00339\ \textcolor{preprocessor}{\ \ \ \ lcol(5)\ =\ lhs\_element(5,\ j);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00340\ \textcolor{preprocessor}{\ \ \ \ rrow(5)\ =\ rhs\_element(i,\ 5);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00341\ \textcolor{preprocessor}{\ \ \ \ lcol(6)\ =\ lhs\_element(6,\ j);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00342\ \textcolor{preprocessor}{\ \ \ \ rrow(6)\ =\ rhs\_element(i,\ 6);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00343\ \textcolor{preprocessor}{\ \ \ \ lcol(7)\ =\ lhs\_element(7,\ j);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00344\ \textcolor{preprocessor}{\ \ \ \ rrow(7)\ =\ rhs\_element(i,\ 7);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00345\ \textcolor{preprocessor}{}}
\DoxyCodeLine{00346\ \textcolor{preprocessor}{\#define\ computeCol(j)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00347\ \textcolor{preprocessor}{\ \ \ \ res(0,\ j)\ +=\ lcol(0)\ *\ rrow(j);\ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00348\ \textcolor{preprocessor}{\ \ \ \ res(1,\ j)\ +=\ lcol(1)\ *\ rrow(j);\ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00349\ \textcolor{preprocessor}{\ \ \ \ res(2,\ j)\ +=\ lcol(2)\ *\ rrow(j);\ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00350\ \textcolor{preprocessor}{\ \ \ \ res(3,\ j)\ +=\ lcol(3)\ *\ rrow(j);\ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00351\ \textcolor{preprocessor}{\ \ \ \ res(4,\ j)\ +=\ lcol(4)\ *\ rrow(j);\ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00352\ \textcolor{preprocessor}{\ \ \ \ res(5,\ j)\ +=\ lcol(5)\ *\ rrow(j);\ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00353\ \textcolor{preprocessor}{\ \ \ \ res(6,\ j)\ +=\ lcol(6)\ *\ rrow(j);\ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00354\ \textcolor{preprocessor}{\ \ \ \ res(7,\ j)\ +=\ lcol(7)\ *\ rrow(j);\ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00355\ \textcolor{preprocessor}{}}
\DoxyCodeLine{00356\ \textcolor{preprocessor}{\#define\ computePass(i)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00357\ \textcolor{preprocessor}{\ \ \ \ loadData(i,\ i);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00358\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00359\ \textcolor{preprocessor}{\ \ \ \ computeCol(0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00360\ \textcolor{preprocessor}{\ \ \ \ computeCol(1);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00361\ \textcolor{preprocessor}{\ \ \ \ computeCol(2);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00362\ \textcolor{preprocessor}{\ \ \ \ computeCol(3);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00363\ \textcolor{preprocessor}{\ \ \ \ computeCol(4);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00364\ \textcolor{preprocessor}{\ \ \ \ computeCol(5);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00365\ \textcolor{preprocessor}{\ \ \ \ computeCol(6);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00366\ \textcolor{preprocessor}{\ \ \ \ computeCol(7);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00367\ \textcolor{preprocessor}{}}
\DoxyCodeLine{00368\ \ \ \ \ computePass(0);}
\DoxyCodeLine{00369\ \ \ \ \ computePass(1);}
\DoxyCodeLine{00370\ \ \ \ \ computePass(2);}
\DoxyCodeLine{00371\ \ \ \ \ computePass(3);}
\DoxyCodeLine{00372\ \ \ \ \ computePass(4);}
\DoxyCodeLine{00373\ \ \ \ \ computePass(5);}
\DoxyCodeLine{00374\ \ \ \ \ computePass(6);}
\DoxyCodeLine{00375\ \ \ \ \ computePass(7);}
\DoxyCodeLine{00376\ }
\DoxyCodeLine{00377\ \textcolor{preprocessor}{\#undef\ lcol}}
\DoxyCodeLine{00378\ \textcolor{preprocessor}{\#undef\ rrow}}
\DoxyCodeLine{00379\ \textcolor{preprocessor}{\#undef\ lhs\_element}}
\DoxyCodeLine{00380\ \textcolor{preprocessor}{\#undef\ rhs\_element}}
\DoxyCodeLine{00381\ \textcolor{preprocessor}{\#undef\ loadData}}
\DoxyCodeLine{00382\ \textcolor{preprocessor}{\#undef\ computeCol}}
\DoxyCodeLine{00383\ \textcolor{preprocessor}{\#undef\ computePass}}
\DoxyCodeLine{00384\ \ \ \}\ \textcolor{comment}{//\ end\ loop\ over\ k}}
\DoxyCodeLine{00385\ }
\DoxyCodeLine{00386\ \ \ \textcolor{comment}{//\ we've\ now\ iterated\ over\ all\ of\ the\ large\ (ie\ width\ 64)\ k\ blocks\ and}}
\DoxyCodeLine{00387\ \ \ \textcolor{comment}{//\ accumulated\ results\ in\ registers.\ At\ this\ point\ thread\ (x,\ y,\ z)\ contains}}
\DoxyCodeLine{00388\ \ \ \textcolor{comment}{//\ the\ sum\ across\ all\ big\ k\ blocks\ of\ the\ product\ of\ little\ k\ block\ of\ index\ (x,\ y)}}
\DoxyCodeLine{00389\ \ \ \textcolor{comment}{//\ with\ block\ of\ index\ (y,\ z).\ To\ compute\ the\ final\ output,\ we\ need\ to\ reduce}}
\DoxyCodeLine{00390\ \ \ \textcolor{comment}{//\ the\ 8\ threads\ over\ y\ by\ summation.}}
\DoxyCodeLine{00391\ \textcolor{preprocessor}{\#define\ shuffleInc(i,\ j,\ mask)\ res(i,\ j)\ +=\ \_\_shfl\_xor(res(i,\ j),\ mask)}}
\DoxyCodeLine{00392\ }
\DoxyCodeLine{00393\ \textcolor{preprocessor}{\#define\ reduceRow(i,\ mask)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00394\ \textcolor{preprocessor}{\ \ shuffleInc(i,\ 0,\ mask);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00395\ \textcolor{preprocessor}{\ \ shuffleInc(i,\ 1,\ mask);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00396\ \textcolor{preprocessor}{\ \ shuffleInc(i,\ 2,\ mask);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00397\ \textcolor{preprocessor}{\ \ shuffleInc(i,\ 3,\ mask);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00398\ \textcolor{preprocessor}{\ \ shuffleInc(i,\ 4,\ mask);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00399\ \textcolor{preprocessor}{\ \ shuffleInc(i,\ 5,\ mask);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00400\ \textcolor{preprocessor}{\ \ shuffleInc(i,\ 6,\ mask);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00401\ \textcolor{preprocessor}{\ \ shuffleInc(i,\ 7,\ mask);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00402\ \textcolor{preprocessor}{}}
\DoxyCodeLine{00403\ \textcolor{preprocessor}{\#define\ reduceMatrix(mask)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00404\ \textcolor{preprocessor}{\ \ reduceRow(0,\ mask);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00405\ \textcolor{preprocessor}{\ \ reduceRow(1,\ mask);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00406\ \textcolor{preprocessor}{\ \ reduceRow(2,\ mask);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00407\ \textcolor{preprocessor}{\ \ reduceRow(3,\ mask);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00408\ \textcolor{preprocessor}{\ \ reduceRow(4,\ mask);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00409\ \textcolor{preprocessor}{\ \ reduceRow(5,\ mask);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00410\ \textcolor{preprocessor}{\ \ reduceRow(6,\ mask);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00411\ \textcolor{preprocessor}{\ \ reduceRow(7,\ mask);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00412\ \textcolor{preprocessor}{}}
\DoxyCodeLine{00413\ \ \ \textcolor{comment}{//\ actually\ perform\ the\ reduction,\ now\ each\ thread\ of\ index\ (\_,\ y,\ z)}}
\DoxyCodeLine{00414\ \ \ \textcolor{comment}{//\ contains\ the\ correct\ values\ in\ its\ registers\ that\ belong\ in\ the\ output}}
\DoxyCodeLine{00415\ \ \ \textcolor{comment}{//\ block}}
\DoxyCodeLine{00416\ \ \ reduceMatrix(1);}
\DoxyCodeLine{00417\ \ \ reduceMatrix(2);}
\DoxyCodeLine{00418\ \ \ reduceMatrix(4);}
\DoxyCodeLine{00419\ }
\DoxyCodeLine{00420\ \textcolor{preprocessor}{\#undef\ shuffleInc}}
\DoxyCodeLine{00421\ \textcolor{preprocessor}{\#undef\ reduceRow}}
\DoxyCodeLine{00422\ \textcolor{preprocessor}{\#undef\ reduceMatrix}}
\DoxyCodeLine{00423\ }
\DoxyCodeLine{00424\ \ \ \textcolor{comment}{//\ now\ we\ need\ to\ copy\ the\ 64\ values\ into\ main\ memory.\ We\ can't\ split\ work}}
\DoxyCodeLine{00425\ \ \ \textcolor{comment}{//\ among\ threads\ because\ all\ variables\ are\ in\ registers.\ There's\ 2\ ways}}
\DoxyCodeLine{00426\ \ \ \textcolor{comment}{//\ to\ do\ this:}}
\DoxyCodeLine{00427\ \ \ \textcolor{comment}{//\ (1)\ have\ 1\ thread\ do\ 64\ writes\ from\ registers\ into\ global\ memory}}
\DoxyCodeLine{00428\ \ \ \textcolor{comment}{//\ (2)\ have\ 1\ thread\ do\ 64\ writes\ into\ shared\ memory,\ and\ then\ 8\ threads}}
\DoxyCodeLine{00429\ \ \ \textcolor{comment}{//\ \ \ \ \ each\ do\ 8\ writes\ into\ global\ memory.\ We\ can\ just\ overwrite\ the\ shared}}
\DoxyCodeLine{00430\ \ \ \textcolor{comment}{//\ \ \ \ \ memory\ from\ the\ problem\ we\ just\ solved.}}
\DoxyCodeLine{00431\ \ \ \textcolor{comment}{//\ (2)\ is\ slightly\ faster\ than\ (1)\ due\ to\ less\ branching\ and\ more\ ILP}}
\DoxyCodeLine{00432\ }
\DoxyCodeLine{00433\ \ \ \textcolor{comment}{//\ TODO:\ won't\ yield\ much\ gain,\ but\ could\ just\ use\ currently\ unused\ shared\ mem}}
\DoxyCodeLine{00434\ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ and\ then\ we\ won't\ have\ to\ sync}}
\DoxyCodeLine{00435\ \ \ \textcolor{comment}{//\ wait\ for\ shared\ mem\ to\ be\ out\ of\ use}}
\DoxyCodeLine{00436\ \ \ \_\_syncthreads();}
\DoxyCodeLine{00437\ }
\DoxyCodeLine{00438\ \textcolor{preprocessor}{\#define\ writeResultShmem(i,\ j)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00439\ \textcolor{preprocessor}{\ \ lhs\_shmem[i\ +\ 8\ *\ threadIdx.y\ +\ 64\ *\ threadIdx.z\ +\ 512\ *\ j]\ =\ res(i,\ j);\ \(\backslash\)}}
\DoxyCodeLine{00440\ \textcolor{preprocessor}{}}
\DoxyCodeLine{00441\ \textcolor{preprocessor}{\#define\ writeRow(i)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00442\ \textcolor{preprocessor}{\ \ writeResultShmem(i,\ 0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00443\ \textcolor{preprocessor}{\ \ writeResultShmem(i,\ 1);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00444\ \textcolor{preprocessor}{\ \ writeResultShmem(i,\ 2);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00445\ \textcolor{preprocessor}{\ \ writeResultShmem(i,\ 3);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00446\ \textcolor{preprocessor}{\ \ writeResultShmem(i,\ 4);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00447\ \textcolor{preprocessor}{\ \ writeResultShmem(i,\ 5);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00448\ \textcolor{preprocessor}{\ \ writeResultShmem(i,\ 6);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00449\ \textcolor{preprocessor}{\ \ writeResultShmem(i,\ 7);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00450\ \textcolor{preprocessor}{}}
\DoxyCodeLine{00451\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.x\ ==\ 0)\ \{}
\DoxyCodeLine{00452\ \ \ \ \ writeRow(0);}
\DoxyCodeLine{00453\ \ \ \ \ writeRow(1);}
\DoxyCodeLine{00454\ \ \ \ \ writeRow(2);}
\DoxyCodeLine{00455\ \ \ \ \ writeRow(3);}
\DoxyCodeLine{00456\ \ \ \ \ writeRow(4);}
\DoxyCodeLine{00457\ \ \ \ \ writeRow(5);}
\DoxyCodeLine{00458\ \ \ \ \ writeRow(6);}
\DoxyCodeLine{00459\ \ \ \ \ writeRow(7);}
\DoxyCodeLine{00460\ \ \ \}}
\DoxyCodeLine{00461\ \textcolor{preprocessor}{\#undef\ writeResultShmem}}
\DoxyCodeLine{00462\ \textcolor{preprocessor}{\#undef\ writeRow}}
\DoxyCodeLine{00463\ }
\DoxyCodeLine{00464\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ max\_i\_write\ =\ \mbox{\hyperlink{namespace_eigen_1_1numext_ab3b30bf0bcfa1ad91dbec75fabb3bea0}{numext::mini}}((\textcolor{keywordtype}{int})((m\_size\ -\/\ base\_m\ -\/\ \mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y\ +\ 7)\ /\ 8),\ 8);}
\DoxyCodeLine{00465\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ max\_j\_write\ =\ \mbox{\hyperlink{namespace_eigen_1_1numext_ab3b30bf0bcfa1ad91dbec75fabb3bea0}{numext::mini}}((\textcolor{keywordtype}{int})((n\_size\ -\/\ base\_n\ -\/\ \mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.z\ +\ 7)\ /\ 8),\ 8);}
\DoxyCodeLine{00466\ }
\DoxyCodeLine{00467\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.x\ <\ max\_i\_write)\ \{}
\DoxyCodeLine{00468\ \ \ \ \ \textcolor{keywordflow}{if}\ (max\_j\_write\ ==\ 8)\ \{}
\DoxyCodeLine{00469\ \ \ \ \ \ \ \textcolor{comment}{//\ TODO:\ can\ i\ trade\ bank\ conflicts\ for\ coalesced\ writes?}}
\DoxyCodeLine{00470\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_product}{Scalar}}\ val0\ =\ lhs\_shmem[\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.x\ +\ 8\ *\ \mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y\ +\ 64\ *\ \mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.z\ +\ 512\ *\ 0];}
\DoxyCodeLine{00471\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_product}{Scalar}}\ val1\ =\ lhs\_shmem[\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.x\ +\ 8\ *\ \mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y\ +\ 64\ *\ \mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.z\ +\ 512\ *\ 1];}
\DoxyCodeLine{00472\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_product}{Scalar}}\ val2\ =\ lhs\_shmem[\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.x\ +\ 8\ *\ \mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y\ +\ 64\ *\ \mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.z\ +\ 512\ *\ 2];}
\DoxyCodeLine{00473\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_product}{Scalar}}\ val3\ =\ lhs\_shmem[\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.x\ +\ 8\ *\ \mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y\ +\ 64\ *\ \mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.z\ +\ 512\ *\ 3];}
\DoxyCodeLine{00474\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_product}{Scalar}}\ val4\ =\ lhs\_shmem[\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.x\ +\ 8\ *\ \mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y\ +\ 64\ *\ \mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.z\ +\ 512\ *\ 4];}
\DoxyCodeLine{00475\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_product}{Scalar}}\ val5\ =\ lhs\_shmem[\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.x\ +\ 8\ *\ \mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y\ +\ 64\ *\ \mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.z\ +\ 512\ *\ 5];}
\DoxyCodeLine{00476\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_product}{Scalar}}\ val6\ =\ lhs\_shmem[\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.x\ +\ 8\ *\ \mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y\ +\ 64\ *\ \mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.z\ +\ 512\ *\ 6];}
\DoxyCodeLine{00477\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_product}{Scalar}}\ val7\ =\ lhs\_shmem[\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.x\ +\ 8\ *\ \mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y\ +\ 64\ *\ \mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.z\ +\ 512\ *\ 7];}
\DoxyCodeLine{00478\ }
\DoxyCodeLine{00479\ \ \ \ \ \ \ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}}(base\_m\ +\ \mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y\ +\ 8\ *\ \mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.x,\ base\_n\ +\ \mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.z\ +\ 8\ *\ 0)\ =\ val0;}
\DoxyCodeLine{00480\ \ \ \ \ \ \ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}}(base\_m\ +\ \mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y\ +\ 8\ *\ \mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.x,\ base\_n\ +\ \mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.z\ +\ 8\ *\ 1)\ =\ val1;}
\DoxyCodeLine{00481\ \ \ \ \ \ \ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}}(base\_m\ +\ \mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y\ +\ 8\ *\ \mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.x,\ base\_n\ +\ \mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.z\ +\ 8\ *\ 2)\ =\ val2;}
\DoxyCodeLine{00482\ \ \ \ \ \ \ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}}(base\_m\ +\ \mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y\ +\ 8\ *\ \mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.x,\ base\_n\ +\ \mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.z\ +\ 8\ *\ 3)\ =\ val3;}
\DoxyCodeLine{00483\ \ \ \ \ \ \ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}}(base\_m\ +\ \mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y\ +\ 8\ *\ \mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.x,\ base\_n\ +\ \mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.z\ +\ 8\ *\ 4)\ =\ val4;}
\DoxyCodeLine{00484\ \ \ \ \ \ \ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}}(base\_m\ +\ \mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y\ +\ 8\ *\ \mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.x,\ base\_n\ +\ \mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.z\ +\ 8\ *\ 5)\ =\ val5;}
\DoxyCodeLine{00485\ \ \ \ \ \ \ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}}(base\_m\ +\ \mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y\ +\ 8\ *\ \mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.x,\ base\_n\ +\ \mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.z\ +\ 8\ *\ 6)\ =\ val6;}
\DoxyCodeLine{00486\ \ \ \ \ \ \ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}}(base\_m\ +\ \mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y\ +\ 8\ *\ \mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.x,\ base\_n\ +\ \mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.z\ +\ 8\ *\ 7)\ =\ val7;}
\DoxyCodeLine{00487\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00488\ \textcolor{preprocessor}{\#pragma\ unroll\ 7}}
\DoxyCodeLine{00489\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}\ =\ 0;\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}\ <\ max\_j\_write;\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}++)\ \{}
\DoxyCodeLine{00490\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_product}{Scalar}}\ val\ =\ lhs\_shmem[\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.x\ +\ 8\ *\ \mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y\ +\ 64\ *\ \mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.z\ +\ 512\ *\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}];}
\DoxyCodeLine{00491\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}}(base\_m\ +\ \mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y\ +\ 8\ *\ \mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.x,\ base\_n\ +\ \mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.z\ +\ 8\ *\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}})\ =\ val;}
\DoxyCodeLine{00492\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00493\ \ \ \ \ \}}
\DoxyCodeLine{00494\ \ \ \}}
\DoxyCodeLine{00495\ \textcolor{preprocessor}{\#undef\ res}}
\DoxyCodeLine{00496\ \}}
\DoxyCodeLine{00497\ }
\DoxyCodeLine{00498\ }
\DoxyCodeLine{00499\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ \mbox{\hyperlink{class_eigen_1_1_product}{Scalar}},\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}},\ \textcolor{keyword}{typename}\ LhsMapper,}
\DoxyCodeLine{00500\ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{typename}\ RhsMapper,\ \textcolor{keyword}{typename}\ OutputMapper>}
\DoxyCodeLine{00501\ \_\_global\_\_\ \textcolor{keywordtype}{void}}
\DoxyCodeLine{00502\ \_\_launch\_bounds\_\_(512)}
\DoxyCodeLine{00503\ EigenContractionKernel(const\ LhsMapper\ lhs,\ const\ RhsMapper\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}},}
\DoxyCodeLine{00504\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ OutputMapper\ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}},}
\DoxyCodeLine{00505\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ m\_size,\ const\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ n\_size,\ const\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ k\_size)\ \{}
\DoxyCodeLine{00506\ \ \ \_\_shared\_\_\ \mbox{\hyperlink{class_eigen_1_1_product}{Scalar}}\ lhs\_shmem[72\ *\ 64];}
\DoxyCodeLine{00507\ \ \ \_\_shared\_\_\ \mbox{\hyperlink{class_eigen_1_1_product}{Scalar}}\ rhs\_shmem[72\ *\ 64];}
\DoxyCodeLine{00508\ }
\DoxyCodeLine{00509\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ m\_block\_idx\ =\ \mbox{\hyperlink{cuda__common_8h_ab30e5f6958c9264d3c5235d463eb2b57}{blockIdx}}.x;}
\DoxyCodeLine{00510\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ n\_block\_idx\ =\ \mbox{\hyperlink{cuda__common_8h_ab30e5f6958c9264d3c5235d463eb2b57}{blockIdx}}.y;}
\DoxyCodeLine{00511\ }
\DoxyCodeLine{00512\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ base\_m\ =\ 64\ *\ m\_block\_idx;}
\DoxyCodeLine{00513\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ base\_n\ =\ 64\ *\ n\_block\_idx;}
\DoxyCodeLine{00514\ }
\DoxyCodeLine{00515\ \ \ \textcolor{keywordflow}{if}\ (base\_m\ +\ 63\ <\ m\_size\ \&\&\ base\_n\ +\ 63\ <\ n\_size)\ \{}
\DoxyCodeLine{00516\ \ \ \ \ EigenContractionKernelInternal<Scalar,\ Index,\ LhsMapper,\ RhsMapper,\ OutputMapper,\ false>(lhs,\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}},\ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}},\ lhs\_shmem,\ rhs\_shmem,\ m\_size,\ n\_size,\ k\_size);}
\DoxyCodeLine{00517\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00518\ \ \ \ \ EigenContractionKernelInternal<Scalar,\ Index,\ LhsMapper,\ RhsMapper,\ OutputMapper,\ true>(lhs,\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}},\ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}},\ lhs\_shmem,\ rhs\_shmem,\ m\_size,\ n\_size,\ k\_size);}
\DoxyCodeLine{00519\ \ \ \}}
\DoxyCodeLine{00520\ \}}
\DoxyCodeLine{00521\ }
\DoxyCodeLine{00522\ }
\DoxyCodeLine{00523\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}},\ \textcolor{keyword}{typename}\ LhsMapper,}
\DoxyCodeLine{00524\ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{typename}\ RhsMapper,\ \textcolor{keyword}{typename}\ OutputMapper,\ \textcolor{keywordtype}{bool}\ CHECK\_LHS\_BOUNDARY,}
\DoxyCodeLine{00525\ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ CHECK\_RHS\_BOUNDARY>}
\DoxyCodeLine{00526\ \_\_device\_\_\ \mbox{\hyperlink{eigen-3_83_87_2_eigen_2src_2_core_2util_2_macros_8h_af2b60117c00a6e75812de43bfe7db3b1}{EIGEN\_STRONG\_INLINE}}\ \textcolor{keywordtype}{void}}
\DoxyCodeLine{00527\ EigenFloatContractionKernelInternal16x16(\textcolor{keyword}{const}\ LhsMapper\ lhs,\ \textcolor{keyword}{const}\ RhsMapper\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}},}
\DoxyCodeLine{00528\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ OutputMapper\ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}},\ \mbox{\hyperlink{sugar_8h_a67916a16039f1634ef3ad6bc1fe2eb2a}{float2}}\ lhs\_shmem2[][16],}
\DoxyCodeLine{00529\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{sugar_8h_a67916a16039f1634ef3ad6bc1fe2eb2a}{float2}}\ rhs\_shmem2[][8],\ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ m\_size,}
\DoxyCodeLine{00530\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ n\_size,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ k\_size,}
\DoxyCodeLine{00531\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ base\_m,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ base\_n)\ \{}
\DoxyCodeLine{00532\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keywordtype}{float}\ \mbox{\hyperlink{class_eigen_1_1_product}{Scalar}};}
\DoxyCodeLine{00533\ }
\DoxyCodeLine{00534\ \ \ \textcolor{comment}{//\ prefetch\ registers}}
\DoxyCodeLine{00535\ \ \ \mbox{\hyperlink{sugar_8h_ada97ec01294ee3122f2f2c8f4058db0c}{float4}}\ lhs\_pf0,\ rhs\_pf0;}
\DoxyCodeLine{00536\ }
\DoxyCodeLine{00537\ \ \ \mbox{\hyperlink{sugar_8h_ada97ec01294ee3122f2f2c8f4058db0c}{float4}}\ \mbox{\hyperlink{dense__solvers_8cpp_aca3207197454d3587952bfb490eecbf2}{results}}[4];}
\DoxyCodeLine{00538\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}=0;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ <\ 4;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}++)\ \{}
\DoxyCodeLine{00539\ \ \ \ \ \mbox{\hyperlink{dense__solvers_8cpp_aca3207197454d3587952bfb490eecbf2}{results}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}].x\ =\ \mbox{\hyperlink{dense__solvers_8cpp_aca3207197454d3587952bfb490eecbf2}{results}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}].y\ =\ \mbox{\hyperlink{dense__solvers_8cpp_aca3207197454d3587952bfb490eecbf2}{results}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}].z\ =\ \mbox{\hyperlink{dense__solvers_8cpp_aca3207197454d3587952bfb490eecbf2}{results}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}].w\ =\ 0;}
\DoxyCodeLine{00540\ \ \ \}}
\DoxyCodeLine{00541\ }
\DoxyCodeLine{00542\ }
\DoxyCodeLine{00543\ \textcolor{preprocessor}{\#define\ prefetch\_lhs(reg,\ row,\ col)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00544\ \textcolor{preprocessor}{\ \ \ \ if\ (!CHECK\_LHS\_BOUNDARY)\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00545\ \textcolor{preprocessor}{\ \ \ \ \ \ if\ (col\ <\ k\_size)\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00546\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ reg\ =lhs.loadPacket<Unaligned>(row,\ col);\ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00547\ \textcolor{preprocessor}{\ \ \ \ \ \ \}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00548\ \textcolor{preprocessor}{\ \ \ \ \}\ else\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00549\ \textcolor{preprocessor}{\ \ \ \ \ \ if\ (col\ <\ k\_size)\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00550\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ if\ (row\ +\ 3\ <\ m\_size)\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00551\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ reg\ =lhs.loadPacket<Unaligned>(row,\ col);\ \ \ \(\backslash\)}}
\DoxyCodeLine{00552\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \}\ else\ if\ (row\ +\ 2\ <\ m\_size)\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00553\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ reg.x\ =lhs(row\ +\ 0,\ col);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00554\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ reg.y\ =lhs(row\ +\ 1,\ col);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00555\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ reg.z\ =lhs(row\ +\ 2,\ col);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00556\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \}\ else\ if\ (row\ +\ 1\ <\ m\_size)\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00557\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ reg.x\ =lhs(row\ +\ 0,\ col);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00558\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ reg.y\ =lhs(row\ +\ 1,\ col);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00559\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \}\ else\ if\ (row\ \ <\ m\_size)\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00560\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ reg.x\ =lhs(row\ +\ 0,\ col);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00561\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00562\ \textcolor{preprocessor}{\ \ \ \ \ \ \}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00563\ \textcolor{preprocessor}{\ \ \ \ \}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00564\ \textcolor{preprocessor}{}}
\DoxyCodeLine{00565\ }
\DoxyCodeLine{00566\ \ \ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ lhs\_vert\ =\ base\_m+\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.x*4;}
\DoxyCodeLine{00567\ }
\DoxyCodeLine{00568\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ k\ =\ 0;\ k\ <\ k\_size;\ k\ +=\ 16)\ \{}
\DoxyCodeLine{00569\ \ \ \ \ lhs\_pf0\ =\ \mbox{\hyperlink{namespace_eigen_1_1internal_afa6f9a9f3c905b28cc29841935e44fdb}{internal::pset1<float4>}}(0);}
\DoxyCodeLine{00570\ \ \ \ \ rhs\_pf0\ =\ \mbox{\hyperlink{namespace_eigen_1_1internal_afa6f9a9f3c905b28cc29841935e44fdb}{internal::pset1<float4>}}(0);}
\DoxyCodeLine{00571\ }
\DoxyCodeLine{00572\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ lhs\_horiz\ =\ \mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y+k;}
\DoxyCodeLine{00573\ \ \ \ \ prefetch\_lhs(lhs\_pf0,\ lhs\_vert,\ lhs\_horiz)}
\DoxyCodeLine{00574\ }
\DoxyCodeLine{00575\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ rhs\_vert\ =\ k+(\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.x\%4)*4;}
\DoxyCodeLine{00576\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ rhs\_horiz0\ =\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.x>>2)+\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y*4+base\_n;}
\DoxyCodeLine{00577\ }
\DoxyCodeLine{00578\ \ \ \ \ \textcolor{keywordflow}{if}\ (!CHECK\_RHS\_BOUNDARY)\ \{}
\DoxyCodeLine{00579\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((rhs\_vert\ +\ 3)\ <\ k\_size)\ \{}
\DoxyCodeLine{00580\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ just\ CHECK\_RHS\_BOUNDARY}}
\DoxyCodeLine{00581\ \ \ \ \ \ \ \ \ rhs\_pf0\ =\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}.loadPacket<\mbox{\hyperlink{group__enums_gga45fe06e29902b7a2773de05ba27b47a1a4e19dd09d5ff42295ba1d72d12a46686}{Unaligned}}>(rhs\_vert,\ rhs\_horiz0);}
\DoxyCodeLine{00582\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (rhs\_vert\ +\ 2\ <\ k\_size)\ \{}
\DoxyCodeLine{00583\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ just\ CHECK\_RHS\_BOUNDARY}}
\DoxyCodeLine{00584\ \ \ \ \ \ \ \ \ rhs\_pf0.x\ =\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}(rhs\_vert,\ rhs\_horiz0);}
\DoxyCodeLine{00585\ \ \ \ \ \ \ \ \ rhs\_pf0.y\ =\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}(rhs\_vert\ +\ 1,\ rhs\_horiz0);}
\DoxyCodeLine{00586\ \ \ \ \ \ \ \ \ rhs\_pf0.z\ =\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}(rhs\_vert\ +\ 2,\ rhs\_horiz0);}
\DoxyCodeLine{00587\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (rhs\_vert\ +\ 1\ <\ k\_size)\ \{}
\DoxyCodeLine{00588\ \ \ \ \ \ \ \ \ rhs\_pf0.x\ =\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}(rhs\_vert,\ rhs\_horiz0);}
\DoxyCodeLine{00589\ \ \ \ \ \ \ \ \ rhs\_pf0.y\ =\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}(rhs\_vert\ +\ 1,\ rhs\_horiz0);}
\DoxyCodeLine{00590\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (rhs\_vert\ \ <\ k\_size)\ \{}
\DoxyCodeLine{00591\ \ \ \ \ \ \ \ \ rhs\_pf0.x\ =\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}(rhs\_vert,\ rhs\_horiz0);}
\DoxyCodeLine{00592\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00593\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00594\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (rhs\_horiz0\ <\ n\_size)\ \{}
\DoxyCodeLine{00595\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((rhs\_vert\ +\ 3)\ <\ k\_size)\ \{}
\DoxyCodeLine{00596\ \ \ \ \ \ \ \ \ \ \ rhs\_pf0\ =\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}.loadPacket<\mbox{\hyperlink{group__enums_gga45fe06e29902b7a2773de05ba27b47a1a4e19dd09d5ff42295ba1d72d12a46686}{Unaligned}}>(rhs\_vert,\ rhs\_horiz0);}
\DoxyCodeLine{00597\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ ((rhs\_vert\ +\ 2)\ <\ k\_size)\ \{}
\DoxyCodeLine{00598\ \ \ \ \ \ \ \ \ \ \ rhs\_pf0.x\ =\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}(rhs\_vert,\ rhs\_horiz0);}
\DoxyCodeLine{00599\ \ \ \ \ \ \ \ \ \ \ rhs\_pf0.y\ =\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}(rhs\_vert\ +\ 1,\ rhs\_horiz0);}
\DoxyCodeLine{00600\ \ \ \ \ \ \ \ \ \ \ rhs\_pf0.z\ =\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}(rhs\_vert\ +\ 2,\ rhs\_horiz0);}
\DoxyCodeLine{00601\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ ((rhs\_vert\ +\ 1)\ <\ k\_size)\ \{}
\DoxyCodeLine{00602\ \ \ \ \ \ \ \ \ \ \ rhs\_pf0.x\ =\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}(rhs\_vert,\ rhs\_horiz0);}
\DoxyCodeLine{00603\ \ \ \ \ \ \ \ \ \ \ rhs\_pf0.y\ =\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}(rhs\_vert\ +\ 1,\ rhs\_horiz0);}
\DoxyCodeLine{00604\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (rhs\_vert\ \ <\ k\_size)\ \{}
\DoxyCodeLine{00605\ \ \ \ \ \ \ \ \ \ \ rhs\_pf0.x\ =\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}(rhs\_vert,\ rhs\_horiz0);}
\DoxyCodeLine{00606\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00607\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00608\ \ \ \ \ \}}
\DoxyCodeLine{00609\ \ \ \ \ \textcolor{keywordtype}{float}\ x1,\ x2\ ;}
\DoxyCodeLine{00610\ \ \ \ \ \textcolor{comment}{//\ the\ following\ can\ be\ a\ bitwise\ operation.....\ some\ day.}}
\DoxyCodeLine{00611\ \ \ \ \ \textcolor{keywordflow}{if}((\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.x\%8)\ <\ 4)\ \{}
\DoxyCodeLine{00612\ \ \ \ \ \ \ x1\ =\ rhs\_pf0.y;}
\DoxyCodeLine{00613\ \ \ \ \ \ \ x2\ =\ rhs\_pf0.w;}
\DoxyCodeLine{00614\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00615\ \ \ \ \ \ \ x1\ =\ rhs\_pf0.x;}
\DoxyCodeLine{00616\ \ \ \ \ \ \ x2\ =\ rhs\_pf0.z;}
\DoxyCodeLine{00617\ \ \ \ \ \}}
\DoxyCodeLine{00618\ \ \ \ \ x1\ =\ \_\_shfl\_xor(x1,\ 4);}
\DoxyCodeLine{00619\ \ \ \ \ x2\ =\ \_\_shfl\_xor(x2,\ 4);}
\DoxyCodeLine{00620\ \ \ \ \ \textcolor{keywordflow}{if}((\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.x\%8)\ <\ 4)\ \{}
\DoxyCodeLine{00621\ \ \ \ \ \ \ rhs\_pf0.y\ =\ x1;}
\DoxyCodeLine{00622\ \ \ \ \ \ \ rhs\_pf0.w\ =\ x2;}
\DoxyCodeLine{00623\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00624\ \ \ \ \ \ \ rhs\_pf0.x\ =\ x1;}
\DoxyCodeLine{00625\ \ \ \ \ \ \ rhs\_pf0.z\ =\ x2;}
\DoxyCodeLine{00626\ \ \ \ \ \}}
\DoxyCodeLine{00627\ }
\DoxyCodeLine{00628\ \ \ \ \ \textcolor{comment}{//\ We\ have\ 64\ features.}}
\DoxyCodeLine{00629\ \ \ \ \ \textcolor{comment}{//\ Row\ 0\ -\/>\ times\ (0,\ 4,\ 8,\ 12,\ 1,\ 5,\ 9,\ 13)\ for\ features\ 0,\ 1.}}
\DoxyCodeLine{00630\ \ \ \ \ \textcolor{comment}{//\ Row\ 1\ -\/>\ times\ (0,\ 4,\ 8,\ 12,\ 1,\ 5,\ 9,\ 13)\ for\ features\ 2,\ 3.}}
\DoxyCodeLine{00631\ \ \ \ \ \textcolor{comment}{//\ ...}}
\DoxyCodeLine{00632\ \ \ \ \ \textcolor{comment}{//\ Row\ 31\ -\/>\ times\ (0,\ 4,\ 8,\ 12,\ 1,\ 5,\ 9,\ 13)\ for\ features\ 62,\ 63}}
\DoxyCodeLine{00633\ \ \ \ \ \textcolor{comment}{//\ Row\ 32\ -\/>\ times\ (2,\ 6,\ 10,\ 14,\ 3,\ 7,\ 11,\ 15)\ for\ features\ 0,\ 1}}
\DoxyCodeLine{00634\ \ \ \ \ \textcolor{comment}{//\ ...}}
\DoxyCodeLine{00635\ \ \ \ \ rhs\_shmem2[(\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.x>>3)+\ \mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y*2][\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.x\%8]\ =\ make\_float2(rhs\_pf0.x,\ rhs\_pf0.y);}
\DoxyCodeLine{00636\ \ \ \ \ rhs\_shmem2[(\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.x>>3)+\ \mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y*2+32][\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.x\%8]\ =\ make\_float2(rhs\_pf0.z,\ rhs\_pf0.w);}
\DoxyCodeLine{00637\ }
\DoxyCodeLine{00638\ \ \ \ \ \textcolor{comment}{//\ Row\ 0\ (time\ 0)\ -\/>\ features\ (0,\ 1),\ (4,\ 5),\ ..\ (28,\ 29),\ (32,\ 33),\ ..\ \ (60,\ 61)}}
\DoxyCodeLine{00639\ \ \ \ \ \textcolor{comment}{//\ Row\ 1\ (time\ 1)\ -\/>\ features\ (0,\ 1),\ (4,\ 5),\ ..\ (28,\ 29),\ (32,\ 33),\ ..\ \ (60,\ 61)}}
\DoxyCodeLine{00640\ \ \ \ \ \textcolor{comment}{//\ ...}}
\DoxyCodeLine{00641\ \ \ \ \ \textcolor{comment}{//\ Row\ 15\ (time\ 15)\ -\/>\ features\ (0,\ 1),\ (4,\ 5),\ ..\ (28,\ 29),\ (32,\ 33),\ ..\ \ (60,\ 61)}}
\DoxyCodeLine{00642\ \ \ \ \ \textcolor{comment}{//\ Row\ 16\ (time\ 0)\ -\/>\ features\ (2,\ 3),\ (6,\ 7),\ ..\ (30,\ 31),\ (34,\ 35),\ ..\ \ (62,\ 63)}}
\DoxyCodeLine{00643\ \ \ \ \ \textcolor{comment}{//\ ...}}
\DoxyCodeLine{00644\ }
\DoxyCodeLine{00645\ \ \ \ \ lhs\_shmem2[\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y][\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.x]\ =\ make\_float2(lhs\_pf0.x,\ lhs\_pf0.y);}
\DoxyCodeLine{00646\ \ \ \ \ lhs\_shmem2[\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y+16][\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.x]\ =\ make\_float2(lhs\_pf0.z,\ lhs\_pf0.w);}
\DoxyCodeLine{00647\ }
\DoxyCodeLine{00648\ }
\DoxyCodeLine{00649\ \textcolor{preprocessor}{\#define\ add\_vals(fl1,\ fl2,\ fr1,\ fr2)\(\backslash\)}}
\DoxyCodeLine{00650\ \textcolor{preprocessor}{\ \ \ \ results[0].x\ +=\ fl1.x\ *\ fr1.x;\(\backslash\)}}
\DoxyCodeLine{00651\ \textcolor{preprocessor}{\ \ \ \ results[0].y\ +=\ fl1.y\ *\ fr1.x;\(\backslash\)}}
\DoxyCodeLine{00652\ \textcolor{preprocessor}{\ \ \ \ results[0].z\ +=\ fl2.x\ *\ fr1.x;\(\backslash\)}}
\DoxyCodeLine{00653\ \textcolor{preprocessor}{\ \ \ \ results[0].w\ +=\ fl2.y\ *\ fr1.x;\(\backslash\)}}
\DoxyCodeLine{00654\ \textcolor{preprocessor}{\(\backslash\)}}
\DoxyCodeLine{00655\ \textcolor{preprocessor}{\ \ \ \ results[1].x\ +=\ fl1.x\ *\ fr1.y;\(\backslash\)}}
\DoxyCodeLine{00656\ \textcolor{preprocessor}{\ \ \ \ results[1].y\ +=\ fl1.y\ *\ fr1.y;\(\backslash\)}}
\DoxyCodeLine{00657\ \textcolor{preprocessor}{\ \ \ \ results[1].z\ +=\ fl2.x\ *\ fr1.y;\(\backslash\)}}
\DoxyCodeLine{00658\ \textcolor{preprocessor}{\ \ \ \ results[1].w\ +=\ fl2.y\ *\ fr1.y;\(\backslash\)}}
\DoxyCodeLine{00659\ \textcolor{preprocessor}{\(\backslash\)}}
\DoxyCodeLine{00660\ \textcolor{preprocessor}{\ \ \ \ results[2].x\ +=\ fl1.x\ *\ fr2.x;\(\backslash\)}}
\DoxyCodeLine{00661\ \textcolor{preprocessor}{\ \ \ \ results[2].y\ +=\ fl1.y\ *\ fr2.x;\(\backslash\)}}
\DoxyCodeLine{00662\ \textcolor{preprocessor}{\ \ \ \ results[2].z\ +=\ fl2.x\ *\ fr2.x;\(\backslash\)}}
\DoxyCodeLine{00663\ \textcolor{preprocessor}{\ \ \ \ results[2].w\ +=\ fl2.y\ *\ fr2.x;\(\backslash\)}}
\DoxyCodeLine{00664\ \textcolor{preprocessor}{\(\backslash\)}}
\DoxyCodeLine{00665\ \textcolor{preprocessor}{\ \ \ \ results[3].x\ +=\ fl1.x\ *\ fr2.y;\(\backslash\)}}
\DoxyCodeLine{00666\ \textcolor{preprocessor}{\ \ \ \ results[3].y\ +=\ fl1.y\ *\ fr2.y;\(\backslash\)}}
\DoxyCodeLine{00667\ \textcolor{preprocessor}{\ \ \ \ results[3].z\ +=\ fl2.x\ *\ fr2.y;\(\backslash\)}}
\DoxyCodeLine{00668\ \textcolor{preprocessor}{\ \ \ \ results[3].w\ +=\ fl2.y\ *\ fr2.y;\(\backslash\)}}
\DoxyCodeLine{00669\ \textcolor{preprocessor}{}}
\DoxyCodeLine{00670\ \ \ \ \ \_\_syncthreads();}
\DoxyCodeLine{00671\ }
\DoxyCodeLine{00672\ \ \ \ \ \textcolor{comment}{//\ Do\ the\ multiplies.}}
\DoxyCodeLine{00673\ \textcolor{preprocessor}{\ \ \ \ \#pragma\ unroll}}
\DoxyCodeLine{00674\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ koff\ =\ 0;\ koff\ <\ 16;\ koff\ ++)\ \{}
\DoxyCodeLine{00675\ \ \ \ \ \ \ \textcolor{comment}{//\ 32\ x\ threads.}}
\DoxyCodeLine{00676\ \ \ \ \ \ \ \mbox{\hyperlink{sugar_8h_a67916a16039f1634ef3ad6bc1fe2eb2a}{float2}}\ fl1\ =\ lhs\_shmem2[koff][\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.x];}
\DoxyCodeLine{00677\ \ \ \ \ \ \ \mbox{\hyperlink{sugar_8h_a67916a16039f1634ef3ad6bc1fe2eb2a}{float2}}\ fl2\ =\ lhs\_shmem2[koff\ +\ 16][\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.x];}
\DoxyCodeLine{00678\ }
\DoxyCodeLine{00679\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ start\_feature\ =\ \mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y\ *\ 4;}
\DoxyCodeLine{00680\ \ \ \ \ \ \ \mbox{\hyperlink{sugar_8h_a67916a16039f1634ef3ad6bc1fe2eb2a}{float2}}\ fr1\ =\ rhs\_shmem2[(start\_feature>>1)\ +\ 32*((koff\%4)/2)][koff/4\ +\ (koff\%2)*4];}
\DoxyCodeLine{00681\ \ \ \ \ \ \ \mbox{\hyperlink{sugar_8h_a67916a16039f1634ef3ad6bc1fe2eb2a}{float2}}\ fr2\ =\ rhs\_shmem2[(start\_feature>>1)\ +\ 1\ +\ 32*((koff\%4)/2)][koff/4\ +\ (koff\%2)*4];}
\DoxyCodeLine{00682\ }
\DoxyCodeLine{00683\ \ \ \ \ \ \ add\_vals(fl1,\ fl2,\ fr1,\ fr2)}
\DoxyCodeLine{00684\ \ \ \ \ \}}
\DoxyCodeLine{00685\ \ \ \ \ \_\_syncthreads();}
\DoxyCodeLine{00686\ \ \ \}}
\DoxyCodeLine{00687\ }
\DoxyCodeLine{00688\ \textcolor{preprocessor}{\#undef\ prefetch\_lhs}}
\DoxyCodeLine{00689\ \textcolor{preprocessor}{\#undef\ add\_vals}}
\DoxyCodeLine{00690\ }
\DoxyCodeLine{00691\ \ \ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ horiz\_base\ =\ \mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y*4+base\_n;}
\DoxyCodeLine{00692\ \ \ \textcolor{keywordflow}{if}\ (!CHECK\_LHS\_BOUNDARY\ \&\&\ !CHECK\_RHS\_BOUNDARY)\ \{}
\DoxyCodeLine{00693\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ =\ 0;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ <\ 4;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}++)\ \{}
\DoxyCodeLine{00694\ \ \ \ \ \ \ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}}(lhs\_vert,\ horiz\_base\ +\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ =\ \mbox{\hyperlink{dense__solvers_8cpp_aca3207197454d3587952bfb490eecbf2}{results}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}].x;}
\DoxyCodeLine{00695\ \ \ \ \ \ \ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}}(lhs\_vert\ +\ 1,\ horiz\_base\ +\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ =\ \mbox{\hyperlink{dense__solvers_8cpp_aca3207197454d3587952bfb490eecbf2}{results}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}].y;}
\DoxyCodeLine{00696\ \ \ \ \ \ \ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}}(lhs\_vert\ +\ 2,\ horiz\_base\ +\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ =\ \mbox{\hyperlink{dense__solvers_8cpp_aca3207197454d3587952bfb490eecbf2}{results}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}].z;}
\DoxyCodeLine{00697\ \ \ \ \ \ \ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}}(lhs\_vert\ +\ 3,\ horiz\_base\ +\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ =\ \mbox{\hyperlink{dense__solvers_8cpp_aca3207197454d3587952bfb490eecbf2}{results}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}].w;}
\DoxyCodeLine{00698\ \ \ \ \ \}}
\DoxyCodeLine{00699\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (!CHECK\_RHS\_BOUNDARY)\ \{}
\DoxyCodeLine{00700\ \ \ \ \ \textcolor{comment}{//\ CHECK\ LHS}}
\DoxyCodeLine{00701\ \ \ \ \ \textcolor{keywordflow}{if}\ (lhs\_vert\ +\ 3\ <\ m\_size)\ \{}
\DoxyCodeLine{00702\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ =\ 0;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ <\ 4;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}++)\ \{}
\DoxyCodeLine{00703\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}}(lhs\_vert,\ horiz\_base\ +\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ =\ \mbox{\hyperlink{dense__solvers_8cpp_aca3207197454d3587952bfb490eecbf2}{results}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}].x;}
\DoxyCodeLine{00704\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}}(lhs\_vert\ +\ 1,\ horiz\_base\ +\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ =\ \mbox{\hyperlink{dense__solvers_8cpp_aca3207197454d3587952bfb490eecbf2}{results}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}].y;}
\DoxyCodeLine{00705\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}}(lhs\_vert\ +\ 2,\ horiz\_base\ +\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ =\ \mbox{\hyperlink{dense__solvers_8cpp_aca3207197454d3587952bfb490eecbf2}{results}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}].z;}
\DoxyCodeLine{00706\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}}(lhs\_vert\ +\ 3,\ horiz\_base\ +\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ =\ \mbox{\hyperlink{dense__solvers_8cpp_aca3207197454d3587952bfb490eecbf2}{results}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}].w;}
\DoxyCodeLine{00707\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00708\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (lhs\_vert\ +\ 2\ <\ m\_size)\ \{}
\DoxyCodeLine{00709\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ =\ 0;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ <\ 4;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}++)\ \{}
\DoxyCodeLine{00710\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}}(lhs\_vert,\ horiz\_base\ +\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ =\ \mbox{\hyperlink{dense__solvers_8cpp_aca3207197454d3587952bfb490eecbf2}{results}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}].x;}
\DoxyCodeLine{00711\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}}(lhs\_vert\ +\ 1,\ horiz\_base\ +\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ =\ \mbox{\hyperlink{dense__solvers_8cpp_aca3207197454d3587952bfb490eecbf2}{results}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}].y;}
\DoxyCodeLine{00712\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}}(lhs\_vert\ +\ 2,\ horiz\_base\ +\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ =\ \mbox{\hyperlink{dense__solvers_8cpp_aca3207197454d3587952bfb490eecbf2}{results}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}].z;}
\DoxyCodeLine{00713\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00714\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (lhs\_vert\ +\ 1\ <\ m\_size)\ \{}
\DoxyCodeLine{00715\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ =\ 0;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ <\ 4;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}++)\ \{}
\DoxyCodeLine{00716\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}}(lhs\_vert,\ horiz\_base\ +\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ =\ \mbox{\hyperlink{dense__solvers_8cpp_aca3207197454d3587952bfb490eecbf2}{results}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}].x;}
\DoxyCodeLine{00717\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}}(lhs\_vert\ +\ 1,\ horiz\_base\ +\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ =\ \mbox{\hyperlink{dense__solvers_8cpp_aca3207197454d3587952bfb490eecbf2}{results}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}].y;}
\DoxyCodeLine{00718\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00719\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (lhs\_vert\ \ <\ m\_size)\ \{}
\DoxyCodeLine{00720\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ =\ 0;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ <\ 4;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}++)\ \{}
\DoxyCodeLine{00721\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}}(lhs\_vert,\ horiz\_base\ +\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ =\ \mbox{\hyperlink{dense__solvers_8cpp_aca3207197454d3587952bfb490eecbf2}{results}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}].x;}
\DoxyCodeLine{00722\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00723\ \ \ \ \ \}}
\DoxyCodeLine{00724\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (!CHECK\_LHS\_BOUNDARY)\ \{}
\DoxyCodeLine{00725\ \ \ \ \ \textcolor{comment}{//\ CHECK\ RHS}}
\DoxyCodeLine{00726\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00727\ \textcolor{comment}{\ \ \ \ int\ ncols\_rem\ =\ fminf(n\_size-\/\ horiz\_base,\ 4);}}
\DoxyCodeLine{00728\ \textcolor{comment}{\ \ \ \ for\ (int\ i\ =\ 0;\ i\ <\ ncols\_rem;\ i++)\ \{}}
\DoxyCodeLine{00729\ \textcolor{comment}{\ \ \ \ \ \ output(lhs\_vert,\ horiz\_base\ +\ i)\ =\ results[i].x;}}
\DoxyCodeLine{00730\ \textcolor{comment}{\ \ \ \ \ \ output(lhs\_vert\ +\ 1,\ horiz\_base\ +\ i)\ =\ results[i].y;}}
\DoxyCodeLine{00731\ \textcolor{comment}{\ \ \ \ \ \ output(lhs\_vert\ +\ 2,\ horiz\_base\ +\ i)\ =\ results[i].z;}}
\DoxyCodeLine{00732\ \textcolor{comment}{\ \ \ \ \ \ output(lhs\_vert\ +\ 3,\ horiz\_base\ +\ i)\ =\ results[i].w;}}
\DoxyCodeLine{00733\ \textcolor{comment}{\ \ \ \ \}*/}}
\DoxyCodeLine{00734\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ =\ 0;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ <\ 4;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}++)\ \{}
\DoxyCodeLine{00735\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (horiz\_base+\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ <\ n\_size)\ \{}
\DoxyCodeLine{00736\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}}(lhs\_vert,\ horiz\_base\ +\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ =\ \mbox{\hyperlink{dense__solvers_8cpp_aca3207197454d3587952bfb490eecbf2}{results}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}].x;}
\DoxyCodeLine{00737\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}}(lhs\_vert\ +\ 1,\ horiz\_base\ +\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ =\ \mbox{\hyperlink{dense__solvers_8cpp_aca3207197454d3587952bfb490eecbf2}{results}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}].y;}
\DoxyCodeLine{00738\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}}(lhs\_vert\ +\ 2,\ horiz\_base\ +\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ =\ \mbox{\hyperlink{dense__solvers_8cpp_aca3207197454d3587952bfb490eecbf2}{results}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}].z;}
\DoxyCodeLine{00739\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}}(lhs\_vert\ +\ 3,\ horiz\_base\ +\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ =\ \mbox{\hyperlink{dense__solvers_8cpp_aca3207197454d3587952bfb490eecbf2}{results}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}].w;}
\DoxyCodeLine{00740\ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00741\ \ \ \ \ \}}
\DoxyCodeLine{00742\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00743\ \ \ \ \ \textcolor{comment}{//\ CHECK\ both\ boundaries.}}
\DoxyCodeLine{00744\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ =\ 0;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ <\ 4;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}++)\ \{}
\DoxyCodeLine{00745\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (horiz\_base+\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ <\ n\_size)\ \{}
\DoxyCodeLine{00746\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (lhs\_vert\ <\ m\_size)}
\DoxyCodeLine{00747\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}}(lhs\_vert,\ horiz\_base\ +\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ =\ \mbox{\hyperlink{dense__solvers_8cpp_aca3207197454d3587952bfb490eecbf2}{results}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}].x;}
\DoxyCodeLine{00748\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (lhs\_vert\ +\ 1\ <\ m\_size)}
\DoxyCodeLine{00749\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}}(lhs\_vert\ +\ 1,\ horiz\_base\ +\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ =\ \mbox{\hyperlink{dense__solvers_8cpp_aca3207197454d3587952bfb490eecbf2}{results}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}].y;}
\DoxyCodeLine{00750\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (lhs\_vert\ +\ 2\ <\ m\_size)}
\DoxyCodeLine{00751\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}}(lhs\_vert\ +\ 2,\ horiz\_base\ +\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ =\ \mbox{\hyperlink{dense__solvers_8cpp_aca3207197454d3587952bfb490eecbf2}{results}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}].z;}
\DoxyCodeLine{00752\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (lhs\_vert\ +\ 3\ <\ m\_size)}
\DoxyCodeLine{00753\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}}(lhs\_vert\ +\ 3,\ horiz\_base\ +\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ =\ \mbox{\hyperlink{dense__solvers_8cpp_aca3207197454d3587952bfb490eecbf2}{results}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}].w;}
\DoxyCodeLine{00754\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00755\ \ \ \ \ \}}
\DoxyCodeLine{00756\ \ \ \}}
\DoxyCodeLine{00757\ \}}
\DoxyCodeLine{00758\ }
\DoxyCodeLine{00759\ }
\DoxyCodeLine{00760\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}},\ \textcolor{keyword}{typename}\ LhsMapper,}
\DoxyCodeLine{00761\ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{typename}\ RhsMapper,\ \textcolor{keyword}{typename}\ OutputMapper,\ \textcolor{keywordtype}{bool}\ CHECK\_LHS\_BOUNDARY,}
\DoxyCodeLine{00762\ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ CHECK\_RHS\_BOUNDARY>}
\DoxyCodeLine{00763\ \_\_device\_\_\ \mbox{\hyperlink{eigen-3_83_87_2_eigen_2src_2_core_2util_2_macros_8h_af2b60117c00a6e75812de43bfe7db3b1}{EIGEN\_STRONG\_INLINE}}\ \textcolor{keywordtype}{void}}
\DoxyCodeLine{00764\ EigenFloatContractionKernelInternal(\textcolor{keyword}{const}\ LhsMapper\ lhs,\ \textcolor{keyword}{const}\ RhsMapper\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}},}
\DoxyCodeLine{00765\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ OutputMapper\ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}},\ \mbox{\hyperlink{sugar_8h_a67916a16039f1634ef3ad6bc1fe2eb2a}{float2}}\ lhs\_shmem2[][32],}
\DoxyCodeLine{00766\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{sugar_8h_a67916a16039f1634ef3ad6bc1fe2eb2a}{float2}}\ rhs\_shmem2[][8],\ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ m\_size,}
\DoxyCodeLine{00767\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ n\_size,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ k\_size,}
\DoxyCodeLine{00768\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ base\_m,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ base\_n)\ \{}
\DoxyCodeLine{00769\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keywordtype}{float}\ \mbox{\hyperlink{class_eigen_1_1_product}{Scalar}};}
\DoxyCodeLine{00770\ }
\DoxyCodeLine{00771\ \ \ \textcolor{comment}{//\ prefetch\ registers}}
\DoxyCodeLine{00772\ \ \ \mbox{\hyperlink{sugar_8h_ada97ec01294ee3122f2f2c8f4058db0c}{float4}}\ lhs\_pf0,\ lhs\_pf1,\ lhs\_pf2,\ lhs\_pf3;}
\DoxyCodeLine{00773\ \ \ \mbox{\hyperlink{sugar_8h_ada97ec01294ee3122f2f2c8f4058db0c}{float4}}\ rhs\_pf0,\ rhs\_pf1;}
\DoxyCodeLine{00774\ }
\DoxyCodeLine{00775\ \ \ \mbox{\hyperlink{sugar_8h_ada97ec01294ee3122f2f2c8f4058db0c}{float4}}\ \mbox{\hyperlink{dense__solvers_8cpp_aca3207197454d3587952bfb490eecbf2}{results}}[8];}
\DoxyCodeLine{00776\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}=0;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ <\ 8;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}++)\ \{}
\DoxyCodeLine{00777\ \ \ \ \ \mbox{\hyperlink{dense__solvers_8cpp_aca3207197454d3587952bfb490eecbf2}{results}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}].x\ =\ \mbox{\hyperlink{dense__solvers_8cpp_aca3207197454d3587952bfb490eecbf2}{results}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}].y\ =\ \mbox{\hyperlink{dense__solvers_8cpp_aca3207197454d3587952bfb490eecbf2}{results}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}].z\ =\ \mbox{\hyperlink{dense__solvers_8cpp_aca3207197454d3587952bfb490eecbf2}{results}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}].w\ =\ 0;}
\DoxyCodeLine{00778\ \ \ \}}
\DoxyCodeLine{00779\ }
\DoxyCodeLine{00780\ }
\DoxyCodeLine{00781\ \ \ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ lhs\_vert\ =\ base\_m+\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.x*4+(\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y\%4)*32;}
\DoxyCodeLine{00782\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ k\ =\ 0;\ k\ <\ k\_size;\ k\ +=\ 32)\ \{}
\DoxyCodeLine{00783\ \ \ \ \ lhs\_pf0\ =\ \mbox{\hyperlink{namespace_eigen_1_1internal_afa6f9a9f3c905b28cc29841935e44fdb}{internal::pset1<float4>}}(0);}
\DoxyCodeLine{00784\ \ \ \ \ lhs\_pf1\ =\ \mbox{\hyperlink{namespace_eigen_1_1internal_afa6f9a9f3c905b28cc29841935e44fdb}{internal::pset1<float4>}}(0);}
\DoxyCodeLine{00785\ \ \ \ \ lhs\_pf2\ =\ \mbox{\hyperlink{namespace_eigen_1_1internal_afa6f9a9f3c905b28cc29841935e44fdb}{internal::pset1<float4>}}(0);}
\DoxyCodeLine{00786\ \ \ \ \ lhs\_pf3\ =\ \mbox{\hyperlink{namespace_eigen_1_1internal_afa6f9a9f3c905b28cc29841935e44fdb}{internal::pset1<float4>}}(0);}
\DoxyCodeLine{00787\ }
\DoxyCodeLine{00788\ \ \ \ \ rhs\_pf0\ =\ \mbox{\hyperlink{namespace_eigen_1_1internal_afa6f9a9f3c905b28cc29841935e44fdb}{internal::pset1<float4>}}(0);}
\DoxyCodeLine{00789\ \ \ \ \ rhs\_pf1\ =\ \mbox{\hyperlink{namespace_eigen_1_1internal_afa6f9a9f3c905b28cc29841935e44fdb}{internal::pset1<float4>}}(0);}
\DoxyCodeLine{00790\ }
\DoxyCodeLine{00791\ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!CHECK\_LHS\_BOUNDARY)\ \{}
\DoxyCodeLine{00792\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k+24)\ <\ k\_size)\ \{}
\DoxyCodeLine{00793\ \ \ \ \ \ \ \ \ lhs\_pf0\ =lhs.loadPacket<\mbox{\hyperlink{group__enums_gga45fe06e29902b7a2773de05ba27b47a1a4e19dd09d5ff42295ba1d72d12a46686}{Unaligned}}>(lhs\_vert,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k));}
\DoxyCodeLine{00794\ \ \ \ \ \ \ \ \ lhs\_pf1\ =lhs.loadPacket<\mbox{\hyperlink{group__enums_gga45fe06e29902b7a2773de05ba27b47a1a4e19dd09d5ff42295ba1d72d12a46686}{Unaligned}}>(lhs\_vert,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k+8));}
\DoxyCodeLine{00795\ \ \ \ \ \ \ \ \ lhs\_pf2\ =lhs.loadPacket<\mbox{\hyperlink{group__enums_gga45fe06e29902b7a2773de05ba27b47a1a4e19dd09d5ff42295ba1d72d12a46686}{Unaligned}}>(lhs\_vert,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k+16));}
\DoxyCodeLine{00796\ \ \ \ \ \ \ \ \ lhs\_pf3\ =lhs.loadPacket<\mbox{\hyperlink{group__enums_gga45fe06e29902b7a2773de05ba27b47a1a4e19dd09d5ff42295ba1d72d12a46686}{Unaligned}}>(lhs\_vert,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k+24));}
\DoxyCodeLine{00797\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ ((\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k+16)\ <\ k\_size)\ \{}
\DoxyCodeLine{00798\ \ \ \ \ \ \ \ \ lhs\_pf0\ =lhs.loadPacket<\mbox{\hyperlink{group__enums_gga45fe06e29902b7a2773de05ba27b47a1a4e19dd09d5ff42295ba1d72d12a46686}{Unaligned}}>(lhs\_vert,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k));}
\DoxyCodeLine{00799\ \ \ \ \ \ \ \ \ lhs\_pf1\ =lhs.loadPacket<\mbox{\hyperlink{group__enums_gga45fe06e29902b7a2773de05ba27b47a1a4e19dd09d5ff42295ba1d72d12a46686}{Unaligned}}>(lhs\_vert,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k+8));}
\DoxyCodeLine{00800\ \ \ \ \ \ \ \ \ lhs\_pf2\ =lhs.loadPacket<\mbox{\hyperlink{group__enums_gga45fe06e29902b7a2773de05ba27b47a1a4e19dd09d5ff42295ba1d72d12a46686}{Unaligned}}>(lhs\_vert,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k+16));}
\DoxyCodeLine{00801\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ ((\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k+8)\ <\ k\_size)\ \{}
\DoxyCodeLine{00802\ \ \ \ \ \ \ \ \ lhs\_pf0\ =lhs.loadPacket<\mbox{\hyperlink{group__enums_gga45fe06e29902b7a2773de05ba27b47a1a4e19dd09d5ff42295ba1d72d12a46686}{Unaligned}}>(lhs\_vert,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k));}
\DoxyCodeLine{00803\ \ \ \ \ \ \ \ \ lhs\_pf1\ =lhs.loadPacket<\mbox{\hyperlink{group__enums_gga45fe06e29902b7a2773de05ba27b47a1a4e19dd09d5ff42295ba1d72d12a46686}{Unaligned}}>(lhs\_vert,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k+8));}
\DoxyCodeLine{00804\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ ((\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k)\ <\ k\_size)\ \{}
\DoxyCodeLine{00805\ \ \ \ \ \ \ \ \ lhs\_pf0\ =lhs.loadPacket<\mbox{\hyperlink{group__enums_gga45fe06e29902b7a2773de05ba27b47a1a4e19dd09d5ff42295ba1d72d12a46686}{Unaligned}}>(lhs\_vert,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k));}
\DoxyCodeLine{00806\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00807\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00808\ \ \ \ \ \ \ \textcolor{comment}{//\ just\ CHECK\_LHS\_BOUNDARY}}
\DoxyCodeLine{00809\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (lhs\_vert\ +\ 3\ <\ m\_size)\ \{}
\DoxyCodeLine{00810\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k+24)\ <\ k\_size)\ \{}
\DoxyCodeLine{00811\ \ \ \ \ \ \ \ \ \ \ lhs\_pf0\ =lhs.loadPacket<\mbox{\hyperlink{group__enums_gga45fe06e29902b7a2773de05ba27b47a1a4e19dd09d5ff42295ba1d72d12a46686}{Unaligned}}>(lhs\_vert,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k));}
\DoxyCodeLine{00812\ \ \ \ \ \ \ \ \ \ \ lhs\_pf1\ =lhs.loadPacket<\mbox{\hyperlink{group__enums_gga45fe06e29902b7a2773de05ba27b47a1a4e19dd09d5ff42295ba1d72d12a46686}{Unaligned}}>(lhs\_vert,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k+8));}
\DoxyCodeLine{00813\ \ \ \ \ \ \ \ \ \ \ lhs\_pf2\ =lhs.loadPacket<\mbox{\hyperlink{group__enums_gga45fe06e29902b7a2773de05ba27b47a1a4e19dd09d5ff42295ba1d72d12a46686}{Unaligned}}>(lhs\_vert,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k+16));}
\DoxyCodeLine{00814\ \ \ \ \ \ \ \ \ \ \ lhs\_pf3\ =lhs.loadPacket<\mbox{\hyperlink{group__enums_gga45fe06e29902b7a2773de05ba27b47a1a4e19dd09d5ff42295ba1d72d12a46686}{Unaligned}}>(lhs\_vert,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k+24));}
\DoxyCodeLine{00815\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ ((\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k+16)\ <\ k\_size)\ \{}
\DoxyCodeLine{00816\ \ \ \ \ \ \ \ \ \ \ lhs\_pf0\ =lhs.loadPacket<\mbox{\hyperlink{group__enums_gga45fe06e29902b7a2773de05ba27b47a1a4e19dd09d5ff42295ba1d72d12a46686}{Unaligned}}>(lhs\_vert,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k));}
\DoxyCodeLine{00817\ \ \ \ \ \ \ \ \ \ \ lhs\_pf1\ =lhs.loadPacket<\mbox{\hyperlink{group__enums_gga45fe06e29902b7a2773de05ba27b47a1a4e19dd09d5ff42295ba1d72d12a46686}{Unaligned}}>(lhs\_vert,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k+8));}
\DoxyCodeLine{00818\ \ \ \ \ \ \ \ \ \ \ lhs\_pf2\ =lhs.loadPacket<\mbox{\hyperlink{group__enums_gga45fe06e29902b7a2773de05ba27b47a1a4e19dd09d5ff42295ba1d72d12a46686}{Unaligned}}>(lhs\_vert,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k+16));}
\DoxyCodeLine{00819\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ ((\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k+8)\ <\ k\_size)\ \{}
\DoxyCodeLine{00820\ \ \ \ \ \ \ \ \ \ \ lhs\_pf0\ =lhs.loadPacket<\mbox{\hyperlink{group__enums_gga45fe06e29902b7a2773de05ba27b47a1a4e19dd09d5ff42295ba1d72d12a46686}{Unaligned}}>(lhs\_vert,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k));}
\DoxyCodeLine{00821\ \ \ \ \ \ \ \ \ \ \ lhs\_pf1\ =lhs.loadPacket<\mbox{\hyperlink{group__enums_gga45fe06e29902b7a2773de05ba27b47a1a4e19dd09d5ff42295ba1d72d12a46686}{Unaligned}}>(lhs\_vert,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k+8));}
\DoxyCodeLine{00822\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ ((\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k)\ <\ k\_size)\ \{}
\DoxyCodeLine{00823\ \ \ \ \ \ \ \ \ \ \ lhs\_pf0\ =lhs.loadPacket<\mbox{\hyperlink{group__enums_gga45fe06e29902b7a2773de05ba27b47a1a4e19dd09d5ff42295ba1d72d12a46686}{Unaligned}}>(lhs\_vert,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k));}
\DoxyCodeLine{00824\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00825\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (lhs\_vert\ +\ 2\ <\ m\_size)\ \{}
\DoxyCodeLine{00826\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k+24)\ <\ k\_size)\ \{}
\DoxyCodeLine{00827\ \ \ \ \ \ \ \ \ \ \ lhs\_pf0.x\ =lhs(lhs\_vert\ +\ 0,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k));}
\DoxyCodeLine{00828\ \ \ \ \ \ \ \ \ \ \ lhs\_pf0.y\ =lhs(lhs\_vert\ +\ 1,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k));}
\DoxyCodeLine{00829\ \ \ \ \ \ \ \ \ \ \ lhs\_pf0.z\ =lhs(lhs\_vert\ +\ 2,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k));}
\DoxyCodeLine{00830\ \ \ \ \ \ \ \ \ \ \ lhs\_pf1.x\ =lhs(lhs\_vert\ +\ 0,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k+8));}
\DoxyCodeLine{00831\ \ \ \ \ \ \ \ \ \ \ lhs\_pf1.y\ =lhs(lhs\_vert\ +\ 1,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k+8));}
\DoxyCodeLine{00832\ \ \ \ \ \ \ \ \ \ \ lhs\_pf1.z\ =lhs(lhs\_vert\ +\ 2,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k+8));}
\DoxyCodeLine{00833\ \ \ \ \ \ \ \ \ \ \ lhs\_pf2.x\ =lhs(lhs\_vert\ +\ 0,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k+16));}
\DoxyCodeLine{00834\ \ \ \ \ \ \ \ \ \ \ lhs\_pf2.y\ =lhs(lhs\_vert\ +\ 1,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k+16));}
\DoxyCodeLine{00835\ \ \ \ \ \ \ \ \ \ \ lhs\_pf2.z\ =lhs(lhs\_vert\ +\ 2,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k+16));}
\DoxyCodeLine{00836\ \ \ \ \ \ \ \ \ \ \ lhs\_pf3.x\ =lhs(lhs\_vert\ +\ 0,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k+24));}
\DoxyCodeLine{00837\ \ \ \ \ \ \ \ \ \ \ lhs\_pf3.y\ =lhs(lhs\_vert\ +\ 1,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k+24));}
\DoxyCodeLine{00838\ \ \ \ \ \ \ \ \ \ \ lhs\_pf3.z\ =lhs(lhs\_vert\ +\ 2,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k+24));}
\DoxyCodeLine{00839\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ ((\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k+16)\ <\ k\_size)\ \{}
\DoxyCodeLine{00840\ \ \ \ \ \ \ \ \ \ \ lhs\_pf0.x\ =lhs(lhs\_vert\ +\ 0,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k));}
\DoxyCodeLine{00841\ \ \ \ \ \ \ \ \ \ \ lhs\_pf0.y\ =lhs(lhs\_vert\ +\ 1,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k));}
\DoxyCodeLine{00842\ \ \ \ \ \ \ \ \ \ \ lhs\_pf0.z\ =lhs(lhs\_vert\ +\ 2,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k));}
\DoxyCodeLine{00843\ \ \ \ \ \ \ \ \ \ \ lhs\_pf1.x\ =lhs(lhs\_vert\ +\ 0,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k+8));}
\DoxyCodeLine{00844\ \ \ \ \ \ \ \ \ \ \ lhs\_pf1.y\ =lhs(lhs\_vert\ +\ 1,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k+8));}
\DoxyCodeLine{00845\ \ \ \ \ \ \ \ \ \ \ lhs\_pf1.z\ =lhs(lhs\_vert\ +\ 2,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k+8));}
\DoxyCodeLine{00846\ \ \ \ \ \ \ \ \ \ \ lhs\_pf2.x\ =lhs(lhs\_vert\ +\ 0,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k+16));}
\DoxyCodeLine{00847\ \ \ \ \ \ \ \ \ \ \ lhs\_pf2.y\ =lhs(lhs\_vert\ +\ 1,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k+16));}
\DoxyCodeLine{00848\ \ \ \ \ \ \ \ \ \ \ lhs\_pf2.z\ =lhs(lhs\_vert\ +\ 2,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k+16));}
\DoxyCodeLine{00849\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ ((\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k+8)\ <\ k\_size)\ \{}
\DoxyCodeLine{00850\ \ \ \ \ \ \ \ \ \ \ lhs\_pf0.x\ =lhs(lhs\_vert\ +\ 0,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k));}
\DoxyCodeLine{00851\ \ \ \ \ \ \ \ \ \ \ lhs\_pf0.y\ =lhs(lhs\_vert\ +\ 1,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k));}
\DoxyCodeLine{00852\ \ \ \ \ \ \ \ \ \ \ lhs\_pf0.z\ =lhs(lhs\_vert\ +\ 2,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k));}
\DoxyCodeLine{00853\ \ \ \ \ \ \ \ \ \ \ lhs\_pf1.x\ =lhs(lhs\_vert\ +\ 0,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k+8));}
\DoxyCodeLine{00854\ \ \ \ \ \ \ \ \ \ \ lhs\_pf1.y\ =lhs(lhs\_vert\ +\ 1,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k+8));}
\DoxyCodeLine{00855\ \ \ \ \ \ \ \ \ \ \ lhs\_pf1.z\ =lhs(lhs\_vert\ +\ 2,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k+8));}
\DoxyCodeLine{00856\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ ((\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k)\ <\ k\_size)\ \{}
\DoxyCodeLine{00857\ \ \ \ \ \ \ \ \ \ \ lhs\_pf0.x\ =lhs(lhs\_vert\ +\ 0,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k));}
\DoxyCodeLine{00858\ \ \ \ \ \ \ \ \ \ \ lhs\_pf0.y\ =lhs(lhs\_vert\ +\ 1,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k));}
\DoxyCodeLine{00859\ \ \ \ \ \ \ \ \ \ \ lhs\_pf0.z\ =lhs(lhs\_vert\ +\ 2,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k));}
\DoxyCodeLine{00860\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00861\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (lhs\_vert\ +\ 1\ <\ m\_size)\ \{}
\DoxyCodeLine{00862\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k+24)\ <\ k\_size)\ \{}
\DoxyCodeLine{00863\ \ \ \ \ \ \ \ \ \ \ lhs\_pf0.x\ =lhs(lhs\_vert\ +\ 0,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k));}
\DoxyCodeLine{00864\ \ \ \ \ \ \ \ \ \ \ lhs\_pf0.y\ =lhs(lhs\_vert\ +\ 1,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k));}
\DoxyCodeLine{00865\ \ \ \ \ \ \ \ \ \ \ lhs\_pf1.x\ =lhs(lhs\_vert\ +\ 0,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k+8));}
\DoxyCodeLine{00866\ \ \ \ \ \ \ \ \ \ \ lhs\_pf1.y\ =lhs(lhs\_vert\ +\ 1,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k+8));}
\DoxyCodeLine{00867\ \ \ \ \ \ \ \ \ \ \ lhs\_pf2.x\ =lhs(lhs\_vert\ +\ 0,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k+16));}
\DoxyCodeLine{00868\ \ \ \ \ \ \ \ \ \ \ lhs\_pf2.y\ =lhs(lhs\_vert\ +\ 1,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k+16));}
\DoxyCodeLine{00869\ \ \ \ \ \ \ \ \ \ \ lhs\_pf3.x\ =lhs(lhs\_vert\ +\ 0,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k+24));}
\DoxyCodeLine{00870\ \ \ \ \ \ \ \ \ \ \ lhs\_pf3.y\ =lhs(lhs\_vert\ +\ 1,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k+24));}
\DoxyCodeLine{00871\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ ((\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k+16)\ <\ k\_size)\ \{}
\DoxyCodeLine{00872\ \ \ \ \ \ \ \ \ \ \ lhs\_pf0.x\ =lhs(lhs\_vert\ +\ 0,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k));}
\DoxyCodeLine{00873\ \ \ \ \ \ \ \ \ \ \ lhs\_pf0.y\ =lhs(lhs\_vert\ +\ 1,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k));}
\DoxyCodeLine{00874\ \ \ \ \ \ \ \ \ \ \ lhs\_pf1.x\ =lhs(lhs\_vert\ +\ 0,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k+8));}
\DoxyCodeLine{00875\ \ \ \ \ \ \ \ \ \ \ lhs\_pf1.y\ =lhs(lhs\_vert\ +\ 1,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k+8));}
\DoxyCodeLine{00876\ \ \ \ \ \ \ \ \ \ \ lhs\_pf2.x\ =lhs(lhs\_vert\ +\ 0,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k+16));}
\DoxyCodeLine{00877\ \ \ \ \ \ \ \ \ \ \ lhs\_pf2.y\ =lhs(lhs\_vert\ +\ 1,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k+16));}
\DoxyCodeLine{00878\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ ((\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k+8)\ <\ k\_size)\ \{}
\DoxyCodeLine{00879\ \ \ \ \ \ \ \ \ \ \ lhs\_pf0.x\ =lhs(lhs\_vert\ +\ 0,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k));}
\DoxyCodeLine{00880\ \ \ \ \ \ \ \ \ \ \ lhs\_pf0.y\ =lhs(lhs\_vert\ +\ 1,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k));}
\DoxyCodeLine{00881\ \ \ \ \ \ \ \ \ \ \ lhs\_pf1.x\ =lhs(lhs\_vert\ +\ 0,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k+8));}
\DoxyCodeLine{00882\ \ \ \ \ \ \ \ \ \ \ lhs\_pf1.y\ =lhs(lhs\_vert\ +\ 1,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k+8));}
\DoxyCodeLine{00883\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ ((\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k)\ <\ k\_size)\ \{}
\DoxyCodeLine{00884\ \ \ \ \ \ \ \ \ \ \ lhs\_pf0.x\ =lhs(lhs\_vert\ +\ 0,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k));}
\DoxyCodeLine{00885\ \ \ \ \ \ \ \ \ \ \ lhs\_pf0.y\ =lhs(lhs\_vert\ +\ 1,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k));}
\DoxyCodeLine{00886\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00887\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (lhs\_vert\ <\ m\_size)\ \{}
\DoxyCodeLine{00888\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k+24)\ <\ k\_size)\ \{}
\DoxyCodeLine{00889\ \ \ \ \ \ \ \ \ \ \ lhs\_pf0.x\ =lhs(lhs\_vert\ +\ 0,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k));}
\DoxyCodeLine{00890\ \ \ \ \ \ \ \ \ \ \ lhs\_pf1.x\ =lhs(lhs\_vert\ +\ 0,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k+8));}
\DoxyCodeLine{00891\ \ \ \ \ \ \ \ \ \ \ lhs\_pf2.x\ =lhs(lhs\_vert\ +\ 0,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k+16));}
\DoxyCodeLine{00892\ \ \ \ \ \ \ \ \ \ \ lhs\_pf3.x\ =lhs(lhs\_vert\ +\ 0,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k+24));}
\DoxyCodeLine{00893\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ ((\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k+16)\ <\ k\_size)\ \{}
\DoxyCodeLine{00894\ \ \ \ \ \ \ \ \ \ \ lhs\_pf0.x\ =lhs(lhs\_vert\ +\ 0,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k));}
\DoxyCodeLine{00895\ \ \ \ \ \ \ \ \ \ \ lhs\_pf1.x\ =lhs(lhs\_vert\ +\ 0,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k+8));}
\DoxyCodeLine{00896\ \ \ \ \ \ \ \ \ \ \ lhs\_pf2.x\ =lhs(lhs\_vert\ +\ 0,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k+16));}
\DoxyCodeLine{00897\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ ((\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k+8)\ <\ k\_size)\ \{}
\DoxyCodeLine{00898\ \ \ \ \ \ \ \ \ \ \ lhs\_pf0.x\ =lhs(lhs\_vert\ +\ 0,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k));}
\DoxyCodeLine{00899\ \ \ \ \ \ \ \ \ \ \ lhs\_pf1.x\ =lhs(lhs\_vert\ +\ 0,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k+8));}
\DoxyCodeLine{00900\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ ((\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k)\ <\ k\_size)\ \{}
\DoxyCodeLine{00901\ \ \ \ \ \ \ \ \ \ \ lhs\_pf0.x\ =lhs(lhs\_vert\ +\ 0,\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+k));}
\DoxyCodeLine{00902\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00903\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00904\ \ \ \ \ \}}
\DoxyCodeLine{00905\ \ \ \ \ \_\_syncthreads();}
\DoxyCodeLine{00906\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ rhs\_vert\ =\ k+\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.x*4;}
\DoxyCodeLine{00907\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ rhs\_horiz0\ =\ \mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y*2+base\_n;}
\DoxyCodeLine{00908\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ rhs\_horiz1\ =\ \mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y*2+1+base\_n;}
\DoxyCodeLine{00909\ \ \ \ \ \textcolor{keywordflow}{if}\ (!CHECK\_RHS\_BOUNDARY)\ \{}
\DoxyCodeLine{00910\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((rhs\_vert\ +\ 3)\ <\ k\_size)\ \{}
\DoxyCodeLine{00911\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ just\ CHECK\_RHS\_BOUNDARY}}
\DoxyCodeLine{00912\ \ \ \ \ \ \ \ \ rhs\_pf0\ =\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}.loadPacket<\mbox{\hyperlink{group__enums_gga45fe06e29902b7a2773de05ba27b47a1a4e19dd09d5ff42295ba1d72d12a46686}{Unaligned}}>(rhs\_vert,\ rhs\_horiz0);}
\DoxyCodeLine{00913\ \ \ \ \ \ \ \ \ rhs\_pf1\ =\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}.loadPacket<\mbox{\hyperlink{group__enums_gga45fe06e29902b7a2773de05ba27b47a1a4e19dd09d5ff42295ba1d72d12a46686}{Unaligned}}>(rhs\_vert,\ rhs\_horiz1);}
\DoxyCodeLine{00914\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (rhs\_vert\ +\ 2\ <\ k\_size)\ \{}
\DoxyCodeLine{00915\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ just\ CHECK\_RHS\_BOUNDARY}}
\DoxyCodeLine{00916\ \ \ \ \ \ \ \ \ rhs\_pf0.x\ =\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}(rhs\_vert,\ rhs\_horiz0);}
\DoxyCodeLine{00917\ \ \ \ \ \ \ \ \ rhs\_pf0.y\ =\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}(rhs\_vert\ +\ 1,\ rhs\_horiz0);}
\DoxyCodeLine{00918\ \ \ \ \ \ \ \ \ rhs\_pf0.z\ =\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}(rhs\_vert\ +\ 2,\ rhs\_horiz0);}
\DoxyCodeLine{00919\ \ \ \ \ \ \ \ \ rhs\_pf1.x\ =\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}(rhs\_vert,\ rhs\_horiz1);}
\DoxyCodeLine{00920\ \ \ \ \ \ \ \ \ rhs\_pf1.y\ =\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}(rhs\_vert\ +\ 1,\ rhs\_horiz1);}
\DoxyCodeLine{00921\ \ \ \ \ \ \ \ \ rhs\_pf1.z\ =\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}(rhs\_vert\ +\ 2,\ rhs\_horiz1);}
\DoxyCodeLine{00922\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (rhs\_vert\ +\ 1\ <\ k\_size)\ \{}
\DoxyCodeLine{00923\ \ \ \ \ \ \ \ \ rhs\_pf0.x\ =\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}(rhs\_vert,\ rhs\_horiz0);}
\DoxyCodeLine{00924\ \ \ \ \ \ \ \ \ rhs\_pf0.y\ =\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}(rhs\_vert\ +\ 1,\ rhs\_horiz0);}
\DoxyCodeLine{00925\ \ \ \ \ \ \ \ \ rhs\_pf1.x\ =\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}(rhs\_vert,\ rhs\_horiz1);}
\DoxyCodeLine{00926\ \ \ \ \ \ \ \ \ rhs\_pf1.y\ =\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}(rhs\_vert\ +\ 1,\ rhs\_horiz1);}
\DoxyCodeLine{00927\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (rhs\_vert\ \ <\ k\_size)\ \{}
\DoxyCodeLine{00928\ \ \ \ \ \ \ \ \ rhs\_pf0.x\ =\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}(rhs\_vert,\ rhs\_horiz0);}
\DoxyCodeLine{00929\ \ \ \ \ \ \ \ \ rhs\_pf1.x\ =\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}(rhs\_vert,\ rhs\_horiz1);}
\DoxyCodeLine{00930\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00931\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00932\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (rhs\_horiz1\ <\ n\_size)\ \{}
\DoxyCodeLine{00933\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((rhs\_vert\ +\ 3)\ <\ k\_size)\ \{}
\DoxyCodeLine{00934\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ just\ CHECK\_RHS\_BOUNDARY}}
\DoxyCodeLine{00935\ \ \ \ \ \ \ \ \ \ \ rhs\_pf0\ =\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}.loadPacket<\mbox{\hyperlink{group__enums_gga45fe06e29902b7a2773de05ba27b47a1a4e19dd09d5ff42295ba1d72d12a46686}{Unaligned}}>(rhs\_vert,\ rhs\_horiz0);}
\DoxyCodeLine{00936\ \ \ \ \ \ \ \ \ \ \ rhs\_pf1\ =\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}.loadPacket<\mbox{\hyperlink{group__enums_gga45fe06e29902b7a2773de05ba27b47a1a4e19dd09d5ff42295ba1d72d12a46686}{Unaligned}}>(rhs\_vert,\ rhs\_horiz1);}
\DoxyCodeLine{00937\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (rhs\_vert\ +\ 2\ <\ k\_size)\ \{}
\DoxyCodeLine{00938\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ just\ CHECK\_RHS\_BOUNDARY}}
\DoxyCodeLine{00939\ \ \ \ \ \ \ \ \ \ \ rhs\_pf0.x\ =\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}(rhs\_vert,\ rhs\_horiz0);}
\DoxyCodeLine{00940\ \ \ \ \ \ \ \ \ \ \ rhs\_pf0.y\ =\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}(rhs\_vert\ +\ 1,\ rhs\_horiz0);}
\DoxyCodeLine{00941\ \ \ \ \ \ \ \ \ \ \ rhs\_pf0.z\ =\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}(rhs\_vert\ +\ 2,\ rhs\_horiz0);}
\DoxyCodeLine{00942\ \ \ \ \ \ \ \ \ \ \ rhs\_pf1.x\ =\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}(rhs\_vert,\ rhs\_horiz1);}
\DoxyCodeLine{00943\ \ \ \ \ \ \ \ \ \ \ rhs\_pf1.y\ =\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}(rhs\_vert\ +\ 1,\ rhs\_horiz1);}
\DoxyCodeLine{00944\ \ \ \ \ \ \ \ \ \ \ rhs\_pf1.z\ =\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}(rhs\_vert\ +\ 2,\ rhs\_horiz1);}
\DoxyCodeLine{00945\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (k+\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.x*4\ +\ 1\ <\ k\_size)\ \{}
\DoxyCodeLine{00946\ \ \ \ \ \ \ \ \ \ \ rhs\_pf0.x\ =\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}(rhs\_vert,\ rhs\_horiz0);}
\DoxyCodeLine{00947\ \ \ \ \ \ \ \ \ \ \ rhs\_pf0.y\ =\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}(rhs\_vert\ +\ 1,\ rhs\_horiz0);}
\DoxyCodeLine{00948\ \ \ \ \ \ \ \ \ \ \ rhs\_pf1.x\ =\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}(rhs\_vert,\ rhs\_horiz1);}
\DoxyCodeLine{00949\ \ \ \ \ \ \ \ \ \ \ rhs\_pf1.y\ =\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}(rhs\_vert\ +\ 1,\ rhs\_horiz1);}
\DoxyCodeLine{00950\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (k+\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.x*4\ \ <\ k\_size)\ \{}
\DoxyCodeLine{00951\ \ \ \ \ \ \ \ \ \ \ rhs\_pf0.x\ =\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}(rhs\_vert,\ rhs\_horiz0);}
\DoxyCodeLine{00952\ \ \ \ \ \ \ \ \ \ \ rhs\_pf1.x\ =\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}(rhs\_vert,\ rhs\_horiz1);}
\DoxyCodeLine{00953\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00954\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (rhs\_horiz0\ <\ n\_size)\ \{}
\DoxyCodeLine{00955\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((rhs\_vert\ +\ 3)\ <\ k\_size)\ \{}
\DoxyCodeLine{00956\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ just\ CHECK\_RHS\_BOUNDARY}}
\DoxyCodeLine{00957\ \ \ \ \ \ \ \ \ \ \ rhs\_pf0\ =\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}.loadPacket<\mbox{\hyperlink{group__enums_gga45fe06e29902b7a2773de05ba27b47a1a4e19dd09d5ff42295ba1d72d12a46686}{Unaligned}}>(rhs\_vert,\ rhs\_horiz0);}
\DoxyCodeLine{00958\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ ((rhs\_vert\ +\ 2)\ <\ k\_size)\ \{}
\DoxyCodeLine{00959\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ just\ CHECK\_RHS\_BOUNDARY}}
\DoxyCodeLine{00960\ \ \ \ \ \ \ \ \ \ \ rhs\_pf0.x\ =\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}(rhs\_vert,\ rhs\_horiz0);}
\DoxyCodeLine{00961\ \ \ \ \ \ \ \ \ \ \ rhs\_pf0.y\ =\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}(rhs\_vert\ +\ 1,\ rhs\_horiz0);}
\DoxyCodeLine{00962\ \ \ \ \ \ \ \ \ \ \ rhs\_pf0.z\ =\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}(rhs\_vert\ +\ 2,\ rhs\_horiz0);}
\DoxyCodeLine{00963\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ ((rhs\_vert\ +\ 1)\ <\ k\_size)\ \{}
\DoxyCodeLine{00964\ \ \ \ \ \ \ \ \ \ \ rhs\_pf0.x\ =\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}(rhs\_vert,\ rhs\_horiz0);}
\DoxyCodeLine{00965\ \ \ \ \ \ \ \ \ \ \ rhs\_pf0.y\ =\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}(rhs\_vert\ +\ 1,\ rhs\_horiz0);}
\DoxyCodeLine{00966\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (rhs\_vert\ \ <\ k\_size)\ \{}
\DoxyCodeLine{00967\ \ \ \ \ \ \ \ \ \ \ rhs\_pf0.x\ =\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}(rhs\_vert,\ rhs\_horiz0);}
\DoxyCodeLine{00968\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00969\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00970\ \ \ \ \ \}}
\DoxyCodeLine{00971\ \ \ \ \ \_\_syncthreads();}
\DoxyCodeLine{00972\ \ \ \ \ \textcolor{comment}{//\ Loaded.\ Do\ computation}}
\DoxyCodeLine{00973\ \ \ \ \ \textcolor{comment}{//\ Row\ 0\ -\/>\ times\ (0,\ 4,\ 8,\ ..\ 28)\ for\ features\ 0,\ 1.}}
\DoxyCodeLine{00974\ \ \ \ \ \textcolor{comment}{//\ Row\ 1\ -\/>\ times\ (0,\ 4,\ 8,\ ..\ 28)\ for\ features\ 2,\ 3.}}
\DoxyCodeLine{00975\ \ \ \ \ \textcolor{comment}{//\ ..}}
\DoxyCodeLine{00976\ \ \ \ \ \textcolor{comment}{//\ Row\ 31\ -\/>\ times\ (0,\ 4,\ 8,\ ..\ 28)\ for\ features\ 62,\ 63}}
\DoxyCodeLine{00977\ \ \ \ \ rhs\_shmem2[\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y][\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.x]\ =\ make\_float2(rhs\_pf0.x,\ rhs\_pf1.x);}
\DoxyCodeLine{00978\ \ \ \ \ \textcolor{comment}{//\ Row\ 32\ -\/>\ times\ (1,\ 5,\ 9,\ ..\ 29)\ for\ features\ 0,\ 1.}}
\DoxyCodeLine{00979\ \ \ \ \ \textcolor{comment}{//\ Row\ 33\ -\/>\ times\ (1,\ 5,\ 9,\ ..\ 29)\ for\ features\ 2,\ 3.}}
\DoxyCodeLine{00980\ \ \ \ \ \textcolor{comment}{//\ ..}}
\DoxyCodeLine{00981\ \ \ \ \ rhs\_shmem2[\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y+32][\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.x]\ =\ make\_float2(rhs\_pf0.y,\ rhs\_pf1.y);}
\DoxyCodeLine{00982\ \ \ \ \ \textcolor{comment}{//\ Row\ 64\ -\/>\ times\ (2,\ 6,\ 10,\ ..\ 30)\ for\ features\ 0,\ 1.}}
\DoxyCodeLine{00983\ \ \ \ \ \textcolor{comment}{//\ Row\ 65\ -\/>\ times\ (2,\ 6,\ 10,\ ..\ 30)\ for\ features\ 2,\ 3.}}
\DoxyCodeLine{00984\ \ \ \ \ rhs\_shmem2[\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y+64][\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.x]\ =\ make\_float2(rhs\_pf0.z,\ rhs\_pf1.z);}
\DoxyCodeLine{00985\ \ \ \ \ \textcolor{comment}{//\ Row\ 96\ -\/>\ times\ (3,\ 7,\ 11,\ ..\ 31)\ for\ features\ 0,\ 1.}}
\DoxyCodeLine{00986\ \ \ \ \ \textcolor{comment}{//\ Row\ 97\ -\/>\ times\ (3,\ 7,\ 11,\ ..\ 31)\ for\ features\ 2,\ 3.}}
\DoxyCodeLine{00987\ \ \ \ \ rhs\_shmem2[\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y+96][\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.x]\ =\ make\_float2(rhs\_pf0.w,\ rhs\_pf1.w);}
\DoxyCodeLine{00988\ }
\DoxyCodeLine{00989\ \ \ \ \ \textcolor{comment}{//\ LHS.}}
\DoxyCodeLine{00990\ \ \ \ \ \textcolor{comment}{//\ Row\ 0\ (time\ 0)\ -\/>\ features\ (0,\ 1),\ (4,\ 5),\ ..\ (28,\ 29),\ (32,\ 33),\ ..\ \ (60,\ 61)\ ..\ (124,\ 125)}}
\DoxyCodeLine{00991\ \ \ \ \ \textcolor{comment}{//\ Row\ 1\ (time\ 1)\ -\/>\ features\ (0,\ 1),\ (4,\ 5),\ ..\ (28,\ 29),\ (32,\ 33),\ ..\ \ (60,\ 61)\ ..\ (124,\ 125)}}
\DoxyCodeLine{00992\ \ \ \ \ \textcolor{comment}{//\ ...}}
\DoxyCodeLine{00993\ \ \ \ \ \textcolor{comment}{//\ Row\ 8\ (time\ 0)\ -\/>\ features\ (2,\ 3),\ (6,\ 7),\ ..\ (30,\ 31),\ (34,\ 35),\ ..\ \ (62,\ 63)\ ..\ (126,\ 127)}}
\DoxyCodeLine{00994\ \ \ \ \ \textcolor{comment}{//\ Row\ 15\ (time\ 7)\ -\/>\ features\ (2,\ 3),\ (6,\ 7),\ ..\ (30,\ 31),\ (34,\ 35),\ ..\ \ (62,\ 63)\ ..\ (126,\ 127)}}
\DoxyCodeLine{00995\ }
\DoxyCodeLine{00996\ }
\DoxyCodeLine{00997\ \textcolor{preprocessor}{\#define\ add\_vals(a\_feat1,\ a\_feat2,\ f1,\ f2,\ f3,\ f4)\(\backslash\)}}
\DoxyCodeLine{00998\ \textcolor{preprocessor}{\ \ \ \ \ \ results[0].x\ +=\ a\_feat1.x\ *\ f1.x;\(\backslash\)}}
\DoxyCodeLine{00999\ \textcolor{preprocessor}{\ \ \ \ \ \ results[1].x\ +=\ a\_feat1.x\ *\ f1.y;\(\backslash\)}}
\DoxyCodeLine{01000\ \textcolor{preprocessor}{\ \ \ \ \ \ results[2].x\ +=\ a\_feat1.x\ *\ f2.x;\(\backslash\)}}
\DoxyCodeLine{01001\ \textcolor{preprocessor}{\ \ \ \ \ \ results[3].x\ +=\ a\_feat1.x\ *\ f2.y;\(\backslash\)}}
\DoxyCodeLine{01002\ \textcolor{preprocessor}{\ \ \ \ \ \ results[4].x\ +=\ a\_feat1.x\ *\ f3.x;\(\backslash\)}}
\DoxyCodeLine{01003\ \textcolor{preprocessor}{\ \ \ \ \ \ results[5].x\ +=\ a\_feat1.x\ *\ f3.y;\(\backslash\)}}
\DoxyCodeLine{01004\ \textcolor{preprocessor}{\ \ \ \ \ \ results[6].x\ +=\ a\_feat1.x\ *\ f4.x;\(\backslash\)}}
\DoxyCodeLine{01005\ \textcolor{preprocessor}{\ \ \ \ \ \ results[7].x\ +=\ a\_feat1.x\ *\ f4.y;\(\backslash\)}}
\DoxyCodeLine{01006\ \textcolor{preprocessor}{\(\backslash\)}}
\DoxyCodeLine{01007\ \textcolor{preprocessor}{\ \ \ \ \ \ results[0].y\ +=\ a\_feat1.y\ *\ f1.x;\(\backslash\)}}
\DoxyCodeLine{01008\ \textcolor{preprocessor}{\ \ \ \ \ \ results[1].y\ +=\ a\_feat1.y\ *\ f1.y;\(\backslash\)}}
\DoxyCodeLine{01009\ \textcolor{preprocessor}{\ \ \ \ \ \ results[2].y\ +=\ a\_feat1.y\ *\ f2.x;\(\backslash\)}}
\DoxyCodeLine{01010\ \textcolor{preprocessor}{\ \ \ \ \ \ results[3].y\ +=\ a\_feat1.y\ *\ f2.y;\(\backslash\)}}
\DoxyCodeLine{01011\ \textcolor{preprocessor}{\ \ \ \ \ \ results[4].y\ +=\ a\_feat1.y\ *\ f3.x;\(\backslash\)}}
\DoxyCodeLine{01012\ \textcolor{preprocessor}{\ \ \ \ \ \ results[5].y\ +=\ a\_feat1.y\ *\ f3.y;\(\backslash\)}}
\DoxyCodeLine{01013\ \textcolor{preprocessor}{\ \ \ \ \ \ results[6].y\ +=\ a\_feat1.y\ *\ f4.x;\(\backslash\)}}
\DoxyCodeLine{01014\ \textcolor{preprocessor}{\ \ \ \ \ \ results[7].y\ +=\ a\_feat1.y\ *\ f4.y;\(\backslash\)}}
\DoxyCodeLine{01015\ \textcolor{preprocessor}{\(\backslash\)}}
\DoxyCodeLine{01016\ \textcolor{preprocessor}{\ \ \ \ \ \ results[0].z\ +=\ a\_feat2.x\ *\ f1.x;\(\backslash\)}}
\DoxyCodeLine{01017\ \textcolor{preprocessor}{\ \ \ \ \ \ results[1].z\ +=\ a\_feat2.x\ *\ f1.y;\(\backslash\)}}
\DoxyCodeLine{01018\ \textcolor{preprocessor}{\ \ \ \ \ \ results[2].z\ +=\ a\_feat2.x\ *\ f2.x;\(\backslash\)}}
\DoxyCodeLine{01019\ \textcolor{preprocessor}{\ \ \ \ \ \ results[3].z\ +=\ a\_feat2.x\ *\ f2.y;\(\backslash\)}}
\DoxyCodeLine{01020\ \textcolor{preprocessor}{\ \ \ \ \ \ results[4].z\ +=\ a\_feat2.x\ *\ f3.x;\(\backslash\)}}
\DoxyCodeLine{01021\ \textcolor{preprocessor}{\ \ \ \ \ \ results[5].z\ +=\ a\_feat2.x\ *\ f3.y;\(\backslash\)}}
\DoxyCodeLine{01022\ \textcolor{preprocessor}{\ \ \ \ \ \ results[6].z\ +=\ a\_feat2.x\ *\ f4.x;\(\backslash\)}}
\DoxyCodeLine{01023\ \textcolor{preprocessor}{\ \ \ \ \ \ results[7].z\ +=\ a\_feat2.x\ *\ f4.y;\(\backslash\)}}
\DoxyCodeLine{01024\ \textcolor{preprocessor}{\(\backslash\)}}
\DoxyCodeLine{01025\ \textcolor{preprocessor}{\ \ \ \ \ \ results[0].w\ +=\ a\_feat2.y\ *\ f1.x;\(\backslash\)}}
\DoxyCodeLine{01026\ \textcolor{preprocessor}{\ \ \ \ \ \ results[1].w\ +=\ a\_feat2.y\ *\ f1.y;\(\backslash\)}}
\DoxyCodeLine{01027\ \textcolor{preprocessor}{\ \ \ \ \ \ results[2].w\ +=\ a\_feat2.y\ *\ f2.x;\(\backslash\)}}
\DoxyCodeLine{01028\ \textcolor{preprocessor}{\ \ \ \ \ \ results[3].w\ +=\ a\_feat2.y\ *\ f2.y;\(\backslash\)}}
\DoxyCodeLine{01029\ \textcolor{preprocessor}{\ \ \ \ \ \ results[4].w\ +=\ a\_feat2.y\ *\ f3.x;\(\backslash\)}}
\DoxyCodeLine{01030\ \textcolor{preprocessor}{\ \ \ \ \ \ results[5].w\ +=\ a\_feat2.y\ *\ f3.y;\(\backslash\)}}
\DoxyCodeLine{01031\ \textcolor{preprocessor}{\ \ \ \ \ \ results[6].w\ +=\ a\_feat2.y\ *\ f4.x;\(\backslash\)}}
\DoxyCodeLine{01032\ \textcolor{preprocessor}{\ \ \ \ \ \ results[7].w\ +=\ a\_feat2.y\ *\ f4.y;\(\backslash\)}}
\DoxyCodeLine{01033\ \textcolor{preprocessor}{}}
\DoxyCodeLine{01034\ \ \ \ \ lhs\_shmem2[\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4][\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.x+(\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y\%4)*8]\ =\ make\_float2(lhs\_pf0.x,\ lhs\_pf0.y);}
\DoxyCodeLine{01035\ \ \ \ \ lhs\_shmem2[\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+8][\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.x+(\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y\%4)*8]\ =\ make\_float2(lhs\_pf1.x,\ lhs\_pf1.y);}
\DoxyCodeLine{01036\ \ \ \ \ lhs\_shmem2[\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+16][\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.x+(\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y\%4)*8]\ =\ make\_float2(lhs\_pf2.x,\ lhs\_pf2.y);}
\DoxyCodeLine{01037\ \ \ \ \ lhs\_shmem2[\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4+24][\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.x+(\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y\%4)*8]\ =\ make\_float2(lhs\_pf3.x,\ lhs\_pf3.y);}
\DoxyCodeLine{01038\ }
\DoxyCodeLine{01039\ \ \ \ \ lhs\_shmem2[\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4\ +\ 32][\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.x+(\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y\%4)*8]\ =\ make\_float2(lhs\_pf0.z,\ lhs\_pf0.w);}
\DoxyCodeLine{01040\ \ \ \ \ lhs\_shmem2[\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4\ +\ 40][\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.x+(\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y\%4)*8]\ =\ make\_float2(lhs\_pf1.z,\ lhs\_pf1.w);}
\DoxyCodeLine{01041\ \ \ \ \ lhs\_shmem2[\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4\ +\ 48][\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.x+(\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y\%4)*8]\ =\ make\_float2(lhs\_pf2.z,\ lhs\_pf2.w);}
\DoxyCodeLine{01042\ \ \ \ \ lhs\_shmem2[\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4\ +\ 56][\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.x+(\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y\%4)*8]\ =\ make\_float2(lhs\_pf3.z,\ lhs\_pf3.w);}
\DoxyCodeLine{01043\ }
\DoxyCodeLine{01044\ \ \ \ \ \_\_syncthreads();}
\DoxyCodeLine{01045\ }
\DoxyCodeLine{01046\ \ \ \ \ \textcolor{comment}{//\ Do\ the\ multiplies.}}
\DoxyCodeLine{01047\ \textcolor{preprocessor}{\ \ \ \ \#pragma\ unroll}}
\DoxyCodeLine{01048\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ koff\ =\ 0;\ koff\ <\ 32;\ koff\ ++)\ \{}
\DoxyCodeLine{01049\ \ \ \ \ \ \ \mbox{\hyperlink{sugar_8h_a67916a16039f1634ef3ad6bc1fe2eb2a}{float2}}\ a3\ =\ lhs\_shmem2[koff][\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.x\ +\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y\ \%\ 4)\ *\ 8];}
\DoxyCodeLine{01050\ \ \ \ \ \ \ \mbox{\hyperlink{sugar_8h_a67916a16039f1634ef3ad6bc1fe2eb2a}{float2}}\ a4\ =\ lhs\_shmem2[koff\ +\ 32][\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.x\ +\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y\ \%\ 4)\ *\ 8];}
\DoxyCodeLine{01051\ }
\DoxyCodeLine{01052\ \ \ \ \ \ \ \textcolor{comment}{//\ first\ feature\ is\ at\ (threadIdx.y/4)\ *\ 8\ last\ is\ at\ start\ +\ 8.}}
\DoxyCodeLine{01053\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ start\_feature\ =\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y\ /\ 4)\ *\ 8;}
\DoxyCodeLine{01054\ }
\DoxyCodeLine{01055\ \ \ \ \ \ \ \mbox{\hyperlink{sugar_8h_a67916a16039f1634ef3ad6bc1fe2eb2a}{float2}}\ br1\ =\ rhs\_shmem2[start\_feature/2\ +\ \ \ \ \ (koff\ \%\ 4)\ *\ 32][koff/4];}
\DoxyCodeLine{01056\ \ \ \ \ \ \ \mbox{\hyperlink{sugar_8h_a67916a16039f1634ef3ad6bc1fe2eb2a}{float2}}\ br2\ =\ rhs\_shmem2[start\_feature/2\ +\ 1\ +\ (koff\ \%\ 4)\ *\ 32][koff/4];}
\DoxyCodeLine{01057\ \ \ \ \ \ \ \mbox{\hyperlink{sugar_8h_a67916a16039f1634ef3ad6bc1fe2eb2a}{float2}}\ br3\ =\ rhs\_shmem2[start\_feature/2\ +\ 2\ +\ (koff\ \%\ 4)\ *\ 32][koff/4];}
\DoxyCodeLine{01058\ \ \ \ \ \ \ \mbox{\hyperlink{sugar_8h_a67916a16039f1634ef3ad6bc1fe2eb2a}{float2}}\ br4\ =\ rhs\_shmem2[start\_feature/2\ +\ 3\ +\ (koff\ \%\ 4)\ *\ 32][koff/4];}
\DoxyCodeLine{01059\ }
\DoxyCodeLine{01060\ \ \ \ \ \ \ add\_vals(a3,\ a4,\ br1,\ br2,\ br3,\ br4)}
\DoxyCodeLine{01061\ \ \ \ \ \}}
\DoxyCodeLine{01062\ \ \ \ \ \_\_syncthreads();}
\DoxyCodeLine{01063\ \ \ \}\ \textcolor{comment}{//\ end\ loop\ over\ k}}
\DoxyCodeLine{01064\ }
\DoxyCodeLine{01065\ }
\DoxyCodeLine{01066\ \ \ \_\_syncthreads();}
\DoxyCodeLine{01067\ \ \ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ horiz\_base\ =\ (\mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.y/4)*8+base\_n;}
\DoxyCodeLine{01068\ \ \ \textcolor{keywordflow}{if}\ (!CHECK\_LHS\_BOUNDARY\ \&\&\ !CHECK\_RHS\_BOUNDARY)\ \{}
\DoxyCodeLine{01069\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ =\ 0;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ <\ 8;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}++)\ \{}
\DoxyCodeLine{01070\ \ \ \ \ \ \ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}}(lhs\_vert,\ horiz\_base\ +\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ =\ \mbox{\hyperlink{dense__solvers_8cpp_aca3207197454d3587952bfb490eecbf2}{results}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}].x;}
\DoxyCodeLine{01071\ \ \ \ \ \ \ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}}(lhs\_vert\ +\ 1,\ horiz\_base\ +\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ =\ \mbox{\hyperlink{dense__solvers_8cpp_aca3207197454d3587952bfb490eecbf2}{results}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}].y;}
\DoxyCodeLine{01072\ \ \ \ \ \ \ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}}(lhs\_vert\ +\ 2,\ horiz\_base\ +\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ =\ \mbox{\hyperlink{dense__solvers_8cpp_aca3207197454d3587952bfb490eecbf2}{results}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}].z;}
\DoxyCodeLine{01073\ \ \ \ \ \ \ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}}(lhs\_vert\ +\ 3,\ horiz\_base\ +\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ =\ \mbox{\hyperlink{dense__solvers_8cpp_aca3207197454d3587952bfb490eecbf2}{results}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}].w;}
\DoxyCodeLine{01074\ \ \ \ \ \}}
\DoxyCodeLine{01075\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (!CHECK\_RHS\_BOUNDARY)\ \{}
\DoxyCodeLine{01076\ \ \ \ \ \textcolor{keywordflow}{if}\ (lhs\_vert\ +\ 3\ <\ m\_size)\ \{}
\DoxyCodeLine{01077\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ =\ 0;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ <\ 8;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}++)\ \{}
\DoxyCodeLine{01078\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}}(lhs\_vert,\ horiz\_base\ +\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ =\ \mbox{\hyperlink{dense__solvers_8cpp_aca3207197454d3587952bfb490eecbf2}{results}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}].x;}
\DoxyCodeLine{01079\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}}(lhs\_vert\ +\ 1,\ horiz\_base\ +\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ =\ \mbox{\hyperlink{dense__solvers_8cpp_aca3207197454d3587952bfb490eecbf2}{results}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}].y;}
\DoxyCodeLine{01080\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}}(lhs\_vert\ +\ 2,\ horiz\_base\ +\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ =\ \mbox{\hyperlink{dense__solvers_8cpp_aca3207197454d3587952bfb490eecbf2}{results}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}].z;}
\DoxyCodeLine{01081\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}}(lhs\_vert\ +\ 3,\ horiz\_base\ +\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ =\ \mbox{\hyperlink{dense__solvers_8cpp_aca3207197454d3587952bfb490eecbf2}{results}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}].w;}
\DoxyCodeLine{01082\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01083\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (lhs\_vert\ +\ 2\ <\ m\_size)\ \{}
\DoxyCodeLine{01084\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ =\ 0;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ <\ 8;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}++)\ \{}
\DoxyCodeLine{01085\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}}(lhs\_vert,\ horiz\_base\ +\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ =\ \mbox{\hyperlink{dense__solvers_8cpp_aca3207197454d3587952bfb490eecbf2}{results}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}].x;}
\DoxyCodeLine{01086\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}}(lhs\_vert\ +\ 1,\ horiz\_base\ +\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ =\ \mbox{\hyperlink{dense__solvers_8cpp_aca3207197454d3587952bfb490eecbf2}{results}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}].y;}
\DoxyCodeLine{01087\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}}(lhs\_vert\ +\ 2,\ horiz\_base\ +\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ =\ \mbox{\hyperlink{dense__solvers_8cpp_aca3207197454d3587952bfb490eecbf2}{results}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}].z;}
\DoxyCodeLine{01088\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01089\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (lhs\_vert\ +\ 1\ <\ m\_size)\ \{}
\DoxyCodeLine{01090\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ =\ 0;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ <\ 8;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}++)\ \{}
\DoxyCodeLine{01091\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}}(lhs\_vert,\ horiz\_base\ +\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ =\ \mbox{\hyperlink{dense__solvers_8cpp_aca3207197454d3587952bfb490eecbf2}{results}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}].x;}
\DoxyCodeLine{01092\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}}(lhs\_vert\ +\ 1,\ horiz\_base\ +\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ =\ \mbox{\hyperlink{dense__solvers_8cpp_aca3207197454d3587952bfb490eecbf2}{results}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}].y;}
\DoxyCodeLine{01093\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01094\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (lhs\_vert\ \ <\ m\_size)\ \{}
\DoxyCodeLine{01095\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ =\ 0;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ <\ 8;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}++)\ \{}
\DoxyCodeLine{01096\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}}(lhs\_vert,\ horiz\_base\ +\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ =\ \mbox{\hyperlink{dense__solvers_8cpp_aca3207197454d3587952bfb490eecbf2}{results}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}].x;}
\DoxyCodeLine{01097\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01098\ \ \ \ \ \}}
\DoxyCodeLine{01099\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (!CHECK\_LHS\_BOUNDARY)\ \{}
\DoxyCodeLine{01100\ \ \ \ \ \textcolor{comment}{//\ CHECK\ BOUNDARY\_B}}
\DoxyCodeLine{01101\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ =\ 0;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ <\ 8;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}++)\ \{}
\DoxyCodeLine{01102\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (horiz\_base\ +\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ <\ n\_size)\ \{}
\DoxyCodeLine{01103\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}}(lhs\_vert,\ horiz\_base\ +\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ =\ \mbox{\hyperlink{dense__solvers_8cpp_aca3207197454d3587952bfb490eecbf2}{results}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}].x;}
\DoxyCodeLine{01104\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}}(lhs\_vert\ +\ 1,\ horiz\_base\ +\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ =\ \mbox{\hyperlink{dense__solvers_8cpp_aca3207197454d3587952bfb490eecbf2}{results}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}].y;}
\DoxyCodeLine{01105\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}}(lhs\_vert\ +\ 2,\ horiz\_base\ +\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ =\ \mbox{\hyperlink{dense__solvers_8cpp_aca3207197454d3587952bfb490eecbf2}{results}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}].z;}
\DoxyCodeLine{01106\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}}(lhs\_vert\ +\ 3,\ horiz\_base\ +\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ =\ \mbox{\hyperlink{dense__solvers_8cpp_aca3207197454d3587952bfb490eecbf2}{results}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}].w;}
\DoxyCodeLine{01107\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01108\ \ \ \ \ \}}
\DoxyCodeLine{01109\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01110\ \ \ \ \ \textcolor{comment}{//\ CHECK\ both\ boundaries.}}
\DoxyCodeLine{01111\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ =\ 0;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ <\ 8;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}++)\ \{}
\DoxyCodeLine{01112\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (horiz\_base\ +\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ <\ n\_size)\ \{}
\DoxyCodeLine{01113\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (lhs\_vert\ <\ m\_size)}
\DoxyCodeLine{01114\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}}(lhs\_vert,\ horiz\_base\ +\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ =\ \mbox{\hyperlink{dense__solvers_8cpp_aca3207197454d3587952bfb490eecbf2}{results}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}].x;}
\DoxyCodeLine{01115\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (lhs\_vert\ +\ 1\ <\ m\_size)}
\DoxyCodeLine{01116\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}}(lhs\_vert\ +\ 1,\ horiz\_base\ +\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ =\ \mbox{\hyperlink{dense__solvers_8cpp_aca3207197454d3587952bfb490eecbf2}{results}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}].y;}
\DoxyCodeLine{01117\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (lhs\_vert\ +\ 2\ <\ m\_size)}
\DoxyCodeLine{01118\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}}(lhs\_vert\ +\ 2,\ horiz\_base\ +\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ =\ \mbox{\hyperlink{dense__solvers_8cpp_aca3207197454d3587952bfb490eecbf2}{results}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}].z;}
\DoxyCodeLine{01119\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (lhs\_vert\ +\ 3\ <\ m\_size)}
\DoxyCodeLine{01120\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}}(lhs\_vert\ +\ 3,\ horiz\_base\ +\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ =\ \mbox{\hyperlink{dense__solvers_8cpp_aca3207197454d3587952bfb490eecbf2}{results}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}].w;}
\DoxyCodeLine{01121\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01122\ \ \ \ \ \}}
\DoxyCodeLine{01123\ \ \ \}}
\DoxyCodeLine{01124\ \}}
\DoxyCodeLine{01125\ }
\DoxyCodeLine{01126\ }
\DoxyCodeLine{01127\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}},\ \textcolor{keyword}{typename}\ LhsMapper,}
\DoxyCodeLine{01128\ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{typename}\ RhsMapper,\ \textcolor{keyword}{typename}\ OutputMapper>}
\DoxyCodeLine{01129\ \_\_global\_\_\ \textcolor{keywordtype}{void}}
\DoxyCodeLine{01130\ \_\_launch\_bounds\_\_(256)}
\DoxyCodeLine{01131\ EigenFloatContractionKernel(const\ LhsMapper\ lhs,\ const\ RhsMapper\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}},}
\DoxyCodeLine{01132\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ OutputMapper\ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}},}
\DoxyCodeLine{01133\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ m\_size,\ const\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ n\_size,\ const\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ k\_size)\ \{}
\DoxyCodeLine{01134\ \ \ \_\_shared\_\_\ \mbox{\hyperlink{sugar_8h_a67916a16039f1634ef3ad6bc1fe2eb2a}{float2}}\ lhs\_shmem[64*32];}
\DoxyCodeLine{01135\ \ \ \_\_shared\_\_\ \mbox{\hyperlink{sugar_8h_a67916a16039f1634ef3ad6bc1fe2eb2a}{float2}}\ rhs\_shmem[128*8];}
\DoxyCodeLine{01136\ }
\DoxyCodeLine{01137\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{sugar_8h_a67916a16039f1634ef3ad6bc1fe2eb2a}{float2}}\ LHS\_MEM[64][32];}
\DoxyCodeLine{01138\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{sugar_8h_a67916a16039f1634ef3ad6bc1fe2eb2a}{float2}}\ RHS\_MEM[128][8];}
\DoxyCodeLine{01139\ }
\DoxyCodeLine{01140\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{sugar_8h_a67916a16039f1634ef3ad6bc1fe2eb2a}{float2}}\ LHS\_MEM16x16[32][16];}
\DoxyCodeLine{01141\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{sugar_8h_a67916a16039f1634ef3ad6bc1fe2eb2a}{float2}}\ RHS\_MEM16x16[64][8];}
\DoxyCodeLine{01142\ }
\DoxyCodeLine{01143\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ m\_block\_idx\ =\ \mbox{\hyperlink{cuda__common_8h_ab30e5f6958c9264d3c5235d463eb2b57}{blockIdx}}.x;}
\DoxyCodeLine{01144\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ n\_block\_idx\ =\ \mbox{\hyperlink{cuda__common_8h_ab30e5f6958c9264d3c5235d463eb2b57}{blockIdx}}.y;}
\DoxyCodeLine{01145\ }
\DoxyCodeLine{01146\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ base\_m\ =\ 128\ *\ m\_block\_idx;}
\DoxyCodeLine{01147\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ base\_n\ =\ 64\ *\ n\_block\_idx;}
\DoxyCodeLine{01148\ }
\DoxyCodeLine{01149\ \ \ \textcolor{keywordtype}{bool}\ check\_rhs\ =\ (base\_n\ +\ 63)\ >=\ n\_size;}
\DoxyCodeLine{01150\ \ \ \textcolor{keywordtype}{bool}\ check\_lhs128\ =\ (base\_m\ +\ 127)\ >=\ m\_size;}
\DoxyCodeLine{01151\ }
\DoxyCodeLine{01152\ \ \ \textcolor{keywordflow}{if}\ (!check\_rhs)\ \{}
\DoxyCodeLine{01153\ \ \ \ \ \textcolor{keywordflow}{if}\ (!check\_lhs128)\ \{}
\DoxyCodeLine{01154\ \ \ \ \ \ \ \textcolor{comment}{//\ >=\ 128\ rows\ left}}
\DoxyCodeLine{01155\ \ \ \ \ \ \ EigenFloatContractionKernelInternal<Index,\ LhsMapper,\ RhsMapper,\ OutputMapper,\ false,\ false>(}
\DoxyCodeLine{01156\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lhs,\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}},\ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}},\ *((LHS\_MEM\ *)\ lhs\_shmem),\ *((RHS\_MEM\ *)\ rhs\_shmem),\ m\_size,\ n\_size,\ k\_size,\ base\_m,\ base\_n);}
\DoxyCodeLine{01157\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01158\ \ \ \ \ \ \ EigenFloatContractionKernelInternal<Index,\ LhsMapper,\ RhsMapper,\ OutputMapper,\ true,\ false>(}
\DoxyCodeLine{01159\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lhs,\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}},\ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}},\ *((LHS\_MEM\ *)\ lhs\_shmem),\ *((RHS\_MEM\ *)\ rhs\_shmem),\ m\_size,\ n\_size,\ k\_size,\ base\_m,\ base\_n);}
\DoxyCodeLine{01160\ \ \ \ \ \}}
\DoxyCodeLine{01161\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01162\ \ \ \ \ \textcolor{keywordflow}{if}\ (!check\_lhs128)\ \{}
\DoxyCodeLine{01163\ \ \ \ \ \ \ \textcolor{comment}{//\ >=\ 128\ rows\ left}}
\DoxyCodeLine{01164\ \ \ \ \ \ \ EigenFloatContractionKernelInternal<Index,\ LhsMapper,\ RhsMapper,\ OutputMapper,\ false,\ true>(}
\DoxyCodeLine{01165\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lhs,\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}},\ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}},\ *((LHS\_MEM\ *)\ lhs\_shmem),\ *((RHS\_MEM\ *)\ rhs\_shmem),\ m\_size,\ n\_size,\ k\_size,\ base\_m,\ base\_n);}
\DoxyCodeLine{01166\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01167\ \ \ \ \ \ \ EigenFloatContractionKernelInternal<Index,\ LhsMapper,\ RhsMapper,\ OutputMapper,\ true,\ true>(}
\DoxyCodeLine{01168\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lhs,\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}},\ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}},\ *((LHS\_MEM\ *)\ lhs\_shmem),\ *((RHS\_MEM\ *)\ rhs\_shmem),\ m\_size,\ n\_size,\ k\_size,\ base\_m,\ base\_n);}
\DoxyCodeLine{01169\ \ \ \ \ \}}
\DoxyCodeLine{01170\ \ \ \}}
\DoxyCodeLine{01171\ \}}
\DoxyCodeLine{01172\ }
\DoxyCodeLine{01173\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}},\ \textcolor{keyword}{typename}\ LhsMapper,}
\DoxyCodeLine{01174\ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{typename}\ RhsMapper,\ \textcolor{keyword}{typename}\ OutputMapper>}
\DoxyCodeLine{01175\ \_\_global\_\_\ \textcolor{keywordtype}{void}}
\DoxyCodeLine{01176\ \_\_launch\_bounds\_\_(256)}
\DoxyCodeLine{01177\ EigenFloatContractionKernel16x16(const\ LhsMapper\ lhs,\ const\ RhsMapper\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}},}
\DoxyCodeLine{01178\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ OutputMapper\ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}},}
\DoxyCodeLine{01179\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ m\_size,\ const\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ n\_size,\ const\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ k\_size)\ \{}
\DoxyCodeLine{01180\ \ \ \_\_shared\_\_\ \mbox{\hyperlink{sugar_8h_a67916a16039f1634ef3ad6bc1fe2eb2a}{float2}}\ lhs\_shmem[32][16];}
\DoxyCodeLine{01181\ \ \ \_\_shared\_\_\ \mbox{\hyperlink{sugar_8h_a67916a16039f1634ef3ad6bc1fe2eb2a}{float2}}\ rhs\_shmem[64][8];}
\DoxyCodeLine{01182\ }
\DoxyCodeLine{01183\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ m\_block\_idx\ =\ \mbox{\hyperlink{cuda__common_8h_ab30e5f6958c9264d3c5235d463eb2b57}{blockIdx}}.x;}
\DoxyCodeLine{01184\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ n\_block\_idx\ =\ \mbox{\hyperlink{cuda__common_8h_ab30e5f6958c9264d3c5235d463eb2b57}{blockIdx}}.y;}
\DoxyCodeLine{01185\ }
\DoxyCodeLine{01186\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ base\_m\ =\ 64\ *\ m\_block\_idx;}
\DoxyCodeLine{01187\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ base\_n\ =\ 64\ *\ n\_block\_idx;}
\DoxyCodeLine{01188\ }
\DoxyCodeLine{01189\ \ \ \textcolor{keywordflow}{if}\ (base\_m\ +\ 63\ <\ m\_size)\ \{}
\DoxyCodeLine{01190\ \ \ \ \ \textcolor{keywordflow}{if}\ (base\_n\ +\ 63\ <\ n\_size)\ \{}
\DoxyCodeLine{01191\ \ \ \ \ \ \ EigenFloatContractionKernelInternal16x16<Index,\ LhsMapper,\ RhsMapper,\ OutputMapper,\ false,\ false>(lhs,\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}},\ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}},\ lhs\_shmem,\ rhs\_shmem,\ m\_size,\ n\_size,\ k\_size,\ base\_m,\ base\_n);}
\DoxyCodeLine{01192\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01193\ \ \ \ \ \ \ EigenFloatContractionKernelInternal16x16<Index,\ LhsMapper,\ RhsMapper,\ OutputMapper,\ false,\ true>(lhs,\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}},\ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}},\ lhs\_shmem,\ rhs\_shmem,\ m\_size,\ n\_size,\ k\_size,\ base\_m,\ base\_n);}
\DoxyCodeLine{01194\ \ \ \ \ \}}
\DoxyCodeLine{01195\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01196\ \ \ \ \ \textcolor{keywordflow}{if}\ (base\_n\ +\ 63\ <\ n\_size)\ \{}
\DoxyCodeLine{01197\ \ \ \ \ \ \ EigenFloatContractionKernelInternal16x16<Index,\ LhsMapper,\ RhsMapper,\ OutputMapper,\ true,\ false>(lhs,\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}},\ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}},\ lhs\_shmem,\ rhs\_shmem,\ m\_size,\ n\_size,\ k\_size,\ base\_m,\ base\_n);}
\DoxyCodeLine{01198\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01199\ \ \ \ \ \ \ EigenFloatContractionKernelInternal16x16<Index,\ LhsMapper,\ RhsMapper,\ OutputMapper,\ true,\ true>(lhs,\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}},\ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}},\ lhs\_shmem,\ rhs\_shmem,\ m\_size,\ n\_size,\ k\_size,\ base\_m,\ base\_n);}
\DoxyCodeLine{01200\ \ \ \ \ \}}
\DoxyCodeLine{01201\ \ \ \}}
\DoxyCodeLine{01202\ \}}
\DoxyCodeLine{01203\ }
\DoxyCodeLine{01204\ }
\DoxyCodeLine{01205\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ Indices,\ \textcolor{keyword}{typename}\ LeftArgType,\ \textcolor{keyword}{typename}\ RightArgType>}
\DoxyCodeLine{01206\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_eigen_1_1_tensor_evaluator}{TensorEvaluator}}<const\ \mbox{\hyperlink{class_eigen_1_1_tensor_contraction_op}{TensorContractionOp}}<Indices,\ LeftArgType,\ RightArgType>,\ GpuDevice>\ :}
\DoxyCodeLine{01207\ \ \ \ \ \textcolor{keyword}{public}\ \mbox{\hyperlink{struct_eigen_1_1_tensor_contraction_evaluator_base}{TensorContractionEvaluatorBase}}<TensorEvaluator<const\ TensorContractionOp<Indices,\ LeftArgType,\ RightArgType>,\ GpuDevice>\ >\ \{}
\DoxyCodeLine{01208\ }
\DoxyCodeLine{01209\ \ \ \textcolor{keyword}{typedef}\ GpuDevice\ Device;}
\DoxyCodeLine{01210\ }
\DoxyCodeLine{01211\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{struct_eigen_1_1_tensor_evaluator_a43bea98dc719e3b6ac73ab2df0291455}{TensorEvaluator<const\ TensorContractionOp<Indices,\ LeftArgType,\ RightArgType>}},\ Device>\ Self;}
\DoxyCodeLine{01212\ \ \ \textcolor{keyword}{typedef}\ TensorContractionEvaluatorBase<Self>\ Base;}
\DoxyCodeLine{01213\ }
\DoxyCodeLine{01214\ \ \ \textcolor{keyword}{typedef}\ TensorContractionOp<Indices,\ LeftArgType,\ RightArgType>\ XprType;}
\DoxyCodeLine{01215\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1remove__const_afe3dbb0bdee2ec8eed4416723d75bc90}{internal::remove\_const<typename\ XprType::Scalar>::type}}\ \mbox{\hyperlink{struct_eigen_1_1_tensor_evaluator_a163cadb184cc08462355caf1031115a4}{Scalar}};}
\DoxyCodeLine{01216\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ XprType::Index\ \mbox{\hyperlink{struct_eigen_1_1_tensor_evaluator_a932b320bc0d4f0c027d28f6f9918bbc6}{Index}};}
\DoxyCodeLine{01217\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ XprType::CoeffReturnType\ \mbox{\hyperlink{struct_eigen_1_1_tensor_evaluator_a664eb29b0c38061939b400fbc551c580}{CoeffReturnType}};}
\DoxyCodeLine{01218\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{struct_eigen_1_1_packet_type_a3408a66e0894db9cb51e39dbf4fe9f0f}{PacketType<CoeffReturnType,\ GpuDevice>::type}}\ \mbox{\hyperlink{struct_eigen_1_1_tensor_evaluator_a5ffb21f50e4fbd0d4d9cef40e148cc5e}{PacketReturnType}};}
\DoxyCodeLine{01219\ }
\DoxyCodeLine{01220\ \ \ \textcolor{keyword}{enum}\ \{}
\DoxyCodeLine{01221\ \ \ \ \ \mbox{\hyperlink{struct_eigen_1_1_tensor_evaluator_a505fb36fcf4b16dcedf95e9d8e4d4ac2aaea01fe7598d6c1941853b693ec9f162}{Layout}}\ =\ \mbox{\hyperlink{struct_eigen_1_1_tensor_evaluator_a43bea98dc719e3b6ac73ab2df0291455}{TensorEvaluator<LeftArgType,\ Device>::Layout}},}
\DoxyCodeLine{01222\ \ \ \};}
\DoxyCodeLine{01223\ }
\DoxyCodeLine{01224\ \ \ \textcolor{comment}{//\ Most\ of\ the\ code\ is\ assuming\ that\ both\ input\ tensors\ are\ ColMajor.\ If\ the}}
\DoxyCodeLine{01225\ \ \ \textcolor{comment}{//\ inputs\ are\ RowMajor,\ we\ will\ "{}cheat"{}\ by\ swapping\ the\ LHS\ and\ RHS:}}
\DoxyCodeLine{01226\ \ \ \textcolor{comment}{//\ If\ we\ want\ to\ compute\ A\ *\ B\ =\ C,\ where\ A\ is\ LHS\ and\ B\ is\ RHS,\ the\ code}}
\DoxyCodeLine{01227\ \ \ \textcolor{comment}{//\ will\ pretend\ B\ is\ LHS\ and\ A\ is\ RHS.}}
\DoxyCodeLine{01228\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ internal::conditional<}
\DoxyCodeLine{01229\ \ \ \ \ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(\mbox{\hyperlink{struct_eigen_1_1_tensor_evaluator_a505fb36fcf4b16dcedf95e9d8e4d4ac2aaea01fe7598d6c1941853b693ec9f162}{Layout}})\ ==\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(\mbox{\hyperlink{group__enums_ggaacded1a18ae58b0f554751f6cdf9eb13a0103672ae41005ab03b4176c765afd62}{ColMajor}}),\ LeftArgType,\ RightArgType>\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ae8396ff85d63082521e3324820df1009}{::type}}\ EvalLeftArgType;}
\DoxyCodeLine{01230\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ internal::conditional<}
\DoxyCodeLine{01231\ \ \ \ \ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(\mbox{\hyperlink{struct_eigen_1_1_tensor_evaluator_a505fb36fcf4b16dcedf95e9d8e4d4ac2aaea01fe7598d6c1941853b693ec9f162}{Layout}})\ ==\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(\mbox{\hyperlink{group__enums_ggaacded1a18ae58b0f554751f6cdf9eb13a0103672ae41005ab03b4176c765afd62}{ColMajor}}),\ RightArgType,\ LeftArgType>\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ae8396ff85d63082521e3324820df1009}{::type}}\ EvalRightArgType;}
\DoxyCodeLine{01232\ }
\DoxyCodeLine{01233\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ LDims\ =}
\DoxyCodeLine{01234\ \ \ \ \ \ \ internal::array\_size<typename\ TensorEvaluator<EvalLeftArgType,\ Device>::Dimensions>\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_abe8e049f756b5ba547bda825af81b645}{::value}};}
\DoxyCodeLine{01235\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ RDims\ =}
\DoxyCodeLine{01236\ \ \ \ \ \ \ internal::array\_size<typename\ TensorEvaluator<EvalRightArgType,\ Device>::Dimensions>\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_abe8e049f756b5ba547bda825af81b645}{::value}};}
\DoxyCodeLine{01237\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ ContractDims\ =\ internal::array\_size<Indices>::value;}
\DoxyCodeLine{01238\ }
\DoxyCodeLine{01239\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{sugar_8h_af6228a2253f88b2affbe0c54d8b5b321}{array<Index,\ LDims>}}\ left\_dim\_mapper\_t;}
\DoxyCodeLine{01240\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{sugar_8h_af6228a2253f88b2affbe0c54d8b5b321}{array<Index,\ RDims>}}\ right\_dim\_mapper\_t;}
\DoxyCodeLine{01241\ }
\DoxyCodeLine{01242\ \ \ \textcolor{keyword}{typedef}\ array<Index,\ ContractDims>\ contract\_t;}
\DoxyCodeLine{01243\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{sugar_8h_af6228a2253f88b2affbe0c54d8b5b321}{array}}<\mbox{\hyperlink{struct_eigen_1_1_tensor_evaluator_a932b320bc0d4f0c027d28f6f9918bbc6}{Index}},\ LDims\ -\/\ ContractDims>\ left\_nocontract\_t;}
\DoxyCodeLine{01244\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{sugar_8h_af6228a2253f88b2affbe0c54d8b5b321}{array}}<\mbox{\hyperlink{struct_eigen_1_1_tensor_evaluator_a932b320bc0d4f0c027d28f6f9918bbc6}{Index}},\ RDims\ -\/\ ContractDims>\ right\_nocontract\_t;}
\DoxyCodeLine{01245\ }
\DoxyCodeLine{01246\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ NumDims\ =\ LDims\ +\ RDims\ -\/\ 2\ *\ ContractDims;}
\DoxyCodeLine{01247\ }
\DoxyCodeLine{01248\ \ \ \textcolor{keyword}{typedef}\ DSizes<Index,\ NumDims>\ \mbox{\hyperlink{struct_eigen_1_1_tensor_evaluator_ac4139a59583bb1e6385d3a0195548b6b}{Dimensions}};}
\DoxyCodeLine{01249\ }
\DoxyCodeLine{01250\ \ \ \textcolor{comment}{//\ typedefs\ needed\ in\ evalTo}}
\DoxyCodeLine{01251\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1remove__const_afe3dbb0bdee2ec8eed4416723d75bc90}{internal::remove\_const<typename\ EvalLeftArgType::Scalar>::type}}\ LhsScalar;}
\DoxyCodeLine{01252\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1remove__const_afe3dbb0bdee2ec8eed4416723d75bc90}{internal::remove\_const<typename\ EvalRightArgType::Scalar>::type}}\ RhsScalar;}
\DoxyCodeLine{01253\ }
\DoxyCodeLine{01254\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{struct_eigen_1_1_tensor_evaluator_a43bea98dc719e3b6ac73ab2df0291455}{TensorEvaluator<EvalLeftArgType,\ Device>}}\ LeftEvaluator;}
\DoxyCodeLine{01255\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{struct_eigen_1_1_tensor_evaluator_a43bea98dc719e3b6ac73ab2df0291455}{TensorEvaluator<EvalRightArgType,\ Device>}}\ RightEvaluator;}
\DoxyCodeLine{01256\ }
\DoxyCodeLine{01257\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ LeftEvaluator::Dimensions\ LeftDimensions;}
\DoxyCodeLine{01258\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ RightEvaluator::Dimensions\ RightDimensions;}
\DoxyCodeLine{01259\ }
\DoxyCodeLine{01260\ \ \ EIGEN\_DEVICE\_FUNC\ \mbox{\hyperlink{struct_eigen_1_1_tensor_evaluator_a43bea98dc719e3b6ac73ab2df0291455}{TensorEvaluator}}(\textcolor{keyword}{const}\ XprType\&\ op,\ \textcolor{keyword}{const}\ Device\&\ \mbox{\hyperlink{struct_eigen_1_1_tensor_evaluator_aa1eb26b743a6cafedceb567036276d4e}{device}})\ :}
\DoxyCodeLine{01261\ \ \ \ \ \ \ Base(op,\ \mbox{\hyperlink{struct_eigen_1_1_tensor_evaluator_aa1eb26b743a6cafedceb567036276d4e}{device}})\ \{\}}
\DoxyCodeLine{01262\ }
\DoxyCodeLine{01263\ \ \ \textcolor{comment}{//\ We\ need\ to\ redefine\ this\ method\ to\ make\ nvcc\ happy}}
\DoxyCodeLine{01264\ \ \ EIGEN\_DEVICE\_FUNC\ \mbox{\hyperlink{eigen-3_83_87_2_eigen_2src_2_core_2util_2_macros_8h_af2b60117c00a6e75812de43bfe7db3b1}{EIGEN\_STRONG\_INLINE}}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{struct_eigen_1_1_tensor_evaluator_ae188d806978166eb8cbffbd63c944fb3}{evalSubExprsIfNeeded}}(\mbox{\hyperlink{struct_eigen_1_1_tensor_evaluator_a163cadb184cc08462355caf1031115a4}{Scalar}}*\ \mbox{\hyperlink{struct_eigen_1_1_tensor_evaluator_ae301776353d1f3fa8f687107301bd486}{data}})\ \{}
\DoxyCodeLine{01265\ \ \ \ \ this-\/>m\_leftImpl.evalSubExprsIfNeeded(\mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}});}
\DoxyCodeLine{01266\ \ \ \ \ this-\/>m\_rightImpl.evalSubExprsIfNeeded(\mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}});}
\DoxyCodeLine{01267\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{struct_eigen_1_1_tensor_evaluator_ae301776353d1f3fa8f687107301bd486}{data}})\ \{}
\DoxyCodeLine{01268\ \ \ \ \ \ \ evalTo(\mbox{\hyperlink{struct_eigen_1_1_tensor_evaluator_ae301776353d1f3fa8f687107301bd486}{data}});}
\DoxyCodeLine{01269\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01270\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01271\ \ \ \ \ \ \ this-\/>m\_result\ =\ \textcolor{keyword}{static\_cast<}\mbox{\hyperlink{struct_eigen_1_1_tensor_evaluator_a163cadb184cc08462355caf1031115a4}{Scalar}}\ *\textcolor{keyword}{>}(this-\/>\mbox{\hyperlink{struct_eigen_1_1_tensor_evaluator_a13eb5009d2c2e60155de55e7c3d2bd6f}{m\_device}}.allocate(this-\/>\mbox{\hyperlink{struct_eigen_1_1_tensor_evaluator_a4b49b2c40bcb2220fb240083cd1833c6}{dimensions}}().TotalSize()\ *\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{struct_eigen_1_1_tensor_evaluator_a163cadb184cc08462355caf1031115a4}{Scalar}})));}
\DoxyCodeLine{01272\ \ \ \ \ \ \ evalTo(this-\/>m\_result);}
\DoxyCodeLine{01273\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{01274\ \ \ \ \ \}}
\DoxyCodeLine{01275\ \ \ \}}
\DoxyCodeLine{01276\ }
\DoxyCodeLine{01277\ \ \ \textcolor{keywordtype}{void}\ evalTo(\mbox{\hyperlink{struct_eigen_1_1_tensor_evaluator_a163cadb184cc08462355caf1031115a4}{Scalar}}*\ \mbox{\hyperlink{sugar_8h_aaadc06b5dac8070de2c8677210967bdb}{buffer}})\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01278\ \ \ \ \ \textcolor{keywordflow}{if}\ (this-\/>m\_lhs\_inner\_dim\_contiguous)\ \{}
\DoxyCodeLine{01279\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (this-\/>m\_rhs\_inner\_dim\_contiguous)\ \{}
\DoxyCodeLine{01280\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (this-\/>m\_rhs\_inner\_dim\_reordered)\ \{}
\DoxyCodeLine{01281\ \ \ \ \ \ \ \ \ \ \ evalTyped<true,\ true,\ true,\ Unaligned>(\mbox{\hyperlink{sugar_8h_aaadc06b5dac8070de2c8677210967bdb}{buffer}});}
\DoxyCodeLine{01282\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01283\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01284\ \ \ \ \ \ \ \ \ \ \ evalTyped<true,\ true,\ false,\ Unaligned>(\mbox{\hyperlink{sugar_8h_aaadc06b5dac8070de2c8677210967bdb}{buffer}});}
\DoxyCodeLine{01285\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01286\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01287\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01288\ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (this-\/>m\_rhs\_inner\_dim\_reordered)\ \{}
\DoxyCodeLine{01289\ \ \ \ \ \ \ \ \ \ \ evalTyped<true,\ false,\ true,\ Unaligned>(\mbox{\hyperlink{sugar_8h_aaadc06b5dac8070de2c8677210967bdb}{buffer}});}
\DoxyCodeLine{01290\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01291\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01292\ \ \ \ \ \ \ \ \ \ \ evalTyped<true,\ false,\ false,\ Unaligned>(\mbox{\hyperlink{sugar_8h_aaadc06b5dac8070de2c8677210967bdb}{buffer}});}
\DoxyCodeLine{01293\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01294\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01295\ \ \ \ \ \}}
\DoxyCodeLine{01296\ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01297\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (this-\/>m\_rhs\_inner\_dim\_contiguous)\ \{}
\DoxyCodeLine{01298\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (this-\/>m\_rhs\_inner\_dim\_reordered)\ \{}
\DoxyCodeLine{01299\ \ \ \ \ \ \ \ \ \ \ evalTyped<false,\ true,\ true,\ Unaligned>(\mbox{\hyperlink{sugar_8h_aaadc06b5dac8070de2c8677210967bdb}{buffer}});}
\DoxyCodeLine{01300\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01301\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01302\ \ \ \ \ \ \ \ \ \ \ evalTyped<false,\ true,\ false,\ Unaligned>(\mbox{\hyperlink{sugar_8h_aaadc06b5dac8070de2c8677210967bdb}{buffer}});}
\DoxyCodeLine{01303\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01304\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01305\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01306\ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (this-\/>m\_rhs\_inner\_dim\_reordered)\ \{}
\DoxyCodeLine{01307\ \ \ \ \ \ \ \ \ \ \ evalTyped<false,\ false,\ true,\ Unaligned>(\mbox{\hyperlink{sugar_8h_aaadc06b5dac8070de2c8677210967bdb}{buffer}});}
\DoxyCodeLine{01308\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01309\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01310\ \ \ \ \ \ \ \ \ \ \ evalTyped<false,\ false,\ false,\ Unaligned>(\mbox{\hyperlink{sugar_8h_aaadc06b5dac8070de2c8677210967bdb}{buffer}});}
\DoxyCodeLine{01311\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01312\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01313\ \ \ \ \ \}}
\DoxyCodeLine{01314\ \ \ \}}
\DoxyCodeLine{01315\ }
\DoxyCodeLine{01316\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ LhsScalar,\ \textcolor{keyword}{typename}\ RhsScalar,\ \textcolor{keyword}{typename}\ Index,\ \textcolor{keyword}{typename}\ LhsMapper,\ \textcolor{keyword}{typename}\ RhsMapper,\ \textcolor{keyword}{typename}\ OutputMapper>\ \textcolor{keyword}{struct\ }LaunchKernels\ \{}
\DoxyCodeLine{01317\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{external_2taskflow_23rd-party_2tbb_2examples_2task_2tree__sum_2main_8cpp_a237265286225f0813411af96f6f79493}{Run}}(\textcolor{keyword}{const}\ LhsMapper\&\ lhs,\ \textcolor{keyword}{const}\ RhsMapper\&\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}},\ \textcolor{keyword}{const}\ OutputMapper\&\ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}},\ Index\ \mbox{\hyperlink{_angle_axis__mimic__euler_8cpp_ab3cd915d758008bd19d0f2428fbb354a}{m}},\ Index\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}},\ Index\ k,\ \textcolor{keyword}{const}\ GpuDevice\&\ device)\ \{}
\DoxyCodeLine{01318\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ m\_blocks\ =\ (\mbox{\hyperlink{_angle_axis__mimic__euler_8cpp_ab3cd915d758008bd19d0f2428fbb354a}{m}}\ +\ 63)\ /\ 64;}
\DoxyCodeLine{01319\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ n\_blocks\ =\ (\mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}\ +\ 63)\ /\ 64;}
\DoxyCodeLine{01320\ \ \ \ \ \textcolor{keyword}{const}\ dim3\ num\_blocks(m\_blocks,\ n\_blocks,\ 1);}
\DoxyCodeLine{01321\ \ \ \ \ \textcolor{keyword}{const}\ dim3\ \mbox{\hyperlink{sugar_8h_a9766f5ceca5e25981858ec7384456072}{block\_size}}(8,\ 8,\ 8);}
\DoxyCodeLine{01322\ \ \ \ \ LAUNCH\_CUDA\_KERNEL((EigenContractionKernel<Scalar,\ Index,\ LhsMapper,\ RhsMapper,\ OutputMapper>),\ num\_blocks,\ \mbox{\hyperlink{sugar_8h_a9766f5ceca5e25981858ec7384456072}{block\_size}},\ 0,\ device,\ lhs,\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}},\ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}},\ \mbox{\hyperlink{_angle_axis__mimic__euler_8cpp_ab3cd915d758008bd19d0f2428fbb354a}{m}},\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}},\ k);}
\DoxyCodeLine{01323\ \ \ \ \ \}}
\DoxyCodeLine{01324\ \ \ \};}
\DoxyCodeLine{01325\ }
\DoxyCodeLine{01326\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Index,\ \textcolor{keyword}{typename}\ LhsMapper,\ \textcolor{keyword}{typename}\ RhsMapper,\ \textcolor{keyword}{typename}\ OutputMapper>\ \textcolor{keyword}{struct\ }LaunchKernels<\mbox{\hyperlink{sugar_8h_a0d954e435550ebcb2035013bfea2db85}{float}},\ \mbox{\hyperlink{sugar_8h_a0d954e435550ebcb2035013bfea2db85}{float}},\ \mbox{\hyperlink{struct_eigen_1_1_tensor_evaluator_a932b320bc0d4f0c027d28f6f9918bbc6}{Index}},\ LhsMapper,\ RhsMapper,\ OutputMapper>\ \{}
\DoxyCodeLine{01327\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{external_2taskflow_23rd-party_2tbb_2examples_2task_2tree__sum_2main_8cpp_a237265286225f0813411af96f6f79493}{Run}}(\textcolor{keyword}{const}\ LhsMapper\&\ lhs,\ \textcolor{keyword}{const}\ RhsMapper\&\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}},\ \textcolor{keyword}{const}\ OutputMapper\&\ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}},\ Index\ \mbox{\hyperlink{_angle_axis__mimic__euler_8cpp_ab3cd915d758008bd19d0f2428fbb354a}{m}},\ Index\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}},\ Index\ k,\ \textcolor{keyword}{const}\ GpuDevice\&\ device)\ \{}
\DoxyCodeLine{01328\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{_angle_axis__mimic__euler_8cpp_ab3cd915d758008bd19d0f2428fbb354a}{m}}\ <\ 768\ ||\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}\ <\ 768)\ \{}
\DoxyCodeLine{01329\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ m\_blocks\ =\ (\mbox{\hyperlink{_angle_axis__mimic__euler_8cpp_ab3cd915d758008bd19d0f2428fbb354a}{m}}\ +\ 63)\ /\ 64;}
\DoxyCodeLine{01330\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ n\_blocks\ =\ (\mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}\ +\ 63)\ /\ 64;}
\DoxyCodeLine{01331\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ dim3\ num\_blocks(m\_blocks,\ n\_blocks,\ 1);}
\DoxyCodeLine{01332\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ dim3\ \mbox{\hyperlink{sugar_8h_a9766f5ceca5e25981858ec7384456072}{block\_size}}(16,\ 16,\ 1);}
\DoxyCodeLine{01333\ \ \ \ \ \ \ \ \ LAUNCH\_CUDA\_KERNEL((EigenFloatContractionKernel16x16<Index,\ LhsMapper,\ RhsMapper,\ OutputMapper>),\ num\_blocks,\ \mbox{\hyperlink{sugar_8h_a9766f5ceca5e25981858ec7384456072}{block\_size}},\ 0,\ device,\ lhs,\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}},\ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}},\ \mbox{\hyperlink{_angle_axis__mimic__euler_8cpp_ab3cd915d758008bd19d0f2428fbb354a}{m}},\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}},\ k);}
\DoxyCodeLine{01334\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01335\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ m\_blocks\ =\ (\mbox{\hyperlink{_angle_axis__mimic__euler_8cpp_ab3cd915d758008bd19d0f2428fbb354a}{m}}\ +\ 127)\ /\ 128;}
\DoxyCodeLine{01336\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ n\_blocks\ =\ (\mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}\ +\ 63)\ /\ 64;}
\DoxyCodeLine{01337\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ dim3\ num\_blocks(m\_blocks,\ n\_blocks,\ 1);}
\DoxyCodeLine{01338\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ dim3\ \mbox{\hyperlink{sugar_8h_a9766f5ceca5e25981858ec7384456072}{block\_size}}(8,\ 32,\ 1);}
\DoxyCodeLine{01339\ \ \ \ \ \ \ \ \ LAUNCH\_CUDA\_KERNEL((EigenFloatContractionKernel<Index,\ LhsMapper,\ RhsMapper,\ OutputMapper>),\ num\_blocks,\ \mbox{\hyperlink{sugar_8h_a9766f5ceca5e25981858ec7384456072}{block\_size}},\ 0,\ device,\ lhs,\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}},\ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}},\ \mbox{\hyperlink{_angle_axis__mimic__euler_8cpp_ab3cd915d758008bd19d0f2428fbb354a}{m}},\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}},\ k);}
\DoxyCodeLine{01340\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01341\ \ \ \ \ \}}
\DoxyCodeLine{01342\ \ \ \};}
\DoxyCodeLine{01343\ }
\DoxyCodeLine{01344\ \ \ \textcolor{keyword}{template}\ <\textcolor{keywordtype}{bool}\ lhs\_inner\_dim\_contiguous,\ \textcolor{keywordtype}{bool}\ rhs\_inner\_dim\_contiguous,\ \textcolor{keywordtype}{bool}\ rhs\_inner\_dim\_reordered,\ \textcolor{keywordtype}{int}\ Alignment>}
\DoxyCodeLine{01345\ \ \ \textcolor{keywordtype}{void}\ evalTyped(\mbox{\hyperlink{struct_eigen_1_1_tensor_evaluator_a163cadb184cc08462355caf1031115a4}{Scalar}}*\ \mbox{\hyperlink{sugar_8h_aaadc06b5dac8070de2c8677210967bdb}{buffer}})\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01346\ \ \ \ \ \textcolor{comment}{//\ columns\ in\ left\ side,\ rows\ in\ right\ side}}
\DoxyCodeLine{01347\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_eigen_1_1_tensor_evaluator_a932b320bc0d4f0c027d28f6f9918bbc6}{Index}}\ k\ =\ this-\/>m\_k\_size;}
\DoxyCodeLine{01348\ \ \ \ \ \mbox{\hyperlink{eigen-3_83_87_2_eigen_2src_2_core_2util_2_macros_8h_a7cf6d5b460def34dc4e6acf42889b6a9}{EIGEN\_UNUSED\_VARIABLE}}(k)}
\DoxyCodeLine{01349\ }
\DoxyCodeLine{01350\ \ \ \ \ \textcolor{comment}{//\ rows\ in\ left\ side}}
\DoxyCodeLine{01351\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_eigen_1_1_tensor_evaluator_a932b320bc0d4f0c027d28f6f9918bbc6}{Index}}\ \mbox{\hyperlink{_angle_axis__mimic__euler_8cpp_ab3cd915d758008bd19d0f2428fbb354a}{m}}\ =\ this-\/>m\_i\_size;}
\DoxyCodeLine{01352\ }
\DoxyCodeLine{01353\ \ \ \ \ \textcolor{comment}{//\ columns\ in\ right\ side}}
\DoxyCodeLine{01354\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_eigen_1_1_tensor_evaluator_a932b320bc0d4f0c027d28f6f9918bbc6}{Index}}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}\ =\ this-\/>m\_j\_size;}
\DoxyCodeLine{01355\ }
\DoxyCodeLine{01356\ \ \ \ \ \textcolor{comment}{//\ zero\ out\ the\ result\ buffer\ (which\ must\ be\ of\ size\ at\ least\ m\ *\ n\ *\ sizeof(Scalar)}}
\DoxyCodeLine{01357\ \ \ \ \ this-\/>\mbox{\hyperlink{struct_eigen_1_1_tensor_evaluator_a13eb5009d2c2e60155de55e7c3d2bd6f}{m\_device}}.memset(\mbox{\hyperlink{sugar_8h_aaadc06b5dac8070de2c8677210967bdb}{buffer}},\ 0,\ \mbox{\hyperlink{_angle_axis__mimic__euler_8cpp_ab3cd915d758008bd19d0f2428fbb354a}{m}}\ *\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}\ *\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{struct_eigen_1_1_tensor_evaluator_a163cadb184cc08462355caf1031115a4}{Scalar}}));}
\DoxyCodeLine{01358\ }
\DoxyCodeLine{01359\ \ \ \ \ \textcolor{keyword}{typedef}\ internal::TensorContractionInputMapper<LhsScalar,\ \mbox{\hyperlink{struct_eigen_1_1_tensor_evaluator_a932b320bc0d4f0c027d28f6f9918bbc6}{Index}},\ \mbox{\hyperlink{namespace_eigen_1_1internal_a091d923f61a5d455b1573e17b015adf9a1a7f4ccbeaf23168b50a83680f8f35fb}{internal::Lhs}},}
\DoxyCodeLine{01360\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ LeftEvaluator,\ left\_nocontract\_t,}
\DoxyCodeLine{01361\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ contract\_t,\ 4,}
\DoxyCodeLine{01362\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lhs\_inner\_dim\_contiguous,}
\DoxyCodeLine{01363\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{false},\ \mbox{\hyperlink{group__enums_gga45fe06e29902b7a2773de05ba27b47a1a4e19dd09d5ff42295ba1d72d12a46686}{Unaligned}}>\ LhsMapper;}
\DoxyCodeLine{01364\ }
\DoxyCodeLine{01365\ \ \ \ \ \textcolor{keyword}{typedef}\ internal::TensorContractionInputMapper<RhsScalar,\ \mbox{\hyperlink{struct_eigen_1_1_tensor_evaluator_a932b320bc0d4f0c027d28f6f9918bbc6}{Index}},\ \mbox{\hyperlink{namespace_eigen_1_1internal_a091d923f61a5d455b1573e17b015adf9a6c8de80f9984c6a6da22b7c288fee57d}{internal::Rhs}},}
\DoxyCodeLine{01366\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ RightEvaluator,\ right\_nocontract\_t,}
\DoxyCodeLine{01367\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ contract\_t,\ 4,}
\DoxyCodeLine{01368\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ rhs\_inner\_dim\_contiguous,}
\DoxyCodeLine{01369\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ rhs\_inner\_dim\_reordered,\ \mbox{\hyperlink{group__enums_gga45fe06e29902b7a2773de05ba27b47a1a4e19dd09d5ff42295ba1d72d12a46686}{Unaligned}}>\ RhsMapper;}
\DoxyCodeLine{01370\ }
\DoxyCodeLine{01371\ \ \ \ \ \textcolor{keyword}{typedef}\ internal::blas\_data\_mapper<Scalar,\ Index,\ ColMajor>\ OutputMapper;}
\DoxyCodeLine{01372\ }
\DoxyCodeLine{01373\ }
\DoxyCodeLine{01374\ \ \ \ \ \textcolor{comment}{//\ initialize\ data\ mappers}}
\DoxyCodeLine{01375\ \ \ \ \ LhsMapper\ lhs(this-\/>m\_leftImpl,\ this-\/>m\_left\_nocontract\_strides,\ this-\/>m\_i\_strides,}
\DoxyCodeLine{01376\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>m\_left\_contracting\_strides,\ this-\/>m\_k\_strides);}
\DoxyCodeLine{01377\ }
\DoxyCodeLine{01378\ \ \ \ \ RhsMapper\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}(this-\/>m\_rightImpl,\ this-\/>m\_right\_nocontract\_strides,\ this-\/>m\_j\_strides,}
\DoxyCodeLine{01379\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>m\_right\_contracting\_strides,\ this-\/>m\_k\_strides);}
\DoxyCodeLine{01380\ }
\DoxyCodeLine{01381\ \ \ \ \ OutputMapper\ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}}(\mbox{\hyperlink{sugar_8h_aaadc06b5dac8070de2c8677210967bdb}{buffer}},\ \mbox{\hyperlink{_angle_axis__mimic__euler_8cpp_ab3cd915d758008bd19d0f2428fbb354a}{m}});}
\DoxyCodeLine{01382\ }
\DoxyCodeLine{01383\ \ \ \ \ setCudaSharedMemConfig(cudaSharedMemBankSizeEightByte);}
\DoxyCodeLine{01384\ \ \ \ \ LaunchKernels<LhsScalar,\ RhsScalar,\ Index,\ LhsMapper,\ RhsMapper,\ OutputMapper>::Run(lhs,\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}},\ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}},\ \ \mbox{\hyperlink{_angle_axis__mimic__euler_8cpp_ab3cd915d758008bd19d0f2428fbb354a}{m}},\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}},\ k,\ this-\/>\mbox{\hyperlink{struct_eigen_1_1_tensor_evaluator_a13eb5009d2c2e60155de55e7c3d2bd6f}{m\_device}});}
\DoxyCodeLine{01385\ \ \ \}}
\DoxyCodeLine{01386\ \};}
\DoxyCodeLine{01387\ }
\DoxyCodeLine{01388\ \}\ \textcolor{comment}{//\ end\ namespace\ Eigen}}
\DoxyCodeLine{01389\ }
\DoxyCodeLine{01390\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ EIGEN\_USE\_GPU\ and\ \_\_CUDACC\_\_}}
\DoxyCodeLine{01391\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ EIGEN\_CXX11\_TENSOR\_TENSOR\_CONTRACTION\_CUDA\_H}}

\end{DoxyCode}
