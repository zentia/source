\doxysection{data\+\_\+pipeline.\+hpp}
\hypertarget{taskflow_2algorithm_2data__pipeline_8hpp_source}{}\label{taskflow_2algorithm_2data__pipeline_8hpp_source}\index{external/taskflow/taskflow/algorithm/data\_pipeline.hpp@{external/taskflow/taskflow/algorithm/data\_pipeline.hpp}}
\mbox{\hyperlink{taskflow_2algorithm_2data__pipeline_8hpp}{浏览该文件的文档.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00002\ }
\DoxyCodeLine{00003\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{taskflow_2algorithm_2pipeline_8hpp}{pipeline.hpp}}"{}}}
\DoxyCodeLine{00004\ }
\DoxyCodeLine{00005\ }
\DoxyCodeLine{00006\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespacetf}{tf}}\ \{}
\DoxyCodeLine{00007\ }
\DoxyCodeLine{00008\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00009\ \textcolor{comment}{//\ Class\ Definition:\ DataPipe}}
\DoxyCodeLine{00010\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00011\ }
\DoxyCodeLine{00051\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Input,\ \textcolor{keyword}{typename}\ Output,\ \textcolor{keyword}{typename}\ C>}
\DoxyCodeLine{00052\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classtf_1_1_data_pipe_a8b7e8194874901eacfb5d3d2b72a2b85}{DataPipe}}\ \{}
\DoxyCodeLine{00053\ }
\DoxyCodeLine{00054\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}...\ Ps>}
\DoxyCodeLine{00055\ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classtf_1_1_data_pipe_a576c05629fadf8120eb4db27cf28e659}{DataPipeline}};}
\DoxyCodeLine{00056\ }
\DoxyCodeLine{00057\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00058\ }
\DoxyCodeLine{00062\ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{classtf_1_1_data_pipe_a5cc3b76f16379f4cb2ecdef66dee1ba3}{callable\_t}}\ =\ \mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}};}
\DoxyCodeLine{00063\ }
\DoxyCodeLine{00067\ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{classtf_1_1_data_pipe_ae5e9dd100a02edb2d560e8a1d516037d}{input\_t}}\ =\ Input;}
\DoxyCodeLine{00068\ }
\DoxyCodeLine{00072\ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{classtf_1_1_data_pipe_a8a99a980f0fa6bc55203cb33f526f007}{output\_t}}\ =\ Output;}
\DoxyCodeLine{00073\ }
\DoxyCodeLine{00077\ \ \ \mbox{\hyperlink{classtf_1_1_data_pipe_a8b7e8194874901eacfb5d3d2b72a2b85}{DataPipe}}()\ =\ \textcolor{keywordflow}{default};}
\DoxyCodeLine{00078\ }
\DoxyCodeLine{00086\ \ \ \mbox{\hyperlink{classtf_1_1_data_pipe_a542531895cb9363c6291e0ce9d126974}{DataPipe}}(\mbox{\hyperlink{namespacetf_abb7a11e41fd457f69e7ff45d4c769564}{PipeType}}\ \mbox{\hyperlink{ittnotify__static_8h_a5f135fd1e66a03efd5275434478e0d97}{d}},\ \mbox{\hyperlink{classtf_1_1_data_pipe_a5cc3b76f16379f4cb2ecdef66dee1ba3}{callable\_t}}\&\&\ \mbox{\hyperlink{classtf_1_1_data_pipe_a5931f0ae2db8e00f4ad4c42a26adbeae}{callable}})\ :}
\DoxyCodeLine{00087\ \ \ \ \ \mbox{\hyperlink{classtf_1_1_data_pipe_af7e6b232e5d82bd0443b4e4606a3fbea}{\_type}}\{\mbox{\hyperlink{ittnotify__static_8h_a5f135fd1e66a03efd5275434478e0d97}{d}}\},\ \mbox{\hyperlink{classtf_1_1_data_pipe_a0a91ad80a855658439bb9d9750ae4fc9}{\_callable}}\{\mbox{\hyperlink{namespacestd}{std}}::forward<\mbox{\hyperlink{classtf_1_1_data_pipe_a5cc3b76f16379f4cb2ecdef66dee1ba3}{callable\_t}}>(\mbox{\hyperlink{classtf_1_1_data_pipe_a5931f0ae2db8e00f4ad4c42a26adbeae}{callable}})\}\ \{}
\DoxyCodeLine{00088\ \ \ \}}
\DoxyCodeLine{00089\ }
\DoxyCodeLine{00096\ \ \ \mbox{\hyperlink{namespacetf_abb7a11e41fd457f69e7ff45d4c769564}{PipeType}}\ \mbox{\hyperlink{classtf_1_1_data_pipe_a82ef8e8f06444b251ccfe323facbf67a}{type}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00097\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classtf_1_1_data_pipe_af7e6b232e5d82bd0443b4e4606a3fbea}{\_type}};}
\DoxyCodeLine{00098\ \ \ \}}
\DoxyCodeLine{00099\ }
\DoxyCodeLine{00103\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtf_1_1_data_pipe_af7a3c2d313edd443b049e937f8ec8cd8}{type}}(\mbox{\hyperlink{namespacetf_abb7a11e41fd457f69e7ff45d4c769564}{PipeType}}\ \mbox{\hyperlink{classtf_1_1_data_pipe_a82ef8e8f06444b251ccfe323facbf67a}{type}})\ \{}
\DoxyCodeLine{00104\ \ \ \ \ \mbox{\hyperlink{classtf_1_1_data_pipe_af7e6b232e5d82bd0443b4e4606a3fbea}{\_type}}\ =\ \mbox{\hyperlink{classtf_1_1_data_pipe_a82ef8e8f06444b251ccfe323facbf67a}{type}};}
\DoxyCodeLine{00105\ \ \ \}}
\DoxyCodeLine{00106\ }
\DoxyCodeLine{00116\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ U>}
\DoxyCodeLine{00117\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtf_1_1_data_pipe_a5931f0ae2db8e00f4ad4c42a26adbeae}{callable}}(U\&\&\ \mbox{\hyperlink{classtf_1_1_data_pipe_a5931f0ae2db8e00f4ad4c42a26adbeae}{callable}})\ \{}
\DoxyCodeLine{00118\ \ \ \ \ \mbox{\hyperlink{classtf_1_1_data_pipe_a0a91ad80a855658439bb9d9750ae4fc9}{\_callable}}\ =\ std::forward<U>(\mbox{\hyperlink{classtf_1_1_data_pipe_a5931f0ae2db8e00f4ad4c42a26adbeae}{callable}});}
\DoxyCodeLine{00119\ \ \ \}}
\DoxyCodeLine{00120\ }
\DoxyCodeLine{00121\ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00122\ }
\DoxyCodeLine{00123\ \ \ \mbox{\hyperlink{namespacetf_abb7a11e41fd457f69e7ff45d4c769564}{PipeType}}\ \mbox{\hyperlink{classtf_1_1_data_pipe_af7e6b232e5d82bd0443b4e4606a3fbea}{\_type}};}
\DoxyCodeLine{00124\ }
\DoxyCodeLine{00125\ \ \ \mbox{\hyperlink{classtf_1_1_data_pipe_a5cc3b76f16379f4cb2ecdef66dee1ba3}{callable\_t}}\ \mbox{\hyperlink{classtf_1_1_data_pipe_a0a91ad80a855658439bb9d9750ae4fc9}{\_callable}};}
\DoxyCodeLine{00126\ \};}
\DoxyCodeLine{00127\ }
\DoxyCodeLine{00170\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Input,\ \textcolor{keyword}{typename}\ Output,\ \textcolor{keyword}{typename}\ C>}
\DoxyCodeLine{00171\ \textcolor{keyword}{auto}\ \mbox{\hyperlink{namespacetf_a8975fa5762088789adb0b60f38208309}{make\_data\_pipe}}(\mbox{\hyperlink{namespacetf_abb7a11e41fd457f69e7ff45d4c769564}{PipeType}}\ \mbox{\hyperlink{ittnotify__static_8h_a5f135fd1e66a03efd5275434478e0d97}{d}},\ \mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}}\&\&\ callable)\ \{}
\DoxyCodeLine{00172\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classtf_1_1_data_pipe}{DataPipe<Input,\ Output,\ C>}}(\mbox{\hyperlink{ittnotify__static_8h_a5f135fd1e66a03efd5275434478e0d97}{d}},\ std::forward<C>(callable));}
\DoxyCodeLine{00173\ \}}
\DoxyCodeLine{00174\ }
\DoxyCodeLine{00175\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00176\ \textcolor{comment}{//\ Class\ Definition:\ DataPipeline}}
\DoxyCodeLine{00177\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00178\ }
\DoxyCodeLine{00253\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}...\ Ps>}
\DoxyCodeLine{00254\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classtf_1_1_data_pipeline_a1559f218ca91b41d6c871a88183a04e5}{DataPipeline}}\ \{}
\DoxyCodeLine{00255\ }
\DoxyCodeLine{00256\ \ \ \textcolor{keyword}{static\_assert}(\textcolor{keyword}{sizeof}...(Ps)>0,\ \textcolor{stringliteral}{"{}must\ have\ at\ least\ one\ pipe"{}});}
\DoxyCodeLine{00257\ }
\DoxyCodeLine{00261\ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structtf_1_1_data_pipeline_1_1_line}{Line}}\ \{}
\DoxyCodeLine{00262\ \ \ \ \ std::atomic<size\_t>\ \mbox{\hyperlink{structtf_1_1_data_pipeline_1_1_line_aaade43a88e3f312158054c3ab34f62a9}{join\_counter}};}
\DoxyCodeLine{00263\ \ \ \};}
\DoxyCodeLine{00264\ }
\DoxyCodeLine{00268\ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structtf_1_1_data_pipeline_1_1_pipe_meta}{PipeMeta}}\ \{}
\DoxyCodeLine{00269\ \ \ \ \ \mbox{\hyperlink{namespacetf_abb7a11e41fd457f69e7ff45d4c769564}{PipeType}}\ \mbox{\hyperlink{structtf_1_1_data_pipeline_1_1_pipe_meta_a46556eee44255bb7e1048e8445086e80}{type}};}
\DoxyCodeLine{00270\ \ \ \};}
\DoxyCodeLine{00271\ }
\DoxyCodeLine{00272\ }
\DoxyCodeLine{00273\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00274\ \ \ }
\DoxyCodeLine{00278\ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{classtf_1_1_data_pipeline_ae3bce106a357267223e5a6c5884d57c4}{data\_t}}\ =\ \mbox{\hyperlink{namespacetf_a5182583cb29ae2b1f2827bddd403b535}{unique\_variant\_t}}<std::variant<std::conditional\_t<}
\DoxyCodeLine{00279\ \ \ \ \ std::is\_void\_v<typename\ Ps::output\_t>,\ }
\DoxyCodeLine{00280\ \ \ \ \ std::monostate,\ }
\DoxyCodeLine{00281\ \ \ \ \ std::decay\_t<typename\ Ps::output\_t>>...}
\DoxyCodeLine{00282\ \ \ >>;}
\DoxyCodeLine{00283\ }
\DoxyCodeLine{00295\ \ \ \mbox{\hyperlink{classtf_1_1_data_pipeline_a1559f218ca91b41d6c871a88183a04e5}{DataPipeline}}(\textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classtf_1_1_data_pipeline_aaa74a52dac68155a9b73f5f70d9d14aa}{num\_lines}},\ Ps\&\&...\ \mbox{\hyperlink{level1__cplx__impl_8h_a6280e894a2fd5ef320bda62ca65dcb3f}{ps}});}
\DoxyCodeLine{00296\ }
\DoxyCodeLine{00308\ \ \ \mbox{\hyperlink{classtf_1_1_data_pipeline_a1559f218ca91b41d6c871a88183a04e5}{DataPipeline}}(\textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classtf_1_1_data_pipeline_aaa74a52dac68155a9b73f5f70d9d14aa}{num\_lines}},\ std::tuple<Ps...>\&\&\ \mbox{\hyperlink{level1__cplx__impl_8h_a6280e894a2fd5ef320bda62ca65dcb3f}{ps}});}
\DoxyCodeLine{00309\ }
\DoxyCodeLine{00318\ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classtf_1_1_data_pipeline_aaa74a52dac68155a9b73f5f70d9d14aa}{num\_lines}}()\ const\ noexcept;}
\DoxyCodeLine{00319\ }
\DoxyCodeLine{00326\ \ \ constexpr\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classtf_1_1_data_pipeline_a8720a404e3811b28e3dd5b98c9047496}{num\_pipes}}()\ const\ noexcept;}
\DoxyCodeLine{00327\ }
\DoxyCodeLine{00335\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtf_1_1_data_pipeline_ad6355a117bbc4d3d607fb6f95ffd9889}{reset}}();}
\DoxyCodeLine{00336\ }
\DoxyCodeLine{00343\ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classtf_1_1_data_pipeline_a2c208032313105d142e2c8cec650acfe}{num\_tokens}}()\ const\ noexcept;}
\DoxyCodeLine{00344\ }
\DoxyCodeLine{00351\ \ \ \mbox{\hyperlink{classtf_1_1_graph}{Graph}}\&\ \mbox{\hyperlink{classtf_1_1_data_pipeline_adfc70da6fdffc4a0a56bd2fe0f0dc07d}{graph}}();}
\DoxyCodeLine{00352\ }
\DoxyCodeLine{00353\ \ \ \mbox{\hyperlink{rml__server_8cpp_a6a1d6e1a12975a4e9a0b5b952e79eaad}{private}}:}
\DoxyCodeLine{00354\ }
\DoxyCodeLine{00355\ \ \ \mbox{\hyperlink{classtf_1_1_graph}{Graph}}\ \mbox{\hyperlink{classtf_1_1_data_pipeline_aceec74e44a0b6c2c7018844643da84fb}{\_graph}};}
\DoxyCodeLine{00356\ }
\DoxyCodeLine{00357\ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classtf_1_1_data_pipeline_a4c4d77197be98821ad567db7e8d1cc61}{\_num\_tokens}};}
\DoxyCodeLine{00358\ }
\DoxyCodeLine{00359\ \ \ \mbox{\hyperlink{namespacestd}{std}}::\mbox{\hyperlink{classtuple}{tuple}}<Ps...>\ \mbox{\hyperlink{classtf_1_1_data_pipeline_a30a1c660df935da648be30743a6a3381}{\_pipes}};}
\DoxyCodeLine{00360\ \ \ \mbox{\hyperlink{namespacestd}{std}}::\mbox{\hyperlink{sugar_8h_af6228a2253f88b2affbe0c54d8b5b321}{array}}<\mbox{\hyperlink{structtf_1_1_data_pipeline_1_1_pipe_meta}{PipeMeta}},\ sizeof...(Ps)>\ \mbox{\hyperlink{classtf_1_1_data_pipeline_ad7bb60a333fe6cde6c72c7599145a96c}{\_meta}};}
\DoxyCodeLine{00361\ \ \ \mbox{\hyperlink{namespacestd}{std}}::\mbox{\hyperlink{ppc__define_8c_add93f942eb3d18a8f8e108404869156f}{vector}}<\mbox{\hyperlink{namespacestd}{std}}::\mbox{\hyperlink{sugar_8h_af6228a2253f88b2affbe0c54d8b5b321}{array}}<\mbox{\hyperlink{structtf_1_1_data_pipeline_1_1_line}{Line}},\ sizeof...(Ps)>>\ \mbox{\hyperlink{classtf_1_1_data_pipeline_aa8c8a3852f6a055e0666bd679b69a550}{\_lines}};}
\DoxyCodeLine{00362\ \ \ \mbox{\hyperlink{namespacestd}{std}}::\mbox{\hyperlink{ppc__define_8c_add93f942eb3d18a8f8e108404869156f}{vector}}<\mbox{\hyperlink{classtf_1_1_task}{Task}}>\ \mbox{\hyperlink{classtf_1_1_data_pipeline_ab8d93e0c228355590102a9bc1775b5fd}{\_tasks}};}
\DoxyCodeLine{00363\ \ \ \mbox{\hyperlink{namespacestd}{std}}::\mbox{\hyperlink{ppc__define_8c_add93f942eb3d18a8f8e108404869156f}{vector}}<\mbox{\hyperlink{classtf_1_1_pipeflow}{Pipeflow}}>\ \mbox{\hyperlink{classtf_1_1_data_pipeline_ae78ad58672cd1a4307543957950d7819}{\_pipeflows}};}
\DoxyCodeLine{00364\ \ \ \mbox{\hyperlink{namespacestd}{std}}::\mbox{\hyperlink{ppc__define_8c_add93f942eb3d18a8f8e108404869156f}{vector}}<\mbox{\hyperlink{structtf_1_1_cacheline_aligned}{CachelineAligned}}<\mbox{\hyperlink{classtf_1_1_data_pipeline_ae3bce106a357267223e5a6c5884d57c4}{data\_t}}>>\ \mbox{\hyperlink{classtf_1_1_data_pipeline_a59b6d2346e79a363f5c15958a9d14d7b}{\_buffer}};}
\DoxyCodeLine{00365\ }
\DoxyCodeLine{00366\ \ \ template\ <\textcolor{keywordtype}{size\_t}...\ I>}
\DoxyCodeLine{00367\ \ \ auto\ \mbox{\hyperlink{classtf_1_1_data_pipeline_a4550dd13483b3624648acda90d1e04f4}{\_gen\_meta}}(\mbox{\hyperlink{namespacestd}{std}}::\mbox{\hyperlink{classtuple}{tuple}}<Ps...>\&\&,\ \mbox{\hyperlink{namespacestd}{std}}::index\_sequence<I...>);}
\DoxyCodeLine{00368\ }
\DoxyCodeLine{00369\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtf_1_1_data_pipeline_ad5836484403bf71a4082fc9a71393e86}{\_on\_pipe}}(\mbox{\hyperlink{classtf_1_1_pipeflow}{Pipeflow}}\&,\ \mbox{\hyperlink{classtf_1_1_runtime}{Runtime}}\&);}
\DoxyCodeLine{00370\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtf_1_1_data_pipeline_a2820a8648648fbdb5f06220b5960f033}{\_build}}();}
\DoxyCodeLine{00371\ \};}
\DoxyCodeLine{00372\ }
\DoxyCodeLine{00373\ \textcolor{comment}{//\ constructor}}
\DoxyCodeLine{00374\ template\ <typename...\ Ps>}
\DoxyCodeLine{00375\ \mbox{\hyperlink{classtf_1_1_data_pipeline_a1559f218ca91b41d6c871a88183a04e5}{DataPipeline}}<Ps...>::\mbox{\hyperlink{classtf_1_1_data_pipeline_a1559f218ca91b41d6c871a88183a04e5}{DataPipeline}}(\textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classtf_1_1_data_pipeline_aaa74a52dac68155a9b73f5f70d9d14aa}{num\_lines}},\ Ps\&\&...\ \mbox{\hyperlink{level1__cplx__impl_8h_a6280e894a2fd5ef320bda62ca65dcb3f}{ps}})\ :}
\DoxyCodeLine{00376\ \ \ \mbox{\hyperlink{classtf_1_1_data_pipeline_a30a1c660df935da648be30743a6a3381}{\_pipes}}\ \ \ \ \ \{std::make\_tuple(std::forward<Ps>(\mbox{\hyperlink{level1__cplx__impl_8h_a6280e894a2fd5ef320bda62ca65dcb3f}{ps}})...)\},}
\DoxyCodeLine{00377\ \ \ \mbox{\hyperlink{classtf_1_1_data_pipeline_ad7bb60a333fe6cde6c72c7599145a96c}{\_meta}}\ \ \ \ \ \ \{PipeMeta\{\mbox{\hyperlink{level1__cplx__impl_8h_a6280e894a2fd5ef320bda62ca65dcb3f}{ps}}.type()\}...\},}
\DoxyCodeLine{00378\ \ \ \mbox{\hyperlink{classtf_1_1_data_pipeline_aa8c8a3852f6a055e0666bd679b69a550}{\_lines}}\ \ \ \ \ (\mbox{\hyperlink{classtf_1_1_data_pipeline_aaa74a52dac68155a9b73f5f70d9d14aa}{num\_lines}}),}
\DoxyCodeLine{00379\ \ \ \mbox{\hyperlink{classtf_1_1_data_pipeline_ab8d93e0c228355590102a9bc1775b5fd}{\_tasks}}\ \ \ \ \ (\mbox{\hyperlink{classtf_1_1_data_pipeline_aaa74a52dac68155a9b73f5f70d9d14aa}{num\_lines}}\ +\ 1),}
\DoxyCodeLine{00380\ \ \ \mbox{\hyperlink{classtf_1_1_data_pipeline_ae78ad58672cd1a4307543957950d7819}{\_pipeflows}}\ (\mbox{\hyperlink{classtf_1_1_data_pipeline_aaa74a52dac68155a9b73f5f70d9d14aa}{num\_lines}}),}
\DoxyCodeLine{00381\ \ \ \mbox{\hyperlink{classtf_1_1_data_pipeline_a59b6d2346e79a363f5c15958a9d14d7b}{\_buffer}}\ \ \ \ (\mbox{\hyperlink{classtf_1_1_data_pipeline_aaa74a52dac68155a9b73f5f70d9d14aa}{num\_lines}})\ \{}
\DoxyCodeLine{00382\ }
\DoxyCodeLine{00383\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classtf_1_1_data_pipeline_aaa74a52dac68155a9b73f5f70d9d14aa}{num\_lines}}\ ==\ 0)\ \{}
\DoxyCodeLine{00384\ \ \ \ \ \mbox{\hyperlink{error_8hpp_aecd66f17d01de60aeb9cae992c9dd4bf}{TF\_THROW}}(\textcolor{stringliteral}{"{}must\ have\ at\ least\ one\ line"{}});}
\DoxyCodeLine{00385\ \ \ \}}
\DoxyCodeLine{00386\ }
\DoxyCodeLine{00387\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{namespacestd_aae41d8280b7ccc3f0e0a0be2dab21c8f}{std::get<0>}}(\mbox{\hyperlink{classtf_1_1_data_pipeline_a30a1c660df935da648be30743a6a3381}{\_pipes}}).\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ae8396ff85d63082521e3324820df1009}{type}}()\ !=\ \mbox{\hyperlink{namespacetf_abb7a11e41fd457f69e7ff45d4c769564a7b804a28d6154ab8007287532037f1d0}{PipeType::SERIAL}})\ \{}
\DoxyCodeLine{00388\ \ \ \ \ \mbox{\hyperlink{error_8hpp_aecd66f17d01de60aeb9cae992c9dd4bf}{TF\_THROW}}(\textcolor{stringliteral}{"{}first\ pipe\ must\ be\ serial"{}});}
\DoxyCodeLine{00389\ \ \ \}}
\DoxyCodeLine{00390\ }
\DoxyCodeLine{00391\ \ \ \mbox{\hyperlink{classtf_1_1_data_pipeline_ad6355a117bbc4d3d607fb6f95ffd9889}{reset}}();}
\DoxyCodeLine{00392\ \ \ \mbox{\hyperlink{classtf_1_1_data_pipeline_a2820a8648648fbdb5f06220b5960f033}{\_build}}();}
\DoxyCodeLine{00393\ \}}
\DoxyCodeLine{00394\ }
\DoxyCodeLine{00395\ \textcolor{comment}{//\ constructor}}
\DoxyCodeLine{00396\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}...\ Ps>}
\DoxyCodeLine{00397\ \mbox{\hyperlink{classtf_1_1_data_pipeline_a1559f218ca91b41d6c871a88183a04e5}{DataPipeline<Ps...>::DataPipeline}}(\textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classtf_1_1_data_pipeline_aaa74a52dac68155a9b73f5f70d9d14aa}{num\_lines}},\ std::tuple<Ps...>\&\&\ \mbox{\hyperlink{level1__cplx__impl_8h_a6280e894a2fd5ef320bda62ca65dcb3f}{ps}})\ :}
\DoxyCodeLine{00398\ \ \ \mbox{\hyperlink{classtf_1_1_data_pipeline_a30a1c660df935da648be30743a6a3381}{\_pipes}}\ \ \ \ \ \{\mbox{\hyperlink{namespacestd}{std}}::forward<\mbox{\hyperlink{namespacestd}{std}}::\mbox{\hyperlink{classtuple}{tuple}}<Ps...>>(\mbox{\hyperlink{level1__cplx__impl_8h_a6280e894a2fd5ef320bda62ca65dcb3f}{ps}})\},}
\DoxyCodeLine{00399\ \ \ \mbox{\hyperlink{classtf_1_1_data_pipeline_ad7bb60a333fe6cde6c72c7599145a96c}{\_meta}}\ \ \ \ \ \ \{\mbox{\hyperlink{classtf_1_1_data_pipeline_a4550dd13483b3624648acda90d1e04f4}{\_gen\_meta}}(}
\DoxyCodeLine{00400\ \ \ \ \ \mbox{\hyperlink{namespacestd}{std}}::forward<\mbox{\hyperlink{namespacestd}{std}}::\mbox{\hyperlink{classtuple}{tuple}}<Ps...>>(\mbox{\hyperlink{level1__cplx__impl_8h_a6280e894a2fd5ef320bda62ca65dcb3f}{ps}}),\ \mbox{\hyperlink{namespacestd}{std}}::make\_index\_sequence<sizeof...(Ps)>\{\}}
\DoxyCodeLine{00401\ \ \ )\},}
\DoxyCodeLine{00402\ \ \ \_lines\ \ \ \ \ (num\_lines),}
\DoxyCodeLine{00403\ \ \ \_tasks\ \ \ \ \ (num\_lines\ +\ 1),}
\DoxyCodeLine{00404\ \ \ \_pipeflows\ (num\_lines),}
\DoxyCodeLine{00405\ \ \ \_buffer\ \ \ \ (num\_lines)\ \{}
\DoxyCodeLine{00406\ }
\DoxyCodeLine{00407\ \ \ \textcolor{keywordflow}{if}(num\_lines\ ==\ 0)\ \{}
\DoxyCodeLine{00408\ \ \ \ \ \mbox{\hyperlink{error_8hpp_aecd66f17d01de60aeb9cae992c9dd4bf}{TF\_THROW}}(\textcolor{stringliteral}{"{}must\ have\ at\ least\ one\ line"{}});}
\DoxyCodeLine{00409\ \ \ \}}
\DoxyCodeLine{00410\ }
\DoxyCodeLine{00411\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{namespacestd_aae41d8280b7ccc3f0e0a0be2dab21c8f}{std::get<0>}}(\_pipes).\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ae8396ff85d63082521e3324820df1009}{type}}()\ !=\ PipeType::SERIAL)\ \{}
\DoxyCodeLine{00412\ \ \ \ \ \mbox{\hyperlink{error_8hpp_aecd66f17d01de60aeb9cae992c9dd4bf}{TF\_THROW}}(\textcolor{stringliteral}{"{}first\ pipe\ must\ be\ serial"{}});}
\DoxyCodeLine{00413\ \ \ \}}
\DoxyCodeLine{00414\ }
\DoxyCodeLine{00415\ \ \ reset();}
\DoxyCodeLine{00416\ \ \ \_build();}
\DoxyCodeLine{00417\ \}}
\DoxyCodeLine{00418\ }
\DoxyCodeLine{00419\ \textcolor{comment}{//\ Function:\ \_get\_meta}}
\DoxyCodeLine{00420\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}...\ Ps>}
\DoxyCodeLine{00421\ \textcolor{keyword}{template}\ <\textcolor{keywordtype}{size\_t}...\ I>}
\DoxyCodeLine{00422\ \textcolor{keyword}{auto}\ \mbox{\hyperlink{classtf_1_1_data_pipeline_a4550dd13483b3624648acda90d1e04f4}{DataPipeline<Ps...>::\_gen\_meta}}(std::tuple<Ps...>\&\&\ \mbox{\hyperlink{level1__cplx__impl_8h_a6280e894a2fd5ef320bda62ca65dcb3f}{ps}},\ std::index\_sequence<I...>)\ \{}
\DoxyCodeLine{00423\ \ \ \textcolor{keywordflow}{return}\ std::array\{\mbox{\hyperlink{structtf_1_1_data_pipeline_1_1_pipe_meta}{PipeMeta}}\{\mbox{\hyperlink{namespacestd_aae41d8280b7ccc3f0e0a0be2dab21c8f}{std::get<I>}}(\mbox{\hyperlink{level1__cplx__impl_8h_a6280e894a2fd5ef320bda62ca65dcb3f}{ps}}).type()\}...\};}
\DoxyCodeLine{00424\ \}}
\DoxyCodeLine{00425\ }
\DoxyCodeLine{00426\ \textcolor{comment}{//\ Function:\ num\_lines}}
\DoxyCodeLine{00427\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}...\ Ps>}
\DoxyCodeLine{00428\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classtf_1_1_data_pipeline_aaa74a52dac68155a9b73f5f70d9d14aa}{DataPipeline<Ps...>::num\_lines}}()\ const\ noexcept\ \{}
\DoxyCodeLine{00429\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classtf_1_1_data_pipeline_ae78ad58672cd1a4307543957950d7819}{\_pipeflows}}.size();}
\DoxyCodeLine{00430\ \}}
\DoxyCodeLine{00431\ }
\DoxyCodeLine{00432\ \textcolor{comment}{//\ Function:\ num\_pipes}}
\DoxyCodeLine{00433\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}...\ Ps>}
\DoxyCodeLine{00434\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classtf_1_1_data_pipeline_a8720a404e3811b28e3dd5b98c9047496}{DataPipeline<Ps...>::num\_pipes}}()\ const\ noexcept\ \{}
\DoxyCodeLine{00435\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{sizeof}...(Ps);}
\DoxyCodeLine{00436\ \}}
\DoxyCodeLine{00437\ }
\DoxyCodeLine{00438\ \textcolor{comment}{//\ Function:\ num\_tokens}}
\DoxyCodeLine{00439\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}...\ Ps>}
\DoxyCodeLine{00440\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classtf_1_1_data_pipeline_a2c208032313105d142e2c8cec650acfe}{DataPipeline<Ps...>::num\_tokens}}()\ const\ noexcept\ \{}
\DoxyCodeLine{00441\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classtf_1_1_data_pipeline_a4c4d77197be98821ad567db7e8d1cc61}{\_num\_tokens}};}
\DoxyCodeLine{00442\ \}}
\DoxyCodeLine{00443\ }
\DoxyCodeLine{00444\ \textcolor{comment}{//\ Function:\ graph}}
\DoxyCodeLine{00445\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}...\ Ps>}
\DoxyCodeLine{00446\ \mbox{\hyperlink{classtf_1_1_graph}{Graph}}\&\ \mbox{\hyperlink{classtf_1_1_data_pipeline_adfc70da6fdffc4a0a56bd2fe0f0dc07d}{DataPipeline<Ps...>::graph}}()\ \{}
\DoxyCodeLine{00447\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classtf_1_1_data_pipeline_aceec74e44a0b6c2c7018844643da84fb}{\_graph}};}
\DoxyCodeLine{00448\ \}}
\DoxyCodeLine{00449\ }
\DoxyCodeLine{00450\ \textcolor{comment}{//\ Function:\ reset}}
\DoxyCodeLine{00451\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}...\ Ps>}
\DoxyCodeLine{00452\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtf_1_1_data_pipeline_ad6355a117bbc4d3d607fb6f95ffd9889}{DataPipeline<Ps...>::reset}}()\ \{}
\DoxyCodeLine{00453\ }
\DoxyCodeLine{00454\ \ \ \mbox{\hyperlink{classtf_1_1_data_pipeline_a4c4d77197be98821ad567db7e8d1cc61}{\_num\_tokens}}\ =\ 0;}
\DoxyCodeLine{00455\ }
\DoxyCodeLine{00456\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ l\ =\ 0;\ l<\mbox{\hyperlink{classtf_1_1_data_pipeline_aaa74a52dac68155a9b73f5f70d9d14aa}{num\_lines}}();\ l++)\ \{}
\DoxyCodeLine{00457\ \ \ \ \ \mbox{\hyperlink{classtf_1_1_data_pipeline_ae78ad58672cd1a4307543957950d7819}{\_pipeflows}}[l].\_pipe\ =\ 0;}
\DoxyCodeLine{00458\ \ \ \ \ \mbox{\hyperlink{classtf_1_1_data_pipeline_ae78ad58672cd1a4307543957950d7819}{\_pipeflows}}[l].\_line\ =\ l;}
\DoxyCodeLine{00459\ \ \ \}}
\DoxyCodeLine{00460\ }
\DoxyCodeLine{00461\ \ \ \mbox{\hyperlink{classtf_1_1_data_pipeline_aa8c8a3852f6a055e0666bd679b69a550}{\_lines}}[0][0].join\_counter.store(0,\ std::memory\_order\_relaxed);}
\DoxyCodeLine{00462\ }
\DoxyCodeLine{00463\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ l=1;\ l<\mbox{\hyperlink{classtf_1_1_data_pipeline_aaa74a52dac68155a9b73f5f70d9d14aa}{num\_lines}}();\ l++)\ \{}
\DoxyCodeLine{00464\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{cxx11__tensor__map_8cpp_a7f507fea02198f6cb81c86640c7b1a4e}{f}}=1;\ \mbox{\hyperlink{cxx11__tensor__map_8cpp_a7f507fea02198f6cb81c86640c7b1a4e}{f}}<\mbox{\hyperlink{classtf_1_1_data_pipeline_a8720a404e3811b28e3dd5b98c9047496}{num\_pipes}}();\ \mbox{\hyperlink{cxx11__tensor__map_8cpp_a7f507fea02198f6cb81c86640c7b1a4e}{f}}++)\ \{}
\DoxyCodeLine{00465\ \ \ \ \ \ \ \mbox{\hyperlink{classtf_1_1_data_pipeline_aa8c8a3852f6a055e0666bd679b69a550}{\_lines}}[l][\mbox{\hyperlink{cxx11__tensor__map_8cpp_a7f507fea02198f6cb81c86640c7b1a4e}{f}}].join\_counter.store(}
\DoxyCodeLine{00466\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{size\_t}\textcolor{keyword}{>}(\mbox{\hyperlink{classtf_1_1_data_pipeline_ad7bb60a333fe6cde6c72c7599145a96c}{\_meta}}[\mbox{\hyperlink{cxx11__tensor__map_8cpp_a7f507fea02198f6cb81c86640c7b1a4e}{f}}].\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ae8396ff85d63082521e3324820df1009}{type}}),\ std::memory\_order\_relaxed}
\DoxyCodeLine{00467\ \ \ \ \ \ \ );}
\DoxyCodeLine{00468\ \ \ \ \ \}}
\DoxyCodeLine{00469\ \ \ \}}
\DoxyCodeLine{00470\ }
\DoxyCodeLine{00471\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{cxx11__tensor__map_8cpp_a7f507fea02198f6cb81c86640c7b1a4e}{f}}=1;\ \mbox{\hyperlink{cxx11__tensor__map_8cpp_a7f507fea02198f6cb81c86640c7b1a4e}{f}}<\mbox{\hyperlink{classtf_1_1_data_pipeline_a8720a404e3811b28e3dd5b98c9047496}{num\_pipes}}();\ \mbox{\hyperlink{cxx11__tensor__map_8cpp_a7f507fea02198f6cb81c86640c7b1a4e}{f}}++)\ \{}
\DoxyCodeLine{00472\ \ \ \ \ \mbox{\hyperlink{classtf_1_1_data_pipeline_aa8c8a3852f6a055e0666bd679b69a550}{\_lines}}[0][\mbox{\hyperlink{cxx11__tensor__map_8cpp_a7f507fea02198f6cb81c86640c7b1a4e}{f}}].join\_counter.store(1,\ std::memory\_order\_relaxed);}
\DoxyCodeLine{00473\ \ \ \}}
\DoxyCodeLine{00474\ }
\DoxyCodeLine{00475\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ l=1;\ l<\mbox{\hyperlink{classtf_1_1_data_pipeline_aaa74a52dac68155a9b73f5f70d9d14aa}{num\_lines}}();\ l++)\ \{}
\DoxyCodeLine{00476\ \ \ \ \ \mbox{\hyperlink{classtf_1_1_data_pipeline_aa8c8a3852f6a055e0666bd679b69a550}{\_lines}}[l][0].join\_counter.store(}
\DoxyCodeLine{00477\ \ \ \ \ \ \ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{size\_t}\textcolor{keyword}{>}(\mbox{\hyperlink{classtf_1_1_data_pipeline_ad7bb60a333fe6cde6c72c7599145a96c}{\_meta}}[0].\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ae8396ff85d63082521e3324820df1009}{type}})\ -\/\ 1,\ std::memory\_order\_relaxed}
\DoxyCodeLine{00478\ \ \ \ \ );}
\DoxyCodeLine{00479\ \ \ \}}
\DoxyCodeLine{00480\ \}}
\DoxyCodeLine{00481\ }
\DoxyCodeLine{00482\ \textcolor{comment}{//\ Procedure:\ \_on\_pipe}}
\DoxyCodeLine{00483\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}...\ Ps>}
\DoxyCodeLine{00484\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtf_1_1_data_pipeline_ad5836484403bf71a4082fc9a71393e86}{DataPipeline<Ps...>::\_on\_pipe}}(\mbox{\hyperlink{classtf_1_1_pipeflow}{Pipeflow}}\&\ pf,\ \mbox{\hyperlink{classtf_1_1_runtime}{Runtime}}\&)\ \{}
\DoxyCodeLine{00485\ }
\DoxyCodeLine{00486\ \ \ \mbox{\hyperlink{namespacetf_a9d16a1bfe2949da5f0751304dc4321f1}{visit\_tuple}}([\&](\textcolor{keyword}{auto}\&\&\ pipe)\{}
\DoxyCodeLine{00487\ }
\DoxyCodeLine{00488\ \ \ \ \ \textcolor{keyword}{using\ }data\_pipe\_t\ =\ std::decay\_t<\textcolor{keyword}{decltype}(pipe)>;}
\DoxyCodeLine{00489\ \ \ \ \ \textcolor{keyword}{using\ }callable\_t\ \ =\ \textcolor{keyword}{typename}\ data\_pipe\_t::callable\_t;}
\DoxyCodeLine{00490\ \ \ \ \ \textcolor{keyword}{using\ }input\_t\ \ \ \ \ =\ std::decay\_t<typename\ data\_pipe\_t::input\_t>;}
\DoxyCodeLine{00491\ \ \ \ \ \textcolor{keyword}{using\ }output\_t\ \ \ \ =\ std::decay\_t<typename\ data\_pipe\_t::output\_t>;}
\DoxyCodeLine{00492\ \ \ \ \ }
\DoxyCodeLine{00493\ \ \ \ \ \textcolor{comment}{//\ first\ pipe}}
\DoxyCodeLine{00494\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_invocable\_v<callable\_t,\ Pipeflow\&>)\ \{}
\DoxyCodeLine{00495\ \ \ \ \ \ \ \textcolor{comment}{//\ [](tf::Pipeflow\&)\ -\/>\ void\ \{\},\ i.e.,\ we\ only\ have\ one\ pipe}}
\DoxyCodeLine{00496\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_void\_v<output\_t>)\ \{}
\DoxyCodeLine{00497\ \ \ \ \ \ \ \ \ pipe.\_callable(pf);}
\DoxyCodeLine{00498\ \ \ \ \ \ \ \textcolor{comment}{//\ [](tf::Pipeflow\&)\ -\/>\ output\_t\ \{\}}}
\DoxyCodeLine{00499\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00500\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classtf_1_1_data_pipeline_a59b6d2346e79a363f5c15958a9d14d7b}{\_buffer}}[pf.\mbox{\hyperlink{classtf_1_1_pipeflow_a082a1a549ab50360c7e6e55a0fd4477f}{\_line}}].data\ =\ pipe.\_callable(pf);}
\DoxyCodeLine{00501\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00502\ \ \ \ \ \}}
\DoxyCodeLine{00503\ \ \ \ \ \textcolor{comment}{//\ other\ pipes\ without\ pipeflow\ in\ the\ second\ argument}}
\DoxyCodeLine{00504\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_invocable\_v<callable\_t,\ std::add\_lvalue\_reference\_t<input\_t>\ >)\ \{}
\DoxyCodeLine{00505\ \ \ \ \ \ \ \textcolor{comment}{//\ [](input\_t\&)\ -\/>\ void\ \{\},\ i.e.,\ the\ last\ pipe}}
\DoxyCodeLine{00506\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_void\_v<output\_t>)\ \{}
\DoxyCodeLine{00507\ \ \ \ \ \ \ \ \ pipe.\_callable(\mbox{\hyperlink{namespacestd_aae41d8280b7ccc3f0e0a0be2dab21c8f}{std::get<input\_t>}}(\mbox{\hyperlink{classtf_1_1_data_pipeline_a59b6d2346e79a363f5c15958a9d14d7b}{\_buffer}}[pf.\mbox{\hyperlink{classtf_1_1_pipeflow_a082a1a549ab50360c7e6e55a0fd4477f}{\_line}}].data));}
\DoxyCodeLine{00508\ \ \ \ \ \ \ \textcolor{comment}{//\ [](input\_t\&)\ -\/>\ output\_t\ \{\}}}
\DoxyCodeLine{00509\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00510\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classtf_1_1_data_pipeline_a59b6d2346e79a363f5c15958a9d14d7b}{\_buffer}}[pf.\mbox{\hyperlink{classtf_1_1_pipeflow_a082a1a549ab50360c7e6e55a0fd4477f}{\_line}}].data\ =\ pipe.\_callable(}
\DoxyCodeLine{00511\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacestd_aae41d8280b7ccc3f0e0a0be2dab21c8f}{std::get<input\_t>}}(\mbox{\hyperlink{classtf_1_1_data_pipeline_a59b6d2346e79a363f5c15958a9d14d7b}{\_buffer}}[pf.\mbox{\hyperlink{classtf_1_1_pipeflow_a082a1a549ab50360c7e6e55a0fd4477f}{\_line}}].data)}
\DoxyCodeLine{00512\ \ \ \ \ \ \ \ \ );}
\DoxyCodeLine{00513\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00514\ \ \ \ \ \}}
\DoxyCodeLine{00515\ \ \ \ \ \textcolor{comment}{//\ other\ pipes\ with\ pipeflow\ in\ the\ second\ argument}}
\DoxyCodeLine{00516\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_invocable\_v<callable\_t,\ input\_t\&,\ Pipeflow\&>)\ \{}
\DoxyCodeLine{00517\ \ \ \ \ \ \ \textcolor{comment}{//\ [](input\_t\&,\ tf::Pipeflow\&)\ -\/>\ void\ \{\}}}
\DoxyCodeLine{00518\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_void\_v<output\_t>)\ \{}
\DoxyCodeLine{00519\ \ \ \ \ \ \ \ \ pipe.\_callable(\mbox{\hyperlink{namespacestd_aae41d8280b7ccc3f0e0a0be2dab21c8f}{std::get<input\_t>}}(\mbox{\hyperlink{classtf_1_1_data_pipeline_a59b6d2346e79a363f5c15958a9d14d7b}{\_buffer}}[pf.\mbox{\hyperlink{classtf_1_1_pipeflow_a082a1a549ab50360c7e6e55a0fd4477f}{\_line}}].data),\ pf);}
\DoxyCodeLine{00520\ \ \ \ \ \ \ \textcolor{comment}{//\ [](input\_t\&,\ tf::Pipeflow\&)\ -\/>\ output\_t\ \{\}}}
\DoxyCodeLine{00521\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00522\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classtf_1_1_data_pipeline_a59b6d2346e79a363f5c15958a9d14d7b}{\_buffer}}[pf.\mbox{\hyperlink{classtf_1_1_pipeflow_a082a1a549ab50360c7e6e55a0fd4477f}{\_line}}].data\ =\ pipe.\_callable(}
\DoxyCodeLine{00523\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacestd_aae41d8280b7ccc3f0e0a0be2dab21c8f}{std::get<input\_t>}}(\mbox{\hyperlink{classtf_1_1_data_pipeline_a59b6d2346e79a363f5c15958a9d14d7b}{\_buffer}}[pf.\mbox{\hyperlink{classtf_1_1_pipeflow_a082a1a549ab50360c7e6e55a0fd4477f}{\_line}}].data),\ pf}
\DoxyCodeLine{00524\ \ \ \ \ \ \ \ \ );}
\DoxyCodeLine{00525\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00526\ \ \ \ \ \}}
\DoxyCodeLine{00527\ \ \ \ \ \textcolor{comment}{//else\ if\ constexpr(std::is\_invocable\_v<callable\_t,\ Pipeflow\&,\ Runtime\&>)\ \{}}
\DoxyCodeLine{00528\ \ \ \ \ \textcolor{comment}{//\ \ pipe.\_callable(pf,\ rt);}}
\DoxyCodeLine{00529\ \ \ \ \ \textcolor{comment}{//\}}}
\DoxyCodeLine{00530\ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00531\ \ \ \ \ \ \ \textcolor{keyword}{static\_assert}(\mbox{\hyperlink{namespacetf_a036d82b3ab21beea2ed89611e2930db7}{dependent\_false\_v<callable\_t>}},\ \textcolor{stringliteral}{"{}un-\/supported\ pipe\ callable\ type"{}});}
\DoxyCodeLine{00532\ \ \ \ \ \}}
\DoxyCodeLine{00533\ \ \ \},\ \mbox{\hyperlink{classtf_1_1_data_pipeline_a30a1c660df935da648be30743a6a3381}{\_pipes}},\ pf.\mbox{\hyperlink{classtf_1_1_pipeflow_a597744cac4ef0dd9e31e1d694f71f7ec}{\_pipe}});}
\DoxyCodeLine{00534\ \}}
\DoxyCodeLine{00535\ }
\DoxyCodeLine{00536\ \textcolor{comment}{//\ Procedure:\ \_build}}
\DoxyCodeLine{00537\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}...\ Ps>}
\DoxyCodeLine{00538\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtf_1_1_data_pipeline_a2820a8648648fbdb5f06220b5960f033}{DataPipeline<Ps...>::\_build}}()\ \{}
\DoxyCodeLine{00539\ }
\DoxyCodeLine{00540\ \ \ \textcolor{keyword}{using\ namespace\ }std::literals::string\_literals;}
\DoxyCodeLine{00541\ }
\DoxyCodeLine{00542\ \ \ \mbox{\hyperlink{classtf_1_1_flow_builder}{FlowBuilder}}\ fb(\mbox{\hyperlink{classtf_1_1_data_pipeline_aceec74e44a0b6c2c7018844643da84fb}{\_graph}});}
\DoxyCodeLine{00543\ }
\DoxyCodeLine{00544\ \ \ \textcolor{comment}{//\ init\ task}}
\DoxyCodeLine{00545\ \ \ \mbox{\hyperlink{classtf_1_1_data_pipeline_ab8d93e0c228355590102a9bc1775b5fd}{\_tasks}}[0]\ =\ fb.\mbox{\hyperlink{classtf_1_1_flow_builder_a60d7a666cab71ecfa3010b2efb0d6b57}{emplace}}([\textcolor{keyword}{this}]()\ \{}
\DoxyCodeLine{00546\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(\mbox{\hyperlink{classtf_1_1_data_pipeline_a4c4d77197be98821ad567db7e8d1cc61}{\_num\_tokens}}\ \%\ \mbox{\hyperlink{classtf_1_1_data_pipeline_aaa74a52dac68155a9b73f5f70d9d14aa}{num\_lines}}());}
\DoxyCodeLine{00547\ \ \ \}).\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aab18cfce5ee7c6881ae04f18be70d94a}{name}}(\textcolor{stringliteral}{"{}cond"{}});}
\DoxyCodeLine{00548\ }
\DoxyCodeLine{00549\ \ \ \textcolor{comment}{//\ line\ task}}
\DoxyCodeLine{00550\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ l\ =\ 0;\ l\ <\ \mbox{\hyperlink{classtf_1_1_data_pipeline_aaa74a52dac68155a9b73f5f70d9d14aa}{num\_lines}}();\ l++)\ \{}
\DoxyCodeLine{00551\ }
\DoxyCodeLine{00552\ \ \ \ \ \mbox{\hyperlink{classtf_1_1_data_pipeline_ab8d93e0c228355590102a9bc1775b5fd}{\_tasks}}[l\ +\ 1]\ =\ fb.\mbox{\hyperlink{classtf_1_1_flow_builder_a60d7a666cab71ecfa3010b2efb0d6b57}{emplace}}([\textcolor{keyword}{this},\ l]\ (\mbox{\hyperlink{classtf_1_1_runtime}{tf::Runtime}}\&\ rt)\ \textcolor{keyword}{mutable}\ \{}
\DoxyCodeLine{00553\ }
\DoxyCodeLine{00554\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ pf\ =\ \&\mbox{\hyperlink{classtf_1_1_data_pipeline_ae78ad58672cd1a4307543957950d7819}{\_pipeflows}}[l];}
\DoxyCodeLine{00555\ }
\DoxyCodeLine{00556\ \ \ \ \ \ \ pipeline:}
\DoxyCodeLine{00557\ }
\DoxyCodeLine{00558\ \ \ \ \ \ \ \mbox{\hyperlink{classtf_1_1_data_pipeline_aa8c8a3852f6a055e0666bd679b69a550}{\_lines}}[pf-\/>\_line][pf-\/>\_pipe].join\_counter.store(}
\DoxyCodeLine{00559\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{size\_t}\textcolor{keyword}{>}(\mbox{\hyperlink{classtf_1_1_data_pipeline_ad7bb60a333fe6cde6c72c7599145a96c}{\_meta}}[pf-\/>\_pipe].type),\ std::memory\_order\_relaxed}
\DoxyCodeLine{00560\ \ \ \ \ \ \ );}
\DoxyCodeLine{00561\ }
\DoxyCodeLine{00562\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (pf-\/>\_pipe\ ==\ 0)\ \{}
\DoxyCodeLine{00563\ \ \ \ \ \ \ \ \ pf-\/>\_token\ =\ \mbox{\hyperlink{classtf_1_1_data_pipeline_a4c4d77197be98821ad567db7e8d1cc61}{\_num\_tokens}};}
\DoxyCodeLine{00564\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (pf-\/>\_stop\ =\ \textcolor{keyword}{false},\ \mbox{\hyperlink{classtf_1_1_data_pipeline_ad5836484403bf71a4082fc9a71393e86}{\_on\_pipe}}(*pf,\ rt);\ pf-\/>\_stop\ ==\ \textcolor{keyword}{true})\ \{}
\DoxyCodeLine{00565\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ here,\ the\ pipeline\ is\ not\ stopped\ yet\ because\ other}}
\DoxyCodeLine{00566\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ lines\ of\ tasks\ may\ still\ be\ running\ their\ last\ stages}}
\DoxyCodeLine{00567\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00568\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00569\ \ \ \ \ \ \ \ \ ++\mbox{\hyperlink{classtf_1_1_data_pipeline_a4c4d77197be98821ad567db7e8d1cc61}{\_num\_tokens}};}
\DoxyCodeLine{00570\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00571\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00572\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classtf_1_1_data_pipeline_ad5836484403bf71a4082fc9a71393e86}{\_on\_pipe}}(*pf,\ rt);}
\DoxyCodeLine{00573\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00574\ }
\DoxyCodeLine{00575\ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ c\_f\ =\ pf-\/>\_pipe;}
\DoxyCodeLine{00576\ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ n\_f\ =\ (pf-\/>\_pipe\ +\ 1)\ \%\ \mbox{\hyperlink{classtf_1_1_data_pipeline_a8720a404e3811b28e3dd5b98c9047496}{num\_pipes}}();}
\DoxyCodeLine{00577\ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ n\_l\ =\ (pf-\/>\_line\ +\ 1)\ \%\ \mbox{\hyperlink{classtf_1_1_data_pipeline_aaa74a52dac68155a9b73f5f70d9d14aa}{num\_lines}}();}
\DoxyCodeLine{00578\ }
\DoxyCodeLine{00579\ \ \ \ \ \ \ pf-\/>\_pipe\ =\ n\_f;}
\DoxyCodeLine{00580\ }
\DoxyCodeLine{00581\ \ \ \ \ \ \ \textcolor{comment}{//\ -\/-\/-\/-\/\ scheduling\ starts\ here\ -\/-\/-\/-\/}}
\DoxyCodeLine{00582\ \ \ \ \ \ \ \textcolor{comment}{//\ Notice\ that\ the\ shared\ variable\ f\ must\ not\ be\ changed\ after\ this}}
\DoxyCodeLine{00583\ \ \ \ \ \ \ \textcolor{comment}{//\ point\ because\ it\ can\ result\ in\ data\ race\ due\ to\ the\ following}}
\DoxyCodeLine{00584\ \ \ \ \ \ \ \textcolor{comment}{//\ condition:}}
\DoxyCodeLine{00585\ \ \ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00586\ \ \ \ \ \ \ \textcolor{comment}{//\ a\ -\/>\ b}}
\DoxyCodeLine{00587\ \ \ \ \ \ \ \textcolor{comment}{//\ |\ \ \ \ |}}
\DoxyCodeLine{00588\ \ \ \ \ \ \ \textcolor{comment}{//\ v\ \ \ \ v}}
\DoxyCodeLine{00589\ \ \ \ \ \ \ \textcolor{comment}{//\ c\ -\/>\ d}}
\DoxyCodeLine{00590\ \ \ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00591\ \ \ \ \ \ \ \textcolor{comment}{//\ d\ will\ be\ spawned\ by\ either\ c\ or\ b,\ so\ if\ c\ changes\ f\ but\ b\ spawns\ d}}
\DoxyCodeLine{00592\ \ \ \ \ \ \ \textcolor{comment}{//\ then\ data\ race\ on\ f\ will\ happen}}
\DoxyCodeLine{00593\ }
\DoxyCodeLine{00594\ \ \ \ \ \ \ std::array<int,\ 2>\ retval;}
\DoxyCodeLine{00595\ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}\ =\ 0;}
\DoxyCodeLine{00596\ }
\DoxyCodeLine{00597\ \ \ \ \ \ \ \textcolor{comment}{//\ downward\ dependency}}
\DoxyCodeLine{00598\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classtf_1_1_data_pipeline_ad7bb60a333fe6cde6c72c7599145a96c}{\_meta}}[c\_f].\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ae8396ff85d63082521e3324820df1009}{type}}\ ==\ \mbox{\hyperlink{namespacetf_abb7a11e41fd457f69e7ff45d4c769564a7b804a28d6154ab8007287532037f1d0}{PipeType::SERIAL}}\ \&\&}
\DoxyCodeLine{00599\ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classtf_1_1_data_pipeline_aa8c8a3852f6a055e0666bd679b69a550}{\_lines}}[n\_l][c\_f].join\_counter.fetch\_sub(}
\DoxyCodeLine{00600\ \ \ \ \ \ \ \ \ \ \ \ 1,\ std::memory\_order\_acq\_rel)\ ==\ 1}
\DoxyCodeLine{00601\ \ \ \ \ \ \ \ \ )\ \{}
\DoxyCodeLine{00602\ \ \ \ \ \ \ \ \ retval[\mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}++]\ =\ 1;}
\DoxyCodeLine{00603\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00604\ }
\DoxyCodeLine{00605\ \ \ \ \ \ \ \textcolor{comment}{//\ forward\ dependency}}
\DoxyCodeLine{00606\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classtf_1_1_data_pipeline_aa8c8a3852f6a055e0666bd679b69a550}{\_lines}}[pf-\/>\_line][n\_f].join\_counter.fetch\_sub(}
\DoxyCodeLine{00607\ \ \ \ \ \ \ \ \ \ \ 1,\ std::memory\_order\_acq\_rel)\ ==\ 1}
\DoxyCodeLine{00608\ \ \ \ \ \ \ \ \ )\ \{}
\DoxyCodeLine{00609\ \ \ \ \ \ \ \ \ retval[\mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}++]\ =\ 0;}
\DoxyCodeLine{00610\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00611\ }
\DoxyCodeLine{00612\ \ \ \ \ \ \ \textcolor{comment}{//\ notice\ that\ the\ task\ index\ starts\ from\ 1}}
\DoxyCodeLine{00613\ \ \ \ \ \ \ \textcolor{keywordflow}{switch}(\mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}})\ \{}
\DoxyCodeLine{00614\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ 2:\ \{}
\DoxyCodeLine{00615\ \ \ \ \ \ \ \ \ \ \ rt.\mbox{\hyperlink{classtf_1_1_runtime_aa7e72cc0f298475195b252c8f1793343}{schedule}}(\mbox{\hyperlink{classtf_1_1_data_pipeline_ab8d93e0c228355590102a9bc1775b5fd}{\_tasks}}[n\_l+1]);}
\DoxyCodeLine{00616\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{goto}\ pipeline;}
\DoxyCodeLine{00617\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00618\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ 1:\ \{}
\DoxyCodeLine{00619\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (retval[0]\ ==\ 1)\ \{}
\DoxyCodeLine{00620\ \ \ \ \ \ \ \ \ \ \ \ \ pf\ =\ \&\mbox{\hyperlink{classtf_1_1_data_pipeline_ae78ad58672cd1a4307543957950d7819}{\_pipeflows}}[n\_l];}
\DoxyCodeLine{00621\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00622\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{goto}\ pipeline;}
\DoxyCodeLine{00623\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00624\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00625\ \ \ \ \ \}).\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aab18cfce5ee7c6881ae04f18be70d94a}{name}}(\textcolor{stringliteral}{"{}rt-\/"{}}\mbox{\hyperlink{main-override_8cpp_a1384e7608274313a9433fa573868557b}{s}}\ +\ std::to\_string(l));}
\DoxyCodeLine{00626\ }
\DoxyCodeLine{00627\ \ \ \ \ \mbox{\hyperlink{classtf_1_1_data_pipeline_ab8d93e0c228355590102a9bc1775b5fd}{\_tasks}}[0].precede(\mbox{\hyperlink{classtf_1_1_data_pipeline_ab8d93e0c228355590102a9bc1775b5fd}{\_tasks}}[l+1]);}
\DoxyCodeLine{00628\ \ \ \}}
\DoxyCodeLine{00629\ \}}
\DoxyCodeLine{00630\ }
\DoxyCodeLine{00631\ }
\DoxyCodeLine{00632\ \}\ \ \textcolor{comment}{//\ end\ of\ namespace\ tf\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00633\ }
\DoxyCodeLine{00634\ }
\DoxyCodeLine{00635\ }
\DoxyCodeLine{00636\ }
\DoxyCodeLine{00637\ }

\end{DoxyCode}
