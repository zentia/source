\doxysection{Tensor\+Executor.\+h}
\hypertarget{_tensor_executor_8h_source}{}\label{_tensor_executor_8h_source}\index{external/taskflow/3rd-\/party/eigen-\/3.3.7/unsupported/Eigen/CXX11/src/Tensor/TensorExecutor.h@{external/taskflow/3rd-\/party/eigen-\/3.3.7/unsupported/Eigen/CXX11/src/Tensor/TensorExecutor.h}}
\mbox{\hyperlink{_tensor_executor_8h}{浏览该文件的文档.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ This\ file\ is\ part\ of\ Eigen,\ a\ lightweight\ C++\ template\ library}}
\DoxyCodeLine{00002\ \textcolor{comment}{//\ for\ linear\ algebra.}}
\DoxyCodeLine{00003\ \textcolor{comment}{//}}
\DoxyCodeLine{00004\ \textcolor{comment}{//\ Copyright\ (C)\ 2014\ Benoit\ Steiner\ <benoit.steiner.goog@gmail.com>}}
\DoxyCodeLine{00005\ \textcolor{comment}{//}}
\DoxyCodeLine{00006\ \textcolor{comment}{//\ This\ Source\ Code\ Form\ is\ subject\ to\ the\ terms\ of\ the\ Mozilla}}
\DoxyCodeLine{00007\ \textcolor{comment}{//\ Public\ License\ v.\ 2.0.\ If\ a\ copy\ of\ the\ MPL\ was\ not\ distributed}}
\DoxyCodeLine{00008\ \textcolor{comment}{//\ with\ this\ file,\ You\ can\ obtain\ one\ at\ http://mozilla.org/MPL/2.0/.}}
\DoxyCodeLine{00009\ }
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#ifndef\ EIGEN\_CXX11\_TENSOR\_TENSOR\_EXECUTOR\_H}}
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#define\ EIGEN\_CXX11\_TENSOR\_TENSOR\_EXECUTOR\_H}}
\DoxyCodeLine{00012\ }
\DoxyCodeLine{00013\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespace_eigen}{Eigen}}\ \{}
\DoxyCodeLine{00014\ }
\DoxyCodeLine{00023\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespaceinternal}{internal}}\ \{}
\DoxyCodeLine{00024\ }
\DoxyCodeLine{00025\ \textcolor{comment}{//\ Default\ strategy:\ the\ expression\ is\ evaluated\ with\ a\ single\ cpu\ thread.}}
\DoxyCodeLine{00026\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ Expression,\ \textcolor{keyword}{typename}\ Device,\ \textcolor{keywordtype}{bool}\ Vectorizable>}
\DoxyCodeLine{00027\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_eigen_1_1internal_1_1_tensor_executor}{TensorExecutor}}}
\DoxyCodeLine{00028\ \{}
\DoxyCodeLine{00029\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00030\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ Expression::Index\ \mbox{\hyperlink{class_eigen_1_1internal_1_1_tensor_executor_aae209bfff57548530837db0e6d100932}{Index}};}
\DoxyCodeLine{00031\ \ \ EIGEN\_DEVICE\_FUNC}
\DoxyCodeLine{00032\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_eigen_1_1internal_1_1_tensor_executor_a2746f3ea9258215fe221288ec352c0bc}{run}}(\textcolor{keyword}{const}\ Expression\&\ expr,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1traits}{Device}}\&\ device\ =\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1traits}{Device}}())}
\DoxyCodeLine{00033\ \ \ \{}
\DoxyCodeLine{00034\ \ \ \ \ \mbox{\hyperlink{struct_eigen_1_1_tensor_evaluator}{TensorEvaluator<Expression,\ Device>}}\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1evaluator}{evaluator}}(expr,\ device);}
\DoxyCodeLine{00035\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ needs\_assign\ =\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1evaluator}{evaluator}}.evalSubExprsIfNeeded(\mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}});}
\DoxyCodeLine{00036\ \ \ \ \ \textcolor{keywordflow}{if}\ (needs\_assign)}
\DoxyCodeLine{00037\ \ \ \ \ \{}
\DoxyCodeLine{00038\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1internal_1_1_tensor_executor_aae209bfff57548530837db0e6d100932}{Index}}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}}\ =\ \mbox{\hyperlink{namespace_eigen_1_1internal_a3b99e338d92a91c8b3f89d32d0ca2c39}{array\_prod}}(\mbox{\hyperlink{struct_eigen_1_1internal_1_1evaluator}{evaluator}}.dimensions());}
\DoxyCodeLine{00039\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{class_eigen_1_1internal_1_1_tensor_executor_aae209bfff57548530837db0e6d100932}{Index}}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ =\ 0;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ <\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}};\ ++\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ \{}
\DoxyCodeLine{00040\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_eigen_1_1internal_1_1evaluator}{evaluator}}.evalScalar(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}});}
\DoxyCodeLine{00041\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00042\ \ \ \ \ \}}
\DoxyCodeLine{00043\ \ \ \ \ \mbox{\hyperlink{struct_eigen_1_1internal_1_1evaluator}{evaluator}}.cleanup();}
\DoxyCodeLine{00044\ \ \ \}}
\DoxyCodeLine{00045\ \};}
\DoxyCodeLine{00046\ }
\DoxyCodeLine{00047\ }
\DoxyCodeLine{00048\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ Expression>}
\DoxyCodeLine{00049\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_eigen_1_1internal_1_1_tensor_executor}{TensorExecutor}}<Expression,\ \mbox{\hyperlink{struct_eigen_1_1_default_device}{DefaultDevice}},\ \mbox{\hyperlink{yyjson_8h_a41f9c5fb8b08eb5dc3edce4dcb37fee7}{true}}>}
\DoxyCodeLine{00050\ \{}
\DoxyCodeLine{00051\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00052\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ Expression::Index\ \mbox{\hyperlink{class_eigen_1_1internal_1_1_tensor_executor_3_01_expression_00_01_default_device_00_01true_01_4_ab79119c2d9cc171c3eba60755b5da1ce}{Index}};}
\DoxyCodeLine{00053\ \ \ EIGEN\_DEVICE\_FUNC}
\DoxyCodeLine{00054\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_eigen_1_1internal_1_1_tensor_executor_3_01_expression_00_01_default_device_00_01true_01_4_ae42547f21bf09faef10677ca987ed171}{run}}(\textcolor{keyword}{const}\ Expression\&\ expr,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_eigen_1_1_default_device}{DefaultDevice}}\&\ device\ =\ \mbox{\hyperlink{struct_eigen_1_1_default_device}{DefaultDevice}}())}
\DoxyCodeLine{00055\ \ \ \{}
\DoxyCodeLine{00056\ \ \ \ \ \mbox{\hyperlink{struct_eigen_1_1_tensor_evaluator}{TensorEvaluator<Expression,\ DefaultDevice>}}\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1evaluator}{evaluator}}(expr,\ device);}
\DoxyCodeLine{00057\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ needs\_assign\ =\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1evaluator}{evaluator}}.evalSubExprsIfNeeded(\mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}});}
\DoxyCodeLine{00058\ \ \ \ \ \textcolor{keywordflow}{if}\ (needs\_assign)}
\DoxyCodeLine{00059\ \ \ \ \ \{}
\DoxyCodeLine{00060\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1internal_1_1_tensor_executor_3_01_expression_00_01_default_device_00_01true_01_4_ab79119c2d9cc171c3eba60755b5da1ce}{Index}}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}}\ =\ \mbox{\hyperlink{namespace_eigen_1_1internal_a3b99e338d92a91c8b3f89d32d0ca2c39}{array\_prod}}(\mbox{\hyperlink{struct_eigen_1_1internal_1_1evaluator}{evaluator}}.dimensions());}
\DoxyCodeLine{00061\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ PacketSize\ =\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1unpacket__traits}{unpacket\_traits<typename\ TensorEvaluator<Expression,\ DefaultDevice>::PacketReturnType}}>\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{::size}};}
\DoxyCodeLine{00062\ \ \ \ \ \ \ \textcolor{comment}{//\ Give\ the\ compiler\ a\ strong\ hint\ to\ unroll\ the\ loop.\ But\ don't\ insist}}
\DoxyCodeLine{00063\ \ \ \ \ \ \ \textcolor{comment}{//\ on\ unrolling,\ because\ if\ the\ function\ is\ expensive\ the\ compiler\ should\ not}}
\DoxyCodeLine{00064\ \ \ \ \ \ \ \textcolor{comment}{//\ unroll\ the\ loop\ at\ the\ expense\ of\ inlining.}}
\DoxyCodeLine{00065\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1internal_1_1_tensor_executor_3_01_expression_00_01_default_device_00_01true_01_4_ab79119c2d9cc171c3eba60755b5da1ce}{Index}}\ UnrolledSize\ =\ (\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}}\ /\ (4\ *\ PacketSize))\ *\ 4\ *\ PacketSize;}
\DoxyCodeLine{00066\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{class_eigen_1_1internal_1_1_tensor_executor_3_01_expression_00_01_default_device_00_01true_01_4_ab79119c2d9cc171c3eba60755b5da1ce}{Index}}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ =\ 0;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ <\ UnrolledSize;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ +=\ 4*PacketSize)\ \{}
\DoxyCodeLine{00067\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{class_eigen_1_1internal_1_1_tensor_executor_3_01_expression_00_01_default_device_00_01true_01_4_ab79119c2d9cc171c3eba60755b5da1ce}{Index}}\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}\ =\ 0;\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}\ <\ 4;\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}++)\ \{}
\DoxyCodeLine{00068\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_eigen_1_1internal_1_1evaluator}{evaluator}}.evalPacket(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ +\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}\ *\ PacketSize);}
\DoxyCodeLine{00069\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00070\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00071\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1internal_1_1_tensor_executor_3_01_expression_00_01_default_device_00_01true_01_4_ab79119c2d9cc171c3eba60755b5da1ce}{Index}}\ VectorizedSize\ =\ (\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}}\ /\ PacketSize)\ *\ PacketSize;}
\DoxyCodeLine{00072\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{class_eigen_1_1internal_1_1_tensor_executor_3_01_expression_00_01_default_device_00_01true_01_4_ab79119c2d9cc171c3eba60755b5da1ce}{Index}}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ =\ UnrolledSize;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ <\ VectorizedSize;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ +=\ PacketSize)\ \{}
\DoxyCodeLine{00073\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_eigen_1_1internal_1_1evaluator}{evaluator}}.evalPacket(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}});}
\DoxyCodeLine{00074\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00075\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{class_eigen_1_1internal_1_1_tensor_executor_3_01_expression_00_01_default_device_00_01true_01_4_ab79119c2d9cc171c3eba60755b5da1ce}{Index}}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ =\ VectorizedSize;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ <\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}};\ ++\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ \{}
\DoxyCodeLine{00076\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_eigen_1_1internal_1_1evaluator}{evaluator}}.evalScalar(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}});}
\DoxyCodeLine{00077\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00078\ \ \ \ \ \}}
\DoxyCodeLine{00079\ \ \ \ \ \mbox{\hyperlink{struct_eigen_1_1internal_1_1evaluator}{evaluator}}.cleanup();}
\DoxyCodeLine{00080\ \ \ \}}
\DoxyCodeLine{00081\ \};}
\DoxyCodeLine{00082\ }
\DoxyCodeLine{00083\ }
\DoxyCodeLine{00084\ }
\DoxyCodeLine{00085\ \textcolor{comment}{//\ Multicore\ strategy:\ the\ index\ space\ is\ partitioned\ and\ each\ partition\ is\ executed\ on\ a\ single\ core}}
\DoxyCodeLine{00086\ \textcolor{preprocessor}{\#ifdef\ EIGEN\_USE\_THREADS}}
\DoxyCodeLine{00087\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Evaluator,\ \textcolor{keyword}{typename}\ Index,\ \textcolor{keywordtype}{bool}\ Vectorizable>}
\DoxyCodeLine{00088\ \textcolor{keyword}{struct\ }EvalRange\ \{}
\DoxyCodeLine{00089\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{poisson_8cpp_ae12af222b820baf64e953be588c5bbbe}{run}}(Evaluator*\ evaluator\_in,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ first,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ last)\ \{}
\DoxyCodeLine{00090\ \ \ \ \ Evaluator\ evaluator\ =\ *evaluator\_in;}
\DoxyCodeLine{00091\ \ \ \ \ \mbox{\hyperlink{eigen-3_83_87_2_eigen_2src_2_core_2util_2_macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(last\ >=\ first);}
\DoxyCodeLine{00092\ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ =\ first;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ <\ last;\ ++\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ \{}
\DoxyCodeLine{00093\ \ \ \ \ \ \ evaluator.evalScalar(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}});}
\DoxyCodeLine{00094\ \ \ \ \ \}}
\DoxyCodeLine{00095\ \ \ \}}
\DoxyCodeLine{00096\ }
\DoxyCodeLine{00097\ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ alignBlockSize(Index\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}})\ \{}
\DoxyCodeLine{00098\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}};}
\DoxyCodeLine{00099\ \ \ \}}
\DoxyCodeLine{00100\ \};}
\DoxyCodeLine{00101\ }
\DoxyCodeLine{00102\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Evaluator,\ \textcolor{keyword}{typename}\ Index>}
\DoxyCodeLine{00103\ \textcolor{keyword}{struct\ }EvalRange<Evaluator,\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1traits}{Index}},\ \mbox{\hyperlink{yyjson_8h_a41f9c5fb8b08eb5dc3edce4dcb37fee7}{true}}>\ \{}
\DoxyCodeLine{00104\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ PacketSize\ =\ unpacket\_traits<typename\ Evaluator::PacketReturnType>::size;}
\DoxyCodeLine{00105\ }
\DoxyCodeLine{00106\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{poisson_8cpp_ae12af222b820baf64e953be588c5bbbe}{run}}(Evaluator*\ evaluator\_in,\ \textcolor{keyword}{const}\ Index\ first,\ \textcolor{keyword}{const}\ Index\ last)\ \{}
\DoxyCodeLine{00107\ \ \ \ \ Evaluator\ evaluator\ =\ *evaluator\_in;}
\DoxyCodeLine{00108\ \ \ \ \ \mbox{\hyperlink{eigen-3_83_87_2_eigen_2src_2_core_2util_2_macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(last\ >=\ first);}
\DoxyCodeLine{00109\ \ \ \ \ \mbox{\hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ =\ \mbox{\hyperlink{namespacedetail_a02319a3deb124802b88b61f85987df5e}{first}};}
\DoxyCodeLine{00110\ \ \ \ \ \textcolor{keywordflow}{if}\ (last\ -\/\ first\ >=\ PacketSize)\ \{}
\DoxyCodeLine{00111\ \ \ \ \ \ \ \mbox{\hyperlink{eigen-3_83_87_2_eigen_2src_2_core_2util_2_macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(first\ \%\ PacketSize\ ==\ 0);}
\DoxyCodeLine{00112\ \ \ \ \ \ \ \mbox{\hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ last\_chunk\_offset\ =\ \mbox{\hyperlink{namespacetbb_1_1internal_a18405c9631e7064d3af5662f30a84dd2}{last}}\ -\/\ 4\ *\ PacketSize;}
\DoxyCodeLine{00113\ \ \ \ \ \ \ \textcolor{comment}{//\ Give\ the\ compiler\ a\ strong\ hint\ to\ unroll\ the\ loop.\ But\ don't\ insist}}
\DoxyCodeLine{00114\ \ \ \ \ \ \ \textcolor{comment}{//\ on\ unrolling,\ because\ if\ the\ function\ is\ expensive\ the\ compiler\ should\ not}}
\DoxyCodeLine{00115\ \ \ \ \ \ \ \textcolor{comment}{//\ unroll\ the\ loop\ at\ the\ expense\ of\ inlining.}}
\DoxyCodeLine{00116\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ <=\ last\_chunk\_offset;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ +=\ 4*PacketSize)\ \{}
\DoxyCodeLine{00117\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (Index\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}\ =\ 0;\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}\ <\ 4;\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}++)\ \{}
\DoxyCodeLine{00118\ \ \ \ \ \ \ \ \ \ \ evaluator.evalPacket(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ +\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}\ *\ PacketSize);}
\DoxyCodeLine{00119\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00120\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00121\ \ \ \ \ \ \ last\_chunk\_offset\ =\ \mbox{\hyperlink{namespacetbb_1_1internal_a18405c9631e7064d3af5662f30a84dd2}{last}}\ -\/\ PacketSize;}
\DoxyCodeLine{00122\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ <=\ last\_chunk\_offset;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ +=\ PacketSize)\ \{}
\DoxyCodeLine{00123\ \ \ \ \ \ \ \ \ evaluator.evalPacket(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}});}
\DoxyCodeLine{00124\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00125\ \ \ \ \ \}}
\DoxyCodeLine{00126\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ <\ \mbox{\hyperlink{namespacetbb_1_1internal_a18405c9631e7064d3af5662f30a84dd2}{last}};\ ++\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ \{}
\DoxyCodeLine{00127\ \ \ \ \ \ \ evaluator.evalScalar(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}});}
\DoxyCodeLine{00128\ \ \ \ \ \}}
\DoxyCodeLine{00129\ \ \ \}}
\DoxyCodeLine{00130\ }
\DoxyCodeLine{00131\ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ alignBlockSize(Index\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}})\ \{}
\DoxyCodeLine{00132\ \ \ \ \ \textcolor{comment}{//\ Align\ block\ size\ to\ packet\ size\ and\ account\ for\ unrolling\ in\ run\ above.}}
\DoxyCodeLine{00133\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}}\ >=\ 16\ *\ PacketSize)\ \{}
\DoxyCodeLine{00134\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}}\ +\ 4\ *\ PacketSize\ -\/\ 1)\ \&\ \string~(4\ *\ PacketSize\ -\/\ 1);}
\DoxyCodeLine{00135\ \ \ \ \ \}}
\DoxyCodeLine{00136\ \ \ \ \ \textcolor{comment}{//\ Aligning\ to\ 4\ *\ PacketSize\ would\ increase\ block\ size\ by\ more\ than\ 25\%.}}
\DoxyCodeLine{00137\ \ \ \ \ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}}\ +\ PacketSize\ -\/\ 1)\ \&\ \string~(PacketSize\ -\/\ 1);}
\DoxyCodeLine{00138\ \ \ \}}
\DoxyCodeLine{00139\ \};}
\DoxyCodeLine{00140\ }
\DoxyCodeLine{00141\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Expression,\ \textcolor{keywordtype}{bool}\ Vectorizable>}
\DoxyCodeLine{00142\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_eigen_1_1internal_1_1_tensor_executor}{TensorExecutor}}<Expression,\ ThreadPoolDevice,\ Vectorizable>\ \{}
\DoxyCodeLine{00143\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00144\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ Expression::Index\ \mbox{\hyperlink{class_eigen_1_1internal_1_1_tensor_executor_aae209bfff57548530837db0e6d100932}{Index}};}
\DoxyCodeLine{00145\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_eigen_1_1internal_1_1_tensor_executor_a2746f3ea9258215fe221288ec352c0bc}{run}}(\textcolor{keyword}{const}\ Expression\&\ expr,\ \textcolor{keyword}{const}\ ThreadPoolDevice\&\ device)}
\DoxyCodeLine{00146\ \ \ \{}
\DoxyCodeLine{00147\ \ \ \ \ \textcolor{keyword}{typedef}\ TensorEvaluator<Expression,\ ThreadPoolDevice>\ Evaluator;}
\DoxyCodeLine{00148\ \ \ \ \ Evaluator\ evaluator(expr,\ device);}
\DoxyCodeLine{00149\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ needs\_assign\ =\ evaluator.evalSubExprsIfNeeded(\mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}});}
\DoxyCodeLine{00150\ \ \ \ \ \textcolor{keywordflow}{if}\ (needs\_assign)}
\DoxyCodeLine{00151\ \ \ \ \ \{}
\DoxyCodeLine{00152\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1internal_1_1_tensor_executor_aae209bfff57548530837db0e6d100932}{Index}}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}}\ =\ \mbox{\hyperlink{namespace_eigen_1_1internal_a3b99e338d92a91c8b3f89d32d0ca2c39}{array\_prod}}(evaluator.dimensions());}
\DoxyCodeLine{00153\ \textcolor{preprocessor}{\#if\ !defined(EIGEN\_USE\_SIMPLE\_THREAD\_POOL)}}
\DoxyCodeLine{00154\ \ \ \ \ \ \ device.parallelFor(\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}},\ evaluator.costPerCoeff(Vectorizable),}
\DoxyCodeLine{00155\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ EvalRange<Evaluator,\ Index,\ Vectorizable>::alignBlockSize,}
\DoxyCodeLine{00156\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [\&evaluator](\mbox{\hyperlink{class_eigen_1_1internal_1_1_tensor_executor_aae209bfff57548530837db0e6d100932}{Index}}\ first,\ \mbox{\hyperlink{class_eigen_1_1internal_1_1_tensor_executor_aae209bfff57548530837db0e6d100932}{Index}}\ last)\ \{}
\DoxyCodeLine{00157\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ EvalRange<Evaluator,\ Index,\ Vectorizable>::run(\&evaluator,\ first,\ last);}
\DoxyCodeLine{00158\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{00159\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00160\ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ num\_threads\ =\ device.numThreads();}
\DoxyCodeLine{00161\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (num\_threads\ >\ 1)\ \{}
\DoxyCodeLine{00162\ \ \ \ \ \ \ \ \ num\_threads\ =\ \mbox{\hyperlink{class_eigen_1_1_tensor_cost_model_a718b68d6a884d2c862b5dc3c4c3f5ab4}{TensorCostModel<ThreadPoolDevice>::numThreads}}(}
\DoxyCodeLine{00163\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}},\ evaluator.costPerCoeff(Vectorizable),\ num\_threads);}
\DoxyCodeLine{00164\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00165\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (num\_threads\ ==\ 1)\ \{}
\DoxyCodeLine{00166\ \ \ \ \ \ \ \ \ EvalRange<Evaluator,\ Index,\ Vectorizable>::run(\&evaluator,\ 0,\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}});}
\DoxyCodeLine{00167\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00168\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1internal_1_1_tensor_executor_aae209bfff57548530837db0e6d100932}{Index}}\ PacketSize\ =\ Vectorizable\ ?\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1unpacket__traits_a5493b6385ef3a8958b09c00eed0ec26ba63cc10676eb13001d700f7bc4336f6ee}{unpacket\_traits<typename\ Evaluator::PacketReturnType>::size}}\ :\ 1;}
\DoxyCodeLine{00169\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1internal_1_1_tensor_executor_aae209bfff57548530837db0e6d100932}{Index}}\ blocksz\ =\ std::ceil<Index>(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{float}\textcolor{keyword}{>}(\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}})/num\_threads)\ +\ PacketSize\ -\/\ 1;}
\DoxyCodeLine{00170\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1internal_1_1_tensor_executor_aae209bfff57548530837db0e6d100932}{Index}}\ blocksize\ =\ \mbox{\hyperlink{namespace_eigen_1_1numext_a29d502349f2ec9897c808e65e0f96eb4}{numext::maxi<Index>}}(PacketSize,\ (blocksz\ -\/\ (blocksz\ \%\ PacketSize)));}
\DoxyCodeLine{00171\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1internal_1_1_tensor_executor_aae209bfff57548530837db0e6d100932}{Index}}\ numblocks\ =\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}}\ /\ blocksize;}
\DoxyCodeLine{00172\ }
\DoxyCodeLine{00173\ \ \ \ \ \ \ \ \ Barrier\ \mbox{\hyperlink{test__condition__variable_8h_a66a856f373cb24d6a669f2635ce27f18}{barrier}}(numblocks);}
\DoxyCodeLine{00174\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ =\ 0;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ <\ numblocks;\ ++\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ \{}
\DoxyCodeLine{00175\ \ \ \ \ \ \ \ \ \ \ device.enqueue\_with\_barrier(}
\DoxyCodeLine{00176\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\mbox{\hyperlink{test__condition__variable_8h_a66a856f373cb24d6a669f2635ce27f18}{barrier}},\ \&EvalRange<Evaluator,\ Index,\ Vectorizable>::run,}
\DoxyCodeLine{00177\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&evaluator,\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ *\ blocksize,\ (\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ +\ 1)\ *\ blocksize);}
\DoxyCodeLine{00178\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00179\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (numblocks\ *\ blocksize\ <\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}})\ \{}
\DoxyCodeLine{00180\ \ \ \ \ \ \ \ \ \ \ EvalRange<Evaluator,\ Index,\ Vectorizable>::run(}
\DoxyCodeLine{00181\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&evaluator,\ numblocks\ *\ blocksize,\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}});}
\DoxyCodeLine{00182\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00183\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{test__condition__variable_8h_a66a856f373cb24d6a669f2635ce27f18}{barrier}}.Wait();}
\DoxyCodeLine{00184\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00185\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ defined(!EIGEN\_USE\_SIMPLE\_THREAD\_POOL)}}
\DoxyCodeLine{00186\ \ \ \ \ \}}
\DoxyCodeLine{00187\ \ \ \ \ evaluator.cleanup();}
\DoxyCodeLine{00188\ \ \ \}}
\DoxyCodeLine{00189\ \};}
\DoxyCodeLine{00190\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ EIGEN\_USE\_THREADS}}
\DoxyCodeLine{00191\ }
\DoxyCodeLine{00192\ }
\DoxyCodeLine{00193\ \textcolor{comment}{//\ GPU:\ the\ evaluation\ of\ the\ expression\ is\ offloaded\ to\ a\ GPU.}}
\DoxyCodeLine{00194\ \textcolor{preprocessor}{\#if\ defined(EIGEN\_USE\_GPU)}}
\DoxyCodeLine{00195\ }
\DoxyCodeLine{00196\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Expression,\ \textcolor{keywordtype}{bool}\ Vectorizable>}
\DoxyCodeLine{00197\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_eigen_1_1internal_1_1_tensor_executor}{TensorExecutor}}<Expression,\ GpuDevice,\ Vectorizable>\ \{}
\DoxyCodeLine{00198\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00199\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ Expression::Index\ \mbox{\hyperlink{class_eigen_1_1internal_1_1_tensor_executor_aae209bfff57548530837db0e6d100932}{Index}};}
\DoxyCodeLine{00200\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_eigen_1_1internal_1_1_tensor_executor_a2746f3ea9258215fe221288ec352c0bc}{run}}(\textcolor{keyword}{const}\ Expression\&\ expr,\ \textcolor{keyword}{const}\ GpuDevice\&\ device);}
\DoxyCodeLine{00201\ \};}
\DoxyCodeLine{00202\ }
\DoxyCodeLine{00203\ }
\DoxyCodeLine{00204\ \textcolor{preprocessor}{\#if\ defined(\_\_CUDACC\_\_)}}
\DoxyCodeLine{00205\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Evaluator,\ \textcolor{keyword}{typename}\ Index,\ \textcolor{keywordtype}{bool}\ Vectorizable>}
\DoxyCodeLine{00206\ \textcolor{keyword}{struct\ }EigenMetaKernelEval\ \{}
\DoxyCodeLine{00207\ \ \ \textcolor{keyword}{static}\ \_\_device\_\_\ \mbox{\hyperlink{eigen-3_83_87_2_eigen_2src_2_core_2util_2_macros_8h_a1fdc6f94f20527c7275768d82b2eb9ce}{EIGEN\_ALWAYS\_INLINE}}}
\DoxyCodeLine{00208\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{poisson_8cpp_ae12af222b820baf64e953be588c5bbbe}{run}}(Evaluator\&\ \mbox{\hyperlink{sparse__permutations_8cpp_abf03ad46cd5db5b4eabad69a86a13a6c}{eval}},\ Index\ first,\ Index\ last,\ Index\ step\_size)\ \{}
\DoxyCodeLine{00209\ \ \ \ \ \textcolor{keywordflow}{for}\ (Index\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ =\ first;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ <\ \mbox{\hyperlink{namespacetbb_1_1internal_a18405c9631e7064d3af5662f30a84dd2}{last}};\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ +=\ step\_size)\ \{}
\DoxyCodeLine{00210\ \ \ \ \ \ \ \mbox{\hyperlink{sparse__permutations_8cpp_abf03ad46cd5db5b4eabad69a86a13a6c}{eval}}.evalScalar(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}});}
\DoxyCodeLine{00211\ \ \ \ \ \}}
\DoxyCodeLine{00212\ \ \ \}}
\DoxyCodeLine{00213\ \};}
\DoxyCodeLine{00214\ }
\DoxyCodeLine{00215\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Evaluator,\ \textcolor{keyword}{typename}\ Index>}
\DoxyCodeLine{00216\ \textcolor{keyword}{struct\ }EigenMetaKernelEval<Evaluator,\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1traits}{Index}},\ \mbox{\hyperlink{yyjson_8h_a41f9c5fb8b08eb5dc3edce4dcb37fee7}{true}}>\ \{}
\DoxyCodeLine{00217\ \ \ \textcolor{keyword}{static}\ \_\_device\_\_\ \mbox{\hyperlink{eigen-3_83_87_2_eigen_2src_2_core_2util_2_macros_8h_a1fdc6f94f20527c7275768d82b2eb9ce}{EIGEN\_ALWAYS\_INLINE}}}
\DoxyCodeLine{00218\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{poisson_8cpp_ae12af222b820baf64e953be588c5bbbe}{run}}(Evaluator\&\ \mbox{\hyperlink{sparse__permutations_8cpp_abf03ad46cd5db5b4eabad69a86a13a6c}{eval}},\ Index\ first,\ Index\ last,\ Index\ step\_size)\ \{}
\DoxyCodeLine{00219\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ PacketSize\ =\ unpacket\_traits<typename\ Evaluator::PacketReturnType>::size;}
\DoxyCodeLine{00220\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ vectorized\_size\ =\ (\mbox{\hyperlink{namespacetbb_1_1internal_a18405c9631e7064d3af5662f30a84dd2}{last}}\ /\ PacketSize)\ *\ PacketSize;}
\DoxyCodeLine{00221\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ vectorized\_step\_size\ =\ step\_size\ *\ PacketSize;}
\DoxyCodeLine{00222\ }
\DoxyCodeLine{00223\ \ \ \ \ \textcolor{comment}{//\ Use\ the\ vector\ path}}
\DoxyCodeLine{00224\ \ \ \ \ \textcolor{keywordflow}{for}\ (Index\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ =\ first\ *\ PacketSize;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ <\ vectorized\_size;}
\DoxyCodeLine{00225\ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ +=\ vectorized\_step\_size)\ \{}
\DoxyCodeLine{00226\ \ \ \ \ \ \ \mbox{\hyperlink{sparse__permutations_8cpp_abf03ad46cd5db5b4eabad69a86a13a6c}{eval}}.evalPacket(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}});}
\DoxyCodeLine{00227\ \ \ \ \ \}}
\DoxyCodeLine{00228\ \ \ \ \ \textcolor{keywordflow}{for}\ (Index\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ =\ vectorized\_size\ +\ first;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ <\ \mbox{\hyperlink{namespacetbb_1_1internal_a18405c9631e7064d3af5662f30a84dd2}{last}};\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ +=\ step\_size)\ \{}
\DoxyCodeLine{00229\ \ \ \ \ \ \ \mbox{\hyperlink{sparse__permutations_8cpp_abf03ad46cd5db5b4eabad69a86a13a6c}{eval}}.evalScalar(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}});}
\DoxyCodeLine{00230\ \ \ \ \ \}}
\DoxyCodeLine{00231\ \ \ \}}
\DoxyCodeLine{00232\ \};}
\DoxyCodeLine{00233\ }
\DoxyCodeLine{00234\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Evaluator,\ \textcolor{keyword}{typename}\ Index>}
\DoxyCodeLine{00235\ \_\_global\_\_\ \textcolor{keywordtype}{void}}
\DoxyCodeLine{00236\ \_\_launch\_bounds\_\_(1024)}
\DoxyCodeLine{00237\ EigenMetaKernel(Evaluator\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1eval}{eval}},\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1traits}{Index}}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}})\ \{}
\DoxyCodeLine{00238\ }
\DoxyCodeLine{00239\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1traits}{Index}}\ first\_index\ =\ \mbox{\hyperlink{cuda__common_8h_ab30e5f6958c9264d3c5235d463eb2b57}{blockIdx}}.x\ *\ \mbox{\hyperlink{cuda__common_8h_a1a2cdcc50d7e1505a058c5832ebe5702}{blockDim}}.x\ +\ \mbox{\hyperlink{cuda__common_8h_a0a680a9519f7aaccce02a4bb4c0a0b52}{threadIdx}}.x;}
\DoxyCodeLine{00240\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1traits}{Index}}\ step\_size\ =\ \mbox{\hyperlink{cuda__common_8h_a1a2cdcc50d7e1505a058c5832ebe5702}{blockDim}}.x\ *\ gridDim.x;}
\DoxyCodeLine{00241\ }
\DoxyCodeLine{00242\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ vectorizable\ =\ Evaluator::PacketAccess\ \&\ Evaluator::IsAligned;}
\DoxyCodeLine{00243\ \ \ EigenMetaKernelEval<Evaluator,\ Index,\ vectorizable>::run(\mbox{\hyperlink{struct_eigen_1_1internal_1_1eval}{eval}},\ first\_index,\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}},\ step\_size);}
\DoxyCodeLine{00244\ \}}
\DoxyCodeLine{00245\ }
\DoxyCodeLine{00246\ \textcolor{comment}{/*static*/}}
\DoxyCodeLine{00247\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Expression,\ \textcolor{keywordtype}{bool}\ Vectorizable>}
\DoxyCodeLine{00248\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_eigen_1_1internal_1_1_tensor_executor_a2746f3ea9258215fe221288ec352c0bc}{TensorExecutor<Expression,\ GpuDevice,\ Vectorizable>::run}}(}
\DoxyCodeLine{00249\ \ \ \ \ \textcolor{keyword}{const}\ Expression\&\ expr,\ \textcolor{keyword}{const}\ GpuDevice\&\ device)\ \{}
\DoxyCodeLine{00250\ \ \ TensorEvaluator<Expression,\ GpuDevice>\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1evaluator}{evaluator}}(expr,\ device);}
\DoxyCodeLine{00251\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ needs\_assign\ =\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1evaluator}{evaluator}}.evalSubExprsIfNeeded(\mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}});}
\DoxyCodeLine{00252\ \ \ \textcolor{keywordflow}{if}\ (needs\_assign)\ \{}
\DoxyCodeLine{00253\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{sugar_8h_a9766f5ceca5e25981858ec7384456072}{block\_size}}\ =\ device.maxCudaThreadsPerBlock();}
\DoxyCodeLine{00254\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ max\_blocks\ =\ device.getNumCudaMultiProcessors()\ *}
\DoxyCodeLine{00255\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ device.maxCudaThreadsPerMultiProcessor()\ /\ \mbox{\hyperlink{sugar_8h_a9766f5ceca5e25981858ec7384456072}{block\_size}};}
\DoxyCodeLine{00256\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1traits}{Index}}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}}\ =\ \mbox{\hyperlink{namespace_eigen_1_1internal_a3b99e338d92a91c8b3f89d32d0ca2c39}{array\_prod}}(\mbox{\hyperlink{struct_eigen_1_1internal_1_1evaluator}{evaluator}}.dimensions());}
\DoxyCodeLine{00257\ \ \ \ \ \textcolor{comment}{//\ Create\ a\ least\ one\ block\ to\ ensure\ we\ won't\ crash\ when\ tensorflow\ calls\ with\ tensors\ of\ size\ 0.}}
\DoxyCodeLine{00258\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ num\_blocks\ =\ \mbox{\hyperlink{namespace_eigen_1_1numext_a29d502349f2ec9897c808e65e0f96eb4}{numext::maxi<int>}}(\mbox{\hyperlink{namespace_eigen_1_1numext_ab3b30bf0bcfa1ad91dbec75fabb3bea0}{numext::mini<int>}}(max\_blocks,\ \mbox{\hyperlink{namespace_eigen_a13ec9832931270b80961236d30f6d2e3}{divup<int>}}(\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}},\ \mbox{\hyperlink{sugar_8h_a9766f5ceca5e25981858ec7384456072}{block\_size}})),\ 1);}
\DoxyCodeLine{00259\ }
\DoxyCodeLine{00260\ \ \ \ \ LAUNCH\_CUDA\_KERNEL(}
\DoxyCodeLine{00261\ \ \ \ \ \ \ \ \ (EigenMetaKernel<TensorEvaluator<Expression,\ GpuDevice>,\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1traits}{Index}}>),}
\DoxyCodeLine{00262\ \ \ \ \ \ \ \ \ num\_blocks,\ \mbox{\hyperlink{sugar_8h_a9766f5ceca5e25981858ec7384456072}{block\_size}},\ 0,\ device,\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1evaluator}{evaluator}},\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}});}
\DoxyCodeLine{00263\ \ \ \}}
\DoxyCodeLine{00264\ \ \ \mbox{\hyperlink{struct_eigen_1_1internal_1_1evaluator}{evaluator}}.cleanup();}
\DoxyCodeLine{00265\ \}}
\DoxyCodeLine{00266\ }
\DoxyCodeLine{00267\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ \_\_CUDACC\_\_}}
\DoxyCodeLine{00268\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ EIGEN\_USE\_GPU}}
\DoxyCodeLine{00269\ }
\DoxyCodeLine{00270\ \textcolor{comment}{//\ SYCL\ Executor\ policy}}
\DoxyCodeLine{00271\ \textcolor{preprocessor}{\#ifdef\ EIGEN\_USE\_SYCL}}
\DoxyCodeLine{00272\ }
\DoxyCodeLine{00273\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Expression,\ \textcolor{keywordtype}{bool}\ Vectorizable>}
\DoxyCodeLine{00274\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_eigen_1_1internal_1_1_tensor_executor}{TensorExecutor}}<Expression,\ SyclDevice,\ Vectorizable>\ \{}
\DoxyCodeLine{00275\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00276\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_eigen_1_1internal_1_1_tensor_executor_a2746f3ea9258215fe221288ec352c0bc}{run}}(\textcolor{keyword}{const}\ Expression\ \&expr,\ \textcolor{keyword}{const}\ SyclDevice\ \&device)\ \{}
\DoxyCodeLine{00277\ \ \ \ \ \textcolor{comment}{//\ call\ TensorSYCL\ module}}
\DoxyCodeLine{00278\ \ \ \ \ \mbox{\hyperlink{namespace_eigen_1_1_tensor_sycl_a789ef14500d782279cc4bb95e6ba3dbd}{TensorSycl::run}}(expr,\ device);}
\DoxyCodeLine{00279\ \ \ \}}
\DoxyCodeLine{00280\ \};}
\DoxyCodeLine{00281\ }
\DoxyCodeLine{00282\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00283\ }
\DoxyCodeLine{00284\ \}\ \textcolor{comment}{//\ end\ namespace\ internal}}
\DoxyCodeLine{00285\ }
\DoxyCodeLine{00286\ \}\ \textcolor{comment}{//\ end\ namespace\ Eigen}}
\DoxyCodeLine{00287\ }
\DoxyCodeLine{00288\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ EIGEN\_CXX11\_TENSOR\_TENSOR\_EXECUTOR\_H}}

\end{DoxyCode}
