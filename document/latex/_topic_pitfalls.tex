\doxysubsection{Common pitfalls}
\hypertarget{_topic_pitfalls}{}\label{_topic_pitfalls}\index{Common pitfalls@{Common pitfalls}}
\hypertarget{_topic_pitfalls_TopicPitfalls_template_keyword}{}\doxysubsubsection{\texorpdfstring{Compilation error with template methods}{Compilation error with template methods}}\label{_topic_pitfalls_TopicPitfalls_template_keyword}
See this \doxylink{_topic_template_keyword}{page }.\hypertarget{_topic_pitfalls_TopicPitfalls_aliasing}{}\doxysubsubsection{\texorpdfstring{Aliasing}{Aliasing}}\label{_topic_pitfalls_TopicPitfalls_aliasing}
Don\textquotesingle{}t miss this \doxylink{group___topic_aliasing}{page } on aliasing, especially if you got wrong results in statements where the destination appears on the right hand side of the expression.\hypertarget{_topic_pitfalls_TopicPitfalls_auto_keyword}{}\doxysubsubsection{\texorpdfstring{C++11 and the auto keyword}{C++11 and the auto keyword}}\label{_topic_pitfalls_TopicPitfalls_auto_keyword}
In short\+: do not use the auto keywords with \doxylink{namespace_eigen}{Eigen}\textquotesingle{}s expressions, unless you are 100\% sure about what you are doing. In particular, do not use the auto keyword as a replacement for a \doxylink{class_eigen_1_1_matrix}{Matrix$<$$>$} type. Here is an example\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{MatrixXd\ \mbox{\hyperlink{bench__gemm_8cpp_addc86e8508f14411ec98f521c520f875}{A}},\ \mbox{\hyperlink{bench__gemm_8cpp_a37a83060ac796961b44991c836f083f7}{B}};}
\DoxyCodeLine{\textcolor{keyword}{auto}\ \mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}}\ =\ \mbox{\hyperlink{bench__gemm_8cpp_addc86e8508f14411ec98f521c520f875}{A}}*\mbox{\hyperlink{bench__gemm_8cpp_a37a83060ac796961b44991c836f083f7}{B}};}
\DoxyCodeLine{\textcolor{keywordflow}{for}(...)\ \{\ ...\ \mbox{\hyperlink{_matrix__resize__int_8cpp_aab236ce080522c9832217fd5f157541b}{w}}\ =\ \mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}}\ *\ \mbox{\hyperlink{_cwise__arg_8cpp_a49bb5a0db288a22a099643d44c5abbd6}{v}};\ \ ...\}}

\end{DoxyCode}


In this example, the type of C is not a Matrix\+Xd but an abstract expression representing a matrix product and storing references to \doxylink{bench__gemm_8cpp_addc86e8508f14411ec98f521c520f875}{A} and \doxylink{bench__gemm_8cpp_a37a83060ac796961b44991c836f083f7}{B}. Therefore, the product of A\texorpdfstring{$\ast$}{*}B will be carried out multiple times, once per iteration of the for loop. Moreover, if the coefficients of \doxylink{bench__gemm_8cpp_addc86e8508f14411ec98f521c520f875}{A} or \doxylink{bench__gemm_8cpp_a37a83060ac796961b44991c836f083f7}{B} change during the iteration, then C will evaluate to different values.

Here is another example leading to a segfault\+: 
\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{keyword}{auto}\ \mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}}\ =\ ((\mbox{\hyperlink{bench__gemm_8cpp_addc86e8508f14411ec98f521c520f875}{A}}+\mbox{\hyperlink{bench__gemm_8cpp_a37a83060ac796961b44991c836f083f7}{B}}).eval()).transpose();}
\DoxyCodeLine{\textcolor{comment}{//\ do\ something\ with\ C}}

\end{DoxyCode}
 The problem is that \doxylink{sparse__permutations_8cpp_abf03ad46cd5db5b4eabad69a86a13a6c}{eval()} returns a temporary object (in this case a Matrix\+Xd) which is then referenced by the \doxylink{class_eigen_1_1_transpose}{Transpose$<$$>$} expression. However, this temporary is deleted right after the first line, and there the C expression reference a dead object. The same issue might occur when sub expressions are automatically evaluated by \doxylink{namespace_eigen}{Eigen} as in the following example\+: 
\begin{DoxyCode}{0}
\DoxyCodeLine{VectorXd\ \mbox{\hyperlink{external_2taskflow_23rd-party_2tbb_2examples_2parallel__for_2seismic_2main_8cpp_a2a671aca47b8db55cef1dd7174adad6f}{u}},\ \mbox{\hyperlink{_cwise__arg_8cpp_a49bb5a0db288a22a099643d44c5abbd6}{v}};}
\DoxyCodeLine{\textcolor{keyword}{auto}\ \mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}}\ =\ \mbox{\hyperlink{external_2taskflow_23rd-party_2tbb_2examples_2parallel__for_2seismic_2main_8cpp_a2a671aca47b8db55cef1dd7174adad6f}{u}}\ +\ (\mbox{\hyperlink{bench__gemm_8cpp_addc86e8508f14411ec98f521c520f875}{A}}*\mbox{\hyperlink{_cwise__arg_8cpp_a49bb5a0db288a22a099643d44c5abbd6}{v}}).\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a991495bc19f64c176dd83a350b8b1c88}{normalized}}();}
\DoxyCodeLine{\textcolor{comment}{//\ do\ something\ with\ C}}

\end{DoxyCode}
 where the \doxylink{imgui__impl__opengl3__loader_8h_a991495bc19f64c176dd83a350b8b1c88}{normalized()} method has to evaluate the expensive product A\texorpdfstring{$\ast$}{*}v to avoid evaluating it twice. On the other hand, the following example is perfectly fine\+: 
\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{keyword}{auto}\ \mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}}\ =\ (\mbox{\hyperlink{external_2taskflow_23rd-party_2tbb_2examples_2parallel__for_2seismic_2main_8cpp_a2a671aca47b8db55cef1dd7174adad6f}{u}}\ +\ (\mbox{\hyperlink{bench__gemm_8cpp_addc86e8508f14411ec98f521c520f875}{A}}*\mbox{\hyperlink{_cwise__arg_8cpp_a49bb5a0db288a22a099643d44c5abbd6}{v}}).normalized()).eval();}

\end{DoxyCode}
 In this case, C will be a regular Vector\+Xd object. 