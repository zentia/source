\doxysection{String\+Converter.\+hpp}
\hypertarget{_string_converter_8hpp_source}{}\label{_string_converter_8hpp_source}\index{external/reflect-\/cpp/include/rfl/internal/enums/StringConverter.hpp@{external/reflect-\/cpp/include/rfl/internal/enums/StringConverter.hpp}}
\mbox{\hyperlink{_string_converter_8hpp}{浏览该文件的文档.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#ifndef\ RFL\_INTERNAL\_ENUMS\_STRINGCONVERTER\_HPP\_}}
\DoxyCodeLine{00002\ \textcolor{preprocessor}{\#define\ RFL\_INTERNAL\_ENUMS\_STRINGCONVERTER\_HPP\_}}
\DoxyCodeLine{00003\ }
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#include\ <algorithm>}}
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#include\ <array>}}
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#include\ <string>}}
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#include\ <string\_view>}}
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#include\ <type\_traits>}}
\DoxyCodeLine{00009\ }
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{_result_8hpp}{../../Result.hpp}}"{}}}
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{strings_8hpp}{../../internal/strings/strings.hpp}}"{}}}
\DoxyCodeLine{00012\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{type__name__t_8hpp}{../../type\_name\_t.hpp}}"{}}}
\DoxyCodeLine{00013\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{get__enum__names_8hpp}{get\_enum\_names.hpp}}"{}}}
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{is__flag__enum_8hpp}{is\_flag\_enum.hpp}}"{}}}
\DoxyCodeLine{00015\ }
\DoxyCodeLine{00016\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespacerfl}{rfl}}\ ::\mbox{\hyperlink{namespaceinternal}{internal}}\ \mbox{\hyperlink{namespaceenums}{::enums}}\ \{}
\DoxyCodeLine{00017\ }
\DoxyCodeLine{00018\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ EnumType>}
\DoxyCodeLine{00019\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classrfl_01_1_1internal_01_1_1enums_1_1_string_converter}{StringConverter}}\ \{}
\DoxyCodeLine{00020\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00021\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classrfl_01_1_1internal_01_1_1enums_1_1_string_converter_a180c547ef86783e0b50d73566154a7b4}{is\_flag\_enum\_}}\ =\ is\_flag\_enum<EnumType>;}
\DoxyCodeLine{00022\ }
\DoxyCodeLine{00023\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ \textcolor{keyword}{auto}\ \mbox{\hyperlink{classrfl_01_1_1internal_01_1_1enums_1_1_string_converter_a6e26f28b9e5b0184cd05ab0b59d4635a}{names\_}}\ =\ get\_enum\_names<EnumType,\ is\_flag\_enum\_>();}
\DoxyCodeLine{00024\ }
\DoxyCodeLine{00025\ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{classrfl_01_1_1internal_01_1_1enums_1_1_string_converter_ad9aa0ca630348cce5879bff9aac3910d}{NamesLiteral}}\ =\ \textcolor{keyword}{typename}\ \textcolor{keyword}{decltype}(\mbox{\hyperlink{classrfl_01_1_1internal_01_1_1enums_1_1_string_converter_a6e26f28b9e5b0184cd05ab0b59d4635a}{names\_}})::Literal;}
\DoxyCodeLine{00026\ }
\DoxyCodeLine{00027\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00029\ \ \ \textcolor{keyword}{static}\ std::string\ \mbox{\hyperlink{classrfl_01_1_1internal_01_1_1enums_1_1_string_converter_ad37434066bb198a216065278cdd512a9}{enum\_to\_string}}(\textcolor{keyword}{const}\ EnumType\ \_enum)\ \{}
\DoxyCodeLine{00030\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (\mbox{\hyperlink{classrfl_01_1_1internal_01_1_1enums_1_1_string_converter_a180c547ef86783e0b50d73566154a7b4}{is\_flag\_enum\_}})\ \{}
\DoxyCodeLine{00031\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classrfl_01_1_1internal_01_1_1enums_1_1_string_converter_ad091ddd603001801717d46d9cd679fbe}{flag\_enum\_to\_string}}(\_enum);}
\DoxyCodeLine{00032\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00033\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classrfl_01_1_1internal_01_1_1enums_1_1_string_converter_af95eadc8c8bab430e88b17d987a7ed7d}{enum\_to\_single\_string}}(\_enum);}
\DoxyCodeLine{00034\ \ \ \ \ \}}
\DoxyCodeLine{00035\ \ \ \}}
\DoxyCodeLine{00036\ }
\DoxyCodeLine{00038\ \ \ \textcolor{keyword}{static}\ Result<EnumType>\ \mbox{\hyperlink{classrfl_01_1_1internal_01_1_1enums_1_1_string_converter_a2a7acb9952a7ae96da562ca64d9dc986}{string\_to\_enum}}(\textcolor{keyword}{const}\ std::string\&\ \_str)\ \{}
\DoxyCodeLine{00039\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (\mbox{\hyperlink{classrfl_01_1_1internal_01_1_1enums_1_1_string_converter_a180c547ef86783e0b50d73566154a7b4}{is\_flag\_enum\_}})\ \{}
\DoxyCodeLine{00040\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classrfl_01_1_1internal_01_1_1enums_1_1_string_converter_a8e0e66f980b3e34c4f12d050623701bc}{string\_to\_flag\_enum}}(\_str);}
\DoxyCodeLine{00041\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00042\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classrfl_01_1_1internal_01_1_1enums_1_1_string_converter_a69ef6b5ca9b98d61b4eae276907dba74}{single\_string\_to\_enum}}(\_str);}
\DoxyCodeLine{00043\ \ \ \ \ \}}
\DoxyCodeLine{00044\ \ \ \}}
\DoxyCodeLine{00045\ }
\DoxyCodeLine{00046\ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00048\ \ \ \textcolor{keyword}{static}\ std::string\ \mbox{\hyperlink{classrfl_01_1_1internal_01_1_1enums_1_1_string_converter_ad091ddd603001801717d46d9cd679fbe}{flag\_enum\_to\_string}}(\textcolor{keyword}{const}\ EnumType\ \_e)\ \{}
\DoxyCodeLine{00049\ \ \ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}}\ =\ std::underlying\_type\_t<EnumType>;}
\DoxyCodeLine{00050\ \ \ \ \ \textcolor{keyword}{auto}\ val\ =\ \textcolor{keyword}{static\_cast<}\mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}}\textcolor{keyword}{>}(\_e);}
\DoxyCodeLine{00051\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ =\ 0;}
\DoxyCodeLine{00052\ \ \ \ \ std::vector<std::string>\ \mbox{\hyperlink{test__split__node_8cpp_afea5520dffc22c33fbcc0eb5f7e3d448}{flags}};}
\DoxyCodeLine{00053\ \ \ \ \ \textcolor{keywordflow}{while}\ (val\ !=\ 0)\ \{}
\DoxyCodeLine{00054\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ bit\ =\ val\ \&\ \textcolor{keyword}{static\_cast<}\mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}}\textcolor{keyword}{>}(1);}
\DoxyCodeLine{00055\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (bit\ ==\ 1)\ \{}
\DoxyCodeLine{00056\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ str\ =\ \mbox{\hyperlink{classrfl_01_1_1internal_01_1_1enums_1_1_string_converter_af95eadc8c8bab430e88b17d987a7ed7d}{enum\_to\_single\_string}}(}
\DoxyCodeLine{00057\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{static\_cast<}EnumType\textcolor{keyword}{>}(\textcolor{keyword}{static\_cast<}\mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}}\textcolor{keyword}{>}(1)\ <<\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}));}
\DoxyCodeLine{00058\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{test__split__node_8cpp_afea5520dffc22c33fbcc0eb5f7e3d448}{flags}}.emplace\_back(std::move(str));}
\DoxyCodeLine{00059\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00060\ \ \ \ \ \ \ ++\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}};}
\DoxyCodeLine{00061\ \ \ \ \ \ \ val\ >>=\ 1;}
\DoxyCodeLine{00062\ \ \ \ \ \}}
\DoxyCodeLine{00063\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacerfl_01_1_1internal_01_1_1strings_a7999dd70dfd84277ca4f388f16462680}{strings::join}}(\textcolor{stringliteral}{"{}|"{}},\ \mbox{\hyperlink{test__split__node_8cpp_afea5520dffc22c33fbcc0eb5f7e3d448}{flags}});}
\DoxyCodeLine{00064\ \ \ \}}
\DoxyCodeLine{00065\ }
\DoxyCodeLine{00068\ \ \ \textcolor{keyword}{static}\ std::string\ \mbox{\hyperlink{classrfl_01_1_1internal_01_1_1enums_1_1_string_converter_af95eadc8c8bab430e88b17d987a7ed7d}{enum\_to\_single\_string}}(\textcolor{keyword}{const}\ EnumType\ \_enum)\ \{}
\DoxyCodeLine{00069\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ to\_str\ =\ [](\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ \_l)\ \{\ \textcolor{keywordflow}{return}\ \_l.str();\ \};}
\DoxyCodeLine{00070\ }
\DoxyCodeLine{00071\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ =\ 0;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ <\ \mbox{\hyperlink{classrfl_01_1_1internal_01_1_1enums_1_1_string_converter_a6e26f28b9e5b0184cd05ab0b59d4635a}{names\_}}.size;\ ++\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ \{}
\DoxyCodeLine{00072\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classrfl_01_1_1internal_01_1_1enums_1_1_string_converter_a6e26f28b9e5b0184cd05ab0b59d4635a}{names\_}}.enums\_[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}]\ ==\ \_enum)\ \{}
\DoxyCodeLine{00073\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ NamesLiteral::from\_value(}
\DoxyCodeLine{00074\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{static\_cast<}typename\ NamesLiteral::ValueType\textcolor{keyword}{>}(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}))}
\DoxyCodeLine{00075\ \ \ \ \ \ \ \ \ \ \ \ \ .transform(to\_str)}
\DoxyCodeLine{00076\ \ \ \ \ \ \ \ \ \ \ \ \ .value();}
\DoxyCodeLine{00077\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00078\ \ \ \ \ \}}
\DoxyCodeLine{00079\ }
\DoxyCodeLine{00080\ \ \ \ \ \textcolor{keywordflow}{return}\ std::to\_string(\textcolor{keyword}{static\_cast<}std::underlying\_type\_t<EnumType>\textcolor{keyword}{>}(\_enum));}
\DoxyCodeLine{00081\ \ \ \}}
\DoxyCodeLine{00082\ }
\DoxyCodeLine{00084\ \ \ \textcolor{keyword}{static}\ EnumType\ \mbox{\hyperlink{classrfl_01_1_1internal_01_1_1enums_1_1_string_converter_a9d5738723ba54958d57fe40cf54dd9cb}{literal\_to\_enum}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classrfl_01_1_1internal_01_1_1enums_1_1_string_converter_ad9aa0ca630348cce5879bff9aac3910d}{NamesLiteral}}\ \_lit)\ \textcolor{keyword}{noexcept}\ \{}
\DoxyCodeLine{00085\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classrfl_01_1_1internal_01_1_1enums_1_1_string_converter_a6e26f28b9e5b0184cd05ab0b59d4635a}{names\_}}.enums\_[\_lit.value()];}
\DoxyCodeLine{00086\ \ \ \}}
\DoxyCodeLine{00087\ }
\DoxyCodeLine{00090\ \ \ \textcolor{keyword}{static}\ Result<EnumType>\ \mbox{\hyperlink{classrfl_01_1_1internal_01_1_1enums_1_1_string_converter_a69ef6b5ca9b98d61b4eae276907dba74}{single\_string\_to\_enum}}(\textcolor{keyword}{const}\ std::string\&\ \_str)\ \{}
\DoxyCodeLine{00091\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ \mbox{\hyperlink{offscreen_8c_a4788d82c901b9367dd5c0daff8a7616b}{r}}\ =\ NamesLiteral::from\_string(\_str).transform(\mbox{\hyperlink{classrfl_01_1_1internal_01_1_1enums_1_1_string_converter_a9d5738723ba54958d57fe40cf54dd9cb}{literal\_to\_enum}});}
\DoxyCodeLine{00092\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{offscreen_8c_a4788d82c901b9367dd5c0daff8a7616b}{r}})\ \{}
\DoxyCodeLine{00093\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{offscreen_8c_a4788d82c901b9367dd5c0daff8a7616b}{r}};}
\DoxyCodeLine{00094\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00095\ \ \ \ \ \ \ \textcolor{keywordflow}{try}\ \{}
\DoxyCodeLine{00096\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{static\_cast<}EnumType\textcolor{keyword}{>}(std::stoi(\_str));}
\DoxyCodeLine{00097\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{catch}\ (std::exception\&\ \mbox{\hyperlink{_array_cwise_unary_ops_8h_a2500b5d4f377a445cb98d3f1facfa1cf}{exp}})\ \{}
\DoxyCodeLine{00098\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ error(\mbox{\hyperlink{_array_cwise_unary_ops_8h_a2500b5d4f377a445cb98d3f1facfa1cf}{exp}}.what());}
\DoxyCodeLine{00099\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00100\ \ \ \ \ \}}
\DoxyCodeLine{00101\ \ \ \}}
\DoxyCodeLine{00102\ }
\DoxyCodeLine{00105\ \ \ \textcolor{keyword}{static}\ Result<EnumType>\ \mbox{\hyperlink{classrfl_01_1_1internal_01_1_1enums_1_1_string_converter_a8e0e66f980b3e34c4f12d050623701bc}{string\_to\_flag\_enum}}(}
\DoxyCodeLine{00106\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\&\ \_str)\ \textcolor{keyword}{noexcept}\ \{}
\DoxyCodeLine{00107\ \ \ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}}\ =\ std::underlying\_type\_t<EnumType>;}
\DoxyCodeLine{00108\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ \mbox{\hyperlink{dff__run_8cpp_a0711bc625a1e6944ca62107b5847365f}{split}}\ =\ \mbox{\hyperlink{namespacerfl_01_1_1internal_01_1_1strings_ab5a9d932c80900a8ecf11c035b0576b1}{strings::split}}(\_str,\ \textcolor{stringliteral}{"{}|"{}});}
\DoxyCodeLine{00109\ \ \ \ \ \textcolor{keyword}{auto}\ \mbox{\hyperlink{_partial_redux__count_8cpp_acbe60897559b79afc28b79b0687b5f29}{res}}\ =\ \textcolor{keyword}{static\_cast<}\mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}}\textcolor{keyword}{>}(0);}
\DoxyCodeLine{00110\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ \mbox{\hyperlink{main-override_8cpp_a1384e7608274313a9433fa573868557b}{s}}\ :\ \mbox{\hyperlink{dff__run_8cpp_a0711bc625a1e6944ca62107b5847365f}{split}})\ \{}
\DoxyCodeLine{00111\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ \mbox{\hyperlink{offscreen_8c_a4788d82c901b9367dd5c0daff8a7616b}{r}}\ =\ \mbox{\hyperlink{classrfl_01_1_1internal_01_1_1enums_1_1_string_converter_a69ef6b5ca9b98d61b4eae276907dba74}{single\_string\_to\_enum}}(\mbox{\hyperlink{main-override_8cpp_a1384e7608274313a9433fa573868557b}{s}});}
\DoxyCodeLine{00112\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{offscreen_8c_a4788d82c901b9367dd5c0daff8a7616b}{r}})\ \{}
\DoxyCodeLine{00113\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_partial_redux__count_8cpp_acbe60897559b79afc28b79b0687b5f29}{res}}\ |=\ \textcolor{keyword}{static\_cast<}\mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}}\textcolor{keyword}{>}(*r);}
\DoxyCodeLine{00114\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00115\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{offscreen_8c_a4788d82c901b9367dd5c0daff8a7616b}{r}};}
\DoxyCodeLine{00116\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00117\ \ \ \ \ \}}
\DoxyCodeLine{00118\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{static\_cast<}EnumType\textcolor{keyword}{>}(\mbox{\hyperlink{_partial_redux__count_8cpp_acbe60897559b79afc28b79b0687b5f29}{res}});}
\DoxyCodeLine{00119\ \ \ \}}
\DoxyCodeLine{00120\ \};}
\DoxyCodeLine{00121\ }
\DoxyCodeLine{00122\ \}\ \ \textcolor{comment}{//\ namespace\ rfl::internal::enums}}
\DoxyCodeLine{00123\ }
\DoxyCodeLine{00124\ \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
