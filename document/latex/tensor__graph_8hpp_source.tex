\doxysection{tensor\+\_\+graph.\+hpp}
\hypertarget{tensor__graph_8hpp_source}{}\label{tensor__graph_8hpp_source}\index{external/taskflow/sandbox/tensorframe/tensor\_graph.hpp@{external/taskflow/sandbox/tensorframe/tensor\_graph.hpp}}
\mbox{\hyperlink{tensor__graph_8hpp}{浏览该文件的文档.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00002\ }
\DoxyCodeLine{00003\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{tensor_8hpp}{tensor.hpp}}"{}}}
\DoxyCodeLine{00004\ }
\DoxyCodeLine{00005\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespacetf}{tf}}\ \{}
\DoxyCodeLine{00006\ }
\DoxyCodeLine{00007\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00008\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classtf_1_1_tensor_node_ae6d6bf731ce534313713a5be8e359dd6}{TensorNode}}\ \{}
\DoxyCodeLine{00009\ }
\DoxyCodeLine{00010\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ U>}
\DoxyCodeLine{00011\ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classtf_1_1_tensor_node_afa3f44dbdcfed47a9aadeeef017b3ca7}{TensorExpr}};}
\DoxyCodeLine{00012\ }
\DoxyCodeLine{00013\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ U>}
\DoxyCodeLine{00014\ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classtf_1_1_tensor_node_a92ca7df08d3f7ebddc58403bc8a5398e}{TensorFrame}};}
\DoxyCodeLine{00015\ }
\DoxyCodeLine{00016\ \ \ \textcolor{comment}{//using\ tensor\_t\ =\ std::variant<}}
\DoxyCodeLine{00017\ \ \ \textcolor{comment}{//\ \ std::monostate,\ \ \ \ //\ not\ yet\ assigned\ -\/\ placeholder}}
\DoxyCodeLine{00018\ \ \ \textcolor{comment}{//\ \ std::shared\_ptr<Tensor<int>>,}}
\DoxyCodeLine{00019\ \ \ \textcolor{comment}{//\ \ std::shared\_ptr<Tensor<float>>}}
\DoxyCodeLine{00020\ \ \ \textcolor{comment}{//>;}}
\DoxyCodeLine{00021\ }
\DoxyCodeLine{00022\ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structtf_1_1_tensor_node_1_1_input_abc4bd346aa7d83bec31bb63a8578bc53}{Input}}\ \{}
\DoxyCodeLine{00023\ \ \ \ \ std::shared\_ptr<Tensor<T>>\ \mbox{\hyperlink{structtf_1_1_tensor_node_1_1_input_ad991aa046ee96545f24d0ae9197467a0}{tensor}};}
\DoxyCodeLine{00024\ \ \ \ \ \mbox{\hyperlink{structtf_1_1_tensor_node_1_1_input_abc4bd346aa7d83bec31bb63a8578bc53}{Input}}(\mbox{\hyperlink{classtf_1_1_tensor}{Tensor<T>}}\&);}
\DoxyCodeLine{00025\ \ \ \};}
\DoxyCodeLine{00026\ }
\DoxyCodeLine{00027\ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structtf_1_1_tensor_node_1_1_output_ad1271f20670ef8e8c7364d9ee0b4db24}{Output}}\ \{}
\DoxyCodeLine{00028\ \ \ \ \ std::shared\_ptr<Tensor<T>>\ \mbox{\hyperlink{structtf_1_1_tensor_node_1_1_output_a89d75353b1f1eccbf1be297ac3792ec6}{tensor}};}
\DoxyCodeLine{00029\ \ \ \ \ \mbox{\hyperlink{structtf_1_1_tensor_node_1_1_output_ad1271f20670ef8e8c7364d9ee0b4db24}{Output}}(\mbox{\hyperlink{classtf_1_1_tensor}{Tensor<T>}}\&);}
\DoxyCodeLine{00030\ \ \ \};}
\DoxyCodeLine{00031\ }
\DoxyCodeLine{00032\ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structtf_1_1_tensor_node_1_1_add_a4962112963ccfbbcbff5a0ebd2300af6}{Add}}\ \{}
\DoxyCodeLine{00033\ \ \ \ \ std::shared\_ptr<Tensor<T>>\ \mbox{\hyperlink{structtf_1_1_tensor_node_1_1_add_abfe18d928e763e413851b6106779f380}{tensor}};}
\DoxyCodeLine{00034\ \ \ \ \ \mbox{\hyperlink{classtf_1_1_tensor_node_ae6d6bf731ce534313713a5be8e359dd6}{TensorNode}}*\ \mbox{\hyperlink{structtf_1_1_tensor_node_1_1_add_a7c743988068597cd74adef810f76557b}{lhs}}\ \{\textcolor{keyword}{nullptr}\};}
\DoxyCodeLine{00035\ \ \ \ \ \mbox{\hyperlink{classtf_1_1_tensor_node_ae6d6bf731ce534313713a5be8e359dd6}{TensorNode}}*\ \mbox{\hyperlink{structtf_1_1_tensor_node_1_1_add_a2f3932e3815f1e84c68fecf14d4448d4}{rhs}}\ \{\textcolor{keyword}{nullptr}\};}
\DoxyCodeLine{00036\ \ \ \ \ \mbox{\hyperlink{structtf_1_1_tensor_node_1_1_add_a4962112963ccfbbcbff5a0ebd2300af6}{Add}}(\mbox{\hyperlink{classtf_1_1_tensor_node_ae6d6bf731ce534313713a5be8e359dd6}{TensorNode}}*,\ \mbox{\hyperlink{classtf_1_1_tensor_node_ae6d6bf731ce534313713a5be8e359dd6}{TensorNode}}*);}
\DoxyCodeLine{00037\ \ \ \};}
\DoxyCodeLine{00038\ }
\DoxyCodeLine{00039\ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{classtf_1_1_tensor_node_a461b0bcd9976d4f97e352eb61dc27b06}{handle\_t}}\ =\ std::variant<}
\DoxyCodeLine{00040\ \ \ \ \ \mbox{\hyperlink{structtf_1_1_tensor_node_1_1_input}{Input}},}
\DoxyCodeLine{00041\ \ \ \ \ \mbox{\hyperlink{structtf_1_1_tensor_node_1_1_output}{Output}},}
\DoxyCodeLine{00042\ \ \ \ \ \mbox{\hyperlink{structtf_1_1_tensor_node_1_1_add}{Add}}}
\DoxyCodeLine{00043\ \ \ >;}
\DoxyCodeLine{00044\ }
\DoxyCodeLine{00045\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00046\ }
\DoxyCodeLine{00047\ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}...\ Args>}
\DoxyCodeLine{00048\ \ \ \ \ \mbox{\hyperlink{classtf_1_1_tensor_node_ae6d6bf731ce534313713a5be8e359dd6}{TensorNode}}(Args\&\&...\ \mbox{\hyperlink{tbbproxy_8cpp_acd08a6295eccfeb30c79985f047e4be5}{args}});}
\DoxyCodeLine{00049\ }
\DoxyCodeLine{00050\ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00051\ }
\DoxyCodeLine{00052\ \ \ \ \ std::string\ \mbox{\hyperlink{classtf_1_1_tensor_node_af352305f0cd945a34f9db9959a920c1e}{\_name}};}
\DoxyCodeLine{00053\ }
\DoxyCodeLine{00054\ \ \ \ \ \mbox{\hyperlink{classtf_1_1_tensor_node_a461b0bcd9976d4f97e352eb61dc27b06}{handle\_t}}\ \mbox{\hyperlink{classtf_1_1_tensor_node_adb4353b608c1d06769e3ade67dac9fd2}{\_handle}};}
\DoxyCodeLine{00055\ }
\DoxyCodeLine{00056\ \ \ \ \ std::vector<TensorNode*>\ \mbox{\hyperlink{classtf_1_1_tensor_node_a0d2328cf3b2742c1c2a3aba323874b44}{\_successors}};}
\DoxyCodeLine{00057\ \ \ \ \ std::vector<TensorNode*>\ \mbox{\hyperlink{classtf_1_1_tensor_node_a12d2a3104563049ddc8c2c55492a2b10}{\_dependents}};}
\DoxyCodeLine{00058\ }
\DoxyCodeLine{00059\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtf_1_1_tensor_node_a57c020eec427c3230c80c5be7a6aeba4}{\_precede}}(\mbox{\hyperlink{classtf_1_1_tensor_node_ae6d6bf731ce534313713a5be8e359dd6}{TensorNode}}*);}
\DoxyCodeLine{00060\ \};}
\DoxyCodeLine{00061\ }
\DoxyCodeLine{00062\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00063\ \textcolor{comment}{//\ TensorNode::Input}}
\DoxyCodeLine{00064\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00065\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00066\ \mbox{\hyperlink{structtf_1_1_tensor_node_1_1_input_abc4bd346aa7d83bec31bb63a8578bc53}{TensorNode<T>::Input::Input}}(\mbox{\hyperlink{classtf_1_1_tensor}{Tensor<T>}}\&\ in)\ :}
\DoxyCodeLine{00067\ \ \ \mbox{\hyperlink{structtf_1_1_tensor_node_1_1_input_ad991aa046ee96545f24d0ae9197467a0}{tensor}}\ \{\ \mbox{\hyperlink{namespacestd}{std}}::shared\_ptr<\mbox{\hyperlink{classtf_1_1_tensor}{Tensor}}<\mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}}>>(\&in,\ [](\mbox{\hyperlink{classtf_1_1_tensor}{Tensor}}<\mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}}>*)\{\})\ \}\ \{}
\DoxyCodeLine{00068\ \ \ \textcolor{comment}{//std::cout\ <<\ "{}input\ "{}\ <<\ in.index()\ <<\ '\(\backslash\)n';}}
\DoxyCodeLine{00069\ \}}
\DoxyCodeLine{00070\ }
\DoxyCodeLine{00071\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00072\ \textcolor{comment}{//\ TensorNode::Output}}
\DoxyCodeLine{00073\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00074\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00075\ \mbox{\hyperlink{structtf_1_1_tensor_node_1_1_output_ad1271f20670ef8e8c7364d9ee0b4db24}{TensorNode<T>::Output::Output}}(\mbox{\hyperlink{classtf_1_1_tensor}{Tensor<T>}}\&\ out)\ :}
\DoxyCodeLine{00076\ \ \ \mbox{\hyperlink{structtf_1_1_tensor_node_1_1_output_a89d75353b1f1eccbf1be297ac3792ec6}{tensor}}\ \{\ \mbox{\hyperlink{namespacestd}{std}}::shared\_ptr<\mbox{\hyperlink{classtf_1_1_tensor}{Tensor}}<\mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}}>>(\&out,\ [](\mbox{\hyperlink{classtf_1_1_tensor}{Tensor}}<\mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}}>*)\{\})\ \}\ \ \{}
\DoxyCodeLine{00077\ \ \ \textcolor{comment}{//std::cout\ <<\ "{}output\ "{}\ <<\ out.index()\ <<\ '\(\backslash\)n';}}
\DoxyCodeLine{00078\ \}}
\DoxyCodeLine{00079\ }
\DoxyCodeLine{00080\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00081\ \textcolor{comment}{//\ TensorNode::Add}}
\DoxyCodeLine{00082\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00083\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00084\ \mbox{\hyperlink{structtf_1_1_tensor_node_1_1_add_a4962112963ccfbbcbff5a0ebd2300af6}{TensorNode<T>::Add::Add}}(\mbox{\hyperlink{classtf_1_1_tensor_node_ae6d6bf731ce534313713a5be8e359dd6}{TensorNode}}*\ l,\ \mbox{\hyperlink{classtf_1_1_tensor_node_ae6d6bf731ce534313713a5be8e359dd6}{TensorNode}}*\ \mbox{\hyperlink{offscreen_8c_a4788d82c901b9367dd5c0daff8a7616b}{r}})\ :}
\DoxyCodeLine{00085\ \ \ \mbox{\hyperlink{structtf_1_1_tensor_node_1_1_add_a7c743988068597cd74adef810f76557b}{lhs}}\ \{l\},\ \mbox{\hyperlink{structtf_1_1_tensor_node_1_1_add_a2f3932e3815f1e84c68fecf14d4448d4}{rhs}}\ \{\mbox{\hyperlink{offscreen_8c_a4788d82c901b9367dd5c0daff8a7616b}{r}}\}\ \{}
\DoxyCodeLine{00086\ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}add:\ "{}}\ <<\ l\ <<\ \textcolor{charliteral}{'\ '}\ <<\ \mbox{\hyperlink{offscreen_8c_a4788d82c901b9367dd5c0daff8a7616b}{r}}\ <<\ \textcolor{charliteral}{'\(\backslash\)n'};}
\DoxyCodeLine{00087\ \}}
\DoxyCodeLine{00088\ }
\DoxyCodeLine{00089\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00090\ \textcolor{comment}{//\ TensorNode\ member\ definition}}
\DoxyCodeLine{00091\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00092\ }
\DoxyCodeLine{00093\ \textcolor{comment}{//\ Constructor}}
\DoxyCodeLine{00094\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00095\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}...\ Args>}
\DoxyCodeLine{00096\ \mbox{\hyperlink{classtf_1_1_tensor_node_ae6d6bf731ce534313713a5be8e359dd6}{TensorNode<T>::TensorNode}}(Args\&\&...\ \mbox{\hyperlink{tbbproxy_8cpp_acd08a6295eccfeb30c79985f047e4be5}{args}})\ :\ \mbox{\hyperlink{classtf_1_1_tensor_node_adb4353b608c1d06769e3ade67dac9fd2}{\_handle}}\{\mbox{\hyperlink{namespacestd}{std}}::forward<Args>(\mbox{\hyperlink{tbbproxy_8cpp_acd08a6295eccfeb30c79985f047e4be5}{args}})...\}\ \{}
\DoxyCodeLine{00097\ \}}
\DoxyCodeLine{00098\ }
\DoxyCodeLine{00099\ \textcolor{comment}{//\ Procedure:\ \_precede}}
\DoxyCodeLine{00100\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00101\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtf_1_1_tensor_node_a57c020eec427c3230c80c5be7a6aeba4}{TensorNode<T>::\_precede}}(\mbox{\hyperlink{classtf_1_1_tensor_node_ae6d6bf731ce534313713a5be8e359dd6}{TensorNode}}*\ \mbox{\hyperlink{_cwise__arg_8cpp_a49bb5a0db288a22a099643d44c5abbd6}{v}})\ \{}
\DoxyCodeLine{00102\ \ \ \mbox{\hyperlink{classtf_1_1_tensor_node_a0d2328cf3b2742c1c2a3aba323874b44}{\_successors}}.push\_back(\mbox{\hyperlink{_cwise__arg_8cpp_a49bb5a0db288a22a099643d44c5abbd6}{v}});}
\DoxyCodeLine{00103\ \ \ \mbox{\hyperlink{_cwise__arg_8cpp_a49bb5a0db288a22a099643d44c5abbd6}{v}}-\/>\_dependents.push\_back(\textcolor{keyword}{this});}
\DoxyCodeLine{00104\ \}}
\DoxyCodeLine{00105\ }
\DoxyCodeLine{00106\ \}\ \ \textcolor{comment}{//\ end\ of\ namespace\ tf\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00107\ }
\DoxyCodeLine{00108\ }
\DoxyCodeLine{00109\ }
\DoxyCodeLine{00110\ }
\DoxyCodeLine{00111\ }
\DoxyCodeLine{00112\ }
\DoxyCodeLine{00113\ }
\DoxyCodeLine{00114\ }
\DoxyCodeLine{00115\ }

\end{DoxyCode}
