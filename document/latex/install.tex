\chapter{Building and Installing}
\hypertarget{install}{}\label{install}\index{Building and Installing@{Building and Installing}}
This page describes how to set up Taskflow in your project. We will also go through the building process of unit tests and examples.\hypertarget{install_BAISupportedCompilers}{}\doxysection{\texorpdfstring{Supported Compilers}{Supported Compilers}}\label{install_BAISupportedCompilers}
To use Taskflow, you only need a compiler that supports C++17\+:

\begin{DoxyItemize}
\item GNU C++ Compiler at least v8.\+4 with -\/std=c++17 \item Clang C++ Compiler at least v6.\+0 with -\/std=c++17 \item Microsoft Visual Studio at least v15.\+7 (MSVC++ 19.\+14) \item Apple\+Clang Xcode Version at least v12.\+0 with -\/std=c++17 \item Nvidia CUDA Toolkit and Compiler (nvcc) at least v11.\+1 with -\/std=c++17 \item Intel C++ Compiler (nvcc) at least v19.\+0.\+1 with -\/std=c++17 \item Intel DPC++ Clang Compiler at least v13.\+0.\+0 with -\/std=c++17 and SYCL20\end{DoxyItemize}
Taskflow works on Linux, Windows, and Mac OS X.\hypertarget{install_BAIIntegrateTaskflowToYourProject}{}\doxysection{\texorpdfstring{Integrate Taskflow to Your Project}{Integrate Taskflow to Your Project}}\label{install_BAIIntegrateTaskflowToYourProject}
Taskflow is {\itshape header-\/only} and there is no need for installation. Simply download the source and copy the headers under the directory {\ttfamily taskflow/} to your project.


\begin{DoxyCode}{0}
\DoxyCodeLine{\{.shell-\/session\}\ }
\DoxyCodeLine{\string~\$\ git\ clone\ https:\textcolor{comment}{//github.com/taskflow/taskflow.git}}
\DoxyCodeLine{\string~\$\ cd\ \mbox{\hyperlink{poisson_8hpp_aa56fe360bb0ae38e0082f49e394ff825}{taskflow}}/}
\DoxyCodeLine{\string~\$\ cp\ -\/\mbox{\hyperlink{offscreen_8c_a4788d82c901b9367dd5c0daff8a7616b}{r}}\ \mbox{\hyperlink{poisson_8hpp_aa56fe360bb0ae38e0082f49e394ff825}{taskflow}}\ myproject/include/}

\end{DoxyCode}


Taskflow is written in C++17 and is built on top of C++ standardized threading libraries to improve portability. To compile a Taskflow program, say {\ttfamily \doxylink{simple_8cpp}{simple.\+cpp}}, you need to tell the compiler where to find the Taskflow header files and link it through the system thread library (usually \href{http://man7.org/linux/man-pages/man7/pthreads.7.html}{\texttt{ POSIX threads}} in Linux-\/like systems). Take gcc for an example\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{\{.shell-\/session\}\ }
\DoxyCodeLine{\string~\$\ \mbox{\hyperlink{offscreen_8c_a8cf17d727651616de6f2b79ef32170cd}{g}}++\ simple.cpp\ -\/\mbox{\hyperlink{namespacestd}{std}}=\mbox{\hyperlink{bench_vec_add_8cpp_a41689956983587b085f9da3e48f31d99}{c}}++17\ -\/I\ myproject/include/\ -\/O2\ -\/pthread\ -\/o\ simple}

\end{DoxyCode}
\hypertarget{install_BAIBuildExamplesAndUnitTests}{}\doxysection{\texorpdfstring{Build Examples and Unit Tests}{Build Examples and Unit Tests}}\label{install_BAIBuildExamplesAndUnitTests}
Taskflow uses CMake to build examples and unit tests. We recommend using out-\/of-\/source build.


\begin{DoxyCode}{0}
\DoxyCodeLine{\{.shell-\/session\}\ }
\DoxyCodeLine{\string~\$\ cd\ \mbox{\hyperlink{ittnotify__static_8h_a7016119bc831a22d1a351d56128518ed}{path}}/to/\mbox{\hyperlink{poisson_8hpp_aa56fe360bb0ae38e0082f49e394ff825}{taskflow}}}
\DoxyCodeLine{\string~\$\ mkdir\ \mbox{\hyperlink{namespacebuild}{build}}}
\DoxyCodeLine{\string~\$\ cd\ \mbox{\hyperlink{namespacebuild}{build}}}
\DoxyCodeLine{\string~\$\ \mbox{\hyperlink{cblat2_8f_a02c505d1046fe3c18a9f17c1f1dc6b51}{cmake}}\ ../}
\DoxyCodeLine{\string~\$\ make\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#\ compile\ all\ examples\ and\ unittests}
\DoxyCodeLine{\string~\$\ make\ \mbox{\hyperlink{external_2spine-runtimes_2spine-sfml_2c_2example_2main_8cpp_aac5f14f710620d78720c06cd063ec0ca}{test}}}
\DoxyCodeLine{}
\DoxyCodeLine{Running\ tests...}
\DoxyCodeLine{/usr/\mbox{\hyperlink{runtime_2spdlog_2include_2spdlog_2fmt_2bundled_2base_8h_adfa139c9a1902753b3696794759b2c48ac1111bd512b29e821b120b86446026b8}{bin}}/\mbox{\hyperlink{cblat1_8f_a30ed3e5ad7f9db2e542a261e1e513e8e}{ctest}}\ -\/-\/force-\/\textcolor{keyword}{new}-\/\mbox{\hyperlink{cblat1_8f_a30ed3e5ad7f9db2e542a261e1e513e8e}{ctest}}-\/process}
\DoxyCodeLine{\mbox{\hyperlink{class_test}{Test}}\ project\ /home/tsung-\/wei/Code/\mbox{\hyperlink{poisson_8hpp_aa56fe360bb0ae38e0082f49e394ff825}{taskflow}}/\mbox{\hyperlink{namespacebuild}{build}}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ Start\ \ \ 1:\ passive\_vector}
\DoxyCodeLine{\ \ 1/254\ \mbox{\hyperlink{class_test}{Test}}\ \ \ \#1:\ passive\_vector\ ...................\ \ \ Passed\ \ \ \ 0.04\ sec}
\DoxyCodeLine{\ \ \ \ \ \ \ \ Start\ \ \ 2:\ function\_traits}
\DoxyCodeLine{\ \ 2/254\ \mbox{\hyperlink{class_test}{Test}}\ \ \ \#2:\ function\_traits\ ..................\ \ \ Passed\ \ \ \ 0.00\ sec}
\DoxyCodeLine{\ \ \ \ \ \ \ \ Start\ \ \ 3:\ object\_pool.sequential}
\DoxyCodeLine{\ \ 3/254\ \mbox{\hyperlink{class_test}{Test}}\ \ \ \#3:\ object\_pool.sequential\ ...........\ \ \ Passed\ \ \ \ 0.10\ sec}
\DoxyCodeLine{...}
\DoxyCodeLine{}
\DoxyCodeLine{100\%\ tests\ passed,\ 0\ tests\ \mbox{\hyperlink{testhelper_8h_ad4ec5aab9b62fbbe9b8fc2d8ac0a5989}{failed}}\ out\ of\ 254}
\DoxyCodeLine{}
\DoxyCodeLine{Total\ \mbox{\hyperlink{class_test}{Test}}\ time\ (\mbox{\hyperlink{datatypes_8h_a1bb7bda9eb99a2427c358ecb686be221}{real}})\ =\ \ 29.67\ sec}

\end{DoxyCode}


When the building completes, you can find the executables for examples and tests under the two folders, {\ttfamily examples/} and {\ttfamily unittests/}. You can list a set of available options in the cmake.


\begin{DoxyCode}{0}
\DoxyCodeLine{\{.shell-\/session\}\ }
\DoxyCodeLine{\string~\$\ \mbox{\hyperlink{cblat2_8f_a02c505d1046fe3c18a9f17c1f1dc6b51}{cmake}}\ -\/LA}
\DoxyCodeLine{...}
\DoxyCodeLine{TF\_BUILD\_EXAMPLES:BOOL=ON\ \ \ \ \ \ \ \#\ by\ \textcolor{keywordflow}{default},\ we\ compile\ examples}
\DoxyCodeLine{TF\_BUILD\_TESTS:BOOL=ON\ \ \ \ \ \ \ \ \ \ \#\ by\ \textcolor{keywordflow}{default},\ we\ compile\ tests}
\DoxyCodeLine{TF\_BUILD\_BENCHMARKS:BOOL=OFF\ \ \ \ \#\ by\ \textcolor{keywordflow}{default},\ we\ don\textcolor{stringliteral}{'t\ compile\ benchmarks\ }}
\DoxyCodeLine{\textcolor{stringliteral}{TF\_BUILD\_CUDA:BOOL=OFF\ \ \ \ \ \ \ \ \ \ \#\ by\ default,\ we\ don'}\mbox{\hyperlink{boing_8c_a87accd1af8e0aff4b818d891374f7cec}{t}}\ compile\ CUDA\ code}
\DoxyCodeLine{...}
\DoxyCodeLine{...\ more\ \mbox{\hyperlink{options_8c_a92a8d2cc6467e45662af606615851df8}{options}}}

\end{DoxyCode}


Currently, our CMake script supports the following options\+:

 \tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{3}{|X[-1]}|}
\hline
\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ CMake Option   }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Default   }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Usage    }\\\cline{1-3}
\endfirsthead
\hline
\endfoot
\hline
\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ CMake Option   }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Default   }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Usage    }\\\cline{1-3}
\endhead
\PBS\centering TF\+\_\+\+BUILD\+\_\+\+EXAMPLES   &\PBS\centering ON   &\PBS\centering enable/disable building examples    \\\cline{1-3}
\PBS\centering TF\+\_\+\+BUILD\+\_\+\+TESTS   &\PBS\centering ON   &\PBS\centering enable/disable building unit tests    \\\cline{1-3}
\PBS\centering TF\+\_\+\+BUILD\+\_\+\+BENCHMARKS   &\PBS\centering OFF   &\PBS\centering enable/disable building benchmarks    \\\cline{1-3}
\PBS\centering TF\+\_\+\+BUILD\+\_\+\+CUDA   &\PBS\centering OFF   &\PBS\centering enable/disable building CUDA code   \\\cline{1-3}
\end{longtabu}


To enable or disable a specific option, use {\ttfamily -\/D} in the CMake build. For example\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{\{.shell-\/session\}\ }
\DoxyCodeLine{\string~\$\ \mbox{\hyperlink{cblat2_8f_a02c505d1046fe3c18a9f17c1f1dc6b51}{cmake}}\ ../\ -\/DTF\_BUILD\_EXAMPLES=OFF}

\end{DoxyCode}


The above command turns off building Taskflow examples.\hypertarget{install_BAIBuildCUDACode}{}\doxysection{\texorpdfstring{Build CUDA Examples and Unit Tests}{Build CUDA Examples and Unit Tests}}\label{install_BAIBuildCUDACode}
To build CUDA code, including unit tests and examples, enable the CMake option {\ttfamily TF\+\_\+\+BUILD\+\_\+\+CUDA} to {\ttfamily ON}. Cmake will automatically detect the existence of {\ttfamily nvcc} and use it to compile and link {\ttfamily }.cu code.


\begin{DoxyCode}{0}
\DoxyCodeLine{\{.shell-\/session\}\ }
\DoxyCodeLine{\string~\$\ \mbox{\hyperlink{cblat2_8f_a02c505d1046fe3c18a9f17c1f1dc6b51}{cmake}}\ ../\ -\/DTF\_BUILD\_CUDA=ON}
\DoxyCodeLine{\string~\$\ make}

\end{DoxyCode}


Please visit the page \doxylink{CompileTaskflowWithCUDA}{Compile Taskflow with CUDA} for details.\hypertarget{install_BAIBuildSanitizers}{}\doxysection{\texorpdfstring{Build Sanitizers}{Build Sanitizers}}\label{install_BAIBuildSanitizers}
You can build Taskflow with {\itshape sanitizers} to detect a variety of errors, such as data race, memory leak, undefined behavior, and others. To enable a sanitizer, add the sanitizer flag to the CMake variable {\ttfamily CMAKE\+\_\+\+CXX\+\_\+\+FLAGS}. The following example enables thread sanitizer in building Taskflow code to detect data race\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{\{.shell-\/session\}\ }
\DoxyCodeLine{\textcolor{preprocessor}{\#\ build\ Taskflow\ code\ with\ thread\ sanitizer\ to\ detect\ data\ race}}
\DoxyCodeLine{\string~\$\ \mbox{\hyperlink{cblat2_8f_a02c505d1046fe3c18a9f17c1f1dc6b51}{cmake}}\ ../\ -\/DCMAKE\_CXX\_FLAGS=\textcolor{stringliteral}{"{}-\/fsanitize=thread\ -\/g"{}}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{preprocessor}{\#\ build\ Taskflow\ code\ with\ address\ sanitizer\ to\ detect\ illegal\ memory\ access}}
\DoxyCodeLine{\string~\$\ \mbox{\hyperlink{cblat2_8f_a02c505d1046fe3c18a9f17c1f1dc6b51}{cmake}}\ ../\ -\/DCMAKE\_CXX\_FLAGS=\textcolor{stringliteral}{"{}-\/fsanitize=address\ -\/g"{}}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{preprocessor}{\#\ build\ Taskflow\ code\ with\ ub\ sanitizer\ to\ detect\ undefined\ behavior}}
\DoxyCodeLine{\string~\$\ \mbox{\hyperlink{cblat2_8f_a02c505d1046fe3c18a9f17c1f1dc6b51}{cmake}}\ ../\ -\/DCMAKE\_CXX\_FLAGS=\textcolor{stringliteral}{"{}-\/fsanitize=undefined\ -\/g"{}}}

\end{DoxyCode}


Our @\+CI incorporates thread sanitizer (\href{https://clang.llvm.org/docs/ThreadSanitizer.html}{\texttt{ -\/fsanitize=thread}}), address sanitizer (\href{https://clang.llvm.org/docs/AddressSanitizer.html}{\texttt{ -\/fsanitize=address}}), and leak sanitizer (\href{https://clang.llvm.org/docs/LeakSanitizer.html}{\texttt{ -\/fsanitize=leak}}) to detect data race, illegal memory address, and memory leak. To our best knowledge, Taskflow is one of the very few parallel programming libraries that are free from data race.

\begin{DoxyAttention}{注意}
Some sanitizers are supported by certain computing architectures. You can find the information about architecture support of each sanitizer at \href{https://clang.llvm.org/docs/index.html}{\texttt{ Clang Documentation}} and \href{https://gcc.gnu.org/onlinedocs/gcc/Instrumentation-Options.html}{\texttt{ GCC Instrumentation Options}}.
\end{DoxyAttention}
\hypertarget{install_BAIBuildBenchmarks}{}\doxysection{\texorpdfstring{Build Benchmarks}{Build Benchmarks}}\label{install_BAIBuildBenchmarks}
The Taskflow project contains a set of benchmarks to evaluate and compare the performance of \doxylink{classtf_1_1_taskflow}{Taskflow} with existing parallel programming libraries. To build the benchmark code, enable the CMake option {\ttfamily TF\+\_\+\+BUILD\+\_\+\+BENCHMARKS} to {\ttfamily ON} as follows\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{\{.shell-\/session\}\ }
\DoxyCodeLine{\string~\$\ \mbox{\hyperlink{cblat2_8f_a02c505d1046fe3c18a9f17c1f1dc6b51}{cmake}}\ ../\ -\/DTF\_BUILD\_BENCHMARKS=ON}
\DoxyCodeLine{\string~\$\ make}

\end{DoxyCode}


Please visit the page \doxylink{BenchmarkTaskflow}{Benchmark Taskflow} for details.\hypertarget{install_BAIBuildDocumentation}{}\doxysection{\texorpdfstring{Build Documentation}{Build Documentation}}\label{install_BAIBuildDocumentation}
Taskflow uses @\+Doxygen and @\+MCSS to generate this documentation. The source of documentation is located in the folder {\ttfamily taskflow/doxygen} and the generated html is output to the folder {\ttfamily taskflow/docs}. To generate the documentation, you need to first install doxygen\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{\{.shell-\/session\}\ }
\DoxyCodeLine{\textcolor{preprocessor}{\#\ ubuntu\ as\ an\ example}}
\DoxyCodeLine{\string~\$\ sudo\ apt-\/\mbox{\hyperlink{stdlist__overload_8cpp_a120a90058439faee14791b33f94c0693}{get}}\ install\ doxygen\ graphviz}

\end{DoxyCode}


Once you have doxygen and dot graph generator installed, clone the m.\+css project and enter the {\ttfamily m.\+css/documentation} directory\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{\{.shell-\/session\}\ }
\DoxyCodeLine{\string~\$\ git\ clone\ https:\textcolor{comment}{//github.com/mosra/m.css.git}}
\DoxyCodeLine{\string~\$\ cd\ \mbox{\hyperlink{_angle_axis__mimic__euler_8cpp_ab3cd915d758008bd19d0f2428fbb354a}{m}}.css/documentation}

\end{DoxyCode}


The script {\ttfamily doxygen.\+py} requires Python 3.\+6, depends on \href{http://jinja.pocoo.org/}{\texttt{ Jinja2}} for templating and \href{http://pygments.org/}{\texttt{ Pygments}} for code block highlighting. You can install the dependencies via {\ttfamily pip} or your distribution package manager\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{\{.shell-\/session\}\ }
\DoxyCodeLine{\textcolor{preprocessor}{\#\ You\ may\ need\ sudo\ here}}
\DoxyCodeLine{\textcolor{preprocessor}{\#\ More\ details\ are\ available\ at\ https:}\textcolor{comment}{//mcss.mosra.cz/documentation/doxygen/}}
\DoxyCodeLine{\string~\$\ pip3\ install\ jinja2\ Pygments}

\end{DoxyCode}


Next, invoke {\ttfamily doxygen.\+py} and point it to the {\ttfamily \doxylink{conf_8py}{taskflow/doxygen/conf.\+py}}\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{\{.shell-\/session\}\ }
\DoxyCodeLine{\string~\$\ ./doxygen.py\ \mbox{\hyperlink{ittnotify__static_8h_a7016119bc831a22d1a351d56128518ed}{path}}/to/\mbox{\hyperlink{poisson_8hpp_aa56fe360bb0ae38e0082f49e394ff825}{taskflow}}/doxygen/\mbox{\hyperlink{namespaceconf}{conf}}.py}

\end{DoxyCode}


You can find the documentation output in {\ttfamily taskflow/docs}. \input{_compile_taskflow_with_c_u_d_a}
\input{_benchmark_taskflow}
