\doxysection{Jacobi\+SVD.\+h}
\hypertarget{_jacobi_s_v_d_8h_source}{}\label{_jacobi_s_v_d_8h_source}\index{external/taskflow/3rd-\/party/eigen-\/3.3.7/Eigen/src/SVD/JacobiSVD.h@{external/taskflow/3rd-\/party/eigen-\/3.3.7/Eigen/src/SVD/JacobiSVD.h}}
\mbox{\hyperlink{_jacobi_s_v_d_8h}{浏览该文件的文档.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ This\ file\ is\ part\ of\ Eigen,\ a\ lightweight\ C++\ template\ library}}
\DoxyCodeLine{00002\ \textcolor{comment}{//\ for\ linear\ algebra.}}
\DoxyCodeLine{00003\ \textcolor{comment}{//}}
\DoxyCodeLine{00004\ \textcolor{comment}{//\ Copyright\ (C)\ 2009-\/2010\ Benoit\ Jacob\ <jacob.benoit.1@gmail.com>}}
\DoxyCodeLine{00005\ \textcolor{comment}{//\ Copyright\ (C)\ 2013-\/2014\ Gael\ Guennebaud\ <gael.guennebaud@inria.fr>}}
\DoxyCodeLine{00006\ \textcolor{comment}{//}}
\DoxyCodeLine{00007\ \textcolor{comment}{//\ This\ Source\ Code\ Form\ is\ subject\ to\ the\ terms\ of\ the\ Mozilla}}
\DoxyCodeLine{00008\ \textcolor{comment}{//\ Public\ License\ v.\ 2.0.\ If\ a\ copy\ of\ the\ MPL\ was\ not\ distributed}}
\DoxyCodeLine{00009\ \textcolor{comment}{//\ with\ this\ file,\ You\ can\ obtain\ one\ at\ http://mozilla.org/MPL/2.0/.}}
\DoxyCodeLine{00010\ }
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#ifndef\ EIGEN\_JACOBISVD\_H}}
\DoxyCodeLine{00012\ \textcolor{preprocessor}{\#define\ EIGEN\_JACOBISVD\_H}}
\DoxyCodeLine{00013\ }
\DoxyCodeLine{00014\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespace_eigen}{Eigen}}\ \{\ }
\DoxyCodeLine{00015\ }
\DoxyCodeLine{00016\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespace_eigen_1_1internal}{internal}}\ \{}
\DoxyCodeLine{00017\ \textcolor{comment}{//\ forward\ declaration\ (needed\ by\ ICC)}}
\DoxyCodeLine{00018\ \textcolor{comment}{//\ the\ empty\ body\ is\ required\ by\ MSVC}}
\DoxyCodeLine{00019\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1traits}{MatrixType}},\ \textcolor{keywordtype}{int}\ QRPreconditioner,}
\DoxyCodeLine{00020\ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{external_2taskflow_23rd-party_2eigen-3_83_87_2blas_2common_8h_aa430eede2197cbd34a7082f8fca83cd4a66d6dc5b929fc072f7dce7fdab0ee378}{IsComplex}}\ =\ \mbox{\hyperlink{struct_eigen_1_1_generic_num_traits_a4a7b16effb0b7df2ab247e4df795dd3eadf2f66fe13a7f838f9984a31fea52b61}{NumTraits<typename\ MatrixType::Scalar>::IsComplex}}>}
\DoxyCodeLine{00021\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_eigen_1_1internal_1_1svd__precondition__2x2__block__to__be__real}{svd\_precondition\_2x2\_block\_to\_be\_real}}\ \{\};}
\DoxyCodeLine{00022\ }
\DoxyCodeLine{00023\ \textcolor{comment}{/***\ QR\ preconditioners\ (R-\/SVD)}}
\DoxyCodeLine{00024\ \textcolor{comment}{\ ***}}
\DoxyCodeLine{00025\ \textcolor{comment}{\ ***\ Their\ role\ is\ to\ reduce\ the\ problem\ of\ computing\ the\ SVD\ to\ the\ case\ of\ a\ square\ matrix.}}
\DoxyCodeLine{00026\ \textcolor{comment}{\ ***\ This\ approach,\ known\ as\ R-\/SVD,\ is\ an\ optimization\ for\ rectangular-\/enough\ matrices,\ and\ is\ a\ requirement\ for}}
\DoxyCodeLine{00027\ \textcolor{comment}{\ ***\ JacobiSVD\ which\ by\ itself\ is\ only\ able\ to\ work\ on\ square\ matrices.}}
\DoxyCodeLine{00028\ \textcolor{comment}{\ ***/}}
\DoxyCodeLine{00029\ }
\DoxyCodeLine{00030\ \textcolor{keyword}{enum}\ \{\ \mbox{\hyperlink{namespace_eigen_1_1internal_ab45d1a34d0816cbc15002d2e58fd37d0adfa337668e3d39e7dd721825902eba87}{PreconditionIfMoreColsThanRows}},\ \mbox{\hyperlink{namespace_eigen_1_1internal_ab45d1a34d0816cbc15002d2e58fd37d0af43dd09c4617ed9311811a15db114b62}{PreconditionIfMoreRowsThanCols}}\ \};}
\DoxyCodeLine{00031\ }
\DoxyCodeLine{00032\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ MatrixType,\ \textcolor{keywordtype}{int}\ QRPreconditioner,\ \textcolor{keywordtype}{int}\ Case>}
\DoxyCodeLine{00033\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_eigen_1_1internal_1_1qr__preconditioner__should__do__anything}{qr\_preconditioner\_should\_do\_anything}}}
\DoxyCodeLine{00034\ \{}
\DoxyCodeLine{00035\ \ \ \textcolor{keyword}{enum}\ \{\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1qr__preconditioner__should__do__anything_a4ba6f0b7cc0c8f02d1a8a42b430b5c14af265d032f57f5a14e17b876a8e258924}{a}}\ =\ MatrixType::RowsAtCompileTime\ !=\ \mbox{\hyperlink{namespace_eigen_ad81fa7195215a0ce30017dfac309f0b2}{Dynamic}}\ \&\&}
\DoxyCodeLine{00036\ \ \ \ \ \ \ \ \ \ \ \ \ \ MatrixType::ColsAtCompileTime\ !=\ \mbox{\hyperlink{namespace_eigen_ad81fa7195215a0ce30017dfac309f0b2}{Dynamic}}\ \&\&}
\DoxyCodeLine{00037\ \ \ \ \ \ \ \ \ \ \ \ \ \ MatrixType::ColsAtCompileTime\ <=\ MatrixType::RowsAtCompileTime,}
\DoxyCodeLine{00038\ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_eigen_1_1internal_1_1qr__preconditioner__should__do__anything_a4ba6f0b7cc0c8f02d1a8a42b430b5c14af495dc5a2ec09073600f910fc589aecb}{b}}\ =\ MatrixType::RowsAtCompileTime\ !=\ \mbox{\hyperlink{namespace_eigen_ad81fa7195215a0ce30017dfac309f0b2}{Dynamic}}\ \&\&}
\DoxyCodeLine{00039\ \ \ \ \ \ \ \ \ \ \ \ \ \ MatrixType::ColsAtCompileTime\ !=\ \mbox{\hyperlink{namespace_eigen_ad81fa7195215a0ce30017dfac309f0b2}{Dynamic}}\ \&\&}
\DoxyCodeLine{00040\ \ \ \ \ \ \ \ \ \ \ \ \ \ MatrixType::RowsAtCompileTime\ <=\ MatrixType::ColsAtCompileTime,}
\DoxyCodeLine{00041\ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_eigen_1_1internal_1_1qr__preconditioner__should__do__anything_a4ba6f0b7cc0c8f02d1a8a42b430b5c14a4e2ea80561bf08f28cb79e8c4e4a32f4}{ret}}\ =\ !(\ (QRPreconditioner\ ==\ \mbox{\hyperlink{group__enums_gga46eba0d5c621f590b8cf1b53af31d56ea2e95bc818f975b19def01e93d240dece}{NoQRPreconditioner}})\ ||}
\DoxyCodeLine{00042\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (Case\ ==\ \mbox{\hyperlink{namespace_eigen_1_1internal_ab45d1a34d0816cbc15002d2e58fd37d0adfa337668e3d39e7dd721825902eba87}{PreconditionIfMoreColsThanRows}}\ \&\&\ \mbox{\hyperlink{sugar_8h_abb452686968e48b67397da5f97445f5b}{bool}}(\mbox{\hyperlink{struct_eigen_1_1internal_1_1qr__preconditioner__should__do__anything_a4ba6f0b7cc0c8f02d1a8a42b430b5c14af265d032f57f5a14e17b876a8e258924}{a}}))\ ||}
\DoxyCodeLine{00043\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (Case\ ==\ \mbox{\hyperlink{namespace_eigen_1_1internal_ab45d1a34d0816cbc15002d2e58fd37d0af43dd09c4617ed9311811a15db114b62}{PreconditionIfMoreRowsThanCols}}\ \&\&\ \mbox{\hyperlink{sugar_8h_abb452686968e48b67397da5f97445f5b}{bool}}(\mbox{\hyperlink{struct_eigen_1_1internal_1_1qr__preconditioner__should__do__anything_a4ba6f0b7cc0c8f02d1a8a42b430b5c14af495dc5a2ec09073600f910fc589aecb}{b}}))\ )}
\DoxyCodeLine{00044\ \ \ \};}
\DoxyCodeLine{00045\ \};}
\DoxyCodeLine{00046\ }
\DoxyCodeLine{00047\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ \mbox{\hyperlink{class_eigen_1_1_transform}{MatrixType}},\ \textcolor{keywordtype}{int}\ QRPreconditioner,\ \textcolor{keywordtype}{int}\ Case,}
\DoxyCodeLine{00048\ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ DoAnything\ =\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1qr__preconditioner__should__do__anything_a4ba6f0b7cc0c8f02d1a8a42b430b5c14a4e2ea80561bf08f28cb79e8c4e4a32f4}{qr\_preconditioner\_should\_do\_anything<MatrixType,\ QRPreconditioner,\ Case>::ret}}}
\DoxyCodeLine{00049\ >\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_eigen_1_1internal_1_1qr__preconditioner__impl}{qr\_preconditioner\_impl}}\ \{\};}
\DoxyCodeLine{00050\ }
\DoxyCodeLine{00051\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ MatrixType,\ \textcolor{keywordtype}{int}\ QRPreconditioner,\ \textcolor{keywordtype}{int}\ Case>}
\DoxyCodeLine{00052\ \textcolor{keyword}{class\ }\mbox{\hyperlink{struct_eigen_1_1internal_1_1qr__preconditioner__impl}{qr\_preconditioner\_impl}}<\mbox{\hyperlink{struct_eigen_1_1internal_1_1traits}{MatrixType}},\ QRPreconditioner,\ Case,\ \mbox{\hyperlink{yyjson_8h_a65e9886d74aaee76545e83dd09011727}{false}}>}
\DoxyCodeLine{00053\ \{}
\DoxyCodeLine{00054\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00055\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_q_r_preconditioner_00_01_case_00_01false_01_4_a01b0ec87576066bf204beaadddf9a8a0}{allocate}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d}{JacobiSVD<MatrixType,\ QRPreconditioner>}}\&)\ \{\}}
\DoxyCodeLine{00056\ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_q_r_preconditioner_00_01_case_00_01false_01_4_abeec41257bdf659db9940e51544c4073}{run}}(\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d}{JacobiSVD<MatrixType,\ QRPreconditioner>}}\&,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1traits}{MatrixType}}\&)}
\DoxyCodeLine{00057\ \ \ \{}
\DoxyCodeLine{00058\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00059\ \ \ \}}
\DoxyCodeLine{00060\ \};}
\DoxyCodeLine{00061\ }
\DoxyCodeLine{00062\ \textcolor{comment}{/***\ preconditioner\ using\ FullPivHouseholderQR\ ***/}}
\DoxyCodeLine{00063\ }
\DoxyCodeLine{00064\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ MatrixType>}
\DoxyCodeLine{00065\ \textcolor{keyword}{class\ }\mbox{\hyperlink{struct_eigen_1_1internal_1_1qr__preconditioner__impl}{qr\_preconditioner\_impl}}<\mbox{\hyperlink{struct_eigen_1_1internal_1_1traits}{MatrixType}},\ \mbox{\hyperlink{group__enums_gga46eba0d5c621f590b8cf1b53af31d56eabd745dcaff7019c5f918c68809e5ea50}{FullPivHouseholderQRPreconditioner}},\ \mbox{\hyperlink{namespace_eigen_1_1internal_ab45d1a34d0816cbc15002d2e58fd37d0af43dd09c4617ed9311811a15db114b62}{PreconditionIfMoreRowsThanCols}},\ \mbox{\hyperlink{yyjson_8h_a41f9c5fb8b08eb5dc3edce4dcb37fee7}{true}}>}
\DoxyCodeLine{00066\ \{}
\DoxyCodeLine{00067\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00068\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ MatrixType::Scalar\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_full_piv_householder_b68efcf0da0383d73ce7fb20aafa2293_a6598c76a30eba4be4175fd6024520646}{Scalar}};}
\DoxyCodeLine{00069\ \ \ \textcolor{keyword}{enum}}
\DoxyCodeLine{00070\ \ \ \{}
\DoxyCodeLine{00071\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_full_piv_householder_b68efcf0da0383d73ce7fb20aafa2293_af3f2df141f745b0fc4f2a088aac7a6d5ac04646de84f44a8376e8c5fa64922112}{RowsAtCompileTime}}\ =\ MatrixType::RowsAtCompileTime,}
\DoxyCodeLine{00072\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_full_piv_householder_b68efcf0da0383d73ce7fb20aafa2293_af3f2df141f745b0fc4f2a088aac7a6d5afe974d81c81f824bd0e4a51c62028ba6}{MaxRowsAtCompileTime}}\ =\ MatrixType::MaxRowsAtCompileTime}
\DoxyCodeLine{00073\ \ \ \};}
\DoxyCodeLine{00074\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{class_eigen_1_1_matrix}{Matrix<Scalar,\ 1,\ RowsAtCompileTime,\ RowMajor,\ 1,\ MaxRowsAtCompileTime>}}\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_full_piv_householder_b68efcf0da0383d73ce7fb20aafa2293_acd199f9e16acf39324487c2bcff62fc1}{WorkspaceType}};}
\DoxyCodeLine{00075\ }
\DoxyCodeLine{00076\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_full_piv_householder_b68efcf0da0383d73ce7fb20aafa2293_aaf51bc2637a96e8069128f3ee9eb1726}{allocate}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d}{JacobiSVD<MatrixType,\ FullPivHouseholderQRPreconditioner>}}\&\ \mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}})}
\DoxyCodeLine{00077\ \ \ \{}
\DoxyCodeLine{00078\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.rows()\ !=\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_full_piv_householder_b68efcf0da0383d73ce7fb20aafa2293_af0e3bc8bad9bda049439c273114d9d83}{m\_qr}}.rows()\ ||\ \mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.cols()\ !=\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_full_piv_householder_b68efcf0da0383d73ce7fb20aafa2293_af0e3bc8bad9bda049439c273114d9d83}{m\_qr}}.cols())}
\DoxyCodeLine{00079\ \ \ \ \ \{}
\DoxyCodeLine{00080\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_full_piv_householder_b68efcf0da0383d73ce7fb20aafa2293_af0e3bc8bad9bda049439c273114d9d83}{m\_qr}}.\string~QRType();}
\DoxyCodeLine{00081\ \ \ \ \ \ \ ::new\ (\&\mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_full_piv_householder_b68efcf0da0383d73ce7fb20aafa2293_af0e3bc8bad9bda049439c273114d9d83}{m\_qr}})\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_full_piv_householder_b68efcf0da0383d73ce7fb20aafa2293_a6cfa033c3b8ae2e0327bdebd87c9a9fc}{QRType}}(\mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.rows(),\ \mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.cols());}
\DoxyCodeLine{00082\ \ \ \ \ \}}
\DoxyCodeLine{00083\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.m\_computeFullU)\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_full_piv_householder_b68efcf0da0383d73ce7fb20aafa2293_a79d0dd33c1e3c04b9b6d2a5271fc9b0f}{m\_workspace}}.resize(\mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.rows());}
\DoxyCodeLine{00084\ \ \ \}}
\DoxyCodeLine{00085\ }
\DoxyCodeLine{00086\ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_full_piv_householder_b68efcf0da0383d73ce7fb20aafa2293_ab9e7960349091e9d4c44b9a0a31b0931}{run}}(\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d}{JacobiSVD<MatrixType,\ FullPivHouseholderQRPreconditioner>}}\&\ \mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}},\ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1traits}{MatrixType}}\&\ \mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}})}
\DoxyCodeLine{00087\ \ \ \{}
\DoxyCodeLine{00088\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}}.rows()\ >\ \mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}}.cols())}
\DoxyCodeLine{00089\ \ \ \ \ \{}
\DoxyCodeLine{00090\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_full_piv_householder_b68efcf0da0383d73ce7fb20aafa2293_af0e3bc8bad9bda049439c273114d9d83}{m\_qr}}.compute(\mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}});}
\DoxyCodeLine{00091\ \ \ \ \ \ \ \mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.m\_workMatrix\ =\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_full_piv_householder_b68efcf0da0383d73ce7fb20aafa2293_af0e3bc8bad9bda049439c273114d9d83}{m\_qr}}.matrixQR().block(0,0,\mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}}.cols(),\mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}}.cols()).template\ triangularView<Upper>();}
\DoxyCodeLine{00092\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.m\_computeFullU)\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_full_piv_householder_b68efcf0da0383d73ce7fb20aafa2293_af0e3bc8bad9bda049439c273114d9d83}{m\_qr}}.matrixQ().evalTo(\mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.m\_matrixU,\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_full_piv_householder_b68efcf0da0383d73ce7fb20aafa2293_a79d0dd33c1e3c04b9b6d2a5271fc9b0f}{m\_workspace}});}
\DoxyCodeLine{00093\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.computeV())\ \mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.m\_matrixV\ =\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_full_piv_householder_b68efcf0da0383d73ce7fb20aafa2293_af0e3bc8bad9bda049439c273114d9d83}{m\_qr}}.colsPermutation();}
\DoxyCodeLine{00094\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00095\ \ \ \ \ \}}
\DoxyCodeLine{00096\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00097\ \ \ \}}
\DoxyCodeLine{00098\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00099\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{class_eigen_1_1_full_piv_householder_q_r}{FullPivHouseholderQR<MatrixType>}}\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_full_piv_householder_b68efcf0da0383d73ce7fb20aafa2293_a6cfa033c3b8ae2e0327bdebd87c9a9fc}{QRType}};}
\DoxyCodeLine{00100\ \ \ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_full_piv_householder_b68efcf0da0383d73ce7fb20aafa2293_a6cfa033c3b8ae2e0327bdebd87c9a9fc}{QRType}}\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_full_piv_householder_b68efcf0da0383d73ce7fb20aafa2293_af0e3bc8bad9bda049439c273114d9d83}{m\_qr}};}
\DoxyCodeLine{00101\ \ \ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_full_piv_householder_b68efcf0da0383d73ce7fb20aafa2293_acd199f9e16acf39324487c2bcff62fc1}{WorkspaceType}}\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_full_piv_householder_b68efcf0da0383d73ce7fb20aafa2293_a79d0dd33c1e3c04b9b6d2a5271fc9b0f}{m\_workspace}};}
\DoxyCodeLine{00102\ \};}
\DoxyCodeLine{00103\ }
\DoxyCodeLine{00104\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ MatrixType>}
\DoxyCodeLine{00105\ \textcolor{keyword}{class\ }\mbox{\hyperlink{struct_eigen_1_1internal_1_1qr__preconditioner__impl}{qr\_preconditioner\_impl}}<\mbox{\hyperlink{struct_eigen_1_1internal_1_1traits}{MatrixType}},\ \mbox{\hyperlink{group__enums_gga46eba0d5c621f590b8cf1b53af31d56eabd745dcaff7019c5f918c68809e5ea50}{FullPivHouseholderQRPreconditioner}},\ \mbox{\hyperlink{namespace_eigen_1_1internal_ab45d1a34d0816cbc15002d2e58fd37d0adfa337668e3d39e7dd721825902eba87}{PreconditionIfMoreColsThanRows}},\ \mbox{\hyperlink{yyjson_8h_a41f9c5fb8b08eb5dc3edce4dcb37fee7}{true}}>}
\DoxyCodeLine{00106\ \{}
\DoxyCodeLine{00107\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00108\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ MatrixType::Scalar\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_full_piv_householder_0bfd000ff4c8127883e77da4144b4435_ab4614d310274ec672b10bf51fee7caf5}{Scalar}};}
\DoxyCodeLine{00109\ \ \ \textcolor{keyword}{enum}}
\DoxyCodeLine{00110\ \ \ \{}
\DoxyCodeLine{00111\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_full_piv_householder_0bfd000ff4c8127883e77da4144b4435_a4bf880351a5d457e1e5177a1638eff4ead564dbfa5df92657b057bf95f2ea971a}{RowsAtCompileTime}}\ =\ MatrixType::RowsAtCompileTime,}
\DoxyCodeLine{00112\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_full_piv_householder_0bfd000ff4c8127883e77da4144b4435_a4bf880351a5d457e1e5177a1638eff4eab5295259f6bdd66ebaadfc8ad96db6e0}{ColsAtCompileTime}}\ =\ MatrixType::ColsAtCompileTime,}
\DoxyCodeLine{00113\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_full_piv_householder_0bfd000ff4c8127883e77da4144b4435_a4bf880351a5d457e1e5177a1638eff4eaf6f7609137e9bb61f011f14091c0dedc}{MaxRowsAtCompileTime}}\ =\ MatrixType::MaxRowsAtCompileTime,}
\DoxyCodeLine{00114\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_full_piv_householder_0bfd000ff4c8127883e77da4144b4435_a4bf880351a5d457e1e5177a1638eff4eaf2e2a0cf33ae07e04265f54ffa30918b}{MaxColsAtCompileTime}}\ =\ MatrixType::MaxColsAtCompileTime,}
\DoxyCodeLine{00115\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_full_piv_householder_0bfd000ff4c8127883e77da4144b4435_a4bf880351a5d457e1e5177a1638eff4ea53d41744ef3db30752b8e4c50452c7c8}{TrOptions}}\ =\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_full_piv_householder_0bfd000ff4c8127883e77da4144b4435_a4bf880351a5d457e1e5177a1638eff4ead564dbfa5df92657b057bf95f2ea971a}{RowsAtCompileTime}}==1\ ?\ (MatrixType::Options\ \&\ \string~(\mbox{\hyperlink{group__enums_ggaacded1a18ae58b0f554751f6cdf9eb13a77c993a8d9f6efe5c1159fb2ab07dd4f}{RowMajor}}))}
\DoxyCodeLine{00116\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_full_piv_householder_0bfd000ff4c8127883e77da4144b4435_a4bf880351a5d457e1e5177a1638eff4eab5295259f6bdd66ebaadfc8ad96db6e0}{ColsAtCompileTime}}==1\ ?\ (\mbox{\hyperlink{struct_eigen_1_1internal_1_1traits}{MatrixType}}::Options\ |\ \ \ \mbox{\hyperlink{group__enums_ggaacded1a18ae58b0f554751f6cdf9eb13a77c993a8d9f6efe5c1159fb2ab07dd4f}{RowMajor}})}
\DoxyCodeLine{00117\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1traits}{MatrixType}}::Options}
\DoxyCodeLine{00118\ \ \ \};}
\DoxyCodeLine{00119\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{class_eigen_1_1_matrix}{Matrix<Scalar,\ ColsAtCompileTime,\ RowsAtCompileTime,\ TrOptions,\ MaxColsAtCompileTime,\ MaxRowsAtCompileTime>}}}
\DoxyCodeLine{00120\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_full_piv_householder_0bfd000ff4c8127883e77da4144b4435_a1b7fe65d1a64c063e03f968ac201fc1a}{TransposeTypeWithSameStorageOrder}};}
\DoxyCodeLine{00121\ }
\DoxyCodeLine{00122\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_full_piv_householder_0bfd000ff4c8127883e77da4144b4435_a42354f06b00258ab291e4d374caa5fd9}{allocate}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d}{JacobiSVD<MatrixType,\ FullPivHouseholderQRPreconditioner>}}\&\ \mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}})}
\DoxyCodeLine{00123\ \ \ \{}
\DoxyCodeLine{00124\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.cols()\ !=\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_full_piv_householder_0bfd000ff4c8127883e77da4144b4435_a7cab0c35ee3a371a890f8416521a3afa}{m\_qr}}.rows()\ ||\ \mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.rows()\ !=\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_full_piv_householder_0bfd000ff4c8127883e77da4144b4435_a7cab0c35ee3a371a890f8416521a3afa}{m\_qr}}.cols())}
\DoxyCodeLine{00125\ \ \ \ \ \{}
\DoxyCodeLine{00126\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_full_piv_householder_0bfd000ff4c8127883e77da4144b4435_a7cab0c35ee3a371a890f8416521a3afa}{m\_qr}}.\string~QRType();}
\DoxyCodeLine{00127\ \ \ \ \ \ \ ::new\ (\&\mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_full_piv_householder_0bfd000ff4c8127883e77da4144b4435_a7cab0c35ee3a371a890f8416521a3afa}{m\_qr}})\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_full_piv_householder_0bfd000ff4c8127883e77da4144b4435_ae56f9da11fc35aa558de0d6ec9524de8}{QRType}}(\mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.cols(),\ \mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.rows());}
\DoxyCodeLine{00128\ \ \ \ \ \}}
\DoxyCodeLine{00129\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_full_piv_householder_0bfd000ff4c8127883e77da4144b4435_aa67eb852b6a6b8215eec719e47dd631f}{m\_adjoint}}.resize(\mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.cols(),\ \mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.rows());}
\DoxyCodeLine{00130\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.m\_computeFullV)\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_full_piv_householder_0bfd000ff4c8127883e77da4144b4435_a627a8c49d6d653c201e12304e8652906}{m\_workspace}}.resize(\mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.cols());}
\DoxyCodeLine{00131\ \ \ \}}
\DoxyCodeLine{00132\ }
\DoxyCodeLine{00133\ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_full_piv_householder_0bfd000ff4c8127883e77da4144b4435_a31e087de4ff8d6e54fb71faccbb07c63}{run}}(\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d}{JacobiSVD<MatrixType,\ FullPivHouseholderQRPreconditioner>}}\&\ \mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}},\ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1traits}{MatrixType}}\&\ \mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}})}
\DoxyCodeLine{00134\ \ \ \{}
\DoxyCodeLine{00135\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}}.cols()\ >\ \mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}}.rows())}
\DoxyCodeLine{00136\ \ \ \ \ \{}
\DoxyCodeLine{00137\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_full_piv_householder_0bfd000ff4c8127883e77da4144b4435_aa67eb852b6a6b8215eec719e47dd631f}{m\_adjoint}}\ =\ \mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}}.adjoint();}
\DoxyCodeLine{00138\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_full_piv_householder_0bfd000ff4c8127883e77da4144b4435_a7cab0c35ee3a371a890f8416521a3afa}{m\_qr}}.compute(\mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_full_piv_householder_0bfd000ff4c8127883e77da4144b4435_aa67eb852b6a6b8215eec719e47dd631f}{m\_adjoint}});}
\DoxyCodeLine{00139\ \ \ \ \ \ \ \mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.m\_workMatrix\ =\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_full_piv_householder_0bfd000ff4c8127883e77da4144b4435_a7cab0c35ee3a371a890f8416521a3afa}{m\_qr}}.matrixQR().block(0,0,\mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}}.rows(),\mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}}.rows()).template\ triangularView<Upper>().adjoint();}
\DoxyCodeLine{00140\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.m\_computeFullV)\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_full_piv_householder_0bfd000ff4c8127883e77da4144b4435_a7cab0c35ee3a371a890f8416521a3afa}{m\_qr}}.matrixQ().evalTo(\mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.m\_matrixV,\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_full_piv_householder_0bfd000ff4c8127883e77da4144b4435_a627a8c49d6d653c201e12304e8652906}{m\_workspace}});}
\DoxyCodeLine{00141\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.computeU())\ \mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.m\_matrixU\ =\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_full_piv_householder_0bfd000ff4c8127883e77da4144b4435_a7cab0c35ee3a371a890f8416521a3afa}{m\_qr}}.colsPermutation();}
\DoxyCodeLine{00142\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00143\ \ \ \ \ \}}
\DoxyCodeLine{00144\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00145\ \ \ \}}
\DoxyCodeLine{00146\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00147\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{class_eigen_1_1_full_piv_householder_q_r}{FullPivHouseholderQR<TransposeTypeWithSameStorageOrder>}}\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_full_piv_householder_0bfd000ff4c8127883e77da4144b4435_ae56f9da11fc35aa558de0d6ec9524de8}{QRType}};}
\DoxyCodeLine{00148\ \ \ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_full_piv_householder_0bfd000ff4c8127883e77da4144b4435_ae56f9da11fc35aa558de0d6ec9524de8}{QRType}}\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_full_piv_householder_0bfd000ff4c8127883e77da4144b4435_a7cab0c35ee3a371a890f8416521a3afa}{m\_qr}};}
\DoxyCodeLine{00149\ \ \ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_full_piv_householder_0bfd000ff4c8127883e77da4144b4435_a1b7fe65d1a64c063e03f968ac201fc1a}{TransposeTypeWithSameStorageOrder}}\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_full_piv_householder_0bfd000ff4c8127883e77da4144b4435_aa67eb852b6a6b8215eec719e47dd631f}{m\_adjoint}};}
\DoxyCodeLine{00150\ \ \ \textcolor{keyword}{typename}\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1plain__row__type_a46f848dfbee390d779e1e04070126d25}{internal::plain\_row\_type<MatrixType>::type}}\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_full_piv_householder_0bfd000ff4c8127883e77da4144b4435_a627a8c49d6d653c201e12304e8652906}{m\_workspace}};}
\DoxyCodeLine{00151\ \};}
\DoxyCodeLine{00152\ }
\DoxyCodeLine{00153\ \textcolor{comment}{/***\ preconditioner\ using\ ColPivHouseholderQR\ ***/}}
\DoxyCodeLine{00154\ }
\DoxyCodeLine{00155\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ MatrixType>}
\DoxyCodeLine{00156\ \textcolor{keyword}{class\ }\mbox{\hyperlink{struct_eigen_1_1internal_1_1qr__preconditioner__impl}{qr\_preconditioner\_impl}}<\mbox{\hyperlink{struct_eigen_1_1internal_1_1traits}{MatrixType}},\ \mbox{\hyperlink{group__enums_gga46eba0d5c621f590b8cf1b53af31d56eabd2e2f4875c5b4b6e602a433d90c4e5e}{ColPivHouseholderQRPreconditioner}},\ \mbox{\hyperlink{namespace_eigen_1_1internal_ab45d1a34d0816cbc15002d2e58fd37d0af43dd09c4617ed9311811a15db114b62}{PreconditionIfMoreRowsThanCols}},\ \mbox{\hyperlink{yyjson_8h_a41f9c5fb8b08eb5dc3edce4dcb37fee7}{true}}>}
\DoxyCodeLine{00157\ \{}
\DoxyCodeLine{00158\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00159\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_col_piv_householder_q4429b16903ed71549d5aafc43959c2c2_a528c2a55d53add25075f8ae1adda891a}{allocate}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d}{JacobiSVD<MatrixType,\ ColPivHouseholderQRPreconditioner>}}\&\ \mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}})}
\DoxyCodeLine{00160\ \ \ \{}
\DoxyCodeLine{00161\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.rows()\ !=\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_col_piv_householder_q4429b16903ed71549d5aafc43959c2c2_a1ba75ee549aa97b6336a11bd7912544d}{m\_qr}}.rows()\ ||\ \mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.cols()\ !=\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_col_piv_householder_q4429b16903ed71549d5aafc43959c2c2_a1ba75ee549aa97b6336a11bd7912544d}{m\_qr}}.cols())}
\DoxyCodeLine{00162\ \ \ \ \ \{}
\DoxyCodeLine{00163\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_col_piv_householder_q4429b16903ed71549d5aafc43959c2c2_a1ba75ee549aa97b6336a11bd7912544d}{m\_qr}}.\string~QRType();}
\DoxyCodeLine{00164\ \ \ \ \ \ \ ::new\ (\&\mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_col_piv_householder_q4429b16903ed71549d5aafc43959c2c2_a1ba75ee549aa97b6336a11bd7912544d}{m\_qr}})\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_col_piv_householder_q4429b16903ed71549d5aafc43959c2c2_a4c68e8f86cd8f4905ce65f8f1b3c2525}{QRType}}(\mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.rows(),\ \mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.cols());}
\DoxyCodeLine{00165\ \ \ \ \ \}}
\DoxyCodeLine{00166\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.m\_computeFullU)\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_col_piv_householder_q4429b16903ed71549d5aafc43959c2c2_a8022492d37a80b7a629fbd48d8278822}{m\_workspace}}.resize(\mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.rows());}
\DoxyCodeLine{00167\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.m\_computeThinU)\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_col_piv_householder_q4429b16903ed71549d5aafc43959c2c2_a8022492d37a80b7a629fbd48d8278822}{m\_workspace}}.resize(\mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.cols());}
\DoxyCodeLine{00168\ \ \ \}}
\DoxyCodeLine{00169\ }
\DoxyCodeLine{00170\ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_col_piv_householder_q4429b16903ed71549d5aafc43959c2c2_a901d20a4f40e2254534e8560bd8219bd}{run}}(\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d}{JacobiSVD<MatrixType,\ ColPivHouseholderQRPreconditioner>}}\&\ \mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}},\ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1traits}{MatrixType}}\&\ \mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}})}
\DoxyCodeLine{00171\ \ \ \{}
\DoxyCodeLine{00172\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}}.rows()\ >\ \mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}}.cols())}
\DoxyCodeLine{00173\ \ \ \ \ \{}
\DoxyCodeLine{00174\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_col_piv_householder_q4429b16903ed71549d5aafc43959c2c2_a1ba75ee549aa97b6336a11bd7912544d}{m\_qr}}.compute(\mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}});}
\DoxyCodeLine{00175\ \ \ \ \ \ \ \mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.m\_workMatrix\ =\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_col_piv_householder_q4429b16903ed71549d5aafc43959c2c2_a1ba75ee549aa97b6336a11bd7912544d}{m\_qr}}.matrixQR().block(0,0,\mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}}.cols(),\mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}}.cols()).template\ triangularView<Upper>();}
\DoxyCodeLine{00176\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.m\_computeFullU)\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_col_piv_householder_q4429b16903ed71549d5aafc43959c2c2_a1ba75ee549aa97b6336a11bd7912544d}{m\_qr}}.householderQ().evalTo(\mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.m\_matrixU,\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_col_piv_householder_q4429b16903ed71549d5aafc43959c2c2_a8022492d37a80b7a629fbd48d8278822}{m\_workspace}});}
\DoxyCodeLine{00177\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(\mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.m\_computeThinU)}
\DoxyCodeLine{00178\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00179\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.m\_matrixU.setIdentity(\mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}}.rows(),\ \mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}}.cols());}
\DoxyCodeLine{00180\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_col_piv_householder_q4429b16903ed71549d5aafc43959c2c2_a1ba75ee549aa97b6336a11bd7912544d}{m\_qr}}.householderQ().applyThisOnTheLeft(\mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.m\_matrixU,\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_col_piv_householder_q4429b16903ed71549d5aafc43959c2c2_a8022492d37a80b7a629fbd48d8278822}{m\_workspace}});}
\DoxyCodeLine{00181\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00182\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.computeV())\ \mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.m\_matrixV\ =\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_col_piv_householder_q4429b16903ed71549d5aafc43959c2c2_a1ba75ee549aa97b6336a11bd7912544d}{m\_qr}}.colsPermutation();}
\DoxyCodeLine{00183\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00184\ \ \ \ \ \}}
\DoxyCodeLine{00185\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00186\ \ \ \}}
\DoxyCodeLine{00187\ }
\DoxyCodeLine{00188\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00189\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{class_eigen_1_1_col_piv_householder_q_r}{ColPivHouseholderQR<MatrixType>}}\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_col_piv_householder_q4429b16903ed71549d5aafc43959c2c2_a4c68e8f86cd8f4905ce65f8f1b3c2525}{QRType}};}
\DoxyCodeLine{00190\ \ \ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_col_piv_householder_q4429b16903ed71549d5aafc43959c2c2_a4c68e8f86cd8f4905ce65f8f1b3c2525}{QRType}}\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_col_piv_householder_q4429b16903ed71549d5aafc43959c2c2_a1ba75ee549aa97b6336a11bd7912544d}{m\_qr}};}
\DoxyCodeLine{00191\ \ \ \textcolor{keyword}{typename}\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1plain__col__type_a50d7bd17cb1a08813dc6d2c58cae4261}{internal::plain\_col\_type<MatrixType>::type}}\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_col_piv_householder_q4429b16903ed71549d5aafc43959c2c2_a8022492d37a80b7a629fbd48d8278822}{m\_workspace}};}
\DoxyCodeLine{00192\ \};}
\DoxyCodeLine{00193\ }
\DoxyCodeLine{00194\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ MatrixType>}
\DoxyCodeLine{00195\ \textcolor{keyword}{class\ }\mbox{\hyperlink{struct_eigen_1_1internal_1_1qr__preconditioner__impl}{qr\_preconditioner\_impl}}<\mbox{\hyperlink{struct_eigen_1_1internal_1_1traits}{MatrixType}},\ \mbox{\hyperlink{group__enums_gga46eba0d5c621f590b8cf1b53af31d56eabd2e2f4875c5b4b6e602a433d90c4e5e}{ColPivHouseholderQRPreconditioner}},\ \mbox{\hyperlink{namespace_eigen_1_1internal_ab45d1a34d0816cbc15002d2e58fd37d0adfa337668e3d39e7dd721825902eba87}{PreconditionIfMoreColsThanRows}},\ \mbox{\hyperlink{yyjson_8h_a41f9c5fb8b08eb5dc3edce4dcb37fee7}{true}}>}
\DoxyCodeLine{00196\ \{}
\DoxyCodeLine{00197\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00198\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ MatrixType::Scalar\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_col_piv_householder_q9febbd0c27c13f65b619ca11d9f35cb8_a85b6c5ee23a5920211586a22d33c73a9}{Scalar}};}
\DoxyCodeLine{00199\ \ \ \textcolor{keyword}{enum}}
\DoxyCodeLine{00200\ \ \ \{}
\DoxyCodeLine{00201\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_col_piv_householder_q9febbd0c27c13f65b619ca11d9f35cb8_a33240387a8d7bc19168d9af3340c0600ac3382f11611e941f6da321769838b8d7}{RowsAtCompileTime}}\ =\ MatrixType::RowsAtCompileTime,}
\DoxyCodeLine{00202\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_col_piv_householder_q9febbd0c27c13f65b619ca11d9f35cb8_a33240387a8d7bc19168d9af3340c0600a0290aa7a4e983370171f4cc6208eba33}{ColsAtCompileTime}}\ =\ MatrixType::ColsAtCompileTime,}
\DoxyCodeLine{00203\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_col_piv_householder_q9febbd0c27c13f65b619ca11d9f35cb8_a33240387a8d7bc19168d9af3340c0600a31de03ca17ee45d6fdbc945e1f4e0356}{MaxRowsAtCompileTime}}\ =\ MatrixType::MaxRowsAtCompileTime,}
\DoxyCodeLine{00204\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_col_piv_householder_q9febbd0c27c13f65b619ca11d9f35cb8_a33240387a8d7bc19168d9af3340c0600a32c12628b9a84feb5de837e2eeed8188}{MaxColsAtCompileTime}}\ =\ MatrixType::MaxColsAtCompileTime,}
\DoxyCodeLine{00205\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_col_piv_householder_q9febbd0c27c13f65b619ca11d9f35cb8_a33240387a8d7bc19168d9af3340c0600ac11842b5c289dfb4c3b679dd489cbef1}{TrOptions}}\ =\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_col_piv_householder_q9febbd0c27c13f65b619ca11d9f35cb8_a33240387a8d7bc19168d9af3340c0600ac3382f11611e941f6da321769838b8d7}{RowsAtCompileTime}}==1\ ?\ (MatrixType::Options\ \&\ \string~(\mbox{\hyperlink{group__enums_ggaacded1a18ae58b0f554751f6cdf9eb13a77c993a8d9f6efe5c1159fb2ab07dd4f}{RowMajor}}))}
\DoxyCodeLine{00206\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_col_piv_householder_q9febbd0c27c13f65b619ca11d9f35cb8_a33240387a8d7bc19168d9af3340c0600a0290aa7a4e983370171f4cc6208eba33}{ColsAtCompileTime}}==1\ ?\ (\mbox{\hyperlink{struct_eigen_1_1internal_1_1traits}{MatrixType}}::Options\ |\ \ \ \mbox{\hyperlink{group__enums_ggaacded1a18ae58b0f554751f6cdf9eb13a77c993a8d9f6efe5c1159fb2ab07dd4f}{RowMajor}})}
\DoxyCodeLine{00207\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1traits}{MatrixType}}::Options}
\DoxyCodeLine{00208\ \ \ \};}
\DoxyCodeLine{00209\ }
\DoxyCodeLine{00210\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{class_eigen_1_1_matrix}{Matrix<Scalar,\ ColsAtCompileTime,\ RowsAtCompileTime,\ TrOptions,\ MaxColsAtCompileTime,\ MaxRowsAtCompileTime>}}}
\DoxyCodeLine{00211\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_col_piv_householder_q9febbd0c27c13f65b619ca11d9f35cb8_a58578c89efb3fbe5e0356412694f873f}{TransposeTypeWithSameStorageOrder}};}
\DoxyCodeLine{00212\ }
\DoxyCodeLine{00213\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_col_piv_householder_q9febbd0c27c13f65b619ca11d9f35cb8_ab4cbdc0bda98095ba9bbae49ea1d550d}{allocate}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d}{JacobiSVD<MatrixType,\ ColPivHouseholderQRPreconditioner>}}\&\ \mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}})}
\DoxyCodeLine{00214\ \ \ \{}
\DoxyCodeLine{00215\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.cols()\ !=\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_col_piv_householder_q9febbd0c27c13f65b619ca11d9f35cb8_a4e8d09d8ea5ab63916c2029beab4f9c5}{m\_qr}}.rows()\ ||\ \mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.rows()\ !=\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_col_piv_householder_q9febbd0c27c13f65b619ca11d9f35cb8_a4e8d09d8ea5ab63916c2029beab4f9c5}{m\_qr}}.cols())}
\DoxyCodeLine{00216\ \ \ \ \ \{}
\DoxyCodeLine{00217\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_col_piv_householder_q9febbd0c27c13f65b619ca11d9f35cb8_a4e8d09d8ea5ab63916c2029beab4f9c5}{m\_qr}}.\string~QRType();}
\DoxyCodeLine{00218\ \ \ \ \ \ \ ::new\ (\&\mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_col_piv_householder_q9febbd0c27c13f65b619ca11d9f35cb8_a4e8d09d8ea5ab63916c2029beab4f9c5}{m\_qr}})\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_col_piv_householder_q9febbd0c27c13f65b619ca11d9f35cb8_a7912cda6b8200d6e33511e49333dd4be}{QRType}}(\mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.cols(),\ \mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.rows());}
\DoxyCodeLine{00219\ \ \ \ \ \}}
\DoxyCodeLine{00220\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.m\_computeFullV)\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_col_piv_householder_q9febbd0c27c13f65b619ca11d9f35cb8_a6935f06a28345f8a77f3110c55f44f89}{m\_workspace}}.resize(\mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.cols());}
\DoxyCodeLine{00221\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.m\_computeThinV)\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_col_piv_householder_q9febbd0c27c13f65b619ca11d9f35cb8_a6935f06a28345f8a77f3110c55f44f89}{m\_workspace}}.resize(\mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.rows());}
\DoxyCodeLine{00222\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_col_piv_householder_q9febbd0c27c13f65b619ca11d9f35cb8_a6a912db696bdf423ebc7762368bf89ec}{m\_adjoint}}.resize(\mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.cols(),\ \mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.rows());}
\DoxyCodeLine{00223\ \ \ \}}
\DoxyCodeLine{00224\ }
\DoxyCodeLine{00225\ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_col_piv_householder_q9febbd0c27c13f65b619ca11d9f35cb8_a0ab01429feb699987a2e7003327e4ba5}{run}}(\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d}{JacobiSVD<MatrixType,\ ColPivHouseholderQRPreconditioner>}}\&\ \mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}},\ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1traits}{MatrixType}}\&\ \mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}})}
\DoxyCodeLine{00226\ \ \ \{}
\DoxyCodeLine{00227\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}}.cols()\ >\ \mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}}.rows())}
\DoxyCodeLine{00228\ \ \ \ \ \{}
\DoxyCodeLine{00229\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_col_piv_householder_q9febbd0c27c13f65b619ca11d9f35cb8_a6a912db696bdf423ebc7762368bf89ec}{m\_adjoint}}\ =\ \mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}}.adjoint();}
\DoxyCodeLine{00230\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_col_piv_householder_q9febbd0c27c13f65b619ca11d9f35cb8_a4e8d09d8ea5ab63916c2029beab4f9c5}{m\_qr}}.compute(\mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_col_piv_householder_q9febbd0c27c13f65b619ca11d9f35cb8_a6a912db696bdf423ebc7762368bf89ec}{m\_adjoint}});}
\DoxyCodeLine{00231\ }
\DoxyCodeLine{00232\ \ \ \ \ \ \ \mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.m\_workMatrix\ =\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_col_piv_householder_q9febbd0c27c13f65b619ca11d9f35cb8_a4e8d09d8ea5ab63916c2029beab4f9c5}{m\_qr}}.matrixQR().block(0,0,\mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}}.rows(),\mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}}.rows()).template\ triangularView<Upper>().adjoint();}
\DoxyCodeLine{00233\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.m\_computeFullV)\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_col_piv_householder_q9febbd0c27c13f65b619ca11d9f35cb8_a4e8d09d8ea5ab63916c2029beab4f9c5}{m\_qr}}.householderQ().evalTo(\mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.m\_matrixV,\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_col_piv_householder_q9febbd0c27c13f65b619ca11d9f35cb8_a6935f06a28345f8a77f3110c55f44f89}{m\_workspace}});}
\DoxyCodeLine{00234\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(\mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.m\_computeThinV)}
\DoxyCodeLine{00235\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00236\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.m\_matrixV.setIdentity(\mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}}.cols(),\ \mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}}.rows());}
\DoxyCodeLine{00237\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_col_piv_householder_q9febbd0c27c13f65b619ca11d9f35cb8_a4e8d09d8ea5ab63916c2029beab4f9c5}{m\_qr}}.householderQ().applyThisOnTheLeft(\mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.m\_matrixV,\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_col_piv_householder_q9febbd0c27c13f65b619ca11d9f35cb8_a6935f06a28345f8a77f3110c55f44f89}{m\_workspace}});}
\DoxyCodeLine{00238\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00239\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.computeU())\ \mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.m\_matrixU\ =\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_col_piv_householder_q9febbd0c27c13f65b619ca11d9f35cb8_a4e8d09d8ea5ab63916c2029beab4f9c5}{m\_qr}}.colsPermutation();}
\DoxyCodeLine{00240\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00241\ \ \ \ \ \}}
\DoxyCodeLine{00242\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00243\ \ \ \}}
\DoxyCodeLine{00244\ }
\DoxyCodeLine{00245\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00246\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{class_eigen_1_1_col_piv_householder_q_r}{ColPivHouseholderQR<TransposeTypeWithSameStorageOrder>}}\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_col_piv_householder_q9febbd0c27c13f65b619ca11d9f35cb8_a7912cda6b8200d6e33511e49333dd4be}{QRType}};}
\DoxyCodeLine{00247\ \ \ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_col_piv_householder_q9febbd0c27c13f65b619ca11d9f35cb8_a7912cda6b8200d6e33511e49333dd4be}{QRType}}\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_col_piv_householder_q9febbd0c27c13f65b619ca11d9f35cb8_a4e8d09d8ea5ab63916c2029beab4f9c5}{m\_qr}};}
\DoxyCodeLine{00248\ \ \ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_col_piv_householder_q9febbd0c27c13f65b619ca11d9f35cb8_a58578c89efb3fbe5e0356412694f873f}{TransposeTypeWithSameStorageOrder}}\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_col_piv_householder_q9febbd0c27c13f65b619ca11d9f35cb8_a6a912db696bdf423ebc7762368bf89ec}{m\_adjoint}};}
\DoxyCodeLine{00249\ \ \ \textcolor{keyword}{typename}\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1plain__row__type_a46f848dfbee390d779e1e04070126d25}{internal::plain\_row\_type<MatrixType>::type}}\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_col_piv_householder_q9febbd0c27c13f65b619ca11d9f35cb8_a6935f06a28345f8a77f3110c55f44f89}{m\_workspace}};}
\DoxyCodeLine{00250\ \};}
\DoxyCodeLine{00251\ }
\DoxyCodeLine{00252\ \textcolor{comment}{/***\ preconditioner\ using\ HouseholderQR\ ***/}}
\DoxyCodeLine{00253\ }
\DoxyCodeLine{00254\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ MatrixType>}
\DoxyCodeLine{00255\ \textcolor{keyword}{class\ }\mbox{\hyperlink{struct_eigen_1_1internal_1_1qr__preconditioner__impl}{qr\_preconditioner\_impl}}<\mbox{\hyperlink{struct_eigen_1_1internal_1_1traits}{MatrixType}},\ \mbox{\hyperlink{group__enums_gga46eba0d5c621f590b8cf1b53af31d56ea9c660eb3336bf8c77ce9d081ca07cbdd}{HouseholderQRPreconditioner}},\ \mbox{\hyperlink{namespace_eigen_1_1internal_ab45d1a34d0816cbc15002d2e58fd37d0af43dd09c4617ed9311811a15db114b62}{PreconditionIfMoreRowsThanCols}},\ \mbox{\hyperlink{yyjson_8h_a41f9c5fb8b08eb5dc3edce4dcb37fee7}{true}}>}
\DoxyCodeLine{00256\ \{}
\DoxyCodeLine{00257\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00258\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_householder_q_r_preco3db9481bdea35fcb59961342158459cb_a6052eaee17d51283dc3251a0461f6177}{allocate}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d}{JacobiSVD<MatrixType,\ HouseholderQRPreconditioner>}}\&\ \mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}})}
\DoxyCodeLine{00259\ \ \ \{}
\DoxyCodeLine{00260\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.rows()\ !=\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_householder_q_r_preco3db9481bdea35fcb59961342158459cb_aeef5986c4d73227e2101e3c62e54c710}{m\_qr}}.rows()\ ||\ \mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.cols()\ !=\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_householder_q_r_preco3db9481bdea35fcb59961342158459cb_aeef5986c4d73227e2101e3c62e54c710}{m\_qr}}.cols())}
\DoxyCodeLine{00261\ \ \ \ \ \{}
\DoxyCodeLine{00262\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_householder_q_r_preco3db9481bdea35fcb59961342158459cb_aeef5986c4d73227e2101e3c62e54c710}{m\_qr}}.\string~QRType();}
\DoxyCodeLine{00263\ \ \ \ \ \ \ ::new\ (\&\mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_householder_q_r_preco3db9481bdea35fcb59961342158459cb_aeef5986c4d73227e2101e3c62e54c710}{m\_qr}})\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_householder_q_r_preco3db9481bdea35fcb59961342158459cb_a81e07131f63d4ecb9fcf9e3ffea2cd47}{QRType}}(\mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.rows(),\ \mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.cols());}
\DoxyCodeLine{00264\ \ \ \ \ \}}
\DoxyCodeLine{00265\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.m\_computeFullU)\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_householder_q_r_preco3db9481bdea35fcb59961342158459cb_ad451c2110571c652ab8b9aa92435882a}{m\_workspace}}.resize(\mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.rows());}
\DoxyCodeLine{00266\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.m\_computeThinU)\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_householder_q_r_preco3db9481bdea35fcb59961342158459cb_ad451c2110571c652ab8b9aa92435882a}{m\_workspace}}.resize(\mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.cols());}
\DoxyCodeLine{00267\ \ \ \}}
\DoxyCodeLine{00268\ }
\DoxyCodeLine{00269\ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_householder_q_r_preco3db9481bdea35fcb59961342158459cb_a1c9bce19c400f97400e43b41a6e3255a}{run}}(\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d}{JacobiSVD<MatrixType,\ HouseholderQRPreconditioner>}}\&\ \mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}},\ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1traits}{MatrixType}}\&\ \mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}})}
\DoxyCodeLine{00270\ \ \ \{}
\DoxyCodeLine{00271\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}}.rows()\ >\ \mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}}.cols())}
\DoxyCodeLine{00272\ \ \ \ \ \{}
\DoxyCodeLine{00273\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_householder_q_r_preco3db9481bdea35fcb59961342158459cb_aeef5986c4d73227e2101e3c62e54c710}{m\_qr}}.compute(\mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}});}
\DoxyCodeLine{00274\ \ \ \ \ \ \ \mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.m\_workMatrix\ =\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_householder_q_r_preco3db9481bdea35fcb59961342158459cb_aeef5986c4d73227e2101e3c62e54c710}{m\_qr}}.matrixQR().block(0,0,\mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}}.cols(),\mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}}.cols()).template\ triangularView<Upper>();}
\DoxyCodeLine{00275\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.m\_computeFullU)\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_householder_q_r_preco3db9481bdea35fcb59961342158459cb_aeef5986c4d73227e2101e3c62e54c710}{m\_qr}}.householderQ().evalTo(\mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.m\_matrixU,\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_householder_q_r_preco3db9481bdea35fcb59961342158459cb_ad451c2110571c652ab8b9aa92435882a}{m\_workspace}});}
\DoxyCodeLine{00276\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(\mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.m\_computeThinU)}
\DoxyCodeLine{00277\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00278\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.m\_matrixU.setIdentity(\mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}}.rows(),\ \mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}}.cols());}
\DoxyCodeLine{00279\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_householder_q_r_preco3db9481bdea35fcb59961342158459cb_aeef5986c4d73227e2101e3c62e54c710}{m\_qr}}.householderQ().applyThisOnTheLeft(\mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.m\_matrixU,\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_householder_q_r_preco3db9481bdea35fcb59961342158459cb_ad451c2110571c652ab8b9aa92435882a}{m\_workspace}});}
\DoxyCodeLine{00280\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00281\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.computeV())\ \mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.m\_matrixV.setIdentity(\mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}}.cols(),\ \mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}}.cols());}
\DoxyCodeLine{00282\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00283\ \ \ \ \ \}}
\DoxyCodeLine{00284\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00285\ \ \ \}}
\DoxyCodeLine{00286\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00287\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{class_eigen_1_1_householder_q_r}{HouseholderQR<MatrixType>}}\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_householder_q_r_preco3db9481bdea35fcb59961342158459cb_a81e07131f63d4ecb9fcf9e3ffea2cd47}{QRType}};}
\DoxyCodeLine{00288\ \ \ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_householder_q_r_preco3db9481bdea35fcb59961342158459cb_a81e07131f63d4ecb9fcf9e3ffea2cd47}{QRType}}\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_householder_q_r_preco3db9481bdea35fcb59961342158459cb_aeef5986c4d73227e2101e3c62e54c710}{m\_qr}};}
\DoxyCodeLine{00289\ \ \ \textcolor{keyword}{typename}\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1plain__col__type_a50d7bd17cb1a08813dc6d2c58cae4261}{internal::plain\_col\_type<MatrixType>::type}}\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_householder_q_r_preco3db9481bdea35fcb59961342158459cb_ad451c2110571c652ab8b9aa92435882a}{m\_workspace}};}
\DoxyCodeLine{00290\ \};}
\DoxyCodeLine{00291\ }
\DoxyCodeLine{00292\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ MatrixType>}
\DoxyCodeLine{00293\ \textcolor{keyword}{class\ }\mbox{\hyperlink{struct_eigen_1_1internal_1_1qr__preconditioner__impl}{qr\_preconditioner\_impl}}<\mbox{\hyperlink{struct_eigen_1_1internal_1_1traits}{MatrixType}},\ \mbox{\hyperlink{group__enums_gga46eba0d5c621f590b8cf1b53af31d56ea9c660eb3336bf8c77ce9d081ca07cbdd}{HouseholderQRPreconditioner}},\ \mbox{\hyperlink{namespace_eigen_1_1internal_ab45d1a34d0816cbc15002d2e58fd37d0adfa337668e3d39e7dd721825902eba87}{PreconditionIfMoreColsThanRows}},\ \mbox{\hyperlink{yyjson_8h_a41f9c5fb8b08eb5dc3edce4dcb37fee7}{true}}>}
\DoxyCodeLine{00294\ \{}
\DoxyCodeLine{00295\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00296\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ MatrixType::Scalar\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_householder_q_r_preco31667955395337fca0dd5f85cded2a6b_a725d93b64c11461c9eee2d042cd1ddee}{Scalar}};}
\DoxyCodeLine{00297\ \ \ \textcolor{keyword}{enum}}
\DoxyCodeLine{00298\ \ \ \{}
\DoxyCodeLine{00299\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_householder_q_r_preco31667955395337fca0dd5f85cded2a6b_aa3135a9075856071e79601a73c22ba53a6aa7bd33cac3520d980b36307154da3c}{RowsAtCompileTime}}\ =\ MatrixType::RowsAtCompileTime,}
\DoxyCodeLine{00300\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_householder_q_r_preco31667955395337fca0dd5f85cded2a6b_aa3135a9075856071e79601a73c22ba53afcfa1d3971e9377b15ca2ab19e84d023}{ColsAtCompileTime}}\ =\ MatrixType::ColsAtCompileTime,}
\DoxyCodeLine{00301\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_householder_q_r_preco31667955395337fca0dd5f85cded2a6b_aa3135a9075856071e79601a73c22ba53a4a8c26a7342c7dd28fef095c11f1da9a}{MaxRowsAtCompileTime}}\ =\ MatrixType::MaxRowsAtCompileTime,}
\DoxyCodeLine{00302\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_householder_q_r_preco31667955395337fca0dd5f85cded2a6b_aa3135a9075856071e79601a73c22ba53a3c420830dc65ce4005f9751948d7a517}{MaxColsAtCompileTime}}\ =\ MatrixType::MaxColsAtCompileTime,}
\DoxyCodeLine{00303\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_householder_q_r_preco31667955395337fca0dd5f85cded2a6b_aa3135a9075856071e79601a73c22ba53a850fec79ec21bcb07d7717e50edcc850}{Options}}\ =\ MatrixType::Options}
\DoxyCodeLine{00304\ \ \ \};}
\DoxyCodeLine{00305\ }
\DoxyCodeLine{00306\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{class_eigen_1_1_matrix}{Matrix<Scalar,\ ColsAtCompileTime,\ RowsAtCompileTime,\ Options,\ MaxColsAtCompileTime,\ MaxRowsAtCompileTime>}}}
\DoxyCodeLine{00307\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_householder_q_r_preco31667955395337fca0dd5f85cded2a6b_a689f20f9b957aea1376e25c839216f6a}{TransposeTypeWithSameStorageOrder}};}
\DoxyCodeLine{00308\ }
\DoxyCodeLine{00309\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_householder_q_r_preco31667955395337fca0dd5f85cded2a6b_a8885f59d4a7ecc4b52c9b2f563913750}{allocate}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d}{JacobiSVD<MatrixType,\ HouseholderQRPreconditioner>}}\&\ \mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}})}
\DoxyCodeLine{00310\ \ \ \{}
\DoxyCodeLine{00311\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.cols()\ !=\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_householder_q_r_preco31667955395337fca0dd5f85cded2a6b_ae72c335c3e1c206727b737ff7fd03bbb}{m\_qr}}.rows()\ ||\ \mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.rows()\ !=\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_householder_q_r_preco31667955395337fca0dd5f85cded2a6b_ae72c335c3e1c206727b737ff7fd03bbb}{m\_qr}}.cols())}
\DoxyCodeLine{00312\ \ \ \ \ \{}
\DoxyCodeLine{00313\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_householder_q_r_preco31667955395337fca0dd5f85cded2a6b_ae72c335c3e1c206727b737ff7fd03bbb}{m\_qr}}.\string~QRType();}
\DoxyCodeLine{00314\ \ \ \ \ \ \ ::new\ (\&\mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_householder_q_r_preco31667955395337fca0dd5f85cded2a6b_ae72c335c3e1c206727b737ff7fd03bbb}{m\_qr}})\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_householder_q_r_preco31667955395337fca0dd5f85cded2a6b_a0269e5506c2c119d50df488d8edecc64}{QRType}}(\mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.cols(),\ \mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.rows());}
\DoxyCodeLine{00315\ \ \ \ \ \}}
\DoxyCodeLine{00316\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.m\_computeFullV)\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_householder_q_r_preco31667955395337fca0dd5f85cded2a6b_ad757dc8bc0f0a17a84b18c07169a8651}{m\_workspace}}.resize(\mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.cols());}
\DoxyCodeLine{00317\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.m\_computeThinV)\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_householder_q_r_preco31667955395337fca0dd5f85cded2a6b_ad757dc8bc0f0a17a84b18c07169a8651}{m\_workspace}}.resize(\mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.rows());}
\DoxyCodeLine{00318\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_householder_q_r_preco31667955395337fca0dd5f85cded2a6b_a727ff754c6329e6dde45c5ecb8dbeb64}{m\_adjoint}}.resize(\mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.cols(),\ \mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.rows());}
\DoxyCodeLine{00319\ \ \ \}}
\DoxyCodeLine{00320\ }
\DoxyCodeLine{00321\ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_householder_q_r_preco31667955395337fca0dd5f85cded2a6b_a1518723c076752e639525450f7fc1909}{run}}(\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d}{JacobiSVD<MatrixType,\ HouseholderQRPreconditioner>}}\&\ \mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}},\ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1traits}{MatrixType}}\&\ \mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}})}
\DoxyCodeLine{00322\ \ \ \{}
\DoxyCodeLine{00323\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}}.cols()\ >\ \mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}}.rows())}
\DoxyCodeLine{00324\ \ \ \ \ \{}
\DoxyCodeLine{00325\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_householder_q_r_preco31667955395337fca0dd5f85cded2a6b_a727ff754c6329e6dde45c5ecb8dbeb64}{m\_adjoint}}\ =\ \mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}}.adjoint();}
\DoxyCodeLine{00326\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_householder_q_r_preco31667955395337fca0dd5f85cded2a6b_ae72c335c3e1c206727b737ff7fd03bbb}{m\_qr}}.compute(\mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_householder_q_r_preco31667955395337fca0dd5f85cded2a6b_a727ff754c6329e6dde45c5ecb8dbeb64}{m\_adjoint}});}
\DoxyCodeLine{00327\ }
\DoxyCodeLine{00328\ \ \ \ \ \ \ \mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.m\_workMatrix\ =\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_householder_q_r_preco31667955395337fca0dd5f85cded2a6b_ae72c335c3e1c206727b737ff7fd03bbb}{m\_qr}}.matrixQR().block(0,0,\mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}}.rows(),\mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}}.rows()).template\ triangularView<Upper>().adjoint();}
\DoxyCodeLine{00329\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.m\_computeFullV)\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_householder_q_r_preco31667955395337fca0dd5f85cded2a6b_ae72c335c3e1c206727b737ff7fd03bbb}{m\_qr}}.householderQ().evalTo(\mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.m\_matrixV,\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_householder_q_r_preco31667955395337fca0dd5f85cded2a6b_ad757dc8bc0f0a17a84b18c07169a8651}{m\_workspace}});}
\DoxyCodeLine{00330\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(\mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.m\_computeThinV)}
\DoxyCodeLine{00331\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00332\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.m\_matrixV.setIdentity(\mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}}.cols(),\ \mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}}.rows());}
\DoxyCodeLine{00333\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_householder_q_r_preco31667955395337fca0dd5f85cded2a6b_ae72c335c3e1c206727b737ff7fd03bbb}{m\_qr}}.householderQ().applyThisOnTheLeft(\mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.m\_matrixV,\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_householder_q_r_preco31667955395337fca0dd5f85cded2a6b_ad757dc8bc0f0a17a84b18c07169a8651}{m\_workspace}});}
\DoxyCodeLine{00334\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00335\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.computeU())\ \mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.m\_matrixU.setIdentity(\mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}}.rows(),\ \mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}}.rows());}
\DoxyCodeLine{00336\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00337\ \ \ \ \ \}}
\DoxyCodeLine{00338\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00339\ \ \ \}}
\DoxyCodeLine{00340\ }
\DoxyCodeLine{00341\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00342\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{class_eigen_1_1_householder_q_r}{HouseholderQR<TransposeTypeWithSameStorageOrder>}}\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_householder_q_r_preco31667955395337fca0dd5f85cded2a6b_a0269e5506c2c119d50df488d8edecc64}{QRType}};}
\DoxyCodeLine{00343\ \ \ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_householder_q_r_preco31667955395337fca0dd5f85cded2a6b_a0269e5506c2c119d50df488d8edecc64}{QRType}}\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_householder_q_r_preco31667955395337fca0dd5f85cded2a6b_ae72c335c3e1c206727b737ff7fd03bbb}{m\_qr}};}
\DoxyCodeLine{00344\ \ \ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_householder_q_r_preco31667955395337fca0dd5f85cded2a6b_a689f20f9b957aea1376e25c839216f6a}{TransposeTypeWithSameStorageOrder}}\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_householder_q_r_preco31667955395337fca0dd5f85cded2a6b_a727ff754c6329e6dde45c5ecb8dbeb64}{m\_adjoint}};}
\DoxyCodeLine{00345\ \ \ \textcolor{keyword}{typename}\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1plain__row__type_a46f848dfbee390d779e1e04070126d25}{internal::plain\_row\_type<MatrixType>::type}}\ \mbox{\hyperlink{class_eigen_1_1internal_1_1qr__preconditioner__impl_3_01_matrix_type_00_01_householder_q_r_preco31667955395337fca0dd5f85cded2a6b_ad757dc8bc0f0a17a84b18c07169a8651}{m\_workspace}};}
\DoxyCodeLine{00346\ \};}
\DoxyCodeLine{00347\ }
\DoxyCodeLine{00348\ \textcolor{comment}{/***\ 2x2\ SVD\ implementation}}
\DoxyCodeLine{00349\ \textcolor{comment}{\ ***}}
\DoxyCodeLine{00350\ \textcolor{comment}{\ ***\ JacobiSVD\ consists\ in\ performing\ a\ series\ of\ 2x2\ SVD\ subproblems}}
\DoxyCodeLine{00351\ \textcolor{comment}{\ ***/}}
\DoxyCodeLine{00352\ }
\DoxyCodeLine{00353\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ MatrixType,\ \textcolor{keywordtype}{int}\ QRPreconditioner>}
\DoxyCodeLine{00354\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_eigen_1_1internal_1_1svd__precondition__2x2__block__to__be__real}{svd\_precondition\_2x2\_block\_to\_be\_real}}<\mbox{\hyperlink{struct_eigen_1_1internal_1_1traits}{MatrixType}},\ QRPreconditioner,\ \mbox{\hyperlink{yyjson_8h_a65e9886d74aaee76545e83dd09011727}{false}}>}
\DoxyCodeLine{00355\ \{}
\DoxyCodeLine{00356\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d}{JacobiSVD<MatrixType,\ QRPreconditioner>}}\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1svd__precondition__2x2__block__to__be__real_3_01_matrix_type_00_01_q076cf26720930d18ea7d222bbee662fd_a03f1047549bd0f97f40c2df3f4a14927}{SVD}};}
\DoxyCodeLine{00357\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ MatrixType::RealScalar\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1svd__precondition__2x2__block__to__be__real_3_01_matrix_type_00_01_q076cf26720930d18ea7d222bbee662fd_a9256fcadaa3aa0e1ad3a5785dae44751}{RealScalar}};}
\DoxyCodeLine{00358\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1svd__precondition__2x2__block__to__be__real_3_01_matrix_type_00_01_q076cf26720930d18ea7d222bbee662fd_afde3f70cb5d0cf4bf15c8df8a36372f9}{run}}(\textcolor{keyword}{typename}\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a2340597ffb613aec7aeff16310d19639}{SVD::WorkMatrixType}}\&,\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1svd__precondition__2x2__block__to__be__real_3_01_matrix_type_00_01_q076cf26720930d18ea7d222bbee662fd_a03f1047549bd0f97f40c2df3f4a14927}{SVD}}\&,\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1traits}{Index}},\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1traits}{Index}},\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1svd__precondition__2x2__block__to__be__real_3_01_matrix_type_00_01_q076cf26720930d18ea7d222bbee662fd_a9256fcadaa3aa0e1ad3a5785dae44751}{RealScalar}}\&)\ \{\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};\ \}}
\DoxyCodeLine{00359\ \};}
\DoxyCodeLine{00360\ }
\DoxyCodeLine{00361\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ MatrixType,\ \textcolor{keywordtype}{int}\ QRPreconditioner>}
\DoxyCodeLine{00362\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_eigen_1_1internal_1_1svd__precondition__2x2__block__to__be__real}{svd\_precondition\_2x2\_block\_to\_be\_real}}<\mbox{\hyperlink{struct_eigen_1_1internal_1_1traits}{MatrixType}},\ QRPreconditioner,\ \mbox{\hyperlink{yyjson_8h_a41f9c5fb8b08eb5dc3edce4dcb37fee7}{true}}>}
\DoxyCodeLine{00363\ \{}
\DoxyCodeLine{00364\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d}{JacobiSVD<MatrixType,\ QRPreconditioner>}}\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1svd__precondition__2x2__block__to__be__real_3_01_matrix_type_00_01_qb58fa819a3391e7d55d98ccdc14db9e4_a6eb249bbad69fe226879d1e64e1c01c6}{SVD}};}
\DoxyCodeLine{00365\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ MatrixType::Scalar\ \mbox{\hyperlink{class_eigen_1_1_matrix_base_ac966a9548d81c18515e90b536d3b769e}{Scalar}};}
\DoxyCodeLine{00366\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ MatrixType::RealScalar\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1svd__precondition__2x2__block__to__be__real_3_01_matrix_type_00_01_qb58fa819a3391e7d55d98ccdc14db9e4_a5a0e30c2f4c8f54c4940144c8bd3db0e}{RealScalar}};}
\DoxyCodeLine{00367\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1svd__precondition__2x2__block__to__be__real_3_01_matrix_type_00_01_qb58fa819a3391e7d55d98ccdc14db9e4_a76a3369c7786e295de41c7061b9da031}{run}}(\textcolor{keyword}{typename}\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a2340597ffb613aec7aeff16310d19639}{SVD::WorkMatrixType}}\&\ work\_matrix,\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1svd__precondition__2x2__block__to__be__real_3_01_matrix_type_00_01_qb58fa819a3391e7d55d98ccdc14db9e4_a6eb249bbad69fe226879d1e64e1c01c6}{SVD}}\&\ \mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}},\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1traits}{Index}}\ \mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}},\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1traits}{Index}}\ \mbox{\hyperlink{som__graph_8cpp_ae900b2add8deca663438fb20de69acce}{q}},\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1svd__precondition__2x2__block__to__be__real_3_01_matrix_type_00_01_qb58fa819a3391e7d55d98ccdc14db9e4_a5a0e30c2f4c8f54c4940144c8bd3db0e}{RealScalar}}\&\ maxDiagEntry)}
\DoxyCodeLine{00368\ \ \ \{}
\DoxyCodeLine{00369\ \ \ \ \ \textcolor{keyword}{using\ }std::sqrt;}
\DoxyCodeLine{00370\ \ \ \ \ \textcolor{keyword}{using\ }std::abs;}
\DoxyCodeLine{00371\ \ \ \ \ \mbox{\hyperlink{struct_eigen_1_1internal_1_1svd__precondition__2x2__block__to__be__real_3_01_matrix_type_00_01_qb58fa819a3391e7d55d98ccdc14db9e4_ada4e70275b77aaeb1af07b5141b773e1}{Scalar}}\ z;}
\DoxyCodeLine{00372\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_jacobi_rotation}{JacobiRotation<Scalar>}}\ \mbox{\hyperlink{level1__real__impl_8h_a6085d1e47159b776e841c37e5c45f105}{rot}};}
\DoxyCodeLine{00373\ \ \ \ \ \mbox{\hyperlink{struct_eigen_1_1internal_1_1svd__precondition__2x2__block__to__be__real_3_01_matrix_type_00_01_qb58fa819a3391e7d55d98ccdc14db9e4_a5a0e30c2f4c8f54c4940144c8bd3db0e}{RealScalar}}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}\ =\ \mbox{\hyperlink{_array_cwise_unary_ops_8h_a656b9217a2fcb6de59dc8d1eb3079cc7}{sqrt}}(numext::abs2(work\_matrix.\mbox{\hyperlink{class_eigen_1_1_plain_object_base_aa5a84a35bf7dc5c42abf4a3e9fde222c}{coeff}}(\mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}},\mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}}))\ +\ numext::abs2(work\_matrix.\mbox{\hyperlink{class_eigen_1_1_plain_object_base_aa5a84a35bf7dc5c42abf4a3e9fde222c}{coeff}}(\mbox{\hyperlink{som__graph_8cpp_ae900b2add8deca663438fb20de69acce}{q}},\mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}})));}
\DoxyCodeLine{00374\ }
\DoxyCodeLine{00375\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1svd__precondition__2x2__block__to__be__real_3_01_matrix_type_00_01_qb58fa819a3391e7d55d98ccdc14db9e4_a5a0e30c2f4c8f54c4940144c8bd3db0e}{RealScalar}}\ considerAsZero\ =\ (std::numeric\_limits<RealScalar>::min)();}
\DoxyCodeLine{00376\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1svd__precondition__2x2__block__to__be__real_3_01_matrix_type_00_01_qb58fa819a3391e7d55d98ccdc14db9e4_a5a0e30c2f4c8f54c4940144c8bd3db0e}{RealScalar}}\ precision\ =\ \mbox{\hyperlink{struct_eigen_1_1_generic_num_traits_aadcf7fa75b2bc9a0e461a3b851d836a7}{NumTraits<Scalar>::epsilon}}();}
\DoxyCodeLine{00377\ }
\DoxyCodeLine{00378\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}==0)}
\DoxyCodeLine{00379\ \ \ \ \ \{}
\DoxyCodeLine{00380\ \ \ \ \ \ \ \textcolor{comment}{//\ make\ sure\ first\ column\ is\ zero}}
\DoxyCodeLine{00381\ \ \ \ \ \ \ work\_matrix.\mbox{\hyperlink{class_eigen_1_1_matrix_aec085505a683eaffbd9b6680e99611af}{coeffRef}}(\mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}},\mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}})\ =\ work\_matrix.\mbox{\hyperlink{class_eigen_1_1_matrix_aec085505a683eaffbd9b6680e99611af}{coeffRef}}(\mbox{\hyperlink{som__graph_8cpp_ae900b2add8deca663438fb20de69acce}{q}},\mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}})\ =\ \mbox{\hyperlink{bench__gemm_8cpp_a052eb942d12b6404aade6fae4b075fb9}{Scalar}}(0);}
\DoxyCodeLine{00382\ }
\DoxyCodeLine{00383\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{datatypes_8h_a3aa069ac3980707dae1e0530f50d59e4}{abs}}(numext::imag(work\_matrix.\mbox{\hyperlink{class_eigen_1_1_plain_object_base_aa5a84a35bf7dc5c42abf4a3e9fde222c}{coeff}}(\mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}},\mbox{\hyperlink{som__graph_8cpp_ae900b2add8deca663438fb20de69acce}{q}})))>considerAsZero)}
\DoxyCodeLine{00384\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00385\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ work\_matrix.coeff(p,q)\ can\ be\ zero\ if\ work\_matrix.coeff(q,p)\ is\ not\ zero\ but\ small\ enough\ to\ underflow\ when\ computing\ n}}
\DoxyCodeLine{00386\ \ \ \ \ \ \ \ \ z\ =\ \mbox{\hyperlink{datatypes_8h_a3aa069ac3980707dae1e0530f50d59e4}{abs}}(work\_matrix.\mbox{\hyperlink{class_eigen_1_1_plain_object_base_aa5a84a35bf7dc5c42abf4a3e9fde222c}{coeff}}(\mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}},\mbox{\hyperlink{som__graph_8cpp_ae900b2add8deca663438fb20de69acce}{q}}))\ /\ work\_matrix.\mbox{\hyperlink{class_eigen_1_1_plain_object_base_aa5a84a35bf7dc5c42abf4a3e9fde222c}{coeff}}(\mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}},\mbox{\hyperlink{som__graph_8cpp_ae900b2add8deca663438fb20de69acce}{q}});}
\DoxyCodeLine{00387\ \ \ \ \ \ \ \ \ work\_matrix.row(\mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}})\ *=\ z;}
\DoxyCodeLine{00388\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.computeU())\ \mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.m\_matrixU.col(\mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}})\ *=\ \mbox{\hyperlink{exceptions_8cpp_a75f785bf0f51cbc94279c80d143642ae}{conj}}(z);}
\DoxyCodeLine{00389\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00390\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{datatypes_8h_a3aa069ac3980707dae1e0530f50d59e4}{abs}}(numext::imag(work\_matrix.\mbox{\hyperlink{class_eigen_1_1_plain_object_base_aa5a84a35bf7dc5c42abf4a3e9fde222c}{coeff}}(\mbox{\hyperlink{som__graph_8cpp_ae900b2add8deca663438fb20de69acce}{q}},\mbox{\hyperlink{som__graph_8cpp_ae900b2add8deca663438fb20de69acce}{q}})))>considerAsZero)}
\DoxyCodeLine{00391\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00392\ \ \ \ \ \ \ \ \ z\ =\ \mbox{\hyperlink{datatypes_8h_a3aa069ac3980707dae1e0530f50d59e4}{abs}}(work\_matrix.\mbox{\hyperlink{class_eigen_1_1_plain_object_base_aa5a84a35bf7dc5c42abf4a3e9fde222c}{coeff}}(\mbox{\hyperlink{som__graph_8cpp_ae900b2add8deca663438fb20de69acce}{q}},\mbox{\hyperlink{som__graph_8cpp_ae900b2add8deca663438fb20de69acce}{q}}))\ /\ work\_matrix.\mbox{\hyperlink{class_eigen_1_1_plain_object_base_aa5a84a35bf7dc5c42abf4a3e9fde222c}{coeff}}(\mbox{\hyperlink{som__graph_8cpp_ae900b2add8deca663438fb20de69acce}{q}},\mbox{\hyperlink{som__graph_8cpp_ae900b2add8deca663438fb20de69acce}{q}});}
\DoxyCodeLine{00393\ \ \ \ \ \ \ \ \ work\_matrix.row(\mbox{\hyperlink{som__graph_8cpp_ae900b2add8deca663438fb20de69acce}{q}})\ *=\ z;}
\DoxyCodeLine{00394\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.computeU())\ \mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.m\_matrixU.col(\mbox{\hyperlink{som__graph_8cpp_ae900b2add8deca663438fb20de69acce}{q}})\ *=\ \mbox{\hyperlink{exceptions_8cpp_a75f785bf0f51cbc94279c80d143642ae}{conj}}(z);}
\DoxyCodeLine{00395\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00396\ \ \ \ \ \ \ \textcolor{comment}{//\ otherwise\ the\ second\ row\ is\ already\ zero,\ so\ we\ have\ nothing\ to\ do.}}
\DoxyCodeLine{00397\ \ \ \ \ \}}
\DoxyCodeLine{00398\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00399\ \ \ \ \ \{}
\DoxyCodeLine{00400\ \ \ \ \ \ \ \mbox{\hyperlink{level1__real__impl_8h_a6085d1e47159b776e841c37e5c45f105}{rot}}.c()\ =\ \mbox{\hyperlink{exceptions_8cpp_a75f785bf0f51cbc94279c80d143642ae}{conj}}(work\_matrix.\mbox{\hyperlink{class_eigen_1_1_plain_object_base_aa5a84a35bf7dc5c42abf4a3e9fde222c}{coeff}}(\mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}},\mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}}))\ /\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}};}
\DoxyCodeLine{00401\ \ \ \ \ \ \ \mbox{\hyperlink{level1__real__impl_8h_a6085d1e47159b776e841c37e5c45f105}{rot}}.s()\ =\ work\_matrix.\mbox{\hyperlink{class_eigen_1_1_plain_object_base_aa5a84a35bf7dc5c42abf4a3e9fde222c}{coeff}}(\mbox{\hyperlink{som__graph_8cpp_ae900b2add8deca663438fb20de69acce}{q}},\mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}})\ /\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}};}
\DoxyCodeLine{00402\ \ \ \ \ \ \ work\_matrix.applyOnTheLeft(\mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}},\mbox{\hyperlink{som__graph_8cpp_ae900b2add8deca663438fb20de69acce}{q}},\mbox{\hyperlink{level1__real__impl_8h_a6085d1e47159b776e841c37e5c45f105}{rot}});}
\DoxyCodeLine{00403\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.computeU())\ \mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.m\_matrixU.applyOnTheRight(\mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}},\mbox{\hyperlink{som__graph_8cpp_ae900b2add8deca663438fb20de69acce}{q}},\mbox{\hyperlink{level1__real__impl_8h_a6085d1e47159b776e841c37e5c45f105}{rot}}.adjoint());}
\DoxyCodeLine{00404\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{datatypes_8h_a3aa069ac3980707dae1e0530f50d59e4}{abs}}(numext::imag(work\_matrix.\mbox{\hyperlink{class_eigen_1_1_plain_object_base_aa5a84a35bf7dc5c42abf4a3e9fde222c}{coeff}}(\mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}},\mbox{\hyperlink{som__graph_8cpp_ae900b2add8deca663438fb20de69acce}{q}})))>considerAsZero)}
\DoxyCodeLine{00405\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00406\ \ \ \ \ \ \ \ \ z\ =\ \mbox{\hyperlink{datatypes_8h_a3aa069ac3980707dae1e0530f50d59e4}{abs}}(work\_matrix.\mbox{\hyperlink{class_eigen_1_1_plain_object_base_aa5a84a35bf7dc5c42abf4a3e9fde222c}{coeff}}(\mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}},\mbox{\hyperlink{som__graph_8cpp_ae900b2add8deca663438fb20de69acce}{q}}))\ /\ work\_matrix.\mbox{\hyperlink{class_eigen_1_1_plain_object_base_aa5a84a35bf7dc5c42abf4a3e9fde222c}{coeff}}(\mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}},\mbox{\hyperlink{som__graph_8cpp_ae900b2add8deca663438fb20de69acce}{q}});}
\DoxyCodeLine{00407\ \ \ \ \ \ \ \ \ work\_matrix.col(\mbox{\hyperlink{som__graph_8cpp_ae900b2add8deca663438fb20de69acce}{q}})\ *=\ z;}
\DoxyCodeLine{00408\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.computeV())\ \mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.m\_matrixV.col(\mbox{\hyperlink{som__graph_8cpp_ae900b2add8deca663438fb20de69acce}{q}})\ *=\ z;}
\DoxyCodeLine{00409\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00410\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{datatypes_8h_a3aa069ac3980707dae1e0530f50d59e4}{abs}}(numext::imag(work\_matrix.\mbox{\hyperlink{class_eigen_1_1_plain_object_base_aa5a84a35bf7dc5c42abf4a3e9fde222c}{coeff}}(\mbox{\hyperlink{som__graph_8cpp_ae900b2add8deca663438fb20de69acce}{q}},\mbox{\hyperlink{som__graph_8cpp_ae900b2add8deca663438fb20de69acce}{q}})))>considerAsZero)}
\DoxyCodeLine{00411\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00412\ \ \ \ \ \ \ \ \ z\ =\ \mbox{\hyperlink{datatypes_8h_a3aa069ac3980707dae1e0530f50d59e4}{abs}}(work\_matrix.\mbox{\hyperlink{class_eigen_1_1_plain_object_base_aa5a84a35bf7dc5c42abf4a3e9fde222c}{coeff}}(\mbox{\hyperlink{som__graph_8cpp_ae900b2add8deca663438fb20de69acce}{q}},\mbox{\hyperlink{som__graph_8cpp_ae900b2add8deca663438fb20de69acce}{q}}))\ /\ work\_matrix.\mbox{\hyperlink{class_eigen_1_1_plain_object_base_aa5a84a35bf7dc5c42abf4a3e9fde222c}{coeff}}(\mbox{\hyperlink{som__graph_8cpp_ae900b2add8deca663438fb20de69acce}{q}},\mbox{\hyperlink{som__graph_8cpp_ae900b2add8deca663438fb20de69acce}{q}});}
\DoxyCodeLine{00413\ \ \ \ \ \ \ \ \ work\_matrix.row(\mbox{\hyperlink{som__graph_8cpp_ae900b2add8deca663438fb20de69acce}{q}})\ *=\ z;}
\DoxyCodeLine{00414\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.computeU())\ \mbox{\hyperlink{_jacobi_s_v_d__basic_8cpp_a961ad48248cad814fa628db8adefbd42}{svd}}.m\_matrixU.col(\mbox{\hyperlink{som__graph_8cpp_ae900b2add8deca663438fb20de69acce}{q}})\ *=\ \mbox{\hyperlink{exceptions_8cpp_a75f785bf0f51cbc94279c80d143642ae}{conj}}(z);}
\DoxyCodeLine{00415\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00416\ \ \ \ \ \}}
\DoxyCodeLine{00417\ }
\DoxyCodeLine{00418\ \ \ \ \ \textcolor{comment}{//\ update\ largest\ diagonal\ entry}}
\DoxyCodeLine{00419\ \ \ \ \ maxDiagEntry\ =\ \mbox{\hyperlink{namespace_eigen_1_1numext_a29d502349f2ec9897c808e65e0f96eb4}{numext::maxi<RealScalar>}}(maxDiagEntry,\mbox{\hyperlink{namespace_eigen_1_1numext_a29d502349f2ec9897c808e65e0f96eb4}{numext::maxi<RealScalar>}}(\mbox{\hyperlink{datatypes_8h_a3aa069ac3980707dae1e0530f50d59e4}{abs}}(work\_matrix.\mbox{\hyperlink{class_eigen_1_1_plain_object_base_aa5a84a35bf7dc5c42abf4a3e9fde222c}{coeff}}(\mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}},\mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}})),\ \mbox{\hyperlink{datatypes_8h_a3aa069ac3980707dae1e0530f50d59e4}{abs}}(work\_matrix.\mbox{\hyperlink{class_eigen_1_1_plain_object_base_aa5a84a35bf7dc5c42abf4a3e9fde222c}{coeff}}(\mbox{\hyperlink{som__graph_8cpp_ae900b2add8deca663438fb20de69acce}{q}},\mbox{\hyperlink{som__graph_8cpp_ae900b2add8deca663438fb20de69acce}{q}}))));}
\DoxyCodeLine{00420\ \ \ \ \ \textcolor{comment}{//\ and\ check\ whether\ the\ 2x2\ block\ is\ already\ diagonal}}
\DoxyCodeLine{00421\ \ \ \ \ \mbox{\hyperlink{struct_eigen_1_1internal_1_1svd__precondition__2x2__block__to__be__real_3_01_matrix_type_00_01_qb58fa819a3391e7d55d98ccdc14db9e4_a5a0e30c2f4c8f54c4940144c8bd3db0e}{RealScalar}}\ threshold\ =\ \mbox{\hyperlink{namespace_eigen_1_1numext_a29d502349f2ec9897c808e65e0f96eb4}{numext::maxi<RealScalar>}}(considerAsZero,\ precision\ *\ maxDiagEntry);}
\DoxyCodeLine{00422\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{datatypes_8h_a3aa069ac3980707dae1e0530f50d59e4}{abs}}(work\_matrix.\mbox{\hyperlink{class_eigen_1_1_plain_object_base_aa5a84a35bf7dc5c42abf4a3e9fde222c}{coeff}}(\mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}},\mbox{\hyperlink{som__graph_8cpp_ae900b2add8deca663438fb20de69acce}{q}}))>threshold\ ||\ \mbox{\hyperlink{datatypes_8h_a3aa069ac3980707dae1e0530f50d59e4}{abs}}(work\_matrix.\mbox{\hyperlink{class_eigen_1_1_plain_object_base_aa5a84a35bf7dc5c42abf4a3e9fde222c}{coeff}}(\mbox{\hyperlink{som__graph_8cpp_ae900b2add8deca663438fb20de69acce}{q}},\mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}}))\ >\ threshold;}
\DoxyCodeLine{00423\ \ \ \}}
\DoxyCodeLine{00424\ \};}
\DoxyCodeLine{00425\ }
\DoxyCodeLine{00426\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ \_MatrixType,\ \textcolor{keywordtype}{int}\ QRPreconditioner>\ }
\DoxyCodeLine{00427\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_eigen_1_1internal_1_1traits}{traits}}<\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d}{JacobiSVD}}<\_MatrixType,QRPreconditioner>\ >}
\DoxyCodeLine{00428\ \{}
\DoxyCodeLine{00429\ \ \ \textcolor{keyword}{typedef}\ \_MatrixType\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1traits_3_01_jacobi_s_v_d_3_01___matrix_type_00_01_q_r_preconditioner_01_4_01_4_a0c5efadd389b46f324bdee9e47f7c273}{MatrixType}};}
\DoxyCodeLine{00430\ \};}
\DoxyCodeLine{00431\ }
\DoxyCodeLine{00432\ \}\ \textcolor{comment}{//\ end\ namespace\ internal}}
\DoxyCodeLine{00433\ }
\DoxyCodeLine{00487\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ \_MatrixType,\ \textcolor{keywordtype}{int}\ QRPreconditioner>\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a55315ab9cd060019a5ad07be798ff3b9}{JacobiSVD}}}
\DoxyCodeLine{00488\ \ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base_abed06fc6f4b743e1f76a7b317539da87}{SVDBase}}<JacobiSVD<\_MatrixType,QRPreconditioner>\ >}
\DoxyCodeLine{00489\ \{}
\DoxyCodeLine{00490\ \ \ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base_abed06fc6f4b743e1f76a7b317539da87}{SVDBase<JacobiSVD>}}\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a45b9acf6aa7d7fb7635119667a8ab038}{Base}};}
\DoxyCodeLine{00491\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00492\ }
\DoxyCodeLine{00493\ \ \ \ \ \textcolor{keyword}{typedef}\ \_MatrixType\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a2b526fed1f4280249d759b09cadcfded}{MatrixType}};}
\DoxyCodeLine{00494\ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ MatrixType::Scalar\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_af8aa379704163fb6ea722beb615f0862}{Scalar}};}
\DoxyCodeLine{00495\ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{struct_eigen_1_1_generic_num_traits_abca8573812593670795c41f22aa9d5e2}{NumTraits<typename\ MatrixType::Scalar>::Real}}\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a533baa1b09ff7c9056e4be374ea3c788}{RealScalar}};}
\DoxyCodeLine{00496\ \ \ \ \ \textcolor{keyword}{enum}\ \{}
\DoxyCodeLine{00497\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_ab9c9fdb79dfcffec79165bf48b334206ace9ac05e00fc4368629e3f8e3a2cb1ef}{RowsAtCompileTime}}\ =\ MatrixType::RowsAtCompileTime,}
\DoxyCodeLine{00498\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_ab9c9fdb79dfcffec79165bf48b334206aba7009bc3fa7d855e12e176af38d2270}{ColsAtCompileTime}}\ =\ MatrixType::ColsAtCompileTime,}
\DoxyCodeLine{00499\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_ab9c9fdb79dfcffec79165bf48b334206ada1c34752cd977a3a2cef0c2ff573acf}{DiagSizeAtCompileTime}}\ =\ \mbox{\hyperlink{eigen-3_83_87_2_eigen_2src_2_core_2util_2_macros_8h_a2a07ba221d47a7d636fd13678c8c75b3}{EIGEN\_SIZE\_MIN\_PREFER\_DYNAMIC}}(\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_ab9c9fdb79dfcffec79165bf48b334206ace9ac05e00fc4368629e3f8e3a2cb1ef}{RowsAtCompileTime}},\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_ab9c9fdb79dfcffec79165bf48b334206aba7009bc3fa7d855e12e176af38d2270}{ColsAtCompileTime}}),}
\DoxyCodeLine{00500\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_ab9c9fdb79dfcffec79165bf48b334206a36a5817babc0f0c463525e62aa015fd5}{MaxRowsAtCompileTime}}\ =\ MatrixType::MaxRowsAtCompileTime,}
\DoxyCodeLine{00501\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_ab9c9fdb79dfcffec79165bf48b334206ab1a42a23c36344b0dad9508fe820828c}{MaxColsAtCompileTime}}\ =\ MatrixType::MaxColsAtCompileTime,}
\DoxyCodeLine{00502\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_ab9c9fdb79dfcffec79165bf48b334206a653bceb920ae9ca29f01380ebb0667e9}{MaxDiagSizeAtCompileTime}}\ =\ \mbox{\hyperlink{eigen-3_83_87_2_eigen_2src_2_core_2util_2_macros_8h_af2d58514e6156c4da2d4af66fafd0b12}{EIGEN\_SIZE\_MIN\_PREFER\_FIXED}}(\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_ab9c9fdb79dfcffec79165bf48b334206a36a5817babc0f0c463525e62aa015fd5}{MaxRowsAtCompileTime}},\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_ab9c9fdb79dfcffec79165bf48b334206ab1a42a23c36344b0dad9508fe820828c}{MaxColsAtCompileTime}}),}
\DoxyCodeLine{00503\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_ab9c9fdb79dfcffec79165bf48b334206ae357a5a3dd2e6bd14bd94c15de1de2be}{MatrixOptions}}\ =\ MatrixType::Options}
\DoxyCodeLine{00504\ \ \ \ \ \};}
\DoxyCodeLine{00505\ }
\DoxyCodeLine{00506\ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base_ab62c306c5d1efeae9bce88dee1b04965}{Base::MatrixUType}}\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a8b2e5e357eb839e65cee7f4d56962906}{MatrixUType}};}
\DoxyCodeLine{00507\ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base_af2ec05d33dd5be28df6fcf56346e23ec}{Base::MatrixVType}}\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a08597d375e3ba00f089e1f3dd994739a}{MatrixVType}};}
\DoxyCodeLine{00508\ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a12b2496fb3a6e0e1faa3e6723ced20b7}{Base::SingularValuesType}}\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_aa984693f000ee4bb8b97a8745ce4fc3f}{SingularValuesType}};}
\DoxyCodeLine{00509\ \ \ \ \ }
\DoxyCodeLine{00510\ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1plain__row__type_a46f848dfbee390d779e1e04070126d25}{internal::plain\_row\_type<MatrixType>::type}}\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a207a070b273d496fed8ae023dc65bc1d}{RowType}};}
\DoxyCodeLine{00511\ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1plain__col__type_a50d7bd17cb1a08813dc6d2c58cae4261}{internal::plain\_col\_type<MatrixType>::type}}\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_aa0f11b5e8b126ff21937e8a08781a50d}{ColType}};}
\DoxyCodeLine{00512\ \ \ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{class_eigen_1_1_matrix}{Matrix}}<\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_af8aa379704163fb6ea722beb615f0862}{Scalar}},\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_ab9c9fdb79dfcffec79165bf48b334206ada1c34752cd977a3a2cef0c2ff573acf}{DiagSizeAtCompileTime}},\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_ab9c9fdb79dfcffec79165bf48b334206ada1c34752cd977a3a2cef0c2ff573acf}{DiagSizeAtCompileTime}},}
\DoxyCodeLine{00513\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_ab9c9fdb79dfcffec79165bf48b334206ae357a5a3dd2e6bd14bd94c15de1de2be}{MatrixOptions}},\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_ab9c9fdb79dfcffec79165bf48b334206a653bceb920ae9ca29f01380ebb0667e9}{MaxDiagSizeAtCompileTime}},\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_ab9c9fdb79dfcffec79165bf48b334206a653bceb920ae9ca29f01380ebb0667e9}{MaxDiagSizeAtCompileTime}}>}
\DoxyCodeLine{00514\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a2340597ffb613aec7aeff16310d19639}{WorkMatrixType}};}
\DoxyCodeLine{00515\ }
\DoxyCodeLine{00521\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a55315ab9cd060019a5ad07be798ff3b9}{JacobiSVD}}()}
\DoxyCodeLine{00522\ \ \ \ \ \{\}}
\DoxyCodeLine{00523\ }
\DoxyCodeLine{00524\ }
\DoxyCodeLine{00531\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a5d9ea7c8f361337727260efd77ee03ac}{JacobiSVD}}(\mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a67ad0315cc1ddc76674810669aac775d}{rows}},\ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a335f73c6b4b137ae04c7dee723195aab}{cols}},\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ computationOptions\ =\ 0)}
\DoxyCodeLine{00532\ \ \ \ \ \{}
\DoxyCodeLine{00533\ \ \ \ \ \ \ \mbox{\hyperlink{allocator_8c_a3a4fc1fa103fa3a33fc168de4cd6703e}{allocate}}(\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a67ad0315cc1ddc76674810669aac775d}{rows}},\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a335f73c6b4b137ae04c7dee723195aab}{cols}},\ computationOptions);}
\DoxyCodeLine{00534\ \ \ \ \ \}}
\DoxyCodeLine{00535\ }
\DoxyCodeLine{00546\ \ \ \ \ \textcolor{keyword}{explicit}\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_abfd1dd454a6e3edec7feecd97c818a78}{JacobiSVD}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a2b526fed1f4280249d759b09cadcfded}{MatrixType}}\&\ \mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}},\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ computationOptions\ =\ 0)}
\DoxyCodeLine{00547\ \ \ \ \ \{}
\DoxyCodeLine{00548\ \ \ \ \ \ \ \mbox{\hyperlink{dense__solvers_8cpp_a8ef543dd0111424127c81cdd31f3753a}{compute}}(\mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}},\ computationOptions);}
\DoxyCodeLine{00549\ \ \ \ \ \}}
\DoxyCodeLine{00550\ }
\DoxyCodeLine{00561\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a55315ab9cd060019a5ad07be798ff3b9}{JacobiSVD}}\&\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a5dab376cc86cf0d36674bcdad4af3f5a}{compute}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a2b526fed1f4280249d759b09cadcfded}{MatrixType}}\&\ \mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}},\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ computationOptions);}
\DoxyCodeLine{00562\ }
\DoxyCodeLine{00569\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a55315ab9cd060019a5ad07be798ff3b9}{JacobiSVD}}\&\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a408ef2580962859ff292eca69aa4b976}{compute}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a2b526fed1f4280249d759b09cadcfded}{MatrixType}}\&\ \mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}})}
\DoxyCodeLine{00570\ \ \ \ \ \{}
\DoxyCodeLine{00571\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{dense__solvers_8cpp_a8ef543dd0111424127c81cdd31f3753a}{compute}}(\mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}},\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_aeb792d55f09119d57d3143bff4d6852e}{m\_computationOptions}});}
\DoxyCodeLine{00572\ \ \ \ \ \}}
\DoxyCodeLine{00573\ }
\DoxyCodeLine{00574\ \ \ \ \ \textcolor{keyword}{using\ }Base::computeU;}
\DoxyCodeLine{00575\ \ \ \ \ \textcolor{keyword}{using\ }Base::computeV;}
\DoxyCodeLine{00576\ \ \ \ \ \textcolor{keyword}{using\ }Base::rows;}
\DoxyCodeLine{00577\ \ \ \ \ \textcolor{keyword}{using\ }Base::cols;}
\DoxyCodeLine{00578\ \ \ \ \ \textcolor{keyword}{using\ }Base::rank;}
\DoxyCodeLine{00579\ }
\DoxyCodeLine{00580\ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00581\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a364fe8a222ebcc6ba0e605dfd4c6016a}{allocate}}(\mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a67ad0315cc1ddc76674810669aac775d}{rows}},\ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a335f73c6b4b137ae04c7dee723195aab}{cols}},\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ computationOptions);}
\DoxyCodeLine{00582\ }
\DoxyCodeLine{00583\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00584\ \ \ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{class_eigen_1_1_s_v_d_base_af0e0b3833c1d49286c0fdcbc023c3bd8}{Base::m\_matrixU}};}
\DoxyCodeLine{00585\ \ \ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a69cf1cfb527ff5562156c13bdca45ca5}{Base::m\_matrixV}};}
\DoxyCodeLine{00586\ \ \ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{class_eigen_1_1_s_v_d_base_ab71e31e61c33f68ff2f499ed9f30e718}{Base::m\_singularValues}};}
\DoxyCodeLine{00587\ \ \ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a633b92f4eb9c65911b943b93bb8b341c}{Base::m\_isInitialized}};}
\DoxyCodeLine{00588\ \ \ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{class_eigen_1_1_s_v_d_base_af91d9b16ff9b51e22bfb9b637ef50cfb}{Base::m\_isAllocated}};}
\DoxyCodeLine{00589\ \ \ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a1dd5193fac24ae397f08cc722f3ae3ca}{Base::m\_usePrescribedThreshold}};}
\DoxyCodeLine{00590\ \ \ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{class_eigen_1_1_s_v_d_base_ad6f49fd8f826a41109f8eb68e2f48dc4}{Base::m\_computeFullU}};}
\DoxyCodeLine{00591\ \ \ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a47b67c55d69ba645bb7ae32bb5466138}{Base::m\_computeThinU}};}
\DoxyCodeLine{00592\ \ \ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a1eec8ead08bc9cd1729ba9ba7beb6b41}{Base::m\_computeFullV}};}
\DoxyCodeLine{00593\ \ \ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{class_eigen_1_1_s_v_d_base_ac8321ff2cbf3b82f5c2638b9de6661af}{Base::m\_computeThinV}};}
\DoxyCodeLine{00594\ \ \ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a680646d2f3fa0de030cbf9b4815d6cda}{Base::m\_computationOptions}};}
\DoxyCodeLine{00595\ \ \ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{class_eigen_1_1_s_v_d_base_aa41b395662650f2e10652f76365877c4}{Base::m\_nonzeroSingularValues}};}
\DoxyCodeLine{00596\ \ \ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a9c7ac2fc2666e3d34143c726a6462f1f}{Base::m\_rows}};}
\DoxyCodeLine{00597\ \ \ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a65e1a36d7d3d90ad143fa6a6494695c9}{Base::m\_cols}};}
\DoxyCodeLine{00598\ \ \ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6eca3829eb56684ca01c291c6630c8d8}{Base::m\_diagSize}};}
\DoxyCodeLine{00599\ \ \ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{class_eigen_1_1_s_v_d_base_abbc1cfb200cc681ca18bdb1892597e62}{Base::m\_prescribedThreshold}};}
\DoxyCodeLine{00600\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a2340597ffb613aec7aeff16310d19639}{WorkMatrixType}}\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a4d68a51c9138c05942b97482cea88a37}{m\_workMatrix}};}
\DoxyCodeLine{00601\ }
\DoxyCodeLine{00602\ \ \ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ \_\_MatrixType,\ \textcolor{keywordtype}{int}\ \_QRPreconditioner,\ \textcolor{keywordtype}{bool}\ \_IsComplex>}
\DoxyCodeLine{00603\ \ \ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_eigen_1_1internal_1_1svd__precondition__2x2__block__to__be__real}{internal::svd\_precondition\_2x2\_block\_to\_be\_real}};}
\DoxyCodeLine{00604\ \ \ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ \_\_MatrixType,\ \textcolor{keywordtype}{int}\ \_QRPreconditioner,\ \textcolor{keywordtype}{int}\ \_Case,\ \textcolor{keywordtype}{bool}\ \_DoAnything>}
\DoxyCodeLine{00605\ \ \ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_eigen_1_1internal_1_1qr__preconditioner__impl}{internal::qr\_preconditioner\_impl}};}
\DoxyCodeLine{00606\ }
\DoxyCodeLine{00607\ \ \ \ \ \mbox{\hyperlink{struct_eigen_1_1internal_1_1qr__preconditioner__impl}{internal::qr\_preconditioner\_impl<MatrixType,\ QRPreconditioner,\ internal::PreconditionIfMoreColsThanRows>}}\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a496e62e1757d99dfb394c14be25bffb2}{m\_qr\_precond\_morecols}};}
\DoxyCodeLine{00608\ \ \ \ \ \mbox{\hyperlink{struct_eigen_1_1internal_1_1qr__preconditioner__impl}{internal::qr\_preconditioner\_impl<MatrixType,\ QRPreconditioner,\ internal::PreconditionIfMoreRowsThanCols>}}\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_ac0a41538ddc23f75c34175755813b041}{m\_qr\_precond\_morerows}};}
\DoxyCodeLine{00609\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a2b526fed1f4280249d759b09cadcfded}{MatrixType}}\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a0b861908151379c8f9002f6d56e69107}{m\_scaledMatrix}};}
\DoxyCodeLine{00610\ \};}
\DoxyCodeLine{00611\ }
\DoxyCodeLine{00612\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ MatrixType,\ \textcolor{keywordtype}{int}\ QRPreconditioner>}
\DoxyCodeLine{00613\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a364fe8a222ebcc6ba0e605dfd4c6016a}{JacobiSVD<MatrixType,\ QRPreconditioner>::allocate}}(\mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a67ad0315cc1ddc76674810669aac775d}{rows}},\ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a335f73c6b4b137ae04c7dee723195aab}{cols}},\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ computationOptions)}
\DoxyCodeLine{00614\ \{}
\DoxyCodeLine{00615\ \ \ \mbox{\hyperlink{eigen-3_83_87_2_eigen_2src_2_core_2util_2_macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a67ad0315cc1ddc76674810669aac775d}{rows}}\ >=\ 0\ \&\&\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a335f73c6b4b137ae04c7dee723195aab}{cols}}\ >=\ 0);}
\DoxyCodeLine{00616\ }
\DoxyCodeLine{00617\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a8f66464f4392a7488d2f68621f4ad413}{m\_isAllocated}}\ \&\&}
\DoxyCodeLine{00618\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a67ad0315cc1ddc76674810669aac775d}{rows}}\ ==\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_aa69497b0251d5beeb72b6cd0c235e8c2}{m\_rows}}\ \&\&}
\DoxyCodeLine{00619\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a335f73c6b4b137ae04c7dee723195aab}{cols}}\ ==\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a2eb7a9bddc49e588280d2397a3005a35}{m\_cols}}\ \&\&}
\DoxyCodeLine{00620\ \ \ \ \ \ \ computationOptions\ ==\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_aeb792d55f09119d57d3143bff4d6852e}{m\_computationOptions}})}
\DoxyCodeLine{00621\ \ \ \{}
\DoxyCodeLine{00622\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00623\ \ \ \}}
\DoxyCodeLine{00624\ }
\DoxyCodeLine{00625\ \ \ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_aa69497b0251d5beeb72b6cd0c235e8c2}{m\_rows}}\ =\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a67ad0315cc1ddc76674810669aac775d}{rows}};}
\DoxyCodeLine{00626\ \ \ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a2eb7a9bddc49e588280d2397a3005a35}{m\_cols}}\ =\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a335f73c6b4b137ae04c7dee723195aab}{cols}};}
\DoxyCodeLine{00627\ \ \ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_af3675dcc1726cccd2cdacfbb2b7545e5}{m\_isInitialized}}\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00628\ \ \ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a8f66464f4392a7488d2f68621f4ad413}{m\_isAllocated}}\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00629\ \ \ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_aeb792d55f09119d57d3143bff4d6852e}{m\_computationOptions}}\ =\ computationOptions;}
\DoxyCodeLine{00630\ \ \ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_ad24eb26c9819d577e8a2d9ef03935fa9}{m\_computeFullU}}\ =\ (computationOptions\ \&\ \mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a9fa9302d510cee20c26311154937e23f}{ComputeFullU}})\ !=\ 0;}
\DoxyCodeLine{00631\ \ \ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a709a47c97923200c5f0d2b27a8707d61}{m\_computeThinU}}\ =\ (computationOptions\ \&\ \mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9aa7fb4e98834788d0b1b0f2b8467d2527}{ComputeThinU}})\ !=\ 0;}
\DoxyCodeLine{00632\ \ \ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_ab2e89ef5e2e3cb0f3e6750e8596d679d}{m\_computeFullV}}\ =\ (computationOptions\ \&\ \mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a36581f7c662f7def31efd500c284f930}{ComputeFullV}})\ !=\ 0;}
\DoxyCodeLine{00633\ \ \ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a998be515dba125f6c37969327ca41e20}{m\_computeThinV}}\ =\ (computationOptions\ \&\ \mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a540036417bfecf2e791a70948c227f47}{ComputeThinV}})\ !=\ 0;}
\DoxyCodeLine{00634\ \ \ \mbox{\hyperlink{eigen-3_83_87_2_eigen_2src_2_core_2util_2_macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(!(\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_ad24eb26c9819d577e8a2d9ef03935fa9}{m\_computeFullU}}\ \&\&\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a709a47c97923200c5f0d2b27a8707d61}{m\_computeThinU}})\ \&\&\ \textcolor{stringliteral}{"{}JacobiSVD:\ you\ can't\ ask\ for\ both\ full\ and\ thin\ U"{}});}
\DoxyCodeLine{00635\ \ \ \mbox{\hyperlink{eigen-3_83_87_2_eigen_2src_2_core_2util_2_macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(!(\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_ab2e89ef5e2e3cb0f3e6750e8596d679d}{m\_computeFullV}}\ \&\&\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a998be515dba125f6c37969327ca41e20}{m\_computeThinV}})\ \&\&\ \textcolor{stringliteral}{"{}JacobiSVD:\ you\ can't\ ask\ for\ both\ full\ and\ thin\ V"{}});}
\DoxyCodeLine{00636\ \ \ \mbox{\hyperlink{eigen-3_83_87_2_eigen_2src_2_core_2util_2_macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(\mbox{\hyperlink{eigen-3_83_87_2_eigen_2src_2_core_2util_2_macros_8h_ae309c2778566c4bd7c2801a61f8b7c6c}{EIGEN\_IMPLIES}}(\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a709a47c97923200c5f0d2b27a8707d61}{m\_computeThinU}}\ ||\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a998be515dba125f6c37969327ca41e20}{m\_computeThinV}},\ MatrixType::ColsAtCompileTime==\mbox{\hyperlink{namespace_eigen_ad81fa7195215a0ce30017dfac309f0b2}{Dynamic}})\ \&\&}
\DoxyCodeLine{00637\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}JacobiSVD:\ thin\ U\ and\ V\ are\ only\ available\ when\ your\ matrix\ has\ a\ dynamic\ number\ of\ columns."{}});}
\DoxyCodeLine{00638\ \ \ \textcolor{keywordflow}{if}\ (QRPreconditioner\ ==\ \mbox{\hyperlink{group__enums_gga46eba0d5c621f590b8cf1b53af31d56eabd745dcaff7019c5f918c68809e5ea50}{FullPivHouseholderQRPreconditioner}})}
\DoxyCodeLine{00639\ \ \ \{}
\DoxyCodeLine{00640\ \ \ \ \ \ \ \mbox{\hyperlink{eigen-3_83_87_2_eigen_2src_2_core_2util_2_macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(!(\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a709a47c97923200c5f0d2b27a8707d61}{m\_computeThinU}}\ ||\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a998be515dba125f6c37969327ca41e20}{m\_computeThinV}})\ \&\&}
\DoxyCodeLine{00641\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}JacobiSVD:\ can't\ compute\ thin\ U\ or\ thin\ V\ with\ the\ FullPivHouseholderQR\ preconditioner.\ "{}}}
\DoxyCodeLine{00642\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Use\ the\ ColPivHouseholderQR\ preconditioner\ instead."{}});}
\DoxyCodeLine{00643\ \ \ \}}
\DoxyCodeLine{00644\ \ \ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a194a8784cb5b08d4faa92a4bdda89fda}{m\_diagSize}}\ =\ (\mbox{\hyperlink{namespacestd_ac7b9885417769949d76890454b6d072e}{std::min}})(\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_aa69497b0251d5beeb72b6cd0c235e8c2}{m\_rows}},\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a2eb7a9bddc49e588280d2397a3005a35}{m\_cols}});}
\DoxyCodeLine{00645\ \ \ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a324c11555db31965f5b871434c3e1f4e}{m\_singularValues}}.resize(\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a194a8784cb5b08d4faa92a4bdda89fda}{m\_diagSize}});}
\DoxyCodeLine{00646\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_ab9c9fdb79dfcffec79165bf48b334206ace9ac05e00fc4368629e3f8e3a2cb1ef}{RowsAtCompileTime}}==\mbox{\hyperlink{namespace_eigen_ad81fa7195215a0ce30017dfac309f0b2}{Dynamic}})}
\DoxyCodeLine{00647\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a23702501edc888c10fba9d3e05ceab38}{m\_matrixU}}.resize(\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_aa69497b0251d5beeb72b6cd0c235e8c2}{m\_rows}},\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_ad24eb26c9819d577e8a2d9ef03935fa9}{m\_computeFullU}}\ ?\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_aa69497b0251d5beeb72b6cd0c235e8c2}{m\_rows}}}
\DoxyCodeLine{00648\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a709a47c97923200c5f0d2b27a8707d61}{m\_computeThinU}}\ ?\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a194a8784cb5b08d4faa92a4bdda89fda}{m\_diagSize}}}
\DoxyCodeLine{00649\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ 0);}
\DoxyCodeLine{00650\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_ab9c9fdb79dfcffec79165bf48b334206aba7009bc3fa7d855e12e176af38d2270}{ColsAtCompileTime}}==\mbox{\hyperlink{namespace_eigen_ad81fa7195215a0ce30017dfac309f0b2}{Dynamic}})}
\DoxyCodeLine{00651\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a5094132b12c7528bcc7edac72f137f22}{m\_matrixV}}.resize(\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a2eb7a9bddc49e588280d2397a3005a35}{m\_cols}},\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_ab2e89ef5e2e3cb0f3e6750e8596d679d}{m\_computeFullV}}\ ?\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a2eb7a9bddc49e588280d2397a3005a35}{m\_cols}}}
\DoxyCodeLine{00652\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a998be515dba125f6c37969327ca41e20}{m\_computeThinV}}\ ?\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a194a8784cb5b08d4faa92a4bdda89fda}{m\_diagSize}}}
\DoxyCodeLine{00653\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ 0);}
\DoxyCodeLine{00654\ \ \ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a4d68a51c9138c05942b97482cea88a37}{m\_workMatrix}}.resize(\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a194a8784cb5b08d4faa92a4bdda89fda}{m\_diagSize}},\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a194a8784cb5b08d4faa92a4bdda89fda}{m\_diagSize}});}
\DoxyCodeLine{00655\ \ \ }
\DoxyCodeLine{00656\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a2eb7a9bddc49e588280d2397a3005a35}{m\_cols}}>\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_aa69497b0251d5beeb72b6cd0c235e8c2}{m\_rows}})\ \ \ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a496e62e1757d99dfb394c14be25bffb2}{m\_qr\_precond\_morecols}}.allocate(*\textcolor{keyword}{this});}
\DoxyCodeLine{00657\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_aa69497b0251d5beeb72b6cd0c235e8c2}{m\_rows}}>\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a2eb7a9bddc49e588280d2397a3005a35}{m\_cols}})\ \ \ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_ac0a41538ddc23f75c34175755813b041}{m\_qr\_precond\_morerows}}.allocate(*\textcolor{keyword}{this});}
\DoxyCodeLine{00658\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_aa69497b0251d5beeb72b6cd0c235e8c2}{m\_rows}}!=\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a2eb7a9bddc49e588280d2397a3005a35}{m\_cols}})\ \ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a0b861908151379c8f9002f6d56e69107}{m\_scaledMatrix}}.resize(\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a67ad0315cc1ddc76674810669aac775d}{rows}},\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a335f73c6b4b137ae04c7dee723195aab}{cols}});}
\DoxyCodeLine{00659\ \}}
\DoxyCodeLine{00660\ }
\DoxyCodeLine{00661\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ MatrixType,\ \textcolor{keywordtype}{int}\ QRPreconditioner>}
\DoxyCodeLine{00662\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d}{JacobiSVD<MatrixType,\ QRPreconditioner>}}\&}
\DoxyCodeLine{00663\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a5dab376cc86cf0d36674bcdad4af3f5a}{JacobiSVD<MatrixType,\ QRPreconditioner>::compute}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a2b526fed1f4280249d759b09cadcfded}{MatrixType}}\&\ \mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}},\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ computationOptions)}
\DoxyCodeLine{00664\ \{}
\DoxyCodeLine{00665\ \ \ \textcolor{keyword}{using\ }std::abs;}
\DoxyCodeLine{00666\ \ \ \mbox{\hyperlink{allocator_8c_a3a4fc1fa103fa3a33fc168de4cd6703e}{allocate}}(\mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}}.rows(),\ \mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}}.cols(),\ computationOptions);}
\DoxyCodeLine{00667\ }
\DoxyCodeLine{00668\ \ \ \textcolor{comment}{//\ currently\ we\ stop\ when\ we\ reach\ precision\ 2*epsilon\ as\ the\ last\ bit\ of\ precision\ can\ require\ an\ unreasonable\ number\ of\ iterations,}}
\DoxyCodeLine{00669\ \ \ \textcolor{comment}{//\ only\ worsening\ the\ precision\ of\ U\ and\ V\ as\ we\ accumulate\ more\ rotations}}
\DoxyCodeLine{00670\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a533baa1b09ff7c9056e4be374ea3c788}{RealScalar}}\ precision\ =\ \mbox{\hyperlink{bench__gemm_8cpp_acb5c3dc237f99cf17167e8a629f01b43}{RealScalar}}(2)\ *\ \mbox{\hyperlink{struct_eigen_1_1_generic_num_traits_aadcf7fa75b2bc9a0e461a3b851d836a7}{NumTraits<Scalar>::epsilon}}();}
\DoxyCodeLine{00671\ }
\DoxyCodeLine{00672\ \ \ \textcolor{comment}{//\ limit\ for\ denormal\ numbers\ to\ be\ considered\ zero\ in\ order\ to\ avoid\ infinite\ loops\ (see\ bug\ 286)}}
\DoxyCodeLine{00673\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a533baa1b09ff7c9056e4be374ea3c788}{RealScalar}}\ considerAsZero\ =\ (std::numeric\_limits<RealScalar>::min)();}
\DoxyCodeLine{00674\ }
\DoxyCodeLine{00675\ \ \ \textcolor{comment}{//\ Scaling\ factor\ to\ reduce\ over/under-\/flows}}
\DoxyCodeLine{00676\ \ \ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a533baa1b09ff7c9056e4be374ea3c788}{RealScalar}}\ \mbox{\hyperlink{gnuplot__common__settings_8hh_a028be1055fb10c679b6153f8dcd0befa}{scale}}\ =\ \mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}}.cwiseAbs().maxCoeff();}
\DoxyCodeLine{00677\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{gnuplot__common__settings_8hh_a028be1055fb10c679b6153f8dcd0befa}{scale}}==\mbox{\hyperlink{bench__gemm_8cpp_acb5c3dc237f99cf17167e8a629f01b43}{RealScalar}}(0))\ \mbox{\hyperlink{gnuplot__common__settings_8hh_a028be1055fb10c679b6153f8dcd0befa}{scale}}\ =\ \mbox{\hyperlink{bench__gemm_8cpp_acb5c3dc237f99cf17167e8a629f01b43}{RealScalar}}(1);}
\DoxyCodeLine{00678\ \ \ }
\DoxyCodeLine{00679\ \textcolor{comment}{\ \ /***\ step\ 1.\ The\ R-\/SVD\ step:\ we\ use\ a\ QR\ decomposition\ to\ reduce\ to\ the\ case\ of\ a\ square\ matrix\ */}}
\DoxyCodeLine{00680\ }
\DoxyCodeLine{00681\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_aa69497b0251d5beeb72b6cd0c235e8c2}{m\_rows}}!=\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a2eb7a9bddc49e588280d2397a3005a35}{m\_cols}})}
\DoxyCodeLine{00682\ \ \ \{}
\DoxyCodeLine{00683\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a0b861908151379c8f9002f6d56e69107}{m\_scaledMatrix}}\ =\ \mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}}\ /\ \mbox{\hyperlink{gnuplot__common__settings_8hh_a028be1055fb10c679b6153f8dcd0befa}{scale}};}
\DoxyCodeLine{00684\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a496e62e1757d99dfb394c14be25bffb2}{m\_qr\_precond\_morecols}}.run(*\textcolor{keyword}{this},\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a0b861908151379c8f9002f6d56e69107}{m\_scaledMatrix}});}
\DoxyCodeLine{00685\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_ac0a41538ddc23f75c34175755813b041}{m\_qr\_precond\_morerows}}.run(*\textcolor{keyword}{this},\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a0b861908151379c8f9002f6d56e69107}{m\_scaledMatrix}});}
\DoxyCodeLine{00686\ \ \ \}}
\DoxyCodeLine{00687\ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00688\ \ \ \{}
\DoxyCodeLine{00689\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a4d68a51c9138c05942b97482cea88a37}{m\_workMatrix}}\ =\ \mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}}.block(0,0,\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a194a8784cb5b08d4faa92a4bdda89fda}{m\_diagSize}},\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a194a8784cb5b08d4faa92a4bdda89fda}{m\_diagSize}})\ /\ \mbox{\hyperlink{gnuplot__common__settings_8hh_a028be1055fb10c679b6153f8dcd0befa}{scale}};}
\DoxyCodeLine{00690\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_ad24eb26c9819d577e8a2d9ef03935fa9}{m\_computeFullU}})\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a23702501edc888c10fba9d3e05ceab38}{m\_matrixU}}.setIdentity(\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_aa69497b0251d5beeb72b6cd0c235e8c2}{m\_rows}},\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_aa69497b0251d5beeb72b6cd0c235e8c2}{m\_rows}});}
\DoxyCodeLine{00691\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a709a47c97923200c5f0d2b27a8707d61}{m\_computeThinU}})\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a23702501edc888c10fba9d3e05ceab38}{m\_matrixU}}.setIdentity(\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_aa69497b0251d5beeb72b6cd0c235e8c2}{m\_rows}},\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a194a8784cb5b08d4faa92a4bdda89fda}{m\_diagSize}});}
\DoxyCodeLine{00692\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_ab2e89ef5e2e3cb0f3e6750e8596d679d}{m\_computeFullV}})\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a5094132b12c7528bcc7edac72f137f22}{m\_matrixV}}.setIdentity(\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a2eb7a9bddc49e588280d2397a3005a35}{m\_cols}},\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a2eb7a9bddc49e588280d2397a3005a35}{m\_cols}});}
\DoxyCodeLine{00693\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a998be515dba125f6c37969327ca41e20}{m\_computeThinV}})\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a5094132b12c7528bcc7edac72f137f22}{m\_matrixV}}.setIdentity(\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a2eb7a9bddc49e588280d2397a3005a35}{m\_cols}},\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a194a8784cb5b08d4faa92a4bdda89fda}{m\_diagSize}});}
\DoxyCodeLine{00694\ \ \ \}}
\DoxyCodeLine{00695\ }
\DoxyCodeLine{00696\ \textcolor{comment}{\ \ /***\ step\ 2.\ The\ main\ Jacobi\ SVD\ iteration.\ ***/}}
\DoxyCodeLine{00697\ \ \ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a533baa1b09ff7c9056e4be374ea3c788}{RealScalar}}\ maxDiagEntry\ =\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a4d68a51c9138c05942b97482cea88a37}{m\_workMatrix}}.cwiseAbs().diagonal().maxCoeff();}
\DoxyCodeLine{00698\ }
\DoxyCodeLine{00699\ \ \ \textcolor{keywordtype}{bool}\ finished\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00700\ \ \ \textcolor{keywordflow}{while}(!finished)}
\DoxyCodeLine{00701\ \ \ \{}
\DoxyCodeLine{00702\ \ \ \ \ finished\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00703\ }
\DoxyCodeLine{00704\ \ \ \ \ \textcolor{comment}{//\ do\ a\ sweep:\ for\ all\ index\ pairs\ (p,q),\ perform\ SVD\ of\ the\ corresponding\ 2x2\ sub-\/matrix}}
\DoxyCodeLine{00705\ }
\DoxyCodeLine{00706\ \ \ \ \ \textcolor{keywordflow}{for}(\mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ \mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}}\ =\ 1;\ \mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}}\ <\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a194a8784cb5b08d4faa92a4bdda89fda}{m\_diagSize}};\ ++\mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}})}
\DoxyCodeLine{00707\ \ \ \ \ \{}
\DoxyCodeLine{00708\ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ \mbox{\hyperlink{som__graph_8cpp_ae900b2add8deca663438fb20de69acce}{q}}\ =\ 0;\ \mbox{\hyperlink{som__graph_8cpp_ae900b2add8deca663438fb20de69acce}{q}}\ <\ \mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}};\ ++\mbox{\hyperlink{som__graph_8cpp_ae900b2add8deca663438fb20de69acce}{q}})}
\DoxyCodeLine{00709\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00710\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ if\ this\ 2x2\ sub-\/matrix\ is\ not\ diagonal\ already...}}
\DoxyCodeLine{00711\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ notice\ that\ this\ comparison\ will\ evaluate\ to\ false\ if\ any\ NaN\ is\ involved,\ ensuring\ that\ NaN's\ don't}}
\DoxyCodeLine{00712\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ keep\ us\ iterating\ forever.\ Similarly,\ small\ denormal\ numbers\ are\ considered\ zero.}}
\DoxyCodeLine{00713\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a533baa1b09ff7c9056e4be374ea3c788}{RealScalar}}\ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a98b2ee98690358951807353812a05c69}{threshold}}\ =\ \mbox{\hyperlink{namespace_eigen_1_1numext_a29d502349f2ec9897c808e65e0f96eb4}{numext::maxi<RealScalar>}}(considerAsZero,\ precision\ *\ maxDiagEntry);}
\DoxyCodeLine{00714\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{datatypes_8h_a3aa069ac3980707dae1e0530f50d59e4}{abs}}(\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a4d68a51c9138c05942b97482cea88a37}{m\_workMatrix}}.coeff(\mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}},\mbox{\hyperlink{som__graph_8cpp_ae900b2add8deca663438fb20de69acce}{q}}))>\mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a98b2ee98690358951807353812a05c69}{threshold}}\ ||\ \mbox{\hyperlink{datatypes_8h_a3aa069ac3980707dae1e0530f50d59e4}{abs}}(\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a4d68a51c9138c05942b97482cea88a37}{m\_workMatrix}}.coeff(\mbox{\hyperlink{som__graph_8cpp_ae900b2add8deca663438fb20de69acce}{q}},\mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}}))\ >\ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a98b2ee98690358951807353812a05c69}{threshold}})}
\DoxyCodeLine{00715\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00716\ \ \ \ \ \ \ \ \ \ \ finished\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00717\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ perform\ SVD\ decomposition\ of\ 2x2\ sub-\/matrix\ corresponding\ to\ indices\ p,q\ to\ make\ it\ diagonal}}
\DoxyCodeLine{00718\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ the\ complex\ to\ real\ operation\ returns\ true\ if\ the\ updated\ 2x2\ block\ is\ not\ already\ diagonal}}
\DoxyCodeLine{00719\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{struct_eigen_1_1internal_1_1svd__precondition__2x2__block__to__be__real}{internal::svd\_precondition\_2x2\_block\_to\_be\_real<MatrixType,\ QRPreconditioner>::run}}(\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a4d68a51c9138c05942b97482cea88a37}{m\_workMatrix}},\ *\textcolor{keyword}{this},\ \mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}},\ \mbox{\hyperlink{som__graph_8cpp_ae900b2add8deca663438fb20de69acce}{q}},\ maxDiagEntry))}
\DoxyCodeLine{00720\ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00721\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_jacobi_rotation}{JacobiRotation<RealScalar>}}\ j\_left,\ j\_right;}
\DoxyCodeLine{00722\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_eigen_1_1internal_a6c2651dd28bd9227267e66aaca20330e}{internal::real\_2x2\_jacobi\_svd}}(\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a4d68a51c9138c05942b97482cea88a37}{m\_workMatrix}},\ \mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}},\ \mbox{\hyperlink{som__graph_8cpp_ae900b2add8deca663438fb20de69acce}{q}},\ \&j\_left,\ \&j\_right);}
\DoxyCodeLine{00723\ }
\DoxyCodeLine{00724\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ accumulate\ resulting\ Jacobi\ rotations}}
\DoxyCodeLine{00725\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a4d68a51c9138c05942b97482cea88a37}{m\_workMatrix}}.applyOnTheLeft(\mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}},\mbox{\hyperlink{som__graph_8cpp_ae900b2add8deca663438fb20de69acce}{q}},j\_left);}
\DoxyCodeLine{00726\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a85661f1d7707070f204d18a1fe857c93}{computeU}}())\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a23702501edc888c10fba9d3e05ceab38}{m\_matrixU}}.applyOnTheRight(\mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}},\mbox{\hyperlink{som__graph_8cpp_ae900b2add8deca663438fb20de69acce}{q}},j\_left.\mbox{\hyperlink{class_eigen_1_1_jacobi_rotation_ab40e9cdc4582593511e57ee896e055a2}{transpose}}());}
\DoxyCodeLine{00727\ }
\DoxyCodeLine{00728\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a4d68a51c9138c05942b97482cea88a37}{m\_workMatrix}}.applyOnTheRight(\mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}},\mbox{\hyperlink{som__graph_8cpp_ae900b2add8deca663438fb20de69acce}{q}},j\_right);}
\DoxyCodeLine{00729\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a468809f18ea083ff6e2581af5d6c99dc}{computeV}}())\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a5094132b12c7528bcc7edac72f137f22}{m\_matrixV}}.applyOnTheRight(\mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}},\mbox{\hyperlink{som__graph_8cpp_ae900b2add8deca663438fb20de69acce}{q}},j\_right);}
\DoxyCodeLine{00730\ }
\DoxyCodeLine{00731\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ keep\ track\ of\ the\ largest\ diagonal\ coefficient}}
\DoxyCodeLine{00732\ \ \ \ \ \ \ \ \ \ \ \ \ maxDiagEntry\ =\ \mbox{\hyperlink{namespace_eigen_1_1numext_a29d502349f2ec9897c808e65e0f96eb4}{numext::maxi<RealScalar>}}(maxDiagEntry,\mbox{\hyperlink{namespace_eigen_1_1numext_a29d502349f2ec9897c808e65e0f96eb4}{numext::maxi<RealScalar>}}(\mbox{\hyperlink{datatypes_8h_a3aa069ac3980707dae1e0530f50d59e4}{abs}}(\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a4d68a51c9138c05942b97482cea88a37}{m\_workMatrix}}.coeff(\mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}},\mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}})),\ \mbox{\hyperlink{datatypes_8h_a3aa069ac3980707dae1e0530f50d59e4}{abs}}(\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a4d68a51c9138c05942b97482cea88a37}{m\_workMatrix}}.coeff(\mbox{\hyperlink{som__graph_8cpp_ae900b2add8deca663438fb20de69acce}{q}},\mbox{\hyperlink{som__graph_8cpp_ae900b2add8deca663438fb20de69acce}{q}}))));}
\DoxyCodeLine{00733\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00734\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00735\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00736\ \ \ \ \ \}}
\DoxyCodeLine{00737\ \ \ \}}
\DoxyCodeLine{00738\ }
\DoxyCodeLine{00739\ \textcolor{comment}{\ \ /***\ step\ 3.\ The\ work\ matrix\ is\ now\ diagonal,\ so\ ensure\ it's\ positive\ so\ its\ diagonal\ entries\ are\ the\ singular\ values\ ***/}}
\DoxyCodeLine{00740\ }
\DoxyCodeLine{00741\ \ \ \textcolor{keywordflow}{for}(\mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ =\ 0;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ <\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a194a8784cb5b08d4faa92a4bdda89fda}{m\_diagSize}};\ ++\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})}
\DoxyCodeLine{00742\ \ \ \{}
\DoxyCodeLine{00743\ \ \ \ \ \textcolor{comment}{//\ For\ a\ complex\ matrix,\ some\ diagonal\ coefficients\ might\ note\ have\ been}}
\DoxyCodeLine{00744\ \ \ \ \ \textcolor{comment}{//\ treated\ by\ svd\_precondition\_2x2\_block\_to\_be\_real,\ and\ the\ imaginary\ part}}
\DoxyCodeLine{00745\ \ \ \ \ \textcolor{comment}{//\ of\ some\ diagonal\ entry\ might\ not\ be\ null.}}
\DoxyCodeLine{00746\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{struct_eigen_1_1_generic_num_traits_a4a7b16effb0b7df2ab247e4df795dd3eadf2f66fe13a7f838f9984a31fea52b61}{NumTraits<Scalar>::IsComplex}}\ \&\&\ \mbox{\hyperlink{datatypes_8h_a3aa069ac3980707dae1e0530f50d59e4}{abs}}(numext::imag(\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a4d68a51c9138c05942b97482cea88a37}{m\_workMatrix}}.coeff(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}},\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})))>considerAsZero)}
\DoxyCodeLine{00747\ \ \ \ \ \{}
\DoxyCodeLine{00748\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a533baa1b09ff7c9056e4be374ea3c788}{RealScalar}}\ \mbox{\hyperlink{_cwise__product_8cpp_ad2cbe4616e813eb9af81732dca777b24}{a}}\ =\ \mbox{\hyperlink{datatypes_8h_a3aa069ac3980707dae1e0530f50d59e4}{abs}}(\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a4d68a51c9138c05942b97482cea88a37}{m\_workMatrix}}.coeff(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}},\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}));}
\DoxyCodeLine{00749\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a324c11555db31965f5b871434c3e1f4e}{m\_singularValues}}.coeffRef(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ =\ \mbox{\hyperlink{datatypes_8h_a3aa069ac3980707dae1e0530f50d59e4}{abs}}(\mbox{\hyperlink{_cwise__product_8cpp_ad2cbe4616e813eb9af81732dca777b24}{a}});}
\DoxyCodeLine{00750\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a85661f1d7707070f204d18a1fe857c93}{computeU}}())\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a23702501edc888c10fba9d3e05ceab38}{m\_matrixU}}.col(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ *=\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a4d68a51c9138c05942b97482cea88a37}{m\_workMatrix}}.coeff(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}},\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})/\mbox{\hyperlink{_cwise__product_8cpp_ad2cbe4616e813eb9af81732dca777b24}{a}};}
\DoxyCodeLine{00751\ \ \ \ \ \}}
\DoxyCodeLine{00752\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00753\ \ \ \ \ \{}
\DoxyCodeLine{00754\ \ \ \ \ \ \ \textcolor{comment}{//\ m\_workMatrix.coeff(i,i)\ is\ already\ real,\ no\ difficulty:}}
\DoxyCodeLine{00755\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a533baa1b09ff7c9056e4be374ea3c788}{RealScalar}}\ \mbox{\hyperlink{_cwise__product_8cpp_ad2cbe4616e813eb9af81732dca777b24}{a}}\ =\ numext::real(\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a4d68a51c9138c05942b97482cea88a37}{m\_workMatrix}}.coeff(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}},\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}));}
\DoxyCodeLine{00756\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a324c11555db31965f5b871434c3e1f4e}{m\_singularValues}}.coeffRef(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ =\ \mbox{\hyperlink{datatypes_8h_a3aa069ac3980707dae1e0530f50d59e4}{abs}}(\mbox{\hyperlink{_cwise__product_8cpp_ad2cbe4616e813eb9af81732dca777b24}{a}});}
\DoxyCodeLine{00757\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a85661f1d7707070f204d18a1fe857c93}{computeU}}()\ \&\&\ (\mbox{\hyperlink{_cwise__product_8cpp_ad2cbe4616e813eb9af81732dca777b24}{a}}<\mbox{\hyperlink{bench__gemm_8cpp_acb5c3dc237f99cf17167e8a629f01b43}{RealScalar}}(0)))\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a23702501edc888c10fba9d3e05ceab38}{m\_matrixU}}.col(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ =\ -\/\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a23702501edc888c10fba9d3e05ceab38}{m\_matrixU}}.col(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}});}
\DoxyCodeLine{00758\ \ \ \ \ \}}
\DoxyCodeLine{00759\ \ \ \}}
\DoxyCodeLine{00760\ \ \ }
\DoxyCodeLine{00761\ \ \ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a324c11555db31965f5b871434c3e1f4e}{m\_singularValues}}\ *=\ \mbox{\hyperlink{gnuplot__common__settings_8hh_a028be1055fb10c679b6153f8dcd0befa}{scale}};}
\DoxyCodeLine{00762\ }
\DoxyCodeLine{00763\ \textcolor{comment}{\ \ /***\ step\ 4.\ Sort\ singular\ values\ in\ descending\ order\ and\ compute\ the\ number\ of\ nonzero\ singular\ values\ ***/}}
\DoxyCodeLine{00764\ }
\DoxyCodeLine{00765\ \ \ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_aeadeff21d3cb1e604c474ee88bcca859}{m\_nonzeroSingularValues}}\ =\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a194a8784cb5b08d4faa92a4bdda89fda}{m\_diagSize}};}
\DoxyCodeLine{00766\ \ \ \textcolor{keywordflow}{for}(\mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ =\ 0;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ <\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a194a8784cb5b08d4faa92a4bdda89fda}{m\_diagSize}};\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}++)}
\DoxyCodeLine{00767\ \ \ \{}
\DoxyCodeLine{00768\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ pos;}
\DoxyCodeLine{00769\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a533baa1b09ff7c9056e4be374ea3c788}{RealScalar}}\ maxRemainingSingularValue\ =\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a324c11555db31965f5b871434c3e1f4e}{m\_singularValues}}.tail(\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a194a8784cb5b08d4faa92a4bdda89fda}{m\_diagSize}}-\/\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}).maxCoeff(\&pos);}
\DoxyCodeLine{00770\ \ \ \ \ \textcolor{keywordflow}{if}(maxRemainingSingularValue\ ==\ \mbox{\hyperlink{bench__gemm_8cpp_acb5c3dc237f99cf17167e8a629f01b43}{RealScalar}}(0))}
\DoxyCodeLine{00771\ \ \ \ \ \{}
\DoxyCodeLine{00772\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_aeadeff21d3cb1e604c474ee88bcca859}{m\_nonzeroSingularValues}}\ =\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}};}
\DoxyCodeLine{00773\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00774\ \ \ \ \ \}}
\DoxyCodeLine{00775\ \ \ \ \ \textcolor{keywordflow}{if}(pos)}
\DoxyCodeLine{00776\ \ \ \ \ \{}
\DoxyCodeLine{00777\ \ \ \ \ \ \ pos\ +=\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}};}
\DoxyCodeLine{00778\ \ \ \ \ \ \ \mbox{\hyperlink{namespacestd_a3acbe51b6415e9284430194bf04944e1}{std::swap}}(\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a324c11555db31965f5b871434c3e1f4e}{m\_singularValues}}.coeffRef(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}),\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a324c11555db31965f5b871434c3e1f4e}{m\_singularValues}}.coeffRef(pos));}
\DoxyCodeLine{00779\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a85661f1d7707070f204d18a1fe857c93}{computeU}}())\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a23702501edc888c10fba9d3e05ceab38}{m\_matrixU}}.col(pos).swap(\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a23702501edc888c10fba9d3e05ceab38}{m\_matrixU}}.col(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}));}
\DoxyCodeLine{00780\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a468809f18ea083ff6e2581af5d6c99dc}{computeV}}())\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a5094132b12c7528bcc7edac72f137f22}{m\_matrixV}}.col(pos).swap(\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a5094132b12c7528bcc7edac72f137f22}{m\_matrixV}}.col(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}));}
\DoxyCodeLine{00781\ \ \ \ \ \}}
\DoxyCodeLine{00782\ \ \ \}}
\DoxyCodeLine{00783\ }
\DoxyCodeLine{00784\ \ \ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_af3675dcc1726cccd2cdacfbb2b7545e5}{m\_isInitialized}}\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00785\ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{00786\ \}}
\DoxyCodeLine{00787\ }
\DoxyCodeLine{00795\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ Derived>}
\DoxyCodeLine{00796\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d}{JacobiSVD<typename\ MatrixBase<Derived>::PlainObject}}>}
\DoxyCodeLine{00797\ \mbox{\hyperlink{class_eigen_1_1_matrix_base_a5745dca9c54390633b434e54a1d1eedd}{MatrixBase<Derived>::jacobiSvd}}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ computationOptions)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00798\ \textcolor{keyword}{}\{}
\DoxyCodeLine{00799\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d}{JacobiSVD<PlainObject>}}(*\textcolor{keyword}{this},\ computationOptions);}
\DoxyCodeLine{00800\ \}}
\DoxyCodeLine{00801\ }
\DoxyCodeLine{00802\ \}\ \textcolor{comment}{//\ end\ namespace\ Eigen}}
\DoxyCodeLine{00803\ }
\DoxyCodeLine{00804\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ EIGEN\_JACOBISVD\_H}}

\end{DoxyCode}
