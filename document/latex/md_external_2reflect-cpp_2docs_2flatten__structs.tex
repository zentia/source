\chapter{Flatten structs}
\hypertarget{md_external_2reflect-cpp_2docs_2flatten__structs}{}\label{md_external_2reflect-cpp_2docs_2flatten__structs}\index{Flatten structs@{Flatten structs}}
\label{md_external_2reflect-cpp_2docs_2flatten__structs_autotoc_md577}%
\Hypertarget{md_external_2reflect-cpp_2docs_2flatten__structs_autotoc_md577}%


In some cases, you want to structs to "{}inherit"{} fields from other structs. Unfortunately, doing this via actual inheritance is not possible at the moment, due to several restrictions imposed by C++. Instead, we do it via composition, using {\ttfamily \doxylink{structrfl_1_1_flatten}{rfl\+::\+Flatten}}.

Note that you can also have nested flattened fields. If {\ttfamily \doxylink{bench__gemm_8cpp_addc86e8508f14411ec98f521c520f875}{A}} contains {\ttfamily \doxylink{bench__gemm_8cpp_a37a83060ac796961b44991c836f083f7}{B}} and {\ttfamily \doxylink{bench__gemm_8cpp_a37a83060ac796961b44991c836f083f7}{B}} contains {\ttfamily C}, then all fields will be flattened to a single JSON object.

If there are duplicate field names, you will get a compile-\/time error.\hypertarget{md_external_2reflect-cpp_2docs_2flatten__structs_autotoc_md578}{}\doxysection{\texorpdfstring{Example\+: Every employee is a person}{Example\+: Every employee is a person}}\label{md_external_2reflect-cpp_2docs_2flatten__structs_autotoc_md578}

\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{keyword}{struct\ }Person\ \{}
\DoxyCodeLine{\ \ std::string\ first\_name;}
\DoxyCodeLine{\ \ std::string\ last\_name;}
\DoxyCodeLine{\ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{namespacectre_af1ab492eac22f0bfaebe58d37347ce28a7d637d275668ed6d41a9b97e6ad3a556}{age}};}
\DoxyCodeLine{\};}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{struct\ }Employee\ \{}
\DoxyCodeLine{\ \ rfl::Flatten<Person>\ person;}
\DoxyCodeLine{\ \ std::string\ employer;}
\DoxyCodeLine{\ \ \textcolor{keywordtype}{float}\ salary;}
\DoxyCodeLine{\};}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ employee\ =\ Employee\{}
\DoxyCodeLine{\ \ .person\ =\ Person\{.first\_name\ =\ \textcolor{stringliteral}{"{}Homer"{}},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ .last\_name\ =\ \textcolor{stringliteral}{"{}Simpson"{}},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ .age\ =\ 45\},}
\DoxyCodeLine{\ \ .employer\ =\ \textcolor{stringliteral}{"{}Mr.\ Burns"{}},}
\DoxyCodeLine{\ \ .salary\ =\ 60000.0\};}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ json\_str\ =\ \mbox{\hyperlink{namespacerfl_1_1json_af39a23539424555b8c970d12a58e547f}{rfl::json::write}}(employee);}

\end{DoxyCode}


This flattens all fields into a single JSON object\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{\{"{}first\_name"{}:"{}Homer"{},"{}last\_name"{}:"{}Simpson"{},"{}age"{}:45,"{}salary"{}:60000.0\}}

\end{DoxyCode}
\hypertarget{md_external_2reflect-cpp_2docs_2flatten__structs_autotoc_md579}{}\doxysection{\texorpdfstring{Example, using the {\ttfamily rfl\+::\+Field}-\/syntax.}{Example, using the {\ttfamily rfl\+::\+Field}-\/syntax.}}\label{md_external_2reflect-cpp_2docs_2flatten__structs_autotoc_md579}

\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{keyword}{struct\ }Person\ \{}
\DoxyCodeLine{\ \ \ \ rfl::Field<\textcolor{stringliteral}{"{}firstName"{}},\ std::string>\ first\_name;}
\DoxyCodeLine{\ \ \ \ rfl::Field<\textcolor{stringliteral}{"{}lastName"{}},\ std::string>\ last\_name;}
\DoxyCodeLine{\ \ \ \ rfl::Field<\textcolor{stringliteral}{"{}age"{}},\ \textcolor{keywordtype}{int}>\ \mbox{\hyperlink{namespacectre_af1ab492eac22f0bfaebe58d37347ce28a7d637d275668ed6d41a9b97e6ad3a556}{age}};}
\DoxyCodeLine{\};}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{struct\ }Employee\ \{}
\DoxyCodeLine{\ \ \ \ rfl::Flatten<Person>\ person;}
\DoxyCodeLine{\ \ \ \ rfl::Field<\textcolor{stringliteral}{"{}salary"{}},\ \textcolor{keywordtype}{float}>\ salary;}
\DoxyCodeLine{\};}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ employee\ =\ Employee\{}
\DoxyCodeLine{\ \ \ \ .person\ =\ Person\{.first\_name\ =\ \textcolor{stringliteral}{"{}Homer"{}},\ .last\_name\ =\ \textcolor{stringliteral}{"{}Simpson"{}},\ .age\ =\ 45\},}
\DoxyCodeLine{\ \ \ \ .salary\ =\ 60000.0}
\DoxyCodeLine{\};}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ json\_str\ =\ \mbox{\hyperlink{namespacerfl_1_1json_af39a23539424555b8c970d12a58e547f}{rfl::json::write}}(employee);}

\end{DoxyCode}


This flattens all fields into a single JSON object\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{\{"{}firstName"{}:"{}Homer"{},"{}lastName"{}:"{}Simpson"{},"{}age"{}:45,"{}salary"{}:60000.0\}}

\end{DoxyCode}
 