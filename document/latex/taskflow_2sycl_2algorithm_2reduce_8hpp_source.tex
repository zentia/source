\doxysection{reduce.\+hpp}
\hypertarget{taskflow_2sycl_2algorithm_2reduce_8hpp_source}{}\label{taskflow_2sycl_2algorithm_2reduce_8hpp_source}\index{external/taskflow/taskflow/sycl/algorithm/reduce.hpp@{external/taskflow/taskflow/sycl/algorithm/reduce.hpp}}
\mbox{\hyperlink{taskflow_2sycl_2algorithm_2reduce_8hpp}{浏览该文件的文档.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00002\ }
\DoxyCodeLine{00003\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{syclflow_8hpp}{../syclflow.hpp}}"{}}}
\DoxyCodeLine{00004\ }
\DoxyCodeLine{00005\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespacetf_1_1detail}{tf::detail}}\ \{}
\DoxyCodeLine{00006\ }
\DoxyCodeLine{00007\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00008\ \textcolor{comment}{//\ reduction\ helper\ functions}}
\DoxyCodeLine{00009\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00010\ }
\DoxyCodeLine{00012\ \textcolor{keyword}{template}<\textcolor{keywordtype}{unsigned}\ nt,\ \textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00013\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structtf_1_1detail_1_1sycl_block_reduce}{syclBlockReduce}}\ \{}
\DoxyCodeLine{00014\ }
\DoxyCodeLine{00015\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{structtf_1_1detail_1_1sycl_block_reduce_a0c78d4a5ba2ccb88d2b3ee11caf3f496}{group\_size}}\ =\ \mbox{\hyperlink{namespacestd_ac7b9885417769949d76890454b6d072e}{std::min}}(nt,\ \mbox{\hyperlink{namespacetf_a40de533868648566e76c2495fbbfba70}{SYCL\_WARP\_SIZE}});}
\DoxyCodeLine{00016\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{structtf_1_1detail_1_1sycl_block_reduce_a428dca9c139a08fb15e94258c90f92c5}{shm\_size}}\ \ \ =\ std::max(nt,\ 2*\ \mbox{\hyperlink{structtf_1_1detail_1_1sycl_block_reduce_a0c78d4a5ba2ccb88d2b3ee11caf3f496}{group\_size}});}
\DoxyCodeLine{00017\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{structtf_1_1detail_1_1sycl_block_reduce_aaa66022d18c9bc76f3a50b0782950920}{num\_passes}}\ =\ \mbox{\hyperlink{_direct_x_page_8xaml_8cpp_a5ed22c1dd181a227939080748e797261}{log2}}(\mbox{\hyperlink{structtf_1_1detail_1_1sycl_block_reduce_a0c78d4a5ba2ccb88d2b3ee11caf3f496}{group\_size}});}
\DoxyCodeLine{00018\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{structtf_1_1detail_1_1sycl_block_reduce_a097b00a9d533f9aff9d4d12f298c9df1}{num\_items}}\ \ =\ nt\ /\ \mbox{\hyperlink{structtf_1_1detail_1_1sycl_block_reduce_a0c78d4a5ba2ccb88d2b3ee11caf3f496}{group\_size}};}
\DoxyCodeLine{00019\ }
\DoxyCodeLine{00020\ \ \ \textcolor{keyword}{static\_assert}(}
\DoxyCodeLine{00021\ \ \ \ \ nt\ \&\&\ (0\ ==\ nt\ \%\ \mbox{\hyperlink{namespacetf_a40de533868648566e76c2495fbbfba70}{SYCL\_WARP\_SIZE}}),}
\DoxyCodeLine{00022\ \ \ \ \ \textcolor{stringliteral}{"{}syclBlockReduce\ requires\ num\ threads\ to\ be\ a\ multiple\ of\ warp\_size\ (32)"{}}}
\DoxyCodeLine{00023\ \ \ );}
\DoxyCodeLine{00024\ }
\DoxyCodeLine{00025\ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{structtf_1_1detail_1_1sycl_block_reduce_aa8fd8b386a01f1782ebd6c693737ecd5}{shm\_t}}\ =\ sycl::accessor<}
\DoxyCodeLine{00026\ \ \ \ \ \mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}},\ 1,\ sycl::access::mode::read\_write,\ sycl::access::target::local}
\DoxyCodeLine{00027\ \ \ >;}
\DoxyCodeLine{00028\ }
\DoxyCodeLine{00029\ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ op\_t>}
\DoxyCodeLine{00030\ \ \ \mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}}\ \mbox{\hyperlink{structtf_1_1detail_1_1sycl_block_reduce_aaf66f5cdee51876523a1ede75b75068b}{operator()}}(}
\DoxyCodeLine{00031\ \ \ \ \ sycl::nd\_item<1>\&,\ \mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}},\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structtf_1_1detail_1_1sycl_block_reduce_aa8fd8b386a01f1782ebd6c693737ecd5}{shm\_t}}\&,\ \textcolor{keywordtype}{unsigned},\ op\_t,\ \textcolor{keywordtype}{bool}\ =\ \textcolor{keyword}{true}}
\DoxyCodeLine{00032\ \ \ )\ \textcolor{keyword}{const};}
\DoxyCodeLine{00033\ \};}
\DoxyCodeLine{00034\ }
\DoxyCodeLine{00035\ \textcolor{comment}{//\ function:\ reduce\ to\ be\ called\ from\ a\ block}}
\DoxyCodeLine{00036\ \textcolor{keyword}{template}<\textcolor{keywordtype}{unsigned}\ nt,\ \textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00037\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ op\_t>}
\DoxyCodeLine{00038\ \mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}}\ \mbox{\hyperlink{structtf_1_1detail_1_1sycl_block_reduce_aaf66f5cdee51876523a1ede75b75068b}{syclBlockReduce<nt,\ T>::operator\ ()}}(}
\DoxyCodeLine{00039\ \ \ sycl::nd\_item<1>\&\ item,}
\DoxyCodeLine{00040\ \ \ \mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}}\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}},}
\DoxyCodeLine{00041\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structtf_1_1detail_1_1sycl_block_reduce_aa8fd8b386a01f1782ebd6c693737ecd5}{shm\_t}}\&\ shm,}
\DoxyCodeLine{00042\ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}},}
\DoxyCodeLine{00043\ \ \ op\_t\ op,}
\DoxyCodeLine{00044\ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{level1__impl_8h_afb8d513d0298d2695018eb494b092786}{ret}}}
\DoxyCodeLine{00045\ )\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00046\ }
\DoxyCodeLine{00047\ \ \ \textcolor{keyword}{auto}\ tid\ =\ item.get\_local\_id(0);}
\DoxyCodeLine{00048\ }
\DoxyCodeLine{00049\ \ \ \textcolor{comment}{//\ Store\ your\ data\ into\ shared\ memory.}}
\DoxyCodeLine{00050\ \ \ shm[tid]\ =\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}};}
\DoxyCodeLine{00051\ \ \ item.barrier(sycl::access::fence\_space::local\_space);}
\DoxyCodeLine{00052\ }
\DoxyCodeLine{00053\ \ \ \textcolor{keywordflow}{if}(tid\ <\ \mbox{\hyperlink{structtf_1_1detail_1_1sycl_block_reduce_a0c78d4a5ba2ccb88d2b3ee11caf3f496}{group\_size}})\ \{}
\DoxyCodeLine{00054\ \ \ \ \ \textcolor{comment}{//\ Each\ thread\ scans\ within\ its\ lane.}}
\DoxyCodeLine{00055\ \ \ \ \ \mbox{\hyperlink{namespacetf_a73c9e33667bd896e8faf6a0c9fb0ccf6}{sycl\_strided\_iterate<group\_size,\ num\_items>}}([\&](\textcolor{keyword}{auto}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}},\ \textcolor{keyword}{auto}\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}})\ \{}
\DoxyCodeLine{00056\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ >\ 0)\ \{}
\DoxyCodeLine{00057\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}}\ =\ op(\mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}},\ shm[\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}]);}
\DoxyCodeLine{00058\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00059\ \ \ \ \ \},\ tid,\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}});}
\DoxyCodeLine{00060\ \ \ \ \ shm[tid]\ =\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}};}
\DoxyCodeLine{00061\ \ \ \}}
\DoxyCodeLine{00062\ \ \ item.barrier(sycl::access::fence\_space::local\_space);}
\DoxyCodeLine{00063\ }
\DoxyCodeLine{00064\ \ \ \textcolor{keyword}{auto}\ count2\ =\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}}\ <\ \mbox{\hyperlink{structtf_1_1detail_1_1sycl_block_reduce_a0c78d4a5ba2ccb88d2b3ee11caf3f496}{group\_size}}\ ?\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}}\ :\ \mbox{\hyperlink{structtf_1_1detail_1_1sycl_block_reduce_a0c78d4a5ba2ccb88d2b3ee11caf3f496}{group\_size}};}
\DoxyCodeLine{00065\ \ \ \textcolor{keyword}{auto}\ first\ =\ (1\ \&\ \mbox{\hyperlink{structtf_1_1detail_1_1sycl_block_reduce_aaa66022d18c9bc76f3a50b0782950920}{num\_passes}})\ ?\ \mbox{\hyperlink{structtf_1_1detail_1_1sycl_block_reduce_a0c78d4a5ba2ccb88d2b3ee11caf3f496}{group\_size}}\ :\ 0;}
\DoxyCodeLine{00066\ \ \ \textcolor{keywordflow}{if}(tid\ <\ \mbox{\hyperlink{structtf_1_1detail_1_1sycl_block_reduce_a0c78d4a5ba2ccb88d2b3ee11caf3f496}{group\_size}})\ \{}
\DoxyCodeLine{00067\ \ \ \ \ shm[first\ +\ tid]\ =\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}};}
\DoxyCodeLine{00068\ \ \ \}}
\DoxyCodeLine{00069\ \ \ item.barrier(sycl::access::fence\_space::local\_space);}
\DoxyCodeLine{00070\ }
\DoxyCodeLine{00071\ \ \ \mbox{\hyperlink{namespacetf_a15d116b0d477916b4d21d13f917b639b}{sycl\_iterate<num\_passes>}}([\&](\textcolor{keyword}{auto}\ pass)\ \{}
\DoxyCodeLine{00072\ \ \ \ \ \textcolor{keywordflow}{if}(tid\ <\ \mbox{\hyperlink{structtf_1_1detail_1_1sycl_block_reduce_a0c78d4a5ba2ccb88d2b3ee11caf3f496}{group\_size}})\ \{}
\DoxyCodeLine{00073\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\textcolor{keyword}{auto}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ae1b92ae085ddef4b1cdca7d749339fb0}{offset}}\ =\ 1\ <<\ pass;\ tid\ +\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ae1b92ae085ddef4b1cdca7d749339fb0}{offset}}\ <\ count2)\ \{}
\DoxyCodeLine{00074\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}}\ =\ op(\mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}},\ shm[first\ +\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ae1b92ae085ddef4b1cdca7d749339fb0}{offset}}\ +\ tid]);}
\DoxyCodeLine{00075\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00076\ \ \ \ \ \ \ first\ =\ \mbox{\hyperlink{structtf_1_1detail_1_1sycl_block_reduce_a0c78d4a5ba2ccb88d2b3ee11caf3f496}{group\_size}}\ -\/\ first;}
\DoxyCodeLine{00077\ \ \ \ \ \ \ shm[first\ +\ tid]\ =\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}};}
\DoxyCodeLine{00078\ \ \ \ \ \}}
\DoxyCodeLine{00079\ \ \ \ \ item.barrier(sycl::access::fence\_space::local\_space);}
\DoxyCodeLine{00080\ \ \ \});}
\DoxyCodeLine{00081\ }
\DoxyCodeLine{00082\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{level1__impl_8h_afb8d513d0298d2695018eb494b092786}{ret}})\ \{}
\DoxyCodeLine{00083\ \ \ \ \ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}}\ =\ shm[0];}
\DoxyCodeLine{00084\ \ \ \ \ item.barrier(sycl::access::fence\_space::local\_space);}
\DoxyCodeLine{00085\ \ \ \}}
\DoxyCodeLine{00086\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}};}
\DoxyCodeLine{00087\ \}}
\DoxyCodeLine{00088\ }
\DoxyCodeLine{00090\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ P,\ \textcolor{keyword}{typename}\ I,\ \textcolor{keyword}{typename}\ T,\ \textcolor{keyword}{typename}\ O>}
\DoxyCodeLine{00091\ sycl::event\ \mbox{\hyperlink{namespacetf_1_1detail_a4aef16c380f421cd83509ed535a51add}{sycl\_reduce\_loop}}(}
\DoxyCodeLine{00092\ \ \ \mbox{\hyperlink{namespace_p}{P}}\&\&\ \mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}},}
\DoxyCodeLine{00093\ \ \ I\ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_ab7e6955a695fad0be513586926040b1a}{input}},}
\DoxyCodeLine{00094\ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}},}
\DoxyCodeLine{00095\ \ \ \mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}}*\ \mbox{\hyperlink{_partial_redux__count_8cpp_acbe60897559b79afc28b79b0687b5f29}{res}},}
\DoxyCodeLine{00096\ \ \ O\ op,}
\DoxyCodeLine{00097\ \ \ \textcolor{keywordtype}{bool}\ incl,}
\DoxyCodeLine{00098\ \ \ \textcolor{keywordtype}{void}*\ \mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}},}
\DoxyCodeLine{00099\ \ \ std::vector<sycl::event>\ evs}
\DoxyCodeLine{00100\ )\ \{}
\DoxyCodeLine{00101\ }
\DoxyCodeLine{00102\ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{sandbox_2strassen_2omp_8cpp_a4bfa035cad7c3258704669810cd5de5d}{E}}\ =\ std::decay\_t<P>;}
\DoxyCodeLine{00103\ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{test__broadcast__node_8cpp_a554e63228b946db0d44c4f398b18e212}{R}}\ =\ \mbox{\hyperlink{structtf_1_1detail_1_1sycl_block_reduce}{syclBlockReduce<E::nt,\ T>}};}
\DoxyCodeLine{00104\ }
\DoxyCodeLine{00105\ \ \ \textcolor{keyword}{auto}\ buf\ =\ \textcolor{keyword}{static\_cast<}\mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}}*\textcolor{keyword}{>}(\mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}});}
\DoxyCodeLine{00106\ \ \ \textcolor{keyword}{auto}\ \mbox{\hyperlink{bench__gemm_8cpp_a37a83060ac796961b44991c836f083f7}{B}}\ \ \ =\ (\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}}\ +\ E::nv\ -\/\ 1)\ /\ E::nv;}
\DoxyCodeLine{00107\ }
\DoxyCodeLine{00108\ \ \ \textcolor{keyword}{auto}\ \mbox{\hyperlink{_cwise__array__power__array_8cpp_a9cb86ff854760bf91a154f2724a9101d}{e}}\ =\ \mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}}.queue().submit([=,\ evs=std::move(evs)](sycl::handler\&\ \mbox{\hyperlink{ittnotify__static_8h_ae68700d2ebda197674e2fdd0f916f00c}{h}})\ \{}
\DoxyCodeLine{00109\ }
\DoxyCodeLine{00110\ \ \ \ \ \mbox{\hyperlink{ittnotify__static_8h_ae68700d2ebda197674e2fdd0f916f00c}{h}}.depends\_on(evs);}
\DoxyCodeLine{00111\ }
\DoxyCodeLine{00112\ \ \ \ \ \textcolor{comment}{//\ create\ a\ shared\ memory}}
\DoxyCodeLine{00113\ \ \ \ \ \textcolor{keyword}{typename}\ R::shm\_t\ shm(sycl::range<1>(R::shm\_size),\ \mbox{\hyperlink{ittnotify__static_8h_ae68700d2ebda197674e2fdd0f916f00c}{h}});}
\DoxyCodeLine{00114\ }
\DoxyCodeLine{00115\ \ \ \ \ \mbox{\hyperlink{ittnotify__static_8h_ae68700d2ebda197674e2fdd0f916f00c}{h}}.parallel\_for(}
\DoxyCodeLine{00116\ \ \ \ \ \ \ sycl::nd\_range<1>\{sycl::range<1>(\mbox{\hyperlink{bench__gemm_8cpp_a37a83060ac796961b44991c836f083f7}{B}}*E::nt),\ sycl::range<1>(E::nt)\},}
\DoxyCodeLine{00117\ \ \ \ \ \ \ [=](sycl::nd\_item<1>\ item)\ \{}
\DoxyCodeLine{00118\ }
\DoxyCodeLine{00119\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ tid\ =\ item.get\_local\_id(0);}
\DoxyCodeLine{00120\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ bid\ =\ item.get\_group(0);}
\DoxyCodeLine{00121\ }
\DoxyCodeLine{00122\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ get\ the\ tile\ of\ this\ group}}
\DoxyCodeLine{00123\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ tile\ =\ \mbox{\hyperlink{namespacetf_afbe5a82a36acd5287b862e70be9f2f71}{sycl\_get\_tile}}(bid,\ E::nv,\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}});}
\DoxyCodeLine{00124\ }
\DoxyCodeLine{00125\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ load\ data\ from\ input\ to\ register}}
\DoxyCodeLine{00126\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}}\ =\ \mbox{\hyperlink{namespacetf_a9eabeb17a88edba235467d197c6a5cd5}{sycl\_mem\_to\_reg\_strided<E::nt,\ E::vt>}}(}
\DoxyCodeLine{00127\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_ab7e6955a695fad0be513586926040b1a}{input}}\ +\ tile.begin,\ tid,\ tile.count()}
\DoxyCodeLine{00128\ \ \ \ \ \ \ \ \ );}
\DoxyCodeLine{00129\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ reduce\ multiple\ values\ per\ thread\ into\ a\ scalar.}}
\DoxyCodeLine{00130\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}}\ \mbox{\hyperlink{main-override_8cpp_a1384e7608274313a9433fa573868557b}{s}};}
\DoxyCodeLine{00131\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacetf_a73c9e33667bd896e8faf6a0c9fb0ccf6}{sycl\_strided\_iterate<E::nt,\ E::vt>}}(}
\DoxyCodeLine{00132\ \ \ \ \ \ \ \ \ \ \ [\&]\ (\textcolor{keyword}{auto}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}},\ \textcolor{keyword}{auto})\ \{\ \mbox{\hyperlink{main-override_8cpp_a1384e7608274313a9433fa573868557b}{s}}\ =\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ ?\ op(\mbox{\hyperlink{main-override_8cpp_a1384e7608274313a9433fa573868557b}{s}},\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}])\ :\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}}[0];\ \},\ tid,\ tile.count()}
\DoxyCodeLine{00133\ \ \ \ \ \ \ \ \ );}
\DoxyCodeLine{00134\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ reduce\ to\ a\ scalar\ per\ block.}}
\DoxyCodeLine{00135\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{main-override_8cpp_a1384e7608274313a9433fa573868557b}{s}}\ =\ \mbox{\hyperlink{test__broadcast__node_8cpp_a554e63228b946db0d44c4f398b18e212}{R}}()(}
\DoxyCodeLine{00136\ \ \ \ \ \ \ \ \ \ \ item,\ \mbox{\hyperlink{main-override_8cpp_a1384e7608274313a9433fa573868557b}{s}},\ shm,\ (tile.count()<E::nt\ ?\ tile.count()\ :\ E::nt),\ op,\ \textcolor{keyword}{false}}
\DoxyCodeLine{00137\ \ \ \ \ \ \ \ \ );}
\DoxyCodeLine{00138\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!tid)\ \{}
\DoxyCodeLine{00139\ \ \ \ \ \ \ \ \ \ \ (1\ ==\ \mbox{\hyperlink{bench__gemm_8cpp_a37a83060ac796961b44991c836f083f7}{B}})\ ?\ *\mbox{\hyperlink{_partial_redux__count_8cpp_acbe60897559b79afc28b79b0687b5f29}{res}}\ =\ (incl\ ?\ op(*\mbox{\hyperlink{_partial_redux__count_8cpp_acbe60897559b79afc28b79b0687b5f29}{res}},\ \mbox{\hyperlink{main-override_8cpp_a1384e7608274313a9433fa573868557b}{s}})\ :\ \mbox{\hyperlink{main-override_8cpp_a1384e7608274313a9433fa573868557b}{s}})\ :\ buf[bid]\ =\ \mbox{\hyperlink{main-override_8cpp_a1384e7608274313a9433fa573868557b}{s}};}
\DoxyCodeLine{00140\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00141\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00142\ \ \ \ \ );}
\DoxyCodeLine{00143\ \ \ \});}
\DoxyCodeLine{00144\ }
\DoxyCodeLine{00145\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{bench__gemm_8cpp_a37a83060ac796961b44991c836f083f7}{B}}\ >\ 1)\ \{}
\DoxyCodeLine{00146\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacetf_1_1detail_a4aef16c380f421cd83509ed535a51add}{sycl\_reduce\_loop}}(\mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}},\ buf,\ \mbox{\hyperlink{bench__gemm_8cpp_a37a83060ac796961b44991c836f083f7}{B}},\ \mbox{\hyperlink{_partial_redux__count_8cpp_acbe60897559b79afc28b79b0687b5f29}{res}},\ op,\ incl,\ buf+\mbox{\hyperlink{bench__gemm_8cpp_a37a83060ac796961b44991c836f083f7}{B}},\ \{\mbox{\hyperlink{_cwise__array__power__array_8cpp_a9cb86ff854760bf91a154f2724a9101d}{e}}\});}
\DoxyCodeLine{00147\ \ \ \}}
\DoxyCodeLine{00148\ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00149\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{_cwise__array__power__array_8cpp_a9cb86ff854760bf91a154f2724a9101d}{e}};}
\DoxyCodeLine{00150\ \ \ \}}
\DoxyCodeLine{00151\ \}}
\DoxyCodeLine{00152\ }
\DoxyCodeLine{00153\ \}\ \ \textcolor{comment}{//\ end\ of\ namespace\ detail\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00154\ }
\DoxyCodeLine{00155\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespacetf}{tf}}\ \{}
\DoxyCodeLine{00156\ }
\DoxyCodeLine{00168\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ P,\ \textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00169\ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacetf_a7d5979bf44616a9019e700556aa396ba}{sycl\_reduce\_buffer\_size}}(\textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}})\ \{}
\DoxyCodeLine{00170\ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{sandbox_2strassen_2omp_8cpp_a4bfa035cad7c3258704669810cd5de5d}{E}}\ =\ std::decay\_t<P>;}
\DoxyCodeLine{00171\ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{bench__gemm_8cpp_a37a83060ac796961b44991c836f083f7}{B}}\ =\ (\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}}\ +\ E::nv\ -\/\ 1)\ /\ E::nv;}
\DoxyCodeLine{00172\ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}\ =\ 0;}
\DoxyCodeLine{00173\ \ \ \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}\ \mbox{\hyperlink{offscreen_8c_a846c9667e34d56c560bb7f0ac6e173f6}{b}}=\mbox{\hyperlink{bench__gemm_8cpp_a37a83060ac796961b44991c836f083f7}{B}};\ \mbox{\hyperlink{offscreen_8c_a846c9667e34d56c560bb7f0ac6e173f6}{b}}>1;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}\ +=\ (\mbox{\hyperlink{offscreen_8c_a846c9667e34d56c560bb7f0ac6e173f6}{b}}=(\mbox{\hyperlink{offscreen_8c_a846c9667e34d56c560bb7f0ac6e173f6}{b}}+E::nv-\/1)/E::nv));}
\DoxyCodeLine{00174\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}*\textcolor{keyword}{sizeof}(\mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}});}
\DoxyCodeLine{00175\ \}}
\DoxyCodeLine{00176\ }
\DoxyCodeLine{00178\ \textcolor{comment}{//template\ <typename\ I,\ typename\ T,\ typename\ C,\ bool\ uninitialized>}}
\DoxyCodeLine{00179\ \textcolor{comment}{//auto\ syclFlow::\_reduce\_cgh(I\ first,\ I\ last,\ T*\ res,\ C\&\&\ op)\ \{}}
\DoxyCodeLine{00180\ \textcolor{comment}{//}}
\DoxyCodeLine{00181\ \textcolor{comment}{//\ \ //\ TODO:\ special\ case\ N\ ==\ 0?}}
\DoxyCodeLine{00182\ \textcolor{comment}{//\ \ size\_t\ N\ =\ std::distance(first,\ last);}}
\DoxyCodeLine{00183\ \textcolor{comment}{//\ \ size\_t\ B\ =\ \_default\_group\_size(N);}}
\DoxyCodeLine{00184\ \textcolor{comment}{//}}
\DoxyCodeLine{00185\ \textcolor{comment}{//\ \ return\ [=,\ op=std::forward<C>(op)](sycl::handler\&\ handler)\ mutable\ \{}}
\DoxyCodeLine{00186\ \textcolor{comment}{//}}
\DoxyCodeLine{00187\ \textcolor{comment}{//\ \ \ \ //\ create\ a\ shared\ memory}}
\DoxyCodeLine{00188\ \textcolor{comment}{//\ \ \ \ sycl::accessor<}}
\DoxyCodeLine{00189\ \textcolor{comment}{//\ \ \ \ \ \ T,\ 1,\ sycl::access::mode::read\_write,\ sycl::access::target::local}}
\DoxyCodeLine{00190\ \textcolor{comment}{//\ \ \ \ >\ shm(sycl::range<1>(B),\ handler);}}
\DoxyCodeLine{00191\ \textcolor{comment}{//}}
\DoxyCodeLine{00192\ \textcolor{comment}{//\ \ \ \ //\ perform\ parallel\ reduction}}
\DoxyCodeLine{00193\ \textcolor{comment}{//\ \ \ \ handler.parallel\_for(}}
\DoxyCodeLine{00194\ \textcolor{comment}{//\ \ \ \ \ \ sycl::nd\_range<1>\{sycl::range<1>(B),\ sycl::range<1>(B)\},}}
\DoxyCodeLine{00195\ \textcolor{comment}{//\ \ \ \ \ \ [=]\ (sycl::nd\_item<1>\ item)\ \{}}
\DoxyCodeLine{00196\ \textcolor{comment}{//}}
\DoxyCodeLine{00197\ \textcolor{comment}{//\ \ \ \ \ \ size\_t\ tid\ =\ item.get\_global\_id(0);}}
\DoxyCodeLine{00198\ \textcolor{comment}{//}}
\DoxyCodeLine{00199\ \textcolor{comment}{//\ \ \ \ \ \ if(tid\ >=\ N)\ \{}}
\DoxyCodeLine{00200\ \textcolor{comment}{//\ \ \ \ \ \ \ \ return;}}
\DoxyCodeLine{00201\ \textcolor{comment}{//\ \ \ \ \ \ \}}}
\DoxyCodeLine{00202\ \textcolor{comment}{//}}
\DoxyCodeLine{00203\ \textcolor{comment}{//\ \ \ \ \ \ shm[tid]\ =\ *(first+tid);}}
\DoxyCodeLine{00204\ \textcolor{comment}{//}}
\DoxyCodeLine{00205\ \textcolor{comment}{//\ \ \ \ \ \ for(size\_t\ i=tid+B;\ i<N;\ i+=B)\ \{}}
\DoxyCodeLine{00206\ \textcolor{comment}{//\ \ \ \ \ \ \ \ shm[tid]\ =\ op(shm[tid],\ *(first+i));}}
\DoxyCodeLine{00207\ \textcolor{comment}{//\ \ \ \ \ \ \}}}
\DoxyCodeLine{00208\ \textcolor{comment}{//}}
\DoxyCodeLine{00209\ \textcolor{comment}{//\ \ \ \ \ \ item.barrier(sycl::access::fence\_space::local\_space);}}
\DoxyCodeLine{00210\ \textcolor{comment}{//}}
\DoxyCodeLine{00211\ \textcolor{comment}{//\ \ \ \ \ \ for(size\_t\ s\ =\ B\ /\ 2;\ s\ >\ 0;\ s\ >>=\ 1)\ \{}}
\DoxyCodeLine{00212\ \textcolor{comment}{//\ \ \ \ \ \ \ \ if(tid\ <\ s\ \&\&\ tid\ +\ s\ <\ N)\ \{}}
\DoxyCodeLine{00213\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ shm[tid]\ =\ op(shm[tid],\ shm[tid+s]);}}
\DoxyCodeLine{00214\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{00215\ \textcolor{comment}{//\ \ \ \ \ \ \ \ item.barrier(sycl::access::fence\_space::local\_space);}}
\DoxyCodeLine{00216\ \textcolor{comment}{//\ \ \ \ \ \ \}}}
\DoxyCodeLine{00217\ \textcolor{comment}{//}}
\DoxyCodeLine{00218\ \textcolor{comment}{//\ \ \ \ \ \ if(tid\ ==\ 0)\ \{}}
\DoxyCodeLine{00219\ \textcolor{comment}{//\ \ \ \ \ \ \ \ if\ constexpr\ (uninitialized)\ \{}}
\DoxyCodeLine{00220\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ *res\ =\ shm[0];}}
\DoxyCodeLine{00221\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{00222\ \textcolor{comment}{//\ \ \ \ \ \ \ \ else\ \{}}
\DoxyCodeLine{00223\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ *res\ =\ op(*res,\ shm[0]);}}
\DoxyCodeLine{00224\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{00225\ \textcolor{comment}{//\ \ \ \ \ \ \}}}
\DoxyCodeLine{00226\ \textcolor{comment}{//\ \ \ \ \});}}
\DoxyCodeLine{00227\ \textcolor{comment}{//\ \ \};}}
\DoxyCodeLine{00228\ \textcolor{comment}{//\}}}
\DoxyCodeLine{00229\ }
\DoxyCodeLine{00230\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00231\ \textcolor{comment}{//\ SYCL\ standard\ reduce\ algorithms}}
\DoxyCodeLine{00232\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00233\ }
\DoxyCodeLine{00257\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ P,\ \textcolor{keyword}{typename}\ I,\ \textcolor{keyword}{typename}\ T,\ \textcolor{keyword}{typename}\ O>}
\DoxyCodeLine{00258\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{namespacetf_a897367c837e2006a6ae727f651741251}{sycl\_reduce}}(\mbox{\hyperlink{namespace_p}{P}}\&\&\ \mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}},\ I\ first,\ I\ last,\ \mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}}*\ \mbox{\hyperlink{_partial_redux__count_8cpp_acbe60897559b79afc28b79b0687b5f29}{res}},\ O\ op)\ \{}
\DoxyCodeLine{00259\ }
\DoxyCodeLine{00260\ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}}\ =\ std::distance(first,\ last);}
\DoxyCodeLine{00261\ }
\DoxyCodeLine{00262\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}}\ ==\ 0)\ \{}
\DoxyCodeLine{00263\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00264\ \ \ \}}
\DoxyCodeLine{00265\ }
\DoxyCodeLine{00266\ \ \ \textcolor{comment}{//\ allocate\ temporary\ buffer}}
\DoxyCodeLine{00267\ \ \ \textcolor{keyword}{auto}\ tmp\ =\ sycl::malloc\_device(}
\DoxyCodeLine{00268\ \ \ \ \ \mbox{\hyperlink{namespacetf_a7d5979bf44616a9019e700556aa396ba}{sycl\_reduce\_buffer\_size<P,\ T>}}(\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}}),\ \mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}}.queue()}
\DoxyCodeLine{00269\ \ \ );}
\DoxyCodeLine{00270\ }
\DoxyCodeLine{00271\ \ \ \textcolor{comment}{//\ reduction\ loop}}
\DoxyCodeLine{00272\ \ \ \mbox{\hyperlink{namespacetf_1_1detail_a4aef16c380f421cd83509ed535a51add}{detail::sycl\_reduce\_loop}}(\mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}},\ first,\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}},\ \mbox{\hyperlink{_partial_redux__count_8cpp_acbe60897559b79afc28b79b0687b5f29}{res}},\ op,\ \textcolor{keyword}{true},\ tmp,\ \{\}).wait();}
\DoxyCodeLine{00273\ }
\DoxyCodeLine{00274\ \ \ \textcolor{comment}{//\ deallocate\ the\ temporary\ buffer}}
\DoxyCodeLine{00275\ \ \ sycl::free(tmp,\ \mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}}.queue());}
\DoxyCodeLine{00276\ \}}
\DoxyCodeLine{00277\ }
\DoxyCodeLine{00297\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ P,\ \textcolor{keyword}{typename}\ I,\ \textcolor{keyword}{typename}\ T,\ \textcolor{keyword}{typename}\ O>}
\DoxyCodeLine{00298\ sycl::event\ \mbox{\hyperlink{namespacetf_a339d2a093e819c51cef5aa80669271f9}{sycl\_reduce\_async}}(}
\DoxyCodeLine{00299\ \ \ \mbox{\hyperlink{namespace_p}{P}}\&\&\ \mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}},\ I\ first,\ I\ last,\ \mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}}*\ \mbox{\hyperlink{_partial_redux__count_8cpp_acbe60897559b79afc28b79b0687b5f29}{res}},\ O\ op,\ \textcolor{keywordtype}{void}*\ buf,\ std::vector<sycl::event>\ dep}
\DoxyCodeLine{00300\ )\ \{}
\DoxyCodeLine{00301\ }
\DoxyCodeLine{00302\ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}}\ =\ std::distance(first,\ last);}
\DoxyCodeLine{00303\ }
\DoxyCodeLine{00304\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}}\ ==\ 0)\ \{}
\DoxyCodeLine{00305\ \ \ \ \ \textcolor{keywordflow}{return}\ \{\};}
\DoxyCodeLine{00306\ \ \ \}}
\DoxyCodeLine{00307\ }
\DoxyCodeLine{00308\ \ \ \textcolor{comment}{//\ reduction\ loop}}
\DoxyCodeLine{00309\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacetf_1_1detail_a4aef16c380f421cd83509ed535a51add}{detail::sycl\_reduce\_loop}}(}
\DoxyCodeLine{00310\ \ \ \ \ \mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}},\ first,\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}},\ \mbox{\hyperlink{_partial_redux__count_8cpp_acbe60897559b79afc28b79b0687b5f29}{res}},\ op,\ \textcolor{keyword}{true},\ buf,\ std::move(dep)}
\DoxyCodeLine{00311\ \ \ );}
\DoxyCodeLine{00312\ \}}
\DoxyCodeLine{00313\ }
\DoxyCodeLine{00339\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ P,\ \textcolor{keyword}{typename}\ I,\ \textcolor{keyword}{typename}\ T,\ \textcolor{keyword}{typename}\ O>}
\DoxyCodeLine{00340\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{namespacetf_a15aa0055574464d6647e341cdbfa0082}{sycl\_uninitialized\_reduce}}(\mbox{\hyperlink{namespace_p}{P}}\&\&\ \mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}},\ I\ first,\ I\ last,\ \mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}}*\ \mbox{\hyperlink{_partial_redux__count_8cpp_acbe60897559b79afc28b79b0687b5f29}{res}},\ O\ op)\ \{}
\DoxyCodeLine{00341\ }
\DoxyCodeLine{00342\ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}}\ =\ std::distance(first,\ last);}
\DoxyCodeLine{00343\ }
\DoxyCodeLine{00344\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}}\ ==\ 0)\ \{}
\DoxyCodeLine{00345\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00346\ \ \ \}}
\DoxyCodeLine{00347\ }
\DoxyCodeLine{00348\ \ \ \textcolor{comment}{//\ allocate\ temporary\ buffer}}
\DoxyCodeLine{00349\ \ \ \textcolor{keyword}{auto}\ tmp\ =\ sycl::malloc\_device(}
\DoxyCodeLine{00350\ \ \ \ \ \mbox{\hyperlink{namespacetf_a7d5979bf44616a9019e700556aa396ba}{sycl\_reduce\_buffer\_size<P,\ T>}}(\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}}),\ \mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}}.queue()}
\DoxyCodeLine{00351\ \ \ );}
\DoxyCodeLine{00352\ }
\DoxyCodeLine{00353\ \ \ \textcolor{comment}{//\ reduction\ loop}}
\DoxyCodeLine{00354\ \ \ \mbox{\hyperlink{namespacetf_1_1detail_a4aef16c380f421cd83509ed535a51add}{detail::sycl\_reduce\_loop}}(\mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}},\ first,\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}},\ \mbox{\hyperlink{_partial_redux__count_8cpp_acbe60897559b79afc28b79b0687b5f29}{res}},\ op,\ \textcolor{keyword}{false},\ tmp,\ \{\}).wait();}
\DoxyCodeLine{00355\ }
\DoxyCodeLine{00356\ \ \ \textcolor{comment}{//\ deallocate\ the\ temporary\ buffer}}
\DoxyCodeLine{00357\ \ \ sycl::free(tmp,\ \mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}}.queue());}
\DoxyCodeLine{00358\ \}}
\DoxyCodeLine{00359\ }
\DoxyCodeLine{00380\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ P,\ \textcolor{keyword}{typename}\ I,\ \textcolor{keyword}{typename}\ T,\ \textcolor{keyword}{typename}\ O>}
\DoxyCodeLine{00381\ sycl::event\ \mbox{\hyperlink{namespacetf_a1568f3b401506517bc155a1aecadc905}{sycl\_uninitialized\_reduce\_async}}(}
\DoxyCodeLine{00382\ \ \ \mbox{\hyperlink{namespace_p}{P}}\&\&\ \mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}},\ I\ first,\ I\ last,\ \mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}}*\ \mbox{\hyperlink{_partial_redux__count_8cpp_acbe60897559b79afc28b79b0687b5f29}{res}},\ O\ op,\ \textcolor{keywordtype}{void}*\ buf,\ std::vector<sycl::event>\ dep}
\DoxyCodeLine{00383\ )\ \{}
\DoxyCodeLine{00384\ }
\DoxyCodeLine{00385\ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}}\ =\ std::distance(first,\ last);}
\DoxyCodeLine{00386\ }
\DoxyCodeLine{00387\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}}\ ==\ 0)\ \{}
\DoxyCodeLine{00388\ \ \ \ \ \textcolor{keywordflow}{return}\ \{\};}
\DoxyCodeLine{00389\ \ \ \}}
\DoxyCodeLine{00390\ }
\DoxyCodeLine{00391\ \ \ \textcolor{comment}{//\ reduction\ loop}}
\DoxyCodeLine{00392\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacetf_1_1detail_a4aef16c380f421cd83509ed535a51add}{detail::sycl\_reduce\_loop}}(}
\DoxyCodeLine{00393\ \ \ \ \ \mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}},\ first,\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}},\ \mbox{\hyperlink{_partial_redux__count_8cpp_acbe60897559b79afc28b79b0687b5f29}{res}},\ op,\ \textcolor{keyword}{false},\ buf,\ std::move(dep)}
\DoxyCodeLine{00394\ \ \ );}
\DoxyCodeLine{00395\ \}}
\DoxyCodeLine{00396\ }
\DoxyCodeLine{00397\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00398\ \textcolor{comment}{//\ syclFlow\ reduce}}
\DoxyCodeLine{00399\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00400\ }
\DoxyCodeLine{00401\ \textcolor{comment}{//\ Function:\ reduce}}
\DoxyCodeLine{00402\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ I,\ \textcolor{keyword}{typename}\ T,\ \textcolor{keyword}{typename}\ C>}
\DoxyCodeLine{00403\ \mbox{\hyperlink{classtf_1_1sycl_task}{syclTask}}\ \mbox{\hyperlink{classtf_1_1sycl_flow_acddd05832e53597ae9d30dc913d422ca}{syclFlow::reduce}}(I\ first,\ I\ last,\ \mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}}*\ \mbox{\hyperlink{_partial_redux__count_8cpp_acbe60897559b79afc28b79b0687b5f29}{res}},\ \mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}}\&\&\ op)\ \{}
\DoxyCodeLine{00404\ }
\DoxyCodeLine{00405\ \ \ \textcolor{comment}{//return\ on(\_reduce\_cgh<I,\ T,\ C,\ false>(first,\ last,\ res,\ std::forward<C>(op)));}}
\DoxyCodeLine{00406\ }
\DoxyCodeLine{00407\ \ \ \textcolor{keyword}{auto}\ bufsz\ =\ \mbox{\hyperlink{namespacetf_a7d5979bf44616a9019e700556aa396ba}{sycl\_reduce\_buffer\_size<syclDefaultExecutionPolicy,\ T>}}(}
\DoxyCodeLine{00408\ \ \ \ \ std::distance(first,\ last)}
\DoxyCodeLine{00409\ \ \ );}
\DoxyCodeLine{00410\ }
\DoxyCodeLine{00411\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classtf_1_1sycl_flow_a20b79581d27eaed2812ffb14dc821a64}{on}}([=,\ buf=\mbox{\hyperlink{structtf_1_1_mo_c}{MoC}}\{\mbox{\hyperlink{classtf_1_1sycl_scoped_device_memory}{syclScopedDeviceMemory<std::byte>}}(bufsz,\ \mbox{\hyperlink{classtf_1_1sycl_flow_a5728aaf61105ae3ee37eaddb24c1008d}{\_queue}})\}]}
\DoxyCodeLine{00412\ \ \ (sycl::queue\&\ \mbox{\hyperlink{namespacequeue}{queue}},\ std::vector<sycl::event>\ events)\ \textcolor{keyword}{mutable}\ \{}
\DoxyCodeLine{00413\ \ \ \ \ \mbox{\hyperlink{namespacetf_a77f0d44693b0899d6baa436e30f21389}{syclDefaultExecutionPolicy}}\ \mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}}(\mbox{\hyperlink{namespacequeue}{queue}});}
\DoxyCodeLine{00414\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacetf_a339d2a093e819c51cef5aa80669271f9}{sycl\_reduce\_async}}(}
\DoxyCodeLine{00415\ \ \ \ \ \ \ \mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}},\ first,\ last,\ \mbox{\hyperlink{_partial_redux__count_8cpp_acbe60897559b79afc28b79b0687b5f29}{res}},\ op,\ buf.get().data(),\ std::move(events)}
\DoxyCodeLine{00416\ \ \ \ \ );}
\DoxyCodeLine{00417\ \ \ \});}
\DoxyCodeLine{00418\ \}}
\DoxyCodeLine{00419\ }
\DoxyCodeLine{00420\ \textcolor{comment}{//\ Function:\ uninitialized\_reduce}}
\DoxyCodeLine{00421\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ I,\ \textcolor{keyword}{typename}\ T,\ \textcolor{keyword}{typename}\ C>}
\DoxyCodeLine{00422\ \mbox{\hyperlink{classtf_1_1sycl_task}{syclTask}}\ \mbox{\hyperlink{classtf_1_1sycl_flow_a7a3af92f105114b1095a2cec2ccdffbf}{syclFlow::uninitialized\_reduce}}(I\ first,\ I\ last,\ \mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}}*\ \mbox{\hyperlink{_partial_redux__count_8cpp_acbe60897559b79afc28b79b0687b5f29}{res}},\ \mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}}\&\&\ op)\ \{}
\DoxyCodeLine{00423\ \ \ \textcolor{comment}{//return\ on(\_reduce\_cgh<I,\ T,\ C,\ true>(first,\ last,\ res,\ std::forward<C>(op)));}}
\DoxyCodeLine{00424\ }
\DoxyCodeLine{00425\ \ \ \textcolor{keyword}{auto}\ bufsz\ =\ \mbox{\hyperlink{namespacetf_a7d5979bf44616a9019e700556aa396ba}{sycl\_reduce\_buffer\_size<syclDefaultExecutionPolicy,\ T>}}(}
\DoxyCodeLine{00426\ \ \ \ \ std::distance(first,\ last)}
\DoxyCodeLine{00427\ \ \ );}
\DoxyCodeLine{00428\ }
\DoxyCodeLine{00429\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classtf_1_1sycl_flow_a20b79581d27eaed2812ffb14dc821a64}{on}}([=,\ buf=\mbox{\hyperlink{structtf_1_1_mo_c}{MoC}}\{\mbox{\hyperlink{classtf_1_1sycl_scoped_device_memory}{syclScopedDeviceMemory<std::byte>}}(bufsz,\ \mbox{\hyperlink{classtf_1_1sycl_flow_a5728aaf61105ae3ee37eaddb24c1008d}{\_queue}})\}]}
\DoxyCodeLine{00430\ \ \ (sycl::queue\&\ \mbox{\hyperlink{namespacequeue}{queue}},\ std::vector<sycl::event>\ events)\ \textcolor{keyword}{mutable}\ \{}
\DoxyCodeLine{00431\ \ \ \ \ \mbox{\hyperlink{namespacetf_a77f0d44693b0899d6baa436e30f21389}{syclDefaultExecutionPolicy}}\ \mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}}(\mbox{\hyperlink{namespacequeue}{queue}});}
\DoxyCodeLine{00432\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacetf_a1568f3b401506517bc155a1aecadc905}{sycl\_uninitialized\_reduce\_async}}(}
\DoxyCodeLine{00433\ \ \ \ \ \ \ \mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}},\ first,\ last,\ \mbox{\hyperlink{_partial_redux__count_8cpp_acbe60897559b79afc28b79b0687b5f29}{res}},\ op,\ buf.get().data(),\ std::move(events)}
\DoxyCodeLine{00434\ \ \ \ \ );}
\DoxyCodeLine{00435\ \ \ \});}
\DoxyCodeLine{00436\ }
\DoxyCodeLine{00437\ \}}
\DoxyCodeLine{00438\ }
\DoxyCodeLine{00439\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00440\ \textcolor{comment}{//\ rebind\ methods}}
\DoxyCodeLine{00441\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00442\ }
\DoxyCodeLine{00444\ \textcolor{comment}{//template\ <typename\ I,\ typename\ T,\ typename\ C>}}
\DoxyCodeLine{00445\ \textcolor{comment}{//void\ syclFlow::reduce(syclTask\ task,\ I\ first,\ I\ last,\ T*\ res,\ C\&\&\ op)\ \{}}
\DoxyCodeLine{00446\ \textcolor{comment}{//\ \ //on(task,\ \_reduce\_cgh<I,\ T,\ C,\ false>(}}
\DoxyCodeLine{00447\ \textcolor{comment}{//\ \ //\ \ first,\ last,\ res,\ std::forward<C>(op)}}
\DoxyCodeLine{00448\ \textcolor{comment}{//\ \ //));}}
\DoxyCodeLine{00449\ \textcolor{comment}{//}}
\DoxyCodeLine{00450\ \textcolor{comment}{//\ \ auto\ bufsz\ =\ sycl\_reduce\_buffer\_size<syclDefaultExecutionPolicy,\ T>(}}
\DoxyCodeLine{00451\ \textcolor{comment}{//\ \ \ \ std::distance(first,\ last)}}
\DoxyCodeLine{00452\ \textcolor{comment}{//\ \ );}}
\DoxyCodeLine{00453\ \textcolor{comment}{//}}
\DoxyCodeLine{00454\ \textcolor{comment}{//\ \ on(task,\ [=,\ buf=MoC\{syclScopedDeviceMemory<std::byte>(bufsz,\ \_queue)\}]}}
\DoxyCodeLine{00455\ \textcolor{comment}{//\ \ (sycl::queue\&\ queue,\ std::vector<sycl::event>\ events)\ mutable\ \{}}
\DoxyCodeLine{00456\ \textcolor{comment}{//\ \ \ \ syclDefaultExecutionPolicy\ p(queue);}}
\DoxyCodeLine{00457\ \textcolor{comment}{//\ \ \ \ return\ sycl\_reduce\_async(}}
\DoxyCodeLine{00458\ \textcolor{comment}{//\ \ \ \ \ \ p,\ first,\ last,\ res,\ op,\ buf.get().data(),\ std::move(events)}}
\DoxyCodeLine{00459\ \textcolor{comment}{//\ \ \ \ );}}
\DoxyCodeLine{00460\ \textcolor{comment}{//\ \ \});}}
\DoxyCodeLine{00461\ \textcolor{comment}{//\}}}
\DoxyCodeLine{00462\ \textcolor{comment}{//}}
\DoxyCodeLine{00464\ \textcolor{comment}{//template\ <typename\ I,\ typename\ T,\ typename\ C>}}
\DoxyCodeLine{00465\ \textcolor{comment}{//void\ syclFlow::uninitialized\_reduce(}}
\DoxyCodeLine{00466\ \textcolor{comment}{//\ \ syclTask\ task,\ I\ first,\ I\ last,\ T*\ res,\ C\&\&\ op}}
\DoxyCodeLine{00467\ \textcolor{comment}{//)\ \{}}
\DoxyCodeLine{00468\ \textcolor{comment}{//\ \ //on(task,\ \_reduce\_cgh<I,\ T,\ C,\ true>(}}
\DoxyCodeLine{00469\ \textcolor{comment}{//\ \ //\ \ first,\ last,\ res,\ std::forward<C>(op)}}
\DoxyCodeLine{00470\ \textcolor{comment}{//\ \ //));}}
\DoxyCodeLine{00471\ \textcolor{comment}{//\ \ auto\ bufsz\ =\ sycl\_reduce\_buffer\_size<syclDefaultExecutionPolicy,\ T>(}}
\DoxyCodeLine{00472\ \textcolor{comment}{//\ \ \ \ std::distance(first,\ last)}}
\DoxyCodeLine{00473\ \textcolor{comment}{//\ \ );}}
\DoxyCodeLine{00474\ \textcolor{comment}{//}}
\DoxyCodeLine{00475\ \textcolor{comment}{//\ \ on(task,\ [=,\ buf=MoC\{syclScopedDeviceMemory<std::byte>(bufsz,\ \_queue)\}]}}
\DoxyCodeLine{00476\ \textcolor{comment}{//\ \ (sycl::queue\&\ queue,\ std::vector<sycl::event>\ events)\ mutable\ \{}}
\DoxyCodeLine{00477\ \textcolor{comment}{//\ \ \ \ syclDefaultExecutionPolicy\ p(queue);}}
\DoxyCodeLine{00478\ \textcolor{comment}{//\ \ \ \ return\ sycl\_uninitialized\_reduce\_async(}}
\DoxyCodeLine{00479\ \textcolor{comment}{//\ \ \ \ \ \ p,\ first,\ last,\ res,\ op,\ buf.get().data(),\ std::move(events)}}
\DoxyCodeLine{00480\ \textcolor{comment}{//\ \ \ \ );}}
\DoxyCodeLine{00481\ \textcolor{comment}{//\ \ \});}}
\DoxyCodeLine{00482\ \textcolor{comment}{//\}}}
\DoxyCodeLine{00483\ }
\DoxyCodeLine{00484\ }
\DoxyCodeLine{00485\ \}\ \ \textcolor{comment}{//\ end\ of\ namespace\ tf\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00486\ }
\DoxyCodeLine{00487\ }

\end{DoxyCode}
