\doxysection{cds\+::gc\+::DHP类 参考}
\hypertarget{classcds_1_1gc_1_1_d_h_p}{}\label{classcds_1_1gc_1_1_d_h_p}\index{cds::gc::DHP@{cds::gc::DHP}}


Dynamic (adaptie) Hazard Pointer SMR  




{\ttfamily \#include $<$dhp.\+h$>$}

\doxysubsubsection*{类}
\begin{DoxyCompactItemize}
\item 
class \mbox{\hyperlink{classcds_1_1gc_1_1_d_h_p_1_1_guard}{Guard}}
\begin{DoxyCompactList}\small\item\em Dynamic Hazard Pointer guard \end{DoxyCompactList}\item 
class \mbox{\hyperlink{classcds_1_1gc_1_1_d_h_p_1_1_guard_array}{Guard\+Array}}
\begin{DoxyCompactList}\small\item\em Array of Dynamic Hazard Pointer guards \end{DoxyCompactList}\item 
class \mbox{\hyperlink{classcds_1_1gc_1_1_d_h_p_1_1guarded__ptr}{guarded\+\_\+ptr}}
\begin{DoxyCompactList}\small\item\em Guarded pointer \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Public 类型}
\begin{DoxyCompactItemize}
\item 
typedef \mbox{\hyperlink{ittnotify__static_8h_a61af67d9d838a9497ca5b188dabc1aa0}{void}} \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{classcds_1_1gc_1_1_d_h_p_ad6f94dbe36ebd1a1a1fdd6457d95db25}{guarded\+\_\+pointer}}
\begin{DoxyCompactList}\small\item\em Native guarded pointer type \end{DoxyCompactList}\item 
{\footnotesize template$<$typename \mbox{\hyperlink{_tutorial__sparse__example_8cpp_af639fb96631ba0018f0b2259fc95edfb}{T}}$>$ }\\using \mbox{\hyperlink{classcds_1_1gc_1_1_d_h_p_a3299cac0d2f7284ceeae5f6e4619b746}{atomic\+\_\+ref}} = atomics\+::atomic$<$\mbox{\hyperlink{_tutorial__sparse__example_8cpp_af639fb96631ba0018f0b2259fc95edfb}{T}} \texorpdfstring{$\ast$}{*}$>$
\begin{DoxyCompactList}\small\item\em Atomic reference \end{DoxyCompactList}\item 
{\footnotesize template$<$typename \mbox{\hyperlink{_tutorial__sparse__example_8cpp_af639fb96631ba0018f0b2259fc95edfb}{T}}$>$ }\\using \mbox{\hyperlink{classcds_1_1gc_1_1_d_h_p_a6eb8a07cdcb5f14cebed712e3b7a73de}{atomic\+\_\+type}} = atomics\+::atomic$<$\mbox{\hyperlink{_tutorial__sparse__example_8cpp_af639fb96631ba0018f0b2259fc95edfb}{T}}$>$
\begin{DoxyCompactList}\small\item\em Atomic type \end{DoxyCompactList}\item 
{\footnotesize template$<$typename Marked\+Ptr$>$ }\\using \mbox{\hyperlink{classcds_1_1gc_1_1_d_h_p_affeae2a85fb8e80b2e280086d9ef7f8e}{atomic\+\_\+marked\+\_\+ptr}} = atomics\+::atomic$<$Marked\+Ptr$>$
\begin{DoxyCompactList}\small\item\em Atomic marked pointer \end{DoxyCompactList}\item 
typedef \mbox{\hyperlink{structcds_1_1gc_1_1dhp_1_1stat}{dhp\+::stat}} \mbox{\hyperlink{classcds_1_1gc_1_1_d_h_p_a9c85a7e0369b9cb15cd2925b46acbe2c}{stat}}
\begin{DoxyCompactList}\small\item\em Internal statistics \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Public 成员函数}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classcds_1_1gc_1_1_d_h_p_afd5726364310a74bc0a9aefbc3facd26}{DHP}} (size\+\_\+t n\+Initial\+Hazard\+Ptr\+Count=16)
\begin{DoxyCompactList}\small\item\em Initializes DHP memory manager singleton \end{DoxyCompactList}\item 
\mbox{\hyperlink{classcds_1_1gc_1_1_d_h_p_a1d83af864d44020c228b8247c9cdc557}{\texorpdfstring{$\sim$}{\string~}\+DHP}} ()
\begin{DoxyCompactList}\small\item\em Destroys DHP memory manager \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{静态 Public 成员函数}
\begin{DoxyCompactItemize}
\item 
static constexpr \mbox{\hyperlink{sugar_8h_abb452686968e48b67397da5f97445f5b}{bool}} \mbox{\hyperlink{classcds_1_1gc_1_1_d_h_p_a93ec7fc6a2fb39c98c0338846b90636b}{check\+\_\+available\+\_\+guards}} (size\+\_\+t)
\begin{DoxyCompactList}\small\item\em Checks if count of hazard pointer is no less than {\ttfamily n\+Count\+Needed} \end{DoxyCompactList}\item 
static \mbox{\hyperlink{ittnotify__static_8h_a61af67d9d838a9497ca5b188dabc1aa0}{void}} \mbox{\hyperlink{classcds_1_1gc_1_1_d_h_p_addaff9c937beaa650a3134505736a145}{set\+\_\+memory\+\_\+allocator}} (\mbox{\hyperlink{ittnotify__static_8h_a61af67d9d838a9497ca5b188dabc1aa0}{void}} \texorpdfstring{$\ast$}{*}(\texorpdfstring{$\ast$}{*}alloc\+\_\+func)(size\+\_\+t \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}}), \mbox{\hyperlink{ittnotify__static_8h_a61af67d9d838a9497ca5b188dabc1aa0}{void}}(\texorpdfstring{$\ast$}{*}free\+\_\+func)(\mbox{\hyperlink{ittnotify__static_8h_a61af67d9d838a9497ca5b188dabc1aa0}{void}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}}))
\begin{DoxyCompactList}\small\item\em Set memory management functions \end{DoxyCompactList}\item 
{\footnotesize template$<$typename \mbox{\hyperlink{_tutorial__sparse__example_8cpp_af639fb96631ba0018f0b2259fc95edfb}{T}}$>$ }\\static \mbox{\hyperlink{ittnotify__static_8h_a61af67d9d838a9497ca5b188dabc1aa0}{void}} \mbox{\hyperlink{classcds_1_1gc_1_1_d_h_p_aec005e48c74a32a050d143719ccab042}{retire}} (\mbox{\hyperlink{_tutorial__sparse__example_8cpp_af639fb96631ba0018f0b2259fc95edfb}{T}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}}, \mbox{\hyperlink{ittnotify__static_8h_a61af67d9d838a9497ca5b188dabc1aa0}{void}}(\texorpdfstring{$\ast$}{*}\mbox{\hyperlink{structfunc}{func}})(\mbox{\hyperlink{ittnotify__static_8h_a61af67d9d838a9497ca5b188dabc1aa0}{void}} \texorpdfstring{$\ast$}{*}))
\begin{DoxyCompactList}\small\item\em Retire pointer {\ttfamily p} with function {\ttfamily p\+Func} \end{DoxyCompactList}\item 
{\footnotesize template$<$class Disposer, typename \mbox{\hyperlink{_tutorial__sparse__example_8cpp_af639fb96631ba0018f0b2259fc95edfb}{T}}$>$ }\\static \mbox{\hyperlink{ittnotify__static_8h_a61af67d9d838a9497ca5b188dabc1aa0}{void}} \mbox{\hyperlink{classcds_1_1gc_1_1_d_h_p_a599e8517bcf88bfb2f609007867e1512}{retire}} (\mbox{\hyperlink{_tutorial__sparse__example_8cpp_af639fb96631ba0018f0b2259fc95edfb}{T}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}})
\begin{DoxyCompactList}\small\item\em Retire pointer {\ttfamily p} with functor of type {\ttfamily Disposer} \end{DoxyCompactList}\item 
static \mbox{\hyperlink{sugar_8h_abb452686968e48b67397da5f97445f5b}{bool}} \mbox{\hyperlink{classcds_1_1gc_1_1_d_h_p_a0adf84336449c28e4e4e50b4ac8154f0}{is\+Used}} ()
\begin{DoxyCompactList}\small\item\em Checks if Dynamic Hazard Pointer GC is constructed and may be used \end{DoxyCompactList}\item 
static \mbox{\hyperlink{ittnotify__static_8h_a61af67d9d838a9497ca5b188dabc1aa0}{void}} \mbox{\hyperlink{classcds_1_1gc_1_1_d_h_p_a0d5865baa42a93fc72a7878723408ce2}{scan}} ()
\begin{DoxyCompactList}\small\item\em Forced GC cycle call for current thread \end{DoxyCompactList}\item 
static \mbox{\hyperlink{ittnotify__static_8h_a61af67d9d838a9497ca5b188dabc1aa0}{void}} \mbox{\hyperlink{classcds_1_1gc_1_1_d_h_p_a2f74f3a7573638d7ca5161e45494f90b}{force\+\_\+dispose}} ()
\begin{DoxyCompactList}\small\item\em Synonym for {\ttfamily \doxylink{classcds_1_1gc_1_1_d_h_p_a0d5865baa42a93fc72a7878723408ce2}{scan()}} \end{DoxyCompactList}\item 
static \mbox{\hyperlink{ittnotify__static_8h_a61af67d9d838a9497ca5b188dabc1aa0}{void}} \mbox{\hyperlink{classcds_1_1gc_1_1_d_h_p_abaf4f1c5e616c98fa64a35df04c1dd85}{statistics}} (\mbox{\hyperlink{classcds_1_1gc_1_1_d_h_p_a9c85a7e0369b9cb15cd2925b46acbe2c}{stat}} \&st)
\begin{DoxyCompactList}\small\item\em Returns internal statistics \end{DoxyCompactList}\item 
static \mbox{\hyperlink{compiler_2defs_8h_a4ac8e9c4ea6b38586b0189153d1f38c9}{CDS\+\_\+\+EXPORT\+\_\+\+API}} \mbox{\hyperlink{classcds_1_1gc_1_1_d_h_p_a9c85a7e0369b9cb15cd2925b46acbe2c}{stat}} const \& \mbox{\hyperlink{classcds_1_1gc_1_1_d_h_p_a42fa95f8b290c889f21e4d4c5d20d6ae}{postmortem\+\_\+statistics}} ()
\begin{DoxyCompactList}\small\item\em Returns post-\/mortem statistics \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{详细描述}
Dynamic (adaptie) Hazard Pointer SMR 

Implementation of Dynamic (adaptive) Hazard Pointer SMR

Sources\+:
\begin{DoxyItemize}
\item \mbox{[}2002\mbox{]} Maged M.\+Michael "{}\+Safe memory reclamation for dynamic lock-\/freeobjects using atomic reads and writes"{}
\item \mbox{[}2003\mbox{]} Maged M.\+Michael "{}\+Hazard Pointers\+: Safe memory reclamation for lock-\/free objects"{}
\item \mbox{[}2004\mbox{]} Andrei Alexandrescy, Maged Michael "{}\+Lock-\/free Data Structures with Hazard Pointers"{}
\end{DoxyItemize}

DHP is an adaptive variant of classic {\ttfamily \doxylink{namespacecds_1_1gc_af0523881f089593a7559d194ee2b5dd9}{cds\+::gc\+::\+HP}}, see \doxysectlink{group__cds__garbage__collector}{Compare HP implementation}{0}

\begin{DoxyNote}{注解}
Internally, DHP depends on free-\/list implementation. There are DCAS-\/based free-\/list {\ttfamily \doxylink{classcds_1_1intrusive_1_1_tagged_free_list}{cds\+::intrusive\+::\+Tagged\+Free\+List}} and more complicated CAS-\/based free-\/list {\ttfamily \doxylink{classcds_1_1intrusive_1_1_free_list}{cds\+::intrusive\+::\+Free\+List}}. For x86 architecture and GCC/clang, libcds selects appropriate free-\/list based on {\ttfamily -\/mcx16} compiler flag. You may manually disable DCAS support specifying {\ttfamily -\/DCDS\+\_\+\+DISABLE\+\_\+128\+BIT\+\_\+\+ATOMIC} for 64bit build or {\ttfamily -\/DCDS\+\_\+\+DISABLE\+\_\+64\+BIT\+\_\+\+ATOMIC} for 32bit build in compiler command line. All your projects and libcds MUST be compiled with the same flags -\/ either with DCAS support or without it. For MS VC++ compiler DCAS is not supported.
\end{DoxyNote}
See \doxylink{defs.h_cds_how_to_use}{How to use} section for details how to apply SMR. 

\doxysubsection{成员类型定义说明}
\Hypertarget{classcds_1_1gc_1_1_d_h_p_affeae2a85fb8e80b2e280086d9ef7f8e}\index{cds::gc::DHP@{cds::gc::DHP}!atomic\_marked\_ptr@{atomic\_marked\_ptr}}
\index{atomic\_marked\_ptr@{atomic\_marked\_ptr}!cds::gc::DHP@{cds::gc::DHP}}
\doxysubsubsection{\texorpdfstring{atomic\_marked\_ptr}{atomic\_marked\_ptr}}
{\footnotesize\ttfamily \label{classcds_1_1gc_1_1_d_h_p_affeae2a85fb8e80b2e280086d9ef7f8e} 
template$<$typename Marked\+Ptr$>$ \\
using \mbox{\hyperlink{classcds_1_1gc_1_1_d_h_p_affeae2a85fb8e80b2e280086d9ef7f8e}{cds\+::gc\+::\+DHP\+::atomic\+\_\+marked\+\_\+ptr}} = atomics\+::atomic$<$Marked\+Ptr$>$}



Atomic marked pointer 

\Hypertarget{classcds_1_1gc_1_1_d_h_p_a3299cac0d2f7284ceeae5f6e4619b746}\index{cds::gc::DHP@{cds::gc::DHP}!atomic\_ref@{atomic\_ref}}
\index{atomic\_ref@{atomic\_ref}!cds::gc::DHP@{cds::gc::DHP}}
\doxysubsubsection{\texorpdfstring{atomic\_ref}{atomic\_ref}}
{\footnotesize\ttfamily \label{classcds_1_1gc_1_1_d_h_p_a3299cac0d2f7284ceeae5f6e4619b746} 
template$<$typename \mbox{\hyperlink{_tutorial__sparse__example_8cpp_af639fb96631ba0018f0b2259fc95edfb}{T}}$>$ \\
using \mbox{\hyperlink{classcds_1_1gc_1_1_d_h_p_a3299cac0d2f7284ceeae5f6e4619b746}{cds\+::gc\+::\+DHP\+::atomic\+\_\+ref}} = atomics\+::atomic$<$\mbox{\hyperlink{_tutorial__sparse__example_8cpp_af639fb96631ba0018f0b2259fc95edfb}{T}} \texorpdfstring{$\ast$}{*}$>$}



Atomic reference 

\Hypertarget{classcds_1_1gc_1_1_d_h_p_a6eb8a07cdcb5f14cebed712e3b7a73de}\index{cds::gc::DHP@{cds::gc::DHP}!atomic\_type@{atomic\_type}}
\index{atomic\_type@{atomic\_type}!cds::gc::DHP@{cds::gc::DHP}}
\doxysubsubsection{\texorpdfstring{atomic\_type}{atomic\_type}}
{\footnotesize\ttfamily \label{classcds_1_1gc_1_1_d_h_p_a6eb8a07cdcb5f14cebed712e3b7a73de} 
template$<$typename \mbox{\hyperlink{_tutorial__sparse__example_8cpp_af639fb96631ba0018f0b2259fc95edfb}{T}}$>$ \\
using \mbox{\hyperlink{classcds_1_1gc_1_1_d_h_p_a6eb8a07cdcb5f14cebed712e3b7a73de}{cds\+::gc\+::\+DHP\+::atomic\+\_\+type}} = atomics\+::atomic$<$\mbox{\hyperlink{_tutorial__sparse__example_8cpp_af639fb96631ba0018f0b2259fc95edfb}{T}}$>$}



Atomic type 

\Hypertarget{classcds_1_1gc_1_1_d_h_p_ad6f94dbe36ebd1a1a1fdd6457d95db25}\index{cds::gc::DHP@{cds::gc::DHP}!guarded\_pointer@{guarded\_pointer}}
\index{guarded\_pointer@{guarded\_pointer}!cds::gc::DHP@{cds::gc::DHP}}
\doxysubsubsection{\texorpdfstring{guarded\_pointer}{guarded\_pointer}}
{\footnotesize\ttfamily \label{classcds_1_1gc_1_1_d_h_p_ad6f94dbe36ebd1a1a1fdd6457d95db25} 
typedef \mbox{\hyperlink{ittnotify__static_8h_a61af67d9d838a9497ca5b188dabc1aa0}{void}}\texorpdfstring{$\ast$}{*} \mbox{\hyperlink{classcds_1_1gc_1_1_d_h_p_ad6f94dbe36ebd1a1a1fdd6457d95db25}{cds\+::gc\+::\+DHP\+::guarded\+\_\+pointer}}}



Native guarded pointer type 

\Hypertarget{classcds_1_1gc_1_1_d_h_p_a9c85a7e0369b9cb15cd2925b46acbe2c}\index{cds::gc::DHP@{cds::gc::DHP}!stat@{stat}}
\index{stat@{stat}!cds::gc::DHP@{cds::gc::DHP}}
\doxysubsubsection{\texorpdfstring{stat}{stat}}
{\footnotesize\ttfamily \label{classcds_1_1gc_1_1_d_h_p_a9c85a7e0369b9cb15cd2925b46acbe2c} 
typedef \mbox{\hyperlink{structcds_1_1gc_1_1dhp_1_1stat}{dhp\+::stat}} \mbox{\hyperlink{classcds_1_1gc_1_1_d_h_p_a9c85a7e0369b9cb15cd2925b46acbe2c}{cds\+::gc\+::\+DHP\+::stat}}}



Internal statistics 



\doxysubsection{构造及析构函数说明}
\Hypertarget{classcds_1_1gc_1_1_d_h_p_afd5726364310a74bc0a9aefbc3facd26}\index{cds::gc::DHP@{cds::gc::DHP}!DHP@{DHP}}
\index{DHP@{DHP}!cds::gc::DHP@{cds::gc::DHP}}
\doxysubsubsection{\texorpdfstring{DHP()}{DHP()}}
{\footnotesize\ttfamily \label{classcds_1_1gc_1_1_d_h_p_afd5726364310a74bc0a9aefbc3facd26} 
cds\+::gc\+::\+DHP\+::\+DHP (\begin{DoxyParamCaption}\item[{size\+\_\+t}]{n\+Initial\+Hazard\+Ptr\+Count}{ = {\ttfamily 16}}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [explicit]}}



Initializes DHP memory manager singleton 

Constructor creates and initializes DHP global object. DHP object should be created before using CDS data structure based on {\ttfamily cds\+::gc\+::\+DHP}. Usually, it is created in the beginning of {\ttfamily \doxylink{main-override-static_8c_ae66f6b31b5ad750f1fe042a706a4e3d4}{main()}} function. After creating of global object you may use CDS data structures based on {\ttfamily cds\+::gc\+::\+DHP}.

{\ttfamily n\+Initial\+Thread\+Guard\+Count} -\/ initial count of guard allocated for each thread. When a thread is initialized the GC allocates local guard pool for the thread from a common guard pool. By perforce the local thread\textquotesingle{}s guard pool is grown automatically from common pool. When the thread terminated its guard pool is backed to common GC\textquotesingle{}s pool. 
\begin{DoxyParams}{参数}
{\em n\+Initial\+Hazard\+Ptr\+Count} & Initial number of hazard pointer per thread \\
\hline
\end{DoxyParams}
\Hypertarget{classcds_1_1gc_1_1_d_h_p_a1d83af864d44020c228b8247c9cdc557}\index{cds::gc::DHP@{cds::gc::DHP}!````~DHP@{\texorpdfstring{$\sim$}{\string~}DHP}}
\index{````~DHP@{\texorpdfstring{$\sim$}{\string~}DHP}!cds::gc::DHP@{cds::gc::DHP}}
\doxysubsubsection{\texorpdfstring{\texorpdfstring{$\sim$}{\string~}DHP()}{\string~DHP()}}
{\footnotesize\ttfamily \label{classcds_1_1gc_1_1_d_h_p_a1d83af864d44020c228b8247c9cdc557} 
cds\+::gc\+::\+DHP\+::\texorpdfstring{$\sim$}{\string~}\+DHP (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Destroys DHP memory manager 

The destructor destroys DHP global object. After calling of this function you may {\bfseries{NOT}} use CDS data structures based on {\ttfamily cds\+::gc\+::\+DHP}. Usually, DHP object is destroyed at the end of your {\ttfamily \doxylink{main-override-static_8c_ae66f6b31b5ad750f1fe042a706a4e3d4}{main()}}. 

\doxysubsection{成员函数说明}
\Hypertarget{classcds_1_1gc_1_1_d_h_p_a93ec7fc6a2fb39c98c0338846b90636b}\index{cds::gc::DHP@{cds::gc::DHP}!check\_available\_guards@{check\_available\_guards}}
\index{check\_available\_guards@{check\_available\_guards}!cds::gc::DHP@{cds::gc::DHP}}
\doxysubsubsection{\texorpdfstring{check\_available\_guards()}{check\_available\_guards()}}
{\footnotesize\ttfamily \label{classcds_1_1gc_1_1_d_h_p_a93ec7fc6a2fb39c98c0338846b90636b} 
static constexpr \mbox{\hyperlink{sugar_8h_abb452686968e48b67397da5f97445f5b}{bool}} cds\+::gc\+::\+DHP\+::check\+\_\+available\+\_\+guards (\begin{DoxyParamCaption}\item[{size\+\_\+t}]{}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}, {\ttfamily [constexpr]}}



Checks if count of hazard pointer is no less than {\ttfamily n\+Count\+Needed} 

The function always returns {\ttfamily true} since the guard count is unlimited for {\ttfamily gc\+::\+DHP} garbage collector. \Hypertarget{classcds_1_1gc_1_1_d_h_p_a2f74f3a7573638d7ca5161e45494f90b}\index{cds::gc::DHP@{cds::gc::DHP}!force\_dispose@{force\_dispose}}
\index{force\_dispose@{force\_dispose}!cds::gc::DHP@{cds::gc::DHP}}
\doxysubsubsection{\texorpdfstring{force\_dispose()}{force\_dispose()}}
{\footnotesize\ttfamily \label{classcds_1_1gc_1_1_d_h_p_a2f74f3a7573638d7ca5161e45494f90b} 
static \mbox{\hyperlink{ittnotify__static_8h_a61af67d9d838a9497ca5b188dabc1aa0}{void}} cds\+::gc\+::\+DHP\+::force\+\_\+dispose (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}



Synonym for {\ttfamily \doxylink{classcds_1_1gc_1_1_d_h_p_a0d5865baa42a93fc72a7878723408ce2}{scan()}} 

函数调用图\+:
% FIG 0
\Hypertarget{classcds_1_1gc_1_1_d_h_p_a0adf84336449c28e4e4e50b4ac8154f0}\index{cds::gc::DHP@{cds::gc::DHP}!isUsed@{isUsed}}
\index{isUsed@{isUsed}!cds::gc::DHP@{cds::gc::DHP}}
\doxysubsubsection{\texorpdfstring{isUsed()}{isUsed()}}
{\footnotesize\ttfamily \label{classcds_1_1gc_1_1_d_h_p_a0adf84336449c28e4e4e50b4ac8154f0} 
static \mbox{\hyperlink{sugar_8h_abb452686968e48b67397da5f97445f5b}{bool}} cds\+::gc\+::\+DHP\+::is\+Used (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}



Checks if Dynamic Hazard Pointer GC is constructed and may be used 

\Hypertarget{classcds_1_1gc_1_1_d_h_p_a42fa95f8b290c889f21e4d4c5d20d6ae}\index{cds::gc::DHP@{cds::gc::DHP}!postmortem\_statistics@{postmortem\_statistics}}
\index{postmortem\_statistics@{postmortem\_statistics}!cds::gc::DHP@{cds::gc::DHP}}
\doxysubsubsection{\texorpdfstring{postmortem\_statistics()}{postmortem\_statistics()}}
{\footnotesize\ttfamily \label{classcds_1_1gc_1_1_d_h_p_a42fa95f8b290c889f21e4d4c5d20d6ae} 
\mbox{\hyperlink{compiler_2defs_8h_a4ac8e9c4ea6b38586b0189153d1f38c9}{CDS\+\_\+\+EXPORT\+\_\+\+API}} \mbox{\hyperlink{classcds_1_1gc_1_1_d_h_p_a9c85a7e0369b9cb15cd2925b46acbe2c}{cds\+::gc\+::\+DHP\+::stat}} const  \& cds\+::gc\+::\+DHP\+::postmortem\+\_\+statistics (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Returns post-\/mortem statistics 

Post-\/mortem statistics is gathered in the {\ttfamily DHP} object destructor and can be accessible after destructing the global {\ttfamily DHP} object.

\begin{DoxyNote}{注解}
Internal statistics is available only if you compile {\ttfamily libcds} and your program with {\ttfamily -\/DCDS\+\_\+\+ENABLE\+\_\+\+HPSTAT}.
\end{DoxyNote}
Usage\+: 
\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{keywordtype}{int}\ \mbox{\hyperlink{main-override-static_8c_ae66f6b31b5ad750f1fe042a706a4e3d4}{main}}()}
\DoxyCodeLine{\{}
\DoxyCodeLine{\ \ \ \ \mbox{\hyperlink{namespacecds_ae14cc7bb67e75ea6ed18a82f3380d2c0}{cds::Initialize}}();}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{comment}{//\ Initialize\ DHP\ SMR}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ cds::gc::DHP\ dhp;}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{comment}{//\ deal\ with\ DHP-\/based\ data\ structured}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{comment}{//\ ...}}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ DHP\ object\ destroyed}}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ Get\ total\ post-\/mortem\ statistics}}
\DoxyCodeLine{\ \ \ \ \mbox{\hyperlink{classcds_1_1gc_1_1_d_h_p_a9c85a7e0369b9cb15cd2925b46acbe2c}{cds::gc::DHP::stat}}\ \textcolor{keyword}{const}\&\ st\ =\ \mbox{\hyperlink{classcds_1_1gc_1_1_d_h_p_a42fa95f8b290c889f21e4d4c5d20d6ae}{cds::gc::DHP::postmortem\_statistics}}();}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \mbox{\hyperlink{printf_8h_aee3ed3a831f25f07e7be3919fff2203a}{printf}}(\ \textcolor{stringliteral}{"{}DHP\ statistics:\(\backslash\)n"{}}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\ \ thread\ count\ \ \ \ \ \ \ \ \ \ \ =\ \%llu\(\backslash\)n"{}}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\ \ guard\ allocated\ \ \ \ \ \ \ \ =\ \%llu\(\backslash\)n"{}}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\ \ guard\ freed\ \ \ \ \ \ \ \ \ \ \ \ =\ \%llu\(\backslash\)n"{}}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\ \ retired\ data\ count\ \ \ \ \ =\ \%llu\(\backslash\)n"{}}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\ \ free\ data\ count\ \ \ \ \ \ \ \ =\ \%llu\(\backslash\)n"{}}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\ \ scan()\ call\ count\ \ \ \ \ \ =\ \%llu\(\backslash\)n"{}}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\ \ help\_scan()\ call\ count\ =\ \%llu\(\backslash\)n"{}},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ st.\mbox{\hyperlink{structcds_1_1gc_1_1dhp_1_1stat_a5e49c933308355dac28c93fed8038cfb}{thread\_rec\_count}},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ st.\mbox{\hyperlink{structcds_1_1gc_1_1dhp_1_1stat_a67b79f01f3a4027703624745c40e9c52}{guard\_allocated}},\ st.\mbox{\hyperlink{structcds_1_1gc_1_1dhp_1_1stat_a29f36d62fa4c2d1f441188b613cd1944}{guard\_freed}},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ st.\mbox{\hyperlink{structcds_1_1gc_1_1dhp_1_1stat_a21839e45101bd6ae8d68963f550a2b7b}{retired\_count}},\ st.\mbox{\hyperlink{structcds_1_1gc_1_1dhp_1_1stat_af9a44851f0c028f66064d0b44e8eaedf}{free\_count}},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ st.\mbox{\hyperlink{structcds_1_1gc_1_1dhp_1_1stat_a1d0d2015438250beaf5d6602f36bd3f3}{scan\_count}},\ st.\mbox{\hyperlink{structcds_1_1gc_1_1dhp_1_1stat_a981160606e6dd2f13db97f88c6e74ad8}{help\_scan\_count}}}
\DoxyCodeLine{\ \ \ \ );}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \mbox{\hyperlink{namespacecds_a9ca275d587d2b0b11ded25220718a049}{cds::Terminate}}();}
\DoxyCodeLine{\}}

\end{DoxyCode}
 \Hypertarget{classcds_1_1gc_1_1_d_h_p_a599e8517bcf88bfb2f609007867e1512}\index{cds::gc::DHP@{cds::gc::DHP}!retire@{retire}}
\index{retire@{retire}!cds::gc::DHP@{cds::gc::DHP}}
\doxysubsubsection{\texorpdfstring{retire()}{retire()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily \label{classcds_1_1gc_1_1_d_h_p_a599e8517bcf88bfb2f609007867e1512} 
template$<$class Disposer, typename \mbox{\hyperlink{_tutorial__sparse__example_8cpp_af639fb96631ba0018f0b2259fc95edfb}{T}}$>$ \\
static \mbox{\hyperlink{ittnotify__static_8h_a61af67d9d838a9497ca5b188dabc1aa0}{void}} cds\+::gc\+::\+DHP\+::retire (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{_tutorial__sparse__example_8cpp_af639fb96631ba0018f0b2259fc95edfb}{T}} \texorpdfstring{$\ast$}{*}}]{p}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}



Retire pointer {\ttfamily p} with functor of type {\ttfamily Disposer} 

The function places pointer {\ttfamily p} to array of pointers ready for removing. (so called retired pointer array). The pointer can be safely removed when no hazard pointer points to it.

Deleting the pointer is an invocation of some object of type {\ttfamily Disposer}; the interface of {\ttfamily Disposer} is\+: 
\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{\textcolor{keyword}{struct\ }disposer\ \{}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordtype}{void}\ operator()(\ \mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}}\ *\ \mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}}\ )\ \ \ \ ;\ \ \ \textcolor{comment}{//\ disposing\ operator}}
\DoxyCodeLine{\};}

\end{DoxyCode}
 Since the functor call can happen at any time after {\ttfamily \doxylink{classcds_1_1gc_1_1_d_h_p_aec005e48c74a32a050d143719ccab042}{retire()}} call, additional restrictions are imposed to {\ttfamily Disposer} type\+:
\begin{DoxyItemize}
\item it should be stateless functor
\item it should be default-\/constructible
\item the result of functor call with argument {\ttfamily p} should not depend on where the functor will be called.
\end{DoxyItemize}

\begin{DoxyParagraph}{Examples\+:}
Operator {\ttfamily delete} functor\+: 
\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{\textcolor{keyword}{struct\ }disposer\ \{}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordtype}{void}\ operator\ ()(\ \mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}}\ *\ \mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}}\ )\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keyword}{delete}\ \mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}};}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{\};}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{//\ How\ to\ call\ HP::retire\ method}}
\DoxyCodeLine{\textcolor{keywordtype}{int}\ *\ \mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}}\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{sugar_8h_ae4f82344f573c70aa1066a2394bba345}{int}};}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{//\ ...\ use\ p\ in\ lock-\/free\ manner}}
\DoxyCodeLine{}
\DoxyCodeLine{\mbox{\hyperlink{classcds_1_1gc_1_1_d_h_p_aec005e48c74a32a050d143719ccab042}{cds::gc::DHP::retire<disposer>}}(\ \mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}}\ )\ ;\ \ \ \textcolor{comment}{//\ place\ p\ to\ retired\ pointer\ array\ of\ DHP\ SMR}}

\end{DoxyCode}

\end{DoxyParagraph}
\doxylink{struct_functor}{Functor} based on {\ttfamily std\+::allocator} \+: 
\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Alloc\ =\ std::allocator<\textcolor{keywordtype}{int}>\ >}
\DoxyCodeLine{\textcolor{keyword}{struct\ }disposer\ \{}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordtype}{void}\ operator()(\ \mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}}\ *\ \mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}}\ )\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ Alloc::templare\ rebind<T>::other\ alloc\_t;}
\DoxyCodeLine{\ \ \ \ \ \ \ \ alloc\_t\ \mbox{\hyperlink{_cwise__product_8cpp_ad2cbe4616e813eb9af81732dca777b24}{a}};}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \mbox{\hyperlink{_cwise__product_8cpp_ad2cbe4616e813eb9af81732dca777b24}{a}}.destroy(\ \mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}}\ );}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \mbox{\hyperlink{_cwise__product_8cpp_ad2cbe4616e813eb9af81732dca777b24}{a}}.deallocate(\ \mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}},\ 1\ );}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{\};}

\end{DoxyCode}
 函数调用图\+:
% FIG 1
\Hypertarget{classcds_1_1gc_1_1_d_h_p_aec005e48c74a32a050d143719ccab042}\index{cds::gc::DHP@{cds::gc::DHP}!retire@{retire}}
\index{retire@{retire}!cds::gc::DHP@{cds::gc::DHP}}
\doxysubsubsection{\texorpdfstring{retire()}{retire()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily \label{classcds_1_1gc_1_1_d_h_p_aec005e48c74a32a050d143719ccab042} 
template$<$typename \mbox{\hyperlink{_tutorial__sparse__example_8cpp_af639fb96631ba0018f0b2259fc95edfb}{T}}$>$ \\
static \mbox{\hyperlink{ittnotify__static_8h_a61af67d9d838a9497ca5b188dabc1aa0}{void}} cds\+::gc\+::\+DHP\+::retire (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{_tutorial__sparse__example_8cpp_af639fb96631ba0018f0b2259fc95edfb}{T}} \texorpdfstring{$\ast$}{*}}]{p}{, }\item[{\mbox{\hyperlink{ittnotify__static_8h_a61af67d9d838a9497ca5b188dabc1aa0}{void}}(\texorpdfstring{$\ast$}{*}}]{func~}{)(\mbox{\hyperlink{ittnotify__static_8h_a61af67d9d838a9497ca5b188dabc1aa0}{void}} \texorpdfstring{$\ast$}{*})}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}



Retire pointer {\ttfamily p} with function {\ttfamily p\+Func} 

The function places pointer {\ttfamily p} to array of pointers ready for removing. (so called retired pointer array). The pointer can be safely removed when no hazard pointer points to it. {\ttfamily func} is a disposer\+: when {\ttfamily p} can be safely removed, {\ttfamily func} is called. \Hypertarget{classcds_1_1gc_1_1_d_h_p_a0d5865baa42a93fc72a7878723408ce2}\index{cds::gc::DHP@{cds::gc::DHP}!scan@{scan}}
\index{scan@{scan}!cds::gc::DHP@{cds::gc::DHP}}
\doxysubsubsection{\texorpdfstring{scan()}{scan()}}
{\footnotesize\ttfamily \label{classcds_1_1gc_1_1_d_h_p_a0d5865baa42a93fc72a7878723408ce2} 
static \mbox{\hyperlink{ittnotify__static_8h_a61af67d9d838a9497ca5b188dabc1aa0}{void}} cds\+::gc\+::\+DHP\+::scan (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}



Forced GC cycle call for current thread 

Usually, this function should not be called directly. \Hypertarget{classcds_1_1gc_1_1_d_h_p_addaff9c937beaa650a3134505736a145}\index{cds::gc::DHP@{cds::gc::DHP}!set\_memory\_allocator@{set\_memory\_allocator}}
\index{set\_memory\_allocator@{set\_memory\_allocator}!cds::gc::DHP@{cds::gc::DHP}}
\doxysubsubsection{\texorpdfstring{set\_memory\_allocator()}{set\_memory\_allocator()}}
{\footnotesize\ttfamily \label{classcds_1_1gc_1_1_d_h_p_addaff9c937beaa650a3134505736a145} 
static \mbox{\hyperlink{ittnotify__static_8h_a61af67d9d838a9497ca5b188dabc1aa0}{void}} cds\+::gc\+::\+DHP\+::set\+\_\+memory\+\_\+allocator (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{ittnotify__static_8h_a61af67d9d838a9497ca5b188dabc1aa0}{void}} \texorpdfstring{$\ast$}{*}(\texorpdfstring{$\ast$}{*}}]{alloc\+\_\+func~}{)(size\+\_\+t \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}}), }\item[{\mbox{\hyperlink{ittnotify__static_8h_a61af67d9d838a9497ca5b188dabc1aa0}{void}}(\texorpdfstring{$\ast$}{*}}]{free\+\_\+func~}{)(\mbox{\hyperlink{ittnotify__static_8h_a61af67d9d838a9497ca5b188dabc1aa0}{void}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}})}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}



Set memory management functions 

\begin{DoxyNote}{注解}
This function may be called {\bfseries{BEFORE}} creating an instance of Dynamic Hazard Pointer SMR
\end{DoxyNote}
SMR object allocates some memory for thread-\/specific data and for creating SMR object. By default, a standard {\ttfamily new} and {\ttfamily delete} operators are used for this. 
\begin{DoxyParams}{参数}
{\em alloc\+\_\+func} & {\ttfamily \doxylink{mimalloc-override_8h_a99aa8fd9f4831e1b0fa9e1cdcde3e249}{malloc()}} function  \\
\hline
{\em free\+\_\+func} & {\ttfamily \doxylink{mimalloc-override_8h_a9d4b5df3530d1bc733070a4669ba6ebc}{free()}} function \\
\hline
\end{DoxyParams}
\Hypertarget{classcds_1_1gc_1_1_d_h_p_abaf4f1c5e616c98fa64a35df04c1dd85}\index{cds::gc::DHP@{cds::gc::DHP}!statistics@{statistics}}
\index{statistics@{statistics}!cds::gc::DHP@{cds::gc::DHP}}
\doxysubsubsection{\texorpdfstring{statistics()}{statistics()}}
{\footnotesize\ttfamily \label{classcds_1_1gc_1_1_d_h_p_abaf4f1c5e616c98fa64a35df04c1dd85} 
static \mbox{\hyperlink{ittnotify__static_8h_a61af67d9d838a9497ca5b188dabc1aa0}{void}} cds\+::gc\+::\+DHP\+::statistics (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classcds_1_1gc_1_1_d_h_p_a9c85a7e0369b9cb15cd2925b46acbe2c}{stat}} \&}]{st}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}



Returns internal statistics 

The function clears {\ttfamily st} before gathering statistics.

\begin{DoxyNote}{注解}
Internal statistics is available only if you compile {\ttfamily libcds} and your program with {\ttfamily -\/DCDS\+\_\+\+ENABLE\+\_\+\+HPSTAT}. 
\end{DoxyNote}


该类的文档由以下文件生成\+:\begin{DoxyCompactItemize}
\item 
external/libcds/cds/gc/\mbox{\hyperlink{dhp_8h}{dhp.\+h}}\item 
external/libcds/src/\mbox{\hyperlink{dhp_8cpp}{dhp.\+cpp}}\end{DoxyCompactItemize}
