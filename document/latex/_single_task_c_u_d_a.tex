\doxysection{Single Task}
\hypertarget{_single_task_c_u_d_a}{}\label{_single_task_c_u_d_a}\index{Single \%Task@{Single \%Task}}
\doxylink{classtf_1_1cuda_flow}{tf\+::cuda\+Flow} provides a template method, \doxylink{classtf_1_1cuda_flow_ac2906cb0002fc411a983d100a3d58d62}{tf\+::cuda\+Flow\+::single\+\_\+task}, for creating a task to run the given callable using a single kernel thread.\hypertarget{_single_task_c_u_d_a_CUDASingleTaskIncludeTheHeader}{}\doxysubsection{\texorpdfstring{Include the Header}{Include the Header}}\label{_single_task_c_u_d_a_CUDASingleTaskIncludeTheHeader}
You need to include the header file, {\ttfamily taskflow/cuda/algorithm/for\+\_\+each.hpp}, for creating a single-\/threaded task.


\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{taskflow_2cuda_2algorithm_2for__each_8hpp}{taskflow/cuda/algorithm/for\_each.hpp}}>}}

\end{DoxyCode}
\hypertarget{_single_task_c_u_d_a_SingleTaskCUDASingleTask}{}\doxysubsection{\texorpdfstring{Run a Task with a Single Thread}{Run a Task with a Single Thread}}\label{_single_task_c_u_d_a_SingleTaskCUDASingleTask}
You can create a task to run a kernel function just once, i.\+e., using one GPU thread. This is handy when you want to set up a single or a few global variables that do not need multiple threads and will be used by multiple kernels afterwards. The following example creates a single-\/task kernel that sets a device variable to {\ttfamily 1}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{keywordtype}{int}*\ gpu\_variable;}
\DoxyCodeLine{cudaMalloc(\&gpu\_variable,\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}));}
\DoxyCodeLine{}
\DoxyCodeLine{\mbox{\hyperlink{classtf_1_1cuda_flow}{tf::cudaFlow}}\ cf;}
\DoxyCodeLine{cf.\mbox{\hyperlink{classtf_1_1cuda_flow_ac2906cb0002fc411a983d100a3d58d62}{single\_task}}([gpu\_variable]\ \_\_device\_\_\ ()\ \{}
\DoxyCodeLine{\ \ *gpu\_Variable\ =\ 1;}
\DoxyCodeLine{\});}
\DoxyCodeLine{}
\DoxyCodeLine{\mbox{\hyperlink{namespacetf_af19c9b301dc0b0fe2a51a960fa427e83}{tf::cudaStream}}\ stream;}
\DoxyCodeLine{cf.run(stream);}
\DoxyCodeLine{stream.\mbox{\hyperlink{classtf_1_1cuda_stream_base_a08857ff2874cd5378e578822e2e96dd0}{synchronize}}();}

\end{DoxyCode}


Since the callable runs on GPU, it must be declared with a {\ttfamily \+\_\+\+\_\+device\+\_\+\+\_\+} specifier.\hypertarget{_single_task_c_u_d_a_SingleTaskCUDAMiscellaneousItems}{}\doxysubsection{\texorpdfstring{Miscellaneous Items}{Miscellaneous Items}}\label{_single_task_c_u_d_a_SingleTaskCUDAMiscellaneousItems}
The single-\/task algorithm is also available in \doxylink{classtf_1_1cuda_flow_capturer_ac944c7d20056e0633ef84f1a25b52296}{tf\+::cuda\+Flow\+Capturer\+::single\+\_\+task}. 