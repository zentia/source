\doxysection{Tensor\+Cost\+Model.\+h}
\hypertarget{_tensor_cost_model_8h_source}{}\label{_tensor_cost_model_8h_source}\index{external/taskflow/3rd-\/party/eigen-\/3.3.7/unsupported/Eigen/CXX11/src/Tensor/TensorCostModel.h@{external/taskflow/3rd-\/party/eigen-\/3.3.7/unsupported/Eigen/CXX11/src/Tensor/TensorCostModel.h}}
\mbox{\hyperlink{_tensor_cost_model_8h}{浏览该文件的文档.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ This\ file\ is\ part\ of\ Eigen,\ a\ lightweight\ C++\ template\ library}}
\DoxyCodeLine{00002\ \textcolor{comment}{//\ for\ linear\ algebra.}}
\DoxyCodeLine{00003\ \textcolor{comment}{//}}
\DoxyCodeLine{00004\ \textcolor{comment}{//\ Copyright\ (C)\ 2016\ Rasmus\ Munk\ Larsen\ <rmlarsen@google.com>}}
\DoxyCodeLine{00005\ \textcolor{comment}{//}}
\DoxyCodeLine{00006\ \textcolor{comment}{//\ This\ Source\ Code\ Form\ is\ subject\ to\ the\ terms\ of\ the\ Mozilla}}
\DoxyCodeLine{00007\ \textcolor{comment}{//\ Public\ License\ v.\ 2.0.\ If\ a\ copy\ of\ the\ MPL\ was\ not\ distributed}}
\DoxyCodeLine{00008\ \textcolor{comment}{//\ with\ this\ file,\ You\ can\ obtain\ one\ at\ http://mozilla.org/MPL/2.0/.}}
\DoxyCodeLine{00009\ }
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#ifndef\ EIGEN\_CXX11\_TENSOR\_TENSOR\_COST\_MODEL\_H}}
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#define\ EIGEN\_CXX11\_TENSOR\_TENSOR\_COST\_MODEL\_H}}
\DoxyCodeLine{00012\ }
\DoxyCodeLine{00013\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespace_eigen}{Eigen}}\ \{}
\DoxyCodeLine{00014\ }
\DoxyCodeLine{00022\ }
\DoxyCodeLine{00023\ \textcolor{comment}{//\ Class\ storing\ the\ cost\ of\ evaluating\ a\ tensor\ expression\ in\ terms\ of\ the}}
\DoxyCodeLine{00024\ \textcolor{comment}{//\ estimated\ number\ of\ operand\ bytes\ loads,\ bytes\ stored,\ and\ compute\ cycles.}}
\DoxyCodeLine{00025\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_a918b5fe64078a5ca8877387409ce4055}{TensorOpCost}}\ \{}
\DoxyCodeLine{00026\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00027\ \ \ \textcolor{comment}{//\ TODO(rmlarsen):\ Fix\ the\ scalar\ op\ costs\ in\ Eigen\ proper.\ Even\ a\ simple}}
\DoxyCodeLine{00028\ \ \ \textcolor{comment}{//\ model\ based\ on\ minimal\ reciprocal\ throughput\ numbers\ from\ Intel\ or}}
\DoxyCodeLine{00029\ \ \ \textcolor{comment}{//\ Agner\ Fog's\ tables\ would\ be\ better\ than\ what\ is\ there\ now.}}
\DoxyCodeLine{00030\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ ArgType>}
\DoxyCodeLine{00031\ \ \ \textcolor{keyword}{static}\ EIGEN\_DEVICE\_FUNC\ \mbox{\hyperlink{eigen-3_83_87_2_eigen_2src_2_core_2util_2_macros_8h_af2b60117c00a6e75812de43bfe7db3b1}{EIGEN\_STRONG\_INLINE}}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_a6beccb61485f429ac575d0a22abf9014}{MulCost}}()\ \{}
\DoxyCodeLine{00032\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1functor__traits}{internal::functor\_traits}}<}
\DoxyCodeLine{00033\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_eigen_1_1internal_1_1scalar__product__op}{internal::scalar\_product\_op<ArgType,\ ArgType>}}\ >::Cost;}
\DoxyCodeLine{00034\ \ \ \}}
\DoxyCodeLine{00035\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ ArgType>}
\DoxyCodeLine{00036\ \ \ \textcolor{keyword}{static}\ EIGEN\_DEVICE\_FUNC\ \mbox{\hyperlink{eigen-3_83_87_2_eigen_2src_2_core_2util_2_macros_8h_af2b60117c00a6e75812de43bfe7db3b1}{EIGEN\_STRONG\_INLINE}}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_a7c74e94f5c5992ddd756ba868df98441}{AddCost}}()\ \{}
\DoxyCodeLine{00037\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1functor__traits}{internal::functor\_traits<internal::scalar\_sum\_op<ArgType>}}\ >::Cost;}
\DoxyCodeLine{00038\ \ \ \}}
\DoxyCodeLine{00039\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ ArgType>}
\DoxyCodeLine{00040\ \ \ \textcolor{keyword}{static}\ EIGEN\_DEVICE\_FUNC\ \mbox{\hyperlink{eigen-3_83_87_2_eigen_2src_2_core_2util_2_macros_8h_af2b60117c00a6e75812de43bfe7db3b1}{EIGEN\_STRONG\_INLINE}}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_ab5da69fab8e443d48fafa9880aa8691c}{DivCost}}()\ \{}
\DoxyCodeLine{00041\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1functor__traits}{internal::functor\_traits}}<}
\DoxyCodeLine{00042\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_eigen_1_1internal_1_1scalar__quotient__op}{internal::scalar\_quotient\_op<ArgType,\ ArgType>}}\ >::Cost;}
\DoxyCodeLine{00043\ \ \ \}}
\DoxyCodeLine{00044\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ ArgType>}
\DoxyCodeLine{00045\ \ \ \textcolor{keyword}{static}\ EIGEN\_DEVICE\_FUNC\ \mbox{\hyperlink{eigen-3_83_87_2_eigen_2src_2_core_2util_2_macros_8h_af2b60117c00a6e75812de43bfe7db3b1}{EIGEN\_STRONG\_INLINE}}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_a7041e9d0ec3d9b67f951a6bfb68c3cc0}{ModCost}}()\ \{}
\DoxyCodeLine{00046\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1functor__traits}{internal::functor\_traits<internal::scalar\_mod\_op<ArgType>}}\ >::Cost;}
\DoxyCodeLine{00047\ \ \ \}}
\DoxyCodeLine{00048\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ SrcType,\ \textcolor{keyword}{typename}\ TargetType>}
\DoxyCodeLine{00049\ \ \ \textcolor{keyword}{static}\ EIGEN\_DEVICE\_FUNC\ \mbox{\hyperlink{eigen-3_83_87_2_eigen_2src_2_core_2util_2_macros_8h_af2b60117c00a6e75812de43bfe7db3b1}{EIGEN\_STRONG\_INLINE}}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_a8087678093f5133cd7d001e8e4ae5899}{CastCost}}()\ \{}
\DoxyCodeLine{00050\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1functor__traits}{internal::functor\_traits}}<}
\DoxyCodeLine{00051\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_eigen_1_1internal_1_1scalar__cast__op}{internal::scalar\_cast\_op<SrcType,\ TargetType>}}\ >::Cost;}
\DoxyCodeLine{00052\ \ \ \}}
\DoxyCodeLine{00053\ }
\DoxyCodeLine{00054\ \ \ EIGEN\_DEVICE\_FUNC}
\DoxyCodeLine{00055\ \ \ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_a918b5fe64078a5ca8877387409ce4055}{TensorOpCost}}()\ :\ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_a386c707658272c2a97e3a7c554efa783}{bytes\_loaded\_}}(0),\ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_a62e48a4428e3a1603aea4a9f3051f752}{bytes\_stored\_}}(0),\ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_ab83e0cb244466a8d0283d733a32e1e36}{compute\_cycles\_}}(0)\ \{\}}
\DoxyCodeLine{00056\ \ \ EIGEN\_DEVICE\_FUNC}
\DoxyCodeLine{00057\ \ \ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_a28957e6eb06dc8d5b36aa54d6b5d908f}{TensorOpCost}}(\textcolor{keywordtype}{double}\ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_ab219b63415092d08e09310471cf6fc23}{bytes\_loaded}},\ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_a5d813f65797b15c9da19d23ae7ceb5eb}{bytes\_stored}},\ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_ac24758ad7deef1e3968f66eb33eaf139}{compute\_cycles}})}
\DoxyCodeLine{00058\ \ \ \ \ \ \ :\ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_a386c707658272c2a97e3a7c554efa783}{bytes\_loaded\_}}(\mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_ab219b63415092d08e09310471cf6fc23}{bytes\_loaded}}),}
\DoxyCodeLine{00059\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_a62e48a4428e3a1603aea4a9f3051f752}{bytes\_stored\_}}(\mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_a5d813f65797b15c9da19d23ae7ceb5eb}{bytes\_stored}}),}
\DoxyCodeLine{00060\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_ab83e0cb244466a8d0283d733a32e1e36}{compute\_cycles\_}}(\mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_ac24758ad7deef1e3968f66eb33eaf139}{compute\_cycles}})\ \{\}}
\DoxyCodeLine{00061\ }
\DoxyCodeLine{00062\ \ \ EIGEN\_DEVICE\_FUNC}
\DoxyCodeLine{00063\ \ \ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_acb9efb295137bd79a37936952247e5c3}{TensorOpCost}}(\textcolor{keywordtype}{double}\ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_ab219b63415092d08e09310471cf6fc23}{bytes\_loaded}},\ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_a5d813f65797b15c9da19d23ae7ceb5eb}{bytes\_stored}},\ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_ac24758ad7deef1e3968f66eb33eaf139}{compute\_cycles}},}
\DoxyCodeLine{00064\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ vectorized,\ \textcolor{keywordtype}{double}\ packet\_size)}
\DoxyCodeLine{00065\ \ \ \ \ \ \ :\ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_a386c707658272c2a97e3a7c554efa783}{bytes\_loaded\_}}(\mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_ab219b63415092d08e09310471cf6fc23}{bytes\_loaded}}),}
\DoxyCodeLine{00066\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_a62e48a4428e3a1603aea4a9f3051f752}{bytes\_stored\_}}(\mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_a5d813f65797b15c9da19d23ae7ceb5eb}{bytes\_stored}}),}
\DoxyCodeLine{00067\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_ab83e0cb244466a8d0283d733a32e1e36}{compute\_cycles\_}}(vectorized\ ?\ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_ac24758ad7deef1e3968f66eb33eaf139}{compute\_cycles}}\ /\ packet\_size}
\DoxyCodeLine{00068\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_ac24758ad7deef1e3968f66eb33eaf139}{compute\_cycles}})\ \{}
\DoxyCodeLine{00069\ \ \ \ \ \mbox{\hyperlink{eigen-3_83_87_2_eigen_2src_2_core_2util_2_macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(\mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_ab219b63415092d08e09310471cf6fc23}{bytes\_loaded}}\ >=\ 0\ \&\&\ (\mbox{\hyperlink{namespace_eigen_1_1numext_a7e14263bc3784b17cbd6f13c69c97003}{numext::isfinite}})(\mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_ab219b63415092d08e09310471cf6fc23}{bytes\_loaded}}));}
\DoxyCodeLine{00070\ \ \ \ \ \mbox{\hyperlink{eigen-3_83_87_2_eigen_2src_2_core_2util_2_macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(\mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_a5d813f65797b15c9da19d23ae7ceb5eb}{bytes\_stored}}\ >=\ 0\ \&\&\ (\mbox{\hyperlink{namespace_eigen_1_1numext_a7e14263bc3784b17cbd6f13c69c97003}{numext::isfinite}})(\mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_a5d813f65797b15c9da19d23ae7ceb5eb}{bytes\_stored}}));}
\DoxyCodeLine{00071\ \ \ \ \ \mbox{\hyperlink{eigen-3_83_87_2_eigen_2src_2_core_2util_2_macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(\mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_ac24758ad7deef1e3968f66eb33eaf139}{compute\_cycles}}\ >=\ 0\ \&\&\ (\mbox{\hyperlink{namespace_eigen_1_1numext_a7e14263bc3784b17cbd6f13c69c97003}{numext::isfinite}})(\mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_ac24758ad7deef1e3968f66eb33eaf139}{compute\_cycles}}));}
\DoxyCodeLine{00072\ \ \ \}}
\DoxyCodeLine{00073\ }
\DoxyCodeLine{00074\ \ \ EIGEN\_DEVICE\_FUNC\ \mbox{\hyperlink{eigen-3_83_87_2_eigen_2src_2_core_2util_2_macros_8h_af2b60117c00a6e75812de43bfe7db3b1}{EIGEN\_STRONG\_INLINE}}\ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_ab219b63415092d08e09310471cf6fc23}{bytes\_loaded}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00075\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_a386c707658272c2a97e3a7c554efa783}{bytes\_loaded\_}};}
\DoxyCodeLine{00076\ \ \ \}}
\DoxyCodeLine{00077\ \ \ EIGEN\_DEVICE\_FUNC\ \mbox{\hyperlink{eigen-3_83_87_2_eigen_2src_2_core_2util_2_macros_8h_af2b60117c00a6e75812de43bfe7db3b1}{EIGEN\_STRONG\_INLINE}}\ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_a5d813f65797b15c9da19d23ae7ceb5eb}{bytes\_stored}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00078\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_a62e48a4428e3a1603aea4a9f3051f752}{bytes\_stored\_}};}
\DoxyCodeLine{00079\ \ \ \}}
\DoxyCodeLine{00080\ \ \ EIGEN\_DEVICE\_FUNC\ \mbox{\hyperlink{eigen-3_83_87_2_eigen_2src_2_core_2util_2_macros_8h_af2b60117c00a6e75812de43bfe7db3b1}{EIGEN\_STRONG\_INLINE}}\ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_ac24758ad7deef1e3968f66eb33eaf139}{compute\_cycles}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00081\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_ab83e0cb244466a8d0283d733a32e1e36}{compute\_cycles\_}};}
\DoxyCodeLine{00082\ \ \ \}}
\DoxyCodeLine{00083\ \ \ EIGEN\_DEVICE\_FUNC\ \mbox{\hyperlink{eigen-3_83_87_2_eigen_2src_2_core_2util_2_macros_8h_af2b60117c00a6e75812de43bfe7db3b1}{EIGEN\_STRONG\_INLINE}}\ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_ae7caee524a30c15d68c781ea5f063ead}{total\_cost}}(}
\DoxyCodeLine{00084\ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ load\_cost,\ \textcolor{keywordtype}{double}\ store\_cost,\ \textcolor{keywordtype}{double}\ compute\_cost)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00085\ \ \ \ \ \textcolor{keywordflow}{return}\ load\_cost\ *\ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_a386c707658272c2a97e3a7c554efa783}{bytes\_loaded\_}}\ +\ store\_cost\ *\ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_a62e48a4428e3a1603aea4a9f3051f752}{bytes\_stored\_}}\ +}
\DoxyCodeLine{00086\ \ \ \ \ \ \ \ \ \ \ \ compute\_cost\ *\ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_ab83e0cb244466a8d0283d733a32e1e36}{compute\_cycles\_}};}
\DoxyCodeLine{00087\ \ \ \}}
\DoxyCodeLine{00088\ }
\DoxyCodeLine{00089\ \ \ \textcolor{comment}{//\ Drop\ memory\ access\ component.\ Intended\ for\ cases\ when\ memory\ accesses\ are}}
\DoxyCodeLine{00090\ \ \ \textcolor{comment}{//\ sequential\ or\ are\ completely\ masked\ by\ computations.}}
\DoxyCodeLine{00091\ \ \ EIGEN\_DEVICE\_FUNC\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_ae309b668454a04ebbaaaf2dbcc623e08}{dropMemoryCost}}()\ \{}
\DoxyCodeLine{00092\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_a386c707658272c2a97e3a7c554efa783}{bytes\_loaded\_}}\ =\ 0;}
\DoxyCodeLine{00093\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_a62e48a4428e3a1603aea4a9f3051f752}{bytes\_stored\_}}\ =\ 0;}
\DoxyCodeLine{00094\ \ \ \}}
\DoxyCodeLine{00095\ }
\DoxyCodeLine{00096\ \ \ \textcolor{comment}{//\ TODO(rmlarsen):\ Define\ min\ in\ terms\ of\ total\ cost,\ not\ elementwise.}}
\DoxyCodeLine{00097\ \ \ EIGEN\_DEVICE\_FUNC\ \mbox{\hyperlink{eigen-3_83_87_2_eigen_2src_2_core_2util_2_macros_8h_af2b60117c00a6e75812de43bfe7db3b1}{EIGEN\_STRONG\_INLINE}}\ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_a918b5fe64078a5ca8877387409ce4055}{TensorOpCost}}\ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_a1ab887f487b37baa8808be9973f91297}{cwiseMin}}(}
\DoxyCodeLine{00098\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_a918b5fe64078a5ca8877387409ce4055}{TensorOpCost}}\&\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}})\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00099\ \ \ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_ab219b63415092d08e09310471cf6fc23}{bytes\_loaded}}\ =\ \mbox{\hyperlink{namespace_eigen_1_1numext_ab3b30bf0bcfa1ad91dbec75fabb3bea0}{numext::mini}}(\mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_a386c707658272c2a97e3a7c554efa783}{bytes\_loaded\_}},\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}.bytes\_loaded());}
\DoxyCodeLine{00100\ \ \ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_a5d813f65797b15c9da19d23ae7ceb5eb}{bytes\_stored}}\ =\ \mbox{\hyperlink{namespace_eigen_1_1numext_ab3b30bf0bcfa1ad91dbec75fabb3bea0}{numext::mini}}(\mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_a62e48a4428e3a1603aea4a9f3051f752}{bytes\_stored\_}},\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}.bytes\_stored());}
\DoxyCodeLine{00101\ \ \ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_ac24758ad7deef1e3968f66eb33eaf139}{compute\_cycles}}\ =\ \mbox{\hyperlink{namespace_eigen_1_1numext_ab3b30bf0bcfa1ad91dbec75fabb3bea0}{numext::mini}}(\mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_ab83e0cb244466a8d0283d733a32e1e36}{compute\_cycles\_}},\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}.compute\_cycles());}
\DoxyCodeLine{00102\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_a918b5fe64078a5ca8877387409ce4055}{TensorOpCost}}(\mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_ab219b63415092d08e09310471cf6fc23}{bytes\_loaded}},\ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_a5d813f65797b15c9da19d23ae7ceb5eb}{bytes\_stored}},\ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_ac24758ad7deef1e3968f66eb33eaf139}{compute\_cycles}});}
\DoxyCodeLine{00103\ \ \ \}}
\DoxyCodeLine{00104\ }
\DoxyCodeLine{00105\ \ \ \textcolor{comment}{//\ TODO(rmlarsen):\ Define\ max\ in\ terms\ of\ total\ cost,\ not\ elementwise.}}
\DoxyCodeLine{00106\ \ \ EIGEN\_DEVICE\_FUNC\ \mbox{\hyperlink{eigen-3_83_87_2_eigen_2src_2_core_2util_2_macros_8h_af2b60117c00a6e75812de43bfe7db3b1}{EIGEN\_STRONG\_INLINE}}\ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_a918b5fe64078a5ca8877387409ce4055}{TensorOpCost}}\ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_a41a42f41c2b31092bfaae8b34e8120c5}{cwiseMax}}(}
\DoxyCodeLine{00107\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_a918b5fe64078a5ca8877387409ce4055}{TensorOpCost}}\&\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}})\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00108\ \ \ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_ab219b63415092d08e09310471cf6fc23}{bytes\_loaded}}\ =\ \mbox{\hyperlink{namespace_eigen_1_1numext_a29d502349f2ec9897c808e65e0f96eb4}{numext::maxi}}(\mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_a386c707658272c2a97e3a7c554efa783}{bytes\_loaded\_}},\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}.bytes\_loaded());}
\DoxyCodeLine{00109\ \ \ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_a5d813f65797b15c9da19d23ae7ceb5eb}{bytes\_stored}}\ =\ \mbox{\hyperlink{namespace_eigen_1_1numext_a29d502349f2ec9897c808e65e0f96eb4}{numext::maxi}}(\mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_a62e48a4428e3a1603aea4a9f3051f752}{bytes\_stored\_}},\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}.bytes\_stored());}
\DoxyCodeLine{00110\ \ \ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_ac24758ad7deef1e3968f66eb33eaf139}{compute\_cycles}}\ =\ \mbox{\hyperlink{namespace_eigen_1_1numext_a29d502349f2ec9897c808e65e0f96eb4}{numext::maxi}}(\mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_ab83e0cb244466a8d0283d733a32e1e36}{compute\_cycles\_}},\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}.compute\_cycles());}
\DoxyCodeLine{00111\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_a918b5fe64078a5ca8877387409ce4055}{TensorOpCost}}(\mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_ab219b63415092d08e09310471cf6fc23}{bytes\_loaded}},\ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_a5d813f65797b15c9da19d23ae7ceb5eb}{bytes\_stored}},\ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_ac24758ad7deef1e3968f66eb33eaf139}{compute\_cycles}});}
\DoxyCodeLine{00112\ \ \ \}}
\DoxyCodeLine{00113\ }
\DoxyCodeLine{00114\ \ \ EIGEN\_DEVICE\_FUNC\ \mbox{\hyperlink{eigen-3_83_87_2_eigen_2src_2_core_2util_2_macros_8h_af2b60117c00a6e75812de43bfe7db3b1}{EIGEN\_STRONG\_INLINE}}\ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_a918b5fe64078a5ca8877387409ce4055}{TensorOpCost}}\&\ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_a755a23f3d9d94776a38cfd9862bc70f7}{operator+=}}(}
\DoxyCodeLine{00115\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_a918b5fe64078a5ca8877387409ce4055}{TensorOpCost}}\&\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}})\ \{}
\DoxyCodeLine{00116\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_a386c707658272c2a97e3a7c554efa783}{bytes\_loaded\_}}\ +=\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}.bytes\_loaded();}
\DoxyCodeLine{00117\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_a62e48a4428e3a1603aea4a9f3051f752}{bytes\_stored\_}}\ +=\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}.bytes\_stored();}
\DoxyCodeLine{00118\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_ab83e0cb244466a8d0283d733a32e1e36}{compute\_cycles\_}}\ +=\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}.compute\_cycles();}
\DoxyCodeLine{00119\ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{00120\ \ \ \}}
\DoxyCodeLine{00121\ }
\DoxyCodeLine{00122\ \ \ EIGEN\_DEVICE\_FUNC\ \mbox{\hyperlink{eigen-3_83_87_2_eigen_2src_2_core_2util_2_macros_8h_af2b60117c00a6e75812de43bfe7db3b1}{EIGEN\_STRONG\_INLINE}}\ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_a918b5fe64078a5ca8877387409ce4055}{TensorOpCost}}\&\ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_a7281989c5dc88697a0573abab011d366}{operator*=}}(\textcolor{keywordtype}{double}\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}})\ \{}
\DoxyCodeLine{00123\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_a386c707658272c2a97e3a7c554efa783}{bytes\_loaded\_}}\ *=\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}};}
\DoxyCodeLine{00124\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_a62e48a4428e3a1603aea4a9f3051f752}{bytes\_stored\_}}\ *=\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}};}
\DoxyCodeLine{00125\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_ab83e0cb244466a8d0283d733a32e1e36}{compute\_cycles\_}}\ *=\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}};}
\DoxyCodeLine{00126\ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{00127\ \ \ \}}
\DoxyCodeLine{00128\ }
\DoxyCodeLine{00129\ \ \ EIGEN\_DEVICE\_FUNC\ \mbox{\hyperlink{eigen-3_83_87_2_eigen_2src_2_core_2util_2_macros_8h_af2b60117c00a6e75812de43bfe7db3b1}{EIGEN\_STRONG\_INLINE}}\ \textcolor{keyword}{friend}\ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_a918b5fe64078a5ca8877387409ce4055}{TensorOpCost}}\ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_a4bf19abdd278dc789984826418d45b4f}{operator+}}(}
\DoxyCodeLine{00130\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_a918b5fe64078a5ca8877387409ce4055}{TensorOpCost}}\ lhs,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_a918b5fe64078a5ca8877387409ce4055}{TensorOpCost}}\&\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}})\ \{}
\DoxyCodeLine{00131\ \ \ \ \ lhs\ +=\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}};}
\DoxyCodeLine{00132\ \ \ \ \ \textcolor{keywordflow}{return}\ lhs;}
\DoxyCodeLine{00133\ \ \ \}}
\DoxyCodeLine{00134\ \ \ EIGEN\_DEVICE\_FUNC\ \mbox{\hyperlink{eigen-3_83_87_2_eigen_2src_2_core_2util_2_macros_8h_af2b60117c00a6e75812de43bfe7db3b1}{EIGEN\_STRONG\_INLINE}}\ \textcolor{keyword}{friend}\ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_a918b5fe64078a5ca8877387409ce4055}{TensorOpCost}}\ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_a7cf6f7f475447551927a5192c7d0e1d6}{operator*}}(}
\DoxyCodeLine{00135\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_a918b5fe64078a5ca8877387409ce4055}{TensorOpCost}}\ lhs,\ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}})\ \{}
\DoxyCodeLine{00136\ \ \ \ \ lhs\ *=\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}};}
\DoxyCodeLine{00137\ \ \ \ \ \textcolor{keywordflow}{return}\ lhs;}
\DoxyCodeLine{00138\ \ \ \}}
\DoxyCodeLine{00139\ \ \ EIGEN\_DEVICE\_FUNC\ \mbox{\hyperlink{eigen-3_83_87_2_eigen_2src_2_core_2util_2_macros_8h_af2b60117c00a6e75812de43bfe7db3b1}{EIGEN\_STRONG\_INLINE}}\ \textcolor{keyword}{friend}\ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_a918b5fe64078a5ca8877387409ce4055}{TensorOpCost}}\ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_a6557ef3f7399e2415a9602a088734438}{operator*}}(}
\DoxyCodeLine{00140\ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ lhs,\ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_a918b5fe64078a5ca8877387409ce4055}{TensorOpCost}}\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}})\ \{}
\DoxyCodeLine{00141\ \ \ \ \ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}\ *=\ lhs;}
\DoxyCodeLine{00142\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}};}
\DoxyCodeLine{00143\ \ \ \}}
\DoxyCodeLine{00144\ }
\DoxyCodeLine{00145\ \ \ \textcolor{keyword}{friend}\ std::ostream\&\ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_a9b3665c656ced4f18e7c841f6c393f2f}{operator<<}}(std::ostream\&\ os,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_a918b5fe64078a5ca8877387409ce4055}{TensorOpCost}}\&\ tc)\ \{}
\DoxyCodeLine{00146\ \ \ \ \ \textcolor{keywordflow}{return}\ os\ <<\ \textcolor{stringliteral}{"{}[bytes\_loaded\ =\ "{}}\ <<\ tc.\mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_ab219b63415092d08e09310471cf6fc23}{bytes\_loaded}}()}
\DoxyCodeLine{00147\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{},\ bytes\_stored\ =\ "{}}\ <<\ tc.\mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_a5d813f65797b15c9da19d23ae7ceb5eb}{bytes\_stored}}()}
\DoxyCodeLine{00148\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{},\ compute\_cycles\ =\ "{}}\ <<\ tc.\mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_ac24758ad7deef1e3968f66eb33eaf139}{compute\_cycles}}()\ <<\ \textcolor{stringliteral}{"{}]"{}};}
\DoxyCodeLine{00149\ \ \ \}}
\DoxyCodeLine{00150\ }
\DoxyCodeLine{00151\ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00152\ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_a386c707658272c2a97e3a7c554efa783}{bytes\_loaded\_}};}
\DoxyCodeLine{00153\ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_a62e48a4428e3a1603aea4a9f3051f752}{bytes\_stored\_}};}
\DoxyCodeLine{00154\ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_ab83e0cb244466a8d0283d733a32e1e36}{compute\_cycles\_}};}
\DoxyCodeLine{00155\ \};}
\DoxyCodeLine{00156\ }
\DoxyCodeLine{00157\ \textcolor{comment}{//\ TODO(rmlarsen):\ Implement\ a\ policy\ that\ chooses\ an\ "{}optimal"{}\ number\ of\ theads}}
\DoxyCodeLine{00158\ \textcolor{comment}{//\ in\ [1:max\_threads]\ instead\ of\ just\ switching\ multi-\/threading\ off\ for\ small}}
\DoxyCodeLine{00159\ \textcolor{comment}{//\ work\ units.}}
\DoxyCodeLine{00160\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Device>}
\DoxyCodeLine{00161\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_eigen_1_1_tensor_cost_model}{TensorCostModel}}\ \{}
\DoxyCodeLine{00162\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00163\ \ \ \textcolor{comment}{//\ Scaling\ from\ Eigen\ compute\ cost\ to\ device\ cycles.}}
\DoxyCodeLine{00164\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{class_eigen_1_1_tensor_cost_model_a72c9fb1313ef5bfbd248083ca7027230}{kDeviceCyclesPerComputeCycle}}\ =\ 1;}
\DoxyCodeLine{00165\ }
\DoxyCodeLine{00166\ \ \textcolor{comment}{//\ Costs\ in\ device\ cycles.}}
\DoxyCodeLine{00167\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{class_eigen_1_1_tensor_cost_model_aa0ee6d42a164ac5ad26d0a5a3bb79400}{kStartupCycles}}\ =\ 100000;}
\DoxyCodeLine{00168\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{class_eigen_1_1_tensor_cost_model_a9a8d747099b9f03478ceef1bce63563e}{kPerThreadCycles}}\ =\ 100000;}
\DoxyCodeLine{00169\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{class_eigen_1_1_tensor_cost_model_af33afbe1c48dd9cccd3b01cfc3b73d5c}{kTaskSize}}\ =\ 40000;}
\DoxyCodeLine{00170\ }
\DoxyCodeLine{00171\ \ \ \textcolor{comment}{//\ Returns\ the\ number\ of\ threads\ in\ [1:max\_threads]\ to\ use\ for}}
\DoxyCodeLine{00172\ \ \ \textcolor{comment}{//\ evaluating\ an\ expression\ with\ the\ given\ output\ size\ and\ cost\ per}}
\DoxyCodeLine{00173\ \ \ \textcolor{comment}{//\ coefficient.}}
\DoxyCodeLine{00174\ \ \ \textcolor{keyword}{static}\ EIGEN\_DEVICE\_FUNC\ \mbox{\hyperlink{eigen-3_83_87_2_eigen_2src_2_core_2util_2_macros_8h_af2b60117c00a6e75812de43bfe7db3b1}{EIGEN\_STRONG\_INLINE}}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{class_eigen_1_1_tensor_cost_model_a718b68d6a884d2c862b5dc3c4c3f5ab4}{numThreads}}(}
\DoxyCodeLine{00175\ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ output\_size,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost}{TensorOpCost}}\&\ cost\_per\_coeff,\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{bench_8cpp_a90e9a7f7d8b7e956103b27fdad266932}{max\_threads}})\ \{}
\DoxyCodeLine{00176\ \ \ \ \ \textcolor{keywordtype}{double}\ cost\ =\ \mbox{\hyperlink{class_eigen_1_1_tensor_cost_model_ac277d7bf1fa2ba3b54c8dd3edeff0064}{totalCost}}(output\_size,\ cost\_per\_coeff);}
\DoxyCodeLine{00177\ \ \ \ \ \textcolor{keywordtype}{int}\ threads\ =\ (cost\ -\/\ \mbox{\hyperlink{class_eigen_1_1_tensor_cost_model_aa0ee6d42a164ac5ad26d0a5a3bb79400}{kStartupCycles}})\ /\ \mbox{\hyperlink{class_eigen_1_1_tensor_cost_model_a9a8d747099b9f03478ceef1bce63563e}{kPerThreadCycles}}\ +\ 0.9;}
\DoxyCodeLine{00178\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespace_eigen_1_1numext_ab3b30bf0bcfa1ad91dbec75fabb3bea0}{numext::mini}}(\mbox{\hyperlink{bench_8cpp_a90e9a7f7d8b7e956103b27fdad266932}{max\_threads}},\ \mbox{\hyperlink{namespace_eigen_1_1numext_a29d502349f2ec9897c808e65e0f96eb4}{numext::maxi}}(1,\ threads));}
\DoxyCodeLine{00179\ \ \ \}}
\DoxyCodeLine{00180\ }
\DoxyCodeLine{00181\ \ \ \textcolor{comment}{//\ taskSize\ assesses\ parallel\ task\ size.}}
\DoxyCodeLine{00182\ \ \ \textcolor{comment}{//\ Value\ of\ 1.0\ means\ ideal\ parallel\ task\ size.\ Values\ <\ 1.0\ mean\ that\ task}}
\DoxyCodeLine{00183\ \ \ \textcolor{comment}{//\ granularity\ needs\ to\ be\ increased\ to\ mitigate\ parallelization\ overheads.}}
\DoxyCodeLine{00184\ \ \ \textcolor{keyword}{static}\ EIGEN\_DEVICE\_FUNC\ \mbox{\hyperlink{eigen-3_83_87_2_eigen_2src_2_core_2util_2_macros_8h_af2b60117c00a6e75812de43bfe7db3b1}{EIGEN\_STRONG\_INLINE}}\ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{class_eigen_1_1_tensor_cost_model_aaae32b6af60750622e87ac1f34766c1b}{taskSize}}(}
\DoxyCodeLine{00185\ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ output\_size,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost}{TensorOpCost}}\&\ cost\_per\_coeff)\ \{}
\DoxyCodeLine{00186\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{class_eigen_1_1_tensor_cost_model_ac277d7bf1fa2ba3b54c8dd3edeff0064}{totalCost}}(output\_size,\ cost\_per\_coeff)\ /\ \mbox{\hyperlink{class_eigen_1_1_tensor_cost_model_af33afbe1c48dd9cccd3b01cfc3b73d5c}{kTaskSize}};}
\DoxyCodeLine{00187\ \ \ \}}
\DoxyCodeLine{00188\ }
\DoxyCodeLine{00189\ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00190\ \ \ \textcolor{keyword}{static}\ EIGEN\_DEVICE\_FUNC\ \mbox{\hyperlink{eigen-3_83_87_2_eigen_2src_2_core_2util_2_macros_8h_af2b60117c00a6e75812de43bfe7db3b1}{EIGEN\_STRONG\_INLINE}}\ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{class_eigen_1_1_tensor_cost_model_ac277d7bf1fa2ba3b54c8dd3edeff0064}{totalCost}}(}
\DoxyCodeLine{00191\ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ output\_size,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_tensor_op_cost}{TensorOpCost}}\&\ cost\_per\_coeff)\ \{}
\DoxyCodeLine{00192\ \ \ \ \ \textcolor{comment}{//\ Cost\ of\ memory\ fetches\ from\ L2\ cache.\ 64\ is\ typical\ cache\ line\ size.}}
\DoxyCodeLine{00193\ \ \ \ \ \textcolor{comment}{//\ 11\ is\ L2\ cache\ latency\ on\ Haswell.}}
\DoxyCodeLine{00194\ \ \ \ \ \textcolor{comment}{//\ We\ don't\ know\ whether\ data\ is\ in\ L1,\ L2\ or\ L3.\ But\ we\ are\ most\ interested}}
\DoxyCodeLine{00195\ \ \ \ \ \textcolor{comment}{//\ in\ single-\/threaded\ computational\ time\ around\ 100us-\/10ms\ (smaller\ time}}
\DoxyCodeLine{00196\ \ \ \ \ \textcolor{comment}{//\ is\ too\ small\ for\ parallelization,\ larger\ time\ is\ not\ intersting}}
\DoxyCodeLine{00197\ \ \ \ \ \textcolor{comment}{//\ either\ because\ we\ are\ probably\ using\ all\ available\ threads\ already).}}
\DoxyCodeLine{00198\ \ \ \ \ \textcolor{comment}{//\ And\ for\ the\ target\ time\ range,\ L2\ seems\ to\ be\ what\ matters.\ Data\ set}}
\DoxyCodeLine{00199\ \ \ \ \ \textcolor{comment}{//\ fitting\ into\ L1\ is\ too\ small\ to\ take\ noticeable\ time.\ Data\ set\ fitting}}
\DoxyCodeLine{00200\ \ \ \ \ \textcolor{comment}{//\ only\ into\ L3\ presumably\ will\ take\ more\ than\ 10ms\ to\ load\ and\ process.}}
\DoxyCodeLine{00201\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ kLoadCycles\ =\ 1.0\ /\ 64\ *\ 11;}
\DoxyCodeLine{00202\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ kStoreCycles\ =\ 1.0\ /\ 64\ *\ 11;}
\DoxyCodeLine{00203\ \ \ \ \ \textcolor{comment}{//\ Scaling\ from\ Eigen\ compute\ cost\ to\ device\ cycles.}}
\DoxyCodeLine{00204\ \ \ \ \ \textcolor{keywordflow}{return}\ output\_size\ *}
\DoxyCodeLine{00205\ \ \ \ \ \ \ \ \ cost\_per\_coeff.\mbox{\hyperlink{class_eigen_1_1_tensor_op_cost_ae7caee524a30c15d68c781ea5f063ead}{total\_cost}}(kLoadCycles,\ kStoreCycles,}
\DoxyCodeLine{00206\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_tensor_cost_model_a72c9fb1313ef5bfbd248083ca7027230}{kDeviceCyclesPerComputeCycle}});}
\DoxyCodeLine{00207\ \ \ \}}
\DoxyCodeLine{00208\ \};}
\DoxyCodeLine{00209\ }
\DoxyCodeLine{00210\ \}\ \ \textcolor{comment}{//\ namespace\ Eigen}}
\DoxyCodeLine{00211\ }
\DoxyCodeLine{00212\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ EIGEN\_CXX11\_TENSOR\_TENSOR\_COST\_MODEL\_H}}

\end{DoxyCode}
