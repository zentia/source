\chapter{Optional fields}
\hypertarget{md_external_2reflect-cpp_2docs_2optional__fields}{}\label{md_external_2reflect-cpp_2docs_2optional__fields}\index{Optional fields@{Optional fields}}
\label{md_external_2reflect-cpp_2docs_2optional__fields_autotoc_md616}%
\Hypertarget{md_external_2reflect-cpp_2docs_2optional__fields_autotoc_md616}%


Usually, when you set up a struct, all of the fields are required. For instance, in the previous example, we generated a JSON string like this\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{\{"{}firstName"{}:"{}Bart"{},"{}lastName"{}:"{}Simpson"{},"{}children"{}:[]\}}

\end{DoxyCode}


Likewise, if we read the JSON string and the field "{}children"{} is missing, that will result in a runtime error.

But Bart doesn\textquotesingle{}t have any children. After all, he\textquotesingle{}s only 10 years old. To indicate to the library that the field "{}children"{} is optional, we can use either {\ttfamily std\+::optional}, {\ttfamily std\+::shared\+\_\+ptr} or {\ttfamily std\+::unique\+\_\+ptr}.

If {\ttfamily std\+::optional} is {\ttfamily std\+::nullopt} or any of the smart pointers is a {\ttfamily nullptr}, then the field will not be written to the JSON string. Likewise, when you read the JSON string, the fields will not be required. If you want the fields to be required, you can use the {\ttfamily \doxylink{structrfl_1_1_no_optionals}{rfl\+::\+No\+Optionals}} processor, please refer to the section on processors.

So this is how we could rewrite the previous example\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{keyword}{struct\ }Person\ \{}
\DoxyCodeLine{\ \ \ \ rfl::Rename<\textcolor{stringliteral}{"{}firstName"{}},\ std::string>\ first\_name;}
\DoxyCodeLine{\ \ \ \ rfl::Rename<\textcolor{stringliteral}{"{}lastName"{}},\ std::string>\ last\_name\ =\ \textcolor{stringliteral}{"{}Simpson"{}};}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ Indicates\ to\ the\ library\ that\ the\ field\ is\ optional.}}
\DoxyCodeLine{\ \ \ \ std::optional<std::vector<Person>>\ children;}
\DoxyCodeLine{\};}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ bart\ =\ Person\{.first\_name\ =\ \textcolor{stringliteral}{"{}Bart"{}}\};}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ lisa\ =\ Person\{.first\_name\ =\ \textcolor{stringliteral}{"{}Lisa"{}}\};}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ maggie\ =\ Person\{.first\_name\ =\ \textcolor{stringliteral}{"{}Maggie"{}}\};}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ homer\ =\ Person\{.first\_name\ =\ \textcolor{stringliteral}{"{}Homer"{}},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ .children\ =\ std::vector<Person>(\{bart,\ lisa,\ maggie\})\};}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ json\_string\ =\ \mbox{\hyperlink{namespacerfl_1_1json_af39a23539424555b8c970d12a58e547f}{rfl::json::write}}(homer);}

\end{DoxyCode}


Now, the field "{}children"{} is missing for Bart, Lisa and Maggie\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{\{"{}firstName"{}:"{}Homer"{},"{}lastName"{}:"{}Simpson"{},"{}children"{}:[\{"{}firstName"{}:"{}Bart"{},"{}lastName"{}:"{}Simpson"{}\},\{"{}firstName"{}:"{}Lisa"{},"{}lastName"{}:"{}Simpson"{}\},\{"{}firstName"{}:"{}Maggie"{},"{}lastName"{}:"{}Simpson"{}\}]\}}

\end{DoxyCode}


{\bfseries{NOTE}}\+: If you want to explicitly set default values for your fields and/or you want all fields to be optional, please consider using the {\ttfamily \doxylink{structrfl_1_1_default_if_missing}{rfl\+::\+Default\+If\+Missing}} processor. You will find more information in the section on processors in this documentation. 