\doxysection{frontend.\+cpp}
\hypertarget{frontend_8cpp_source}{}\label{frontend_8cpp_source}\index{external/taskflow/3rd-\/party/tbb/src/tbbmalloc/frontend.cpp@{external/taskflow/3rd-\/party/tbb/src/tbbmalloc/frontend.cpp}}
\mbox{\hyperlink{frontend_8cpp}{浏览该文件的文档.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{/*}}
\DoxyCodeLine{00002\ \textcolor{comment}{\ \ \ \ Copyright\ (c)\ 2005-\/2020\ Intel\ Corporation}}
\DoxyCodeLine{00003\ \textcolor{comment}{}}
\DoxyCodeLine{00004\ \textcolor{comment}{\ \ \ \ Licensed\ under\ the\ Apache\ License,\ Version\ 2.0\ (the\ "{}License"{});}}
\DoxyCodeLine{00005\ \textcolor{comment}{\ \ \ \ you\ may\ not\ use\ this\ file\ except\ in\ compliance\ with\ the\ License.}}
\DoxyCodeLine{00006\ \textcolor{comment}{\ \ \ \ You\ may\ obtain\ a\ copy\ of\ the\ License\ at}}
\DoxyCodeLine{00007\ \textcolor{comment}{}}
\DoxyCodeLine{00008\ \textcolor{comment}{\ \ \ \ \ \ \ \ http://www.apache.org/licenses/LICENSE-\/2.0}}
\DoxyCodeLine{00009\ \textcolor{comment}{}}
\DoxyCodeLine{00010\ \textcolor{comment}{\ \ \ \ Unless\ required\ by\ applicable\ law\ or\ agreed\ to\ in\ writing,\ software}}
\DoxyCodeLine{00011\ \textcolor{comment}{\ \ \ \ distributed\ under\ the\ License\ is\ distributed\ on\ an\ "{}AS\ IS"{}\ BASIS,}}
\DoxyCodeLine{00012\ \textcolor{comment}{\ \ \ \ WITHOUT\ WARRANTIES\ OR\ CONDITIONS\ OF\ ANY\ KIND,\ either\ express\ or\ implied.}}
\DoxyCodeLine{00013\ \textcolor{comment}{\ \ \ \ See\ the\ License\ for\ the\ specific\ language\ governing\ permissions\ and}}
\DoxyCodeLine{00014\ \textcolor{comment}{\ \ \ \ limitations\ under\ the\ License.}}
\DoxyCodeLine{00015\ \textcolor{comment}{*/}}
\DoxyCodeLine{00016\ }
\DoxyCodeLine{00017\ }
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{tbbmalloc__internal_8h}{tbbmalloc\_internal.h}}"{}}}
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#include\ <errno.h>}}
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#include\ <new>}\ \ \ \ \ \ \ \ \textcolor{comment}{/*\ for\ placement\ new\ */}}
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{string_8h}{string.h}}>}\ \ \ \textcolor{comment}{/*\ for\ memset\ */}}
\DoxyCodeLine{00022\ }
\DoxyCodeLine{00023\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{tbb__version_8h}{../tbb/tbb\_version.h}}"{}}}
\DoxyCodeLine{00024\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{tbb__environment_8h}{../tbb/tbb\_environment.h}}"{}}}
\DoxyCodeLine{00025\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{itt__notify_8h}{../tbb/itt\_notify.h}}"{}}\ \textcolor{comment}{//\ for\ \_\_TBB\_load\_ittnotify()}}
\DoxyCodeLine{00026\ }
\DoxyCodeLine{00027\ \textcolor{preprocessor}{\#if\ USE\_PTHREAD}}
\DoxyCodeLine{00028\ \textcolor{preprocessor}{\ \ \ \ \#define\ TlsSetValue\_func\ pthread\_setspecific}}
\DoxyCodeLine{00029\ \textcolor{preprocessor}{\ \ \ \ \#define\ TlsGetValue\_func\ pthread\_getspecific}}
\DoxyCodeLine{00030\ \textcolor{preprocessor}{\ \ \ \ \#define\ GetMyTID()\ pthread\_self()}}
\DoxyCodeLine{00031\ \textcolor{preprocessor}{\ \ \ \ \#include\ <sched.h>}}
\DoxyCodeLine{00032\ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{frontend_8cpp_a55c924873baf1481b4de290a2b4fc299}{do\_yield}}()\ \{sched\_yield();\}}
\DoxyCodeLine{00033\ \ \ \ \ \textcolor{keyword}{extern}\ \textcolor{stringliteral}{"{}C"{}}\ \{\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{frontend_8cpp_a80b659a5a1776ca131e47a7a68a2c4a3}{mallocThreadShutdownNotification}}(\textcolor{keywordtype}{void}*);\ \}}
\DoxyCodeLine{00034\ \textcolor{preprocessor}{\ \ \ \ \#if\ \_\_sun\ ||\ \_\_SUNPRO\_CC}}
\DoxyCodeLine{00035\ \textcolor{preprocessor}{\ \ \ \ \#define\ \_\_asm\_\_\ asm}}
\DoxyCodeLine{00036\ \textcolor{preprocessor}{\ \ \ \ \#endif}}
\DoxyCodeLine{00037\ \textcolor{preprocessor}{\ \ \ \ \#include\ <unistd.h>}\ \textcolor{comment}{//\ sysconf(\_SC\_PAGESIZE)}}
\DoxyCodeLine{00038\ \textcolor{preprocessor}{\#elif\ USE\_WINTHREAD}}
\DoxyCodeLine{00039\ \textcolor{preprocessor}{\ \ \ \ \#define\ GetMyTID()\ GetCurrentThreadId()}}
\DoxyCodeLine{00040\ \textcolor{preprocessor}{\#if\ \_\_TBB\_WIN8UI\_SUPPORT}}
\DoxyCodeLine{00041\ \textcolor{preprocessor}{\ \ \ \ \#include<thread>}}
\DoxyCodeLine{00042\ \textcolor{preprocessor}{\ \ \ \ \#define\ TlsSetValue\_func\ FlsSetValue}}
\DoxyCodeLine{00043\ \textcolor{preprocessor}{\ \ \ \ \#define\ TlsGetValue\_func\ FlsGetValue}}
\DoxyCodeLine{00044\ \textcolor{preprocessor}{\ \ \ \ \#define\ TlsAlloc()\ FlsAlloc(NULL)}}
\DoxyCodeLine{00045\ \textcolor{preprocessor}{\ \ \ \ \#define\ TLS\_ALLOC\_FAILURE\ FLS\_OUT\_OF\_INDEXES}}
\DoxyCodeLine{00046\ \textcolor{preprocessor}{\ \ \ \ \#define\ TlsFree\ FlsFree}}
\DoxyCodeLine{00047\ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{frontend_8cpp_a55c924873baf1481b4de290a2b4fc299}{do\_yield}}()\ \{std::this\_thread::yield();\}}
\DoxyCodeLine{00048\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00049\ \textcolor{preprocessor}{\ \ \ \ \#define\ TlsSetValue\_func\ TlsSetValue}}
\DoxyCodeLine{00050\ \textcolor{preprocessor}{\ \ \ \ \#define\ TlsGetValue\_func\ TlsGetValue}}
\DoxyCodeLine{00051\ \textcolor{preprocessor}{\ \ \ \ \#define\ TLS\_ALLOC\_FAILURE\ TLS\_OUT\_OF\_INDEXES}}
\DoxyCodeLine{00052\ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{frontend_8cpp_a55c924873baf1481b4de290a2b4fc299}{do\_yield}}()\ \{SwitchToThread();\}}
\DoxyCodeLine{00053\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00054\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00055\ \textcolor{preprocessor}{\ \ \ \ \#error\ Must\ define\ USE\_PTHREAD\ or\ USE\_WINTHREAD}}
\DoxyCodeLine{00056\ }
\DoxyCodeLine{00057\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00058\ }
\DoxyCodeLine{00059\ }
\DoxyCodeLine{00060\ \textcolor{preprocessor}{\#define\ FREELIST\_NONBLOCKING\ 1}}
\DoxyCodeLine{00061\ }
\DoxyCodeLine{00062\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespacerml}{rml}}\ \{}
\DoxyCodeLine{00063\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool}{MemoryPool}};}
\DoxyCodeLine{00064\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespaceinternal}{internal}}\ \{}
\DoxyCodeLine{00065\ }
\DoxyCodeLine{00066\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}};}
\DoxyCodeLine{00067\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool}{MemoryPool}};}
\DoxyCodeLine{00068\ }
\DoxyCodeLine{00069\ \textcolor{preprocessor}{\#if\ MALLOC\_CHECK\_RECURSION}}
\DoxyCodeLine{00070\ }
\DoxyCodeLine{00071\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{namespacerml_1_1internal_a61c4d632ea815cbeea8ed0ee72e06ac7}{isMallocInitialized}}();}
\DoxyCodeLine{00072\ }
\DoxyCodeLine{00073\ \textcolor{keywordtype}{bool}\ RecursiveMallocCallProtector::noRecursion()\ \{}
\DoxyCodeLine{00074\ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\mbox{\hyperlink{namespacerml_1_1internal_a61c4d632ea815cbeea8ed0ee72e06ac7}{isMallocInitialized}}(),}
\DoxyCodeLine{00075\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Recursion\ status\ can\ be\ checked\ only\ when\ initialization\ was\ done."{}});}
\DoxyCodeLine{00076\ \ \ \ \ \textcolor{keywordflow}{return}\ !mallocRecursionDetected;}
\DoxyCodeLine{00077\ \}}
\DoxyCodeLine{00078\ }
\DoxyCodeLine{00079\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ MALLOC\_CHECK\_RECURSION}}
\DoxyCodeLine{00080\ }
\DoxyCodeLine{00082\ \textcolor{keyword}{const}\ intptr\_t\ \mbox{\hyperlink{namespacerml_1_1internal_ad6f3bbe7431bdc77608df9223c1c7e44}{UNUSABLE}}\ =\ 0x1;}
\DoxyCodeLine{00083\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{namespacerml_1_1internal_acf31583c01d488b00e387c3bfcb23e34}{isSolidPtr}}(\ \textcolor{keywordtype}{void}*\ \mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}}\ )\ \{}
\DoxyCodeLine{00084\ \ \ \ \ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{namespacerml_1_1internal_ad6f3bbe7431bdc77608df9223c1c7e44}{UNUSABLE}}|(intptr\_t)\mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}})!=\mbox{\hyperlink{namespacerml_1_1internal_ad6f3bbe7431bdc77608df9223c1c7e44}{UNUSABLE}};}
\DoxyCodeLine{00085\ \}}
\DoxyCodeLine{00086\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{namespacerml_1_1internal_a1e643afb71dbda290c1b03a3dbebdfbc}{isNotForUse}}(\ \textcolor{keywordtype}{void}*\ \mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}}\ )\ \{}
\DoxyCodeLine{00087\ \ \ \ \ \textcolor{keywordflow}{return}\ (intptr\_t)\mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}}==\mbox{\hyperlink{namespacerml_1_1internal_ad6f3bbe7431bdc77608df9223c1c7e44}{UNUSABLE}};}
\DoxyCodeLine{00088\ \}}
\DoxyCodeLine{00089\ }
\DoxyCodeLine{00090\ \textcolor{comment}{/*}}
\DoxyCodeLine{00091\ \textcolor{comment}{\ *\ Block::objectSize\ value\ used\ to\ mark\ blocks\ allocated\ by\ startupAlloc}}
\DoxyCodeLine{00092\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00093\ \textcolor{keyword}{const}\ \mbox{\hyperlink{eabase_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t}}\ \mbox{\hyperlink{namespacerml_1_1internal_a854b5f12c3c2951f100004bb161b3d4e}{startupAllocObjSizeMark}}\ =\ \string~(\mbox{\hyperlink{eabase_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t}})0;}
\DoxyCodeLine{00094\ }
\DoxyCodeLine{00095\ \textcolor{comment}{/*}}
\DoxyCodeLine{00096\ \textcolor{comment}{\ *\ The\ following\ constant\ is\ used\ to\ define\ the\ size\ of\ struct\ Block,\ the\ block\ header.}}
\DoxyCodeLine{00097\ \textcolor{comment}{\ *\ The\ intent\ is\ to\ have\ the\ size\ of\ a\ Block\ multiple\ of\ the\ cache\ line\ size,\ this\ allows\ us\ to}}
\DoxyCodeLine{00098\ \textcolor{comment}{\ *\ get\ good\ alignment\ at\ the\ cost\ of\ some\ overhead\ equal\ to\ the\ amount\ of\ padding\ included\ in\ the\ Block.}}
\DoxyCodeLine{00099\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00100\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{namespacerml_1_1internal_a60e9e26358bf7e6c992a1181a8f4ddf5}{blockHeaderAlignment}}\ =\ \mbox{\hyperlink{namespacerml_1_1internal_a559caa4a53713c2a95d8b28708ff1d77}{estimatedCacheLineSize}};}
\DoxyCodeLine{00101\ }
\DoxyCodeLine{00102\ \textcolor{comment}{/*********\ The\ data\ structures\ and\ global\ objects\ \ \ \ \ \ \ \ **************/}}
\DoxyCodeLine{00103\ }
\DoxyCodeLine{00104\ \textcolor{comment}{/*}}
\DoxyCodeLine{00105\ \textcolor{comment}{\ *\ The\ malloc\ routines\ themselves\ need\ to\ be\ able\ to\ occasionally\ malloc\ some\ space,}}
\DoxyCodeLine{00106\ \textcolor{comment}{\ *\ in\ order\ to\ set\ up\ the\ structures\ used\ by\ the\ thread\ local\ structures.\ This}}
\DoxyCodeLine{00107\ \textcolor{comment}{\ *\ routine\ performs\ that\ functions.}}
\DoxyCodeLine{00108\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00109\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classrml_1_1internal_1_1_boot_strap_blocks}{BootStrapBlocks}}\ \{}
\DoxyCodeLine{00110\ \ \ \ \ \mbox{\hyperlink{class_malloc_mutex}{MallocMutex}}\ \mbox{\hyperlink{classrml_1_1internal_1_1_boot_strap_blocks_a15103d69d2c9dc17b383f88fe238b50e}{bootStrapLock}};}
\DoxyCodeLine{00111\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}\ \ \ \ \ \ *\mbox{\hyperlink{classrml_1_1internal_1_1_boot_strap_blocks_aa446bae623c32a2231cb1c5dfbd53cb4}{bootStrapBlock}};}
\DoxyCodeLine{00112\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}\ \ \ \ \ \ *\mbox{\hyperlink{classrml_1_1internal_1_1_boot_strap_blocks_aa5ec57e57f3acdb33c4e95cffef57682}{bootStrapBlockUsed}};}
\DoxyCodeLine{00113\ \ \ \ \ \mbox{\hyperlink{structrml_1_1internal_1_1_free_object}{FreeObject}}\ *\mbox{\hyperlink{classrml_1_1internal_1_1_boot_strap_blocks_ab3c22f8255fb4f6bdd51d9a360aa57fc}{bootStrapObjectList}};}
\DoxyCodeLine{00114\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00115\ \ \ \ \ \textcolor{keywordtype}{void}\ *\mbox{\hyperlink{classrml_1_1internal_1_1_boot_strap_blocks_ac04f5dfb5527488b55c491957dc8ec66}{allocate}}(\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool}{MemoryPool}}\ *memPool,\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}});}
\DoxyCodeLine{00116\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{mimalloc-override_8h_a9d4b5df3530d1bc733070a4669ba6ebc}{free}}(\textcolor{keywordtype}{void}*\ \mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}});}
\DoxyCodeLine{00117\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1internal_1_1_boot_strap_blocks_addc591467d1fb49018fd5dd05943b114}{reset}}();}
\DoxyCodeLine{00118\ \};}
\DoxyCodeLine{00119\ }
\DoxyCodeLine{00120\ \textcolor{preprocessor}{\#if\ USE\_INTERNAL\_TID}}
\DoxyCodeLine{00121\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classrml_1_1internal_1_1_thread_id}{ThreadId}}\ \{}
\DoxyCodeLine{00122\ \ \ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{tbbmalloc__internal_8h_a426aa0379460f2cf1bf8efaaad1ec694}{tls\_key\_t}}\ Tid\_key;}
\DoxyCodeLine{00123\ \ \ \ \ \textcolor{keyword}{static}\ intptr\_t\ ThreadCount;}
\DoxyCodeLine{00124\ }
\DoxyCodeLine{00125\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{cocoa__platform_8h_acf00cd75f37488e1d4ac463303ccfec4}{id}};}
\DoxyCodeLine{00126\ }
\DoxyCodeLine{00127\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ tlsNumber()\ \{}
\DoxyCodeLine{00128\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}}\ =\ \textcolor{keyword}{reinterpret\_cast<}intptr\_t\textcolor{keyword}{>}(\mbox{\hyperlink{frontend_8cpp_a2a58bb0885434c134c2db44198dceb31}{TlsGetValue\_func}}(Tid\_key));}
\DoxyCodeLine{00129\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ !\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}}\ )\ \{}
\DoxyCodeLine{00130\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_recursive_malloc_call_protector}{RecursiveMallocCallProtector}}\ scoped;}
\DoxyCodeLine{00131\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Thread-\/local\ value\ is\ zero\ -\/>\ first\ call\ from\ this\ thread,}}
\DoxyCodeLine{00132\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ need\ to\ initialize\ with\ next\ ID\ value\ (IDs\ start\ from\ 1)}}
\DoxyCodeLine{00133\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}}\ =\ \mbox{\hyperlink{_synchronize_8h_a248bc2de542e20022d01360546768c50}{AtomicIncrement}}(ThreadCount);\ \textcolor{comment}{//\ returned\ new\ value!}}
\DoxyCodeLine{00134\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{frontend_8cpp_a36763b323ed1dbbc589f0e05e2c591bd}{TlsSetValue\_func}}(\ Tid\_key,\ \textcolor{keyword}{reinterpret\_cast<}\textcolor{keywordtype}{void}*\textcolor{keyword}{>}(\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}})\ );}
\DoxyCodeLine{00135\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00136\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}};}
\DoxyCodeLine{00137\ \ \ \ \ \}}
\DoxyCodeLine{00138\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00139\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classrml_1_1internal_1_1_thread_id_a58d4cb2156367a2fc468f6daf5cbded2}{init}}()\ \{}
\DoxyCodeLine{00140\ \textcolor{preprocessor}{\#if\ USE\_WINTHREAD}}
\DoxyCodeLine{00141\ \ \ \ \ \ \ \ \ Tid\_key\ =\ TlsAlloc();}
\DoxyCodeLine{00142\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (Tid\_key\ ==\ TLS\_ALLOC\_FAILURE)}
\DoxyCodeLine{00143\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00144\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00145\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ status\ =\ \mbox{\hyperlink{pthread__minport__windows_8h_aeec8c9fbaa95db94c605152be4dbe088}{pthread\_key\_create}}(\ \&Tid\_key,\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}}\ );}
\DoxyCodeLine{00146\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\ status\ )\ \{}
\DoxyCodeLine{00147\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{printf_8h_a9f315126362cae9675de1642105e631e}{fprintf}}\ (stderr,\ \textcolor{stringliteral}{"{}The\ memory\ manager\ cannot\ create\ tls\ key\ during\ initialization\(\backslash\)n"{}});}
\DoxyCodeLine{00148\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00149\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00150\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{/*\ USE\_WINTHREAD\ */}\textcolor{preprocessor}{}}
\DoxyCodeLine{00151\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00152\ \ \ \ \ \}}
\DoxyCodeLine{00153\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1internal_1_1_thread_id_ad5e9ae4af22d11ac614a530cdc3ad02f}{destroy}}()\ \{}
\DoxyCodeLine{00154\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ Tid\_key\ )\ \{}
\DoxyCodeLine{00155\ \textcolor{preprocessor}{\#if\ USE\_WINTHREAD}}
\DoxyCodeLine{00156\ \ \ \ \ \ \ \ \ \ \ \ \ BOOL\ status\ =\ !(TlsFree(\ Tid\_key\ ));\ \ \textcolor{comment}{//\ fail\ is\ zero}}
\DoxyCodeLine{00157\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00158\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ status\ =\ \mbox{\hyperlink{pthread__minport__windows_8h_a20c3a19dc169f60d2b3df87499686ac2}{pthread\_key\_delete}}(\ Tid\_key\ );}
\DoxyCodeLine{00159\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{/*\ USE\_WINTHREAD\ */}\textcolor{preprocessor}{}}
\DoxyCodeLine{00160\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\ status\ )}
\DoxyCodeLine{00161\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{printf_8h_a9f315126362cae9675de1642105e631e}{fprintf}}\ (stderr,\ \textcolor{stringliteral}{"{}The\ memory\ manager\ cannot\ delete\ tls\ key\(\backslash\)n"{}});}
\DoxyCodeLine{00162\ \ \ \ \ \ \ \ \ \ \ \ \ Tid\_key\ =\ 0;}
\DoxyCodeLine{00163\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00164\ \ \ \ \ \}}
\DoxyCodeLine{00165\ }
\DoxyCodeLine{00166\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_thread_id_a17d802dfdb7cb86e64291e03ca92d82c}{ThreadId}}()\ :\ \mbox{\hyperlink{cocoa__platform_8h_acf00cd75f37488e1d4ac463303ccfec4}{id}}(\mbox{\hyperlink{classrml_1_1internal_1_1_thread_id_a17d802dfdb7cb86e64291e03ca92d82c}{ThreadId}}::tlsNumber())\ \{\}}
\DoxyCodeLine{00167\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classrml_1_1internal_1_1_thread_id_aba782a6a5546e7caa33b7cf9471629b9}{isCurrentThreadId}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \textcolor{keywordtype}{id}\ ==\ ThreadId::tlsNumber();\ \}}
\DoxyCodeLine{00168\ }
\DoxyCodeLine{00169\ \textcolor{preprocessor}{\#if\ COLLECT\_STATISTICS\ ||\ MALLOC\_TRACE}}
\DoxyCodeLine{00170\ \ \ \ \ \textcolor{keyword}{friend}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{namespacerml_1_1internal_a2877b2db91c23b8b7eb1d37891c40b2b}{getThreadId}}()\ \{\ \textcolor{keywordflow}{return}\ ThreadId::tlsNumber();\ \}}
\DoxyCodeLine{00171\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00172\ \textcolor{preprocessor}{\#if\ COLLECT\_STATISTICS}}
\DoxyCodeLine{00173\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{unsigned}\ getMaxThreadId()\ \{\ \textcolor{keywordflow}{return}\ ThreadCount;\ \}}
\DoxyCodeLine{00174\ }
\DoxyCodeLine{00175\ \ \ \ \ \textcolor{keyword}{friend}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{tbbmalloc_2statistics_8h_a45adf7cb101679d45b142782cc324196}{STAT\_increment}}(\mbox{\hyperlink{classrml_1_1internal_1_1_thread_id_a17d802dfdb7cb86e64291e03ca92d82c}{ThreadId}}\ \mbox{\hyperlink{classrml_1_1internal_1_1_thread_id_ad4bf2bbae4e0b701f9ecd64aead3decf}{tid}},\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{runtime_2spdlog_2include_2spdlog_2fmt_2bundled_2base_8h_adfa139c9a1902753b3696794759b2c48ac1111bd512b29e821b120b86446026b8}{bin}},\ \textcolor{keywordtype}{int}\ ctr);}
\DoxyCodeLine{00176\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00177\ \};}
\DoxyCodeLine{00178\ }
\DoxyCodeLine{00179\ \mbox{\hyperlink{tbbmalloc__internal_8h_a426aa0379460f2cf1bf8efaaad1ec694}{tls\_key\_t}}\ ThreadId::Tid\_key;}
\DoxyCodeLine{00180\ intptr\_t\ ThreadId::ThreadCount;}
\DoxyCodeLine{00181\ }
\DoxyCodeLine{00182\ \textcolor{preprocessor}{\#if\ COLLECT\_STATISTICS}}
\DoxyCodeLine{00183\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{tbbmalloc_2statistics_8h_a45adf7cb101679d45b142782cc324196}{STAT\_increment}}(\mbox{\hyperlink{classrml_1_1internal_1_1_thread_id}{ThreadId}}\ tid,\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{runtime_2spdlog_2include_2spdlog_2fmt_2bundled_2base_8h_adfa139c9a1902753b3696794759b2c48ac1111bd512b29e821b120b86446026b8}{bin}},\ \textcolor{keywordtype}{int}\ ctr)}
\DoxyCodeLine{00184\ \{}
\DoxyCodeLine{00185\ \ \ \ \ return\ ::STAT\_increment(tid.id,\ \mbox{\hyperlink{runtime_2spdlog_2include_2spdlog_2fmt_2bundled_2base_8h_adfa139c9a1902753b3696794759b2c48ac1111bd512b29e821b120b86446026b8}{bin}},\ ctr);}
\DoxyCodeLine{00186\ \}}
\DoxyCodeLine{00187\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00188\ }
\DoxyCodeLine{00189\ \textcolor{preprocessor}{\#else\ }\textcolor{comment}{//\ USE\_INTERNAL\_TID}}
\DoxyCodeLine{00190\ }
\DoxyCodeLine{00191\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classrml_1_1internal_1_1_thread_id_a17d802dfdb7cb86e64291e03ca92d82c}{ThreadId}}\ \{}
\DoxyCodeLine{00192\ \textcolor{preprocessor}{\#if\ USE\_PTHREAD}}
\DoxyCodeLine{00193\ \ \ \ \ \mbox{\hyperlink{pthread__minport__windows_8h_ad665cf4bf4a61dd23aab712d9c5e9d81}{pthread\_t}}\ \mbox{\hyperlink{classrml_1_1internal_1_1_thread_id_ad4bf2bbae4e0b701f9ecd64aead3decf}{tid}};}
\DoxyCodeLine{00194\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00195\ \ \ \ \ \mbox{\hyperlink{test__malloc__compliance_8cpp_ad342ac907eb044443153a22f964bf0af}{DWORD}}\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_thread_id_ad4bf2bbae4e0b701f9ecd64aead3decf}{tid}};}
\DoxyCodeLine{00196\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00197\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00198\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_thread_id_a17d802dfdb7cb86e64291e03ca92d82c}{ThreadId}}()\ :\ \mbox{\hyperlink{classrml_1_1internal_1_1_thread_id_ad4bf2bbae4e0b701f9ecd64aead3decf}{tid}}(\mbox{\hyperlink{frontend_8cpp_a6be7f1c64c9c0726a5c2f4b4e0436168}{GetMyTID}}())\ \{\}}
\DoxyCodeLine{00199\ \textcolor{preprocessor}{\#if\ USE\_PTHREAD}}
\DoxyCodeLine{00200\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classrml_1_1internal_1_1_thread_id_aba782a6a5546e7caa33b7cf9471629b9}{isCurrentThreadId}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ pthread\_equal(\mbox{\hyperlink{pthread__minport__windows_8h_a31ffbf449d7404f9bb088564190c6bce}{pthread\_self}}(),\ \mbox{\hyperlink{classrml_1_1internal_1_1_thread_id_ad4bf2bbae4e0b701f9ecd64aead3decf}{tid}});\ \}}
\DoxyCodeLine{00201\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00202\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classrml_1_1internal_1_1_thread_id_aba782a6a5546e7caa33b7cf9471629b9}{isCurrentThreadId}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ GetCurrentThreadId()\ ==\ \mbox{\hyperlink{classrml_1_1internal_1_1_thread_id_ad4bf2bbae4e0b701f9ecd64aead3decf}{tid}};\ \}}
\DoxyCodeLine{00203\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00204\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classrml_1_1internal_1_1_thread_id_a58d4cb2156367a2fc468f6daf5cbded2}{init}}()\ \{\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};\ \}}
\DoxyCodeLine{00205\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1internal_1_1_thread_id_ad5e9ae4af22d11ac614a530cdc3ad02f}{destroy}}()\ \{\}}
\DoxyCodeLine{00206\ \};}
\DoxyCodeLine{00207\ }
\DoxyCodeLine{00208\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ USE\_INTERNAL\_TID}}
\DoxyCodeLine{00209\ }
\DoxyCodeLine{00210\ \textcolor{comment}{/***********\ Code\ to\ provide\ thread\ ID\ and\ a\ thread-\/local\ void\ pointer\ **********/}}
\DoxyCodeLine{00211\ }
\DoxyCodeLine{00212\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_key_a1f2f9f05f38781763a400ab092135758}{TLSKey::init}}()}
\DoxyCodeLine{00213\ \{}
\DoxyCodeLine{00214\ \textcolor{preprocessor}{\#if\ USE\_WINTHREAD}}
\DoxyCodeLine{00215\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_key_a9f65839984ce3556d00450a06bfa7b48}{TLS\_pointer\_key}}\ =\ TlsAlloc();}
\DoxyCodeLine{00216\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_key_a9f65839984ce3556d00450a06bfa7b48}{TLS\_pointer\_key}}\ ==\ TLS\_ALLOC\_FAILURE)}
\DoxyCodeLine{00217\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00218\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00219\ \ \ \ \ \textcolor{keywordtype}{int}\ status\ =\ \mbox{\hyperlink{pthread__minport__windows_8h_aeec8c9fbaa95db94c605152be4dbe088}{pthread\_key\_create}}(\ \&\mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_key_a9f65839984ce3556d00450a06bfa7b48}{TLS\_pointer\_key}},\ \mbox{\hyperlink{frontend_8cpp_a80b659a5a1776ca131e47a7a68a2c4a3}{mallocThreadShutdownNotification}}\ );}
\DoxyCodeLine{00220\ \ \ \ \ \textcolor{keywordflow}{if}\ (\ status\ )}
\DoxyCodeLine{00221\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00222\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{/*\ USE\_WINTHREAD\ */}\textcolor{preprocessor}{}}
\DoxyCodeLine{00223\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00224\ \}}
\DoxyCodeLine{00225\ }
\DoxyCodeLine{00226\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_key_ac132d53d35d0536953da9c6e3bc7e5ea}{TLSKey::destroy}}()}
\DoxyCodeLine{00227\ \{}
\DoxyCodeLine{00228\ \textcolor{preprocessor}{\#if\ USE\_WINTHREAD}}
\DoxyCodeLine{00229\ \ \ \ \ BOOL\ status1\ =\ !(TlsFree(\mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_key_a9f65839984ce3556d00450a06bfa7b48}{TLS\_pointer\_key}}));\ \textcolor{comment}{//\ fail\ is\ zero}}
\DoxyCodeLine{00230\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00231\ \ \ \ \ \textcolor{keywordtype}{int}\ status1\ =\ \mbox{\hyperlink{pthread__minport__windows_8h_a20c3a19dc169f60d2b3df87499686ac2}{pthread\_key\_delete}}(\mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_key_a9f65839984ce3556d00450a06bfa7b48}{TLS\_pointer\_key}});}
\DoxyCodeLine{00232\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{/*\ USE\_WINTHREAD\ */}\textcolor{preprocessor}{}}
\DoxyCodeLine{00233\ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(!status1,\ \textcolor{stringliteral}{"{}The\ memory\ manager\ cannot\ delete\ tls\ key."{}});}
\DoxyCodeLine{00234\ \ \ \ \ \textcolor{keywordflow}{return}\ status1==0;}
\DoxyCodeLine{00235\ \}}
\DoxyCodeLine{00236\ }
\DoxyCodeLine{00237\ \textcolor{keyword}{inline}\ \mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data}{TLSData}}*\ \mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_key_a13963112bc0570cdcd5449d4104c3d0f}{TLSKey::getThreadMallocTLS}}()\textcolor{keyword}{\ const}}
\DoxyCodeLine{00238\ \textcolor{keyword}{}\{}
\DoxyCodeLine{00239\ \ \ \ \ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data}{TLSData}}\ *)\mbox{\hyperlink{frontend_8cpp_a2a58bb0885434c134c2db44198dceb31}{TlsGetValue\_func}}(\ \mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_key_a9f65839984ce3556d00450a06bfa7b48}{TLS\_pointer\_key}}\ );}
\DoxyCodeLine{00240\ \}}
\DoxyCodeLine{00241\ }
\DoxyCodeLine{00242\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_key_af482c91d6b8aff61e3a45c4a41cf09c9}{TLSKey::setThreadMallocTLS}}(\ \mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data}{TLSData}}\ *\ newvalue\ )\ \{}
\DoxyCodeLine{00243\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_recursive_malloc_call_protector}{RecursiveMallocCallProtector}}\ scoped;}
\DoxyCodeLine{00244\ \ \ \ \ \mbox{\hyperlink{frontend_8cpp_a36763b323ed1dbbc589f0e05e2c591bd}{TlsSetValue\_func}}(\ \mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_key_a9f65839984ce3556d00450a06bfa7b48}{TLS\_pointer\_key}},\ newvalue\ );}
\DoxyCodeLine{00245\ \}}
\DoxyCodeLine{00246\ }
\DoxyCodeLine{00247\ \textcolor{comment}{/*\ The\ 'next'\ field\ in\ the\ block\ header\ has\ to\ maintain\ some\ invariants:}}
\DoxyCodeLine{00248\ \textcolor{comment}{\ *\ \ \ it\ needs\ to\ be\ on\ a\ 16K\ boundary\ and\ the\ first\ field\ in\ the\ block.}}
\DoxyCodeLine{00249\ \textcolor{comment}{\ *\ \ \ Any\ value\ stored\ there\ needs\ to\ have\ the\ lower\ 14\ bits\ set\ to\ 0}}
\DoxyCodeLine{00250\ \textcolor{comment}{\ *\ \ \ so\ that\ various\ assert\ work.\ This\ means\ that\ if\ you\ want\ to\ smash\ this\ memory}}
\DoxyCodeLine{00251\ \textcolor{comment}{\ *\ \ \ for\ debugging\ purposes\ you\ will\ need\ to\ obey\ this\ invariant.}}
\DoxyCodeLine{00252\ \textcolor{comment}{\ *\ The\ total\ size\ of\ the\ header\ needs\ to\ be\ a\ power\ of\ 2\ to\ simplify}}
\DoxyCodeLine{00253\ \textcolor{comment}{\ *\ the\ alignment\ requirements.\ For\ now\ it\ is\ a\ 128\ byte\ structure.}}
\DoxyCodeLine{00254\ \textcolor{comment}{\ *\ To\ avoid\ false\ sharing,\ the\ fields\ changed\ only\ locally\ are\ separated}}
\DoxyCodeLine{00255\ \textcolor{comment}{\ *\ from\ the\ fields\ changed\ by\ foreign\ threads.}}
\DoxyCodeLine{00256\ \textcolor{comment}{\ *\ Changing\ the\ size\ of\ the\ block\ header\ would\ require\ to\ change}}
\DoxyCodeLine{00257\ \textcolor{comment}{\ *\ some\ bin\ allocation\ sizes,\ in\ particular\ "{}fitting"{}\ sizes\ (see\ above).}}
\DoxyCodeLine{00258\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00259\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classrml_1_1internal_1_1_bin}{Bin}};}
\DoxyCodeLine{00260\ \textcolor{keyword}{class\ }StartupBlock;}
\DoxyCodeLine{00261\ }
\DoxyCodeLine{00262\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_ab697cecb784483488f6639c6efce0c42}{MemoryPool}}\ \{}
\DoxyCodeLine{00263\ \ \ \ \ \textcolor{comment}{//\ if\ no\ explicit\ grainsize,\ expect\ to\ see\ malloc\ in\ user's\ pAlloc}}
\DoxyCodeLine{00264\ \ \ \ \ \textcolor{comment}{//\ and\ set\ reasonable\ low\ granularity}}
\DoxyCodeLine{00265\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_a97cf2383f445b70fb210cdf30d410c11}{defaultGranularity}}\ =\ \mbox{\hyperlink{namespacerml_1_1internal_a559caa4a53713c2a95d8b28708ff1d77}{estimatedCacheLineSize}};}
\DoxyCodeLine{00266\ }
\DoxyCodeLine{00267\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_ab697cecb784483488f6639c6efce0c42}{MemoryPool}}();\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ deny}}
\DoxyCodeLine{00268\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00269\ \ \ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{class_malloc_mutex}{MallocMutex}}\ \ \mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_ae2f9869ec6e87cbdeabf13d365d49f62}{memPoolListLock}};}
\DoxyCodeLine{00270\ }
\DoxyCodeLine{00271\ \ \ \ \ \textcolor{comment}{//\ list\ of\ all\ active\ pools\ is\ used\ to\ release}}
\DoxyCodeLine{00272\ \ \ \ \ \textcolor{comment}{//\ all\ TLS\ data\ on\ thread\ termination\ or\ library\ unload}}
\DoxyCodeLine{00273\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_ab697cecb784483488f6639c6efce0c42}{MemoryPool}}\ \ \ \ *\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_abe53d310d639ead4d055119d5a2b5552}{next}},}
\DoxyCodeLine{00274\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_aee4c5ad03dce6827a776cedbf53339d9}{prev}};}
\DoxyCodeLine{00275\ \ \ \ \ \mbox{\hyperlink{structrml_1_1internal_1_1_ext_memory_pool}{ExtMemoryPool}}\ \ \mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_a93f7cd65f7ae8f1608a846cded95cd7c}{extMemPool}};}
\DoxyCodeLine{00276\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_boot_strap_blocks}{BootStrapBlocks}}\ \mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_ab6031f40ff7011e056db5052cd88de22}{bootStrapBlocks}};}
\DoxyCodeLine{00277\ }
\DoxyCodeLine{00278\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_add7381e97285946d931d763e07dee7e5}{initDefaultPool}}();}
\DoxyCodeLine{00279\ }
\DoxyCodeLine{00280\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{boing_8c_a2858154e2009b0e6e616f313177762bc}{init}}(intptr\_t\ poolId,\ \textcolor{keyword}{const}\ MemPoolPolicy*\ memPoolPolicy);}
\DoxyCodeLine{00281\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_a906373d1f7c52a00bf31f841d46ce281}{reset}}();}
\DoxyCodeLine{00282\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_ac77d7b8f6b4cd31f7f3e49b0d7676196}{destroy}}();}
\DoxyCodeLine{00283\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_a2a310517ff92f8e0e7dae29400ffeb61}{onThreadShutdown}}(\mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data}{TLSData}}\ *tlsData);}
\DoxyCodeLine{00284\ }
\DoxyCodeLine{00285\ \ \ \ \ \textcolor{keyword}{inline}\ \mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data}{TLSData}}\ *\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_acdf684e1b29c9d00886d97b909798488}{getTLS}}(\textcolor{keywordtype}{bool}\ create);}
\DoxyCodeLine{00286\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_ae55f3e31dc8bce61a9e97a6a83283d12}{clearTLS}}()\ \{\ \mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_a93f7cd65f7ae8f1608a846cded95cd7c}{extMemPool}}.tlsPointerKey.setThreadMallocTLS(\mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}});\ \}}
\DoxyCodeLine{00287\ }
\DoxyCodeLine{00288\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}\ *\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_a16261e62d2c6418981ade9a7ea23d5d0}{getEmptyBlock}}(\textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}});}
\DoxyCodeLine{00289\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_a7a5bf7ebdfc09d422f7862d8d4063795}{returnEmptyBlock}}(\mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}\ *\mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}},\ \textcolor{keywordtype}{bool}\ poolTheBlock);}
\DoxyCodeLine{00290\ }
\DoxyCodeLine{00291\ \ \ \ \ \textcolor{comment}{//\ get/put\ large\ object\ to/from\ local\ large\ object\ cache}}
\DoxyCodeLine{00292\ \ \ \ \ \textcolor{keywordtype}{void}\ *\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_af1f6175add16b2b950447b8b4c6bf491}{getFromLLOCache}}(\mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data}{TLSData}}\ *tls,\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}},\ \textcolor{keywordtype}{size\_t}\ alignment);}
\DoxyCodeLine{00293\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_aedf33ac6b570a3847f86ad528de00149}{putToLLOCache}}(\mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data}{TLSData}}\ *tls,\ \textcolor{keywordtype}{void}\ *\textcolor{keywordtype}{object});}
\DoxyCodeLine{00294\ \};}
\DoxyCodeLine{00295\ }
\DoxyCodeLine{00296\ \textcolor{keyword}{static}\ intptr\_t\ \mbox{\hyperlink{namespacerml_1_1internal_a20dda5aef9747bc10069cc46cb32b2f2}{defaultMemPool\_space}}[\textcolor{keyword}{sizeof}(\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool}{MemoryPool}})/\textcolor{keyword}{sizeof}(intptr\_t)\ +}
\DoxyCodeLine{00297\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{keyword}{sizeof}(\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool}{MemoryPool}})\%\textcolor{keyword}{sizeof}(intptr\_t)?\ 1\ :\ 0)];}
\DoxyCodeLine{00298\ \textcolor{keyword}{static}\ \mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool}{MemoryPool}}\ *\mbox{\hyperlink{namespacerml_1_1internal_a775ef3ae8dd6b242d20f44ebd787a1be}{defaultMemPool}}\ =\ (\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool}{MemoryPool}}*)\mbox{\hyperlink{namespacerml_1_1internal_a20dda5aef9747bc10069cc46cb32b2f2}{defaultMemPool\_space}};}
\DoxyCodeLine{00299\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_a97cf2383f445b70fb210cdf30d410c11}{MemoryPool::defaultGranularity}};}
\DoxyCodeLine{00300\ \textcolor{comment}{//\ zero-\/initialized}}
\DoxyCodeLine{00301\ \mbox{\hyperlink{class_malloc_mutex}{MallocMutex}}\ \ \mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_ae2f9869ec6e87cbdeabf13d365d49f62}{MemoryPool::memPoolListLock}};}
\DoxyCodeLine{00302\ \textcolor{comment}{//\ TODO:\ move\ huge\ page\ status\ to\ default\ pool,\ because\ that's\ its\ states}}
\DoxyCodeLine{00303\ \mbox{\hyperlink{classrml_1_1internal_1_1_huge_pages_status}{HugePagesStatus}}\ \mbox{\hyperlink{namespacerml_1_1internal_a47aa4f0d1eb6a621e5830ea034495648}{hugePages}};}
\DoxyCodeLine{00304\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{namespacerml_1_1internal_adfef860fe0efd8df96bdddf72c66e7e2}{usedBySrcIncluded}}\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00305\ }
\DoxyCodeLine{00306\ \textcolor{comment}{//\ Padding\ helpers}}
\DoxyCodeLine{00307\ \textcolor{keyword}{template}<\textcolor{keywordtype}{size\_t}\ padd>}
\DoxyCodeLine{00308\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structrml_1_1internal_1_1_padding_impl}{PaddingImpl}}\ \{}
\DoxyCodeLine{00309\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \ \ \ \ \ \ \mbox{\hyperlink{structrml_1_1internal_1_1_padding_impl_a54413188e22d248a15202ead14a26764}{\_\_padding}}[padd];}
\DoxyCodeLine{00310\ \};}
\DoxyCodeLine{00311\ }
\DoxyCodeLine{00312\ \textcolor{keyword}{template}<>}
\DoxyCodeLine{00313\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structrml_1_1internal_1_1_padding_impl}{PaddingImpl}}<0>\ \{\};}
\DoxyCodeLine{00314\ }
\DoxyCodeLine{00315\ \textcolor{keyword}{template}<\textcolor{keywordtype}{int}\ N>}
\DoxyCodeLine{00316\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structrml_1_1internal_1_1_padding}{Padding}}\ :\ \mbox{\hyperlink{structrml_1_1internal_1_1_padding_impl}{PaddingImpl}}<N/sizeof(size\_t)>\ \{\};}
\DoxyCodeLine{00317\ }
\DoxyCodeLine{00318\ \textcolor{comment}{//\ Slab\ block\ is\ 16KB-\/aligned.\ To\ prevent\ false\ sharing,\ separate\ locally-\/accessed}}
\DoxyCodeLine{00319\ \textcolor{comment}{//\ fields\ and\ fields\ commonly\ accessed\ by\ not\ owner\ threads.}}
\DoxyCodeLine{00320\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classrml_1_1internal_1_1_global_block_fields}{GlobalBlockFields}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{classrml_1_1internal_1_1_block_i}{BlockI}}\ \{}
\DoxyCodeLine{00321\ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00322\ \ \ \ \ \mbox{\hyperlink{structrml_1_1internal_1_1_free_object}{FreeObject}}\ \ *\mbox{\hyperlink{classrml_1_1internal_1_1_global_block_fields_a250f5629d8827f1821cd6a318d1d6b9b}{publicFreeList}};}
\DoxyCodeLine{00323\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}\ \ \ \ \ \ \ *\mbox{\hyperlink{classrml_1_1internal_1_1_global_block_fields_a1360a23b724f8505caeb81b21eab0c59}{nextPrivatizable}};}
\DoxyCodeLine{00324\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool}{MemoryPool}}\ \ *\mbox{\hyperlink{classrml_1_1internal_1_1_global_block_fields_a1039208fa5c6fc42be80bfeb59efcab8}{poolPtr}};}
\DoxyCodeLine{00325\ \};}
\DoxyCodeLine{00326\ }
\DoxyCodeLine{00327\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields}{LocalBlockFields}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{classrml_1_1internal_1_1_global_block_fields}{GlobalBlockFields}},\ \mbox{\hyperlink{structrml_1_1internal_1_1_padding}{Padding}}<blockHeaderAlignment\ -\/\ sizeof(GlobalBlockFields)>\ \ \{}
\DoxyCodeLine{00328\ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00329\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}\ \ \ \ \ \ \ *\mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_ab0858e200e0125219210fe856e98fa28}{next}};}
\DoxyCodeLine{00330\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}\ \ \ \ \ \ \ *\mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a3a5c6afadff504e7196e643938f26cad}{previous}};\ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Use\ double\ linked\ list\ to\ speed\ up\ removal\ */}}
\DoxyCodeLine{00331\ \ \ \ \ \mbox{\hyperlink{structrml_1_1internal_1_1_free_object}{FreeObject}}\ \ *\mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a7539e25da68797f70368fa66e62e9c1c}{bumpPtr}};\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Bump\ pointer\ moves\ from\ the\ end\ to\ the\ beginning\ of\ a\ block\ */}}
\DoxyCodeLine{00332\ \ \ \ \ \mbox{\hyperlink{structrml_1_1internal_1_1_free_object}{FreeObject}}\ \ *\mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_ade8311f40ae3e9114518063032b7c42a}{freeList}};}
\DoxyCodeLine{00333\ \ \ \ \ \textcolor{comment}{/*\ Pointer\ to\ local\ data\ for\ the\ owner\ thread.\ Used\ for\ fast\ finding\ tls}}
\DoxyCodeLine{00334\ \textcolor{comment}{\ \ \ \ \ \ \ when\ releasing\ object\ from\ a\ block\ that\ current\ thread\ owned.}}
\DoxyCodeLine{00335\ \textcolor{comment}{\ \ \ \ \ \ \ NULL\ for\ orphaned\ blocks.\ */}}
\DoxyCodeLine{00336\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data}{TLSData}}\ \ \ \ \ *\mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_ac591e79d62cf0ee8907a3e60991d0734}{tlsPtr}};}
\DoxyCodeLine{00337\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_thread_id}{ThreadId}}\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a22b6910d3d56fd1183c5c4a1ed44e09f}{ownerTid}};\ \ \ \ \ \ \ \ \textcolor{comment}{/*\ the\ ID\ of\ the\ thread\ that\ owns\ or\ last\ owned\ the\ block\ */}}
\DoxyCodeLine{00338\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_back_ref_idx}{BackRefIdx}}\ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a11ce58dcddb3de047a57116d563d24ea}{backRefIdx}};}
\DoxyCodeLine{00339\ \ \ \ \ \mbox{\hyperlink{eabase_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t}}\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a7d1d7c70675b3ba72924d1cbafd6772a}{allocatedCount}};\ \ \textcolor{comment}{/*\ Number\ of\ objects\ allocated\ (obviously\ by\ the\ owning\ thread)\ */}}
\DoxyCodeLine{00340\ \ \ \ \ \mbox{\hyperlink{eabase_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t}}\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a0e116178c7df6b87077b7b029a0fe653}{objectSize}};}
\DoxyCodeLine{00341\ \ \ \ \ \textcolor{keywordtype}{bool}\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a76d70cbe8837862cdf286a120266e430}{isFull}};}
\DoxyCodeLine{00342\ }
\DoxyCodeLine{00343\ \ \ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_aab178c7b56f5dcfba20ccb6c19ca4304}{FreeBlockPool}};}
\DoxyCodeLine{00344\ \ \ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a9308a65d09141b30f2fec487c2a15828}{StartupBlock}};}
\DoxyCodeLine{00345\ \ \ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_ada4f758cc14b38601bff2f737f50caca}{LifoList}};}
\DoxyCodeLine{00346\ \ \ \ \ \textcolor{keyword}{friend}\ \textcolor{keywordtype}{void}\ *\mbox{\hyperlink{classrml_1_1internal_1_1_boot_strap_blocks_ac04f5dfb5527488b55c491957dc8ec66}{BootStrapBlocks::allocate}}(\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool}{MemoryPool}}\ *,\ \textcolor{keywordtype}{size\_t});}
\DoxyCodeLine{00347\ \ \ \ \ \textcolor{keyword}{friend}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classrml_1_1internal_1_1_orphaned_blocks_a1707222a0a6430ed2efe30049dfd4784}{OrphanedBlocks::cleanup}}(\mbox{\hyperlink{classrml_1_1internal_1_1_backend}{Backend}}*);}
\DoxyCodeLine{00348\ \ \ \ \ \textcolor{keyword}{friend}\ \mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}\ *\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_a16261e62d2c6418981ade9a7ea23d5d0}{MemoryPool::getEmptyBlock}}(\textcolor{keywordtype}{size\_t});}
\DoxyCodeLine{00349\ \};}
\DoxyCodeLine{00350\ }
\DoxyCodeLine{00351\ \textcolor{comment}{//\ Use\ inheritance\ to\ guarantee\ that\ a\ user\ data\ start\ on\ next\ cache\ line.}}
\DoxyCodeLine{00352\ \textcolor{comment}{//\ Can't\ use\ member\ for\ it,\ because\ when\ LocalBlockFields\ already\ on\ cache\ line,}}
\DoxyCodeLine{00353\ \textcolor{comment}{//\ we\ must\ have\ no\ additional\ memory\ consumption\ for\ all\ compilers.}}
\DoxyCodeLine{00354\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields}{LocalBlockFields}},}
\DoxyCodeLine{00355\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structrml_1_1internal_1_1_padding}{Padding}}<2*blockHeaderAlignment\ -\/\ sizeof(LocalBlockFields)>\ \{}
\DoxyCodeLine{00356\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00357\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classrml_1_1internal_1_1_block_a2a7ca914c507f4411cd9d8dd1bd63330}{empty}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00358\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a7d1d7c70675b3ba72924d1cbafd6772a}{allocatedCount}}\ >\ 0)\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00359\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(!\mbox{\hyperlink{namespacerml_1_1internal_acf31583c01d488b00e387c3bfcb23e34}{isSolidPtr}}(\mbox{\hyperlink{classrml_1_1internal_1_1_global_block_fields_a250f5629d8827f1821cd6a318d1d6b9b}{publicFreeList}}),\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}});}
\DoxyCodeLine{00360\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00361\ \ \ \ \ \}}
\DoxyCodeLine{00362\ \ \ \ \ \textcolor{keyword}{inline}\ \mbox{\hyperlink{structrml_1_1internal_1_1_free_object}{FreeObject}}*\ \mbox{\hyperlink{classrml_1_1internal_1_1_block_ab304c726e184fcd2cad31e30306e07ab}{allocate}}();}
\DoxyCodeLine{00363\ \ \ \ \ \textcolor{keyword}{inline}\ \mbox{\hyperlink{structrml_1_1internal_1_1_free_object}{FreeObject}}\ *\mbox{\hyperlink{classrml_1_1internal_1_1_block_a49c5382153edd22b031869f0a822f9f2}{allocateFromFreeList}}();}
\DoxyCodeLine{00364\ }
\DoxyCodeLine{00365\ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classrml_1_1internal_1_1_block_ab8c840097b1ff314c170187763e7aeaf}{adjustFullness}}();}
\DoxyCodeLine{00366\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1internal_1_1_block_a43f7aaa2170d48797fa410e8b694a683}{adjustPositionInBin}}(\mbox{\hyperlink{classrml_1_1internal_1_1_bin}{Bin}}*\ \mbox{\hyperlink{runtime_2spdlog_2include_2spdlog_2fmt_2bundled_2base_8h_adfa139c9a1902753b3696794759b2c48ac1111bd512b29e821b120b86446026b8}{bin}}\ =\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}});}
\DoxyCodeLine{00367\ }
\DoxyCodeLine{00368\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classrml_1_1internal_1_1_block_a624decb3bf1a4f7ab0b66e3ae0fb1324}{freeListNonNull}}()\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_ade8311f40ae3e9114518063032b7c42a}{freeList}};\ \}}
\DoxyCodeLine{00369\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1internal_1_1_block_a66007bf10cb5ca6edf3734362e285279}{freePublicObject}}(\mbox{\hyperlink{structrml_1_1internal_1_1_free_object}{FreeObject}}\ *objectToFree);}
\DoxyCodeLine{00370\ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1internal_1_1_block_a2aaa6c2e28d81fd7f29dda1079ba31b6}{freeOwnObject}}(\textcolor{keywordtype}{void}\ *\textcolor{keywordtype}{object});}
\DoxyCodeLine{00371\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1internal_1_1_block_a598d517a2307d2bfc16e2cba1784ad78}{reset}}();}
\DoxyCodeLine{00372\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1internal_1_1_block_ab857c7950fdfe4227d57ac948a02a215}{privatizePublicFreeList}}(\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classrml_1_1internal_1_1_block_a598d517a2307d2bfc16e2cba1784ad78}{reset}}\ =\ \textcolor{keyword}{true}\ );}
\DoxyCodeLine{00373\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1internal_1_1_block_a5df4dfd201e5dd98c7e542e2ed64d990}{restoreBumpPtr}}();}
\DoxyCodeLine{00374\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1internal_1_1_block_a4fe193f1c1e58be7a5a7be85dce62b2e}{privatizeOrphaned}}(\mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data}{TLSData}}\ *tls,\ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ab47dd9958bcadea08866b42bf358e95e}{index}});}
\DoxyCodeLine{00375\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classrml_1_1internal_1_1_block_a1216d6387c838e35475bc0fa3c5f2e21}{readyToShare}}();}
\DoxyCodeLine{00376\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1internal_1_1_block_a8ad4343ada0da1773726cd85581189a0}{shareOrphaned}}(intptr\_t\ binTag,\ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ab47dd9958bcadea08866b42bf358e95e}{index}});}
\DoxyCodeLine{00377\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classrml_1_1internal_1_1_block_a4d222fbb9aede736464e89f4e42efcf3}{getSize}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00378\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\mbox{\hyperlink{classrml_1_1internal_1_1_block_a3f8bba034d89886e7b2110cabab5e02c}{isStartupAllocObject}}()\ ||\ \mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a0e116178c7df6b87077b7b029a0fe653}{objectSize}}<\mbox{\hyperlink{namespacerml_1_1internal_ad778f7cb21fd95b85e36f2cf18d8fc60}{minLargeObjectSize}},}
\DoxyCodeLine{00379\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Invalid\ object\ size"{}});}
\DoxyCodeLine{00380\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classrml_1_1internal_1_1_block_a3f8bba034d89886e7b2110cabab5e02c}{isStartupAllocObject}}()?\ 0\ :\ \mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a0e116178c7df6b87077b7b029a0fe653}{objectSize}};}
\DoxyCodeLine{00381\ \ \ \ \ \}}
\DoxyCodeLine{00382\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classrml_1_1internal_1_1_back_ref_idx}{BackRefIdx}}\ *\mbox{\hyperlink{classrml_1_1internal_1_1_block_a3e5bded9feaecc0d3c5cacb5e859aa63}{getBackRefIdx}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \&\mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a11ce58dcddb3de047a57116d563d24ea}{backRefIdx}};\ \}}
\DoxyCodeLine{00383\ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classrml_1_1internal_1_1_block_a764948ac32e7d5689a755e4af99308e2}{isOwnedByCurrentThread}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00384\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classrml_1_1internal_1_1_block_a3f8bba034d89886e7b2110cabab5e02c}{isStartupAllocObject}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a0e116178c7df6b87077b7b029a0fe653}{objectSize}}\ ==\ \mbox{\hyperlink{namespacerml_1_1internal_a854b5f12c3c2951f100004bb161b3d4e}{startupAllocObjSizeMark}};\ \}}
\DoxyCodeLine{00385\ \ \ \ \ \textcolor{keyword}{inline}\ \mbox{\hyperlink{structrml_1_1internal_1_1_free_object}{FreeObject}}\ *\mbox{\hyperlink{classrml_1_1internal_1_1_block_a1cc1c9493f28b26a694f9206d2b82f3c}{findObjectToFree}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *\textcolor{keywordtype}{object})\ \textcolor{keyword}{const};}
\DoxyCodeLine{00386\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1internal_1_1_block_adb4bc8e99527a3f6f6c0252fd7d550f8}{checkFreePrecond}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *\textcolor{keywordtype}{object})\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00387\ \textcolor{preprocessor}{\#if\ MALLOC\_DEBUG}}
\DoxyCodeLine{00388\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *msg\ =\ \textcolor{stringliteral}{"{}Possible\ double\ free\ or\ heap\ corruption."{}};}
\DoxyCodeLine{00389\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ small\ objects\ are\ always\ at\ least\ sizeof(size\_t)\ Byte\ aligned,}}
\DoxyCodeLine{00390\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ try\ to\ check\ this\ before\ this\ dereference\ as\ for\ invalid\ objects}}
\DoxyCodeLine{00391\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ this\ may\ be\ unreadable}}
\DoxyCodeLine{00392\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\mbox{\hyperlink{_customize_8h_a717f2c2c0501922cd654a5ebf49b287e}{isAligned}}(\textcolor{keywordtype}{object},\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{size\_t})),\ \textcolor{stringliteral}{"{}Try\ to\ free\ invalid\ small\ object"{}});}
\DoxyCodeLine{00393\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ releasing\ to\ free\ slab}}
\DoxyCodeLine{00394\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a7d1d7c70675b3ba72924d1cbafd6772a}{allocatedCount}}>0,\ msg);}
\DoxyCodeLine{00395\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ must\ not\ point\ to\ slab's\ header}}
\DoxyCodeLine{00396\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}((uintptr\_t)\textcolor{keywordtype}{object}\ -\/\ (uintptr\_t)\textcolor{keyword}{this}\ >=\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}),\ msg);}
\DoxyCodeLine{00397\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacerml_1_1internal_a854b5f12c3c2951f100004bb161b3d4e}{startupAllocObjSizeMark}}\ ==\ \mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a0e116178c7df6b87077b7b029a0fe653}{objectSize}})\ \textcolor{comment}{//\ startup\ block}}
\DoxyCodeLine{00398\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\textcolor{keywordtype}{object}<=\mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a7539e25da68797f70368fa66e62e9c1c}{bumpPtr}},\ msg);}
\DoxyCodeLine{00399\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00400\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ non-\/startup\ objects\ are\ 8\ Byte\ aligned}}
\DoxyCodeLine{00401\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\mbox{\hyperlink{_customize_8h_a717f2c2c0501922cd654a5ebf49b287e}{isAligned}}(\textcolor{keywordtype}{object},\ 8),\ \textcolor{stringliteral}{"{}Try\ to\ free\ invalid\ small\ object"{}});}
\DoxyCodeLine{00402\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a7d1d7c70675b3ba72924d1cbafd6772a}{allocatedCount}}\ <=\ (\mbox{\hyperlink{namespacerml_1_1internal_ab92a44f5c0d4ae24554856afbba1943d}{slabSize}}-\/\textcolor{keyword}{sizeof}(\mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}))/\mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a0e116178c7df6b87077b7b029a0fe653}{objectSize}}}
\DoxyCodeLine{00403\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\&\ (!\mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a7539e25da68797f70368fa66e62e9c1c}{bumpPtr}}\ ||\ \textcolor{keywordtype}{object}>\mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a7539e25da68797f70368fa66e62e9c1c}{bumpPtr}}),\ msg);}
\DoxyCodeLine{00404\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structrml_1_1internal_1_1_free_object}{FreeObject}}\ *toFree\ =\ \mbox{\hyperlink{classrml_1_1internal_1_1_block_a1cc1c9493f28b26a694f9206d2b82f3c}{findObjectToFree}}(\textcolor{keywordtype}{object});}
\DoxyCodeLine{00405\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ check\ against\ head\ of\ freeList,\ as\ this\ is\ mostly}}
\DoxyCodeLine{00406\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ expected\ after\ double\ free}}
\DoxyCodeLine{00407\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(toFree\ !=\ \mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_ade8311f40ae3e9114518063032b7c42a}{freeList}},\ msg);}
\DoxyCodeLine{00408\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ check\ against\ head\ of\ publicFreeList,\ to\ detect\ double\ free}}
\DoxyCodeLine{00409\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ involving\ foreign\ thread}}
\DoxyCodeLine{00410\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(toFree\ !=\ \mbox{\hyperlink{classrml_1_1internal_1_1_global_block_fields_a250f5629d8827f1821cd6a318d1d6b9b}{publicFreeList}},\ msg);}
\DoxyCodeLine{00411\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00412\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00413\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacerml_1_1internal_acf3df9c7e1c2baec44e3dab2d8f1ee42}{suppress\_unused\_warning}}(\textcolor{keywordtype}{object});}
\DoxyCodeLine{00414\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00415\ \ \ \ \ \}}
\DoxyCodeLine{00416\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1internal_1_1_block_ac28a4338a88b594da0a1c4225e6c5d2e}{initEmptyBlock}}(\mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data}{TLSData}}\ *tls,\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}});}
\DoxyCodeLine{00417\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classrml_1_1internal_1_1_block_aa7dc2dc2c4549c010b30647f12fb8c60}{findObjectSize}}(\textcolor{keywordtype}{void}\ *\textcolor{keywordtype}{object})\ \textcolor{keyword}{const};}
\DoxyCodeLine{00418\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool}{MemoryPool}}\ *\mbox{\hyperlink{classrml_1_1internal_1_1_block_a0716dcf5a3897ed9e02741f3df418770}{getMemPool}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classrml_1_1internal_1_1_global_block_fields_a1039208fa5c6fc42be80bfeb59efcab8}{poolPtr}};\ \}\ \textcolor{comment}{//\ do\ not\ use\ on\ the\ hot\ path!}}
\DoxyCodeLine{00419\ }
\DoxyCodeLine{00420\ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00421\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1internal_1_1_block_a62edc0a79ebbbfff63671ad25b0561ba}{cleanBlockHeader}}();}
\DoxyCodeLine{00422\ }
\DoxyCodeLine{00423\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00424\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{float}\ \mbox{\hyperlink{classrml_1_1internal_1_1_block_aebbd21b8c6cb1b5c94b81443ba227237}{emptyEnoughRatio}};\ \textcolor{comment}{/*\ Threshold\ on\ free\ space\ needed\ to\ "{}reactivate"{}\ a\ block\ */}}
\DoxyCodeLine{00425\ }
\DoxyCodeLine{00426\ \ \ \ \ \textcolor{keyword}{inline}\ \mbox{\hyperlink{structrml_1_1internal_1_1_free_object}{FreeObject}}\ *\mbox{\hyperlink{classrml_1_1internal_1_1_block_a15badeb7c104a8f860a7375ed648a43e}{allocateFromBumpPtr}}();}
\DoxyCodeLine{00427\ \ \ \ \ \textcolor{keyword}{inline}\ \mbox{\hyperlink{structrml_1_1internal_1_1_free_object}{FreeObject}}\ *\mbox{\hyperlink{classrml_1_1internal_1_1_block_a40ba10a264d6930e09da78ecfc9034a7}{findAllocatedObject}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *\mbox{\hyperlink{ittnotify__static_8h_aee2b510694d56cbe27f47b65477e7049}{address}})\ \textcolor{keyword}{const};}
\DoxyCodeLine{00428\ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classrml_1_1internal_1_1_block_a0784348220b090a74a437cc7a61d0c88}{isProperlyPlaced}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *\textcolor{keywordtype}{object})\ \textcolor{keyword}{const};}
\DoxyCodeLine{00429\ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1internal_1_1_block_ae756f3bad7579cab3bf41552adb63bc2}{markOwned}}(\mbox{\hyperlink{classrml_1_1internal_1_1_block_ae3aa039820cf39eb9faa6a8e37ad5402}{TLSData}}\ *tls)\ \{}
\DoxyCodeLine{00430\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(!\mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_ac591e79d62cf0ee8907a3e60991d0734}{tlsPtr}},\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}});}
\DoxyCodeLine{00431\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a22b6910d3d56fd1183c5c4a1ed44e09f}{ownerTid}}\ =\ \mbox{\hyperlink{classrml_1_1internal_1_1_thread_id}{ThreadId}}();\ \textcolor{comment}{/*\ save\ the\ ID\ of\ the\ current\ thread\ */}}
\DoxyCodeLine{00432\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_ac591e79d62cf0ee8907a3e60991d0734}{tlsPtr}}\ =\ tls;}
\DoxyCodeLine{00433\ \ \ \ \ \}}
\DoxyCodeLine{00434\ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1internal_1_1_block_aeea6bb8d7c94c6e2647c1d3a18e85e79}{markOrphaned}}()\ \{}
\DoxyCodeLine{00435\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_ac591e79d62cf0ee8907a3e60991d0734}{tlsPtr}},\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}});}
\DoxyCodeLine{00436\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_ac591e79d62cf0ee8907a3e60991d0734}{tlsPtr}}\ =\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{00437\ \ \ \ \ \}}
\DoxyCodeLine{00438\ }
\DoxyCodeLine{00439\ \ \ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classrml_1_1internal_1_1_block_a6a6bc571688594aded1969d70ba65cce}{Bin}};}
\DoxyCodeLine{00440\ \ \ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classrml_1_1internal_1_1_block_ae3aa039820cf39eb9faa6a8e37ad5402}{TLSData}};}
\DoxyCodeLine{00441\ \ \ \ \ \textcolor{keyword}{friend}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_ac77d7b8f6b4cd31f7f3e49b0d7676196}{MemoryPool::destroy}}();}
\DoxyCodeLine{00442\ \};}
\DoxyCodeLine{00443\ }
\DoxyCodeLine{00444\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{float}\ \mbox{\hyperlink{classrml_1_1internal_1_1_block_aebbd21b8c6cb1b5c94b81443ba227237}{Block::emptyEnoughRatio}}\ =\ 1.0\ /\ 4.0;}
\DoxyCodeLine{00445\ }
\DoxyCodeLine{00446\ \mbox{\hyperlink{_customize_8h_a65d0dcc10d4bd982cf2171e170c01d14}{MALLOC\_STATIC\_ASSERT}}(\textcolor{keyword}{sizeof}(\mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}})\ <=\ 2*\mbox{\hyperlink{namespacerml_1_1internal_a559caa4a53713c2a95d8b28708ff1d77}{estimatedCacheLineSize}},}
\DoxyCodeLine{00447\ \ \ \ \ \textcolor{stringliteral}{"{}The\ class\ Block\ does\ not\ fit\ into\ 2\ cache\ lines\ on\ this\ platform.\ "{}}}
\DoxyCodeLine{00448\ \ \ \ \ \textcolor{stringliteral}{"{}Defining\ USE\_INTERNAL\_TID\ may\ help\ to\ fix\ it."{}});}
\DoxyCodeLine{00449\ }
\DoxyCodeLine{00450\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classrml_1_1internal_1_1_bin}{Bin}}\ \{}
\DoxyCodeLine{00451\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00452\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}\ \ \ \ \ \ *\mbox{\hyperlink{classrml_1_1internal_1_1_bin_ab97ae6d4fad5c846576164dcfc44702a}{activeBlk}};}
\DoxyCodeLine{00453\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}\ \ \ \ \ \ *\mbox{\hyperlink{classrml_1_1internal_1_1_bin_a97f756c491feed7e3704dca9aeebb935}{mailbox}};}
\DoxyCodeLine{00454\ \ \ \ \ \mbox{\hyperlink{class_malloc_mutex}{MallocMutex}}\ \mbox{\hyperlink{classrml_1_1internal_1_1_bin_a49898470723504724115b4fbdbee64fd}{mailLock}};}
\DoxyCodeLine{00455\ }
\DoxyCodeLine{00456\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00457\ \ \ \ \ \textcolor{keyword}{inline}\ \mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}*\ \mbox{\hyperlink{classrml_1_1internal_1_1_bin_a29d1714b17a9564d7759ffc8f6e61304}{getActiveBlock}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classrml_1_1internal_1_1_bin_ab97ae6d4fad5c846576164dcfc44702a}{activeBlk}};\ \}}
\DoxyCodeLine{00458\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1internal_1_1_bin_aa29fffd63036693e7b999971c9221d5b}{resetActiveBlock}}()\ \{\ \mbox{\hyperlink{classrml_1_1internal_1_1_bin_ab97ae6d4fad5c846576164dcfc44702a}{activeBlk}}\ =\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};\ \}}
\DoxyCodeLine{00459\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classrml_1_1internal_1_1_bin_a2710a8aee8b101868b17dc3a975c2a7c}{activeBlockUnused}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classrml_1_1internal_1_1_bin_ab97ae6d4fad5c846576164dcfc44702a}{activeBlk}}\ \&\&\ !\mbox{\hyperlink{classrml_1_1internal_1_1_bin_ab97ae6d4fad5c846576164dcfc44702a}{activeBlk}}-\/>allocatedCount;\ \}}
\DoxyCodeLine{00460\ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1internal_1_1_bin_a7c2d26793546cc9e053163731fdf43e5}{setActiveBlock}}(\mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}\ *\mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}});}
\DoxyCodeLine{00461\ \ \ \ \ \textcolor{keyword}{inline}\ \mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}*\ \mbox{\hyperlink{classrml_1_1internal_1_1_bin_adde6cbfe4fe734a4cfeef1626c327e9a}{setPreviousBlockActive}}();}
\DoxyCodeLine{00462\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}*\ \mbox{\hyperlink{classrml_1_1internal_1_1_bin_a94a64e0b7ab5ceec768dd8d976688898}{getPrivatizedFreeListBlock}}();}
\DoxyCodeLine{00463\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1internal_1_1_bin_a0e3087b9eb6233c7f5a7598508dcbeae}{moveBlockToFront}}(\mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}\ *\mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}});}
\DoxyCodeLine{00464\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classrml_1_1internal_1_1_bin_aef8a87646221418bd9c2bf67afb86c1a}{cleanPublicFreeLists}}();}
\DoxyCodeLine{00465\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1internal_1_1_bin_a0c2e5eadb3e68467ee5635ab367abd46}{processEmptyBlock}}(\mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}\ *\mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}},\ \textcolor{keywordtype}{bool}\ poolTheBlock);}
\DoxyCodeLine{00466\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1internal_1_1_bin_a581a3ea96dae969984084a00200e2d35}{addPublicFreeListBlock}}(\mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}*\ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}});}
\DoxyCodeLine{00467\ }
\DoxyCodeLine{00468\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1internal_1_1_bin_adb853b6ddddbdbaff1ce9fbdbd560f40}{outofTLSBin}}(\mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}*\ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}});}
\DoxyCodeLine{00469\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1internal_1_1_bin_a1ec1f87fab1f4e4f36bb401ce5c4bb87}{verifyTLSBin}}(\textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}})\ \textcolor{keyword}{const};}
\DoxyCodeLine{00470\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1internal_1_1_bin_a88e5bf9d3eb59a30e58f3dc23e240d4e}{pushTLSBin}}(\mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}*\ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}});}
\DoxyCodeLine{00471\ }
\DoxyCodeLine{00472\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1internal_1_1_bin_ad3fb9d711bc5b20aac1ac4667d505a13}{verifyInitState}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00473\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ !\mbox{\hyperlink{classrml_1_1internal_1_1_bin_ab97ae6d4fad5c846576164dcfc44702a}{activeBlk}},\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );}
\DoxyCodeLine{00474\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ !\mbox{\hyperlink{classrml_1_1internal_1_1_bin_a97f756c491feed7e3704dca9aeebb935}{mailbox}},\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );}
\DoxyCodeLine{00475\ \ \ \ \ \}}
\DoxyCodeLine{00476\ }
\DoxyCodeLine{00477\ \ \ \ \ \textcolor{keyword}{friend}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1internal_1_1_block_a66007bf10cb5ca6edf3734362e285279}{Block::freePublicObject}}\ (\mbox{\hyperlink{structrml_1_1internal_1_1_free_object}{FreeObject}}\ *objectToFree);}
\DoxyCodeLine{00478\ \};}
\DoxyCodeLine{00479\ }
\DoxyCodeLine{00480\ \textcolor{comment}{/*********\ End\ of\ the\ data\ structures\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ **************/}}
\DoxyCodeLine{00481\ }
\DoxyCodeLine{00482\ \textcolor{comment}{/*}}
\DoxyCodeLine{00483\ \textcolor{comment}{\ *\ There\ are\ bins\ for\ all\ 8\ byte\ aligned\ objects\ less\ than\ this\ segregated\ size;\ 8\ bins\ in\ total}}
\DoxyCodeLine{00484\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00485\ \textcolor{keyword}{const}\ \mbox{\hyperlink{eabase_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t}}\ \mbox{\hyperlink{namespacerml_1_1internal_a18358a6bfe6b087714651e07abbab609}{minSmallObjectIndex}}\ =\ 0;}
\DoxyCodeLine{00486\ \textcolor{keyword}{const}\ \mbox{\hyperlink{eabase_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t}}\ \mbox{\hyperlink{namespacerml_1_1internal_a96a693506773ae9cf214a9b0bce7eb10}{numSmallObjectBins}}\ =\ 8;}
\DoxyCodeLine{00487\ \textcolor{keyword}{const}\ \mbox{\hyperlink{eabase_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t}}\ \mbox{\hyperlink{namespacerml_1_1internal_a8b248c08cf434752fdb37a696f9dd7c9}{maxSmallObjectSize}}\ =\ 64;}
\DoxyCodeLine{00488\ }
\DoxyCodeLine{00489\ \textcolor{comment}{/*}}
\DoxyCodeLine{00490\ \textcolor{comment}{\ *\ There\ are\ 4\ bins\ between\ each\ couple\ of\ powers\ of\ 2\ [64-\/128-\/256-\/...]}}
\DoxyCodeLine{00491\ \textcolor{comment}{\ *\ from\ maxSmallObjectSize\ till\ this\ size;\ 16\ bins\ in\ total}}
\DoxyCodeLine{00492\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00493\ \textcolor{keyword}{const}\ \mbox{\hyperlink{eabase_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t}}\ \mbox{\hyperlink{namespacerml_1_1internal_a3228789e0905a650368b88c83cc7e255}{minSegregatedObjectIndex}}\ =\ \mbox{\hyperlink{namespacerml_1_1internal_a18358a6bfe6b087714651e07abbab609}{minSmallObjectIndex}}+\mbox{\hyperlink{namespacerml_1_1internal_a96a693506773ae9cf214a9b0bce7eb10}{numSmallObjectBins}};}
\DoxyCodeLine{00494\ \textcolor{keyword}{const}\ \mbox{\hyperlink{eabase_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t}}\ \mbox{\hyperlink{namespacerml_1_1internal_ad712c1c4a8c3a81480e0fbc194ec48c9}{numSegregatedObjectBins}}\ =\ 16;}
\DoxyCodeLine{00495\ \textcolor{keyword}{const}\ \mbox{\hyperlink{eabase_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t}}\ \mbox{\hyperlink{namespacerml_1_1internal_ac18775d0814a506927c2bb6b978a1d73}{maxSegregatedObjectSize}}\ =\ 1024;}
\DoxyCodeLine{00496\ }
\DoxyCodeLine{00497\ \textcolor{comment}{/*}}
\DoxyCodeLine{00498\ \textcolor{comment}{\ *\ And\ there\ are\ 5\ bins\ with\ allocation\ sizes\ that\ are\ multiples\ of\ estimatedCacheLineSize}}
\DoxyCodeLine{00499\ \textcolor{comment}{\ *\ and\ selected\ to\ fit\ 9,\ 6,\ 4,\ 3,\ and\ 2\ allocations\ in\ a\ block.}}
\DoxyCodeLine{00500\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00501\ \textcolor{keyword}{const}\ \mbox{\hyperlink{eabase_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t}}\ \mbox{\hyperlink{namespacerml_1_1internal_af911b4fc0cfbb7dffb74bcd3027515ae}{minFittingIndex}}\ =\ \mbox{\hyperlink{namespacerml_1_1internal_a3228789e0905a650368b88c83cc7e255}{minSegregatedObjectIndex}}+\mbox{\hyperlink{namespacerml_1_1internal_ad712c1c4a8c3a81480e0fbc194ec48c9}{numSegregatedObjectBins}};}
\DoxyCodeLine{00502\ \textcolor{keyword}{const}\ \mbox{\hyperlink{eabase_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t}}\ \mbox{\hyperlink{namespacerml_1_1internal_a8d5b054ff5273f9f6f271512835c47af}{numFittingBins}}\ =\ 5;}
\DoxyCodeLine{00503\ }
\DoxyCodeLine{00504\ \textcolor{keyword}{const}\ \mbox{\hyperlink{eabase_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t}}\ \mbox{\hyperlink{namespacerml_1_1internal_ab092ca824bbb860a4cb0153229864bb7}{fittingAlignment}}\ =\ \mbox{\hyperlink{namespacerml_1_1internal_a559caa4a53713c2a95d8b28708ff1d77}{estimatedCacheLineSize}};}
\DoxyCodeLine{00505\ }
\DoxyCodeLine{00506\ \textcolor{preprocessor}{\#define\ SET\_FITTING\_SIZE(N)\ (\ (slabSize-\/sizeof(Block))/N\ )\ \&\ \string~(fittingAlignment-\/1)}}
\DoxyCodeLine{00507\ \textcolor{comment}{//\ For\ blockSize=16*1024,\ sizeof(Block)=2*estimatedCacheLineSize\ and\ fittingAlignment=estimatedCacheLineSize,}}
\DoxyCodeLine{00508\ \textcolor{comment}{//\ the\ comments\ show\ the\ fitting\ sizes\ and\ the\ amounts\ left\ unused\ for\ estimatedCacheLineSize=64/128:}}
\DoxyCodeLine{00509\ \textcolor{keyword}{const}\ \mbox{\hyperlink{eabase_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t}}\ \mbox{\hyperlink{namespacerml_1_1internal_abf9b6a55c23ce9d253f4fd134682b002}{fittingSize1}}\ =\ \mbox{\hyperlink{frontend_8cpp_aea46ff4058905e3cc2e8202c7224e387}{SET\_FITTING\_SIZE}}(9);\ \textcolor{comment}{//\ 1792/1792\ 128/000}}
\DoxyCodeLine{00510\ \textcolor{keyword}{const}\ \mbox{\hyperlink{eabase_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t}}\ \mbox{\hyperlink{namespacerml_1_1internal_a5a758b17d8a8e8f0a94b43645be7e539}{fittingSize2}}\ =\ \mbox{\hyperlink{frontend_8cpp_aea46ff4058905e3cc2e8202c7224e387}{SET\_FITTING\_SIZE}}(6);\ \textcolor{comment}{//\ 2688/2688\ 128/000}}
\DoxyCodeLine{00511\ \textcolor{keyword}{const}\ \mbox{\hyperlink{eabase_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t}}\ \mbox{\hyperlink{namespacerml_1_1internal_a204e4db26e6fbb0756f15ad673101c2a}{fittingSize3}}\ =\ \mbox{\hyperlink{frontend_8cpp_aea46ff4058905e3cc2e8202c7224e387}{SET\_FITTING\_SIZE}}(4);\ \textcolor{comment}{//\ 4032/3968\ 128/256}}
\DoxyCodeLine{00512\ \textcolor{keyword}{const}\ \mbox{\hyperlink{eabase_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t}}\ \mbox{\hyperlink{namespacerml_1_1internal_aa61277b9cc18c3279cd1b02026bba7b7}{fittingSize4}}\ =\ \mbox{\hyperlink{frontend_8cpp_aea46ff4058905e3cc2e8202c7224e387}{SET\_FITTING\_SIZE}}(3);\ \textcolor{comment}{//\ 5376/5376\ 128/000}}
\DoxyCodeLine{00513\ \textcolor{keyword}{const}\ \mbox{\hyperlink{eabase_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t}}\ \mbox{\hyperlink{namespacerml_1_1internal_a353e5d7e5844beb88452a87ddd86c27f}{fittingSize5}}\ =\ \mbox{\hyperlink{frontend_8cpp_aea46ff4058905e3cc2e8202c7224e387}{SET\_FITTING\_SIZE}}(2);\ \textcolor{comment}{//\ 8128/8064\ 000/000}}
\DoxyCodeLine{00514\ \textcolor{preprocessor}{\#undef\ SET\_FITTING\_SIZE}}
\DoxyCodeLine{00515\ }
\DoxyCodeLine{00516\ \textcolor{comment}{/*}}
\DoxyCodeLine{00517\ \textcolor{comment}{\ *\ The\ total\ number\ of\ thread-\/specific\ Block-\/based\ bins}}
\DoxyCodeLine{00518\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00519\ \textcolor{keyword}{const}\ \mbox{\hyperlink{eabase_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t}}\ \mbox{\hyperlink{namespacerml_1_1internal_a21c3f916c95516a91553eb2d3cf8a190}{numBlockBins}}\ =\ \mbox{\hyperlink{namespacerml_1_1internal_af911b4fc0cfbb7dffb74bcd3027515ae}{minFittingIndex}}+\mbox{\hyperlink{namespacerml_1_1internal_a8d5b054ff5273f9f6f271512835c47af}{numFittingBins}};}
\DoxyCodeLine{00520\ }
\DoxyCodeLine{00521\ \textcolor{comment}{/*}}
\DoxyCodeLine{00522\ \textcolor{comment}{\ *\ Objects\ of\ this\ size\ and\ larger\ are\ considered\ large\ objects.}}
\DoxyCodeLine{00523\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00524\ \textcolor{keyword}{const}\ \mbox{\hyperlink{eabase_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t}}\ \mbox{\hyperlink{namespacerml_1_1internal_ad778f7cb21fd95b85e36f2cf18d8fc60}{minLargeObjectSize}}\ =\ \mbox{\hyperlink{namespacerml_1_1internal_a353e5d7e5844beb88452a87ddd86c27f}{fittingSize5}}\ +\ 1;}
\DoxyCodeLine{00525\ }
\DoxyCodeLine{00526\ \textcolor{comment}{/*}}
\DoxyCodeLine{00527\ \textcolor{comment}{\ *\ Per-\/thread\ pool\ of\ slab\ blocks.\ Idea\ behind\ it\ is\ to\ not\ share\ with\ other}}
\DoxyCodeLine{00528\ \textcolor{comment}{\ *\ threads\ memory\ that\ are\ likely\ in\ local\ cache(s)\ of\ our\ CPU.}}
\DoxyCodeLine{00529\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00530\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classrml_1_1internal_1_1_free_block_pool_aad05cb886a99827d6c90b58d0707e2f9}{FreeBlockPool}}\ \{}
\DoxyCodeLine{00531\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00532\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}\ \ \ \ \ \ *\mbox{\hyperlink{classrml_1_1internal_1_1_free_block_pool_a8646628c2c30186529369da707f2be8e}{head}};}
\DoxyCodeLine{00533\ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_free_block_pool_adac9c11cb2c7c28ecd96c8eb3ff0d0fc}{size}};}
\DoxyCodeLine{00534\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_backend}{Backend}}\ \ \ \ *\mbox{\hyperlink{classrml_1_1internal_1_1_free_block_pool_a52e4839e46d27b38fb31b9d5fb4658fa}{backend}};}
\DoxyCodeLine{00535\ \ \ \ \ \textcolor{keywordtype}{bool}\ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_free_block_pool_a1d7dfb06f6a6dbe236defdaae637fc37}{lastAccessMiss}};}
\DoxyCodeLine{00536\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00537\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classrml_1_1internal_1_1_free_block_pool_a6e0b38bdab3a76180e356b4707320b73}{POOL\_HIGH\_MARK}}\ =\ 32;}
\DoxyCodeLine{00538\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classrml_1_1internal_1_1_free_block_pool_a4966b4cf11130701d61cc63b4385054a}{POOL\_LOW\_MARK}}\ \ =\ 8;}
\DoxyCodeLine{00539\ }
\DoxyCodeLine{00540\ \ \ \ \ \textcolor{keyword}{class\ }\mbox{\hyperlink{classrml_1_1internal_1_1_free_block_pool_1_1_res_of_get_a596d835416b69621180a8d3c877816ea}{ResOfGet}}\ \{}
\DoxyCodeLine{00541\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_free_block_pool_1_1_res_of_get_a596d835416b69621180a8d3c877816ea}{ResOfGet}}();}
\DoxyCodeLine{00542\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00543\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}*\ \mbox{\hyperlink{classrml_1_1internal_1_1_free_block_pool_1_1_res_of_get_ac96452c87d5f9a987af40afbf216133e}{block}};}
\DoxyCodeLine{00544\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_free_block_pool_1_1_res_of_get_aa3699ac885699fdbb8952de8d20dc128}{lastAccMiss}};}
\DoxyCodeLine{00545\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_free_block_pool_1_1_res_of_get_a384e753602287d2db88b8d2ecfd30c0e}{ResOfGet}}(\mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}\ *\mbox{\hyperlink{offscreen_8c_a846c9667e34d56c560bb7f0ac6e173f6}{b}},\ \textcolor{keywordtype}{bool}\ lastMiss)\ :\ \mbox{\hyperlink{classrml_1_1internal_1_1_free_block_pool_1_1_res_of_get_ac96452c87d5f9a987af40afbf216133e}{block}}(\mbox{\hyperlink{offscreen_8c_a846c9667e34d56c560bb7f0ac6e173f6}{b}}),\ \mbox{\hyperlink{classrml_1_1internal_1_1_free_block_pool_1_1_res_of_get_aa3699ac885699fdbb8952de8d20dc128}{lastAccMiss}}(lastMiss)\ \{\}}
\DoxyCodeLine{00546\ \ \ \ \ \};}
\DoxyCodeLine{00547\ }
\DoxyCodeLine{00548\ \ \ \ \ \textcolor{comment}{//\ allocated\ in\ zero-\/initialized\ memory}}
\DoxyCodeLine{00549\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_free_block_pool_aad05cb886a99827d6c90b58d0707e2f9}{FreeBlockPool}}(\mbox{\hyperlink{classrml_1_1internal_1_1_backend}{Backend}}\ *bknd)\ :\ \mbox{\hyperlink{classrml_1_1internal_1_1_free_block_pool_a52e4839e46d27b38fb31b9d5fb4658fa}{backend}}(bknd)\ \{\}}
\DoxyCodeLine{00550\ \ \ \ \ ResOfGet\ \mbox{\hyperlink{classrml_1_1internal_1_1_free_block_pool_a3d6745e31d1a809ce90273ba7a8f8ab7}{getBlock}}();}
\DoxyCodeLine{00551\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1internal_1_1_free_block_pool_a98adf682213916f2d39812b170938b4a}{returnBlock}}(\mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}\ *\mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}});}
\DoxyCodeLine{00552\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classrml_1_1internal_1_1_free_block_pool_ab61c0024cb476fa6efa9748f257bfa39}{externalCleanup}}();\ \textcolor{comment}{//\ can\ be\ called\ by\ another\ thread}}
\DoxyCodeLine{00553\ \};}
\DoxyCodeLine{00554\ }
\DoxyCodeLine{00555\ \textcolor{keyword}{template}<\textcolor{keywordtype}{int}\ LOW\_MARK,\ \textcolor{keywordtype}{int}\ HIGH\_MARK>}
\DoxyCodeLine{00556\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classrml_1_1internal_1_1_local_l_o_c_impl}{LocalLOCImpl}}\ \{}
\DoxyCodeLine{00557\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00558\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classrml_1_1internal_1_1_local_l_o_c_impl_a75ab70d6b13d0081f21321cebabf92d7}{MAX\_TOTAL\_SIZE}}\ =\ 4*1024*1024;}
\DoxyCodeLine{00559\ \ \ \ \ \textcolor{comment}{//\ TODO:\ can\ single-\/linked\ list\ be\ faster\ here?}}
\DoxyCodeLine{00560\ \ \ \ \ \mbox{\hyperlink{structrml_1_1internal_1_1_large_memory_block}{LargeMemoryBlock}}\ *\mbox{\hyperlink{classrml_1_1internal_1_1_local_l_o_c_impl_a42dc1bb7ca50c46791c015e107820d5c}{head}},}
\DoxyCodeLine{00561\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\mbox{\hyperlink{classrml_1_1internal_1_1_local_l_o_c_impl_ac6b24420fcae56ca954f907d46fa9678}{tail}};\ \textcolor{comment}{//\ need\ it\ when\ do\ releasing\ on\ overflow}}
\DoxyCodeLine{00562\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_local_l_o_c_impl_a2d83f04b433f716840a043e29e4d893b}{totalSize}};}
\DoxyCodeLine{00563\ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_local_l_o_c_impl_a2a0f7261a6ffabdd3e06006c135ecf01}{numOfBlocks}};}
\DoxyCodeLine{00564\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00565\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classrml_1_1internal_1_1_local_l_o_c_impl_a40f0e9cea1a99d95d786f52e2dc8add9}{put}}(\mbox{\hyperlink{structrml_1_1internal_1_1_large_memory_block}{LargeMemoryBlock}}\ *\textcolor{keywordtype}{object},\ \mbox{\hyperlink{structrml_1_1internal_1_1_ext_memory_pool}{ExtMemoryPool}}\ *extMemPool);}
\DoxyCodeLine{00566\ \ \ \ \ \mbox{\hyperlink{structrml_1_1internal_1_1_large_memory_block}{LargeMemoryBlock}}\ *\mbox{\hyperlink{classrml_1_1internal_1_1_local_l_o_c_impl_af40a0514dcc47ac4ceccfea084adb199}{get}}(\textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}});}
\DoxyCodeLine{00567\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classrml_1_1internal_1_1_local_l_o_c_impl_a80e3527b3fb859a937366335f05832f5}{externalCleanup}}(\mbox{\hyperlink{structrml_1_1internal_1_1_ext_memory_pool}{ExtMemoryPool}}\ *extMemPool);}
\DoxyCodeLine{00568\ \textcolor{preprocessor}{\#if\ \_\_TBB\_MALLOC\_WHITEBOX\_TEST}}
\DoxyCodeLine{00569\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_local_l_o_c_impl}{LocalLOCImpl}}()\ :\ \mbox{\hyperlink{classrml_1_1internal_1_1_local_l_o_c_impl_a42dc1bb7ca50c46791c015e107820d5c}{head}}(\mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}}),\ \mbox{\hyperlink{classrml_1_1internal_1_1_local_l_o_c_impl_ac6b24420fcae56ca954f907d46fa9678}{tail}}(\mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}}),\ \mbox{\hyperlink{classrml_1_1internal_1_1_local_l_o_c_impl_a2d83f04b433f716840a043e29e4d893b}{totalSize}}(0),\ \mbox{\hyperlink{classrml_1_1internal_1_1_local_l_o_c_impl_a2a0f7261a6ffabdd3e06006c135ecf01}{numOfBlocks}}(0)\ \{\}}
\DoxyCodeLine{00570\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{size\_t}\ getMaxSize()\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classrml_1_1internal_1_1_local_l_o_c_impl_a75ab70d6b13d0081f21321cebabf92d7}{MAX\_TOTAL\_SIZE}};\ \}}
\DoxyCodeLine{00571\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ LOC\_HIGH\_MARK\ =\ HIGH\_MARK;}
\DoxyCodeLine{00572\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00573\ \ \ \ \ \textcolor{comment}{//\ no\ ctor,\ object\ must\ be\ created\ in\ zero-\/initialized\ memory}}
\DoxyCodeLine{00574\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00575\ \};}
\DoxyCodeLine{00576\ }
\DoxyCodeLine{00577\ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{classrml_1_1internal_1_1_local_l_o_c_impl}{LocalLOCImpl<8,32>}}\ \mbox{\hyperlink{namespacerml_1_1internal_ac3339c3b381d3cc712c0c6fe8d2ead80}{LocalLOC}};\ \textcolor{comment}{//\ set\ production\ code\ parameters}}
\DoxyCodeLine{00578\ }
\DoxyCodeLine{00579\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data_a490eaf67a7d5bc706cb128d5f39f051d}{TLSData}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{structrml_1_1internal_1_1_t_l_s_remote}{TLSRemote}}\ \{}
\DoxyCodeLine{00580\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool}{MemoryPool}}\ \ \ *\mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data_ab364147df477e80294c59a9b9ff79d53}{memPool}};}
\DoxyCodeLine{00581\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00582\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_bin}{Bin}}\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data_a140deb931bef016f17cacae4ec0754c3}{bin}}[\mbox{\hyperlink{namespacerml_1_1internal_af9e9162c10034b03b23d5734de443213}{numBlockBinLimit}}];}
\DoxyCodeLine{00583\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_free_block_pool}{FreeBlockPool}}\ \mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data_a00be57391bf8297f48bab787f963f666}{freeSlabBlocks}};}
\DoxyCodeLine{00584\ \ \ \ \ \mbox{\hyperlink{namespacerml_1_1internal_ac3339c3b381d3cc712c0c6fe8d2ead80}{LocalLOC}}\ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data_a9cc38b7f838e548d0fbac8d3a194b2cf}{lloc}};}
\DoxyCodeLine{00585\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data_a0afea8877687495caf569889c796d535}{currCacheIdx}};}
\DoxyCodeLine{00586\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00587\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data_a68f2f49ad5b87e6a7d5ce0f911f22627}{unused}};}
\DoxyCodeLine{00588\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00589\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data_a490eaf67a7d5bc706cb128d5f39f051d}{TLSData}}(\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool}{MemoryPool}}\ *mPool,\ \mbox{\hyperlink{classrml_1_1internal_1_1_backend}{Backend}}\ *bknd)\ :\ \mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data_ab364147df477e80294c59a9b9ff79d53}{memPool}}(mPool),\ \mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data_a00be57391bf8297f48bab787f963f666}{freeSlabBlocks}}(bknd)\ \{\}}
\DoxyCodeLine{00590\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool}{MemoryPool}}\ *\mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data_aaec35d80922e4d30a6de64d5fa5d9d7f}{getMemPool}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data_ab364147df477e80294c59a9b9ff79d53}{memPool}};\ \}}
\DoxyCodeLine{00591\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_bin}{Bin}}*\ \mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data_a26c607a6304c0fa325c6604cf7c767ea}{getAllocationBin}}(\textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}});}
\DoxyCodeLine{00592\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data_a782f29462cd5eaf08ad7beec48e88761}{release}}();}
\DoxyCodeLine{00593\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data_a6249ba2f15b82c002a6b82a731ad09b0}{externalCleanup}}(\textcolor{keywordtype}{bool}\ cleanOnlyUnused,\ \textcolor{keywordtype}{bool}\ cleanBins)\ \{}
\DoxyCodeLine{00594\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data_a68f2f49ad5b87e6a7d5ce0f911f22627}{unused}}\ \&\&\ cleanOnlyUnused)\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00595\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Heavy\ operation\ in\ terms\ of\ synchronization\ complexity,}}
\DoxyCodeLine{00596\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ should\ be\ called\ only\ for\ the\ current\ thread}}
\DoxyCodeLine{00597\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ released\ =\ cleanBins\ ?\ \mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data_ab0dcc7bbaf1f93e63b64c0ee00e4e74b}{cleanupBlockBins}}()\ :\ \textcolor{keyword}{false};}
\DoxyCodeLine{00598\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ both\ cleanups\ to\ be\ called,\ and\ the\ order\ is\ not\ important}}
\DoxyCodeLine{00599\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ released\ |\ \mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data_a9cc38b7f838e548d0fbac8d3a194b2cf}{lloc}}.externalCleanup(\&\mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data_ab364147df477e80294c59a9b9ff79d53}{memPool}}-\/>extMemPool)\ |\ \mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data_a00be57391bf8297f48bab787f963f666}{freeSlabBlocks}}.externalCleanup();}
\DoxyCodeLine{00600\ \ \ \ \ \}}
\DoxyCodeLine{00601\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data_ab0dcc7bbaf1f93e63b64c0ee00e4e74b}{cleanupBlockBins}}();}
\DoxyCodeLine{00602\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data_afabda6a63ddb1942d1d5a7a06f41e2ae}{markUsed}}()\ \{\ \mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data_a68f2f49ad5b87e6a7d5ce0f911f22627}{unused}}\ =\ \textcolor{keyword}{false};\ \}\ \textcolor{comment}{//\ called\ by\ owner\ when\ TLS\ touched}}
\DoxyCodeLine{00603\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data_a2dbe4c6ad60bc541ce0bff6274fa35b0}{markUnused}}()\ \{\ \mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data_a68f2f49ad5b87e6a7d5ce0f911f22627}{unused}}\ =\ \ \textcolor{keyword}{true};\ \}\ \textcolor{comment}{//\ can\ be\ called\ by\ not\ owner\ thread}}
\DoxyCodeLine{00604\ \};}
\DoxyCodeLine{00605\ }
\DoxyCodeLine{00606\ \mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data}{TLSData}}\ *\mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_key_a06d9e3bc08d87039bdcc081d3b6b10cb}{TLSKey::createTLS}}(\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool}{MemoryPool}}\ *memPool,\ \mbox{\hyperlink{classrml_1_1internal_1_1_backend}{Backend}}\ *backend)}
\DoxyCodeLine{00607\ \{}
\DoxyCodeLine{00608\ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data}{TLSData}})\ >=\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{classrml_1_1internal_1_1_bin}{Bin}})\ *\ \mbox{\hyperlink{namespacerml_1_1internal_a21c3f916c95516a91553eb2d3cf8a190}{numBlockBins}}\ +\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{classrml_1_1internal_1_1_free_block_pool}{FreeBlockPool}}),\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );}
\DoxyCodeLine{00609\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data}{TLSData}}*\ tls\ =\ (\mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data}{TLSData}}*)\ memPool-\/>\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_ab6031f40ff7011e056db5052cd88de22}{bootStrapBlocks}}.\mbox{\hyperlink{classrml_1_1internal_1_1_boot_strap_blocks_ac04f5dfb5527488b55c491957dc8ec66}{allocate}}(memPool,\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data}{TLSData}}));}
\DoxyCodeLine{00610\ \ \ \ \ \textcolor{keywordflow}{if}\ (\ !tls\ )}
\DoxyCodeLine{00611\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{00612\ \ \ \ \ \textcolor{keyword}{new}(tls)\ \mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data}{TLSData}}(memPool,\ backend);}
\DoxyCodeLine{00613\ \ \ \ \ \textcolor{comment}{/*\ the\ block\ contains\ zeroes\ after\ bootStrapMalloc,\ so\ bins\ are\ initialized\ */}}
\DoxyCodeLine{00614\ \textcolor{preprocessor}{\#if\ MALLOC\_DEBUG}}
\DoxyCodeLine{00615\ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{eabase_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t}}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ =\ 0;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ <\ \mbox{\hyperlink{namespacerml_1_1internal_af9e9162c10034b03b23d5734de443213}{numBlockBinLimit}};\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}++)}
\DoxyCodeLine{00616\ \ \ \ \ \ \ \ \ tls-\/>\mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data_a140deb931bef016f17cacae4ec0754c3}{bin}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}].\mbox{\hyperlink{classrml_1_1internal_1_1_bin_ad3fb9d711bc5b20aac1ac4667d505a13}{verifyInitState}}();}
\DoxyCodeLine{00617\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00618\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_key_af482c91d6b8aff61e3a45c4a41cf09c9}{setThreadMallocTLS}}(tls);}
\DoxyCodeLine{00619\ \ \ \ \ memPool-\/>\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_a93f7cd65f7ae8f1608a846cded95cd7c}{extMemPool}}.\mbox{\hyperlink{structrml_1_1internal_1_1_ext_memory_pool_abfc19fab46f65ebb79992d2950494fc3}{allLocalCaches}}.\mbox{\hyperlink{classrml_1_1internal_1_1_all_local_caches_ad7176ca94d2801b0d12f1d487a05c6aa}{registerThread}}(tls);}
\DoxyCodeLine{00620\ \ \ \ \ \textcolor{keywordflow}{return}\ tls;}
\DoxyCodeLine{00621\ \}}
\DoxyCodeLine{00622\ }
\DoxyCodeLine{00623\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data_ab0dcc7bbaf1f93e63b64c0ee00e4e74b}{TLSData::cleanupBlockBins}}()}
\DoxyCodeLine{00624\ \{}
\DoxyCodeLine{00625\ \ \ \ \ \textcolor{keywordtype}{bool}\ released\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00626\ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{eabase_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t}}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ =\ 0;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ <\ \mbox{\hyperlink{namespacerml_1_1internal_af9e9162c10034b03b23d5734de443213}{numBlockBinLimit}};\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}++)\ \{}
\DoxyCodeLine{00627\ \ \ \ \ \ \ \ \ released\ |=\ \mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data_a140deb931bef016f17cacae4ec0754c3}{bin}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}].cleanPublicFreeLists();}
\DoxyCodeLine{00628\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ After\ cleaning\ public\ free\ lists,\ only\ the\ active\ block\ might\ be\ empty.}}
\DoxyCodeLine{00629\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Do\ not\ use\ processEmptyBlock\ because\ it\ will\ just\ restore\ bumpPtr.}}
\DoxyCodeLine{00630\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}\ *\mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}\ =\ \mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data_a140deb931bef016f17cacae4ec0754c3}{bin}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}].getActiveBlock();}
\DoxyCodeLine{00631\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}\ \&\&\ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}-\/>empty())\ \{}
\DoxyCodeLine{00632\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data_a140deb931bef016f17cacae4ec0754c3}{bin}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}].outofTLSBin(\mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}});}
\DoxyCodeLine{00633\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data_ab364147df477e80294c59a9b9ff79d53}{memPool}}-\/>returnEmptyBlock(\mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}},\ \textcolor{comment}{/*poolTheBlock=*/}\textcolor{keyword}{false});}
\DoxyCodeLine{00634\ \ \ \ \ \ \ \ \ \ \ \ \ released\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00635\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00636\ \ \ \ \ \}}
\DoxyCodeLine{00637\ \ \ \ \ \textcolor{keywordflow}{return}\ released;}
\DoxyCodeLine{00638\ \}}
\DoxyCodeLine{00639\ }
\DoxyCodeLine{00640\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{structrml_1_1internal_1_1_ext_memory_pool_a47b9aace2f0d1d465a4aa47a489c464b}{ExtMemoryPool::releaseAllLocalCaches}}()}
\DoxyCodeLine{00641\ \{}
\DoxyCodeLine{00642\ \ \ \ \ \textcolor{comment}{//\ Iterate\ all\ registered\ TLS\ data\ and\ clean\ LLOC\ and\ Slab\ pools}}
\DoxyCodeLine{00643\ \ \ \ \ \textcolor{keywordtype}{bool}\ released\ =\ \mbox{\hyperlink{structrml_1_1internal_1_1_ext_memory_pool_abfc19fab46f65ebb79992d2950494fc3}{allLocalCaches}}.cleanup(\textcolor{comment}{/*cleanOnlyUnused=*/}\textcolor{keyword}{false});}
\DoxyCodeLine{00644\ }
\DoxyCodeLine{00645\ \ \ \ \ \textcolor{comment}{//\ Bins\ privatization\ is\ done\ only\ for\ the\ current\ thread}}
\DoxyCodeLine{00646\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data}{TLSData}}\ *tlsData\ =\ \mbox{\hyperlink{structrml_1_1internal_1_1_ext_memory_pool_a8b3cd2c2364c73142c7eed261fa14be3}{tlsPointerKey}}.getThreadMallocTLS())}
\DoxyCodeLine{00647\ \ \ \ \ \ \ \ \ released\ |=\ tlsData-\/>cleanupBlockBins();}
\DoxyCodeLine{00648\ }
\DoxyCodeLine{00649\ \ \ \ \ \textcolor{keywordflow}{return}\ released;}
\DoxyCodeLine{00650\ \}}
\DoxyCodeLine{00651\ }
\DoxyCodeLine{00652\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1internal_1_1_all_local_caches_ad7176ca94d2801b0d12f1d487a05c6aa}{AllLocalCaches::registerThread}}(\mbox{\hyperlink{structrml_1_1internal_1_1_t_l_s_remote}{TLSRemote}}\ *tls)}
\DoxyCodeLine{00653\ \{}
\DoxyCodeLine{00654\ \ \ \ \ tls-\/>\mbox{\hyperlink{structrml_1_1internal_1_1_t_l_s_remote_a455fa204dc7e55cc6859b0b92ff0105a}{prev}}\ =\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{00655\ \ \ \ \ \mbox{\hyperlink{class_malloc_mutex_1_1scoped__lock}{MallocMutex::scoped\_lock}}\ \mbox{\hyperlink{ittnotify__static_8h_a46e8be2e3aadb2f6ee62e762a36b9243}{lock}}(\mbox{\hyperlink{classrml_1_1internal_1_1_all_local_caches_a60ab58e04ecf5df0107bb24d54feb645}{listLock}});}
\DoxyCodeLine{00656\ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\mbox{\hyperlink{classrml_1_1internal_1_1_all_local_caches_a2cc70f27db1dfa47f3e5d1ea35c78e4d}{head}}!=tls,\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}});}
\DoxyCodeLine{00657\ \ \ \ \ tls-\/>\mbox{\hyperlink{structrml_1_1internal_1_1_t_l_s_remote_aa6e2f590f3cbad3968cbb62a5a23f6ee}{next}}\ =\ \mbox{\hyperlink{classrml_1_1internal_1_1_all_local_caches_a2cc70f27db1dfa47f3e5d1ea35c78e4d}{head}};}
\DoxyCodeLine{00658\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classrml_1_1internal_1_1_all_local_caches_a2cc70f27db1dfa47f3e5d1ea35c78e4d}{head}})}
\DoxyCodeLine{00659\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_all_local_caches_a2cc70f27db1dfa47f3e5d1ea35c78e4d}{head}}-\/>prev\ =\ tls;}
\DoxyCodeLine{00660\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_all_local_caches_a2cc70f27db1dfa47f3e5d1ea35c78e4d}{head}}\ =\ tls;}
\DoxyCodeLine{00661\ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\mbox{\hyperlink{classrml_1_1internal_1_1_all_local_caches_a2cc70f27db1dfa47f3e5d1ea35c78e4d}{head}}-\/>next!=\mbox{\hyperlink{classrml_1_1internal_1_1_all_local_caches_a2cc70f27db1dfa47f3e5d1ea35c78e4d}{head}},\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}});}
\DoxyCodeLine{00662\ \}}
\DoxyCodeLine{00663\ }
\DoxyCodeLine{00664\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1internal_1_1_all_local_caches_a53d07e07b151b79af310ff5d40010f1d}{AllLocalCaches::unregisterThread}}(\mbox{\hyperlink{structrml_1_1internal_1_1_t_l_s_remote}{TLSRemote}}\ *tls)}
\DoxyCodeLine{00665\ \{}
\DoxyCodeLine{00666\ \ \ \ \ \mbox{\hyperlink{class_malloc_mutex_1_1scoped__lock}{MallocMutex::scoped\_lock}}\ \mbox{\hyperlink{ittnotify__static_8h_a46e8be2e3aadb2f6ee62e762a36b9243}{lock}}(\mbox{\hyperlink{classrml_1_1internal_1_1_all_local_caches_a60ab58e04ecf5df0107bb24d54feb645}{listLock}});}
\DoxyCodeLine{00667\ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\mbox{\hyperlink{classrml_1_1internal_1_1_all_local_caches_a2cc70f27db1dfa47f3e5d1ea35c78e4d}{head}},\ \textcolor{stringliteral}{"{}Can't\ unregister\ thread:\ no\ threads\ are\ registered."{}});}
\DoxyCodeLine{00668\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classrml_1_1internal_1_1_all_local_caches_a2cc70f27db1dfa47f3e5d1ea35c78e4d}{head}}\ ==\ tls)}
\DoxyCodeLine{00669\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_all_local_caches_a2cc70f27db1dfa47f3e5d1ea35c78e4d}{head}}\ =\ tls-\/>\mbox{\hyperlink{structrml_1_1internal_1_1_t_l_s_remote_aa6e2f590f3cbad3968cbb62a5a23f6ee}{next}};}
\DoxyCodeLine{00670\ \ \ \ \ \textcolor{keywordflow}{if}\ (tls-\/>\mbox{\hyperlink{structrml_1_1internal_1_1_t_l_s_remote_aa6e2f590f3cbad3968cbb62a5a23f6ee}{next}})}
\DoxyCodeLine{00671\ \ \ \ \ \ \ \ \ tls-\/>\mbox{\hyperlink{structrml_1_1internal_1_1_t_l_s_remote_aa6e2f590f3cbad3968cbb62a5a23f6ee}{next}}-\/>\mbox{\hyperlink{structrml_1_1internal_1_1_t_l_s_remote_a455fa204dc7e55cc6859b0b92ff0105a}{prev}}\ =\ tls-\/>\mbox{\hyperlink{structrml_1_1internal_1_1_t_l_s_remote_a455fa204dc7e55cc6859b0b92ff0105a}{prev}};}
\DoxyCodeLine{00672\ \ \ \ \ \textcolor{keywordflow}{if}\ (tls-\/>\mbox{\hyperlink{structrml_1_1internal_1_1_t_l_s_remote_a455fa204dc7e55cc6859b0b92ff0105a}{prev}})}
\DoxyCodeLine{00673\ \ \ \ \ \ \ \ \ tls-\/>\mbox{\hyperlink{structrml_1_1internal_1_1_t_l_s_remote_a455fa204dc7e55cc6859b0b92ff0105a}{prev}}-\/>\mbox{\hyperlink{structrml_1_1internal_1_1_t_l_s_remote_aa6e2f590f3cbad3968cbb62a5a23f6ee}{next}}\ =\ tls-\/>\mbox{\hyperlink{structrml_1_1internal_1_1_t_l_s_remote_aa6e2f590f3cbad3968cbb62a5a23f6ee}{next}};}
\DoxyCodeLine{00674\ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(!tls-\/>\mbox{\hyperlink{structrml_1_1internal_1_1_t_l_s_remote_aa6e2f590f3cbad3968cbb62a5a23f6ee}{next}}\ ||\ tls-\/>\mbox{\hyperlink{structrml_1_1internal_1_1_t_l_s_remote_aa6e2f590f3cbad3968cbb62a5a23f6ee}{next}}-\/>\mbox{\hyperlink{structrml_1_1internal_1_1_t_l_s_remote_aa6e2f590f3cbad3968cbb62a5a23f6ee}{next}}!=tls-\/>\mbox{\hyperlink{structrml_1_1internal_1_1_t_l_s_remote_aa6e2f590f3cbad3968cbb62a5a23f6ee}{next}},\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}});}
\DoxyCodeLine{00675\ \}}
\DoxyCodeLine{00676\ }
\DoxyCodeLine{00677\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classrml_1_1internal_1_1_all_local_caches_a37c9bd0c14ea906eb82f7a05928663f1}{AllLocalCaches::cleanup}}(\textcolor{keywordtype}{bool}\ cleanOnlyUnused)}
\DoxyCodeLine{00678\ \{}
\DoxyCodeLine{00679\ \ \ \ \ \textcolor{keywordtype}{bool}\ released\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00680\ \ \ \ \ \{}
\DoxyCodeLine{00681\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_malloc_mutex_1_1scoped__lock}{MallocMutex::scoped\_lock}}\ \mbox{\hyperlink{ittnotify__static_8h_a46e8be2e3aadb2f6ee62e762a36b9243}{lock}}(\mbox{\hyperlink{classrml_1_1internal_1_1_all_local_caches_a60ab58e04ecf5df0107bb24d54feb645}{listLock}});}
\DoxyCodeLine{00682\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{structrml_1_1internal_1_1_t_l_s_remote}{TLSRemote}}\ *curr=\mbox{\hyperlink{classrml_1_1internal_1_1_all_local_caches_a2cc70f27db1dfa47f3e5d1ea35c78e4d}{head}};\ curr;\ curr=curr-\/>next)}
\DoxyCodeLine{00683\ \ \ \ \ \ \ \ \ \ \ \ \ released\ |=\ \textcolor{keyword}{static\_cast<}\mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data}{TLSData}}*\textcolor{keyword}{>}(curr)-\/>\mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data_a6249ba2f15b82c002a6b82a731ad09b0}{externalCleanup}}(cleanOnlyUnused,\ \textcolor{comment}{/*cleanBins=*/}\textcolor{keyword}{false});}
\DoxyCodeLine{00684\ \ \ \ \ \}}
\DoxyCodeLine{00685\ \ \ \ \ \textcolor{keywordflow}{return}\ released;}
\DoxyCodeLine{00686\ \}}
\DoxyCodeLine{00687\ }
\DoxyCodeLine{00688\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1internal_1_1_all_local_caches_ae7e8856f91b8ff05b3ae0a719c20f345}{AllLocalCaches::markUnused}}()}
\DoxyCodeLine{00689\ \{}
\DoxyCodeLine{00690\ \ \ \ \ \textcolor{keywordtype}{bool}\ locked;}
\DoxyCodeLine{00691\ \ \ \ \ \mbox{\hyperlink{class_malloc_mutex_1_1scoped__lock}{MallocMutex::scoped\_lock}}\ \mbox{\hyperlink{ittnotify__static_8h_a46e8be2e3aadb2f6ee62e762a36b9243}{lock}}(\mbox{\hyperlink{classrml_1_1internal_1_1_all_local_caches_a60ab58e04ecf5df0107bb24d54feb645}{listLock}},\ \textcolor{comment}{/*block=*/}\textcolor{keyword}{false},\ \&locked);}
\DoxyCodeLine{00692\ \ \ \ \ \textcolor{keywordflow}{if}\ (!locked)\ \textcolor{comment}{//\ not\ wait\ for\ marking\ if\ someone\ doing\ something\ with\ it}}
\DoxyCodeLine{00693\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};\ }
\DoxyCodeLine{00694\ }
\DoxyCodeLine{00695\ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{structrml_1_1internal_1_1_t_l_s_remote}{TLSRemote}}\ *curr=\mbox{\hyperlink{classrml_1_1internal_1_1_all_local_caches_a2cc70f27db1dfa47f3e5d1ea35c78e4d}{head}};\ curr;\ curr=curr-\/>next)}
\DoxyCodeLine{00696\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static\_cast<}\mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data}{TLSData}}*\textcolor{keyword}{>}(curr)-\/>\mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data_a2dbe4c6ad60bc541ce0bff6274fa35b0}{markUnused}}();}
\DoxyCodeLine{00697\ \}}
\DoxyCodeLine{00698\ }
\DoxyCodeLine{00699\ \textcolor{preprocessor}{\#if\ MALLOC\_CHECK\_RECURSION}}
\DoxyCodeLine{00700\ \mbox{\hyperlink{class_malloc_mutex}{MallocMutex}}\ RecursiveMallocCallProtector::rmc\_mutex;}
\DoxyCodeLine{00701\ \mbox{\hyperlink{pthread__minport__windows_8h_ad665cf4bf4a61dd23aab712d9c5e9d81}{pthread\_t}}\ \ \ RecursiveMallocCallProtector::owner\_thread;}
\DoxyCodeLine{00702\ \textcolor{keywordtype}{void}\ \ \ \ \ \ \ *RecursiveMallocCallProtector::autoObjPtr;}
\DoxyCodeLine{00703\ \textcolor{keywordtype}{bool}\ \ \ \ \ \ \ \ RecursiveMallocCallProtector::mallocRecursionDetected;}
\DoxyCodeLine{00704\ \textcolor{preprocessor}{\#if\ \_\_FreeBSD\_\_}}
\DoxyCodeLine{00705\ \textcolor{keywordtype}{bool}\ \ \ \ \ \ \ \ RecursiveMallocCallProtector::canUsePthread;}
\DoxyCodeLine{00706\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00707\ }
\DoxyCodeLine{00708\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00709\ }
\DoxyCodeLine{00710\ \textcolor{comment}{/***********\ End\ code\ to\ provide\ thread\ ID\ and\ a\ TLS\ pointer\ **********/}}
\DoxyCodeLine{00711\ }
\DoxyCodeLine{00712\ \textcolor{comment}{//\ Parameter\ for\ isLargeObject,\ keeps\ our\ expectations\ on\ memory\ origin.}}
\DoxyCodeLine{00713\ \textcolor{comment}{//\ Assertions\ must\ use\ unknownMem\ to\ reliably\ report\ object\ invalidity.}}
\DoxyCodeLine{00714\ \textcolor{keyword}{enum}\ \mbox{\hyperlink{namespacerml_1_1internal_a2296ed46b728e5cbf437925e3c2b7741}{MemoryOrigin}}\ \{}
\DoxyCodeLine{00715\ \ \ \ \ \mbox{\hyperlink{namespacerml_1_1internal_a2296ed46b728e5cbf437925e3c2b7741aec1fc2f8963fd76a704000132f0bd1c4}{ourMem}},\ \ \ \ \textcolor{comment}{//\ allocated\ by\ TBB\ allocator}}
\DoxyCodeLine{00716\ \ \ \ \ \mbox{\hyperlink{namespacerml_1_1internal_a2296ed46b728e5cbf437925e3c2b7741a871a4fdedb61da75e66f4db4196890d2}{unknownMem}}\ \textcolor{comment}{//\ can\ be\ allocated\ by\ system\ allocator\ or\ TBB\ allocator}}
\DoxyCodeLine{00717\ \};}
\DoxyCodeLine{00718\ }
\DoxyCodeLine{00719\ \textcolor{keyword}{template}<MemoryOrigin>\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{namespacerml_1_1internal_a730f387568a0a522e003dca4246eb393}{isLargeObject}}(\textcolor{keywordtype}{void}\ *\textcolor{keywordtype}{object});}
\DoxyCodeLine{00720\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ *\mbox{\hyperlink{namespacerml_1_1internal_a19b0fbc5aaa4b08cc412bb5777b01f89}{internalMalloc}}(\textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}});}
\DoxyCodeLine{00721\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{namespacerml_1_1internal_a91eeaa067e3fdf5618b5a65b8b368231}{internalFree}}(\textcolor{keywordtype}{void}\ *\textcolor{keywordtype}{object});}
\DoxyCodeLine{00722\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ *\mbox{\hyperlink{namespacerml_1_1internal_a341c0310d4c1374c96acc18cd37eba26}{internalPoolMalloc}}(\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool}{MemoryPool}}*\ mPool,\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}});}
\DoxyCodeLine{00723\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{namespacerml_1_1internal_a8bff2023b8463f38317c75980f21e0db}{internalPoolFree}}(\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool}{MemoryPool}}\ *mPool,\ \textcolor{keywordtype}{void}\ *\textcolor{keywordtype}{object},\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}});}
\DoxyCodeLine{00724\ }
\DoxyCodeLine{00725\ \textcolor{preprocessor}{\#if\ !MALLOC\_DEBUG}}
\DoxyCodeLine{00726\ \textcolor{preprocessor}{\#if\ \_\_INTEL\_COMPILER\ ||\ \_MSC\_VER}}
\DoxyCodeLine{00727\ \textcolor{preprocessor}{\#define\ NOINLINE(decl)\ \_\_declspec(noinline)\ decl}}
\DoxyCodeLine{00728\ \textcolor{preprocessor}{\#define\ ALWAYSINLINE(decl)\ \_\_forceinline\ decl}}
\DoxyCodeLine{00729\ \textcolor{preprocessor}{\#elif\ \_\_GNUC\_\_}}
\DoxyCodeLine{00730\ \textcolor{preprocessor}{\#define\ NOINLINE(decl)\ decl\ \_\_attribute\_\_\ ((noinline))}}
\DoxyCodeLine{00731\ \textcolor{preprocessor}{\#define\ ALWAYSINLINE(decl)\ decl\ \_\_attribute\_\_\ ((always\_inline))}}
\DoxyCodeLine{00732\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00733\ \textcolor{preprocessor}{\#define\ NOINLINE(decl)\ decl}}
\DoxyCodeLine{00734\ \textcolor{preprocessor}{\#define\ ALWAYSINLINE(decl)\ decl}}
\DoxyCodeLine{00735\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00736\ }
\DoxyCodeLine{00737\ \textcolor{keyword}{static}\ \mbox{\hyperlink{ff__queue_8hpp_a1b173d22e57d9395897acbd8de62d505}{NOINLINE}}(\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{namespacerml_1_1internal_aad59cc02d849210b00c8587544e44e20}{doInitialization}}()\ );}
\DoxyCodeLine{00738\ \mbox{\hyperlink{frontend_8cpp_a15c4fcc69d05a963c0ed7e2cad03551a}{ALWAYSINLINE}}(\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{namespacerml_1_1internal_a61c4d632ea815cbeea8ed0ee72e06ac7}{isMallocInitialized}}()\ );}
\DoxyCodeLine{00739\ }
\DoxyCodeLine{00740\ \textcolor{preprocessor}{\#undef\ ALWAYSINLINE}}
\DoxyCodeLine{00741\ \textcolor{preprocessor}{\#undef\ NOINLINE}}
\DoxyCodeLine{00742\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{/*\ !MALLOC\_DEBUG\ */}\textcolor{preprocessor}{}}
\DoxyCodeLine{00743\ }
\DoxyCodeLine{00744\ }
\DoxyCodeLine{00745\ \textcolor{comment}{/*********\ Now\ some\ rough\ utility\ code\ to\ deal\ with\ indexing\ the\ size\ bins.\ **************/}}
\DoxyCodeLine{00746\ }
\DoxyCodeLine{00747\ \textcolor{comment}{/*}}
\DoxyCodeLine{00748\ \textcolor{comment}{\ *\ Given\ a\ number\ return\ the\ highest\ non-\/zero\ bit\ in\ it.\ It\ is\ intended\ to\ work\ with\ 32-\/bit\ values\ only.}}
\DoxyCodeLine{00749\ \textcolor{comment}{\ *\ Moreover,\ on\ IPF,\ for\ sake\ of\ simplicity\ and\ performance,\ it\ is\ narrowed\ to\ only\ serve\ for\ 64\ to\ 1023.}}
\DoxyCodeLine{00750\ \textcolor{comment}{\ *\ This\ is\ enough\ for\ current\ algorithm\ of\ distribution\ of\ sizes\ among\ bins.}}
\DoxyCodeLine{00751\ \textcolor{comment}{\ *\ \_\_TBB\_Log2\ is\ not\ used\ here\ to\ minimize\ dependencies\ on\ TBB\ specific\ sources.}}
\DoxyCodeLine{00752\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00753\ \textcolor{preprocessor}{\#if\ \_WIN64\ \&\&\ \_MSC\_VER>=1400\ \&\&\ !\_\_INTEL\_COMPILER}}
\DoxyCodeLine{00754\ \textcolor{keyword}{extern}\ \textcolor{stringliteral}{"{}C"{}}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ \_BitScanReverse(\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{long}*\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}},\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{long}\ \mbox{\hyperlink{_matrix__resize__int_8cpp_aab236ce080522c9832217fd5f157541b}{w}}\ );}
\DoxyCodeLine{00755\ \textcolor{preprocessor}{\#pragma\ intrinsic(\_BitScanReverse)}}
\DoxyCodeLine{00756\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00757\ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{namespacerml_1_1internal_a207376af1d0186a621e6e405cd469662}{highestBitPos}}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}})}
\DoxyCodeLine{00758\ \{}
\DoxyCodeLine{00759\ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}>=64\ \&\&\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}<1024,\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );\ \textcolor{comment}{//\ only\ needed\ for\ bsr\ array\ lookup,\ but\ always\ true}}
\DoxyCodeLine{00760\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ pos;}
\DoxyCodeLine{00761\ \textcolor{preprocessor}{\#if\ \_\_ARCH\_x86\_32||\_\_ARCH\_x86\_64}}
\DoxyCodeLine{00762\ }
\DoxyCodeLine{00763\ \textcolor{preprocessor}{\#\ if\ \_\_linux\_\_||\_\_APPLE\_\_||\_\_FreeBSD\_\_||\_\_NetBSD\_\_||\_\_OpenBSD\_\_||\_\_sun||\_\_MINGW32\_\_}}
\DoxyCodeLine{00764\ \ \ \ \ \_\_asm\_\_\ (\textcolor{stringliteral}{"{}bsr\ \%1,\%0"{}}\ :\ \textcolor{stringliteral}{"{}=r"{}}(pos)\ :\ \textcolor{stringliteral}{"{}r"{}}(\mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}));}
\DoxyCodeLine{00765\ \textcolor{preprocessor}{\#\ elif\ (\_WIN32\ \&\&\ (!\_WIN64\ ||\ \_\_INTEL\_COMPILER))}}
\DoxyCodeLine{00766\ \ \ \ \ \_\_asm}
\DoxyCodeLine{00767\ \ \ \ \ \{}
\DoxyCodeLine{00768\ \ \ \ \ \ \ \ \ bsr\ eax,\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}}
\DoxyCodeLine{00769\ \ \ \ \ \ \ \ \ mov\ pos,\ eax}
\DoxyCodeLine{00770\ \ \ \ \ \}}
\DoxyCodeLine{00771\ \textcolor{preprocessor}{\#\ elif\ \_WIN64\ \&\&\ \_MSC\_VER>=1400}}
\DoxyCodeLine{00772\ \ \ \ \ \_BitScanReverse((\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{long}*)\&pos,\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{long})\mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}});}
\DoxyCodeLine{00773\ \textcolor{preprocessor}{\#\ else}}
\DoxyCodeLine{00774\ \textcolor{preprocessor}{\#\ \ \ error\ highestBitPos()\ not\ implemented\ for\ this\ platform}}
\DoxyCodeLine{00775\ \textcolor{preprocessor}{\#\ endif}}
\DoxyCodeLine{00776\ \textcolor{preprocessor}{\#elif\ \_\_arm\_\_}}
\DoxyCodeLine{00777\ \ \ \ \ \_\_asm\_\_\ \_\_volatile\_\_}
\DoxyCodeLine{00778\ \ \ \ \ (}
\DoxyCodeLine{00779\ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}clz\ \%0,\ \%1\(\backslash\)n"{}}}
\DoxyCodeLine{00780\ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}rsb\ \%0,\ \%0,\ \%2\(\backslash\)n"{}}}
\DoxyCodeLine{00781\ \ \ \ \ \ \ \ :\textcolor{stringliteral}{"{}=r"{}}\ (pos)\ :\textcolor{stringliteral}{"{}r"{}}\ (\mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}),\ \textcolor{stringliteral}{"{}I"{}}\ (31)}
\DoxyCodeLine{00782\ \ \ \ \ );}
\DoxyCodeLine{00783\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00784\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ bsr[16]\ =\ \{0\textcolor{comment}{/*N/A*/},6,7,7,8,8,8,8,9,9,9,9,9,9,9,9\};}
\DoxyCodeLine{00785\ \ \ \ \ pos\ =\ bsr[\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}>>6\ ];}
\DoxyCodeLine{00786\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{/*\ \_\_ARCH\_*\ */}\textcolor{preprocessor}{}}
\DoxyCodeLine{00787\ \ \ \ \ \textcolor{keywordflow}{return}\ pos;}
\DoxyCodeLine{00788\ \}}
\DoxyCodeLine{00789\ }
\DoxyCodeLine{00790\ \textcolor{keyword}{template}<\textcolor{keywordtype}{bool}\ Is32Bit>}
\DoxyCodeLine{00791\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{namespacerml_1_1internal_a1c4eb44e079bcce46d628794a9862661}{getSmallObjectIndex}}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}})}
\DoxyCodeLine{00792\ \{}
\DoxyCodeLine{00793\ \ \ \ \ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}}-\/1)>>3;}
\DoxyCodeLine{00794\ \}}
\DoxyCodeLine{00795\ \textcolor{keyword}{template}<>}
\DoxyCodeLine{00796\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{namespacerml_1_1internal_a1c4eb44e079bcce46d628794a9862661}{getSmallObjectIndex}}<\textcolor{comment}{/*Is32Bit=*/}\textcolor{keyword}{false}>(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}})}
\DoxyCodeLine{00797\ \{}
\DoxyCodeLine{00798\ \ \ \ \ \textcolor{comment}{//\ For\ 64-\/bit\ malloc,\ 16\ byte\ alignment\ is\ needed\ except\ for\ bin\ 0.}}
\DoxyCodeLine{00799\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}}\ =\ (\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}}-\/1)>>3;}
\DoxyCodeLine{00800\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}})\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}}\ |=\ 1;\ \textcolor{comment}{//\ 0,1,3,5,7;\ bins\ 2,4,6\ are\ not\ aligned\ to\ 16\ bytes}}
\DoxyCodeLine{00801\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}};}
\DoxyCodeLine{00802\ \}}
\DoxyCodeLine{00803\ \textcolor{comment}{/*}}
\DoxyCodeLine{00804\ \textcolor{comment}{\ *\ Depending\ on\ indexRequest,\ for\ a\ given\ size\ return\ either\ the\ index\ into\ the\ bin}}
\DoxyCodeLine{00805\ \textcolor{comment}{\ *\ for\ objects\ of\ this\ size,\ or\ the\ actual\ size\ of\ objects\ in\ this\ bin.}}
\DoxyCodeLine{00806\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00807\ \textcolor{keyword}{template}<\textcolor{keywordtype}{bool}\ indexRequest>}
\DoxyCodeLine{00808\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{namespacerml_1_1internal_aebac3191559671ba56411f6a4926649a}{getIndexOrObjectSize}}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}})}
\DoxyCodeLine{00809\ \{}
\DoxyCodeLine{00810\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}}\ <=\ \mbox{\hyperlink{namespacerml_1_1internal_a8b248c08cf434752fdb37a696f9dd7c9}{maxSmallObjectSize}})\ \{\ \textcolor{comment}{//\ selection\ from\ 8/16/24/32/40/48/56/64}}
\DoxyCodeLine{00811\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ab47dd9958bcadea08866b42bf358e95e}{index}}\ =\ \mbox{\hyperlink{namespacerml_1_1internal_a1c4eb44e079bcce46d628794a9862661}{getSmallObjectIndex}}<\textcolor{comment}{/*Is32Bit=*/}(\textcolor{keyword}{sizeof}(size\_t)<=4)>(\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}}\ );}
\DoxyCodeLine{00812\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Bin\ 0\ is\ for\ 8\ bytes,\ bin\ 1\ is\ for\ 16,\ and\ so\ forth\ */}}
\DoxyCodeLine{00813\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ indexRequest\ ?\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ab47dd9958bcadea08866b42bf358e95e}{index}}\ :\ (\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ab47dd9958bcadea08866b42bf358e95e}{index}}+1)<<3;}
\DoxyCodeLine{00814\ \ \ \ \ \}}
\DoxyCodeLine{00815\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}}\ <=\ \mbox{\hyperlink{namespacerml_1_1internal_ac18775d0814a506927c2bb6b978a1d73}{maxSegregatedObjectSize}}\ )\ \{\ \textcolor{comment}{//\ 80/96/112/128\ /\ 160/192/224/256\ /\ 320/384/448/512\ /\ 640/768/896/1024}}
\DoxyCodeLine{00816\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ order\ =\ \mbox{\hyperlink{namespacerml_1_1internal_a207376af1d0186a621e6e405cd469662}{highestBitPos}}(\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}}-\/1);\ \textcolor{comment}{//\ which\ group\ of\ bin\ sizes?}}
\DoxyCodeLine{00817\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ 6<=order\ \&\&\ order<=9,\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );}
\DoxyCodeLine{00818\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (indexRequest)}
\DoxyCodeLine{00819\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacerml_1_1internal_a3228789e0905a650368b88c83cc7e255}{minSegregatedObjectIndex}}\ -\/\ (4*6)\ -\/\ 4\ +\ (4*order)\ +\ ((\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}}-\/1)>>(order-\/2));}
\DoxyCodeLine{00820\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00821\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ alignment\ =\ 128\ >>\ (9-\/order);\ \textcolor{comment}{//\ alignment\ in\ the\ group}}
\DoxyCodeLine{00822\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ alignment==16\ ||\ alignment==32\ ||\ alignment==64\ ||\ alignment==128,\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );}
\DoxyCodeLine{00823\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{shared__utils_8h_abf7a0e928f58ffeeefa291f674c30d69}{alignUp}}(\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}},alignment);}
\DoxyCodeLine{00824\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00825\ \ \ \ \ \}}
\DoxyCodeLine{00826\ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00827\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}}\ <=\ \mbox{\hyperlink{namespacerml_1_1internal_a204e4db26e6fbb0756f15ad673101c2a}{fittingSize3}}\ )\ \{}
\DoxyCodeLine{00828\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}}\ <=\ \mbox{\hyperlink{namespacerml_1_1internal_a5a758b17d8a8e8f0a94b43645be7e539}{fittingSize2}}\ )\ \{}
\DoxyCodeLine{00829\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}}\ <=\ \mbox{\hyperlink{namespacerml_1_1internal_abf9b6a55c23ce9d253f4fd134682b002}{fittingSize1}}\ )}
\DoxyCodeLine{00830\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ indexRequest\ ?\ \mbox{\hyperlink{namespacerml_1_1internal_af911b4fc0cfbb7dffb74bcd3027515ae}{minFittingIndex}}\ :\ \mbox{\hyperlink{namespacerml_1_1internal_abf9b6a55c23ce9d253f4fd134682b002}{fittingSize1}};}
\DoxyCodeLine{00831\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00832\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ indexRequest\ ?\ \mbox{\hyperlink{namespacerml_1_1internal_af911b4fc0cfbb7dffb74bcd3027515ae}{minFittingIndex}}+1\ :\ \mbox{\hyperlink{namespacerml_1_1internal_a5a758b17d8a8e8f0a94b43645be7e539}{fittingSize2}};}
\DoxyCodeLine{00833\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00834\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ indexRequest\ ?\ \mbox{\hyperlink{namespacerml_1_1internal_af911b4fc0cfbb7dffb74bcd3027515ae}{minFittingIndex}}+2\ :\ \mbox{\hyperlink{namespacerml_1_1internal_a204e4db26e6fbb0756f15ad673101c2a}{fittingSize3}};}
\DoxyCodeLine{00835\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00836\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}}\ <=\ \mbox{\hyperlink{namespacerml_1_1internal_a353e5d7e5844beb88452a87ddd86c27f}{fittingSize5}}\ )\ \{}
\DoxyCodeLine{00837\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}}\ <=\ \mbox{\hyperlink{namespacerml_1_1internal_aa61277b9cc18c3279cd1b02026bba7b7}{fittingSize4}}\ )}
\DoxyCodeLine{00838\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ indexRequest\ ?\ \mbox{\hyperlink{namespacerml_1_1internal_af911b4fc0cfbb7dffb74bcd3027515ae}{minFittingIndex}}+3\ :\ \mbox{\hyperlink{namespacerml_1_1internal_aa61277b9cc18c3279cd1b02026bba7b7}{fittingSize4}};}
\DoxyCodeLine{00839\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00840\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ indexRequest\ ?\ \mbox{\hyperlink{namespacerml_1_1internal_af911b4fc0cfbb7dffb74bcd3027515ae}{minFittingIndex}}+4\ :\ \mbox{\hyperlink{namespacerml_1_1internal_a353e5d7e5844beb88452a87ddd86c27f}{fittingSize5}};}
\DoxyCodeLine{00841\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00842\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ 0,\mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );\ \textcolor{comment}{//\ this\ should\ not\ happen}}
\DoxyCodeLine{00843\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \string~0U;}
\DoxyCodeLine{00844\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00845\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00846\ \ \ \ \ \}}
\DoxyCodeLine{00847\ \}}
\DoxyCodeLine{00848\ }
\DoxyCodeLine{00849\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{namespacerml_1_1internal_a70dcd761b867baccb7ffdb087e52e215}{getIndex}}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}})}
\DoxyCodeLine{00850\ \{}
\DoxyCodeLine{00851\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacerml_1_1internal_aebac3191559671ba56411f6a4926649a}{getIndexOrObjectSize}}<\textcolor{comment}{/*indexRequest=*/}\textcolor{keyword}{true}>(\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}});}
\DoxyCodeLine{00852\ \}}
\DoxyCodeLine{00853\ }
\DoxyCodeLine{00854\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{namespacerml_1_1internal_af01ec297511bd9be238191aa74fcf9fc}{getObjectSize}}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}})}
\DoxyCodeLine{00855\ \{}
\DoxyCodeLine{00856\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacerml_1_1internal_aebac3191559671ba56411f6a4926649a}{getIndexOrObjectSize}}<\textcolor{comment}{/*indexRequest=*/}\textcolor{keyword}{false}>(\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}});}
\DoxyCodeLine{00857\ \}}
\DoxyCodeLine{00858\ }
\DoxyCodeLine{00859\ }
\DoxyCodeLine{00860\ \textcolor{keywordtype}{void}\ *\mbox{\hyperlink{classrml_1_1internal_1_1_boot_strap_blocks_ac04f5dfb5527488b55c491957dc8ec66}{BootStrapBlocks::allocate}}(\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool}{MemoryPool}}\ *memPool,\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}})}
\DoxyCodeLine{00861\ \{}
\DoxyCodeLine{00862\ \ \ \ \ \mbox{\hyperlink{structrml_1_1internal_1_1_free_object}{FreeObject}}\ *\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}};}
\DoxyCodeLine{00863\ }
\DoxyCodeLine{00864\ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}}\ ==\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data}{TLSData}}),\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );}
\DoxyCodeLine{00865\ }
\DoxyCodeLine{00866\ \ \ \ \ \{\ \textcolor{comment}{//\ Lock\ with\ acquire}}
\DoxyCodeLine{00867\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_malloc_mutex_1_1scoped__lock}{MallocMutex::scoped\_lock}}\ scoped\_cs(\mbox{\hyperlink{classrml_1_1internal_1_1_boot_strap_blocks_a15103d69d2c9dc17b383f88fe238b50e}{bootStrapLock}});}
\DoxyCodeLine{00868\ }
\DoxyCodeLine{00869\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ \mbox{\hyperlink{classrml_1_1internal_1_1_boot_strap_blocks_ab3c22f8255fb4f6bdd51d9a360aa57fc}{bootStrapObjectList}})\ \{}
\DoxyCodeLine{00870\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}}\ =\ \mbox{\hyperlink{classrml_1_1internal_1_1_boot_strap_blocks_ab3c22f8255fb4f6bdd51d9a360aa57fc}{bootStrapObjectList}};}
\DoxyCodeLine{00871\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_boot_strap_blocks_ab3c22f8255fb4f6bdd51d9a360aa57fc}{bootStrapObjectList}}\ =\ \mbox{\hyperlink{classrml_1_1internal_1_1_boot_strap_blocks_ab3c22f8255fb4f6bdd51d9a360aa57fc}{bootStrapObjectList}}-\/>next;}
\DoxyCodeLine{00872\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00873\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classrml_1_1internal_1_1_boot_strap_blocks_aa446bae623c32a2231cb1c5dfbd53cb4}{bootStrapBlock}})\ \{}
\DoxyCodeLine{00874\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_boot_strap_blocks_aa446bae623c32a2231cb1c5dfbd53cb4}{bootStrapBlock}}\ =\ memPool-\/>\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_a16261e62d2c6418981ade9a7ea23d5d0}{getEmptyBlock}}(\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}});}
\DoxyCodeLine{00875\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classrml_1_1internal_1_1_boot_strap_blocks_aa446bae623c32a2231cb1c5dfbd53cb4}{bootStrapBlock}})\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{00876\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00877\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}}\ =\ \mbox{\hyperlink{classrml_1_1internal_1_1_boot_strap_blocks_aa446bae623c32a2231cb1c5dfbd53cb4}{bootStrapBlock}}-\/>bumpPtr;}
\DoxyCodeLine{00878\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_boot_strap_blocks_aa446bae623c32a2231cb1c5dfbd53cb4}{bootStrapBlock}}-\/>bumpPtr\ =\ (\mbox{\hyperlink{structrml_1_1internal_1_1_free_object}{FreeObject}}\ *)((uintptr\_t)\mbox{\hyperlink{classrml_1_1internal_1_1_boot_strap_blocks_aa446bae623c32a2231cb1c5dfbd53cb4}{bootStrapBlock}}-\/>bumpPtr\ -\/\ \mbox{\hyperlink{classrml_1_1internal_1_1_boot_strap_blocks_aa446bae623c32a2231cb1c5dfbd53cb4}{bootStrapBlock}}-\/>objectSize);}
\DoxyCodeLine{00879\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((uintptr\_t)\mbox{\hyperlink{classrml_1_1internal_1_1_boot_strap_blocks_aa446bae623c32a2231cb1c5dfbd53cb4}{bootStrapBlock}}-\/>bumpPtr\ <\ (uintptr\_t)\mbox{\hyperlink{classrml_1_1internal_1_1_boot_strap_blocks_aa446bae623c32a2231cb1c5dfbd53cb4}{bootStrapBlock}}+\textcolor{keyword}{sizeof}(\mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}))\ \{}
\DoxyCodeLine{00880\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_boot_strap_blocks_aa446bae623c32a2231cb1c5dfbd53cb4}{bootStrapBlock}}-\/>bumpPtr\ =\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{00881\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_boot_strap_blocks_aa446bae623c32a2231cb1c5dfbd53cb4}{bootStrapBlock}}-\/>next\ =\ \mbox{\hyperlink{classrml_1_1internal_1_1_boot_strap_blocks_aa5ec57e57f3acdb33c4e95cffef57682}{bootStrapBlockUsed}};}
\DoxyCodeLine{00882\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_boot_strap_blocks_aa5ec57e57f3acdb33c4e95cffef57682}{bootStrapBlockUsed}}\ =\ \mbox{\hyperlink{classrml_1_1internal_1_1_boot_strap_blocks_aa446bae623c32a2231cb1c5dfbd53cb4}{bootStrapBlock}};}
\DoxyCodeLine{00883\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_boot_strap_blocks_aa446bae623c32a2231cb1c5dfbd53cb4}{bootStrapBlock}}\ =\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{00884\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00885\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00886\ \ \ \ \ \}\ \textcolor{comment}{//\ Unlock\ with\ release}}
\DoxyCodeLine{00887\ }
\DoxyCodeLine{00888\ \ \ \ \ memset\ (\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}},\ 0,\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}});}
\DoxyCodeLine{00889\ \ \ \ \ \textcolor{keywordflow}{return}\ (\textcolor{keywordtype}{void}*)\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}};}
\DoxyCodeLine{00890\ \}}
\DoxyCodeLine{00891\ }
\DoxyCodeLine{00892\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1internal_1_1_boot_strap_blocks_a77ebf6da50eb9bb839ba9585186df6c5}{BootStrapBlocks::free}}(\textcolor{keywordtype}{void}*\ \mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}})}
\DoxyCodeLine{00893\ \{}
\DoxyCodeLine{00894\ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ \mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}},\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );}
\DoxyCodeLine{00895\ \ \ \ \ \{\ \textcolor{comment}{//\ Lock\ with\ acquire}}
\DoxyCodeLine{00896\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_malloc_mutex_1_1scoped__lock}{MallocMutex::scoped\_lock}}\ scoped\_cs(\mbox{\hyperlink{classrml_1_1internal_1_1_boot_strap_blocks_a15103d69d2c9dc17b383f88fe238b50e}{bootStrapLock}});}
\DoxyCodeLine{00897\ \ \ \ \ \ \ \ \ ((\mbox{\hyperlink{structrml_1_1internal_1_1_free_object}{FreeObject}}*)\mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}})-\/>next\ =\ \mbox{\hyperlink{classrml_1_1internal_1_1_boot_strap_blocks_ab3c22f8255fb4f6bdd51d9a360aa57fc}{bootStrapObjectList}};}
\DoxyCodeLine{00898\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_boot_strap_blocks_ab3c22f8255fb4f6bdd51d9a360aa57fc}{bootStrapObjectList}}\ =\ (\mbox{\hyperlink{structrml_1_1internal_1_1_free_object}{FreeObject}}*)\mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}};}
\DoxyCodeLine{00899\ \ \ \ \ \}\ \textcolor{comment}{//\ Unlock\ with\ release}}
\DoxyCodeLine{00900\ \}}
\DoxyCodeLine{00901\ }
\DoxyCodeLine{00902\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1internal_1_1_boot_strap_blocks_addc591467d1fb49018fd5dd05943b114}{BootStrapBlocks::reset}}()}
\DoxyCodeLine{00903\ \{}
\DoxyCodeLine{00904\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_boot_strap_blocks_aa446bae623c32a2231cb1c5dfbd53cb4}{bootStrapBlock}}\ =\ \mbox{\hyperlink{classrml_1_1internal_1_1_boot_strap_blocks_aa5ec57e57f3acdb33c4e95cffef57682}{bootStrapBlockUsed}}\ =\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{00905\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_boot_strap_blocks_ab3c22f8255fb4f6bdd51d9a360aa57fc}{bootStrapObjectList}}\ =\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{00906\ \}}
\DoxyCodeLine{00907\ }
\DoxyCodeLine{00908\ \textcolor{preprocessor}{\#if\ !(FREELIST\_NONBLOCKING)}}
\DoxyCodeLine{00909\ \textcolor{keyword}{static}\ \mbox{\hyperlink{class_malloc_mutex}{MallocMutex}}\ publicFreeListLock;\ \textcolor{comment}{//\ lock\ for\ changes\ of\ publicFreeList}}
\DoxyCodeLine{00910\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00911\ }
\DoxyCodeLine{00912\ \textcolor{comment}{/*********\ End\ rough\ utility\ code\ \ **************/}}
\DoxyCodeLine{00913\ }
\DoxyCodeLine{00914\ \textcolor{comment}{/*\ LifoList\ assumes\ zero\ initialization\ so\ a\ vector\ of\ it\ can\ be\ created}}
\DoxyCodeLine{00915\ \textcolor{comment}{\ *\ by\ just\ allocating\ some\ space\ with\ no\ call\ to\ constructor.}}
\DoxyCodeLine{00916\ \textcolor{comment}{\ *\ On\ Linux,\ it\ seems\ to\ be\ necessary\ to\ avoid\ linking\ with\ C++\ libraries.}}
\DoxyCodeLine{00917\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00918\ \textcolor{comment}{\ *\ By\ usage\ convention\ there\ is\ no\ race\ on\ the\ initialization.\ */}}
\DoxyCodeLine{00919\ \mbox{\hyperlink{classrml_1_1internal_1_1_lifo_list_a71a4147a226b1f1dea6475093ef3139b}{LifoList::LifoList}}(\ )\ :\ \mbox{\hyperlink{classrml_1_1internal_1_1_lifo_list_a446bb262c2fad232bbc5f95088c19b58}{top}}(\mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}})}
\DoxyCodeLine{00920\ \{}
\DoxyCodeLine{00921\ \ \ \ \ \textcolor{comment}{//\ MallocMutex\ assumes\ zero\ initialization}}
\DoxyCodeLine{00922\ \ \ \ \ memset(\&\mbox{\hyperlink{classrml_1_1internal_1_1_lifo_list_a1cf637a3e8495bdbf71893a397eb20de}{lock}},\ 0,\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{class_malloc_mutex}{MallocMutex}}));}
\DoxyCodeLine{00923\ \}}
\DoxyCodeLine{00924\ }
\DoxyCodeLine{00925\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1internal_1_1_lifo_list_aa7629cbd8403ea42d5ec9a5efe9c3f91}{LifoList::push}}(\mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}\ *\mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}})}
\DoxyCodeLine{00926\ \{}
\DoxyCodeLine{00927\ \ \ \ \ \mbox{\hyperlink{class_malloc_mutex_1_1scoped__lock}{MallocMutex::scoped\_lock}}\ scoped\_cs(\mbox{\hyperlink{classrml_1_1internal_1_1_lifo_list_a1cf637a3e8495bdbf71893a397eb20de}{lock}});}
\DoxyCodeLine{00928\ \ \ \ \ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}-\/>next\ =\ \mbox{\hyperlink{classrml_1_1internal_1_1_lifo_list_a446bb262c2fad232bbc5f95088c19b58}{top}};}
\DoxyCodeLine{00929\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_lifo_list_a446bb262c2fad232bbc5f95088c19b58}{top}}\ =\ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}};}
\DoxyCodeLine{00930\ \}}
\DoxyCodeLine{00931\ }
\DoxyCodeLine{00932\ \mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}\ *\mbox{\hyperlink{classrml_1_1internal_1_1_lifo_list_a75a913938955f0898e950401bcdeb54d}{LifoList::pop}}()}
\DoxyCodeLine{00933\ \{}
\DoxyCodeLine{00934\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}\ *\mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}=\mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{00935\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classrml_1_1internal_1_1_lifo_list_a446bb262c2fad232bbc5f95088c19b58}{top}})\ \{}
\DoxyCodeLine{00936\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_malloc_mutex_1_1scoped__lock}{MallocMutex::scoped\_lock}}\ scoped\_cs(\mbox{\hyperlink{classrml_1_1internal_1_1_lifo_list_a1cf637a3e8495bdbf71893a397eb20de}{lock}});}
\DoxyCodeLine{00937\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classrml_1_1internal_1_1_lifo_list_a446bb262c2fad232bbc5f95088c19b58}{top}})\ \{}
\DoxyCodeLine{00938\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}\ =\ \mbox{\hyperlink{classrml_1_1internal_1_1_lifo_list_a446bb262c2fad232bbc5f95088c19b58}{top}};}
\DoxyCodeLine{00939\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_lifo_list_a446bb262c2fad232bbc5f95088c19b58}{top}}\ =\ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}-\/>next;}
\DoxyCodeLine{00940\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00941\ \ \ \ \ \}}
\DoxyCodeLine{00942\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}};}
\DoxyCodeLine{00943\ \}}
\DoxyCodeLine{00944\ }
\DoxyCodeLine{00945\ \mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}\ *\mbox{\hyperlink{classrml_1_1internal_1_1_lifo_list_a1c0e42e0d99bd02cc8f243980d500434}{LifoList::grab}}()}
\DoxyCodeLine{00946\ \{}
\DoxyCodeLine{00947\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}\ *\mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}\ =\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{00948\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classrml_1_1internal_1_1_lifo_list_a446bb262c2fad232bbc5f95088c19b58}{top}})\ \{}
\DoxyCodeLine{00949\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_malloc_mutex_1_1scoped__lock}{MallocMutex::scoped\_lock}}\ scoped\_cs(\mbox{\hyperlink{classrml_1_1internal_1_1_lifo_list_a1cf637a3e8495bdbf71893a397eb20de}{lock}});}
\DoxyCodeLine{00950\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}\ =\ \mbox{\hyperlink{classrml_1_1internal_1_1_lifo_list_a446bb262c2fad232bbc5f95088c19b58}{top}};}
\DoxyCodeLine{00951\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_lifo_list_a446bb262c2fad232bbc5f95088c19b58}{top}}\ =\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{00952\ \ \ \ \ \}}
\DoxyCodeLine{00953\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}};}
\DoxyCodeLine{00954\ \}}
\DoxyCodeLine{00955\ }
\DoxyCodeLine{00956\ \textcolor{comment}{/*********\ Thread\ and\ block\ related\ code\ \ \ \ \ \ *************/}}
\DoxyCodeLine{00957\ }
\DoxyCodeLine{00958\ \textcolor{keyword}{template}<\textcolor{keywordtype}{bool}\ poolDestroy>\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1internal_1_1_all_large_blocks_list_a93202fa088a712fbdba4c671bab8f015}{AllLargeBlocksList::releaseAll}}(\mbox{\hyperlink{classrml_1_1internal_1_1_backend}{Backend}}\ *backend)\ \{}
\DoxyCodeLine{00959\ \ \ \ \ \ \mbox{\hyperlink{structrml_1_1internal_1_1_large_memory_block}{LargeMemoryBlock}}\ *next,\ *lmb\ =\ \mbox{\hyperlink{classrml_1_1internal_1_1_all_large_blocks_list_a6a9aef552076577102e7c5288e29598f}{loHead}};}
\DoxyCodeLine{00960\ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_all_large_blocks_list_a6a9aef552076577102e7c5288e29598f}{loHead}}\ =\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{00961\ }
\DoxyCodeLine{00962\ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ lmb;\ lmb\ =\ next)\ \{}
\DoxyCodeLine{00963\ \ \ \ \ \ \ \ \ \ next\ =\ lmb-\/>\mbox{\hyperlink{structrml_1_1internal_1_1_large_memory_block_a2c2870cb49c99aa7e2438c4662b85b20}{gNext}};}
\DoxyCodeLine{00964\ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (poolDestroy)\ \{}
\DoxyCodeLine{00965\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ as\ it's\ pool\ destruction,\ no\ need\ to\ return\ object\ to\ backend,}}
\DoxyCodeLine{00966\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ only\ remove\ backrefs,\ as\ they\ are\ global}}
\DoxyCodeLine{00967\ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacerml_1_1internal_ab8e65fb38698f5544e2b1fa3127bec85}{removeBackRef}}(lmb-\/>\mbox{\hyperlink{structrml_1_1internal_1_1_large_memory_block_ad97a9f039a803f7f20887a0217b014de}{backRefIdx}});}
\DoxyCodeLine{00968\ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00969\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ clean\ g(Next|Prev)\ to\ prevent\ removing\ lmb}}
\DoxyCodeLine{00970\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ from\ AllLargeBlocksList\ inside\ returnLargeObject}}
\DoxyCodeLine{00971\ \ \ \ \ \ \ \ \ \ \ \ \ \ lmb-\/>\mbox{\hyperlink{structrml_1_1internal_1_1_large_memory_block_a2c2870cb49c99aa7e2438c4662b85b20}{gNext}}\ =\ lmb-\/>\mbox{\hyperlink{structrml_1_1internal_1_1_large_memory_block_a82d0961bf793ad33d0dc11b0f14be14e}{gPrev}}\ =\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{00972\ \ \ \ \ \ \ \ \ \ \ \ \ \ backend-\/>\mbox{\hyperlink{classrml_1_1internal_1_1_backend_a1fcb1bab9ea664ed7202eb5398a12e0b}{returnLargeObject}}(lmb);}
\DoxyCodeLine{00973\ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00974\ \ \ \ \ \ \}}
\DoxyCodeLine{00975\ \}}
\DoxyCodeLine{00976\ }
\DoxyCodeLine{00977\ \mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data}{TLSData}}*\ \mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_acdf684e1b29c9d00886d97b909798488}{MemoryPool::getTLS}}(\textcolor{keywordtype}{bool}\ create)}
\DoxyCodeLine{00978\ \{}
\DoxyCodeLine{00979\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data}{TLSData}}*\ tls\ =\ \mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_a93f7cd65f7ae8f1608a846cded95cd7c}{extMemPool}}.tlsPointerKey.getThreadMallocTLS();}
\DoxyCodeLine{00980\ \ \ \ \ \textcolor{keywordflow}{if}\ (create\ \&\&\ !tls)}
\DoxyCodeLine{00981\ \ \ \ \ \ \ \ \ tls\ =\ \mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_a93f7cd65f7ae8f1608a846cded95cd7c}{extMemPool}}.tlsPointerKey.createTLS(\textcolor{keyword}{this},\ \&\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_a93f7cd65f7ae8f1608a846cded95cd7c}{extMemPool}}.backend);}
\DoxyCodeLine{00982\ \ \ \ \ \textcolor{keywordflow}{return}\ tls;}
\DoxyCodeLine{00983\ \}}
\DoxyCodeLine{00984\ }
\DoxyCodeLine{00985\ \textcolor{comment}{/*}}
\DoxyCodeLine{00986\ \textcolor{comment}{\ *\ Return\ the\ bin\ for\ the\ given\ size.}}
\DoxyCodeLine{00987\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00988\ \textcolor{keyword}{inline}\ \mbox{\hyperlink{classrml_1_1internal_1_1_bin}{Bin}}*\ \mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data_a26c607a6304c0fa325c6604cf7c767ea}{TLSData::getAllocationBin}}(\textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}})}
\DoxyCodeLine{00989\ \{}
\DoxyCodeLine{00990\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data_a140deb931bef016f17cacae4ec0754c3}{bin}}\ +\ \mbox{\hyperlink{namespacerml_1_1internal_a70dcd761b867baccb7ffdb087e52e215}{getIndex}}(\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}});}
\DoxyCodeLine{00991\ \}}
\DoxyCodeLine{00992\ }
\DoxyCodeLine{00993\ \textcolor{comment}{/*\ Return\ an\ empty\ uninitialized\ block\ in\ a\ non-\/blocking\ fashion.\ */}}
\DoxyCodeLine{00994\ \mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}\ *\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_a16261e62d2c6418981ade9a7ea23d5d0}{MemoryPool::getEmptyBlock}}(\textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}})}
\DoxyCodeLine{00995\ \{}
\DoxyCodeLine{00996\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data}{TLSData}}*\ tls\ =\ \mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_acdf684e1b29c9d00886d97b909798488}{getTLS}}(\textcolor{comment}{/*create=*/}\textcolor{keyword}{false});}
\DoxyCodeLine{00997\ \ \ \ \ \textcolor{comment}{//\ try\ to\ use\ per-\/thread\ cache,\ if\ TLS\ available}}
\DoxyCodeLine{00998\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_free_block_pool_1_1_res_of_get}{FreeBlockPool::ResOfGet}}\ resOfGet\ =\ tls?}
\DoxyCodeLine{00999\ \ \ \ \ \ \ \ \ tls-\/>\mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data_a00be57391bf8297f48bab787f963f666}{freeSlabBlocks}}.\mbox{\hyperlink{classrml_1_1internal_1_1_free_block_pool_a3d6745e31d1a809ce90273ba7a8f8ab7}{getBlock}}()\ :\ \mbox{\hyperlink{classrml_1_1internal_1_1_free_block_pool_1_1_res_of_get}{FreeBlockPool::ResOfGet}}(\mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}},\ \textcolor{keyword}{false});}
\DoxyCodeLine{01000\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}\ *\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}}\ =\ resOfGet.\mbox{\hyperlink{classrml_1_1internal_1_1_free_block_pool_1_1_res_of_get_ac96452c87d5f9a987af40afbf216133e}{block}};}
\DoxyCodeLine{01001\ }
\DoxyCodeLine{01002\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}})\ \{\ \textcolor{comment}{//\ not\ found\ in\ local\ cache,\ asks\ backend\ for\ slabs}}
\DoxyCodeLine{01003\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ num\ =\ resOfGet.\mbox{\hyperlink{classrml_1_1internal_1_1_free_block_pool_1_1_res_of_get_aa3699ac885699fdbb8952de8d20dc128}{lastAccMiss}}?\ \mbox{\hyperlink{classrml_1_1internal_1_1_backend_a37fd2d10ce777e87cc7ddfe55249f0f6}{Backend::numOfSlabAllocOnMiss}}\ :\ 1;}
\DoxyCodeLine{01004\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_back_ref_idx}{BackRefIdx}}\ backRefIdx[\mbox{\hyperlink{classrml_1_1internal_1_1_backend_a37fd2d10ce777e87cc7ddfe55249f0f6}{Backend::numOfSlabAllocOnMiss}}];}
\DoxyCodeLine{01005\ }
\DoxyCodeLine{01006\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}}\ =\ \textcolor{keyword}{static\_cast<}\mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}*\textcolor{keyword}{>}(\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_a93f7cd65f7ae8f1608a846cded95cd7c}{extMemPool}}.backend.getSlabBlock(num));}
\DoxyCodeLine{01007\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}})\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{01008\ }
\DoxyCodeLine{01009\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_a93f7cd65f7ae8f1608a846cded95cd7c}{extMemPool}}.userPool())}
\DoxyCodeLine{01010\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}=0;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}<num;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}++)\ \{}
\DoxyCodeLine{01011\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ backRefIdx[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}]\ =\ BackRefIdx::newBackRef(\textcolor{comment}{/*largeObj=*/}\textcolor{keyword}{false});}
\DoxyCodeLine{01012\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (backRefIdx[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}].isInvalid())\ \{}
\DoxyCodeLine{01013\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ roll\ back\ resource\ allocation}}
\DoxyCodeLine{01014\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}=0;\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}<\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}};\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}++)}
\DoxyCodeLine{01015\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacerml_1_1internal_ab8e65fb38698f5544e2b1fa3127bec85}{removeBackRef}}(backRefIdx[\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}]);}
\DoxyCodeLine{01016\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}\ *\mbox{\hyperlink{offscreen_8c_a846c9667e34d56c560bb7f0ac6e173f6}{b}}\ =\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}};}
\DoxyCodeLine{01017\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}=0;\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}<num;\ \mbox{\hyperlink{offscreen_8c_a846c9667e34d56c560bb7f0ac6e173f6}{b}}=(\mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}*)((uintptr\_t)\mbox{\hyperlink{offscreen_8c_a846c9667e34d56c560bb7f0ac6e173f6}{b}}+\mbox{\hyperlink{namespacerml_1_1internal_ab92a44f5c0d4ae24554856afbba1943d}{slabSize}}),\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}++)}
\DoxyCodeLine{01018\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_a93f7cd65f7ae8f1608a846cded95cd7c}{extMemPool}}.backend.putSlabBlock(\mbox{\hyperlink{offscreen_8c_a846c9667e34d56c560bb7f0ac6e173f6}{b}});}
\DoxyCodeLine{01019\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{01020\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01021\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01022\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ resources\ were\ allocated,\ register\ blocks}}
\DoxyCodeLine{01023\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}\ *\mbox{\hyperlink{offscreen_8c_a846c9667e34d56c560bb7f0ac6e173f6}{b}}\ =\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}};}
\DoxyCodeLine{01024\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}=0;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}<num;\ \mbox{\hyperlink{offscreen_8c_a846c9667e34d56c560bb7f0ac6e173f6}{b}}=(\mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}*)((uintptr\_t)\mbox{\hyperlink{offscreen_8c_a846c9667e34d56c560bb7f0ac6e173f6}{b}}+\mbox{\hyperlink{namespacerml_1_1internal_ab92a44f5c0d4ae24554856afbba1943d}{slabSize}}),\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}++)\ \{}
\DoxyCodeLine{01025\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ slab\ block\ in\ user's\ pool\ must\ have\ invalid\ backRefIdx}}
\DoxyCodeLine{01026\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_a93f7cd65f7ae8f1608a846cded95cd7c}{extMemPool}}.userPool())\ \{}
\DoxyCodeLine{01027\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{new}\ (\&\mbox{\hyperlink{offscreen_8c_a846c9667e34d56c560bb7f0ac6e173f6}{b}}-\/>backRefIdx)\ \mbox{\hyperlink{classrml_1_1internal_1_1_back_ref_idx}{BackRefIdx}}();}
\DoxyCodeLine{01028\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01029\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacerml_1_1internal_aa5ddbf0f60817126c51b54ca648caf34}{setBackRef}}(backRefIdx[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}],\ \mbox{\hyperlink{offscreen_8c_a846c9667e34d56c560bb7f0ac6e173f6}{b}});}
\DoxyCodeLine{01030\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{offscreen_8c_a846c9667e34d56c560bb7f0ac6e173f6}{b}}-\/>backRefIdx\ =\ backRefIdx[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}];}
\DoxyCodeLine{01031\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01032\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{offscreen_8c_a846c9667e34d56c560bb7f0ac6e173f6}{b}}-\/>tlsPtr\ =\ tls;}
\DoxyCodeLine{01033\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{offscreen_8c_a846c9667e34d56c560bb7f0ac6e173f6}{b}}-\/>poolPtr\ =\ \textcolor{keyword}{this};}
\DoxyCodeLine{01034\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ all\ but\ first\ one\ go\ to\ per-\/thread\ pool}}
\DoxyCodeLine{01035\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ >\ 0)\ \{}
\DoxyCodeLine{01036\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(tls,\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}});}
\DoxyCodeLine{01037\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tls-\/>\mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data_a00be57391bf8297f48bab787f963f666}{freeSlabBlocks}}.\mbox{\hyperlink{classrml_1_1internal_1_1_free_block_pool_a98adf682213916f2d39812b170938b4a}{returnBlock}}(\mbox{\hyperlink{offscreen_8c_a846c9667e34d56c560bb7f0ac6e173f6}{b}});}
\DoxyCodeLine{01038\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01039\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01040\ \ \ \ \ \}}
\DoxyCodeLine{01041\ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}},\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}});}
\DoxyCodeLine{01042\ \ \ \ \ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}}-\/>initEmptyBlock(tls,\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}});}
\DoxyCodeLine{01043\ \ \ \ \ \mbox{\hyperlink{tbbmalloc_2statistics_8h_a45adf7cb101679d45b142782cc324196}{STAT\_increment}}(\mbox{\hyperlink{namespacerml_1_1internal_a2877b2db91c23b8b7eb1d37891c40b2b}{getThreadId}}(),\ \mbox{\hyperlink{namespacerml_1_1internal_a70dcd761b867baccb7ffdb087e52e215}{getIndex}}(\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}}-\/>objectSize),\ \mbox{\hyperlink{tbbmalloc_2statistics_8h_a88d7e7c1f1ccad444adb066d12334d4aa7e369da4f8e1332608bf3e09e081cd02}{allocBlockNew}});}
\DoxyCodeLine{01044\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}};}
\DoxyCodeLine{01045\ \}}
\DoxyCodeLine{01046\ }
\DoxyCodeLine{01047\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_a7a5bf7ebdfc09d422f7862d8d4063795}{MemoryPool::returnEmptyBlock}}(\mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}\ *\mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}},\ \textcolor{keywordtype}{bool}\ poolTheBlock)}
\DoxyCodeLine{01048\ \{}
\DoxyCodeLine{01049\ \ \ \ \ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}-\/>reset();}
\DoxyCodeLine{01050\ \ \ \ \ \textcolor{keywordflow}{if}\ (poolTheBlock)\ \{}
\DoxyCodeLine{01051\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_acdf684e1b29c9d00886d97b909798488}{getTLS}}(\textcolor{comment}{/*create=*/}\textcolor{keyword}{false})-\/>\mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data_a00be57391bf8297f48bab787f963f666}{freeSlabBlocks}}.\mbox{\hyperlink{classrml_1_1internal_1_1_free_block_pool_a98adf682213916f2d39812b170938b4a}{returnBlock}}(\mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}});}
\DoxyCodeLine{01052\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01053\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ slab\ blocks\ in\ user's\ pools\ do\ not\ have\ valid\ backRefIdx}}
\DoxyCodeLine{01054\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_a93f7cd65f7ae8f1608a846cded95cd7c}{extMemPool}}.userPool())}
\DoxyCodeLine{01055\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacerml_1_1internal_ab8e65fb38698f5544e2b1fa3127bec85}{removeBackRef}}(*(\mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}-\/>getBackRefIdx()));}
\DoxyCodeLine{01056\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_a93f7cd65f7ae8f1608a846cded95cd7c}{extMemPool}}.backend.putSlabBlock(\mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}});}
\DoxyCodeLine{01057\ \ \ \ \ \}}
\DoxyCodeLine{01058\ \}}
\DoxyCodeLine{01059\ }
\DoxyCodeLine{01060\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{structrml_1_1internal_1_1_ext_memory_pool_ae8e7d952a9a6dbb43605a290997a6cc6}{ExtMemoryPool::init}}(intptr\_t\ \mbox{\hyperlink{structrml_1_1internal_1_1_ext_memory_pool_a7446458fc55a25205035be6cdb62df4b}{poolId}},\ rawAllocType\ \mbox{\hyperlink{structrml_1_1internal_1_1_ext_memory_pool_a1d8ad0bd4a6c28ab90a9c0e96a3d1bf7}{rawAlloc}},}
\DoxyCodeLine{01061\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ rawFreeType\ \mbox{\hyperlink{structrml_1_1internal_1_1_ext_memory_pool_a993c9d0e9c8a6ca40b76a51c907f662a}{rawFree}},\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{structrml_1_1internal_1_1_ext_memory_pool_a29bfd6715f573c62dd721464fe92698b}{granularity}},}
\DoxyCodeLine{01062\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{structrml_1_1internal_1_1_ext_memory_pool_a72cac70cd2102374a0ce820237c3d655}{keepAllMemory}},\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{structrml_1_1internal_1_1_ext_memory_pool_a978e0b112031bed60263674f71b7f5a5}{fixedPool}})}
\DoxyCodeLine{01063\ \{}
\DoxyCodeLine{01064\ \ \ \ \ this-\/>poolId\ =\ \mbox{\hyperlink{structrml_1_1internal_1_1_ext_memory_pool_a7446458fc55a25205035be6cdb62df4b}{poolId}};}
\DoxyCodeLine{01065\ \ \ \ \ this-\/>rawAlloc\ =\ \mbox{\hyperlink{structrml_1_1internal_1_1_ext_memory_pool_a1d8ad0bd4a6c28ab90a9c0e96a3d1bf7}{rawAlloc}};}
\DoxyCodeLine{01066\ \ \ \ \ this-\/>rawFree\ =\ \mbox{\hyperlink{structrml_1_1internal_1_1_ext_memory_pool_a993c9d0e9c8a6ca40b76a51c907f662a}{rawFree}};}
\DoxyCodeLine{01067\ \ \ \ \ this-\/>granularity\ =\ \mbox{\hyperlink{structrml_1_1internal_1_1_ext_memory_pool_a29bfd6715f573c62dd721464fe92698b}{granularity}};}
\DoxyCodeLine{01068\ \ \ \ \ this-\/>keepAllMemory\ =\ \mbox{\hyperlink{structrml_1_1internal_1_1_ext_memory_pool_a72cac70cd2102374a0ce820237c3d655}{keepAllMemory}};}
\DoxyCodeLine{01069\ \ \ \ \ this-\/>fixedPool\ =\ \mbox{\hyperlink{structrml_1_1internal_1_1_ext_memory_pool_a978e0b112031bed60263674f71b7f5a5}{fixedPool}};}
\DoxyCodeLine{01070\ \ \ \ \ this-\/>\mbox{\hyperlink{structrml_1_1internal_1_1_ext_memory_pool_a117b9e963f323eebb1742a3d5802fa65}{delayRegsReleasing}}\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01071\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{structrml_1_1internal_1_1_ext_memory_pool_ae6fece579999c6cdabc48ea2c18baee3}{initTLS}}())}
\DoxyCodeLine{01072\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01073\ \ \ \ \ \mbox{\hyperlink{structrml_1_1internal_1_1_ext_memory_pool_a278849f2903427f0b7f96f677204b995}{loc}}.init(\textcolor{keyword}{this});}
\DoxyCodeLine{01074\ \ \ \ \ \mbox{\hyperlink{structrml_1_1internal_1_1_ext_memory_pool_a86fdbadea90130b4aa51a5e1f2bb8fb3}{backend}}.init(\textcolor{keyword}{this});}
\DoxyCodeLine{01075\ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\mbox{\hyperlink{structrml_1_1internal_1_1_ext_memory_pool_ab66c85117dac4f9bbc977fca349f9887}{isPoolValid}}(),\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}});}
\DoxyCodeLine{01076\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{01077\ \}}
\DoxyCodeLine{01078\ }
\DoxyCodeLine{01079\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{structrml_1_1internal_1_1_ext_memory_pool_ae6fece579999c6cdabc48ea2c18baee3}{ExtMemoryPool::initTLS}}()\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structrml_1_1internal_1_1_ext_memory_pool_a8b3cd2c2364c73142c7eed261fa14be3}{tlsPointerKey}}.init();\ \}}
\DoxyCodeLine{01080\ }
\DoxyCodeLine{01081\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_a7b9f97bc41fa9c3d5fb6d3e7bbe4180d}{MemoryPool::init}}(intptr\_t\ poolId,\ \textcolor{keyword}{const}\ MemPoolPolicy\ *policy)}
\DoxyCodeLine{01082\ \{}
\DoxyCodeLine{01083\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_a93f7cd65f7ae8f1608a846cded95cd7c}{extMemPool}}.init(poolId,\ policy-\/>pAlloc,\ policy-\/>pFree,}
\DoxyCodeLine{01084\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ policy-\/>granularity?\ policy-\/>granularity\ :\ \mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_a97cf2383f445b70fb210cdf30d410c11}{defaultGranularity}},}
\DoxyCodeLine{01085\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ policy-\/>keepAllMemory,\ policy-\/>fixedPool))}
\DoxyCodeLine{01086\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01087\ \ \ \ \ \{}
\DoxyCodeLine{01088\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_malloc_mutex_1_1scoped__lock}{MallocMutex::scoped\_lock}}\ \mbox{\hyperlink{ittnotify__static_8h_a46e8be2e3aadb2f6ee62e762a36b9243}{lock}}(\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_ae2f9869ec6e87cbdeabf13d365d49f62}{memPoolListLock}});}
\DoxyCodeLine{01089\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_abe53d310d639ead4d055119d5a2b5552}{next}}\ =\ \mbox{\hyperlink{namespacerml_1_1internal_a775ef3ae8dd6b242d20f44ebd787a1be}{defaultMemPool}}-\/>next;}
\DoxyCodeLine{01090\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacerml_1_1internal_a775ef3ae8dd6b242d20f44ebd787a1be}{defaultMemPool}}-\/>next\ =\ \textcolor{keyword}{this};}
\DoxyCodeLine{01091\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_aee4c5ad03dce6827a776cedbf53339d9}{prev}}\ =\ \mbox{\hyperlink{namespacerml_1_1internal_a775ef3ae8dd6b242d20f44ebd787a1be}{defaultMemPool}};}
\DoxyCodeLine{01092\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_abe53d310d639ead4d055119d5a2b5552}{next}})}
\DoxyCodeLine{01093\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_abe53d310d639ead4d055119d5a2b5552}{next}}-\/>prev\ =\ \textcolor{keyword}{this};}
\DoxyCodeLine{01094\ \ \ \ \ \}}
\DoxyCodeLine{01095\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{01096\ \}}
\DoxyCodeLine{01097\ }
\DoxyCodeLine{01098\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_a906373d1f7c52a00bf31f841d46ce281}{MemoryPool::reset}}()}
\DoxyCodeLine{01099\ \{}
\DoxyCodeLine{01100\ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_a93f7cd65f7ae8f1608a846cded95cd7c}{extMemPool}}.userPool(),\ \textcolor{stringliteral}{"{}No\ reset\ for\ the\ system\ pool."{}});}
\DoxyCodeLine{01101\ \ \ \ \ \textcolor{comment}{//\ memory\ is\ not\ releasing\ during\ pool\ reset}}
\DoxyCodeLine{01102\ \ \ \ \ \textcolor{comment}{//\ TODO:\ mark\ regions\ to\ release\ unused\ on\ next\ reset()}}
\DoxyCodeLine{01103\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_a93f7cd65f7ae8f1608a846cded95cd7c}{extMemPool}}.delayRegionsReleasing(\textcolor{keyword}{true});}
\DoxyCodeLine{01104\ }
\DoxyCodeLine{01105\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_ab6031f40ff7011e056db5052cd88de22}{bootStrapBlocks}}.reset();}
\DoxyCodeLine{01106\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_a93f7cd65f7ae8f1608a846cded95cd7c}{extMemPool}}.lmbList.releaseAll<\textcolor{comment}{/*poolDestroy=*/}\textcolor{keyword}{false}>(\&\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_a93f7cd65f7ae8f1608a846cded95cd7c}{extMemPool}}.backend);}
\DoxyCodeLine{01107\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_a93f7cd65f7ae8f1608a846cded95cd7c}{extMemPool}}.reset())}
\DoxyCodeLine{01108\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01109\ }
\DoxyCodeLine{01110\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_a93f7cd65f7ae8f1608a846cded95cd7c}{extMemPool}}.initTLS())}
\DoxyCodeLine{01111\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01112\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_a93f7cd65f7ae8f1608a846cded95cd7c}{extMemPool}}.delayRegionsReleasing(\textcolor{keyword}{false});}
\DoxyCodeLine{01113\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{01114\ \}}
\DoxyCodeLine{01115\ }
\DoxyCodeLine{01116\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_ac77d7b8f6b4cd31f7f3e49b0d7676196}{MemoryPool::destroy}}()}
\DoxyCodeLine{01117\ \{}
\DoxyCodeLine{01118\ \textcolor{preprocessor}{\#if\ \_\_TBB\_MALLOC\_LOCACHE\_STAT}}
\DoxyCodeLine{01119\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_a93f7cd65f7ae8f1608a846cded95cd7c}{extMemPool}}.loc.reportStat(stdout);}
\DoxyCodeLine{01120\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01121\ \textcolor{preprocessor}{\#if\ \_\_TBB\_MALLOC\_BACKEND\_STAT}}
\DoxyCodeLine{01122\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_a93f7cd65f7ae8f1608a846cded95cd7c}{extMemPool}}.backend.reportStat(stdout);}
\DoxyCodeLine{01123\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01124\ \ \ \ \ \{}
\DoxyCodeLine{01125\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_malloc_mutex_1_1scoped__lock}{MallocMutex::scoped\_lock}}\ \mbox{\hyperlink{ittnotify__static_8h_a46e8be2e3aadb2f6ee62e762a36b9243}{lock}}(\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_ae2f9869ec6e87cbdeabf13d365d49f62}{memPoolListLock}});}
\DoxyCodeLine{01126\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ remove\ itself\ from\ global\ pool\ list}}
\DoxyCodeLine{01127\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_aee4c5ad03dce6827a776cedbf53339d9}{prev}})}
\DoxyCodeLine{01128\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_aee4c5ad03dce6827a776cedbf53339d9}{prev}}-\/>next\ =\ \mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_abe53d310d639ead4d055119d5a2b5552}{next}};}
\DoxyCodeLine{01129\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_abe53d310d639ead4d055119d5a2b5552}{next}})}
\DoxyCodeLine{01130\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_abe53d310d639ead4d055119d5a2b5552}{next}}-\/>prev\ =\ \mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_aee4c5ad03dce6827a776cedbf53339d9}{prev}};}
\DoxyCodeLine{01131\ \ \ \ \ \}}
\DoxyCodeLine{01132\ \ \ \ \ \textcolor{comment}{//\ slab\ blocks\ in\ non-\/default\ pool\ do\ not\ have\ backreferences,}}
\DoxyCodeLine{01133\ \ \ \ \ \textcolor{comment}{//\ only\ large\ objects\ do}}
\DoxyCodeLine{01134\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_a93f7cd65f7ae8f1608a846cded95cd7c}{extMemPool}}.userPool())}
\DoxyCodeLine{01135\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_a93f7cd65f7ae8f1608a846cded95cd7c}{extMemPool}}.lmbList.releaseAll<\textcolor{comment}{/*poolDestroy=*/}\textcolor{keyword}{true}>(\&\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_a93f7cd65f7ae8f1608a846cded95cd7c}{extMemPool}}.backend);}
\DoxyCodeLine{01136\ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01137\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ only\ one\ non-\/userPool()\ is\ supported\ now}}
\DoxyCodeLine{01138\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\textcolor{keyword}{this}==\mbox{\hyperlink{namespacerml_1_1internal_a775ef3ae8dd6b242d20f44ebd787a1be}{defaultMemPool}},\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}});}
\DoxyCodeLine{01139\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ There\ and\ below\ in\ extMemPool.destroy(),\ do\ not\ restore\ initial\ state}}
\DoxyCodeLine{01140\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ for\ user\ pool,\ because\ it's\ just\ about\ to\ be\ released.\ But\ for\ system}}
\DoxyCodeLine{01141\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ pool\ restoring,\ we\ do\ not\ want\ to\ do\ zeroing\ of\ it\ on\ subsequent\ reload.}}
\DoxyCodeLine{01142\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_ab6031f40ff7011e056db5052cd88de22}{bootStrapBlocks}}.reset();}
\DoxyCodeLine{01143\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_a93f7cd65f7ae8f1608a846cded95cd7c}{extMemPool}}.orphanedBlocks.reset();}
\DoxyCodeLine{01144\ \ \ \ \ \}}
\DoxyCodeLine{01145\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_a93f7cd65f7ae8f1608a846cded95cd7c}{extMemPool}}.destroy();}
\DoxyCodeLine{01146\ \}}
\DoxyCodeLine{01147\ }
\DoxyCodeLine{01148\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_a2a310517ff92f8e0e7dae29400ffeb61}{MemoryPool::onThreadShutdown}}(\mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data}{TLSData}}\ *tlsData)}
\DoxyCodeLine{01149\ \{}
\DoxyCodeLine{01150\ \ \ \ \ \textcolor{keywordflow}{if}\ (tlsData)\ \{\ \textcolor{comment}{//\ might\ be\ called\ for\ "{}empty"{}\ TLS}}
\DoxyCodeLine{01151\ \ \ \ \ \ \ \ \ tlsData-\/>\mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data_a782f29462cd5eaf08ad7beec48e88761}{release}}();}
\DoxyCodeLine{01152\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_ab6031f40ff7011e056db5052cd88de22}{bootStrapBlocks}}.free(tlsData);}
\DoxyCodeLine{01153\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_ae55f3e31dc8bce61a9e97a6a83283d12}{clearTLS}}();}
\DoxyCodeLine{01154\ \ \ \ \ \}}
\DoxyCodeLine{01155\ \}}
\DoxyCodeLine{01156\ }
\DoxyCodeLine{01157\ \textcolor{preprocessor}{\#if\ MALLOC\_DEBUG}}
\DoxyCodeLine{01158\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1internal_1_1_bin_a1ec1f87fab1f4e4f36bb401ce5c4bb87}{Bin::verifyTLSBin}}\ (\textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}})\textcolor{keyword}{\ const}}
\DoxyCodeLine{01159\ \textcolor{keyword}{}\{}
\DoxyCodeLine{01160\ \textcolor{comment}{/*\ The\ debug\ version\ verifies\ the\ TLSBin\ as\ needed\ */}}
\DoxyCodeLine{01161\ \ \ \ \ \mbox{\hyperlink{eabase_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t}}\ objSize\ =\ \mbox{\hyperlink{namespacerml_1_1internal_af01ec297511bd9be238191aa74fcf9fc}{getObjectSize}}(\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}});}
\DoxyCodeLine{01162\ }
\DoxyCodeLine{01163\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classrml_1_1internal_1_1_bin_ab97ae6d4fad5c846576164dcfc44702a}{activeBlk}})\ \{}
\DoxyCodeLine{01164\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ \mbox{\hyperlink{classrml_1_1internal_1_1_bin_ab97ae6d4fad5c846576164dcfc44702a}{activeBlk}}-\/>\mbox{\hyperlink{classrml_1_1internal_1_1_block_a764948ac32e7d5689a755e4af99308e2}{isOwnedByCurrentThread}}(),\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );}
\DoxyCodeLine{01165\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ \mbox{\hyperlink{classrml_1_1internal_1_1_bin_ab97ae6d4fad5c846576164dcfc44702a}{activeBlk}}-\/>\mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a0e116178c7df6b87077b7b029a0fe653}{objectSize}}\ ==\ objSize,\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );}
\DoxyCodeLine{01166\ \textcolor{preprocessor}{\#if\ MALLOC\_DEBUG>1}}
\DoxyCodeLine{01167\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}*\ temp\ =\ \mbox{\hyperlink{classrml_1_1internal_1_1_bin_ab97ae6d4fad5c846576164dcfc44702a}{activeBlk}}-\/>\mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_ab0858e200e0125219210fe856e98fa28}{next}};\ temp;\ temp=temp-\/>\mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_ab0858e200e0125219210fe856e98fa28}{next}})\ \{}
\DoxyCodeLine{01168\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ temp!=\mbox{\hyperlink{classrml_1_1internal_1_1_bin_ab97ae6d4fad5c846576164dcfc44702a}{activeBlk}},\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );}
\DoxyCodeLine{01169\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ temp-\/>isOwnedByCurrentThread(),\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );}
\DoxyCodeLine{01170\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ temp-\/>objectSize\ ==\ objSize,\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );}
\DoxyCodeLine{01171\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ temp-\/>previous-\/>next\ ==\ temp,\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );}
\DoxyCodeLine{01172\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (temp-\/>next)\ \{}
\DoxyCodeLine{01173\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ temp-\/>next-\/>previous\ ==\ temp,\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );}
\DoxyCodeLine{01174\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01175\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01176\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}*\ temp\ =\ \mbox{\hyperlink{classrml_1_1internal_1_1_bin_ab97ae6d4fad5c846576164dcfc44702a}{activeBlk}}-\/>\mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a3a5c6afadff504e7196e643938f26cad}{previous}};\ temp;\ temp=temp-\/>\mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a3a5c6afadff504e7196e643938f26cad}{previous}})\ \{}
\DoxyCodeLine{01177\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ temp!=\mbox{\hyperlink{classrml_1_1internal_1_1_bin_ab97ae6d4fad5c846576164dcfc44702a}{activeBlk}},\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );}
\DoxyCodeLine{01178\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ temp-\/>isOwnedByCurrentThread(),\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );}
\DoxyCodeLine{01179\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ temp-\/>objectSize\ ==\ objSize,\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );}
\DoxyCodeLine{01180\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ temp-\/>next-\/>previous\ ==\ temp,\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );}
\DoxyCodeLine{01181\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (temp-\/>previous)\ \{}
\DoxyCodeLine{01182\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ temp-\/>previous-\/>next\ ==\ temp,\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );}
\DoxyCodeLine{01183\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01184\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01185\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{/*\ MALLOC\_DEBUG>1\ */}\textcolor{preprocessor}{}}
\DoxyCodeLine{01186\ \ \ \ \ \}}
\DoxyCodeLine{01187\ \}}
\DoxyCodeLine{01188\ \textcolor{preprocessor}{\#else\ }\textcolor{comment}{/*\ MALLOC\_DEBUG\ */}\textcolor{preprocessor}{}}
\DoxyCodeLine{01189\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1internal_1_1_bin_a1ec1f87fab1f4e4f36bb401ce5c4bb87}{Bin::verifyTLSBin}}\ (\textcolor{keywordtype}{size\_t})\textcolor{keyword}{\ const\ }\{\ \}}
\DoxyCodeLine{01190\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{/*\ MALLOC\_DEBUG\ */}\textcolor{preprocessor}{}}
\DoxyCodeLine{01191\ }
\DoxyCodeLine{01192\ \textcolor{comment}{/*}}
\DoxyCodeLine{01193\ \textcolor{comment}{\ *\ Add\ a\ block\ to\ the\ start\ of\ this\ tls\ bin\ list.}}
\DoxyCodeLine{01194\ \textcolor{comment}{\ */}}
\DoxyCodeLine{01195\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1internal_1_1_bin_a88e5bf9d3eb59a30e58f3dc23e240d4e}{Bin::pushTLSBin}}(\mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}*\ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}})}
\DoxyCodeLine{01196\ \{}
\DoxyCodeLine{01197\ \ \ \ \ \textcolor{comment}{/*\ The\ objectSize\ should\ be\ defined\ and\ not\ a\ parameter}}
\DoxyCodeLine{01198\ \textcolor{comment}{\ \ \ \ \ \ \ because\ the\ function\ is\ applied\ to\ partially\ filled\ blocks\ as\ well\ */}}
\DoxyCodeLine{01199\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}}\ =\ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}-\/>objectSize;}
\DoxyCodeLine{01200\ }
\DoxyCodeLine{01201\ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}-\/>isOwnedByCurrentThread(),\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );}
\DoxyCodeLine{01202\ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}-\/>objectSize\ !=\ 0,\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );}
\DoxyCodeLine{01203\ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}-\/>next\ ==\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}},\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );}
\DoxyCodeLine{01204\ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}-\/>previous\ ==\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}},\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );}
\DoxyCodeLine{01205\ }
\DoxyCodeLine{01206\ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ \textcolor{keyword}{this},\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );}
\DoxyCodeLine{01207\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_bin_a1ec1f87fab1f4e4f36bb401ce5c4bb87}{verifyTLSBin}}(\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}});}
\DoxyCodeLine{01208\ }
\DoxyCodeLine{01209\ \ \ \ \ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}-\/>next\ =\ \mbox{\hyperlink{classrml_1_1internal_1_1_bin_ab97ae6d4fad5c846576164dcfc44702a}{activeBlk}};}
\DoxyCodeLine{01210\ \ \ \ \ \textcolor{keywordflow}{if}(\ \mbox{\hyperlink{classrml_1_1internal_1_1_bin_ab97ae6d4fad5c846576164dcfc44702a}{activeBlk}}\ )\ \{}
\DoxyCodeLine{01211\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}-\/>previous\ =\ \mbox{\hyperlink{classrml_1_1internal_1_1_bin_ab97ae6d4fad5c846576164dcfc44702a}{activeBlk}}-\/>previous;}
\DoxyCodeLine{01212\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_bin_ab97ae6d4fad5c846576164dcfc44702a}{activeBlk}}-\/>previous\ =\ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}};}
\DoxyCodeLine{01213\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}-\/>previous\ )}
\DoxyCodeLine{01214\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}-\/>previous-\/>next\ =\ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}};}
\DoxyCodeLine{01215\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01216\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_bin_ab97ae6d4fad5c846576164dcfc44702a}{activeBlk}}\ =\ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}};}
\DoxyCodeLine{01217\ \ \ \ \ \}}
\DoxyCodeLine{01218\ }
\DoxyCodeLine{01219\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_bin_a1ec1f87fab1f4e4f36bb401ce5c4bb87}{verifyTLSBin}}(\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}});}
\DoxyCodeLine{01220\ \}}
\DoxyCodeLine{01221\ }
\DoxyCodeLine{01222\ \textcolor{comment}{/*}}
\DoxyCodeLine{01223\ \textcolor{comment}{\ *\ Take\ a\ block\ out\ of\ its\ tls\ bin\ (e.g.\ before\ removal).}}
\DoxyCodeLine{01224\ \textcolor{comment}{\ */}}
\DoxyCodeLine{01225\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1internal_1_1_bin_adb853b6ddddbdbaff1ce9fbdbd560f40}{Bin::outofTLSBin}}(\mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}*\ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}})}
\DoxyCodeLine{01226\ \{}
\DoxyCodeLine{01227\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}}\ =\ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}-\/>objectSize;}
\DoxyCodeLine{01228\ }
\DoxyCodeLine{01229\ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}-\/>isOwnedByCurrentThread(),\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );}
\DoxyCodeLine{01230\ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}-\/>objectSize\ !=\ 0,\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );}
\DoxyCodeLine{01231\ }
\DoxyCodeLine{01232\ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ \textcolor{keyword}{this},\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );}
\DoxyCodeLine{01233\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_bin_a1ec1f87fab1f4e4f36bb401ce5c4bb87}{verifyTLSBin}}(\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}});}
\DoxyCodeLine{01234\ }
\DoxyCodeLine{01235\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}\ ==\ \mbox{\hyperlink{classrml_1_1internal_1_1_bin_ab97ae6d4fad5c846576164dcfc44702a}{activeBlk}})\ \{}
\DoxyCodeLine{01236\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_bin_ab97ae6d4fad5c846576164dcfc44702a}{activeBlk}}\ =\ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}-\/>previous?\ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}-\/>previous\ :\ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}-\/>next;}
\DoxyCodeLine{01237\ \ \ \ \ \}}
\DoxyCodeLine{01238\ \ \ \ \ \textcolor{comment}{/*\ Unlink\ the\ block\ */}}
\DoxyCodeLine{01239\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}-\/>previous)\ \{}
\DoxyCodeLine{01240\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}-\/>previous-\/>next\ ==\ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}},\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );}
\DoxyCodeLine{01241\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}-\/>previous-\/>next\ =\ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}-\/>next;}
\DoxyCodeLine{01242\ \ \ \ \ \}}
\DoxyCodeLine{01243\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}-\/>next)\ \{}
\DoxyCodeLine{01244\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}-\/>next-\/>previous\ ==\ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}},\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );}
\DoxyCodeLine{01245\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}-\/>next-\/>previous\ =\ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}-\/>previous;}
\DoxyCodeLine{01246\ \ \ \ \ \}}
\DoxyCodeLine{01247\ \ \ \ \ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}-\/>next\ =\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{01248\ \ \ \ \ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}-\/>previous\ =\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{01249\ }
\DoxyCodeLine{01250\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_bin_a1ec1f87fab1f4e4f36bb401ce5c4bb87}{verifyTLSBin}}(\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}});}
\DoxyCodeLine{01251\ \}}
\DoxyCodeLine{01252\ }
\DoxyCodeLine{01253\ \mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}*\ \mbox{\hyperlink{classrml_1_1internal_1_1_bin_a94a64e0b7ab5ceec768dd8d976688898}{Bin::getPrivatizedFreeListBlock}}()}
\DoxyCodeLine{01254\ \{}
\DoxyCodeLine{01255\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}*\ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}};}
\DoxyCodeLine{01256\ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ \textcolor{keyword}{this},\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );}
\DoxyCodeLine{01257\ \ \ \ \ \textcolor{comment}{//\ if\ this\ method\ is\ called,\ active\ block\ usage\ must\ be\ unsuccessful}}
\DoxyCodeLine{01258\ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ !\mbox{\hyperlink{classrml_1_1internal_1_1_bin_ab97ae6d4fad5c846576164dcfc44702a}{activeBlk}}\ \&\&\ !\mbox{\hyperlink{classrml_1_1internal_1_1_bin_a97f756c491feed7e3704dca9aeebb935}{mailbox}}\ ||\ \mbox{\hyperlink{classrml_1_1internal_1_1_bin_ab97ae6d4fad5c846576164dcfc44702a}{activeBlk}}\ \&\&\ \mbox{\hyperlink{classrml_1_1internal_1_1_bin_ab97ae6d4fad5c846576164dcfc44702a}{activeBlk}}-\/>isFull,\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );}
\DoxyCodeLine{01259\ }
\DoxyCodeLine{01260\ \textcolor{comment}{//\ the\ counter\ should\ be\ changed\ \ \ \ STAT\_increment(getThreadId(),\ ThreadCommonCounters,\ lockPublicFreeList);}}
\DoxyCodeLine{01261\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{_synchronize_8h_a0792980ea26344eaf2fc0a4112b5d848}{FencedLoad}}((intptr\_t\&)\mbox{\hyperlink{classrml_1_1internal_1_1_bin_a97f756c491feed7e3704dca9aeebb935}{mailbox}}))\ \textcolor{comment}{//\ hotpath\ is\ empty\ mailbox}}
\DoxyCodeLine{01262\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{01263\ \ \ \ \ \textcolor{keywordflow}{else}\ \{\ \textcolor{comment}{//\ mailbox\ is\ not\ empty,\ take\ lock\ and\ inspect\ it}}
\DoxyCodeLine{01264\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_malloc_mutex_1_1scoped__lock}{MallocMutex::scoped\_lock}}\ scoped\_cs(\mbox{\hyperlink{classrml_1_1internal_1_1_bin_a49898470723504724115b4fbdbee64fd}{mailLock}});}
\DoxyCodeLine{01265\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}\ =\ \mbox{\hyperlink{classrml_1_1internal_1_1_bin_a97f756c491feed7e3704dca9aeebb935}{mailbox}};}
\DoxyCodeLine{01266\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}\ )\ \{}
\DoxyCodeLine{01267\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}-\/>isOwnedByCurrentThread(),\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );}
\DoxyCodeLine{01268\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ !\mbox{\hyperlink{namespacerml_1_1internal_a1e643afb71dbda290c1b03a3dbebdfbc}{isNotForUse}}(\mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}-\/>nextPrivatizable),\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );}
\DoxyCodeLine{01269\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_bin_a97f756c491feed7e3704dca9aeebb935}{mailbox}}\ =\ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}-\/>nextPrivatizable;}
\DoxyCodeLine{01270\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}-\/>nextPrivatizable\ =\ (\mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}*)\ \textcolor{keyword}{this};}
\DoxyCodeLine{01271\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01272\ \ \ \ \ \}}
\DoxyCodeLine{01273\ \ \ \ \ \textcolor{keywordflow}{if}(\ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}\ )\ \{}
\DoxyCodeLine{01274\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ \mbox{\hyperlink{namespacerml_1_1internal_acf31583c01d488b00e387c3bfcb23e34}{isSolidPtr}}(\mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}-\/>publicFreeList),\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );}
\DoxyCodeLine{01275\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}-\/>privatizePublicFreeList();}
\DoxyCodeLine{01276\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}-\/>adjustPositionInBin(\textcolor{keyword}{this});}
\DoxyCodeLine{01277\ \ \ \ \ \}}
\DoxyCodeLine{01278\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}};}
\DoxyCodeLine{01279\ \}}
\DoxyCodeLine{01280\ }
\DoxyCodeLine{01281\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1internal_1_1_bin_a581a3ea96dae969984084a00200e2d35}{Bin::addPublicFreeListBlock}}(\mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}*\ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}})}
\DoxyCodeLine{01282\ \{}
\DoxyCodeLine{01283\ \ \ \ \ \mbox{\hyperlink{class_malloc_mutex_1_1scoped__lock}{MallocMutex::scoped\_lock}}\ scoped\_cs(\mbox{\hyperlink{classrml_1_1internal_1_1_bin_a49898470723504724115b4fbdbee64fd}{mailLock}});}
\DoxyCodeLine{01284\ \ \ \ \ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}-\/>nextPrivatizable\ =\ \mbox{\hyperlink{classrml_1_1internal_1_1_bin_a97f756c491feed7e3704dca9aeebb935}{mailbox}};}
\DoxyCodeLine{01285\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_bin_a97f756c491feed7e3704dca9aeebb935}{mailbox}}\ =\ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}};}
\DoxyCodeLine{01286\ \}}
\DoxyCodeLine{01287\ }
\DoxyCodeLine{01288\ \textcolor{comment}{//\ Process\ publicly\ freed\ objects\ in\ all\ blocks\ and\ return\ empty\ blocks}}
\DoxyCodeLine{01289\ \textcolor{comment}{//\ to\ the\ backend\ in\ order\ to\ reduce\ overall\ footprint.}}
\DoxyCodeLine{01290\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classrml_1_1internal_1_1_bin_aef8a87646221418bd9c2bf67afb86c1a}{Bin::cleanPublicFreeLists}}()}
\DoxyCodeLine{01291\ \{}
\DoxyCodeLine{01292\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}*\ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}};}
\DoxyCodeLine{01293\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{_synchronize_8h_a0792980ea26344eaf2fc0a4112b5d848}{FencedLoad}}((intptr\_t\&)\mbox{\hyperlink{classrml_1_1internal_1_1_bin_a97f756c491feed7e3704dca9aeebb935}{mailbox}}))}
\DoxyCodeLine{01294\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01295\ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01296\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Grab\ all\ the\ blocks\ in\ the\ mailbox}}
\DoxyCodeLine{01297\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_malloc_mutex_1_1scoped__lock}{MallocMutex::scoped\_lock}}\ scoped\_cs(\mbox{\hyperlink{classrml_1_1internal_1_1_bin_a49898470723504724115b4fbdbee64fd}{mailLock}});}
\DoxyCodeLine{01298\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}\ =\ \mbox{\hyperlink{classrml_1_1internal_1_1_bin_a97f756c491feed7e3704dca9aeebb935}{mailbox}};}
\DoxyCodeLine{01299\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_bin_a97f756c491feed7e3704dca9aeebb935}{mailbox}}\ =\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{01300\ \ \ \ \ \}}
\DoxyCodeLine{01301\ \ \ \ \ \textcolor{keywordtype}{bool}\ released\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01302\ \ \ \ \ \textcolor{keywordflow}{while}\ (\mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}})\ \{}
\DoxyCodeLine{01303\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}-\/>isOwnedByCurrentThread(),\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );}
\DoxyCodeLine{01304\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}*\ tmp\ =\ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}-\/>nextPrivatizable;}
\DoxyCodeLine{01305\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}-\/>nextPrivatizable\ =\ (\mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}*)\ \textcolor{keyword}{this};}
\DoxyCodeLine{01306\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}-\/>privatizePublicFreeList();}
\DoxyCodeLine{01307\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}-\/>empty())\ \{}
\DoxyCodeLine{01308\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_bin_a0c2e5eadb3e68467ee5635ab367abd46}{processEmptyBlock}}(\mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}},\ \textcolor{comment}{/*poolTheBlock=*/}\textcolor{keyword}{false});}
\DoxyCodeLine{01309\ \ \ \ \ \ \ \ \ \ \ \ \ released\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01310\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}}
\DoxyCodeLine{01311\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}-\/>adjustPositionInBin(\textcolor{keyword}{this});}
\DoxyCodeLine{01312\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}\ =\ tmp;}
\DoxyCodeLine{01313\ \ \ \ \ \}}
\DoxyCodeLine{01314\ \ \ \ \ \textcolor{keywordflow}{return}\ released;}
\DoxyCodeLine{01315\ \}}
\DoxyCodeLine{01316\ }
\DoxyCodeLine{01317\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classrml_1_1internal_1_1_block_ab8c840097b1ff314c170187763e7aeaf}{Block::adjustFullness}}()}
\DoxyCodeLine{01318\ \{}
\DoxyCodeLine{01319\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a7539e25da68797f70368fa66e62e9c1c}{bumpPtr}})\ \{}
\DoxyCodeLine{01320\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ If\ we\ are\ still\ using\ a\ bump\ ptr\ for\ this\ block\ it\ is\ empty\ enough\ to\ use.\ */}}
\DoxyCodeLine{01321\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{tbbmalloc_2statistics_8h_a45adf7cb101679d45b142782cc324196}{STAT\_increment}}(\mbox{\hyperlink{namespacerml_1_1internal_a2877b2db91c23b8b7eb1d37891c40b2b}{getThreadId}}(),\ \mbox{\hyperlink{namespacerml_1_1internal_a70dcd761b867baccb7ffdb087e52e215}{getIndex}}(\mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a0e116178c7df6b87077b7b029a0fe653}{objectSize}}),\ \mbox{\hyperlink{tbbmalloc_2statistics_8h_a88d7e7c1f1ccad444adb066d12334d4aa2d5ad75ff5379f1437faff731963cccf}{examineEmptyEnough}});}
\DoxyCodeLine{01322\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a76d70cbe8837862cdf286a120266e430}{isFull}}\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01323\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01324\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{float}\ threshold\ =\ (\mbox{\hyperlink{namespacerml_1_1internal_ab92a44f5c0d4ae24554856afbba1943d}{slabSize}}\ -\/\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}))\ *\ (1\ -\/\ \mbox{\hyperlink{classrml_1_1internal_1_1_block_aebbd21b8c6cb1b5c94b81443ba227237}{emptyEnoughRatio}});}
\DoxyCodeLine{01325\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ allocatedCount\ shows\ how\ many\ objects\ in\ the\ block\ are\ in\ use;\ however\ it\ still\ counts}}
\DoxyCodeLine{01326\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ blocks\ freed\ by\ other\ threads;\ so\ prior\ call\ to\ privatizePublicFreeList()\ is\ recommended\ */}}
\DoxyCodeLine{01327\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a76d70cbe8837862cdf286a120266e430}{isFull}}\ =\ (\mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a7d1d7c70675b3ba72924d1cbafd6772a}{allocatedCount}}*\mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a0e116178c7df6b87077b7b029a0fe653}{objectSize}}\ >\ threshold)\ ?\ \textcolor{keyword}{true}\ :\ \textcolor{keyword}{false};}
\DoxyCodeLine{01328\ \textcolor{preprocessor}{\#if\ COLLECT\_STATISTICS}}
\DoxyCodeLine{01329\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a76d70cbe8837862cdf286a120266e430}{isFull}})}
\DoxyCodeLine{01330\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{tbbmalloc_2statistics_8h_a45adf7cb101679d45b142782cc324196}{STAT\_increment}}(\mbox{\hyperlink{namespacerml_1_1internal_a2877b2db91c23b8b7eb1d37891c40b2b}{getThreadId}}(),\ \mbox{\hyperlink{namespacerml_1_1internal_a70dcd761b867baccb7ffdb087e52e215}{getIndex}}(\mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a0e116178c7df6b87077b7b029a0fe653}{objectSize}}),\ \mbox{\hyperlink{tbbmalloc_2statistics_8h_a88d7e7c1f1ccad444adb066d12334d4aa1f99062b44f4064f0be7912dcc65bc8e}{examineNotEmpty}});}
\DoxyCodeLine{01331\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{01332\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{tbbmalloc_2statistics_8h_a45adf7cb101679d45b142782cc324196}{STAT\_increment}}(\mbox{\hyperlink{namespacerml_1_1internal_a2877b2db91c23b8b7eb1d37891c40b2b}{getThreadId}}(),\ \mbox{\hyperlink{namespacerml_1_1internal_a70dcd761b867baccb7ffdb087e52e215}{getIndex}}(\mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a0e116178c7df6b87077b7b029a0fe653}{objectSize}}),\ \mbox{\hyperlink{tbbmalloc_2statistics_8h_a88d7e7c1f1ccad444adb066d12334d4aa2d5ad75ff5379f1437faff731963cccf}{examineEmptyEnough}});}
\DoxyCodeLine{01333\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01334\ \ \ \ \ \}}
\DoxyCodeLine{01335\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a76d70cbe8837862cdf286a120266e430}{isFull}};}
\DoxyCodeLine{01336\ \}}
\DoxyCodeLine{01337\ }
\DoxyCodeLine{01338\ \textcolor{comment}{//\ This\ method\ resides\ in\ class\ Block,\ and\ not\ in\ class\ Bin,\ in\ order\ to\ avoid}}
\DoxyCodeLine{01339\ \textcolor{comment}{//\ calling\ getAllocationBin\ on\ a\ reasonably\ hot\ path\ in\ Block::freeOwnObject}}
\DoxyCodeLine{01340\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1internal_1_1_block_a43f7aaa2170d48797fa410e8b694a683}{Block::adjustPositionInBin}}(\mbox{\hyperlink{classrml_1_1internal_1_1_block_a6a6bc571688594aded1969d70ba65cce}{Bin}}*\ \mbox{\hyperlink{runtime_2spdlog_2include_2spdlog_2fmt_2bundled_2base_8h_adfa139c9a1902753b3696794759b2c48ac1111bd512b29e821b120b86446026b8}{bin}}\textcolor{comment}{/*=NULL*/})}
\DoxyCodeLine{01341\ \{}
\DoxyCodeLine{01342\ \ \ \ \ \textcolor{comment}{//\ If\ the\ block\ were\ full,\ but\ became\ empty\ enough\ to\ use,}}
\DoxyCodeLine{01343\ \ \ \ \ \textcolor{comment}{//\ move\ it\ to\ the\ front\ of\ the\ list\ }}
\DoxyCodeLine{01344\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a76d70cbe8837862cdf286a120266e430}{isFull}}\ \&\&\ !\mbox{\hyperlink{classrml_1_1internal_1_1_block_ab8c840097b1ff314c170187763e7aeaf}{adjustFullness}}())\ \{}
\DoxyCodeLine{01345\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{runtime_2spdlog_2include_2spdlog_2fmt_2bundled_2base_8h_adfa139c9a1902753b3696794759b2c48ac1111bd512b29e821b120b86446026b8}{bin}})}
\DoxyCodeLine{01346\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{runtime_2spdlog_2include_2spdlog_2fmt_2bundled_2base_8h_adfa139c9a1902753b3696794759b2c48ac1111bd512b29e821b120b86446026b8}{bin}}\ =\ \mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_ac591e79d62cf0ee8907a3e60991d0734}{tlsPtr}}-\/>getAllocationBin(\mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a0e116178c7df6b87077b7b029a0fe653}{objectSize}});}
\DoxyCodeLine{01347\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{runtime_2spdlog_2include_2spdlog_2fmt_2bundled_2base_8h_adfa139c9a1902753b3696794759b2c48ac1111bd512b29e821b120b86446026b8}{bin}}-\/>moveBlockToFront(\textcolor{keyword}{this});}
\DoxyCodeLine{01348\ \ \ \ \ \}}
\DoxyCodeLine{01349\ \}}
\DoxyCodeLine{01350\ }
\DoxyCodeLine{01351\ \textcolor{comment}{/*\ Restore\ the\ bump\ pointer\ for\ an\ empty\ block\ that\ is\ planned\ to\ use\ */}}
\DoxyCodeLine{01352\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1internal_1_1_block_a5df4dfd201e5dd98c7e542e2ed64d990}{Block::restoreBumpPtr}}()}
\DoxyCodeLine{01353\ \{}
\DoxyCodeLine{01354\ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ \mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a7d1d7c70675b3ba72924d1cbafd6772a}{allocatedCount}}\ ==\ 0,\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );}
\DoxyCodeLine{01355\ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ !\mbox{\hyperlink{namespacerml_1_1internal_acf31583c01d488b00e387c3bfcb23e34}{isSolidPtr}}(\mbox{\hyperlink{classrml_1_1internal_1_1_global_block_fields_a250f5629d8827f1821cd6a318d1d6b9b}{publicFreeList}}),\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );}
\DoxyCodeLine{01356\ \ \ \ \ \mbox{\hyperlink{tbbmalloc_2statistics_8h_a45adf7cb101679d45b142782cc324196}{STAT\_increment}}(\mbox{\hyperlink{namespacerml_1_1internal_a2877b2db91c23b8b7eb1d37891c40b2b}{getThreadId}}(),\ \mbox{\hyperlink{namespacerml_1_1internal_a70dcd761b867baccb7ffdb087e52e215}{getIndex}}(\mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a0e116178c7df6b87077b7b029a0fe653}{objectSize}}),\ \mbox{\hyperlink{tbbmalloc_2statistics_8h_a88d7e7c1f1ccad444adb066d12334d4aa35bbd936e99a82e6c2ec6781a9632942}{freeRestoreBumpPtr}});}
\DoxyCodeLine{01357\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a7539e25da68797f70368fa66e62e9c1c}{bumpPtr}}\ =\ (\mbox{\hyperlink{structrml_1_1internal_1_1_free_object}{FreeObject}}\ *)((uintptr\_t)\textcolor{keyword}{this}\ +\ \mbox{\hyperlink{namespacerml_1_1internal_ab92a44f5c0d4ae24554856afbba1943d}{slabSize}}\ -\/\ \mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a0e116178c7df6b87077b7b029a0fe653}{objectSize}});}
\DoxyCodeLine{01358\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_ade8311f40ae3e9114518063032b7c42a}{freeList}}\ =\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{01359\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a76d70cbe8837862cdf286a120266e430}{isFull}}\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01360\ \}}
\DoxyCodeLine{01361\ }
\DoxyCodeLine{01362\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1internal_1_1_block_a2aaa6c2e28d81fd7f29dda1079ba31b6}{Block::freeOwnObject}}(\textcolor{keywordtype}{void}\ *\textcolor{keywordtype}{object})}
\DoxyCodeLine{01363\ \{}
\DoxyCodeLine{01364\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_ac591e79d62cf0ee8907a3e60991d0734}{tlsPtr}}-\/>markUsed();}
\DoxyCodeLine{01365\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a7d1d7c70675b3ba72924d1cbafd6772a}{allocatedCount}}-\/-\/;}
\DoxyCodeLine{01366\ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ \mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a7d1d7c70675b3ba72924d1cbafd6772a}{allocatedCount}}\ <\ (\mbox{\hyperlink{namespacerml_1_1internal_ab92a44f5c0d4ae24554856afbba1943d}{slabSize}}-\/\textcolor{keyword}{sizeof}(\mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}))/\mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a0e116178c7df6b87077b7b029a0fe653}{objectSize}},\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );}
\DoxyCodeLine{01367\ \textcolor{preprocessor}{\#if\ COLLECT\_STATISTICS}}
\DoxyCodeLine{01368\ \ \ \ \ \textcolor{comment}{//\ Note\ that\ getAllocationBin\ is\ not\ called\ on\ the\ hottest\ path\ with\ statistics\ off.}}
\DoxyCodeLine{01369\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_ac591e79d62cf0ee8907a3e60991d0734}{tlsPtr}}-\/>getAllocationBin(\mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a0e116178c7df6b87077b7b029a0fe653}{objectSize}})-\/>getActiveBlock()\ !=\ \textcolor{keyword}{this})}
\DoxyCodeLine{01370\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{tbbmalloc_2statistics_8h_a45adf7cb101679d45b142782cc324196}{STAT\_increment}}(\mbox{\hyperlink{namespacerml_1_1internal_a2877b2db91c23b8b7eb1d37891c40b2b}{getThreadId}}(),\ \mbox{\hyperlink{namespacerml_1_1internal_a70dcd761b867baccb7ffdb087e52e215}{getIndex}}(\mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a0e116178c7df6b87077b7b029a0fe653}{objectSize}}),\ \mbox{\hyperlink{tbbmalloc_2statistics_8h_a88d7e7c1f1ccad444adb066d12334d4aab5d3b38baa254e6a551ab352f2ac90e0}{freeToInactiveBlock}});}
\DoxyCodeLine{01371\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{01372\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{tbbmalloc_2statistics_8h_a45adf7cb101679d45b142782cc324196}{STAT\_increment}}(\mbox{\hyperlink{namespacerml_1_1internal_a2877b2db91c23b8b7eb1d37891c40b2b}{getThreadId}}(),\ \mbox{\hyperlink{namespacerml_1_1internal_a70dcd761b867baccb7ffdb087e52e215}{getIndex}}(\mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a0e116178c7df6b87077b7b029a0fe653}{objectSize}}),\ \mbox{\hyperlink{tbbmalloc_2statistics_8h_a88d7e7c1f1ccad444adb066d12334d4aa6c96e55bcbd592ea0f097ff09a408bea}{freeToActiveBlock}});}
\DoxyCodeLine{01373\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01374\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classrml_1_1internal_1_1_block_a2a7ca914c507f4411cd9d8dd1bd63330}{empty}}())\ \{}
\DoxyCodeLine{01375\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ If\ the\ last\ object\ of\ a\ slab\ is\ freed,\ the\ slab\ cannot\ be\ marked\ full}}
\DoxyCodeLine{01376\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(!\mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a76d70cbe8837862cdf286a120266e430}{isFull}},\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}});}
\DoxyCodeLine{01377\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_ac591e79d62cf0ee8907a3e60991d0734}{tlsPtr}}-\/>getAllocationBin(\mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a0e116178c7df6b87077b7b029a0fe653}{objectSize}})-\/>processEmptyBlock(\textcolor{keyword}{this},\ \textcolor{comment}{/*poolTheBlock=*/}\textcolor{keyword}{true});}
\DoxyCodeLine{01378\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{\ \textcolor{comment}{//\ hot\ path}}
\DoxyCodeLine{01379\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structrml_1_1internal_1_1_free_object}{FreeObject}}\ *objectToFree\ =\ \mbox{\hyperlink{classrml_1_1internal_1_1_block_a1cc1c9493f28b26a694f9206d2b82f3c}{findObjectToFree}}(\textcolor{keywordtype}{object});}
\DoxyCodeLine{01380\ \ \ \ \ \ \ \ \ objectToFree-\/>\mbox{\hyperlink{structrml_1_1internal_1_1_free_object_adee876800dbeeb0dc522da323d709452}{next}}\ =\ \mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_ade8311f40ae3e9114518063032b7c42a}{freeList}};}
\DoxyCodeLine{01381\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_ade8311f40ae3e9114518063032b7c42a}{freeList}}\ =\ objectToFree;}
\DoxyCodeLine{01382\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_block_a43f7aaa2170d48797fa410e8b694a683}{adjustPositionInBin}}();}
\DoxyCodeLine{01383\ \ \ \ \ \}}
\DoxyCodeLine{01384\ \}}
\DoxyCodeLine{01385\ }
\DoxyCodeLine{01386\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1internal_1_1_block_a66007bf10cb5ca6edf3734362e285279}{Block::freePublicObject}}\ (\mbox{\hyperlink{structrml_1_1internal_1_1_free_object}{FreeObject}}\ *objectToFree)}
\DoxyCodeLine{01387\ \{}
\DoxyCodeLine{01388\ \ \ \ \ \mbox{\hyperlink{structrml_1_1internal_1_1_free_object}{FreeObject}}\ *localPublicFreeList;}
\DoxyCodeLine{01389\ }
\DoxyCodeLine{01390\ \ \ \ \ \mbox{\hyperlink{_customize_8h_af8fcb50fd416dc4f6d1165ae21c58eb3}{MALLOC\_ITT\_SYNC\_RELEASING}}(\&\mbox{\hyperlink{classrml_1_1internal_1_1_global_block_fields_a250f5629d8827f1821cd6a318d1d6b9b}{publicFreeList}});}
\DoxyCodeLine{01391\ \textcolor{preprocessor}{\#if\ FREELIST\_NONBLOCKING}}
\DoxyCodeLine{01392\ \ \ \ \ \mbox{\hyperlink{structrml_1_1internal_1_1_free_object}{FreeObject}}\ *temp\ =\ \mbox{\hyperlink{classrml_1_1internal_1_1_global_block_fields_a250f5629d8827f1821cd6a318d1d6b9b}{publicFreeList}};}
\DoxyCodeLine{01393\ \ \ \ \ \textcolor{keywordflow}{do}\ \{}
\DoxyCodeLine{01394\ \ \ \ \ \ \ \ \ localPublicFreeList\ =\ objectToFree-\/>\mbox{\hyperlink{structrml_1_1internal_1_1_free_object_adee876800dbeeb0dc522da323d709452}{next}}\ =\ temp;}
\DoxyCodeLine{01395\ \ \ \ \ \ \ \ \ temp\ =\ (\mbox{\hyperlink{structrml_1_1internal_1_1_free_object}{FreeObject}}*)\mbox{\hyperlink{_synchronize_8h_a204e8f99046d12f598e460aa19ac9516}{AtomicCompareExchange}}(}
\DoxyCodeLine{01396\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (intptr\_t\&)\mbox{\hyperlink{classrml_1_1internal_1_1_global_block_fields_a250f5629d8827f1821cd6a318d1d6b9b}{publicFreeList}},}
\DoxyCodeLine{01397\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (intptr\_t)objectToFree,\ (intptr\_t)localPublicFreeList\ );}
\DoxyCodeLine{01398\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ no\ backoff\ necessary\ because\ trying\ to\ make\ change,\ not\ waiting\ for\ a\ change}}
\DoxyCodeLine{01399\ \ \ \ \ \}\ \textcolor{keywordflow}{while}(\ temp\ !=\ localPublicFreeList\ );}
\DoxyCodeLine{01400\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{01401\ \ \ \ \ \mbox{\hyperlink{tbbmalloc_2statistics_8h_a45adf7cb101679d45b142782cc324196}{STAT\_increment}}(\mbox{\hyperlink{namespacerml_1_1internal_a2877b2db91c23b8b7eb1d37891c40b2b}{getThreadId}}(),\ \mbox{\hyperlink{tbbmalloc_2statistics_8h_a5a9c41cecb75f90ed25e0b1b73f455d3}{ThreadCommonCounters}},\ \mbox{\hyperlink{tbbmalloc_2statistics_8h_ad0224919995a97978c3f07e260461115ae3bf9b2e5185f9e7e9d14988c47e7122}{lockPublicFreeList}});}
\DoxyCodeLine{01402\ \ \ \ \ \{}
\DoxyCodeLine{01403\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_malloc_mutex_1_1scoped__lock}{MallocMutex::scoped\_lock}}\ scoped\_cs(publicFreeListLock);}
\DoxyCodeLine{01404\ \ \ \ \ \ \ \ \ localPublicFreeList\ =\ objectToFree-\/>\mbox{\hyperlink{structrml_1_1internal_1_1_free_object_adee876800dbeeb0dc522da323d709452}{next}}\ =\ \mbox{\hyperlink{classrml_1_1internal_1_1_global_block_fields_a250f5629d8827f1821cd6a318d1d6b9b}{publicFreeList}};}
\DoxyCodeLine{01405\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_global_block_fields_a250f5629d8827f1821cd6a318d1d6b9b}{publicFreeList}}\ =\ objectToFree;}
\DoxyCodeLine{01406\ \ \ \ \ \}}
\DoxyCodeLine{01407\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01408\ }
\DoxyCodeLine{01409\ \ \ \ \ \textcolor{keywordflow}{if}(\ localPublicFreeList==\mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}}\ )\ \{}
\DoxyCodeLine{01410\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ if\ the\ block\ is\ abandoned,\ its\ nextPrivatizable\ pointer\ should\ be\ UNUSABLE}}
\DoxyCodeLine{01411\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ otherwise,\ it\ should\ point\ to\ the\ bin\ the\ block\ belongs\ to.}}
\DoxyCodeLine{01412\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ reading\ nextPrivatizable\ is\ thread-\/safe\ below,\ because:}}
\DoxyCodeLine{01413\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ 1)\ the\ executing\ thread\ atomically\ got\ publicFreeList==NULL\ and\ changed\ it\ to\ non-\/NULL;}}
\DoxyCodeLine{01414\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ 2)\ only\ owning\ thread\ can\ change\ it\ back\ to\ NULL,}}
\DoxyCodeLine{01415\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ 3)\ but\ it\ can\ not\ be\ done\ until\ the\ block\ is\ put\ to\ the\ mailbox}}
\DoxyCodeLine{01416\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ So\ the\ executing\ thread\ is\ now\ the\ only\ one\ that\ can\ change\ nextPrivatizable}}
\DoxyCodeLine{01417\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ !\mbox{\hyperlink{namespacerml_1_1internal_a1e643afb71dbda290c1b03a3dbebdfbc}{isNotForUse}}(\mbox{\hyperlink{classrml_1_1internal_1_1_global_block_fields_a1360a23b724f8505caeb81b21eab0c59}{nextPrivatizable}})\ )\ \{}
\DoxyCodeLine{01418\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ \mbox{\hyperlink{classrml_1_1internal_1_1_global_block_fields_a1360a23b724f8505caeb81b21eab0c59}{nextPrivatizable}}!=\mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}},\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );}
\DoxyCodeLine{01419\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_block_a6a6bc571688594aded1969d70ba65cce}{Bin}}*\ theBin\ =\ (\mbox{\hyperlink{classrml_1_1internal_1_1_block_a6a6bc571688594aded1969d70ba65cce}{Bin}}*)\ \mbox{\hyperlink{classrml_1_1internal_1_1_global_block_fields_a1360a23b724f8505caeb81b21eab0c59}{nextPrivatizable}};}
\DoxyCodeLine{01420\ \ \ \ \ \ \ \ \ \ \ \ \ theBin-\/>\mbox{\hyperlink{classrml_1_1internal_1_1_bin_a581a3ea96dae969984084a00200e2d35}{addPublicFreeListBlock}}(\textcolor{keyword}{this});}
\DoxyCodeLine{01421\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01422\ \ \ \ \ \}}
\DoxyCodeLine{01423\ \ \ \ \ \mbox{\hyperlink{tbbmalloc_2statistics_8h_a45adf7cb101679d45b142782cc324196}{STAT\_increment}}(\mbox{\hyperlink{namespacerml_1_1internal_a2877b2db91c23b8b7eb1d37891c40b2b}{getThreadId}}(),\ \mbox{\hyperlink{tbbmalloc_2statistics_8h_a5a9c41cecb75f90ed25e0b1b73f455d3}{ThreadCommonCounters}},\ \mbox{\hyperlink{tbbmalloc_2statistics_8h_ad0224919995a97978c3f07e260461115aeccdc19120b679115bffef54f3c44ac0}{freeToOtherThread}});}
\DoxyCodeLine{01424\ \ \ \ \ \mbox{\hyperlink{tbbmalloc_2statistics_8h_a45adf7cb101679d45b142782cc324196}{STAT\_increment}}(\mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a22b6910d3d56fd1183c5c4a1ed44e09f}{ownerTid}},\ \mbox{\hyperlink{namespacerml_1_1internal_a70dcd761b867baccb7ffdb087e52e215}{getIndex}}(\mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a0e116178c7df6b87077b7b029a0fe653}{objectSize}}),\ \mbox{\hyperlink{tbbmalloc_2statistics_8h_a88d7e7c1f1ccad444adb066d12334d4aadc0467f76b95fc074d5136096ea879ef}{freeByOtherThread}});}
\DoxyCodeLine{01425\ \}}
\DoxyCodeLine{01426\ }
\DoxyCodeLine{01427\ \textcolor{comment}{//\ Make\ objects\ freed\ by\ other\ threads\ available\ for\ use\ again}}
\DoxyCodeLine{01428\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1internal_1_1_block_ab857c7950fdfe4227d57ac948a02a215}{Block::privatizePublicFreeList}}(\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classrml_1_1internal_1_1_block_a598d517a2307d2bfc16e2cba1784ad78}{reset}}\ )}
\DoxyCodeLine{01429\ \{}
\DoxyCodeLine{01430\ \ \ \ \ \mbox{\hyperlink{structrml_1_1internal_1_1_free_object}{FreeObject}}\ *localPublicFreeList;}
\DoxyCodeLine{01431\ \ \ \ \ \textcolor{comment}{//\ If\ reset\ is\ false,\ publicFreeList\ should\ not\ be\ zeroed\ but\ set\ to\ UNUSABLE}}
\DoxyCodeLine{01432\ \ \ \ \ \textcolor{comment}{//\ to\ properly\ synchronize\ with\ other\ threads\ freeing\ objects\ to\ this\ slab.}}
\DoxyCodeLine{01433\ \ \ \ \ \textcolor{keyword}{const}\ intptr\_t\ endMarker\ =\ \mbox{\hyperlink{classrml_1_1internal_1_1_block_a598d517a2307d2bfc16e2cba1784ad78}{reset}}\ ?\ 0\ :\ \mbox{\hyperlink{namespacerml_1_1internal_ad6f3bbe7431bdc77608df9223c1c7e44}{UNUSABLE}};}
\DoxyCodeLine{01434\ }
\DoxyCodeLine{01435\ \ \ \ \ \textcolor{comment}{//\ Only\ the\ owner\ thread\ may\ reset\ the\ pointer\ to\ NULL}}
\DoxyCodeLine{01436\ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ \mbox{\hyperlink{classrml_1_1internal_1_1_block_a764948ac32e7d5689a755e4af99308e2}{isOwnedByCurrentThread}}()\ ||\ !\mbox{\hyperlink{classrml_1_1internal_1_1_block_a598d517a2307d2bfc16e2cba1784ad78}{reset}},\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );}
\DoxyCodeLine{01437\ \textcolor{preprocessor}{\#if\ FREELIST\_NONBLOCKING}}
\DoxyCodeLine{01438\ \ \ \ \ localPublicFreeList\ =\ (\mbox{\hyperlink{structrml_1_1internal_1_1_free_object}{FreeObject}}*)\mbox{\hyperlink{_synchronize_8h_a8f959802bcef862416aed96fe5c6e601}{AtomicFetchStore}}(\ \&\mbox{\hyperlink{classrml_1_1internal_1_1_global_block_fields_a250f5629d8827f1821cd6a318d1d6b9b}{publicFreeList}},\ endMarker\ );}
\DoxyCodeLine{01439\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{01440\ \ \ \ \ \mbox{\hyperlink{tbbmalloc_2statistics_8h_a45adf7cb101679d45b142782cc324196}{STAT\_increment}}(\mbox{\hyperlink{namespacerml_1_1internal_a2877b2db91c23b8b7eb1d37891c40b2b}{getThreadId}}(),\ \mbox{\hyperlink{tbbmalloc_2statistics_8h_a5a9c41cecb75f90ed25e0b1b73f455d3}{ThreadCommonCounters}},\ \mbox{\hyperlink{tbbmalloc_2statistics_8h_ad0224919995a97978c3f07e260461115ae3bf9b2e5185f9e7e9d14988c47e7122}{lockPublicFreeList}});}
\DoxyCodeLine{01441\ \ \ \ \ \{}
\DoxyCodeLine{01442\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_malloc_mutex_1_1scoped__lock}{MallocMutex::scoped\_lock}}\ scoped\_cs(publicFreeListLock);}
\DoxyCodeLine{01443\ \ \ \ \ \ \ \ \ localPublicFreeList\ =\ \mbox{\hyperlink{classrml_1_1internal_1_1_global_block_fields_a250f5629d8827f1821cd6a318d1d6b9b}{publicFreeList}};}
\DoxyCodeLine{01444\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_global_block_fields_a250f5629d8827f1821cd6a318d1d6b9b}{publicFreeList}}\ =\ endMarker;}
\DoxyCodeLine{01445\ \ \ \ \ \}}
\DoxyCodeLine{01446\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01447\ \ \ \ \ \mbox{\hyperlink{_customize_8h_a9187d1735e94c2a3b66004b6769f516f}{MALLOC\_ITT\_SYNC\_ACQUIRED}}(\&\mbox{\hyperlink{classrml_1_1internal_1_1_global_block_fields_a250f5629d8827f1821cd6a318d1d6b9b}{publicFreeList}});}
\DoxyCodeLine{01448\ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ !(\mbox{\hyperlink{classrml_1_1internal_1_1_block_a598d517a2307d2bfc16e2cba1784ad78}{reset}}\ \&\&\ \mbox{\hyperlink{namespacerml_1_1internal_a1e643afb71dbda290c1b03a3dbebdfbc}{isNotForUse}}(\mbox{\hyperlink{classrml_1_1internal_1_1_global_block_fields_a250f5629d8827f1821cd6a318d1d6b9b}{publicFreeList}})),\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );}
\DoxyCodeLine{01449\ }
\DoxyCodeLine{01450\ \ \ \ \ \textcolor{comment}{//\ publicFreeList\ must\ have\ been\ UNUSABLE\ or\ valid,\ but\ not\ NULL}}
\DoxyCodeLine{01451\ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ localPublicFreeList!=\mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}},\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );}
\DoxyCodeLine{01452\ \ \ \ \ \textcolor{keywordflow}{if}(\ \mbox{\hyperlink{namespacerml_1_1internal_acf31583c01d488b00e387c3bfcb23e34}{isSolidPtr}}(localPublicFreeList)\ )\ \{}
\DoxyCodeLine{01453\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ \mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a7d1d7c70675b3ba72924d1cbafd6772a}{allocatedCount}}\ <=\ (\mbox{\hyperlink{namespacerml_1_1internal_ab92a44f5c0d4ae24554856afbba1943d}{slabSize}}-\/\textcolor{keyword}{sizeof}(\mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}))/\mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a0e116178c7df6b87077b7b029a0fe653}{objectSize}},\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );}
\DoxyCodeLine{01454\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ other\ threads\ did\ not\ change\ the\ counter\ freeing\ our\ blocks\ */}}
\DoxyCodeLine{01455\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a7d1d7c70675b3ba72924d1cbafd6772a}{allocatedCount}}-\/-\/;}
\DoxyCodeLine{01456\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structrml_1_1internal_1_1_free_object}{FreeObject}}\ *temp\ =\ localPublicFreeList;}
\DoxyCodeLine{01457\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}(\ \mbox{\hyperlink{namespacerml_1_1internal_acf31583c01d488b00e387c3bfcb23e34}{isSolidPtr}}(temp-\/>\mbox{\hyperlink{structrml_1_1internal_1_1_free_object_adee876800dbeeb0dc522da323d709452}{next}})\ )\{\ \textcolor{comment}{//\ the\ list\ will\ end\ with\ either\ NULL\ or\ UNUSABLE}}
\DoxyCodeLine{01458\ \ \ \ \ \ \ \ \ \ \ \ \ temp\ =\ temp-\/>\mbox{\hyperlink{structrml_1_1internal_1_1_free_object_adee876800dbeeb0dc522da323d709452}{next}};}
\DoxyCodeLine{01459\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a7d1d7c70675b3ba72924d1cbafd6772a}{allocatedCount}}-\/-\/;}
\DoxyCodeLine{01460\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ \mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a7d1d7c70675b3ba72924d1cbafd6772a}{allocatedCount}}\ <\ (\mbox{\hyperlink{namespacerml_1_1internal_ab92a44f5c0d4ae24554856afbba1943d}{slabSize}}-\/\textcolor{keyword}{sizeof}(\mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}))/\mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a0e116178c7df6b87077b7b029a0fe653}{objectSize}},\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );}
\DoxyCodeLine{01461\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01462\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ merge\ with\ local\ freeList\ */}}
\DoxyCodeLine{01463\ \ \ \ \ \ \ \ \ temp-\/>\mbox{\hyperlink{structrml_1_1internal_1_1_free_object_adee876800dbeeb0dc522da323d709452}{next}}\ =\ \mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_ade8311f40ae3e9114518063032b7c42a}{freeList}};}
\DoxyCodeLine{01464\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_ade8311f40ae3e9114518063032b7c42a}{freeList}}\ =\ localPublicFreeList;}
\DoxyCodeLine{01465\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{tbbmalloc_2statistics_8h_a45adf7cb101679d45b142782cc324196}{STAT\_increment}}(\mbox{\hyperlink{namespacerml_1_1internal_a2877b2db91c23b8b7eb1d37891c40b2b}{getThreadId}}(),\ \mbox{\hyperlink{namespacerml_1_1internal_a70dcd761b867baccb7ffdb087e52e215}{getIndex}}(\mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a0e116178c7df6b87077b7b029a0fe653}{objectSize}}),\ \mbox{\hyperlink{tbbmalloc_2statistics_8h_a88d7e7c1f1ccad444adb066d12334d4aa578aca551cef2a2b241c10c6ef989bdd}{allocPrivatized}});}
\DoxyCodeLine{01466\ \ \ \ \ \}}
\DoxyCodeLine{01467\ \}}
\DoxyCodeLine{01468\ }
\DoxyCodeLine{01469\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1internal_1_1_block_a4fe193f1c1e58be7a5a7be85dce62b2e}{Block::privatizeOrphaned}}(\mbox{\hyperlink{classrml_1_1internal_1_1_block_ae3aa039820cf39eb9faa6a8e37ad5402}{TLSData}}\ *tls,\ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ab47dd9958bcadea08866b42bf358e95e}{index}})}
\DoxyCodeLine{01470\ \{}
\DoxyCodeLine{01471\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_block_a6a6bc571688594aded1969d70ba65cce}{Bin}}*\ \mbox{\hyperlink{runtime_2spdlog_2include_2spdlog_2fmt_2bundled_2base_8h_adfa139c9a1902753b3696794759b2c48ac1111bd512b29e821b120b86446026b8}{bin}}\ =\ tls-\/>\mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data_a140deb931bef016f17cacae4ec0754c3}{bin}}\ +\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ab47dd9958bcadea08866b42bf358e95e}{index}};}
\DoxyCodeLine{01472\ \ \ \ \ \mbox{\hyperlink{tbbmalloc_2statistics_8h_a45adf7cb101679d45b142782cc324196}{STAT\_increment}}(\mbox{\hyperlink{namespacerml_1_1internal_a2877b2db91c23b8b7eb1d37891c40b2b}{getThreadId}}(),\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ab47dd9958bcadea08866b42bf358e95e}{index}},\ \mbox{\hyperlink{tbbmalloc_2statistics_8h_a88d7e7c1f1ccad444adb066d12334d4aa362099156285b2b236d580114522628b}{allocBlockPublic}});}
\DoxyCodeLine{01473\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_ab0858e200e0125219210fe856e98fa28}{next}}\ =\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{01474\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a3a5c6afadff504e7196e643938f26cad}{previous}}\ =\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{01475\ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ \mbox{\hyperlink{classrml_1_1internal_1_1_global_block_fields_a250f5629d8827f1821cd6a318d1d6b9b}{publicFreeList}}!=\mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}},\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );}
\DoxyCodeLine{01476\ \ \ \ \ \textcolor{comment}{/*\ There\ is\ not\ a\ race\ here\ since\ no\ other\ thread\ owns\ this\ block\ */}}
\DoxyCodeLine{01477\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_block_ae756f3bad7579cab3bf41552adb63bc2}{markOwned}}(tls);}
\DoxyCodeLine{01478\ \ \ \ \ \textcolor{comment}{//\ It\ is\ safe\ to\ change\ nextPrivatizable,\ as\ publicFreeList\ is\ not\ null}}
\DoxyCodeLine{01479\ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ \mbox{\hyperlink{namespacerml_1_1internal_a1e643afb71dbda290c1b03a3dbebdfbc}{isNotForUse}}(\mbox{\hyperlink{classrml_1_1internal_1_1_global_block_fields_a1360a23b724f8505caeb81b21eab0c59}{nextPrivatizable}}),\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );}
\DoxyCodeLine{01480\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_global_block_fields_a1360a23b724f8505caeb81b21eab0c59}{nextPrivatizable}}\ =\ (\mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}*)\mbox{\hyperlink{runtime_2spdlog_2include_2spdlog_2fmt_2bundled_2base_8h_adfa139c9a1902753b3696794759b2c48ac1111bd512b29e821b120b86446026b8}{bin}};}
\DoxyCodeLine{01481\ \ \ \ \ \textcolor{comment}{//\ the\ next\ call\ is\ required\ to\ change\ publicFreeList\ to\ 0}}
\DoxyCodeLine{01482\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_block_ab857c7950fdfe4227d57ac948a02a215}{privatizePublicFreeList}}();}
\DoxyCodeLine{01483\ \ \ \ \ \textcolor{keywordflow}{if}(\ \mbox{\hyperlink{classrml_1_1internal_1_1_block_a2a7ca914c507f4411cd9d8dd1bd63330}{empty}}()\ )\ \{}
\DoxyCodeLine{01484\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_block_a5df4dfd201e5dd98c7e542e2ed64d990}{restoreBumpPtr}}();}
\DoxyCodeLine{01485\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01486\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_block_ab8c840097b1ff314c170187763e7aeaf}{adjustFullness}}();\ \textcolor{comment}{//\ check\ the\ block\ fullness\ and\ set\ isFull}}
\DoxyCodeLine{01487\ \ \ \ \ \}}
\DoxyCodeLine{01488\ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ !\mbox{\hyperlink{namespacerml_1_1internal_a1e643afb71dbda290c1b03a3dbebdfbc}{isNotForUse}}(\mbox{\hyperlink{classrml_1_1internal_1_1_global_block_fields_a250f5629d8827f1821cd6a318d1d6b9b}{publicFreeList}}),\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );}
\DoxyCodeLine{01489\ \}}
\DoxyCodeLine{01490\ }
\DoxyCodeLine{01491\ }
\DoxyCodeLine{01492\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classrml_1_1internal_1_1_block_a1216d6387c838e35475bc0fa3c5f2e21}{Block::readyToShare}}()}
\DoxyCodeLine{01493\ \{}
\DoxyCodeLine{01494\ \ \ \ \ \textcolor{keywordtype}{void}*\ oldval;}
\DoxyCodeLine{01495\ \textcolor{preprocessor}{\#if\ FREELIST\_NONBLOCKING}}
\DoxyCodeLine{01496\ \ \ \ \ oldval\ =\ (\textcolor{keywordtype}{void}*)\mbox{\hyperlink{_synchronize_8h_a204e8f99046d12f598e460aa19ac9516}{AtomicCompareExchange}}((intptr\_t\&)\mbox{\hyperlink{classrml_1_1internal_1_1_global_block_fields_a250f5629d8827f1821cd6a318d1d6b9b}{publicFreeList}},\ \mbox{\hyperlink{namespacerml_1_1internal_ad6f3bbe7431bdc77608df9223c1c7e44}{UNUSABLE}},\ 0);}
\DoxyCodeLine{01497\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{01498\ \ \ \ \ \mbox{\hyperlink{tbbmalloc_2statistics_8h_a45adf7cb101679d45b142782cc324196}{STAT\_increment}}(\mbox{\hyperlink{namespacerml_1_1internal_a2877b2db91c23b8b7eb1d37891c40b2b}{getThreadId}}(),\ \mbox{\hyperlink{tbbmalloc_2statistics_8h_a5a9c41cecb75f90ed25e0b1b73f455d3}{ThreadCommonCounters}},\ \mbox{\hyperlink{tbbmalloc_2statistics_8h_ad0224919995a97978c3f07e260461115ae3bf9b2e5185f9e7e9d14988c47e7122}{lockPublicFreeList}});}
\DoxyCodeLine{01499\ \ \ \ \ \{}
\DoxyCodeLine{01500\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_malloc_mutex_1_1scoped__lock}{MallocMutex::scoped\_lock}}\ scoped\_cs(publicFreeListLock);}
\DoxyCodeLine{01501\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\ (oldval=\mbox{\hyperlink{classrml_1_1internal_1_1_global_block_fields_a250f5629d8827f1821cd6a318d1d6b9b}{publicFreeList}})==\mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}}\ )}
\DoxyCodeLine{01502\ \ \ \ \ \ \ \ \ \ \ \ \ (intptr\_t\&)(\mbox{\hyperlink{classrml_1_1internal_1_1_global_block_fields_a250f5629d8827f1821cd6a318d1d6b9b}{publicFreeList}})\ =\ \mbox{\hyperlink{namespacerml_1_1internal_ad6f3bbe7431bdc77608df9223c1c7e44}{UNUSABLE}};}
\DoxyCodeLine{01503\ \ \ \ \ \}}
\DoxyCodeLine{01504\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01505\ \ \ \ \ \textcolor{keywordflow}{return}\ oldval==\mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{01506\ \}}
\DoxyCodeLine{01507\ }
\DoxyCodeLine{01508\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1internal_1_1_block_a8ad4343ada0da1773726cd85581189a0}{Block::shareOrphaned}}(intptr\_t\ binTag,\ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ab47dd9958bcadea08866b42bf358e95e}{index}})}
\DoxyCodeLine{01509\ \{}
\DoxyCodeLine{01510\ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ binTag,\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );}
\DoxyCodeLine{01511\ \ \ \ \ \mbox{\hyperlink{tbbmalloc_2statistics_8h_a45adf7cb101679d45b142782cc324196}{STAT\_increment}}(\mbox{\hyperlink{namespacerml_1_1internal_a2877b2db91c23b8b7eb1d37891c40b2b}{getThreadId}}(),\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ab47dd9958bcadea08866b42bf358e95e}{index}},\ \mbox{\hyperlink{tbbmalloc_2statistics_8h_a88d7e7c1f1ccad444adb066d12334d4aad56f630b90f986e2637a9b74edaddecc}{freeBlockPublic}});}
\DoxyCodeLine{01512\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_block_aeea6bb8d7c94c6e2647c1d3a18e85e79}{markOrphaned}}();}
\DoxyCodeLine{01513\ \ \ \ \ \textcolor{keywordflow}{if}\ ((intptr\_t)\mbox{\hyperlink{classrml_1_1internal_1_1_global_block_fields_a1360a23b724f8505caeb81b21eab0c59}{nextPrivatizable}}==binTag)\ \{}
\DoxyCodeLine{01514\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ First\ check\ passed:\ the\ block\ is\ not\ in\ mailbox\ yet.}}
\DoxyCodeLine{01515\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Need\ to\ set\ publicFreeList\ to\ non-\/zero,\ so\ other\ threads}}
\DoxyCodeLine{01516\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ will\ not\ change\ nextPrivatizable\ and\ it\ can\ be\ zeroed.}}
\DoxyCodeLine{01517\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\ !\mbox{\hyperlink{classrml_1_1internal_1_1_block_a1216d6387c838e35475bc0fa3c5f2e21}{readyToShare}}()\ )\ \{}
\DoxyCodeLine{01518\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ another\ thread\ freed\ an\ object;\ we\ need\ to\ wait\ until\ it\ finishes.}}
\DoxyCodeLine{01519\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ There\ is\ no\ need\ for\ exponential\ backoff,\ as\ the\ wait\ here\ is\ not\ for\ a\ lock;}}
\DoxyCodeLine{01520\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ but\ need\ to\ yield,\ so\ the\ thread\ we\ wait\ has\ a\ chance\ to\ run.}}
\DoxyCodeLine{01521\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ TODO:\ add\ a\ pause\ to\ also\ be\ friendly\ to\ hyperthreads}}
\DoxyCodeLine{01522\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}}\ =\ 256;}
\DoxyCodeLine{01523\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}(\ (intptr\_t)\textcolor{keyword}{const\_cast<}\mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}*\ \textcolor{keyword}{volatile\ }\&\textcolor{keyword}{>}(\mbox{\hyperlink{classrml_1_1internal_1_1_global_block_fields_a1360a23b724f8505caeb81b21eab0c59}{nextPrivatizable}})==binTag\ )\ \{}
\DoxyCodeLine{01524\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (-\/-\/\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}}==0)\ \{}
\DoxyCodeLine{01525\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{frontend_8cpp_a55c924873baf1481b4de290a2b4fc299}{do\_yield}}();}
\DoxyCodeLine{01526\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}}\ =\ 256;}
\DoxyCodeLine{01527\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01528\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01529\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01530\ \ \ \ \ \}}
\DoxyCodeLine{01531\ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ \mbox{\hyperlink{classrml_1_1internal_1_1_global_block_fields_a250f5629d8827f1821cd6a318d1d6b9b}{publicFreeList}}!=\mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}},\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );}
\DoxyCodeLine{01532\ \ \ \ \ \textcolor{comment}{//\ now\ it\ is\ safe\ to\ change\ our\ data}}
\DoxyCodeLine{01533\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a3a5c6afadff504e7196e643938f26cad}{previous}}\ =\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{01534\ \ \ \ \ \textcolor{comment}{//\ it\ is\ caller\ responsibility\ to\ ensure\ that\ the\ list\ of\ blocks}}
\DoxyCodeLine{01535\ \ \ \ \ \textcolor{comment}{//\ formed\ by\ nextPrivatizable\ pointers\ is\ kept\ consistent\ if\ required.}}
\DoxyCodeLine{01536\ \ \ \ \ \textcolor{comment}{//\ if\ only\ called\ from\ thread\ shutdown\ code,\ it\ does\ not\ matter.}}
\DoxyCodeLine{01537\ \ \ \ \ (intptr\_t\&)(\mbox{\hyperlink{classrml_1_1internal_1_1_global_block_fields_a1360a23b724f8505caeb81b21eab0c59}{nextPrivatizable}})\ =\ \mbox{\hyperlink{namespacerml_1_1internal_ad6f3bbe7431bdc77608df9223c1c7e44}{UNUSABLE}};}
\DoxyCodeLine{01538\ \}}
\DoxyCodeLine{01539\ }
\DoxyCodeLine{01540\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1internal_1_1_block_a62edc0a79ebbbfff63671ad25b0561ba}{Block::cleanBlockHeader}}()}
\DoxyCodeLine{01541\ \{}
\DoxyCodeLine{01542\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_ab0858e200e0125219210fe856e98fa28}{next}}\ =\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{01543\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a3a5c6afadff504e7196e643938f26cad}{previous}}\ =\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{01544\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_ade8311f40ae3e9114518063032b7c42a}{freeList}}\ =\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{01545\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a7d1d7c70675b3ba72924d1cbafd6772a}{allocatedCount}}\ =\ 0;}
\DoxyCodeLine{01546\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a76d70cbe8837862cdf286a120266e430}{isFull}}\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01547\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_ac591e79d62cf0ee8907a3e60991d0734}{tlsPtr}}\ =\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{01548\ }
\DoxyCodeLine{01549\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_global_block_fields_a250f5629d8827f1821cd6a318d1d6b9b}{publicFreeList}}\ =\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{01550\ \}}
\DoxyCodeLine{01551\ }
\DoxyCodeLine{01552\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1internal_1_1_block_ac28a4338a88b594da0a1c4225e6c5d2e}{Block::initEmptyBlock}}(\mbox{\hyperlink{classrml_1_1internal_1_1_block_ae3aa039820cf39eb9faa6a8e37ad5402}{TLSData}}\ *tls,\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}})}
\DoxyCodeLine{01553\ \{}
\DoxyCodeLine{01554\ \ \ \ \ \textcolor{comment}{//\ Having\ getIndex\ and\ getObjectSize\ called\ next\ to\ each\ other}}
\DoxyCodeLine{01555\ \ \ \ \ \textcolor{comment}{//\ allows\ better\ compiler\ optimization\ as\ they\ basically\ share\ the\ code.}}
\DoxyCodeLine{01556\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ab47dd9958bcadea08866b42bf358e95e}{index}}\ =\ \mbox{\hyperlink{namespacerml_1_1internal_a70dcd761b867baccb7ffdb087e52e215}{getIndex}}(\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}});}
\DoxyCodeLine{01557\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ objSz\ =\ \mbox{\hyperlink{namespacerml_1_1internal_af01ec297511bd9be238191aa74fcf9fc}{getObjectSize}}(\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}});}
\DoxyCodeLine{01558\ }
\DoxyCodeLine{01559\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_block_a62edc0a79ebbbfff63671ad25b0561ba}{cleanBlockHeader}}();}
\DoxyCodeLine{01560\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a0e116178c7df6b87077b7b029a0fe653}{objectSize}}\ =\ objSz;}
\DoxyCodeLine{01561\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_block_ae756f3bad7579cab3bf41552adb63bc2}{markOwned}}(tls);}
\DoxyCodeLine{01562\ \ \ \ \ \textcolor{comment}{//\ bump\ pointer\ should\ be\ prepared\ for\ first\ allocation\ -\/\ thus\ mode\ it\ down\ to\ objectSize}}
\DoxyCodeLine{01563\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a7539e25da68797f70368fa66e62e9c1c}{bumpPtr}}\ =\ (\mbox{\hyperlink{structrml_1_1internal_1_1_free_object}{FreeObject}}\ *)((uintptr\_t)\textcolor{keyword}{this}\ +\ \mbox{\hyperlink{namespacerml_1_1internal_ab92a44f5c0d4ae24554856afbba1943d}{slabSize}}\ -\/\ \mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a0e116178c7df6b87077b7b029a0fe653}{objectSize}});}
\DoxyCodeLine{01564\ }
\DoxyCodeLine{01565\ \ \ \ \ \textcolor{comment}{//\ each\ block\ should\ have\ the\ address\ where\ the\ head\ of\ the\ list\ of\ "{}privatizable"{}\ blocks\ is\ kept}}
\DoxyCodeLine{01566\ \ \ \ \ \textcolor{comment}{//\ the\ only\ exception\ is\ a\ block\ for\ boot\ strap\ which\ is\ initialized\ when\ TLS\ is\ yet\ NULL}}
\DoxyCodeLine{01567\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_global_block_fields_a1360a23b724f8505caeb81b21eab0c59}{nextPrivatizable}}\ =\ tls?\ (\mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}*)(tls-\/>\mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data_a140deb931bef016f17cacae4ec0754c3}{bin}}\ +\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ab47dd9958bcadea08866b42bf358e95e}{index}})\ :\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{01568\ \ \ \ \ \mbox{\hyperlink{tbbmalloc__internal_8h_af1c1baacf37ff8d445664716b811ee39}{TRACEF}}((\ \textcolor{stringliteral}{"{}[ScalableMalloc\ trace]\ Empty\ block\ \%p\ is\ initialized,\ owner\ is\ \%ld,\ objectSize\ is\ \%d,\ bumpPtr\ is\ \%p\(\backslash\)n"{}},}
\DoxyCodeLine{01569\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{this},\ \mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_ac591e79d62cf0ee8907a3e60991d0734}{tlsPtr}}\ ?\ \mbox{\hyperlink{namespacerml_1_1internal_a2877b2db91c23b8b7eb1d37891c40b2b}{getThreadId}}()\ :\ -\/1,\ \mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a0e116178c7df6b87077b7b029a0fe653}{objectSize}},\ \mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a7539e25da68797f70368fa66e62e9c1c}{bumpPtr}}\ ));}
\DoxyCodeLine{01570\ \}}
\DoxyCodeLine{01571\ }
\DoxyCodeLine{01572\ \mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}\ *\mbox{\hyperlink{classrml_1_1internal_1_1_orphaned_blocks_a3ed9f9cf98cd6c788195e57408c5ed26}{OrphanedBlocks::get}}(\mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data}{TLSData}}\ *tls,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}})}
\DoxyCodeLine{01573\ \{}
\DoxyCodeLine{01574\ \ \ \ \ \textcolor{comment}{//\ TODO:\ try\ to\ use\ index\ from\ getAllocationBin}}
\DoxyCodeLine{01575\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ab47dd9958bcadea08866b42bf358e95e}{index}}\ =\ \mbox{\hyperlink{namespacerml_1_1internal_a70dcd761b867baccb7ffdb087e52e215}{getIndex}}(\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}});}
\DoxyCodeLine{01576\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}\ *\mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}\ =\ \mbox{\hyperlink{classrml_1_1internal_1_1_orphaned_blocks_a6d309b76a0c4d14b79d3c2c2b5a435a3}{bins}}[\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ab47dd9958bcadea08866b42bf358e95e}{index}}].pop();}
\DoxyCodeLine{01577\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}})\ \{}
\DoxyCodeLine{01578\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_customize_8h_a9187d1735e94c2a3b66004b6769f516f}{MALLOC\_ITT\_SYNC\_ACQUIRED}}(\mbox{\hyperlink{classrml_1_1internal_1_1_orphaned_blocks_a6d309b76a0c4d14b79d3c2c2b5a435a3}{bins}}+\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ab47dd9958bcadea08866b42bf358e95e}{index}});}
\DoxyCodeLine{01579\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}-\/>privatizeOrphaned(tls,\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ab47dd9958bcadea08866b42bf358e95e}{index}});}
\DoxyCodeLine{01580\ \ \ \ \ \}}
\DoxyCodeLine{01581\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}};}
\DoxyCodeLine{01582\ \}}
\DoxyCodeLine{01583\ }
\DoxyCodeLine{01584\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1internal_1_1_orphaned_blocks_a26c824f081a1b11ea4fe0bab06d71e66}{OrphanedBlocks::put}}(intptr\_t\ binTag,\ \mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}\ *\mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}})}
\DoxyCodeLine{01585\ \{}
\DoxyCodeLine{01586\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ab47dd9958bcadea08866b42bf358e95e}{index}}\ =\ \mbox{\hyperlink{namespacerml_1_1internal_a70dcd761b867baccb7ffdb087e52e215}{getIndex}}(\mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}-\/>getSize());}
\DoxyCodeLine{01587\ \ \ \ \ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}-\/>shareOrphaned(binTag,\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ab47dd9958bcadea08866b42bf358e95e}{index}});}
\DoxyCodeLine{01588\ \ \ \ \ \mbox{\hyperlink{_customize_8h_af8fcb50fd416dc4f6d1165ae21c58eb3}{MALLOC\_ITT\_SYNC\_RELEASING}}(\mbox{\hyperlink{classrml_1_1internal_1_1_orphaned_blocks_a6d309b76a0c4d14b79d3c2c2b5a435a3}{bins}}+\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ab47dd9958bcadea08866b42bf358e95e}{index}});}
\DoxyCodeLine{01589\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_orphaned_blocks_a6d309b76a0c4d14b79d3c2c2b5a435a3}{bins}}[\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ab47dd9958bcadea08866b42bf358e95e}{index}}].push(\mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}});}
\DoxyCodeLine{01590\ \}}
\DoxyCodeLine{01591\ }
\DoxyCodeLine{01592\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1internal_1_1_orphaned_blocks_ab0e3bca882f21bd89f6f76bcd33d4640}{OrphanedBlocks::reset}}()}
\DoxyCodeLine{01593\ \{}
\DoxyCodeLine{01594\ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{eabase_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t}}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}=0;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}<\mbox{\hyperlink{namespacerml_1_1internal_af9e9162c10034b03b23d5734de443213}{numBlockBinLimit}};\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}++)}
\DoxyCodeLine{01595\ \ \ \ \ \ \ \ \ \textcolor{keyword}{new}\ (\mbox{\hyperlink{classrml_1_1internal_1_1_orphaned_blocks_a6d309b76a0c4d14b79d3c2c2b5a435a3}{bins}}+\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ \mbox{\hyperlink{classrml_1_1internal_1_1_lifo_list}{LifoList}}();}
\DoxyCodeLine{01596\ \}}
\DoxyCodeLine{01597\ }
\DoxyCodeLine{01598\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classrml_1_1internal_1_1_orphaned_blocks_a1707222a0a6430ed2efe30049dfd4784}{OrphanedBlocks::cleanup}}(\mbox{\hyperlink{classrml_1_1internal_1_1_backend}{Backend}}*\ backend)}
\DoxyCodeLine{01599\ \{}
\DoxyCodeLine{01600\ \ \ \ \ \textcolor{keywordtype}{bool}\ released\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01601\ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{eabase_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t}}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}=0;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}<\mbox{\hyperlink{namespacerml_1_1internal_af9e9162c10034b03b23d5734de443213}{numBlockBinLimit}};\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}++)\ \{}
\DoxyCodeLine{01602\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}*\ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}\ =\ \mbox{\hyperlink{classrml_1_1internal_1_1_orphaned_blocks_a6d309b76a0c4d14b79d3c2c2b5a435a3}{bins}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}].grab();}
\DoxyCodeLine{01603\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_customize_8h_a9187d1735e94c2a3b66004b6769f516f}{MALLOC\_ITT\_SYNC\_ACQUIRED}}(\mbox{\hyperlink{classrml_1_1internal_1_1_orphaned_blocks_a6d309b76a0c4d14b79d3c2c2b5a435a3}{bins}}+\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}});}
\DoxyCodeLine{01604\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (\mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}})\ \{}
\DoxyCodeLine{01605\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}*\ next\ =\ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}-\/>next;}
\DoxyCodeLine{01606\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}-\/>privatizePublicFreeList(\ \textcolor{comment}{/*reset=*/}\textcolor{keyword}{false}\ );\ \textcolor{comment}{//\ do\ not\ set\ publicFreeList\ to\ NULL}}
\DoxyCodeLine{01607\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}-\/>empty())\ \{}
\DoxyCodeLine{01608\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}-\/>reset();}
\DoxyCodeLine{01609\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ slab\ blocks\ in\ user's\ pools\ do\ not\ have\ valid\ backRefIdx}}
\DoxyCodeLine{01610\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!backend-\/>\mbox{\hyperlink{classrml_1_1internal_1_1_backend_a0d970b8baf9c882ee49d4467b88fcd3b}{inUserPool}}())}
\DoxyCodeLine{01611\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacerml_1_1internal_ab8e65fb38698f5544e2b1fa3127bec85}{removeBackRef}}(*(\mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}-\/>getBackRefIdx()));}
\DoxyCodeLine{01612\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ backend-\/>\mbox{\hyperlink{classrml_1_1internal_1_1_backend_aff80d2f96611eb02d64e81c6311dcb16}{putSlabBlock}}(\mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}});}
\DoxyCodeLine{01613\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ released\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01614\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01615\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_customize_8h_af8fcb50fd416dc4f6d1165ae21c58eb3}{MALLOC\_ITT\_SYNC\_RELEASING}}(\mbox{\hyperlink{classrml_1_1internal_1_1_orphaned_blocks_a6d309b76a0c4d14b79d3c2c2b5a435a3}{bins}}+\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}});}
\DoxyCodeLine{01616\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_orphaned_blocks_a6d309b76a0c4d14b79d3c2c2b5a435a3}{bins}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}].push(\mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}});}
\DoxyCodeLine{01617\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01618\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}\ =\ next;}
\DoxyCodeLine{01619\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01620\ \ \ \ \ \}}
\DoxyCodeLine{01621\ \ \ \ \ \textcolor{keywordflow}{return}\ released;}
\DoxyCodeLine{01622\ \}}
\DoxyCodeLine{01623\ }
\DoxyCodeLine{01624\ \mbox{\hyperlink{classrml_1_1internal_1_1_free_block_pool_1_1_res_of_get}{FreeBlockPool::ResOfGet}}\ \mbox{\hyperlink{classrml_1_1internal_1_1_free_block_pool_a3d6745e31d1a809ce90273ba7a8f8ab7}{FreeBlockPool::getBlock}}()}
\DoxyCodeLine{01625\ \{}
\DoxyCodeLine{01626\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}\ *\mbox{\hyperlink{offscreen_8c_a846c9667e34d56c560bb7f0ac6e173f6}{b}}\ =\ (\mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}*)\mbox{\hyperlink{_synchronize_8h_a8f959802bcef862416aed96fe5c6e601}{AtomicFetchStore}}(\&\mbox{\hyperlink{classrml_1_1internal_1_1_free_block_pool_a8646628c2c30186529369da707f2be8e}{head}},\ 0);}
\DoxyCodeLine{01627\ }
\DoxyCodeLine{01628\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{offscreen_8c_a846c9667e34d56c560bb7f0ac6e173f6}{b}})\ \{}
\DoxyCodeLine{01629\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_free_block_pool_adac9c11cb2c7c28ecd96c8eb3ff0d0fc}{size}}-\/-\/;}
\DoxyCodeLine{01630\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}\ *newHead\ =\ \mbox{\hyperlink{offscreen_8c_a846c9667e34d56c560bb7f0ac6e173f6}{b}}-\/>next;}
\DoxyCodeLine{01631\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_free_block_pool_a1d7dfb06f6a6dbe236defdaae637fc37}{lastAccessMiss}}\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01632\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_synchronize_8h_a19886ee3899c0a2435ea9840116ea325}{FencedStore}}((intptr\_t\&)\mbox{\hyperlink{classrml_1_1internal_1_1_free_block_pool_a8646628c2c30186529369da707f2be8e}{head}},\ (intptr\_t)newHead);}
\DoxyCodeLine{01633\ \ \ \ \ \}\ \textcolor{keywordflow}{else}}
\DoxyCodeLine{01634\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_free_block_pool_a1d7dfb06f6a6dbe236defdaae637fc37}{lastAccessMiss}}\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01635\ }
\DoxyCodeLine{01636\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classrml_1_1internal_1_1_free_block_pool_1_1_res_of_get}{ResOfGet}}(\mbox{\hyperlink{offscreen_8c_a846c9667e34d56c560bb7f0ac6e173f6}{b}},\ \mbox{\hyperlink{classrml_1_1internal_1_1_free_block_pool_a1d7dfb06f6a6dbe236defdaae637fc37}{lastAccessMiss}});}
\DoxyCodeLine{01637\ \}}
\DoxyCodeLine{01638\ }
\DoxyCodeLine{01639\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1internal_1_1_free_block_pool_a98adf682213916f2d39812b170938b4a}{FreeBlockPool::returnBlock}}(\mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}\ *\mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}})}
\DoxyCodeLine{01640\ \{}
\DoxyCodeLine{01641\ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ \mbox{\hyperlink{classrml_1_1internal_1_1_free_block_pool_adac9c11cb2c7c28ecd96c8eb3ff0d0fc}{size}}\ <=\ \mbox{\hyperlink{classrml_1_1internal_1_1_free_block_pool_a6e0b38bdab3a76180e356b4707320b73}{POOL\_HIGH\_MARK}},\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );}
\DoxyCodeLine{01642\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}\ *localHead\ =\ (\mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}*)\mbox{\hyperlink{_synchronize_8h_a8f959802bcef862416aed96fe5c6e601}{AtomicFetchStore}}(\&\mbox{\hyperlink{classrml_1_1internal_1_1_free_block_pool_a8646628c2c30186529369da707f2be8e}{head}},\ 0);}
\DoxyCodeLine{01643\ }
\DoxyCodeLine{01644\ \ \ \ \ \textcolor{keywordflow}{if}\ (!localHead)}
\DoxyCodeLine{01645\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_free_block_pool_adac9c11cb2c7c28ecd96c8eb3ff0d0fc}{size}}\ =\ 0;\ \textcolor{comment}{//\ head\ was\ stolen\ by\ externalClean,\ correct\ size\ accordingly}}
\DoxyCodeLine{01646\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classrml_1_1internal_1_1_free_block_pool_adac9c11cb2c7c28ecd96c8eb3ff0d0fc}{size}}\ ==\ \mbox{\hyperlink{classrml_1_1internal_1_1_free_block_pool_a6e0b38bdab3a76180e356b4707320b73}{POOL\_HIGH\_MARK}})\ \{}
\DoxyCodeLine{01647\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ release\ cold\ blocks\ and\ add\ hot\ one,}}
\DoxyCodeLine{01648\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ so\ keep\ POOL\_LOW\_MARK-\/1\ blocks\ and\ add\ new\ block\ to\ head}}
\DoxyCodeLine{01649\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}\ *headToFree\ =\ localHead,\ *helper;}
\DoxyCodeLine{01650\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}=0;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}<\mbox{\hyperlink{classrml_1_1internal_1_1_free_block_pool_a4966b4cf11130701d61cc63b4385054a}{POOL\_LOW\_MARK}}-\/2;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}++)}
\DoxyCodeLine{01651\ \ \ \ \ \ \ \ \ \ \ \ \ headToFree\ =\ headToFree-\/>\mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_ab0858e200e0125219210fe856e98fa28}{next}};}
\DoxyCodeLine{01652\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}\ *last\ =\ headToFree;}
\DoxyCodeLine{01653\ \ \ \ \ \ \ \ \ headToFree\ =\ headToFree-\/>\mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_ab0858e200e0125219210fe856e98fa28}{next}};}
\DoxyCodeLine{01654\ \ \ \ \ \ \ \ \ last-\/>next\ =\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{01655\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_free_block_pool_adac9c11cb2c7c28ecd96c8eb3ff0d0fc}{size}}\ =\ \mbox{\hyperlink{classrml_1_1internal_1_1_free_block_pool_a4966b4cf11130701d61cc63b4385054a}{POOL\_LOW\_MARK}}-\/1;}
\DoxyCodeLine{01656\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}\ *currBl\ =\ headToFree;\ currBl;\ currBl\ =\ helper)\ \{}
\DoxyCodeLine{01657\ \ \ \ \ \ \ \ \ \ \ \ \ helper\ =\ currBl-\/>next;}
\DoxyCodeLine{01658\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ slab\ blocks\ in\ user's\ pools\ do\ not\ have\ valid\ backRefIdx}}
\DoxyCodeLine{01659\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classrml_1_1internal_1_1_free_block_pool_a52e4839e46d27b38fb31b9d5fb4658fa}{backend}}-\/>inUserPool())}
\DoxyCodeLine{01660\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacerml_1_1internal_ab8e65fb38698f5544e2b1fa3127bec85}{removeBackRef}}(currBl-\/>backRefIdx);}
\DoxyCodeLine{01661\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_free_block_pool_a52e4839e46d27b38fb31b9d5fb4658fa}{backend}}-\/>putSlabBlock(currBl);}
\DoxyCodeLine{01662\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01663\ \ \ \ \ \}}
\DoxyCodeLine{01664\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_free_block_pool_adac9c11cb2c7c28ecd96c8eb3ff0d0fc}{size}}++;}
\DoxyCodeLine{01665\ \ \ \ \ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}-\/>next\ =\ localHead;}
\DoxyCodeLine{01666\ \ \ \ \ \mbox{\hyperlink{_synchronize_8h_a19886ee3899c0a2435ea9840116ea325}{FencedStore}}((intptr\_t\&)\mbox{\hyperlink{classrml_1_1internal_1_1_free_block_pool_a8646628c2c30186529369da707f2be8e}{head}},\ (intptr\_t)\mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}});}
\DoxyCodeLine{01667\ \}}
\DoxyCodeLine{01668\ }
\DoxyCodeLine{01669\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classrml_1_1internal_1_1_free_block_pool_ab61c0024cb476fa6efa9748f257bfa39}{FreeBlockPool::externalCleanup}}()}
\DoxyCodeLine{01670\ \{}
\DoxyCodeLine{01671\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}\ *helper;}
\DoxyCodeLine{01672\ \ \ \ \ \textcolor{keywordtype}{bool}\ released\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01673\ }
\DoxyCodeLine{01674\ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}\ *currBl=(\mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}*)\mbox{\hyperlink{_synchronize_8h_a8f959802bcef862416aed96fe5c6e601}{AtomicFetchStore}}(\&\mbox{\hyperlink{classrml_1_1internal_1_1_free_block_pool_a8646628c2c30186529369da707f2be8e}{head}},\ 0);\ currBl;\ currBl=helper)\ \{}
\DoxyCodeLine{01675\ \ \ \ \ \ \ \ \ helper\ =\ currBl-\/>\mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_ab0858e200e0125219210fe856e98fa28}{next}};}
\DoxyCodeLine{01676\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ slab\ blocks\ in\ user's\ pools\ do\ not\ have\ valid\ backRefIdx}}
\DoxyCodeLine{01677\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classrml_1_1internal_1_1_free_block_pool_a52e4839e46d27b38fb31b9d5fb4658fa}{backend}}-\/>inUserPool())}
\DoxyCodeLine{01678\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacerml_1_1internal_ab8e65fb38698f5544e2b1fa3127bec85}{removeBackRef}}(currBl-\/>backRefIdx);}
\DoxyCodeLine{01679\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_free_block_pool_a52e4839e46d27b38fb31b9d5fb4658fa}{backend}}-\/>putSlabBlock(currBl);}
\DoxyCodeLine{01680\ \ \ \ \ \ \ \ \ released\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01681\ \ \ \ \ \}}
\DoxyCodeLine{01682\ \ \ \ \ \textcolor{keywordflow}{return}\ released;}
\DoxyCodeLine{01683\ \}}
\DoxyCodeLine{01684\ }
\DoxyCodeLine{01685\ \textcolor{comment}{/*\ Prepare\ the\ block\ for\ returning\ to\ FreeBlockPool\ */}}
\DoxyCodeLine{01686\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1internal_1_1_block_a598d517a2307d2bfc16e2cba1784ad78}{Block::reset}}()}
\DoxyCodeLine{01687\ \{}
\DoxyCodeLine{01688\ \ \ \ \ \textcolor{comment}{//\ it\ is\ caller's\ responsibility\ to\ ensure\ no\ data\ is\ lost\ before\ calling\ this}}
\DoxyCodeLine{01689\ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ \mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a7d1d7c70675b3ba72924d1cbafd6772a}{allocatedCount}}==0,\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );}
\DoxyCodeLine{01690\ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ !\mbox{\hyperlink{namespacerml_1_1internal_acf31583c01d488b00e387c3bfcb23e34}{isSolidPtr}}(\mbox{\hyperlink{classrml_1_1internal_1_1_global_block_fields_a250f5629d8827f1821cd6a318d1d6b9b}{publicFreeList}}),\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );}
\DoxyCodeLine{01691\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classrml_1_1internal_1_1_block_a3f8bba034d89886e7b2110cabab5e02c}{isStartupAllocObject}}())}
\DoxyCodeLine{01692\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{tbbmalloc_2statistics_8h_a45adf7cb101679d45b142782cc324196}{STAT\_increment}}(\mbox{\hyperlink{namespacerml_1_1internal_a2877b2db91c23b8b7eb1d37891c40b2b}{getThreadId}}(),\ \mbox{\hyperlink{namespacerml_1_1internal_a70dcd761b867baccb7ffdb087e52e215}{getIndex}}(\mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a0e116178c7df6b87077b7b029a0fe653}{objectSize}}),\ \mbox{\hyperlink{tbbmalloc_2statistics_8h_a88d7e7c1f1ccad444adb066d12334d4aa185f5e679f5fff5992c96604b2016bf7}{freeBlockBack}});}
\DoxyCodeLine{01693\ }
\DoxyCodeLine{01694\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_block_a62edc0a79ebbbfff63671ad25b0561ba}{cleanBlockHeader}}();}
\DoxyCodeLine{01695\ }
\DoxyCodeLine{01696\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_global_block_fields_a1360a23b724f8505caeb81b21eab0c59}{nextPrivatizable}}\ =\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{01697\ }
\DoxyCodeLine{01698\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a0e116178c7df6b87077b7b029a0fe653}{objectSize}}\ =\ 0;}
\DoxyCodeLine{01699\ \ \ \ \ \textcolor{comment}{//\ for\ an\ empty\ block,\ bump\ pointer\ should\ point\ right\ after\ the\ end\ of\ the\ block}}
\DoxyCodeLine{01700\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a7539e25da68797f70368fa66e62e9c1c}{bumpPtr}}\ =\ (\mbox{\hyperlink{structrml_1_1internal_1_1_free_object}{FreeObject}}\ *)((uintptr\_t)\textcolor{keyword}{this}\ +\ \mbox{\hyperlink{namespacerml_1_1internal_ab92a44f5c0d4ae24554856afbba1943d}{slabSize}});}
\DoxyCodeLine{01701\ \}}
\DoxyCodeLine{01702\ }
\DoxyCodeLine{01703\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1internal_1_1_bin_a7c2d26793546cc9e053163731fdf43e5}{Bin::setActiveBlock}}\ (\mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}\ *\mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}})}
\DoxyCodeLine{01704\ \{}
\DoxyCodeLine{01705\ \textcolor{comment}{//\ \ \ \ MALLOC\_ASSERT(\ bin,\ ASSERT\_TEXT\ );}}
\DoxyCodeLine{01706\ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}-\/>isOwnedByCurrentThread(),\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );}
\DoxyCodeLine{01707\ \ \ \ \ \textcolor{comment}{//\ it\ is\ the\ caller\ responsibility\ to\ keep\ bin\ consistence\ (i.e.\ ensure\ this\ block\ is\ in\ the\ bin\ list)}}
\DoxyCodeLine{01708\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_bin_ab97ae6d4fad5c846576164dcfc44702a}{activeBlk}}\ =\ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}};}
\DoxyCodeLine{01709\ \}}
\DoxyCodeLine{01710\ }
\DoxyCodeLine{01711\ \textcolor{keyword}{inline}\ \mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}*\ \mbox{\hyperlink{classrml_1_1internal_1_1_bin_adde6cbfe4fe734a4cfeef1626c327e9a}{Bin::setPreviousBlockActive}}()}
\DoxyCodeLine{01712\ \{}
\DoxyCodeLine{01713\ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ \mbox{\hyperlink{classrml_1_1internal_1_1_bin_ab97ae6d4fad5c846576164dcfc44702a}{activeBlk}},\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );}
\DoxyCodeLine{01714\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}*\ temp\ =\ \mbox{\hyperlink{classrml_1_1internal_1_1_bin_ab97ae6d4fad5c846576164dcfc44702a}{activeBlk}}-\/>previous;}
\DoxyCodeLine{01715\ \ \ \ \ \textcolor{keywordflow}{if}(\ temp\ )\ \{}
\DoxyCodeLine{01716\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ !(temp-\/>\mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a76d70cbe8837862cdf286a120266e430}{isFull}}),\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );}
\DoxyCodeLine{01717\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_bin_ab97ae6d4fad5c846576164dcfc44702a}{activeBlk}}\ =\ temp;}
\DoxyCodeLine{01718\ \ \ \ \ \}}
\DoxyCodeLine{01719\ \ \ \ \ \textcolor{keywordflow}{return}\ temp;}
\DoxyCodeLine{01720\ \}}
\DoxyCodeLine{01721\ }
\DoxyCodeLine{01722\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classrml_1_1internal_1_1_block_a764948ac32e7d5689a755e4af99308e2}{Block::isOwnedByCurrentThread}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01723\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_ac591e79d62cf0ee8907a3e60991d0734}{tlsPtr}}\ \&\&\ \mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a22b6910d3d56fd1183c5c4a1ed44e09f}{ownerTid}}.isCurrentThreadId();}
\DoxyCodeLine{01724\ \}}
\DoxyCodeLine{01725\ }
\DoxyCodeLine{01726\ \mbox{\hyperlink{structrml_1_1internal_1_1_free_object}{FreeObject}}\ *\mbox{\hyperlink{classrml_1_1internal_1_1_block_a1cc1c9493f28b26a694f9206d2b82f3c}{Block::findObjectToFree}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *\textcolor{keywordtype}{object})\textcolor{keyword}{\ const}}
\DoxyCodeLine{01727\ \textcolor{keyword}{}\{}
\DoxyCodeLine{01728\ \ \ \ \ \mbox{\hyperlink{structrml_1_1internal_1_1_free_object}{FreeObject}}\ *objectToFree;}
\DoxyCodeLine{01729\ \ \ \ \ \textcolor{comment}{//\ Due\ to\ aligned\ allocations,\ a\ pointer\ passed\ to\ scalable\_free}}
\DoxyCodeLine{01730\ \ \ \ \ \textcolor{comment}{//\ might\ differ\ from\ the\ address\ of\ internally\ allocated\ object.}}
\DoxyCodeLine{01731\ \ \ \ \ \textcolor{comment}{//\ Small\ objects\ however\ should\ always\ be\ fine.}}
\DoxyCodeLine{01732\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a0e116178c7df6b87077b7b029a0fe653}{objectSize}}\ <=\ \mbox{\hyperlink{namespacerml_1_1internal_ac18775d0814a506927c2bb6b978a1d73}{maxSegregatedObjectSize}})}
\DoxyCodeLine{01733\ \ \ \ \ \ \ \ \ objectToFree\ =\ (\mbox{\hyperlink{structrml_1_1internal_1_1_free_object}{FreeObject}}*)\textcolor{keywordtype}{object};}
\DoxyCodeLine{01734\ \ \ \ \ \textcolor{comment}{//\ "{}Fitting\ size"{}\ allocations\ are\ suspicious\ if\ aligned\ higher\ than\ naturally}}
\DoxyCodeLine{01735\ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01736\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\ !\ \mbox{\hyperlink{_customize_8h_a717f2c2c0501922cd654a5ebf49b287e}{isAligned}}(\textcolor{keywordtype}{object},2*\mbox{\hyperlink{namespacerml_1_1internal_ab092ca824bbb860a4cb0153229864bb7}{fittingAlignment}})\ )}
\DoxyCodeLine{01737\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ TODO:\ the\ above\ check\ is\ questionable\ -\/\ it\ gives\ false\ negatives\ in\ \string~50\%\ cases,}}
\DoxyCodeLine{01738\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ so\ might\ even\ be\ slower\ in\ average\ than\ unconditional\ use\ of\ findAllocatedObject.}}
\DoxyCodeLine{01739\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ here\ it\ should\ be\ a\ "{}real"{}\ object}}
\DoxyCodeLine{01740\ \ \ \ \ \ \ \ \ \ \ \ \ objectToFree\ =\ (\mbox{\hyperlink{structrml_1_1internal_1_1_free_object}{FreeObject}}*)\textcolor{keywordtype}{object};}
\DoxyCodeLine{01741\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{01742\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ here\ object\ can\ be\ an\ aligned\ address,\ so\ applying\ additional\ checks}}
\DoxyCodeLine{01743\ \ \ \ \ \ \ \ \ \ \ \ \ objectToFree\ =\ \mbox{\hyperlink{classrml_1_1internal_1_1_block_a40ba10a264d6930e09da78ecfc9034a7}{findAllocatedObject}}(\textcolor{keywordtype}{object});}
\DoxyCodeLine{01744\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ \mbox{\hyperlink{_customize_8h_a717f2c2c0501922cd654a5ebf49b287e}{isAligned}}(objectToFree,\mbox{\hyperlink{namespacerml_1_1internal_ab092ca824bbb860a4cb0153229864bb7}{fittingAlignment}}),\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );}
\DoxyCodeLine{01745\ \ \ \ \ \}}
\DoxyCodeLine{01746\ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ \mbox{\hyperlink{classrml_1_1internal_1_1_block_a0784348220b090a74a437cc7a61d0c88}{isProperlyPlaced}}(objectToFree),\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );}
\DoxyCodeLine{01747\ }
\DoxyCodeLine{01748\ \ \ \ \ \textcolor{keywordflow}{return}\ objectToFree;}
\DoxyCodeLine{01749\ \}}
\DoxyCodeLine{01750\ }
\DoxyCodeLine{01751\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data_a782f29462cd5eaf08ad7beec48e88761}{TLSData::release}}()}
\DoxyCodeLine{01752\ \{}
\DoxyCodeLine{01753\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data_ab364147df477e80294c59a9b9ff79d53}{memPool}}-\/>extMemPool.allLocalCaches.unregisterThread(\textcolor{keyword}{this});}
\DoxyCodeLine{01754\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data_a6249ba2f15b82c002a6b82a731ad09b0}{externalCleanup}}(\textcolor{comment}{/*cleanOnlyUnused=*/}\textcolor{keyword}{false},\ \textcolor{comment}{/*cleanBins=*/}\textcolor{keyword}{false});}
\DoxyCodeLine{01755\ }
\DoxyCodeLine{01756\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ab47dd9958bcadea08866b42bf358e95e}{index}}\ =\ 0;\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ab47dd9958bcadea08866b42bf358e95e}{index}}\ <\ \mbox{\hyperlink{namespacerml_1_1internal_a21c3f916c95516a91553eb2d3cf8a190}{numBlockBins}};\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ab47dd9958bcadea08866b42bf358e95e}{index}}++)\ \{}
\DoxyCodeLine{01757\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}\ *activeBlk\ =\ \mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data_a140deb931bef016f17cacae4ec0754c3}{bin}}[\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ab47dd9958bcadea08866b42bf358e95e}{index}}].getActiveBlock();}
\DoxyCodeLine{01758\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!activeBlk)}
\DoxyCodeLine{01759\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{01760\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}\ *threadlessBlock\ =\ activeBlk-\/>\mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a3a5c6afadff504e7196e643938f26cad}{previous}};}
\DoxyCodeLine{01761\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (threadlessBlock)\ \{}
\DoxyCodeLine{01762\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}\ *threadBlock\ =\ threadlessBlock-\/>\mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a3a5c6afadff504e7196e643938f26cad}{previous}};}
\DoxyCodeLine{01763\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (threadlessBlock-\/>\mbox{\hyperlink{classrml_1_1internal_1_1_block_a2a7ca914c507f4411cd9d8dd1bd63330}{empty}}())\ \{}
\DoxyCodeLine{01764\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ we\ destroy\ the\ thread,\ so\ not\ use\ its\ block\ pool\ */}}
\DoxyCodeLine{01765\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data_ab364147df477e80294c59a9b9ff79d53}{memPool}}-\/>returnEmptyBlock(threadlessBlock,\ \textcolor{comment}{/*poolTheBlock=*/}\textcolor{keyword}{false});}
\DoxyCodeLine{01766\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01767\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data_ab364147df477e80294c59a9b9ff79d53}{memPool}}-\/>extMemPool.orphanedBlocks.put(intptr\_t(\mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data_a140deb931bef016f17cacae4ec0754c3}{bin}}+\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ab47dd9958bcadea08866b42bf358e95e}{index}}),\ threadlessBlock);}
\DoxyCodeLine{01768\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01769\ \ \ \ \ \ \ \ \ \ \ \ \ threadlessBlock\ =\ threadBlock;}
\DoxyCodeLine{01770\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01771\ \ \ \ \ \ \ \ \ threadlessBlock\ =\ activeBlk;}
\DoxyCodeLine{01772\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (threadlessBlock)\ \{}
\DoxyCodeLine{01773\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}\ *threadBlock\ =\ threadlessBlock-\/>\mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_ab0858e200e0125219210fe856e98fa28}{next}};}
\DoxyCodeLine{01774\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (threadlessBlock-\/>\mbox{\hyperlink{classrml_1_1internal_1_1_block_a2a7ca914c507f4411cd9d8dd1bd63330}{empty}}())\ \{}
\DoxyCodeLine{01775\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ we\ destroy\ the\ thread,\ so\ not\ use\ its\ block\ pool\ */}}
\DoxyCodeLine{01776\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data_ab364147df477e80294c59a9b9ff79d53}{memPool}}-\/>returnEmptyBlock(threadlessBlock,\ \textcolor{comment}{/*poolTheBlock=*/}\textcolor{keyword}{false});}
\DoxyCodeLine{01777\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01778\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data_ab364147df477e80294c59a9b9ff79d53}{memPool}}-\/>extMemPool.orphanedBlocks.put(intptr\_t(\mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data_a140deb931bef016f17cacae4ec0754c3}{bin}}+\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ab47dd9958bcadea08866b42bf358e95e}{index}}),\ threadlessBlock);}
\DoxyCodeLine{01779\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01780\ \ \ \ \ \ \ \ \ \ \ \ \ threadlessBlock\ =\ threadBlock;}
\DoxyCodeLine{01781\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01782\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data_a140deb931bef016f17cacae4ec0754c3}{bin}}[\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ab47dd9958bcadea08866b42bf358e95e}{index}}].resetActiveBlock();}
\DoxyCodeLine{01783\ \ \ \ \ \}}
\DoxyCodeLine{01784\ \}}
\DoxyCodeLine{01785\ }
\DoxyCodeLine{01786\ }
\DoxyCodeLine{01787\ \textcolor{preprocessor}{\#if\ MALLOC\_CHECK\_RECURSION}}
\DoxyCodeLine{01788\ \textcolor{comment}{//\ TODO:\ Use\ dedicated\ heap\ for\ this}}
\DoxyCodeLine{01789\ }
\DoxyCodeLine{01790\ \textcolor{comment}{/*}}
\DoxyCodeLine{01791\ \textcolor{comment}{\ *\ It's\ a\ special\ kind\ of\ allocation\ that\ can\ be\ used\ when\ malloc\ is}}
\DoxyCodeLine{01792\ \textcolor{comment}{\ *\ not\ available\ (either\ during\ startup\ or\ when\ malloc\ was\ already\ called\ and}}
\DoxyCodeLine{01793\ \textcolor{comment}{\ *\ we\ are,\ say,\ inside\ pthread\_setspecific's\ call).}}
\DoxyCodeLine{01794\ \textcolor{comment}{\ *\ Block\ can\ contain\ objects\ of\ different\ sizes,}}
\DoxyCodeLine{01795\ \textcolor{comment}{\ *\ allocations\ are\ performed\ by\ moving\ bump\ pointer\ and\ increasing\ of\ object\ counter,}}
\DoxyCodeLine{01796\ \textcolor{comment}{\ *\ releasing\ is\ done\ via\ counter\ of\ objects\ allocated\ in\ the\ block}}
\DoxyCodeLine{01797\ \textcolor{comment}{\ *\ or\ moving\ bump\ pointer\ if\ releasing\ object\ is\ on\ a\ bound.}}
\DoxyCodeLine{01798\ \textcolor{comment}{\ *\ TODO:\ make\ bump\ pointer\ to\ grow\ to\ the\ same\ backward\ direction\ as\ all\ the\ others.}}
\DoxyCodeLine{01799\ \textcolor{comment}{\ */}}
\DoxyCodeLine{01800\ }
\DoxyCodeLine{01801\ \textcolor{keyword}{class\ }StartupBlock\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}\ \{}
\DoxyCodeLine{01802\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ availableSize()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01803\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacerml_1_1internal_ab92a44f5c0d4ae24554856afbba1943d}{slabSize}}\ -\/\ ((uintptr\_t)bumpPtr\ -\/\ (uintptr\_t)\textcolor{keyword}{this});}
\DoxyCodeLine{01804\ \ \ \ \ \}}
\DoxyCodeLine{01805\ \ \ \ \ \textcolor{keyword}{static}\ StartupBlock\ *getBlock();}
\DoxyCodeLine{01806\ \textcolor{keyword}{public}:}
\DoxyCodeLine{01807\ \ \ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{structrml_1_1internal_1_1_free_object}{FreeObject}}\ *\mbox{\hyperlink{allocator_8c_a3a4fc1fa103fa3a33fc168de4cd6703e}{allocate}}(\textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}});}
\DoxyCodeLine{01808\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{size\_t}\ msize(\textcolor{keywordtype}{void}\ *\mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}})\ \{\ \textcolor{keywordflow}{return}\ *((\textcolor{keywordtype}{size\_t}*)\mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}}\ -\/\ 1);\ \}}
\DoxyCodeLine{01809\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{mimalloc-override_8h_a9d4b5df3530d1bc733070a4669ba6ebc}{free}}(\textcolor{keywordtype}{void}\ *\mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}});}
\DoxyCodeLine{01810\ \};}
\DoxyCodeLine{01811\ }
\DoxyCodeLine{01812\ \textcolor{keyword}{static}\ MallocMutex\ startupMallocLock;}
\DoxyCodeLine{01813\ \textcolor{keyword}{static}\ StartupBlock\ *firstStartupBlock;}
\DoxyCodeLine{01814\ }
\DoxyCodeLine{01815\ StartupBlock\ *StartupBlock::getBlock()}
\DoxyCodeLine{01816\ \{}
\DoxyCodeLine{01817\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_back_ref_idx}{BackRefIdx}}\ backRefIdx\ =\ BackRefIdx::newBackRef(\textcolor{comment}{/*largeObj=*/}\textcolor{keyword}{false});}
\DoxyCodeLine{01818\ \ \ \ \ \textcolor{keywordflow}{if}\ (backRefIdx.isInvalid())\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{01819\ }
\DoxyCodeLine{01820\ \ \ \ \ StartupBlock\ *\mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}\ =\ \textcolor{keyword}{static\_cast<}StartupBlock*\textcolor{keyword}{>}(}
\DoxyCodeLine{01821\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacerml_1_1internal_a775ef3ae8dd6b242d20f44ebd787a1be}{defaultMemPool}}-\/>extMemPool.backend.getSlabBlock(1));}
\DoxyCodeLine{01822\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}})\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{01823\ }
\DoxyCodeLine{01824\ \ \ \ \ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}-\/>cleanBlockHeader();}
\DoxyCodeLine{01825\ \ \ \ \ \mbox{\hyperlink{namespacerml_1_1internal_aa5ddbf0f60817126c51b54ca648caf34}{setBackRef}}(backRefIdx,\ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}});}
\DoxyCodeLine{01826\ \ \ \ \ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}-\/>backRefIdx\ =\ backRefIdx;}
\DoxyCodeLine{01827\ \ \ \ \ \textcolor{comment}{//\ use\ startupAllocObjSizeMark\ to\ mark\ objects\ from\ startup\ block\ marker}}
\DoxyCodeLine{01828\ \ \ \ \ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}-\/>objectSize\ =\ \mbox{\hyperlink{namespacerml_1_1internal_a854b5f12c3c2951f100004bb161b3d4e}{startupAllocObjSizeMark}};}
\DoxyCodeLine{01829\ \ \ \ \ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}-\/>bumpPtr\ =\ (\mbox{\hyperlink{structrml_1_1internal_1_1_free_object}{FreeObject}}\ *)((uintptr\_t)\mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}\ +\ \textcolor{keyword}{sizeof}(StartupBlock));}
\DoxyCodeLine{01830\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}};}
\DoxyCodeLine{01831\ \}}
\DoxyCodeLine{01832\ }
\DoxyCodeLine{01833\ \mbox{\hyperlink{structrml_1_1internal_1_1_free_object}{FreeObject}}\ *StartupBlock::allocate(\textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}})}
\DoxyCodeLine{01834\ \{}
\DoxyCodeLine{01835\ \ \ \ \ \mbox{\hyperlink{structrml_1_1internal_1_1_free_object}{FreeObject}}\ *\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}};}
\DoxyCodeLine{01836\ \ \ \ \ StartupBlock\ *newBlock\ =\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{01837\ \ \ \ \ \textcolor{keywordtype}{bool}\ newBlockUnused\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01838\ }
\DoxyCodeLine{01839\ \ \ \ \ \textcolor{comment}{/*\ Objects\ must\ be\ aligned\ on\ their\ natural\ bounds,}}
\DoxyCodeLine{01840\ \textcolor{comment}{\ \ \ \ \ \ \ and\ objects\ bigger\ than\ word\ on\ word's\ bound.\ */}}
\DoxyCodeLine{01841\ \ \ \ \ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}}\ =\ \mbox{\hyperlink{shared__utils_8h_abf7a0e928f58ffeeefa291f674c30d69}{alignUp}}(\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}},\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{size\_t}));}
\DoxyCodeLine{01842\ \ \ \ \ \textcolor{comment}{//\ We\ need\ size\ of\ an\ object\ to\ implement\ msize.}}
\DoxyCodeLine{01843\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ reqSize\ =\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}}\ +\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{namespacemap_a0eee77b0927f0a32275daa00d1a418ac}{size\_t}});}
\DoxyCodeLine{01844\ \ \ \ \ \textcolor{comment}{//\ speculatively\ allocates\ newBlock\ to\ try\ avoid\ allocation\ while\ holding\ lock}}
\DoxyCodeLine{01845\ \ \ \ \ \textcolor{comment}{/*\ TODO:\ The\ function\ is\ called\ when\ malloc\ nested\ call\ is\ detected,}}
\DoxyCodeLine{01846\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ so\ simultaneous\ usage\ from\ different\ threads\ seems\ unlikely.}}
\DoxyCodeLine{01847\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ If\ pre-\/allocation\ is\ found\ useless,\ the\ code\ might\ be\ simplified.\ */}}
\DoxyCodeLine{01848\ \ \ \ \ \textcolor{keywordflow}{if}\ (!firstStartupBlock\ ||\ firstStartupBlock-\/>availableSize()\ <\ reqSize)\ \{}
\DoxyCodeLine{01849\ \ \ \ \ \ \ \ \ newBlock\ =\ StartupBlock::getBlock();}
\DoxyCodeLine{01850\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!newBlock)\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{01851\ \ \ \ \ \}}
\DoxyCodeLine{01852\ \ \ \ \ \{}
\DoxyCodeLine{01853\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_malloc_mutex_afcf922650b2fd9d76b7b939d8511bbd8}{MallocMutex::scoped\_lock}}\ scoped\_cs(startupMallocLock);}
\DoxyCodeLine{01854\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Re-\/check\ whether\ we\ need\ a\ new\ block\ (conditions\ might\ have\ changed)}}
\DoxyCodeLine{01855\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!firstStartupBlock\ ||\ firstStartupBlock-\/>availableSize()\ <\ reqSize)\ \{}
\DoxyCodeLine{01856\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!newBlock)\ \{}
\DoxyCodeLine{01857\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ newBlock\ =\ StartupBlock::getBlock();}
\DoxyCodeLine{01858\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!newBlock)\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{01859\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01860\ \ \ \ \ \ \ \ \ \ \ \ \ newBlock-\/>next\ =\ (\mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}*)firstStartupBlock;}
\DoxyCodeLine{01861\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (firstStartupBlock)}
\DoxyCodeLine{01862\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ firstStartupBlock-\/>previous\ =\ (\mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}*)newBlock;}
\DoxyCodeLine{01863\ \ \ \ \ \ \ \ \ \ \ \ \ firstStartupBlock\ =\ newBlock;}
\DoxyCodeLine{01864\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}}
\DoxyCodeLine{01865\ \ \ \ \ \ \ \ \ \ \ \ \ newBlockUnused\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01866\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}}\ =\ firstStartupBlock-\/>bumpPtr;}
\DoxyCodeLine{01867\ \ \ \ \ \ \ \ \ firstStartupBlock-\/>allocatedCount++;}
\DoxyCodeLine{01868\ \ \ \ \ \ \ \ \ firstStartupBlock-\/>bumpPtr\ =}
\DoxyCodeLine{01869\ \ \ \ \ \ \ \ \ \ \ \ \ (\mbox{\hyperlink{structrml_1_1internal_1_1_free_object}{FreeObject}}\ *)((uintptr\_t)firstStartupBlock-\/>bumpPtr\ +\ reqSize);}
\DoxyCodeLine{01870\ \ \ \ \ \}}
\DoxyCodeLine{01871\ \ \ \ \ \textcolor{keywordflow}{if}\ (newBlock\ \&\&\ newBlockUnused)}
\DoxyCodeLine{01872\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacerml_1_1internal_a775ef3ae8dd6b242d20f44ebd787a1be}{defaultMemPool}}-\/>returnEmptyBlock(newBlock,\ \textcolor{comment}{/*poolTheBlock=*/}\textcolor{keyword}{false});}
\DoxyCodeLine{01873\ }
\DoxyCodeLine{01874\ \ \ \ \ \textcolor{comment}{//\ keep\ object\ size\ at\ the\ negative\ offset}}
\DoxyCodeLine{01875\ \ \ \ \ *((\textcolor{keywordtype}{size\_t}*)\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}})\ =\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}};}
\DoxyCodeLine{01876\ \ \ \ \ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{structrml_1_1internal_1_1_free_object}{FreeObject}}*)((\textcolor{keywordtype}{size\_t}*)\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}}+1);}
\DoxyCodeLine{01877\ \}}
\DoxyCodeLine{01878\ }
\DoxyCodeLine{01879\ \textcolor{keywordtype}{void}\ StartupBlock::free(\textcolor{keywordtype}{void}\ *\mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}})}
\DoxyCodeLine{01880\ \{}
\DoxyCodeLine{01881\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}*\ blockToRelease\ =\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{01882\ \ \ \ \ \{}
\DoxyCodeLine{01883\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_malloc_mutex_afcf922650b2fd9d76b7b939d8511bbd8}{MallocMutex::scoped\_lock}}\ scoped\_cs(startupMallocLock);}
\DoxyCodeLine{01884\ }
\DoxyCodeLine{01885\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(firstStartupBlock,\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}});}
\DoxyCodeLine{01886\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\mbox{\hyperlink{namespacerml_1_1internal_a854b5f12c3c2951f100004bb161b3d4e}{startupAllocObjSizeMark}}==objectSize}
\DoxyCodeLine{01887\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\&\ allocatedCount>0,\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}});}
\DoxyCodeLine{01888\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}((uintptr\_t)\mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}}>=(uintptr\_t)\textcolor{keyword}{this}+\textcolor{keyword}{sizeof}(StartupBlock)}
\DoxyCodeLine{01889\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\&\ (uintptr\_t)\mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}}+StartupBlock::msize(\mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}})<=(uintptr\_t)\textcolor{keyword}{this}+\mbox{\hyperlink{namespacerml_1_1internal_ab92a44f5c0d4ae24554856afbba1943d}{slabSize}},}
\DoxyCodeLine{01890\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}});}
\DoxyCodeLine{01891\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (0\ ==\ -\/-\/allocatedCount)\ \{}
\DoxyCodeLine{01892\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\textcolor{keyword}{this}\ ==\ firstStartupBlock)}
\DoxyCodeLine{01893\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ firstStartupBlock\ =\ (StartupBlock*)firstStartupBlock-\/>next;}
\DoxyCodeLine{01894\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (previous)}
\DoxyCodeLine{01895\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ previous-\/>next\ =\ \mbox{\hyperlink{namespaceeastl_a4e92bbac38652d0b6a6b9882c003fd43}{next}};}
\DoxyCodeLine{01896\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (next)}
\DoxyCodeLine{01897\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespaceeastl_a4e92bbac38652d0b6a6b9882c003fd43}{next}}-\/>previous\ =\ previous;}
\DoxyCodeLine{01898\ \ \ \ \ \ \ \ \ \ \ \ \ blockToRelease\ =\ \textcolor{keyword}{this};}
\DoxyCodeLine{01899\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ ((uintptr\_t)\mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}}\ +\ StartupBlock::msize(\mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}})\ ==\ (uintptr\_t)bumpPtr)\ \{}
\DoxyCodeLine{01900\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ last\ object\ in\ the\ block\ released}}
\DoxyCodeLine{01901\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structrml_1_1internal_1_1_free_object}{FreeObject}}\ *newBump\ =\ (\mbox{\hyperlink{structrml_1_1internal_1_1_free_object}{FreeObject}}*)((\textcolor{keywordtype}{size\_t}*)\mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}}\ -\/\ 1);}
\DoxyCodeLine{01902\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}((uintptr\_t)newBump>(uintptr\_t)\textcolor{keyword}{this}+\textcolor{keyword}{sizeof}(StartupBlock),}
\DoxyCodeLine{01903\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}});}
\DoxyCodeLine{01904\ \ \ \ \ \ \ \ \ \ \ \ \ bumpPtr\ =\ newBump;}
\DoxyCodeLine{01905\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01906\ \ \ \ \ \}}
\DoxyCodeLine{01907\ \ \ \ \ \textcolor{keywordflow}{if}\ (blockToRelease)\ \{}
\DoxyCodeLine{01908\ \ \ \ \ \ \ \ \ blockToRelease-\/>\mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a3a5c6afadff504e7196e643938f26cad}{previous}}\ =\ blockToRelease-\/>\mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_ab0858e200e0125219210fe856e98fa28}{next}}\ =\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{01909\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacerml_1_1internal_a775ef3ae8dd6b242d20f44ebd787a1be}{defaultMemPool}}-\/>returnEmptyBlock(blockToRelease,\ \textcolor{comment}{/*poolTheBlock=*/}\textcolor{keyword}{false});}
\DoxyCodeLine{01910\ \ \ \ \ \}}
\DoxyCodeLine{01911\ \}}
\DoxyCodeLine{01912\ }
\DoxyCodeLine{01913\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{/*\ MALLOC\_CHECK\_RECURSION\ */}\textcolor{preprocessor}{}}
\DoxyCodeLine{01914\ }
\DoxyCodeLine{01915\ \textcolor{comment}{/*********\ End\ thread\ related\ code\ \ *************/}}
\DoxyCodeLine{01916\ }
\DoxyCodeLine{01917\ \textcolor{comment}{/*********\ Library\ initialization\ *************/}}
\DoxyCodeLine{01918\ }
\DoxyCodeLine{01920\ \textcolor{comment}{/*\ 0\ =\ initialization\ not\ started.}}
\DoxyCodeLine{01921\ \textcolor{comment}{\ *\ 1\ =\ initialization\ started\ but\ not\ finished.}}
\DoxyCodeLine{01922\ \textcolor{comment}{\ *\ 2\ =\ initialization\ finished.}}
\DoxyCodeLine{01923\ \textcolor{comment}{\ *\ In\ theory,\ we\ only\ need\ values\ 0\ and\ 2.\ But\ value\ 1\ is\ nonetheless}}
\DoxyCodeLine{01924\ \textcolor{comment}{\ *\ useful\ for\ detecting\ errors\ in\ the\ double-\/check\ pattern.}}
\DoxyCodeLine{01925\ \textcolor{comment}{\ */}}
\DoxyCodeLine{01926\ \textcolor{keyword}{static}\ intptr\_t\ \mbox{\hyperlink{namespacerml_1_1internal_aff6ca9c05f9bd993c8b383d177c55b8e}{mallocInitialized}};\ \ \ \textcolor{comment}{//\ implicitly\ initialized\ to\ 0}}
\DoxyCodeLine{01927\ \textcolor{keyword}{static}\ \mbox{\hyperlink{class_malloc_mutex}{MallocMutex}}\ \mbox{\hyperlink{namespacerml_1_1internal_a945751afa11de4b96d4fdc9ff8bc62d5}{initMutex}};}
\DoxyCodeLine{01928\ }
\DoxyCodeLine{01931\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{char}\ \mbox{\hyperlink{namespacerml_1_1internal_ab48fa6f48f85d15c4f2fe57c51814a87}{VersionString}}[]\ =\ \textcolor{stringliteral}{"{}\(\backslash\)0"{}}\ \mbox{\hyperlink{tbb__version_8h_a626a51ac58cbebf4e0894a465c058f28}{TBBMALLOC\_VERSION\_STRINGS}};}
\DoxyCodeLine{01932\ }
\DoxyCodeLine{01933\ \textcolor{preprocessor}{\#if\ USE\_PTHREAD\ \&\&\ (\_\_TBB\_SOURCE\_DIRECTLY\_INCLUDED\ ||\ \_\_TBB\_USE\_DLOPEN\_REENTRANCY\_WORKAROUND)}}
\DoxyCodeLine{01934\ }
\DoxyCodeLine{01935\ \textcolor{comment}{/*\ Decrease\ race\ interval\ between\ dynamic\ library\ unloading\ and\ pthread\ key}}
\DoxyCodeLine{01936\ \textcolor{comment}{\ \ \ destructor.\ Protect\ only\ Pthreads\ with\ supported\ unloading.\ */}}
\DoxyCodeLine{01937\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classrml_1_1internal_1_1_shutdown_sync}{ShutdownSync}}\ \{}
\DoxyCodeLine{01938\ \textcolor{comment}{/*\ flag\ is\ the\ number\ of\ threads\ in\ pthread\ key\ dtor\ body}}
\DoxyCodeLine{01939\ \textcolor{comment}{\ \ \ (i.e.,\ between\ threadDtorStart()\ and\ threadDtorDone())}}
\DoxyCodeLine{01940\ \textcolor{comment}{\ \ \ or\ the\ signal\ to\ skip\ dtor,\ if\ flag\ <\ 0\ */}}
\DoxyCodeLine{01941\ \ \ \ \ intptr\_t\ flag;}
\DoxyCodeLine{01942\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ intptr\_t\ skipDtor\ =\ \mbox{\hyperlink{eabase_8h_a2aaa6d3aa1d7d1e0e326955aa24db752}{INTPTR\_MIN}}/2;}
\DoxyCodeLine{01943\ \textcolor{keyword}{public}:}
\DoxyCodeLine{01944\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1internal_1_1_shutdown_sync_afffa916f72f345e256498c341488a4e6}{init}}()\ \{\ flag\ =\ 0;\ \}}
\DoxyCodeLine{01945\ \textcolor{comment}{/*\ Suppose\ that\ 2*abs(skipDtor)\ or\ more\ threads\ never\ call\ threadDtorStart()}}
\DoxyCodeLine{01946\ \textcolor{comment}{\ \ \ simultaneously,\ so\ flag\ never\ becomes\ negative\ because\ of\ that.\ */}}
\DoxyCodeLine{01947\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classrml_1_1internal_1_1_shutdown_sync_a5467aaf4a198ffbae69c1e0e446b9a02}{threadDtorStart}}()\ \{}
\DoxyCodeLine{01948\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (flag\ <\ 0)}
\DoxyCodeLine{01949\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01950\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{_synchronize_8h_a248bc2de542e20022d01360546768c50}{AtomicIncrement}}(flag)\ <=\ 0)\ \{\ \textcolor{comment}{//\ note\ that\ new\ value\ returned}}
\DoxyCodeLine{01951\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_synchronize_8h_ae9382ede99cb71105906a4be5337e684}{AtomicAdd}}(flag,\ -\/1);\ \ \textcolor{comment}{//\ flag\ is\ spoiled\ by\ us,\ restore\ it}}
\DoxyCodeLine{01952\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01953\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01954\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{01955\ \ \ \ \ \}}
\DoxyCodeLine{01956\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1internal_1_1_shutdown_sync_a81b701e495c816f144435b04bf92f45c}{threadDtorDone}}()\ \{}
\DoxyCodeLine{01957\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_synchronize_8h_ae9382ede99cb71105906a4be5337e684}{AtomicAdd}}(flag,\ -\/1);}
\DoxyCodeLine{01958\ \ \ \ \ \}}
\DoxyCodeLine{01959\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1internal_1_1_shutdown_sync_afcd88cc7899464924316325f0ba1eca4}{processExit}}()\ \{}
\DoxyCodeLine{01960\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{_synchronize_8h_ae9382ede99cb71105906a4be5337e684}{AtomicAdd}}(flag,\ skipDtor)\ !=\ 0)}
\DoxyCodeLine{01961\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_synchronize_8h_aecf76db787a03ec38862ce3726cd1d72}{SpinWaitUntilEq}}(flag,\ skipDtor);}
\DoxyCodeLine{01962\ \ \ \ \ \}}
\DoxyCodeLine{01963\ \};}
\DoxyCodeLine{01964\ }
\DoxyCodeLine{01965\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{01966\ }
\DoxyCodeLine{01967\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classrml_1_1internal_1_1_shutdown_sync}{ShutdownSync}}\ \{}
\DoxyCodeLine{01968\ \textcolor{keyword}{public}:}
\DoxyCodeLine{01969\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1internal_1_1_shutdown_sync_afffa916f72f345e256498c341488a4e6}{init}}()\ \{\ \}}
\DoxyCodeLine{01970\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classrml_1_1internal_1_1_shutdown_sync_a5467aaf4a198ffbae69c1e0e446b9a02}{threadDtorStart}}()\ \{\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};\ \}}
\DoxyCodeLine{01971\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1internal_1_1_shutdown_sync_a81b701e495c816f144435b04bf92f45c}{threadDtorDone}}()\ \{\ \}}
\DoxyCodeLine{01972\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1internal_1_1_shutdown_sync_afcd88cc7899464924316325f0ba1eca4}{processExit}}()\ \{\ \}}
\DoxyCodeLine{01973\ \};}
\DoxyCodeLine{01974\ }
\DoxyCodeLine{01975\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ USE\_PTHREAD\ \&\&\ (\_\_TBB\_SOURCE\_DIRECTLY\_INCLUDED\ ||\ \_\_TBB\_USE\_DLOPEN\_REENTRANCY\_WORKAROUND)}}
\DoxyCodeLine{01976\ }
\DoxyCodeLine{01977\ \textcolor{keyword}{static}\ \mbox{\hyperlink{classrml_1_1internal_1_1_shutdown_sync}{ShutdownSync}}\ \mbox{\hyperlink{namespacerml_1_1internal_a93ecc803ce228488d5280172f0925c4a}{shutdownSync}};}
\DoxyCodeLine{01978\ }
\DoxyCodeLine{01979\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{namespacerml_1_1internal_a61c4d632ea815cbeea8ed0ee72e06ac7}{isMallocInitialized}}()\ \{}
\DoxyCodeLine{01980\ \ \ \ \ \textcolor{comment}{//\ Load\ must\ have\ acquire\ fence;\ otherwise\ thread\ taking\ "{}initialized"{}\ path}}
\DoxyCodeLine{01981\ \ \ \ \ \textcolor{comment}{//\ might\ perform\ textually\ later\ loads\ *before*\ mallocInitialized\ becomes\ 2.}}
\DoxyCodeLine{01982\ \ \ \ \ \textcolor{keywordflow}{return}\ 2\ ==\ \mbox{\hyperlink{_synchronize_8h_a0792980ea26344eaf2fc0a4112b5d848}{FencedLoad}}(\mbox{\hyperlink{namespacerml_1_1internal_aff6ca9c05f9bd993c8b383d177c55b8e}{mallocInitialized}});}
\DoxyCodeLine{01983\ \}}
\DoxyCodeLine{01984\ }
\DoxyCodeLine{01985\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{namespacerml_1_1internal_acc91531a75193a3a4541a68b4771905b}{isMallocInitializedExt}}()\ \{}
\DoxyCodeLine{01986\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacerml_1_1internal_a61c4d632ea815cbeea8ed0ee72e06ac7}{isMallocInitialized}}();}
\DoxyCodeLine{01987\ \}}
\DoxyCodeLine{01988\ }
\DoxyCodeLine{01989\ \textcolor{comment}{/*\ Caller\ is\ responsible\ for\ ensuring\ this\ routine\ is\ called\ exactly\ once.\ */}}
\DoxyCodeLine{01990\ \textcolor{keyword}{extern}\ \textcolor{stringliteral}{"{}C"{}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{namespacerml_1_1internal_a1496938d4795ed7716f08eff02966822}{MallocInitializeITT}}()\ \{}
\DoxyCodeLine{01991\ \textcolor{preprocessor}{\#if\ DO\_ITT\_NOTIFY}}
\DoxyCodeLine{01992\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{namespacerml_1_1internal_adfef860fe0efd8df96bdddf72c66e7e2}{usedBySrcIncluded}})}
\DoxyCodeLine{01993\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacetbb_1_1internal_a2b4ad2321a003fdcedfac9784ce9a2be}{tbb::internal::\_\_TBB\_load\_ittnotify}}();}
\DoxyCodeLine{01994\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01995\ \}}
\DoxyCodeLine{01996\ }
\DoxyCodeLine{01997\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_add7381e97285946d931d763e07dee7e5}{MemoryPool::initDefaultPool}}()\ \{}
\DoxyCodeLine{01998\ \ \ \ \ \mbox{\hyperlink{namespacerml_1_1internal_a47aa4f0d1eb6a621e5830ea034495648}{hugePages}}.init();}
\DoxyCodeLine{01999\ \}}
\DoxyCodeLine{02000\ }
\DoxyCodeLine{02001\ \textcolor{comment}{/*}}
\DoxyCodeLine{02002\ \textcolor{comment}{\ *\ Allocator\ initialization\ routine;}}
\DoxyCodeLine{02003\ \textcolor{comment}{\ *\ it\ is\ called\ lazily\ on\ the\ very\ first\ scalable\_malloc\ call.}}
\DoxyCodeLine{02004\ \textcolor{comment}{\ */}}
\DoxyCodeLine{02005\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{namespacerml_1_1internal_ab24be00d5e9e602105742c4b1c7903a4}{initMemoryManager}}()}
\DoxyCodeLine{02006\ \{}
\DoxyCodeLine{02007\ \ \ \ \ \mbox{\hyperlink{tbbmalloc__internal_8h_af1c1baacf37ff8d445664716b811ee39}{TRACEF}}((\ \textcolor{stringliteral}{"{}[ScalableMalloc\ trace]\ sizeof(Block)\ is\ \%d\ (expected\ 128);\ sizeof(uintptr\_t)\ is\ \%d\(\backslash\)n"{}},}
\DoxyCodeLine{02008\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}),\ \textcolor{keyword}{sizeof}(uintptr\_t)\ ));}
\DoxyCodeLine{02009\ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ 2*\mbox{\hyperlink{namespacerml_1_1internal_a60e9e26358bf7e6c992a1181a8f4ddf5}{blockHeaderAlignment}}\ ==\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}),\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );}
\DoxyCodeLine{02010\ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structrml_1_1internal_1_1_free_object}{FreeObject}})\ ==\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{void}*),\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );}
\DoxyCodeLine{02011\ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ \mbox{\hyperlink{_customize_8h_a717f2c2c0501922cd654a5ebf49b287e}{isAligned}}(\mbox{\hyperlink{namespacerml_1_1internal_a775ef3ae8dd6b242d20f44ebd787a1be}{defaultMemPool}},\ \textcolor{keyword}{sizeof}(intptr\_t)),}
\DoxyCodeLine{02012\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Memory\ pool\ must\ be\ void*-\/aligned\ for\ atomic\ to\ work\ over\ aligned\ arguments."{}});}
\DoxyCodeLine{02013\ }
\DoxyCodeLine{02014\ \textcolor{preprocessor}{\#if\ USE\_WINTHREAD}}
\DoxyCodeLine{02015\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ granularity\ =\ 64*1024;\ \textcolor{comment}{//\ granulatity\ of\ VirtualAlloc}}
\DoxyCodeLine{02016\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{02017\ \ \ \ \ \textcolor{comment}{//\ POSIX.1-\/2001-\/compliant\ way\ to\ get\ page\ size}}
\DoxyCodeLine{02018\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ granularity\ =\ sysconf(\_SC\_PAGESIZE);}
\DoxyCodeLine{02019\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02020\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{namespacerml_1_1internal_a775ef3ae8dd6b242d20f44ebd787a1be}{defaultMemPool}})\ \{}
\DoxyCodeLine{02021\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Do\ not\ rely\ on\ static\ constructors\ and\ do\ the\ assignment\ in\ case}}
\DoxyCodeLine{02022\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ of\ library\ static\ section\ not\ initialized\ at\ this\ call\ yet.}}
\DoxyCodeLine{02023\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacerml_1_1internal_a775ef3ae8dd6b242d20f44ebd787a1be}{defaultMemPool}}\ =\ (\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool}{MemoryPool}}*)\mbox{\hyperlink{namespacerml_1_1internal_a20dda5aef9747bc10069cc46cb32b2f2}{defaultMemPool\_space}};}
\DoxyCodeLine{02024\ \ \ \ \ \}}
\DoxyCodeLine{02025\ \ \ \ \ \textcolor{keywordtype}{bool}\ initOk\ =\ \mbox{\hyperlink{namespacerml_1_1internal_a775ef3ae8dd6b242d20f44ebd787a1be}{defaultMemPool}}-\/>}
\DoxyCodeLine{02026\ \ \ \ \ \ \ \ \ extMemPool.init(0,\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}},\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}},\ granularity,}
\DoxyCodeLine{02027\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*keepAllMemory=*/}\textcolor{keyword}{false},\ \textcolor{comment}{/*fixedPool=*/}\textcolor{keyword}{false});}
\DoxyCodeLine{02028\ \textcolor{comment}{//\ TODO:\ extMemPool.init()\ to\ not\ allocate\ memory}}
\DoxyCodeLine{02029\ \ \ \ \ \textcolor{keywordflow}{if}\ (!initOk\ ||\ !\mbox{\hyperlink{namespacerml_1_1internal_a35c262cb0badff1e3b2a9df6357a344a}{initBackRefMaster}}(\&\mbox{\hyperlink{namespacerml_1_1internal_a775ef3ae8dd6b242d20f44ebd787a1be}{defaultMemPool}}-\/>extMemPool.backend)\ ||\ !\mbox{\hyperlink{classrml_1_1internal_1_1_thread_id_a58d4cb2156367a2fc468f6daf5cbded2}{ThreadId::init}}())}
\DoxyCodeLine{02030\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{02031\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_add7381e97285946d931d763e07dee7e5}{MemoryPool::initDefaultPool}}();}
\DoxyCodeLine{02032\ \ \ \ \ \textcolor{comment}{//\ init()\ is\ required\ iff\ initMemoryManager()\ is\ called}}
\DoxyCodeLine{02033\ \ \ \ \ \textcolor{comment}{//\ after\ mallocProcessShutdownNotification()}}
\DoxyCodeLine{02034\ \ \ \ \ \mbox{\hyperlink{namespacerml_1_1internal_a93ecc803ce228488d5280172f0925c4a}{shutdownSync}}.init();}
\DoxyCodeLine{02035\ \textcolor{preprocessor}{\#if\ COLLECT\_STATISTICS}}
\DoxyCodeLine{02036\ \ \ \ \ initStatisticsCollection();}
\DoxyCodeLine{02037\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02038\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{02039\ \}}
\DoxyCodeLine{02040\ }
\DoxyCodeLine{02041\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{namespacerml_1_1internal_acbf202195ce55902f2237ab9e8de3be5}{GetBoolEnvironmentVariable}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aab18cfce5ee7c6881ae04f18be70d94a}{name}})\ \{}
\DoxyCodeLine{02042\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacetbb_1_1internal_a97d6c00654cc85d4c072f1a082c8c28a}{tbb::internal::GetBoolEnvironmentVariable}}(\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aab18cfce5ee7c6881ae04f18be70d94a}{name}});}
\DoxyCodeLine{02043\ \}}
\DoxyCodeLine{02044\ }
\DoxyCodeLine{02046\ }
\DoxyCodeLine{02048\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{namespacerml_1_1internal_aad59cc02d849210b00c8587544e44e20}{doInitialization}}()}
\DoxyCodeLine{02049\ \{}
\DoxyCodeLine{02050\ \ \ \ \ \mbox{\hyperlink{class_malloc_mutex_1_1scoped__lock}{MallocMutex::scoped\_lock}}\ \mbox{\hyperlink{ittnotify__static_8h_a46e8be2e3aadb2f6ee62e762a36b9243}{lock}}(\ \mbox{\hyperlink{namespacerml_1_1internal_a945751afa11de4b96d4fdc9ff8bc62d5}{initMutex}}\ );}
\DoxyCodeLine{02051\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacerml_1_1internal_aff6ca9c05f9bd993c8b383d177c55b8e}{mallocInitialized}}!=2)\ \{}
\DoxyCodeLine{02052\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ \mbox{\hyperlink{namespacerml_1_1internal_aff6ca9c05f9bd993c8b383d177c55b8e}{mallocInitialized}}==0,\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );}
\DoxyCodeLine{02053\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacerml_1_1internal_aff6ca9c05f9bd993c8b383d177c55b8e}{mallocInitialized}}\ =\ 1;}
\DoxyCodeLine{02054\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_recursive_malloc_call_protector}{RecursiveMallocCallProtector}}\ scoped;}
\DoxyCodeLine{02055\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{namespacerml_1_1internal_ab24be00d5e9e602105742c4b1c7903a4}{initMemoryManager}}())\ \{}
\DoxyCodeLine{02056\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacerml_1_1internal_aff6ca9c05f9bd993c8b383d177c55b8e}{mallocInitialized}}\ =\ 0;\ \textcolor{comment}{//\ restore\ and\ out}}
\DoxyCodeLine{02057\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{02058\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02059\ \textcolor{preprocessor}{\#ifdef\ \ MALLOC\_EXTRA\_INITIALIZATION}}
\DoxyCodeLine{02060\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_customize_8h_ae4d6dc0761ca5835bb40087f5a79accf}{MALLOC\_EXTRA\_INITIALIZATION}};}
\DoxyCodeLine{02061\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02062\ \textcolor{preprocessor}{\#if\ MALLOC\_CHECK\_RECURSION}}
\DoxyCodeLine{02063\ \ \ \ \ \ \ \ \ RecursiveMallocCallProtector::detectNaiveOverload();}
\DoxyCodeLine{02064\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02065\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ \mbox{\hyperlink{namespacerml_1_1internal_aff6ca9c05f9bd993c8b383d177c55b8e}{mallocInitialized}}==1,\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );}
\DoxyCodeLine{02066\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Store\ must\ have\ release\ fence,\ otherwise\ mallocInitialized==2}}
\DoxyCodeLine{02067\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ might\ become\ remotely\ visible\ before\ side\ effects\ of}}
\DoxyCodeLine{02068\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ initMemoryManager()\ become\ remotely\ visible.}}
\DoxyCodeLine{02069\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_synchronize_8h_a19886ee3899c0a2435ea9840116ea325}{FencedStore}}(\ \mbox{\hyperlink{namespacerml_1_1internal_aff6ca9c05f9bd993c8b383d177c55b8e}{mallocInitialized}},\ 2\ );}
\DoxyCodeLine{02070\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ \mbox{\hyperlink{namespacerml_1_1internal_acbf202195ce55902f2237ab9e8de3be5}{GetBoolEnvironmentVariable}}(\textcolor{stringliteral}{"{}TBB\_VERSION"{}})\ )\ \{}
\DoxyCodeLine{02071\ \ \ \ \ \ \ \ \ \ \ \ \ fputs(\mbox{\hyperlink{namespacerml_1_1internal_ab48fa6f48f85d15c4f2fe57c51814a87}{VersionString}}+1,stderr);}
\DoxyCodeLine{02072\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacerml_1_1internal_a47aa4f0d1eb6a621e5830ea034495648}{hugePages}}.printStatus();}
\DoxyCodeLine{02073\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02074\ \ \ \ \ \}}
\DoxyCodeLine{02075\ \ \ \ \ \textcolor{comment}{/*\ It\ can't\ be\ 0\ or\ I\ would\ have\ initialized\ it\ */}}
\DoxyCodeLine{02076\ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ \mbox{\hyperlink{namespacerml_1_1internal_aff6ca9c05f9bd993c8b383d177c55b8e}{mallocInitialized}}==2,\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );}
\DoxyCodeLine{02077\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{02078\ \}}
\DoxyCodeLine{02079\ }
\DoxyCodeLine{02080\ \textcolor{comment}{/*********\ End\ library\ initialization\ *************/}}
\DoxyCodeLine{02081\ }
\DoxyCodeLine{02082\ \textcolor{comment}{/*********\ The\ malloc\ show\ begins\ \ \ \ \ *************/}}
\DoxyCodeLine{02083\ }
\DoxyCodeLine{02084\ }
\DoxyCodeLine{02085\ \mbox{\hyperlink{structrml_1_1internal_1_1_free_object}{FreeObject}}\ *\mbox{\hyperlink{classrml_1_1internal_1_1_block_a49c5382153edd22b031869f0a822f9f2}{Block::allocateFromFreeList}}()}
\DoxyCodeLine{02086\ \{}
\DoxyCodeLine{02087\ \ \ \ \ \mbox{\hyperlink{structrml_1_1internal_1_1_free_object}{FreeObject}}\ *\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}};}
\DoxyCodeLine{02088\ }
\DoxyCodeLine{02089\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_ade8311f40ae3e9114518063032b7c42a}{freeList}})\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{02090\ }
\DoxyCodeLine{02091\ \ \ \ \ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}}\ =\ \mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_ade8311f40ae3e9114518063032b7c42a}{freeList}};}
\DoxyCodeLine{02092\ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}},\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );}
\DoxyCodeLine{02093\ }
\DoxyCodeLine{02094\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_ade8311f40ae3e9114518063032b7c42a}{freeList}}\ =\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}}-\/>next;}
\DoxyCodeLine{02095\ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ \mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a7d1d7c70675b3ba72924d1cbafd6772a}{allocatedCount}}\ <\ (\mbox{\hyperlink{namespacerml_1_1internal_ab92a44f5c0d4ae24554856afbba1943d}{slabSize}}-\/\textcolor{keyword}{sizeof}(\mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}))/\mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a0e116178c7df6b87077b7b029a0fe653}{objectSize}},\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );}
\DoxyCodeLine{02096\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a7d1d7c70675b3ba72924d1cbafd6772a}{allocatedCount}}++;}
\DoxyCodeLine{02097\ \ \ \ \ \mbox{\hyperlink{tbbmalloc_2statistics_8h_a45adf7cb101679d45b142782cc324196}{STAT\_increment}}(\mbox{\hyperlink{namespacerml_1_1internal_a2877b2db91c23b8b7eb1d37891c40b2b}{getThreadId}}(),\ \mbox{\hyperlink{namespacerml_1_1internal_a70dcd761b867baccb7ffdb087e52e215}{getIndex}}(\mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a0e116178c7df6b87077b7b029a0fe653}{objectSize}}),\ \mbox{\hyperlink{tbbmalloc_2statistics_8h_a88d7e7c1f1ccad444adb066d12334d4aa91506aa635288120efe30a13902bf739}{allocFreeListUsed}});}
\DoxyCodeLine{02098\ }
\DoxyCodeLine{02099\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}};}
\DoxyCodeLine{02100\ \}}
\DoxyCodeLine{02101\ }
\DoxyCodeLine{02102\ \mbox{\hyperlink{structrml_1_1internal_1_1_free_object}{FreeObject}}\ *\mbox{\hyperlink{classrml_1_1internal_1_1_block_a15badeb7c104a8f860a7375ed648a43e}{Block::allocateFromBumpPtr}}()}
\DoxyCodeLine{02103\ \{}
\DoxyCodeLine{02104\ \ \ \ \ \mbox{\hyperlink{structrml_1_1internal_1_1_free_object}{FreeObject}}\ *\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}}\ =\ \mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a7539e25da68797f70368fa66e62e9c1c}{bumpPtr}};}
\DoxyCodeLine{02105\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}})\ \{}
\DoxyCodeLine{02106\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a7539e25da68797f70368fa66e62e9c1c}{bumpPtr}}\ =\ (\mbox{\hyperlink{structrml_1_1internal_1_1_free_object}{FreeObject}}\ *)\ ((uintptr\_t)\ \mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a7539e25da68797f70368fa66e62e9c1c}{bumpPtr}}\ -\/\ \mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a0e116178c7df6b87077b7b029a0fe653}{objectSize}});}
\DoxyCodeLine{02107\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\ (uintptr\_t)\mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a7539e25da68797f70368fa66e62e9c1c}{bumpPtr}}\ <\ (uintptr\_t)\textcolor{keyword}{this}+\textcolor{keyword}{sizeof}(\mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}})\ )\ \{}
\DoxyCodeLine{02108\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a7539e25da68797f70368fa66e62e9c1c}{bumpPtr}}\ =\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{02109\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02110\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ \mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a7d1d7c70675b3ba72924d1cbafd6772a}{allocatedCount}}\ <\ (\mbox{\hyperlink{namespacerml_1_1internal_ab92a44f5c0d4ae24554856afbba1943d}{slabSize}}-\/\textcolor{keyword}{sizeof}(\mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}))/\mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a0e116178c7df6b87077b7b029a0fe653}{objectSize}},\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );}
\DoxyCodeLine{02111\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a7d1d7c70675b3ba72924d1cbafd6772a}{allocatedCount}}++;}
\DoxyCodeLine{02112\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{tbbmalloc_2statistics_8h_a45adf7cb101679d45b142782cc324196}{STAT\_increment}}(\mbox{\hyperlink{namespacerml_1_1internal_a2877b2db91c23b8b7eb1d37891c40b2b}{getThreadId}}(),\ \mbox{\hyperlink{namespacerml_1_1internal_a70dcd761b867baccb7ffdb087e52e215}{getIndex}}(\mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a0e116178c7df6b87077b7b029a0fe653}{objectSize}}),\ \mbox{\hyperlink{tbbmalloc_2statistics_8h_a88d7e7c1f1ccad444adb066d12334d4aa1a00def5a4f74644ba7560ddd8ff16ad}{allocBumpPtrUsed}});}
\DoxyCodeLine{02113\ \ \ \ \ \}}
\DoxyCodeLine{02114\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}};}
\DoxyCodeLine{02115\ \}}
\DoxyCodeLine{02116\ }
\DoxyCodeLine{02117\ \textcolor{keyword}{inline}\ \mbox{\hyperlink{structrml_1_1internal_1_1_free_object}{FreeObject}}*\ \mbox{\hyperlink{classrml_1_1internal_1_1_block_ab304c726e184fcd2cad31e30306e07ab}{Block::allocate}}()}
\DoxyCodeLine{02118\ \{}
\DoxyCodeLine{02119\ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ \mbox{\hyperlink{classrml_1_1internal_1_1_block_a764948ac32e7d5689a755e4af99308e2}{isOwnedByCurrentThread}}(),\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );}
\DoxyCodeLine{02120\ }
\DoxyCodeLine{02121\ \ \ \ \ \textcolor{comment}{/*\ for\ better\ cache\ locality,\ first\ looking\ in\ the\ free\ list.\ */}}
\DoxyCodeLine{02122\ \ \ \ \ \textcolor{keywordflow}{if}\ (\ \mbox{\hyperlink{structrml_1_1internal_1_1_free_object}{FreeObject}}\ *\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}}\ =\ \mbox{\hyperlink{classrml_1_1internal_1_1_block_a49c5382153edd22b031869f0a822f9f2}{allocateFromFreeList}}()\ )\ \{}
\DoxyCodeLine{02123\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}};}
\DoxyCodeLine{02124\ \ \ \ \ \}}
\DoxyCodeLine{02125\ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ !\mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_ade8311f40ae3e9114518063032b7c42a}{freeList}},\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );}
\DoxyCodeLine{02126\ }
\DoxyCodeLine{02127\ \ \ \ \ \textcolor{comment}{/*\ if\ free\ list\ is\ empty,\ try\ thread\ local\ bump\ pointer\ allocation.\ */}}
\DoxyCodeLine{02128\ \ \ \ \ \textcolor{keywordflow}{if}\ (\ \mbox{\hyperlink{structrml_1_1internal_1_1_free_object}{FreeObject}}\ *\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}}\ =\ \mbox{\hyperlink{classrml_1_1internal_1_1_block_a15badeb7c104a8f860a7375ed648a43e}{allocateFromBumpPtr}}()\ )\ \{}
\DoxyCodeLine{02129\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}};}
\DoxyCodeLine{02130\ \ \ \ \ \}}
\DoxyCodeLine{02131\ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ !\mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a7539e25da68797f70368fa66e62e9c1c}{bumpPtr}},\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );}
\DoxyCodeLine{02132\ }
\DoxyCodeLine{02133\ \ \ \ \ \textcolor{comment}{/*\ the\ block\ is\ considered\ full.\ */}}
\DoxyCodeLine{02134\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a76d70cbe8837862cdf286a120266e430}{isFull}}\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{02135\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{02136\ \}}
\DoxyCodeLine{02137\ }
\DoxyCodeLine{02138\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classrml_1_1internal_1_1_block_aa7dc2dc2c4549c010b30647f12fb8c60}{Block::findObjectSize}}(\textcolor{keywordtype}{void}\ *\textcolor{keywordtype}{object})\textcolor{keyword}{\ const}}
\DoxyCodeLine{02139\ \textcolor{keyword}{}\{}
\DoxyCodeLine{02140\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ blSize\ =\ \mbox{\hyperlink{classrml_1_1internal_1_1_block_a4d222fbb9aede736464e89f4e42efcf3}{getSize}}();}
\DoxyCodeLine{02141\ \textcolor{preprocessor}{\#if\ MALLOC\_CHECK\_RECURSION}}
\DoxyCodeLine{02142\ \ \ \ \ \textcolor{comment}{//\ Currently,\ there\ is\ no\ aligned\ allocations\ from\ startup\ blocks,}}
\DoxyCodeLine{02143\ \ \ \ \ \textcolor{comment}{//\ so\ we\ can\ return\ just\ StartupBlock::msize().}}
\DoxyCodeLine{02144\ \ \ \ \ \textcolor{comment}{//\ TODO:\ This\ must\ be\ extended\ if\ we\ add\ aligned\ allocation\ from\ startup\ blocks.}}
\DoxyCodeLine{02145\ \ \ \ \ \textcolor{keywordflow}{if}\ (!blSize)}
\DoxyCodeLine{02146\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ StartupBlock::msize(\textcolor{keywordtype}{object});}
\DoxyCodeLine{02147\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02148\ \ \ \ \ \textcolor{comment}{//\ object\ can\ be\ aligned,\ so\ real\ size\ can\ be\ less\ than\ block's}}
\DoxyCodeLine{02149\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}}\ =}
\DoxyCodeLine{02150\ \ \ \ \ \ \ \ \ blSize\ -\/\ ((uintptr\_t)\textcolor{keywordtype}{object}\ -\/\ (uintptr\_t)\mbox{\hyperlink{classrml_1_1internal_1_1_block_a1cc1c9493f28b26a694f9206d2b82f3c}{findObjectToFree}}(\textcolor{keywordtype}{object}));}
\DoxyCodeLine{02151\ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}}>0\ \&\&\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}}<\mbox{\hyperlink{namespacerml_1_1internal_ad778f7cb21fd95b85e36f2cf18d8fc60}{minLargeObjectSize}},\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}});}
\DoxyCodeLine{02152\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}};}
\DoxyCodeLine{02153\ \}}
\DoxyCodeLine{02154\ }
\DoxyCodeLine{02155\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1internal_1_1_bin_a0e3087b9eb6233c7f5a7598508dcbeae}{Bin::moveBlockToFront}}(\mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}\ *\mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}})}
\DoxyCodeLine{02156\ \{}
\DoxyCodeLine{02157\ \ \ \ \ \textcolor{comment}{/*\ move\ the\ block\ to\ the\ front\ of\ the\ bin\ */}}
\DoxyCodeLine{02158\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}\ ==\ \mbox{\hyperlink{classrml_1_1internal_1_1_bin_ab97ae6d4fad5c846576164dcfc44702a}{activeBlk}})\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{02159\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_bin_adb853b6ddddbdbaff1ce9fbdbd560f40}{outofTLSBin}}(\mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}});}
\DoxyCodeLine{02160\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_bin_a88e5bf9d3eb59a30e58f3dc23e240d4e}{pushTLSBin}}(\mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}});}
\DoxyCodeLine{02161\ \}}
\DoxyCodeLine{02162\ }
\DoxyCodeLine{02163\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1internal_1_1_bin_a0c2e5eadb3e68467ee5635ab367abd46}{Bin::processEmptyBlock}}(\mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}\ *\mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}},\ \textcolor{keywordtype}{bool}\ poolTheBlock)}
\DoxyCodeLine{02164\ \{}
\DoxyCodeLine{02165\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}\ !=\ \mbox{\hyperlink{classrml_1_1internal_1_1_bin_ab97ae6d4fad5c846576164dcfc44702a}{activeBlk}})\ \{}
\DoxyCodeLine{02166\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ We\ are\ not\ using\ this\ block;\ return\ it\ to\ the\ pool\ */}}
\DoxyCodeLine{02167\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_bin_adb853b6ddddbdbaff1ce9fbdbd560f40}{outofTLSBin}}(\mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}});}
\DoxyCodeLine{02168\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}-\/>getMemPool()-\/>returnEmptyBlock(\mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}},\ poolTheBlock);}
\DoxyCodeLine{02169\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02170\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ all\ objects\ are\ free\ -\/\ let's\ restore\ the\ bump\ pointer\ */}}
\DoxyCodeLine{02171\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}-\/>restoreBumpPtr();}
\DoxyCodeLine{02172\ \ \ \ \ \}}
\DoxyCodeLine{02173\ \}}
\DoxyCodeLine{02174\ }
\DoxyCodeLine{02175\ \textcolor{keyword}{template}<\textcolor{keywordtype}{int}\ LOW\_MARK,\ \textcolor{keywordtype}{int}\ HIGH\_MARK>}
\DoxyCodeLine{02176\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classrml_1_1internal_1_1_local_l_o_c_impl_a40f0e9cea1a99d95d786f52e2dc8add9}{LocalLOCImpl<LOW\_MARK,\ HIGH\_MARK>::put}}(\mbox{\hyperlink{structrml_1_1internal_1_1_large_memory_block}{LargeMemoryBlock}}\ *\textcolor{keywordtype}{object},\ \mbox{\hyperlink{structrml_1_1internal_1_1_ext_memory_pool}{ExtMemoryPool}}\ *extMemPool)}
\DoxyCodeLine{02177\ \{}
\DoxyCodeLine{02178\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}}\ =\ \textcolor{keywordtype}{object}-\/>unalignedSize;}
\DoxyCodeLine{02179\ \ \ \ \ \textcolor{comment}{//\ not\ spoil\ cache\ with\ too\ large\ object,\ that\ can\ cause\ its\ total\ cleanup}}
\DoxyCodeLine{02180\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}}\ >\ \mbox{\hyperlink{classrml_1_1internal_1_1_local_l_o_c_impl_a75ab70d6b13d0081f21321cebabf92d7}{MAX\_TOTAL\_SIZE}})}
\DoxyCodeLine{02181\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{02182\ \ \ \ \ \mbox{\hyperlink{structrml_1_1internal_1_1_large_memory_block}{LargeMemoryBlock}}\ *localHead\ =\ (\mbox{\hyperlink{structrml_1_1internal_1_1_large_memory_block}{LargeMemoryBlock}}*)\mbox{\hyperlink{_synchronize_8h_a8f959802bcef862416aed96fe5c6e601}{AtomicFetchStore}}(\&\mbox{\hyperlink{classrml_1_1internal_1_1_local_l_o_c_impl_a42dc1bb7ca50c46791c015e107820d5c}{head}},\ 0);}
\DoxyCodeLine{02183\ }
\DoxyCodeLine{02184\ \ \ \ \ \textcolor{keywordtype}{object}-\/>\mbox{\hyperlink{structrml_1_1internal_1_1_large_memory_block_a3687b4a5f07044935f9cef3047e3c285}{prev}}\ =\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{02185\ \ \ \ \ \textcolor{keywordtype}{object}-\/>next\ =\ localHead;}
\DoxyCodeLine{02186\ \ \ \ \ \textcolor{keywordflow}{if}\ (localHead)}
\DoxyCodeLine{02187\ \ \ \ \ \ \ \ \ localHead-\/>\mbox{\hyperlink{structrml_1_1internal_1_1_large_memory_block_a3687b4a5f07044935f9cef3047e3c285}{prev}}\ =\ \mbox{\hyperlink{classobject}{object}};}
\DoxyCodeLine{02188\ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02189\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ those\ might\ not\ be\ cleaned\ during\ local\ cache\ stealing,\ correct\ them}}
\DoxyCodeLine{02190\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_local_l_o_c_impl_a2d83f04b433f716840a043e29e4d893b}{totalSize}}\ =\ 0;}
\DoxyCodeLine{02191\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_local_l_o_c_impl_a2a0f7261a6ffabdd3e06006c135ecf01}{numOfBlocks}}\ =\ 0;}
\DoxyCodeLine{02192\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_local_l_o_c_impl_ac6b24420fcae56ca954f907d46fa9678}{tail}}\ =\ \mbox{\hyperlink{classobject}{object}};}
\DoxyCodeLine{02193\ \ \ \ \ \}}
\DoxyCodeLine{02194\ \ \ \ \ localHead\ =\ \mbox{\hyperlink{classobject}{object}};}
\DoxyCodeLine{02195\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_local_l_o_c_impl_a2d83f04b433f716840a043e29e4d893b}{totalSize}}\ +=\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}};}
\DoxyCodeLine{02196\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_local_l_o_c_impl_a2a0f7261a6ffabdd3e06006c135ecf01}{numOfBlocks}}++;}
\DoxyCodeLine{02197\ \ \ \ \ \textcolor{comment}{//\ must\ meet\ both\ size\ and\ number\ of\ cached\ objects\ constrains}}
\DoxyCodeLine{02198\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classrml_1_1internal_1_1_local_l_o_c_impl_a2d83f04b433f716840a043e29e4d893b}{totalSize}}\ >\ \mbox{\hyperlink{classrml_1_1internal_1_1_local_l_o_c_impl_a75ab70d6b13d0081f21321cebabf92d7}{MAX\_TOTAL\_SIZE}}\ ||\ \mbox{\hyperlink{classrml_1_1internal_1_1_local_l_o_c_impl_a2a0f7261a6ffabdd3e06006c135ecf01}{numOfBlocks}}\ >=\ HIGH\_MARK)\ \{}
\DoxyCodeLine{02199\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ scanning\ from\ tail\ until\ meet\ conditions}}
\DoxyCodeLine{02200\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (\mbox{\hyperlink{classrml_1_1internal_1_1_local_l_o_c_impl_a2d83f04b433f716840a043e29e4d893b}{totalSize}}\ >\ \mbox{\hyperlink{classrml_1_1internal_1_1_local_l_o_c_impl_a75ab70d6b13d0081f21321cebabf92d7}{MAX\_TOTAL\_SIZE}}\ ||\ \mbox{\hyperlink{classrml_1_1internal_1_1_local_l_o_c_impl_a2a0f7261a6ffabdd3e06006c135ecf01}{numOfBlocks}}\ >\ LOW\_MARK)\ \{}
\DoxyCodeLine{02201\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_local_l_o_c_impl_a2d83f04b433f716840a043e29e4d893b}{totalSize}}\ -\/=\ \mbox{\hyperlink{classrml_1_1internal_1_1_local_l_o_c_impl_ac6b24420fcae56ca954f907d46fa9678}{tail}}-\/>unalignedSize;}
\DoxyCodeLine{02202\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_local_l_o_c_impl_a2a0f7261a6ffabdd3e06006c135ecf01}{numOfBlocks}}-\/-\/;}
\DoxyCodeLine{02203\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_local_l_o_c_impl_ac6b24420fcae56ca954f907d46fa9678}{tail}}\ =\ \mbox{\hyperlink{classrml_1_1internal_1_1_local_l_o_c_impl_ac6b24420fcae56ca954f907d46fa9678}{tail}}-\/>prev;}
\DoxyCodeLine{02204\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02205\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structrml_1_1internal_1_1_large_memory_block}{LargeMemoryBlock}}\ *headToRelease\ =\ \mbox{\hyperlink{classrml_1_1internal_1_1_local_l_o_c_impl_ac6b24420fcae56ca954f907d46fa9678}{tail}}-\/>next;}
\DoxyCodeLine{02206\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_local_l_o_c_impl_ac6b24420fcae56ca954f907d46fa9678}{tail}}-\/>next\ =\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{02207\ }
\DoxyCodeLine{02208\ \ \ \ \ \ \ \ \ extMemPool-\/>\mbox{\hyperlink{structrml_1_1internal_1_1_ext_memory_pool_a06321d28bde3009b25988ea85bee7748}{freeLargeObjectList}}(headToRelease);}
\DoxyCodeLine{02209\ \ \ \ \ \}}
\DoxyCodeLine{02210\ }
\DoxyCodeLine{02211\ \ \ \ \ \mbox{\hyperlink{_synchronize_8h_a19886ee3899c0a2435ea9840116ea325}{FencedStore}}((intptr\_t\&)\mbox{\hyperlink{classrml_1_1internal_1_1_local_l_o_c_impl_a42dc1bb7ca50c46791c015e107820d5c}{head}},\ (intptr\_t)localHead);}
\DoxyCodeLine{02212\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{02213\ \}}
\DoxyCodeLine{02214\ }
\DoxyCodeLine{02215\ \textcolor{keyword}{template}<\textcolor{keywordtype}{int}\ LOW\_MARK,\ \textcolor{keywordtype}{int}\ HIGH\_MARK>}
\DoxyCodeLine{02216\ \mbox{\hyperlink{structrml_1_1internal_1_1_large_memory_block}{LargeMemoryBlock}}\ *\mbox{\hyperlink{classrml_1_1internal_1_1_local_l_o_c_impl_af40a0514dcc47ac4ceccfea084adb199}{LocalLOCImpl<LOW\_MARK,\ HIGH\_MARK>::get}}(\textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}})}
\DoxyCodeLine{02217\ \{}
\DoxyCodeLine{02218\ \ \ \ \ \mbox{\hyperlink{structrml_1_1internal_1_1_large_memory_block}{LargeMemoryBlock}}\ *localHead,\ *\mbox{\hyperlink{_partial_redux__count_8cpp_acbe60897559b79afc28b79b0687b5f29}{res}}=\mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{02219\ }
\DoxyCodeLine{02220\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}}\ >\ \mbox{\hyperlink{classrml_1_1internal_1_1_local_l_o_c_impl_a75ab70d6b13d0081f21321cebabf92d7}{MAX\_TOTAL\_SIZE}})}
\DoxyCodeLine{02221\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{02222\ }
\DoxyCodeLine{02223\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classrml_1_1internal_1_1_local_l_o_c_impl_a42dc1bb7ca50c46791c015e107820d5c}{head}}\ ||\ (localHead\ =\ (\mbox{\hyperlink{structrml_1_1internal_1_1_large_memory_block}{LargeMemoryBlock}}*)\mbox{\hyperlink{_synchronize_8h_a8f959802bcef862416aed96fe5c6e601}{AtomicFetchStore}}(\&\mbox{\hyperlink{classrml_1_1internal_1_1_local_l_o_c_impl_a42dc1bb7ca50c46791c015e107820d5c}{head}},\ 0))\ ==\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}})\ \{}
\DoxyCodeLine{02224\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ do\ not\ restore\ totalSize,\ numOfBlocks\ and\ tail\ at\ this\ point,}}
\DoxyCodeLine{02225\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ as\ they\ are\ used\ only\ in\ put(),\ where\ they\ must\ be\ restored}}
\DoxyCodeLine{02226\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{02227\ \ \ \ \ \}}
\DoxyCodeLine{02228\ }
\DoxyCodeLine{02229\ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{structrml_1_1internal_1_1_large_memory_block}{LargeMemoryBlock}}\ *curr\ =\ localHead;\ curr;\ curr=curr-\/>\mbox{\hyperlink{structrml_1_1internal_1_1_large_memory_block_a556cab303968471599e3491cfcbeaeb8}{next}})\ \{}
\DoxyCodeLine{02230\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (curr-\/>unalignedSize\ ==\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}})\ \{}
\DoxyCodeLine{02231\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_partial_redux__count_8cpp_acbe60897559b79afc28b79b0687b5f29}{res}}\ =\ curr;}
\DoxyCodeLine{02232\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (curr-\/>next)}
\DoxyCodeLine{02233\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ curr-\/>next-\/>prev\ =\ curr-\/>prev;}
\DoxyCodeLine{02234\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{02235\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_local_l_o_c_impl_ac6b24420fcae56ca954f907d46fa9678}{tail}}\ =\ curr-\/>prev;}
\DoxyCodeLine{02236\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (curr\ !=\ localHead)}
\DoxyCodeLine{02237\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ curr-\/>prev-\/>next\ =\ curr-\/>next;}
\DoxyCodeLine{02238\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{02239\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ localHead\ =\ curr-\/>\mbox{\hyperlink{structrml_1_1internal_1_1_large_memory_block_a556cab303968471599e3491cfcbeaeb8}{next}};}
\DoxyCodeLine{02240\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_local_l_o_c_impl_a2d83f04b433f716840a043e29e4d893b}{totalSize}}\ -\/=\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}};}
\DoxyCodeLine{02241\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_local_l_o_c_impl_a2a0f7261a6ffabdd3e06006c135ecf01}{numOfBlocks}}-\/-\/;}
\DoxyCodeLine{02242\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02243\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02244\ \ \ \ \ \}}
\DoxyCodeLine{02245\ \ \ \ \ \mbox{\hyperlink{_synchronize_8h_a19886ee3899c0a2435ea9840116ea325}{FencedStore}}((intptr\_t\&)\mbox{\hyperlink{classrml_1_1internal_1_1_local_l_o_c_impl_a42dc1bb7ca50c46791c015e107820d5c}{head}},\ (intptr\_t)localHead);}
\DoxyCodeLine{02246\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{_partial_redux__count_8cpp_acbe60897559b79afc28b79b0687b5f29}{res}};}
\DoxyCodeLine{02247\ \}}
\DoxyCodeLine{02248\ }
\DoxyCodeLine{02249\ \textcolor{keyword}{template}<\textcolor{keywordtype}{int}\ LOW\_MARK,\ \textcolor{keywordtype}{int}\ HIGH\_MARK>}
\DoxyCodeLine{02250\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classrml_1_1internal_1_1_local_l_o_c_impl_a80e3527b3fb859a937366335f05832f5}{LocalLOCImpl<LOW\_MARK,\ HIGH\_MARK>::externalCleanup}}(\mbox{\hyperlink{structrml_1_1internal_1_1_ext_memory_pool}{ExtMemoryPool}}\ *extMemPool)}
\DoxyCodeLine{02251\ \{}
\DoxyCodeLine{02252\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{structrml_1_1internal_1_1_large_memory_block}{LargeMemoryBlock}}\ *localHead\ =\ (\mbox{\hyperlink{structrml_1_1internal_1_1_large_memory_block}{LargeMemoryBlock}}*)\mbox{\hyperlink{_synchronize_8h_a8f959802bcef862416aed96fe5c6e601}{AtomicFetchStore}}(\&\mbox{\hyperlink{classrml_1_1internal_1_1_local_l_o_c_impl_a42dc1bb7ca50c46791c015e107820d5c}{head}},\ 0))\ \{}
\DoxyCodeLine{02253\ \ \ \ \ \ \ \ \ extMemPool-\/>\mbox{\hyperlink{structrml_1_1internal_1_1_ext_memory_pool_a06321d28bde3009b25988ea85bee7748}{freeLargeObjectList}}(localHead);}
\DoxyCodeLine{02254\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{02255\ \ \ \ \ \}}
\DoxyCodeLine{02256\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{02257\ \}}
\DoxyCodeLine{02258\ }
\DoxyCodeLine{02259\ \textcolor{keywordtype}{void}\ *\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_af1f6175add16b2b950447b8b4c6bf491}{MemoryPool::getFromLLOCache}}(\mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data}{TLSData}}*\ tls,\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}},\ \textcolor{keywordtype}{size\_t}\ alignment)}
\DoxyCodeLine{02260\ \{}
\DoxyCodeLine{02261\ \ \ \ \ \mbox{\hyperlink{structrml_1_1internal_1_1_large_memory_block}{LargeMemoryBlock}}\ *lmb\ =\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{02262\ }
\DoxyCodeLine{02263\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ headersSize\ =\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structrml_1_1internal_1_1_large_memory_block}{LargeMemoryBlock}})+\textcolor{keyword}{sizeof}(\mbox{\hyperlink{structrml_1_1internal_1_1_large_object_hdr}{LargeObjectHdr}});}
\DoxyCodeLine{02264\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ allocationSize\ =\ \mbox{\hyperlink{classrml_1_1internal_1_1_large_object_cache_a60b70cf5fd394c20459885fa6f093cb2}{LargeObjectCache::alignToBin}}(\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}}+headersSize+alignment);}
\DoxyCodeLine{02265\ \ \ \ \ \textcolor{keywordflow}{if}\ (allocationSize\ <\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}})\ \textcolor{comment}{//\ allocationSize\ is\ wrapped\ around\ after\ alignToBin}}
\DoxyCodeLine{02266\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{02267\ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(allocationSize\ >=\ alignment,\ \textcolor{stringliteral}{"{}Overflow\ must\ be\ checked\ before."{}});}
\DoxyCodeLine{02268\ }
\DoxyCodeLine{02269\ \ \ \ \ \textcolor{keywordflow}{if}\ (tls)\ \{}
\DoxyCodeLine{02270\ \ \ \ \ \ \ \ \ tls-\/>\mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data_afabda6a63ddb1942d1d5a7a06f41e2ae}{markUsed}}();}
\DoxyCodeLine{02271\ \ \ \ \ \ \ \ \ lmb\ =\ tls-\/>\mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data_a9cc38b7f838e548d0fbac8d3a194b2cf}{lloc}}.\mbox{\hyperlink{classrml_1_1internal_1_1_local_l_o_c_impl_af40a0514dcc47ac4ceccfea084adb199}{get}}(allocationSize);}
\DoxyCodeLine{02272\ \ \ \ \ \}}
\DoxyCodeLine{02273\ \ \ \ \ \textcolor{keywordflow}{if}\ (!lmb)}
\DoxyCodeLine{02274\ \ \ \ \ \ \ \ \ lmb\ =\ \mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_a93f7cd65f7ae8f1608a846cded95cd7c}{extMemPool}}.mallocLargeObject(\textcolor{keyword}{this},\ allocationSize);}
\DoxyCodeLine{02275\ }
\DoxyCodeLine{02276\ \ \ \ \ \textcolor{keywordflow}{if}\ (lmb)\ \{}
\DoxyCodeLine{02277\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ doing\ shuffle\ we\ suppose\ that\ alignment\ offset\ guarantees}}
\DoxyCodeLine{02278\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ that\ different\ cache\ lines\ are\ in\ use}}
\DoxyCodeLine{02279\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(alignment\ >=\ \mbox{\hyperlink{namespacerml_1_1internal_a559caa4a53713c2a95d8b28708ff1d77}{estimatedCacheLineSize}},\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}});}
\DoxyCodeLine{02280\ }
\DoxyCodeLine{02281\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ *alignedArea\ =\ (\textcolor{keywordtype}{void}*)\mbox{\hyperlink{shared__utils_8h_abf7a0e928f58ffeeefa291f674c30d69}{alignUp}}((uintptr\_t)lmb+headersSize,\ alignment);}
\DoxyCodeLine{02282\ \ \ \ \ \ \ \ \ uintptr\_t\ alignedRight\ =}
\DoxyCodeLine{02283\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{shared__utils_8h_ab3918cd2395835f90b78b96d4e1e2390}{alignDown}}((uintptr\_t)lmb+lmb-\/>\mbox{\hyperlink{structrml_1_1internal_1_1_large_memory_block_aaad527f7110e4c9e9a9cfa09411bd0b7}{unalignedSize}}\ -\/\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}},\ alignment);}
\DoxyCodeLine{02284\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Has\ some\ room\ to\ shuffle\ object\ between\ cache\ lines?}}
\DoxyCodeLine{02285\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Note\ that\ alignedRight\ and\ alignedArea\ are\ aligned\ at\ alignment.}}
\DoxyCodeLine{02286\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ ptrDelta\ =\ alignedRight\ -\/\ (uintptr\_t)alignedArea;}
\DoxyCodeLine{02287\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (ptrDelta\ \&\&\ tls)\ \{\ \textcolor{comment}{//\ !tls\ is\ cold\ path}}
\DoxyCodeLine{02288\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ for\ the\ hot\ path\ of\ alignment==estimatedCacheLineSize,}}
\DoxyCodeLine{02289\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ allow\ compilers\ to\ use\ shift\ for\ division}}
\DoxyCodeLine{02290\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ (since\ estimatedCacheLineSize\ is\ a\ power-\/of-\/2\ constant)}}
\DoxyCodeLine{02291\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ numOfPossibleOffsets\ =\ alignment\ ==\ \mbox{\hyperlink{namespacerml_1_1internal_a559caa4a53713c2a95d8b28708ff1d77}{estimatedCacheLineSize}}?}
\DoxyCodeLine{02292\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ptrDelta\ /\ \mbox{\hyperlink{namespacerml_1_1internal_a559caa4a53713c2a95d8b28708ff1d77}{estimatedCacheLineSize}}\ :}
\DoxyCodeLine{02293\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ptrDelta\ /\ alignment;}
\DoxyCodeLine{02294\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ myCacheIdx\ =\ ++tls-\/>\mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data_a0afea8877687495caf569889c796d535}{currCacheIdx}};}
\DoxyCodeLine{02295\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ae1b92ae085ddef4b1cdca7d749339fb0}{offset}}\ =\ myCacheIdx\ \%\ numOfPossibleOffsets;}
\DoxyCodeLine{02296\ }
\DoxyCodeLine{02297\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Move\ object\ to\ a\ cache\ line\ with\ an\ offset\ that\ is\ different\ from}}
\DoxyCodeLine{02298\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ previous\ allocation.\ This\ supposedly\ allows\ us\ to\ use\ cache}}
\DoxyCodeLine{02299\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ associativity\ more\ efficiently.}}
\DoxyCodeLine{02300\ \ \ \ \ \ \ \ \ \ \ \ \ alignedArea\ =\ (\textcolor{keywordtype}{void}*)((uintptr\_t)alignedArea\ +\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ae1b92ae085ddef4b1cdca7d749339fb0}{offset}}*alignment);}
\DoxyCodeLine{02301\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02302\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}((uintptr\_t)lmb+lmb-\/>\mbox{\hyperlink{structrml_1_1internal_1_1_large_memory_block_aaad527f7110e4c9e9a9cfa09411bd0b7}{unalignedSize}}\ >=}
\DoxyCodeLine{02303\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (uintptr\_t)alignedArea+\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}},\ \textcolor{stringliteral}{"{}Object\ doesn't\ fit\ the\ block."{}});}
\DoxyCodeLine{02304\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structrml_1_1internal_1_1_large_object_hdr}{LargeObjectHdr}}\ *\mbox{\hyperlink{cblat1_8f_a410931b600854e6dd3e253731606117e}{header}}\ =\ (\mbox{\hyperlink{structrml_1_1internal_1_1_large_object_hdr}{LargeObjectHdr}}*)alignedArea-\/1;}
\DoxyCodeLine{02305\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{cblat1_8f_a410931b600854e6dd3e253731606117e}{header}}-\/>memoryBlock\ =\ lmb;}
\DoxyCodeLine{02306\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{cblat1_8f_a410931b600854e6dd3e253731606117e}{header}}-\/>backRefIdx\ =\ lmb-\/>\mbox{\hyperlink{structrml_1_1internal_1_1_large_memory_block_ad97a9f039a803f7f20887a0217b014de}{backRefIdx}};}
\DoxyCodeLine{02307\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacerml_1_1internal_aa5ddbf0f60817126c51b54ca648caf34}{setBackRef}}(\mbox{\hyperlink{cblat1_8f_a410931b600854e6dd3e253731606117e}{header}}-\/>backRefIdx,\ \mbox{\hyperlink{cblat1_8f_a410931b600854e6dd3e253731606117e}{header}});}
\DoxyCodeLine{02308\ }
\DoxyCodeLine{02309\ \ \ \ \ \ \ \ \ lmb-\/>\mbox{\hyperlink{structrml_1_1internal_1_1_large_memory_block_a36dc3cf5c0acd49721481eda74838e3b}{objectSize}}\ =\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}};}
\DoxyCodeLine{02310\ }
\DoxyCodeLine{02311\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ \mbox{\hyperlink{namespacerml_1_1internal_a730f387568a0a522e003dca4246eb393}{isLargeObject<unknownMem>}}(alignedArea),\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );}
\DoxyCodeLine{02312\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ \mbox{\hyperlink{_customize_8h_a717f2c2c0501922cd654a5ebf49b287e}{isAligned}}(alignedArea,\ alignment),\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );}
\DoxyCodeLine{02313\ }
\DoxyCodeLine{02314\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ alignedArea;}
\DoxyCodeLine{02315\ \ \ \ \ \}}
\DoxyCodeLine{02316\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{02317\ \}}
\DoxyCodeLine{02318\ }
\DoxyCodeLine{02319\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_aedf33ac6b570a3847f86ad528de00149}{MemoryPool::putToLLOCache}}(\mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data}{TLSData}}\ *tls,\ \textcolor{keywordtype}{void}\ *\textcolor{keywordtype}{object})}
\DoxyCodeLine{02320\ \{}
\DoxyCodeLine{02321\ \ \ \ \ \mbox{\hyperlink{structrml_1_1internal_1_1_large_object_hdr}{LargeObjectHdr}}\ *\mbox{\hyperlink{cblat1_8f_a410931b600854e6dd3e253731606117e}{header}}\ =\ (\mbox{\hyperlink{structrml_1_1internal_1_1_large_object_hdr}{LargeObjectHdr}}*)\textcolor{keywordtype}{object}\ -\/\ 1;}
\DoxyCodeLine{02322\ \ \ \ \ \textcolor{comment}{//\ overwrite\ backRefIdx\ to\ simplify\ double\ free\ detection}}
\DoxyCodeLine{02323\ \ \ \ \ \mbox{\hyperlink{cblat1_8f_a410931b600854e6dd3e253731606117e}{header}}-\/>backRefIdx\ =\ \mbox{\hyperlink{classrml_1_1internal_1_1_back_ref_idx}{BackRefIdx}}();}
\DoxyCodeLine{02324\ }
\DoxyCodeLine{02325\ \ \ \ \ \textcolor{keywordflow}{if}\ (tls)\ \{}
\DoxyCodeLine{02326\ \ \ \ \ \ \ \ \ tls-\/>\mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data_afabda6a63ddb1942d1d5a7a06f41e2ae}{markUsed}}();}
\DoxyCodeLine{02327\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (tls-\/>\mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data_a9cc38b7f838e548d0fbac8d3a194b2cf}{lloc}}.\mbox{\hyperlink{classrml_1_1internal_1_1_local_l_o_c_impl_a40f0e9cea1a99d95d786f52e2dc8add9}{put}}(\mbox{\hyperlink{cblat1_8f_a410931b600854e6dd3e253731606117e}{header}}-\/>memoryBlock,\ \&\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_a93f7cd65f7ae8f1608a846cded95cd7c}{extMemPool}}))}
\DoxyCodeLine{02328\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{02329\ \ \ \ \ \}}
\DoxyCodeLine{02330\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_a93f7cd65f7ae8f1608a846cded95cd7c}{extMemPool}}.freeLargeObject(\mbox{\hyperlink{cblat1_8f_a410931b600854e6dd3e253731606117e}{header}}-\/>memoryBlock);}
\DoxyCodeLine{02331\ \}}
\DoxyCodeLine{02332\ }
\DoxyCodeLine{02333\ \textcolor{comment}{/*}}
\DoxyCodeLine{02334\ \textcolor{comment}{\ *\ All\ aligned\ allocations\ fall\ into\ one\ of\ the\ following\ categories:}}
\DoxyCodeLine{02335\ \textcolor{comment}{\ *\ \ 1.\ if\ both\ request\ size\ and\ alignment\ are\ <=\ maxSegregatedObjectSize,}}
\DoxyCodeLine{02336\ \textcolor{comment}{\ *\ \ \ \ \ \ \ we\ just\ align\ the\ size\ up,\ and\ request\ this\ amount,\ because\ for\ every\ size}}
\DoxyCodeLine{02337\ \textcolor{comment}{\ *\ \ \ \ \ \ \ aligned\ to\ some\ power\ of\ 2,\ the\ allocated\ object\ is\ at\ least\ that\ aligned.}}
\DoxyCodeLine{02338\ \textcolor{comment}{\ *\ 2.\ for\ size<minLargeObjectSize,\ check\ if\ already\ guaranteed\ fittingAlignment\ is\ enough.}}
\DoxyCodeLine{02339\ \textcolor{comment}{\ *\ 3.\ if\ size+alignment<minLargeObjectSize,\ we\ take\ an\ object\ of\ fittingSizeN\ and\ align}}
\DoxyCodeLine{02340\ \textcolor{comment}{\ *\ \ \ \ \ \ \ its\ address\ up;\ given\ such\ pointer,\ scalable\_free\ could\ find\ the\ real\ object.}}
\DoxyCodeLine{02341\ \textcolor{comment}{\ *\ \ \ \ \ \ \ Wrapping\ of\ size+alignment\ is\ impossible\ because\ maximal\ allowed}}
\DoxyCodeLine{02342\ \textcolor{comment}{\ *\ \ \ \ \ \ \ alignment\ plus\ minLargeObjectSize\ can't\ lead\ to\ wrapping.}}
\DoxyCodeLine{02343\ \textcolor{comment}{\ *\ 4.\ otherwise,\ aligned\ large\ object\ is\ allocated.}}
\DoxyCodeLine{02344\ \textcolor{comment}{\ */}}
\DoxyCodeLine{02345\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ *\mbox{\hyperlink{namespacerml_1_1internal_a8de88aa18618ca387871e41654bef552}{allocateAligned}}(\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool}{MemoryPool}}\ *memPool,\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}},\ \textcolor{keywordtype}{size\_t}\ alignment)}
\DoxyCodeLine{02346\ \{}
\DoxyCodeLine{02347\ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ \mbox{\hyperlink{_customize_8h_acd7827300d6ae7b109ba374f9fd9e7dd}{isPowerOfTwo}}(alignment),\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );}
\DoxyCodeLine{02348\ }
\DoxyCodeLine{02349\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{namespacerml_1_1internal_a61c4d632ea815cbeea8ed0ee72e06ac7}{isMallocInitialized}}())}
\DoxyCodeLine{02350\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{namespacerml_1_1internal_aad59cc02d849210b00c8587544e44e20}{doInitialization}}())}
\DoxyCodeLine{02351\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{02352\ }
\DoxyCodeLine{02353\ \ \ \ \ \textcolor{keywordtype}{void}\ *\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}};}
\DoxyCodeLine{02354\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}}<=\mbox{\hyperlink{namespacerml_1_1internal_ac18775d0814a506927c2bb6b978a1d73}{maxSegregatedObjectSize}}\ \&\&\ alignment<=\mbox{\hyperlink{namespacerml_1_1internal_ac18775d0814a506927c2bb6b978a1d73}{maxSegregatedObjectSize}})}
\DoxyCodeLine{02355\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}}\ =\ \mbox{\hyperlink{namespacerml_1_1internal_a341c0310d4c1374c96acc18cd37eba26}{internalPoolMalloc}}(memPool,\ \mbox{\hyperlink{shared__utils_8h_abf7a0e928f58ffeeefa291f674c30d69}{alignUp}}(\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}}?\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}}:\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{size\_t}),\ alignment));}
\DoxyCodeLine{02356\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}}<\mbox{\hyperlink{namespacerml_1_1internal_ad778f7cb21fd95b85e36f2cf18d8fc60}{minLargeObjectSize}})\ \{}
\DoxyCodeLine{02357\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (alignment<=\mbox{\hyperlink{namespacerml_1_1internal_ab092ca824bbb860a4cb0153229864bb7}{fittingAlignment}})}
\DoxyCodeLine{02358\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}}\ =\ \mbox{\hyperlink{namespacerml_1_1internal_a341c0310d4c1374c96acc18cd37eba26}{internalPoolMalloc}}(memPool,\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}});}
\DoxyCodeLine{02359\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}}+alignment\ <\ \mbox{\hyperlink{namespacerml_1_1internal_ad778f7cb21fd95b85e36f2cf18d8fc60}{minLargeObjectSize}})\ \{}
\DoxyCodeLine{02360\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ *unaligned\ =\ \mbox{\hyperlink{namespacerml_1_1internal_a341c0310d4c1374c96acc18cd37eba26}{internalPoolMalloc}}(memPool,\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}}+alignment);}
\DoxyCodeLine{02361\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!unaligned)\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{02362\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}}\ =\ \mbox{\hyperlink{shared__utils_8h_abf7a0e928f58ffeeefa291f674c30d69}{alignUp}}(unaligned,\ alignment);}
\DoxyCodeLine{02363\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}}
\DoxyCodeLine{02364\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{goto}\ LargeObjAlloc;}
\DoxyCodeLine{02365\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02366\ \ \ \ \ LargeObjAlloc:}
\DoxyCodeLine{02367\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data}{TLSData}}\ *tls\ =\ memPool-\/>\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_acdf684e1b29c9d00886d97b909798488}{getTLS}}(\textcolor{comment}{/*create=*/}\textcolor{keyword}{true});}
\DoxyCodeLine{02368\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ take\ into\ account\ only\ alignment\ that\ are\ higher\ then\ natural}}
\DoxyCodeLine{02369\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}}\ =}
\DoxyCodeLine{02370\ \ \ \ \ \ \ \ \ \ \ \ \ memPool-\/>\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_af1f6175add16b2b950447b8b4c6bf491}{getFromLLOCache}}(tls,\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}},\ \mbox{\hyperlink{namespacerml_1_1internal_aa95f01338b826313f5e137f38e282e01}{largeObjectAlignment}}>alignment?}
\DoxyCodeLine{02371\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacerml_1_1internal_aa95f01338b826313f5e137f38e282e01}{largeObjectAlignment}}:\ alignment);}
\DoxyCodeLine{02372\ \ \ \ \ \}}
\DoxyCodeLine{02373\ }
\DoxyCodeLine{02374\ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ \mbox{\hyperlink{_customize_8h_a717f2c2c0501922cd654a5ebf49b287e}{isAligned}}(\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}},\ alignment),\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );}
\DoxyCodeLine{02375\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}};}
\DoxyCodeLine{02376\ \}}
\DoxyCodeLine{02377\ }
\DoxyCodeLine{02378\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ *\mbox{\hyperlink{namespacerml_1_1internal_a288f89b97757684760f283c91dbe8add}{reallocAligned}}(\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool}{MemoryPool}}\ *memPool,\ \textcolor{keywordtype}{void}\ *\mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}},}
\DoxyCodeLine{02379\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ newSize,\ \textcolor{keywordtype}{size\_t}\ alignment\ =\ 0)}
\DoxyCodeLine{02380\ \{}
\DoxyCodeLine{02381\ \ \ \ \ \textcolor{keywordtype}{void}\ *\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}};}
\DoxyCodeLine{02382\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ copySize;}
\DoxyCodeLine{02383\ }
\DoxyCodeLine{02384\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacerml_1_1internal_a730f387568a0a522e003dca4246eb393}{isLargeObject<ourMem>}}(\mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}}))\ \{}
\DoxyCodeLine{02385\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structrml_1_1internal_1_1_large_memory_block}{LargeMemoryBlock}}*\ lmb\ =\ ((\mbox{\hyperlink{structrml_1_1internal_1_1_large_object_hdr}{LargeObjectHdr}}\ *)\mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}}\ -\/\ 1)-\/>memoryBlock;}
\DoxyCodeLine{02386\ \ \ \ \ \ \ \ \ copySize\ =\ lmb-\/>\mbox{\hyperlink{structrml_1_1internal_1_1_large_memory_block_aaad527f7110e4c9e9a9cfa09411bd0b7}{unalignedSize}}-\/((uintptr\_t)\mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}}-\/(uintptr\_t)lmb);}
\DoxyCodeLine{02387\ }
\DoxyCodeLine{02388\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Apply\ different\ strategies\ if\ size\ decreases}}
\DoxyCodeLine{02389\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (newSize\ <=\ copySize\ \&\&\ (0\ ==\ alignment\ ||\ \mbox{\hyperlink{_customize_8h_a717f2c2c0501922cd654a5ebf49b287e}{isAligned}}(\mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}},\ alignment)))\ \{}
\DoxyCodeLine{02390\ }
\DoxyCodeLine{02391\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ For\ huge\ objects\ (that\ do\ not\ fit\ in\ backend\ cache),\ keep\ the\ same\ space\ unless}}
\DoxyCodeLine{02392\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ the\ new\ size\ is\ at\ least\ twice\ smaller}}
\DoxyCodeLine{02393\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ isMemoryBlockHuge\ =\ copySize\ >\ memPool-\/>\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_a93f7cd65f7ae8f1608a846cded95cd7c}{extMemPool}}.\mbox{\hyperlink{structrml_1_1internal_1_1_ext_memory_pool_a86fdbadea90130b4aa51a5e1f2bb8fb3}{backend}}.\mbox{\hyperlink{classrml_1_1internal_1_1_backend_af7f29ce80d57a9417ba3abaa156a5959}{getMaxBinnedSize}}();}
\DoxyCodeLine{02394\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ threshold\ =\ isMemoryBlockHuge\ ?\ copySize\ /\ 2\ :\ 0;}
\DoxyCodeLine{02395\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (newSize\ >\ threshold)\ \{}
\DoxyCodeLine{02396\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lmb-\/>\mbox{\hyperlink{structrml_1_1internal_1_1_large_memory_block_a36dc3cf5c0acd49721481eda74838e3b}{objectSize}}\ =\ newSize;}
\DoxyCodeLine{02397\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}};}
\DoxyCodeLine{02398\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02399\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ TODO:\ For\ large\ objects\ suitable\ for\ the\ backend\ cache,}}
\DoxyCodeLine{02400\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ split\ out\ the\ excessive\ part\ and\ put\ it\ to\ the\ backend.}}
\DoxyCodeLine{02401\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02402\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Reallocate\ for\ real}}
\DoxyCodeLine{02403\ \ \ \ \ \ \ \ \ copySize\ =\ lmb-\/>\mbox{\hyperlink{structrml_1_1internal_1_1_large_memory_block_a36dc3cf5c0acd49721481eda74838e3b}{objectSize}};}
\DoxyCodeLine{02404\ \textcolor{preprocessor}{\#if\ BACKEND\_HAS\_MREMAP}}
\DoxyCodeLine{02405\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\textcolor{keywordtype}{void}\ *\mbox{\hyperlink{offscreen_8c_a4788d82c901b9367dd5c0daff8a7616b}{r}}\ =\ memPool-\/>\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_a93f7cd65f7ae8f1608a846cded95cd7c}{extMemPool}}.\mbox{\hyperlink{structrml_1_1internal_1_1_ext_memory_pool_affe492c8041681b5fef472d5cd2f694e}{remap}}(\mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}},\ copySize,\ newSize,}
\DoxyCodeLine{02406\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alignment\ <\ \mbox{\hyperlink{namespacerml_1_1internal_aa95f01338b826313f5e137f38e282e01}{largeObjectAlignment}}\ ?\ \mbox{\hyperlink{namespacerml_1_1internal_aa95f01338b826313f5e137f38e282e01}{largeObjectAlignment}}\ :\ alignment))}
\DoxyCodeLine{02407\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{offscreen_8c_a4788d82c901b9367dd5c0daff8a7616b}{r}};}
\DoxyCodeLine{02408\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02409\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}}\ =\ alignment\ ?\ \mbox{\hyperlink{namespacerml_1_1internal_a8de88aa18618ca387871e41654bef552}{allocateAligned}}(memPool,\ newSize,\ alignment)\ :}
\DoxyCodeLine{02410\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacerml_1_1internal_a341c0310d4c1374c96acc18cd37eba26}{internalPoolMalloc}}(memPool,\ newSize);}
\DoxyCodeLine{02411\ }
\DoxyCodeLine{02412\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02413\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}*\ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}\ =\ (\mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}\ *)\mbox{\hyperlink{shared__utils_8h_ab3918cd2395835f90b78b96d4e1e2390}{alignDown}}(\mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}},\ \mbox{\hyperlink{namespacerml_1_1internal_ab92a44f5c0d4ae24554856afbba1943d}{slabSize}});}
\DoxyCodeLine{02414\ \ \ \ \ \ \ \ \ copySize\ =\ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}-\/>findObjectSize(\mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}});}
\DoxyCodeLine{02415\ }
\DoxyCodeLine{02416\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ TODO:\ Move\ object\ to\ another\ bin\ if\ size\ decreases\ and\ the\ current\ bin\ is\ "{}empty\ enough"{}.}}
\DoxyCodeLine{02417\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Currently,\ in\ case\ of\ size\ decreasing,\ old\ pointer\ is\ returned}}
\DoxyCodeLine{02418\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (newSize\ <=\ copySize\ \&\&\ (0==alignment\ ||\ \mbox{\hyperlink{_customize_8h_a717f2c2c0501922cd654a5ebf49b287e}{isAligned}}(\mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}},\ alignment)))\ \{}
\DoxyCodeLine{02419\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}};}
\DoxyCodeLine{02420\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02421\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}}\ =\ alignment\ ?\ \mbox{\hyperlink{namespacerml_1_1internal_a8de88aa18618ca387871e41654bef552}{allocateAligned}}(memPool,\ newSize,\ alignment)\ :}
\DoxyCodeLine{02422\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacerml_1_1internal_a341c0310d4c1374c96acc18cd37eba26}{internalPoolMalloc}}(memPool,\ newSize);}
\DoxyCodeLine{02423\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02424\ \ \ \ \ \}}
\DoxyCodeLine{02425\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}})\ \{}
\DoxyCodeLine{02426\ \ \ \ \ \ \ \ \ memcpy(\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}},\ \mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}},\ copySize\ <\ newSize\ ?\ copySize\ :\ newSize);}
\DoxyCodeLine{02427\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacerml_1_1internal_a8bff2023b8463f38317c75980f21e0db}{internalPoolFree}}(memPool,\ \mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}},\ 0);}
\DoxyCodeLine{02428\ \ \ \ \ \}}
\DoxyCodeLine{02429\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}};}
\DoxyCodeLine{02430\ \}}
\DoxyCodeLine{02431\ }
\DoxyCodeLine{02432\ \textcolor{comment}{/*\ A\ predicate\ checks\ if\ an\ object\ is\ properly\ placed\ inside\ its\ block\ */}}
\DoxyCodeLine{02433\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classrml_1_1internal_1_1_block_a0784348220b090a74a437cc7a61d0c88}{Block::isProperlyPlaced}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *\textcolor{keywordtype}{object})\textcolor{keyword}{\ const}}
\DoxyCodeLine{02434\ \textcolor{keyword}{}\{}
\DoxyCodeLine{02435\ \ \ \ \ \textcolor{keywordflow}{return}\ 0\ ==\ ((uintptr\_t)\textcolor{keyword}{this}\ +\ \mbox{\hyperlink{namespacerml_1_1internal_ab92a44f5c0d4ae24554856afbba1943d}{slabSize}}\ -\/\ (uintptr\_t)\mbox{\hyperlink{classobject}{object}})\ \%\ \mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a0e116178c7df6b87077b7b029a0fe653}{objectSize}};}
\DoxyCodeLine{02436\ \}}
\DoxyCodeLine{02437\ }
\DoxyCodeLine{02438\ \textcolor{comment}{/*\ Finds\ the\ real\ object\ inside\ the\ block\ */}}
\DoxyCodeLine{02439\ \mbox{\hyperlink{structrml_1_1internal_1_1_free_object}{FreeObject}}\ *\mbox{\hyperlink{classrml_1_1internal_1_1_block_a40ba10a264d6930e09da78ecfc9034a7}{Block::findAllocatedObject}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *\mbox{\hyperlink{ittnotify__static_8h_aee2b510694d56cbe27f47b65477e7049}{address}})\textcolor{keyword}{\ const}}
\DoxyCodeLine{02440\ \textcolor{keyword}{}\{}
\DoxyCodeLine{02441\ \ \ \ \ \textcolor{comment}{//\ calculate\ offset\ from\ the\ end\ of\ the\ block\ space}}
\DoxyCodeLine{02442\ \ \ \ \ \mbox{\hyperlink{eabase_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t}}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ae1b92ae085ddef4b1cdca7d749339fb0}{offset}}\ =\ (uintptr\_t)\textcolor{keyword}{this}\ +\ \mbox{\hyperlink{namespacerml_1_1internal_ab92a44f5c0d4ae24554856afbba1943d}{slabSize}}\ -\/\ (uintptr\_t)\mbox{\hyperlink{ittnotify__static_8h_aee2b510694d56cbe27f47b65477e7049}{address}};}
\DoxyCodeLine{02443\ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ae1b92ae085ddef4b1cdca7d749339fb0}{offset}}<=\mbox{\hyperlink{namespacerml_1_1internal_ab92a44f5c0d4ae24554856afbba1943d}{slabSize}}-\/\textcolor{keyword}{sizeof}(\mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}),\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );}
\DoxyCodeLine{02444\ \ \ \ \ \textcolor{comment}{//\ find\ offset\ difference\ from\ a\ multiple\ of\ allocation\ size}}
\DoxyCodeLine{02445\ \ \ \ \ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ae1b92ae085ddef4b1cdca7d749339fb0}{offset}}\ \%=\ \mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a0e116178c7df6b87077b7b029a0fe653}{objectSize}};}
\DoxyCodeLine{02446\ \ \ \ \ \textcolor{comment}{//\ and\ move\ the\ address\ down\ to\ where\ the\ real\ object\ starts.}}
\DoxyCodeLine{02447\ \ \ \ \ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{structrml_1_1internal_1_1_free_object}{FreeObject}}*)((uintptr\_t)\mbox{\hyperlink{ittnotify__static_8h_aee2b510694d56cbe27f47b65477e7049}{address}}\ -\/\ (\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ae1b92ae085ddef4b1cdca7d749339fb0}{offset}}?\ \mbox{\hyperlink{classrml_1_1internal_1_1_local_block_fields_a0e116178c7df6b87077b7b029a0fe653}{objectSize}}-\/\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ae1b92ae085ddef4b1cdca7d749339fb0}{offset}}:\ 0));}
\DoxyCodeLine{02448\ \}}
\DoxyCodeLine{02449\ }
\DoxyCodeLine{02450\ \textcolor{comment}{/*}}
\DoxyCodeLine{02451\ \textcolor{comment}{\ *\ Bad\ dereference\ caused\ by\ a\ foreign\ pointer\ is\ possible\ only\ here,\ not\ earlier\ in\ call\ chain.}}
\DoxyCodeLine{02452\ \textcolor{comment}{\ *\ Separate\ function\ isolates\ SEH\ code,\ as\ it\ has\ bad\ influence\ on\ compiler\ optimization.}}
\DoxyCodeLine{02453\ \textcolor{comment}{\ */}}
\DoxyCodeLine{02454\ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \mbox{\hyperlink{classrml_1_1internal_1_1_back_ref_idx}{BackRefIdx}}\ \mbox{\hyperlink{namespacerml_1_1internal_ad1ffc431b9c2d1e7109a72599d761792}{safer\_dereference}}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{classrml_1_1internal_1_1_back_ref_idx}{BackRefIdx}}\ *\mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}})}
\DoxyCodeLine{02455\ \{}
\DoxyCodeLine{02456\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_back_ref_idx}{BackRefIdx}}\ \mbox{\hyperlink{cocoa__platform_8h_acf00cd75f37488e1d4ac463303ccfec4}{id}};}
\DoxyCodeLine{02457\ \textcolor{preprocessor}{\#if\ \_MSC\_VER}}
\DoxyCodeLine{02458\ \ \ \ \ \_\_try\ \{}
\DoxyCodeLine{02459\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02460\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{id}\ =\ *\mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}};}
\DoxyCodeLine{02461\ \textcolor{preprocessor}{\#if\ \_MSC\_VER}}
\DoxyCodeLine{02462\ \ \ \ \ \}\ \_\_except(\ GetExceptionCode()\ ==\ EXCEPTION\_ACCESS\_VIOLATION?}
\DoxyCodeLine{02463\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ EXCEPTION\_EXECUTE\_HANDLER\ :\ EXCEPTION\_CONTINUE\_SEARCH\ )\ \{}
\DoxyCodeLine{02464\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{id}\ =\ \mbox{\hyperlink{classrml_1_1internal_1_1_back_ref_idx}{BackRefIdx}}();}
\DoxyCodeLine{02465\ \ \ \ \ \}}
\DoxyCodeLine{02466\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02467\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{cocoa__platform_8h_acf00cd75f37488e1d4ac463303ccfec4}{id}};}
\DoxyCodeLine{02468\ \}}
\DoxyCodeLine{02469\ }
\DoxyCodeLine{02470\ \textcolor{keyword}{template}<MemoryOrigin\ memOrigin>}
\DoxyCodeLine{02471\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{namespacerml_1_1internal_a730f387568a0a522e003dca4246eb393}{isLargeObject}}(\textcolor{keywordtype}{void}\ *\textcolor{keywordtype}{object})}
\DoxyCodeLine{02472\ \{}
\DoxyCodeLine{02473\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{_customize_8h_a717f2c2c0501922cd654a5ebf49b287e}{isAligned}}(\textcolor{keywordtype}{object},\ \mbox{\hyperlink{namespacerml_1_1internal_aa95f01338b826313f5e137f38e282e01}{largeObjectAlignment}}))}
\DoxyCodeLine{02474\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{02475\ \ \ \ \ \mbox{\hyperlink{structrml_1_1internal_1_1_large_object_hdr}{LargeObjectHdr}}\ *\mbox{\hyperlink{cblat1_8f_a410931b600854e6dd3e253731606117e}{header}}\ =\ (\mbox{\hyperlink{structrml_1_1internal_1_1_large_object_hdr}{LargeObjectHdr}}*)\textcolor{keywordtype}{object}\ -\/\ 1;}
\DoxyCodeLine{02476\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_back_ref_idx}{BackRefIdx}}\ idx\ =\ (memOrigin\ ==\ \mbox{\hyperlink{namespacerml_1_1internal_a2296ed46b728e5cbf437925e3c2b7741a871a4fdedb61da75e66f4db4196890d2}{unknownMem}})\ ?}
\DoxyCodeLine{02477\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacerml_1_1internal_ad1ffc431b9c2d1e7109a72599d761792}{safer\_dereference}}(\&\mbox{\hyperlink{cblat1_8f_a410931b600854e6dd3e253731606117e}{header}}-\/>backRefIdx)\ :\ \mbox{\hyperlink{cblat1_8f_a410931b600854e6dd3e253731606117e}{header}}-\/>backRefIdx;}
\DoxyCodeLine{02478\ }
\DoxyCodeLine{02479\ \ \ \ \ \textcolor{keywordflow}{return}\ idx.isLargeObject()}
\DoxyCodeLine{02480\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ in\ valid\ LargeObjectHdr\ memoryBlock\ is\ not\ NULL}}
\DoxyCodeLine{02481\ \ \ \ \ \ \ \ \ \&\&\ \mbox{\hyperlink{cblat1_8f_a410931b600854e6dd3e253731606117e}{header}}-\/>memoryBlock}
\DoxyCodeLine{02482\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ in\ valid\ LargeObjectHdr\ memoryBlock\ points\ somewhere\ before\ header}}
\DoxyCodeLine{02483\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ TODO:\ more\ strict\ check}}
\DoxyCodeLine{02484\ \ \ \ \ \ \ \ \ \&\&\ (uintptr\_t)\mbox{\hyperlink{cblat1_8f_a410931b600854e6dd3e253731606117e}{header}}-\/>memoryBlock\ <\ (uintptr\_t)\mbox{\hyperlink{cblat1_8f_a410931b600854e6dd3e253731606117e}{header}}}
\DoxyCodeLine{02485\ \ \ \ \ \ \ \ \ \&\&\ \mbox{\hyperlink{namespacerml_1_1internal_a674d3a46d675ee1887142a9118f48927}{getBackRef}}(idx)\ ==\ \mbox{\hyperlink{cblat1_8f_a410931b600854e6dd3e253731606117e}{header}};}
\DoxyCodeLine{02486\ \}}
\DoxyCodeLine{02487\ }
\DoxyCodeLine{02488\ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{namespacerml_1_1internal_a44371ad68e0e7931776e8e128764ae79}{isSmallObject}}\ (\textcolor{keywordtype}{void}\ *\mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}})}
\DoxyCodeLine{02489\ \{}
\DoxyCodeLine{02490\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}*\ expectedBlock\ =\ (\mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}*)\mbox{\hyperlink{shared__utils_8h_ab3918cd2395835f90b78b96d4e1e2390}{alignDown}}(\mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}},\ \mbox{\hyperlink{namespacerml_1_1internal_ab92a44f5c0d4ae24554856afbba1943d}{slabSize}});}
\DoxyCodeLine{02491\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classrml_1_1internal_1_1_back_ref_idx}{BackRefIdx}}*\ idx\ =\ expectedBlock-\/>\mbox{\hyperlink{classrml_1_1internal_1_1_block_a3e5bded9feaecc0d3c5cacb5e859aa63}{getBackRefIdx}}();}
\DoxyCodeLine{02492\ }
\DoxyCodeLine{02493\ \ \ \ \ \textcolor{keywordtype}{bool}\ isSmall\ =\ expectedBlock\ ==\ \mbox{\hyperlink{namespacerml_1_1internal_a674d3a46d675ee1887142a9118f48927}{getBackRef}}(\mbox{\hyperlink{namespacerml_1_1internal_ad1ffc431b9c2d1e7109a72599d761792}{safer\_dereference}}(idx));}
\DoxyCodeLine{02494\ \ \ \ \ \textcolor{keywordflow}{if}\ (isSmall)}
\DoxyCodeLine{02495\ \ \ \ \ \ \ \ \ expectedBlock-\/>\mbox{\hyperlink{classrml_1_1internal_1_1_block_adb4bc8e99527a3f6f6c0252fd7d550f8}{checkFreePrecond}}(\mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}});}
\DoxyCodeLine{02496\ \ \ \ \ \textcolor{keywordflow}{return}\ isSmall;}
\DoxyCodeLine{02497\ \}}
\DoxyCodeLine{02498\ }
\DoxyCodeLine{02499\ \textcolor{comment}{/****\ Check\ if\ an\ object\ was\ allocated\ by\ scalable\_malloc\ ****/}}
\DoxyCodeLine{02500\ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{namespacerml_1_1internal_abe52e5f71a9571929c11e06738d0864f}{isRecognized}}\ (\textcolor{keywordtype}{void}*\ \mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}})}
\DoxyCodeLine{02501\ \{}
\DoxyCodeLine{02502\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacerml_1_1internal_a775ef3ae8dd6b242d20f44ebd787a1be}{defaultMemPool}}-\/>extMemPool.backend.ptrCanBeValid(\mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}})\ \&\&}
\DoxyCodeLine{02503\ \ \ \ \ \ \ \ \ (\mbox{\hyperlink{namespacerml_1_1internal_a730f387568a0a522e003dca4246eb393}{isLargeObject<unknownMem>}}(\mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}})\ ||\ \mbox{\hyperlink{namespacerml_1_1internal_a44371ad68e0e7931776e8e128764ae79}{isSmallObject}}(\mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}}));}
\DoxyCodeLine{02504\ \}}
\DoxyCodeLine{02505\ }
\DoxyCodeLine{02506\ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{namespacerml_1_1internal_adeac248637575859a6e8f733ba15060e}{freeSmallObject}}(\textcolor{keywordtype}{void}\ *\textcolor{keywordtype}{object})}
\DoxyCodeLine{02507\ \{}
\DoxyCodeLine{02508\ \ \ \ \ \textcolor{comment}{/*\ mask\ low\ bits\ to\ get\ the\ block\ */}}
\DoxyCodeLine{02509\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}\ *\mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}\ =\ (\mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}\ *)\mbox{\hyperlink{shared__utils_8h_ab3918cd2395835f90b78b96d4e1e2390}{alignDown}}(\textcolor{keywordtype}{object},\ \mbox{\hyperlink{namespacerml_1_1internal_ab92a44f5c0d4ae24554856afbba1943d}{slabSize}});}
\DoxyCodeLine{02510\ \ \ \ \ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}-\/>checkFreePrecond(\textcolor{keywordtype}{object});}
\DoxyCodeLine{02511\ }
\DoxyCodeLine{02512\ \textcolor{preprocessor}{\#if\ MALLOC\_CHECK\_RECURSION}}
\DoxyCodeLine{02513\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}-\/>isStartupAllocObject())\ \{}
\DoxyCodeLine{02514\ \ \ \ \ \ \ \ \ ((StartupBlock\ *)\mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}})-\/>free(\textcolor{keywordtype}{object});}
\DoxyCodeLine{02515\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{02516\ \ \ \ \ \}}
\DoxyCodeLine{02517\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02518\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}-\/>isOwnedByCurrentThread())\ \{}
\DoxyCodeLine{02519\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}-\/>freeOwnObject(\textcolor{keywordtype}{object});}
\DoxyCodeLine{02520\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{\ \textcolor{comment}{/*\ Slower\ path\ to\ add\ to\ the\ shared\ list,\ the\ allocatedCount\ is\ updated\ by\ the\ owner\ thread\ in\ malloc.\ */}}
\DoxyCodeLine{02521\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structrml_1_1internal_1_1_free_object}{FreeObject}}\ *objectToFree\ =\ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}-\/>findObjectToFree(\textcolor{keywordtype}{object});}
\DoxyCodeLine{02522\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}-\/>freePublicObject(objectToFree);}
\DoxyCodeLine{02523\ \ \ \ \ \}}
\DoxyCodeLine{02524\ \}}
\DoxyCodeLine{02525\ }
\DoxyCodeLine{02526\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ *\mbox{\hyperlink{namespacerml_1_1internal_a341c0310d4c1374c96acc18cd37eba26}{internalPoolMalloc}}(\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool}{MemoryPool}}*\ memPool,\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}})}
\DoxyCodeLine{02527\ \{}
\DoxyCodeLine{02528\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_bin}{Bin}}*\ \mbox{\hyperlink{runtime_2spdlog_2include_2spdlog_2fmt_2bundled_2base_8h_adfa139c9a1902753b3696794759b2c48ac1111bd512b29e821b120b86446026b8}{bin}};}
\DoxyCodeLine{02529\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}\ *\ mallocBlock;}
\DoxyCodeLine{02530\ }
\DoxyCodeLine{02531\ \ \ \ \ \textcolor{keywordflow}{if}\ (!memPool)\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{02532\ }
\DoxyCodeLine{02533\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}})\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}}\ =\ \textcolor{keyword}{sizeof}(size\_t);}
\DoxyCodeLine{02534\ }
\DoxyCodeLine{02535\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data}{TLSData}}\ *tls\ =\ memPool-\/>\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_acdf684e1b29c9d00886d97b909798488}{getTLS}}(\textcolor{comment}{/*create=*/}\textcolor{keyword}{true});}
\DoxyCodeLine{02536\ }
\DoxyCodeLine{02537\ \ \ \ \ \textcolor{comment}{/*\ Allocate\ a\ large\ object\ */}}
\DoxyCodeLine{02538\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}}\ >=\ \mbox{\hyperlink{namespacerml_1_1internal_ad778f7cb21fd95b85e36f2cf18d8fc60}{minLargeObjectSize}})}
\DoxyCodeLine{02539\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ memPool-\/>\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_af1f6175add16b2b950447b8b4c6bf491}{getFromLLOCache}}(tls,\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}},\ \mbox{\hyperlink{namespacerml_1_1internal_aa95f01338b826313f5e137f38e282e01}{largeObjectAlignment}});}
\DoxyCodeLine{02540\ }
\DoxyCodeLine{02541\ \ \ \ \ \textcolor{keywordflow}{if}\ (!tls)\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{02542\ }
\DoxyCodeLine{02543\ \ \ \ \ tls-\/>\mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data_afabda6a63ddb1942d1d5a7a06f41e2ae}{markUsed}}();}
\DoxyCodeLine{02544\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{02545\ \textcolor{comment}{\ \ \ \ \ *\ Get\ an\ element\ in\ thread-\/local\ array\ corresponding\ to\ the\ given\ size;}}
\DoxyCodeLine{02546\ \textcolor{comment}{\ \ \ \ \ *\ It\ keeps\ ptr\ to\ the\ active\ block\ for\ allocations\ of\ this\ size}}
\DoxyCodeLine{02547\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{02548\ \ \ \ \ \mbox{\hyperlink{runtime_2spdlog_2include_2spdlog_2fmt_2bundled_2base_8h_adfa139c9a1902753b3696794759b2c48ac1111bd512b29e821b120b86446026b8}{bin}}\ =\ tls-\/>\mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data_a26c607a6304c0fa325c6604cf7c767ea}{getAllocationBin}}(\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}});}
\DoxyCodeLine{02549\ \ \ \ \ \textcolor{keywordflow}{if}\ (\ !\mbox{\hyperlink{runtime_2spdlog_2include_2spdlog_2fmt_2bundled_2base_8h_adfa139c9a1902753b3696794759b2c48ac1111bd512b29e821b120b86446026b8}{bin}}\ )\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{02550\ }
\DoxyCodeLine{02551\ \ \ \ \ \textcolor{comment}{/*\ Get\ a\ block\ to\ try\ to\ allocate\ in.\ */}}
\DoxyCodeLine{02552\ \ \ \ \ \textcolor{keywordflow}{for}(\ mallocBlock\ =\ \mbox{\hyperlink{runtime_2spdlog_2include_2spdlog_2fmt_2bundled_2base_8h_adfa139c9a1902753b3696794759b2c48ac1111bd512b29e821b120b86446026b8}{bin}}-\/>getActiveBlock();\ mallocBlock;}
\DoxyCodeLine{02553\ \ \ \ \ \ \ \ \ \ mallocBlock\ =\ \mbox{\hyperlink{runtime_2spdlog_2include_2spdlog_2fmt_2bundled_2base_8h_adfa139c9a1902753b3696794759b2c48ac1111bd512b29e821b120b86446026b8}{bin}}-\/>setPreviousBlockActive()\ )\ \textcolor{comment}{//\ the\ previous\ block\ should\ be\ empty\ enough}}
\DoxyCodeLine{02554\ \ \ \ \ \{}
\DoxyCodeLine{02555\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ \mbox{\hyperlink{structrml_1_1internal_1_1_free_object}{FreeObject}}\ *\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}}\ =\ mallocBlock-\/>\mbox{\hyperlink{classrml_1_1internal_1_1_block_ab304c726e184fcd2cad31e30306e07ab}{allocate}}()\ )}
\DoxyCodeLine{02556\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}};}
\DoxyCodeLine{02557\ \ \ \ \ \}}
\DoxyCodeLine{02558\ }
\DoxyCodeLine{02559\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{02560\ \textcolor{comment}{\ \ \ \ \ *\ else\ privatize\ publicly\ freed\ objects\ in\ some\ block\ and\ allocate\ from\ it}}
\DoxyCodeLine{02561\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{02562\ \ \ \ \ mallocBlock\ =\ \mbox{\hyperlink{runtime_2spdlog_2include_2spdlog_2fmt_2bundled_2base_8h_adfa139c9a1902753b3696794759b2c48ac1111bd512b29e821b120b86446026b8}{bin}}-\/>getPrivatizedFreeListBlock();}
\DoxyCodeLine{02563\ \ \ \ \ \textcolor{keywordflow}{if}\ (mallocBlock)\ \{}
\DoxyCodeLine{02564\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\ mallocBlock-\/>\mbox{\hyperlink{classrml_1_1internal_1_1_block_a624decb3bf1a4f7ab0b66e3ae0fb1324}{freeListNonNull}}(),\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}}\ );}
\DoxyCodeLine{02565\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\ \mbox{\hyperlink{structrml_1_1internal_1_1_free_object}{FreeObject}}\ *\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}}\ =\ mallocBlock-\/>\mbox{\hyperlink{classrml_1_1internal_1_1_block_a49c5382153edd22b031869f0a822f9f2}{allocateFromFreeList}}()\ )}
\DoxyCodeLine{02566\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}};}
\DoxyCodeLine{02567\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Else\ something\ strange\ happened,\ need\ to\ retry\ from\ the\ beginning;\ */}}
\DoxyCodeLine{02568\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{tbbmalloc__internal_8h_af1c1baacf37ff8d445664716b811ee39}{TRACEF}}((\ \textcolor{stringliteral}{"{}[ScalableMalloc\ trace]\ Something\ is\ wrong:\ no\ objects\ in\ public\ free\ list;\ reentering.\(\backslash\)n"{}}\ ));}
\DoxyCodeLine{02569\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacerml_1_1internal_a341c0310d4c1374c96acc18cd37eba26}{internalPoolMalloc}}(memPool,\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}});}
\DoxyCodeLine{02570\ \ \ \ \ \}}
\DoxyCodeLine{02571\ }
\DoxyCodeLine{02572\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{02573\ \textcolor{comment}{\ \ \ \ \ *\ no\ suitable\ own\ blocks,\ try\ to\ get\ a\ partial\ block\ that\ some\ other\ thread\ has\ discarded.}}
\DoxyCodeLine{02574\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{02575\ \ \ \ \ mallocBlock\ =\ memPool-\/>\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_a93f7cd65f7ae8f1608a846cded95cd7c}{extMemPool}}.\mbox{\hyperlink{structrml_1_1internal_1_1_ext_memory_pool_a8fa17ab397beaf1680550ef5213d1643}{orphanedBlocks}}.\mbox{\hyperlink{classrml_1_1internal_1_1_orphaned_blocks_a3ed9f9cf98cd6c788195e57408c5ed26}{get}}(tls,\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}});}
\DoxyCodeLine{02576\ \ \ \ \ \textcolor{keywordflow}{while}\ (mallocBlock)\ \{}
\DoxyCodeLine{02577\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{runtime_2spdlog_2include_2spdlog_2fmt_2bundled_2base_8h_adfa139c9a1902753b3696794759b2c48ac1111bd512b29e821b120b86446026b8}{bin}}-\/>pushTLSBin(mallocBlock);}
\DoxyCodeLine{02578\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{runtime_2spdlog_2include_2spdlog_2fmt_2bundled_2base_8h_adfa139c9a1902753b3696794759b2c48ac1111bd512b29e821b120b86446026b8}{bin}}-\/>setActiveBlock(mallocBlock);\ \textcolor{comment}{//\ TODO:\ move\ under\ the\ below\ condition?}}
\DoxyCodeLine{02579\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ \mbox{\hyperlink{structrml_1_1internal_1_1_free_object}{FreeObject}}\ *\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}}\ =\ mallocBlock-\/>\mbox{\hyperlink{classrml_1_1internal_1_1_block_ab304c726e184fcd2cad31e30306e07ab}{allocate}}()\ )}
\DoxyCodeLine{02580\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}};}
\DoxyCodeLine{02581\ \ \ \ \ \ \ \ \ mallocBlock\ =\ memPool-\/>\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_a93f7cd65f7ae8f1608a846cded95cd7c}{extMemPool}}.\mbox{\hyperlink{structrml_1_1internal_1_1_ext_memory_pool_a8fa17ab397beaf1680550ef5213d1643}{orphanedBlocks}}.\mbox{\hyperlink{classrml_1_1internal_1_1_orphaned_blocks_a3ed9f9cf98cd6c788195e57408c5ed26}{get}}(tls,\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}});}
\DoxyCodeLine{02582\ \ \ \ \ \}}
\DoxyCodeLine{02583\ }
\DoxyCodeLine{02584\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{02585\ \textcolor{comment}{\ \ \ \ \ *\ else\ try\ to\ get\ a\ new\ empty\ block}}
\DoxyCodeLine{02586\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{02587\ \ \ \ \ mallocBlock\ =\ memPool-\/>\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_a16261e62d2c6418981ade9a7ea23d5d0}{getEmptyBlock}}(\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}});}
\DoxyCodeLine{02588\ \ \ \ \ \textcolor{keywordflow}{if}\ (mallocBlock)\ \{}
\DoxyCodeLine{02589\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{runtime_2spdlog_2include_2spdlog_2fmt_2bundled_2base_8h_adfa139c9a1902753b3696794759b2c48ac1111bd512b29e821b120b86446026b8}{bin}}-\/>pushTLSBin(mallocBlock);}
\DoxyCodeLine{02590\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{runtime_2spdlog_2include_2spdlog_2fmt_2bundled_2base_8h_adfa139c9a1902753b3696794759b2c48ac1111bd512b29e821b120b86446026b8}{bin}}-\/>setActiveBlock(mallocBlock);}
\DoxyCodeLine{02591\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ \mbox{\hyperlink{structrml_1_1internal_1_1_free_object}{FreeObject}}\ *\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}}\ =\ mallocBlock-\/>\mbox{\hyperlink{classrml_1_1internal_1_1_block_ab304c726e184fcd2cad31e30306e07ab}{allocate}}()\ )}
\DoxyCodeLine{02592\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}};}
\DoxyCodeLine{02593\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Else\ something\ strange\ happened,\ need\ to\ retry\ from\ the\ beginning;\ */}}
\DoxyCodeLine{02594\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{tbbmalloc__internal_8h_af1c1baacf37ff8d445664716b811ee39}{TRACEF}}((\ \textcolor{stringliteral}{"{}[ScalableMalloc\ trace]\ Something\ is\ wrong:\ no\ objects\ in\ empty\ block;\ reentering.\(\backslash\)n"{}}\ ));}
\DoxyCodeLine{02595\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacerml_1_1internal_a341c0310d4c1374c96acc18cd37eba26}{internalPoolMalloc}}(memPool,\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}});}
\DoxyCodeLine{02596\ \ \ \ \ \}}
\DoxyCodeLine{02597\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{02598\ \textcolor{comment}{\ \ \ \ \ *\ else\ nothing\ works\ so\ return\ NULL}}
\DoxyCodeLine{02599\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{02600\ \ \ \ \ \mbox{\hyperlink{tbbmalloc__internal_8h_af1c1baacf37ff8d445664716b811ee39}{TRACEF}}((\ \textcolor{stringliteral}{"{}[ScalableMalloc\ trace]\ No\ memory\ found,\ returning\ NULL.\(\backslash\)n"{}}\ ));}
\DoxyCodeLine{02601\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{02602\ \}}
\DoxyCodeLine{02603\ }
\DoxyCodeLine{02604\ \textcolor{comment}{//\ When\ size==0\ (i.e.\ unknown),\ detect\ here\ whether\ the\ object\ is\ large.}}
\DoxyCodeLine{02605\ \textcolor{comment}{//\ For\ size\ is\ known\ and\ <\ minLargeObjectSize,\ we\ still\ need\ to\ check}}
\DoxyCodeLine{02606\ \textcolor{comment}{//\ if\ the\ actual\ object\ is\ large,\ because\ large\ objects\ might\ be\ used}}
\DoxyCodeLine{02607\ \textcolor{comment}{//\ for\ aligned\ small\ allocations.}}
\DoxyCodeLine{02608\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{namespacerml_1_1internal_a8bff2023b8463f38317c75980f21e0db}{internalPoolFree}}(\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool}{MemoryPool}}\ *memPool,\ \textcolor{keywordtype}{void}\ *\textcolor{keywordtype}{object},\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}})}
\DoxyCodeLine{02609\ \{}
\DoxyCodeLine{02610\ \ \ \ \ \textcolor{keywordflow}{if}\ (!memPool\ ||\ !\textcolor{keywordtype}{object})\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{02611\ }
\DoxyCodeLine{02612\ \ \ \ \ \textcolor{comment}{//\ The\ library\ is\ initialized\ at\ allocation\ call,\ so\ releasing\ while}}
\DoxyCodeLine{02613\ \ \ \ \ \textcolor{comment}{//\ not\ initialized\ means\ foreign\ object\ is\ releasing.}}
\DoxyCodeLine{02614\ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\mbox{\hyperlink{namespacerml_1_1internal_a61c4d632ea815cbeea8ed0ee72e06ac7}{isMallocInitialized}}(),\ \mbox{\hyperlink{tbbmalloc__internal_8h_a3b823c1707df8bd6d7d8b7cdb8b6dc6d}{ASSERT\_TEXT}});}
\DoxyCodeLine{02615\ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(memPool-\/>\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_a93f7cd65f7ae8f1608a846cded95cd7c}{extMemPool}}.\mbox{\hyperlink{structrml_1_1internal_1_1_ext_memory_pool_a6f02801fa5ba692cf62457c0a80079cc}{userPool}}()\ ||\ \mbox{\hyperlink{namespacerml_1_1internal_abe52e5f71a9571929c11e06738d0864f}{isRecognized}}(\textcolor{keywordtype}{object}),}
\DoxyCodeLine{02616\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Invalid\ pointer\ during\ object\ releasing\ is\ detected."{}});}
\DoxyCodeLine{02617\ }
\DoxyCodeLine{02618\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}}\ >=\ \mbox{\hyperlink{namespacerml_1_1internal_ad778f7cb21fd95b85e36f2cf18d8fc60}{minLargeObjectSize}}\ ||\ \mbox{\hyperlink{namespacerml_1_1internal_a730f387568a0a522e003dca4246eb393}{isLargeObject<ourMem>}}(\textcolor{keywordtype}{object}))}
\DoxyCodeLine{02619\ \ \ \ \ \ \ \ \ memPool-\/>\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_aedf33ac6b570a3847f86ad528de00149}{putToLLOCache}}(memPool-\/>\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_acdf684e1b29c9d00886d97b909798488}{getTLS}}(\textcolor{comment}{/*create=*/}\textcolor{keyword}{false}),\ \textcolor{keywordtype}{object});}
\DoxyCodeLine{02620\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{02621\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacerml_1_1internal_adeac248637575859a6e8f733ba15060e}{freeSmallObject}}(\textcolor{keywordtype}{object});}
\DoxyCodeLine{02622\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{02623\ \}}
\DoxyCodeLine{02624\ }
\DoxyCodeLine{02625\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ *\mbox{\hyperlink{namespacerml_1_1internal_a19b0fbc5aaa4b08cc412bb5777b01f89}{internalMalloc}}(\textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}})}
\DoxyCodeLine{02626\ \{}
\DoxyCodeLine{02627\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}})\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}}\ =\ \textcolor{keyword}{sizeof}(size\_t);}
\DoxyCodeLine{02628\ }
\DoxyCodeLine{02629\ \textcolor{preprocessor}{\#if\ MALLOC\_CHECK\_RECURSION}}
\DoxyCodeLine{02630\ \ \ \ \ \textcolor{keywordflow}{if}\ (RecursiveMallocCallProtector::sameThreadActive())}
\DoxyCodeLine{02631\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}}<\mbox{\hyperlink{namespacerml_1_1internal_ad778f7cb21fd95b85e36f2cf18d8fc60}{minLargeObjectSize}}?\ StartupBlock::allocate(\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}})\ :}
\DoxyCodeLine{02632\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ nested\ allocation,\ so\ skip\ tls}}
\DoxyCodeLine{02633\ \ \ \ \ \ \ \ \ \ \ \ \ (\mbox{\hyperlink{structrml_1_1internal_1_1_free_object}{FreeObject}}*)\mbox{\hyperlink{namespacerml_1_1internal_a775ef3ae8dd6b242d20f44ebd787a1be}{defaultMemPool}}-\/>getFromLLOCache(\mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}},\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}},\ \mbox{\hyperlink{namespacerml_1_1internal_ab92a44f5c0d4ae24554856afbba1943d}{slabSize}});}
\DoxyCodeLine{02634\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02635\ }
\DoxyCodeLine{02636\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{namespacerml_1_1internal_a61c4d632ea815cbeea8ed0ee72e06ac7}{isMallocInitialized}}())}
\DoxyCodeLine{02637\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{namespacerml_1_1internal_aad59cc02d849210b00c8587544e44e20}{doInitialization}}())}
\DoxyCodeLine{02638\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{02639\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacerml_1_1internal_a341c0310d4c1374c96acc18cd37eba26}{internalPoolMalloc}}(\mbox{\hyperlink{namespacerml_1_1internal_a775ef3ae8dd6b242d20f44ebd787a1be}{defaultMemPool}},\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}});}
\DoxyCodeLine{02640\ \}}
\DoxyCodeLine{02641\ }
\DoxyCodeLine{02642\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{namespacerml_1_1internal_a91eeaa067e3fdf5618b5a65b8b368231}{internalFree}}(\textcolor{keywordtype}{void}\ *\textcolor{keywordtype}{object})}
\DoxyCodeLine{02643\ \{}
\DoxyCodeLine{02644\ \ \ \ \ \mbox{\hyperlink{namespacerml_1_1internal_a8bff2023b8463f38317c75980f21e0db}{internalPoolFree}}(\mbox{\hyperlink{namespacerml_1_1internal_a775ef3ae8dd6b242d20f44ebd787a1be}{defaultMemPool}},\ \textcolor{keywordtype}{object},\ 0);}
\DoxyCodeLine{02645\ \}}
\DoxyCodeLine{02646\ }
\DoxyCodeLine{02647\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{namespacerml_1_1internal_a2687be7826e3608802f99d6d2d63f748}{internalMsize}}(\textcolor{keywordtype}{void}*\ \mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}})}
\DoxyCodeLine{02648\ \{}
\DoxyCodeLine{02649\ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}},\ \textcolor{stringliteral}{"{}Invalid\ pointer\ passed\ to\ internalMsize"{}});}
\DoxyCodeLine{02650\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacerml_1_1internal_a730f387568a0a522e003dca4246eb393}{isLargeObject<ourMem>}}(\mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}}))\ \{}
\DoxyCodeLine{02651\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ TODO:\ return\ the\ maximum\ memory\ size,\ that\ can\ be\ written\ to\ this\ object}}
\DoxyCodeLine{02652\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structrml_1_1internal_1_1_large_memory_block}{LargeMemoryBlock}}*\ lmb\ =\ ((\mbox{\hyperlink{structrml_1_1internal_1_1_large_object_hdr}{LargeObjectHdr}}*)\mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}}\ -\/\ 1)-\/>memoryBlock;}
\DoxyCodeLine{02653\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ lmb-\/>\mbox{\hyperlink{structrml_1_1internal_1_1_large_memory_block_a36dc3cf5c0acd49721481eda74838e3b}{objectSize}};}
\DoxyCodeLine{02654\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02655\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}\ *\mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}\ =\ (\mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}*)\mbox{\hyperlink{shared__utils_8h_ab3918cd2395835f90b78b96d4e1e2390}{alignDown}}(\mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}},\ \mbox{\hyperlink{namespacerml_1_1internal_ab92a44f5c0d4ae24554856afbba1943d}{slabSize}});}
\DoxyCodeLine{02656\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}-\/>findObjectSize(\mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}});}
\DoxyCodeLine{02657\ \ \ \ \ \}}
\DoxyCodeLine{02658\ \}}
\DoxyCodeLine{02659\ }
\DoxyCodeLine{02660\ \}\ \textcolor{comment}{//\ namespace\ internal}}
\DoxyCodeLine{02661\ }
\DoxyCodeLine{02662\ \textcolor{keyword}{using\ namespace\ }\mbox{\hyperlink{namespacerml_1_1internal}{rml::internal}};}
\DoxyCodeLine{02663\ }
\DoxyCodeLine{02664\ \textcolor{comment}{//\ legacy\ entry\ point\ saved\ for\ compatibility\ with\ binaries\ complied}}
\DoxyCodeLine{02665\ \textcolor{comment}{//\ with\ pre-\/6003\ versions\ of\ TBB}}
\DoxyCodeLine{02666\ \mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool}{rml::MemoryPool}}\ *\mbox{\hyperlink{namespacerml_afba6b59879ac569c4a01d17208faa177}{pool\_create}}(intptr\_t\ pool\_id,\ \textcolor{keyword}{const}\ MemPoolPolicy\ *policy)}
\DoxyCodeLine{02667\ \{}
\DoxyCodeLine{02668\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool}{rml::MemoryPool}}\ *pool;}
\DoxyCodeLine{02669\ \ \ \ \ MemPoolPolicy\ pol(policy-\/>pAlloc,\ policy-\/>pFree,\ policy-\/>granularity);}
\DoxyCodeLine{02670\ }
\DoxyCodeLine{02671\ \ \ \ \ \mbox{\hyperlink{namespacerml_a5c43cf02ddb1bdd7e9f5a806a2aef010}{pool\_create\_v1}}(pool\_id,\ \&pol,\ \&pool);}
\DoxyCodeLine{02672\ \ \ \ \ \textcolor{keywordflow}{return}\ pool;}
\DoxyCodeLine{02673\ \}}
\DoxyCodeLine{02674\ }
\DoxyCodeLine{02675\ rml::MemPoolError\ \mbox{\hyperlink{namespacerml_a5c43cf02ddb1bdd7e9f5a806a2aef010}{pool\_create\_v1}}(intptr\_t\ pool\_id,\ \textcolor{keyword}{const}\ MemPoolPolicy\ *policy,}
\DoxyCodeLine{02676\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool}{rml::MemoryPool}}\ **pool)}
\DoxyCodeLine{02677\ \{}
\DoxyCodeLine{02678\ \ \ \ \ \textcolor{keywordflow}{if}\ (\ !policy-\/>pAlloc\ ||\ policy-\/>version<MemPoolPolicy::TBBMALLOC\_POOL\_VERSION}
\DoxyCodeLine{02679\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ empty\ pFree\ allowed\ only\ for\ fixed\ pools}}
\DoxyCodeLine{02680\ \ \ \ \ \ \ \ \ \ ||\ !(policy-\/>fixedPool\ ||\ policy-\/>pFree))\ \{}
\DoxyCodeLine{02681\ \ \ \ \ \ \ \ \ *pool\ =\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{02682\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ INVALID\_POLICY;}
\DoxyCodeLine{02683\ \ \ \ \ \}}
\DoxyCodeLine{02684\ \ \ \ \ \textcolor{keywordflow}{if}\ (\ policy-\/>version>MemPoolPolicy::TBBMALLOC\_POOL\_VERSION\ \textcolor{comment}{//\ future\ versions\ are\ not\ supported}}
\DoxyCodeLine{02685\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ new\ flags\ can\ be\ added\ in\ place\ of\ reserved,\ but\ default}}
\DoxyCodeLine{02686\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ behaviour\ must\ be\ supported\ by\ this\ version}}
\DoxyCodeLine{02687\ \ \ \ \ \ \ \ \ \ ||\ policy-\/>reserved\ )\ \{}
\DoxyCodeLine{02688\ \ \ \ \ \ \ \ \ *pool\ =\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{02689\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ UNSUPPORTED\_POLICY;}
\DoxyCodeLine{02690\ \ \ \ \ \}}
\DoxyCodeLine{02691\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{namespacerml_1_1internal_a61c4d632ea815cbeea8ed0ee72e06ac7}{isMallocInitialized}}())}
\DoxyCodeLine{02692\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{namespacerml_1_1internal_aad59cc02d849210b00c8587544e44e20}{doInitialization}}())\ \{}
\DoxyCodeLine{02693\ \ \ \ \ \ \ \ \ \ \ \ \ *pool\ =\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{02694\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ NO\_MEMORY;}
\DoxyCodeLine{02695\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02696\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool}{rml::internal::MemoryPool}}\ *memPool\ =}
\DoxyCodeLine{02697\ \ \ \ \ \ \ \ \ (\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool}{rml::internal::MemoryPool}}*)\mbox{\hyperlink{namespacerml_1_1internal_a19b0fbc5aaa4b08cc412bb5777b01f89}{internalMalloc}}((\textcolor{keyword}{sizeof}(\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool}{rml::internal::MemoryPool}})));}
\DoxyCodeLine{02698\ \ \ \ \ \textcolor{keywordflow}{if}\ (!memPool)\ \{}
\DoxyCodeLine{02699\ \ \ \ \ \ \ \ \ *pool\ =\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{02700\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ NO\_MEMORY;}
\DoxyCodeLine{02701\ \ \ \ \ \}}
\DoxyCodeLine{02702\ \ \ \ \ memset(memPool,\ 0,\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool}{rml::internal::MemoryPool}}));}
\DoxyCodeLine{02703\ \ \ \ \ \textcolor{keywordflow}{if}\ (!memPool-\/>\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_a7b9f97bc41fa9c3d5fb6d3e7bbe4180d}{init}}(pool\_id,\ policy))\ \{}
\DoxyCodeLine{02704\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacerml_1_1internal_a91eeaa067e3fdf5618b5a65b8b368231}{internalFree}}(memPool);}
\DoxyCodeLine{02705\ \ \ \ \ \ \ \ \ *pool\ =\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{02706\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ NO\_MEMORY;}
\DoxyCodeLine{02707\ \ \ \ \ \}}
\DoxyCodeLine{02708\ }
\DoxyCodeLine{02709\ \ \ \ \ *pool\ =\ (\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool}{rml::MemoryPool}}*)memPool;}
\DoxyCodeLine{02710\ \ \ \ \ \textcolor{keywordflow}{return}\ POOL\_OK;}
\DoxyCodeLine{02711\ \}}
\DoxyCodeLine{02712\ }
\DoxyCodeLine{02713\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{namespacerml_a2b8ce24ce088bec3c09ccca31a530cbd}{pool\_destroy}}(\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool}{rml::MemoryPool}}*\ memPool)}
\DoxyCodeLine{02714\ \{}
\DoxyCodeLine{02715\ \ \ \ \ \textcolor{keywordflow}{if}\ (!memPool)\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{02716\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{level1__impl_8h_afb8d513d0298d2695018eb494b092786}{ret}}\ =\ ((\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool}{rml::internal::MemoryPool}}*)memPool)-\/>destroy();}
\DoxyCodeLine{02717\ \ \ \ \ \mbox{\hyperlink{namespacerml_1_1internal_a91eeaa067e3fdf5618b5a65b8b368231}{internalFree}}(memPool);}
\DoxyCodeLine{02718\ }
\DoxyCodeLine{02719\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{level1__impl_8h_afb8d513d0298d2695018eb494b092786}{ret}};}
\DoxyCodeLine{02720\ \}}
\DoxyCodeLine{02721\ }
\DoxyCodeLine{02722\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{namespacerml_abd23da3f48bdfa76540267f3869b7f93}{pool\_reset}}(\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool}{rml::MemoryPool}}*\ memPool)}
\DoxyCodeLine{02723\ \{}
\DoxyCodeLine{02724\ \ \ \ \ \textcolor{keywordflow}{if}\ (!memPool)\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{02725\ }
\DoxyCodeLine{02726\ \ \ \ \ \textcolor{keywordflow}{return}\ ((\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool}{rml::internal::MemoryPool}}*)memPool)-\/>reset();}
\DoxyCodeLine{02727\ \}}
\DoxyCodeLine{02728\ }
\DoxyCodeLine{02729\ \textcolor{keywordtype}{void}\ *\mbox{\hyperlink{namespacerml_a6c230de7a356b3e800d1d902d88def38}{pool\_malloc}}(\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool}{rml::MemoryPool}}*\ mPool,\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}})}
\DoxyCodeLine{02730\ \{}
\DoxyCodeLine{02731\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacerml_1_1internal_a341c0310d4c1374c96acc18cd37eba26}{internalPoolMalloc}}((\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool}{rml::internal::MemoryPool}}*)mPool,\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}});}
\DoxyCodeLine{02732\ \}}
\DoxyCodeLine{02733\ }
\DoxyCodeLine{02734\ \textcolor{keywordtype}{void}\ *\mbox{\hyperlink{namespacerml_ad7b43dc9fd62fe9e93f69c5c534fd4c1}{pool\_realloc}}(\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool}{rml::MemoryPool}}*\ mPool,\ \textcolor{keywordtype}{void}\ *\textcolor{keywordtype}{object},\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}})}
\DoxyCodeLine{02735\ \{}
\DoxyCodeLine{02736\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\textcolor{keywordtype}{object})}
\DoxyCodeLine{02737\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacerml_1_1internal_a341c0310d4c1374c96acc18cd37eba26}{internalPoolMalloc}}((\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool}{rml::internal::MemoryPool}}*)mPool,\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}});}
\DoxyCodeLine{02738\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}})\ \{}
\DoxyCodeLine{02739\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacerml_1_1internal_a8bff2023b8463f38317c75980f21e0db}{internalPoolFree}}((\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool}{rml::internal::MemoryPool}}*)mPool,\ \textcolor{keywordtype}{object},\ 0);}
\DoxyCodeLine{02740\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{02741\ \ \ \ \ \}}
\DoxyCodeLine{02742\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacerml_1_1internal_a288f89b97757684760f283c91dbe8add}{reallocAligned}}((\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool}{rml::internal::MemoryPool}}*)mPool,\ \textcolor{keywordtype}{object},\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}},\ 0);}
\DoxyCodeLine{02743\ \}}
\DoxyCodeLine{02744\ }
\DoxyCodeLine{02745\ \textcolor{keywordtype}{void}\ *\mbox{\hyperlink{namespacerml_aec398325702f6e12f63e9edb54f3d56a}{pool\_aligned\_malloc}}(\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool}{rml::MemoryPool}}*\ mPool,\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}},\ \textcolor{keywordtype}{size\_t}\ alignment)}
\DoxyCodeLine{02746\ \{}
\DoxyCodeLine{02747\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{_customize_8h_acd7827300d6ae7b109ba374f9fd9e7dd}{isPowerOfTwo}}(alignment)\ ||\ 0==\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}})}
\DoxyCodeLine{02748\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{02749\ }
\DoxyCodeLine{02750\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacerml_1_1internal_a8de88aa18618ca387871e41654bef552}{allocateAligned}}((\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool}{rml::internal::MemoryPool}}*)mPool,\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}},\ alignment);}
\DoxyCodeLine{02751\ \}}
\DoxyCodeLine{02752\ }
\DoxyCodeLine{02753\ \textcolor{keywordtype}{void}\ *\mbox{\hyperlink{namespacerml_a76a8196c36394833afc54ac83c1de912}{pool\_aligned\_realloc}}(\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool}{rml::MemoryPool}}*\ memPool,\ \textcolor{keywordtype}{void}\ *\mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}},\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}},\ \textcolor{keywordtype}{size\_t}\ alignment)}
\DoxyCodeLine{02754\ \{}
\DoxyCodeLine{02755\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{_customize_8h_acd7827300d6ae7b109ba374f9fd9e7dd}{isPowerOfTwo}}(alignment))}
\DoxyCodeLine{02756\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{02757\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool}{rml::internal::MemoryPool}}\ *mPool\ =\ (\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool}{rml::internal::MemoryPool}}*)memPool;}
\DoxyCodeLine{02758\ \ \ \ \ \textcolor{keywordtype}{void}\ *tmp;}
\DoxyCodeLine{02759\ }
\DoxyCodeLine{02760\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}})}
\DoxyCodeLine{02761\ \ \ \ \ \ \ \ \ tmp\ =\ \mbox{\hyperlink{namespacerml_1_1internal_a8de88aa18618ca387871e41654bef552}{allocateAligned}}(mPool,\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}},\ alignment);}
\DoxyCodeLine{02762\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}})\ \{}
\DoxyCodeLine{02763\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacerml_1_1internal_a8bff2023b8463f38317c75980f21e0db}{internalPoolFree}}(mPool,\ \mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}},\ 0);}
\DoxyCodeLine{02764\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{02765\ \ \ \ \ \}\ \textcolor{keywordflow}{else}}
\DoxyCodeLine{02766\ \ \ \ \ \ \ \ \ tmp\ =\ \mbox{\hyperlink{namespacerml_1_1internal_a288f89b97757684760f283c91dbe8add}{reallocAligned}}(mPool,\ \mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}},\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}},\ alignment);}
\DoxyCodeLine{02767\ }
\DoxyCodeLine{02768\ \ \ \ \ \textcolor{keywordflow}{return}\ tmp;}
\DoxyCodeLine{02769\ \}}
\DoxyCodeLine{02770\ }
\DoxyCodeLine{02771\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{namespacerml_add3a8a360f829fe466bafc9db5f5be2c}{pool\_free}}(\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool}{rml::MemoryPool}}\ *mPool,\ \textcolor{keywordtype}{void}\ *\textcolor{keywordtype}{object})}
\DoxyCodeLine{02772\ \{}
\DoxyCodeLine{02773\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacerml_1_1internal_a8bff2023b8463f38317c75980f21e0db}{internalPoolFree}}((\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool}{rml::internal::MemoryPool}}*)mPool,\ \textcolor{keywordtype}{object},\ 0);}
\DoxyCodeLine{02774\ \}}
\DoxyCodeLine{02775\ }
\DoxyCodeLine{02776\ \mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool}{rml::MemoryPool}}\ *\mbox{\hyperlink{namespacerml_a6ab7d98b2a87b128320ff275cd64e734}{pool\_identify}}(\textcolor{keywordtype}{void}\ *\textcolor{keywordtype}{object})}
\DoxyCodeLine{02777\ \{}
\DoxyCodeLine{02778\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool}{rml::internal::MemoryPool}}\ *pool;}
\DoxyCodeLine{02779\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacerml_1_1internal_a730f387568a0a522e003dca4246eb393}{isLargeObject<ourMem>}}(\textcolor{keywordtype}{object}))\ \{}
\DoxyCodeLine{02780\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structrml_1_1internal_1_1_large_object_hdr}{LargeObjectHdr}}\ *\mbox{\hyperlink{cblat1_8f_a410931b600854e6dd3e253731606117e}{header}}\ =\ (\mbox{\hyperlink{structrml_1_1internal_1_1_large_object_hdr}{LargeObjectHdr}}*)\textcolor{keywordtype}{object}\ -\/\ 1;}
\DoxyCodeLine{02781\ \ \ \ \ \ \ \ \ pool\ =\ \mbox{\hyperlink{cblat1_8f_a410931b600854e6dd3e253731606117e}{header}}-\/>memoryBlock-\/>pool;}
\DoxyCodeLine{02782\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02783\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}\ *\mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}\ =\ (\mbox{\hyperlink{classrml_1_1internal_1_1_block}{Block}}*)\mbox{\hyperlink{shared__utils_8h_ab3918cd2395835f90b78b96d4e1e2390}{alignDown}}(\textcolor{keywordtype}{object},\ \mbox{\hyperlink{namespacerml_1_1internal_ab92a44f5c0d4ae24554856afbba1943d}{slabSize}});}
\DoxyCodeLine{02784\ \ \ \ \ \ \ \ \ pool\ =\ \mbox{\hyperlink{mimalloc_8h_af7f922b73e3acdb4a430b72f1a1334a5}{block}}-\/>getMemPool();}
\DoxyCodeLine{02785\ \ \ \ \ \}}
\DoxyCodeLine{02786\ \ \ \ \ \textcolor{comment}{//\ do\ not\ return\ defaultMemPool,\ as\ it\ can't\ be\ used\ in\ pool\_free()\ etc}}
\DoxyCodeLine{02787\ \ \ \ \ \mbox{\hyperlink{tbb__stddef_8h_a69f490e0a73f64e92a8eac201f760e5e}{\_\_TBB\_ASSERT\_RELEASE}}(pool!=\mbox{\hyperlink{namespacerml_1_1internal_a775ef3ae8dd6b242d20f44ebd787a1be}{defaultMemPool}},}
\DoxyCodeLine{02788\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}rml::pool\_identify()\ can't\ be\ used\ for\ scalable\_malloc()\ etc\ results."{}});}
\DoxyCodeLine{02789\ \ \ \ \ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool}{rml::MemoryPool}}*)pool;}
\DoxyCodeLine{02790\ \}}
\DoxyCodeLine{02791\ }
\DoxyCodeLine{02792\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{namespacerml_a4a1c654b3a3a7b7f1e54fbbb43a4477f}{pool\_msize}}(\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool}{rml::MemoryPool}}\ *mPool,\ \textcolor{keywordtype}{void}*\ \textcolor{keywordtype}{object})}
\DoxyCodeLine{02793\ \{}
\DoxyCodeLine{02794\ \ \ \ \ \textcolor{keywordflow}{if}\ (\textcolor{keywordtype}{object})\ \{}
\DoxyCodeLine{02795\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ No\ assert\ for\ object\ recognition,\ cause\ objects\ allocated\ from\ non-\/default}}
\DoxyCodeLine{02796\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ memory\ pool\ do\ not\ participate\ in\ range\ checking\ and\ do\ not\ have\ valid\ backreferences\ for}}
\DoxyCodeLine{02797\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ small\ objects.\ Instead,\ check\ that\ an\ object\ belong\ to\ the\ certain\ memory\ pool.}}
\DoxyCodeLine{02798\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_customize_8h_a95d93fd152aba96ceade886f18eb0d1d}{MALLOC\_ASSERT\_EX}}(mPool\ ==\ \mbox{\hyperlink{namespacerml_a6ab7d98b2a87b128320ff275cd64e734}{pool\_identify}}(\textcolor{keywordtype}{object}),\ \textcolor{stringliteral}{"{}Object\ does\ not\ belong\ to\ the\ specified\ pool"{}});}
\DoxyCodeLine{02799\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacerml_1_1internal_a2687be7826e3608802f99d6d2d63f748}{internalMsize}}(\textcolor{keywordtype}{object});}
\DoxyCodeLine{02800\ \ \ \ \ \}}
\DoxyCodeLine{02801\ \ \ \ \ errno\ =\ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_a2d1678d5a7cc8ce499643f3b8957def4}{EINVAL}};}
\DoxyCodeLine{02802\ \ \ \ \ \textcolor{comment}{//\ Unlike\ \_msize,\ return\ 0\ in\ case\ of\ parameter\ error.}}
\DoxyCodeLine{02803\ \ \ \ \ \textcolor{comment}{//\ Returning\ size\_t(-\/1)\ looks\ more\ like\ the\ way\ to\ troubles.}}
\DoxyCodeLine{02804\ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{02805\ \}}
\DoxyCodeLine{02806\ }
\DoxyCodeLine{02807\ \}\ \textcolor{comment}{//\ namespace\ rml}}
\DoxyCodeLine{02808\ }
\DoxyCodeLine{02809\ \textcolor{keyword}{using\ namespace\ }\mbox{\hyperlink{namespacerml_1_1internal}{rml::internal}};}
\DoxyCodeLine{02810\ }
\DoxyCodeLine{02811\ \textcolor{preprocessor}{\#if\ MALLOC\_TRACE}}
\DoxyCodeLine{02812\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ threadGoingDownCount\ =\ 0;}
\DoxyCodeLine{02813\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02814\ }
\DoxyCodeLine{02815\ \textcolor{comment}{/*}}
\DoxyCodeLine{02816\ \textcolor{comment}{\ *\ When\ a\ thread\ is\ shutting\ down\ this\ routine\ should\ be\ called\ to\ remove\ all\ the\ thread\ ids}}
\DoxyCodeLine{02817\ \textcolor{comment}{\ *\ from\ the\ malloc\ blocks\ and\ replace\ them\ with\ a\ NULL\ thread\ id.}}
\DoxyCodeLine{02818\ \textcolor{comment}{\ *}}
\DoxyCodeLine{02819\ \textcolor{comment}{\ *\ For\ pthreads,\ the\ function\ is\ set\ as\ a\ callback\ in\ pthread\_key\_create\ for\ TLS\ bin.}}
\DoxyCodeLine{02820\ \textcolor{comment}{\ *\ It\ will\ be\ automatically\ called\ at\ thread\ exit\ with\ the\ key\ value\ as\ the\ argument,}}
\DoxyCodeLine{02821\ \textcolor{comment}{\ *\ unless\ that\ value\ is\ NULL.}}
\DoxyCodeLine{02822\ \textcolor{comment}{\ *\ For\ Windows,\ it\ is\ called\ from\ DllMain(\ DLL\_THREAD\_DETACH\ ).}}
\DoxyCodeLine{02823\ \textcolor{comment}{\ *}}
\DoxyCodeLine{02824\ \textcolor{comment}{\ *\ However\ neither\ of\ the\ above\ is\ called\ for\ the\ main\ process\ thread,\ so\ the\ routine}}
\DoxyCodeLine{02825\ \textcolor{comment}{\ *\ also\ needs\ to\ be\ called\ during\ the\ process\ shutdown.}}
\DoxyCodeLine{02826\ \textcolor{comment}{\ *}}
\DoxyCodeLine{02827\ \textcolor{comment}{*/}}
\DoxyCodeLine{02828\ \textcolor{comment}{//\ TODO:\ Consider\ making\ this\ function\ part\ of\ class\ MemoryPool.}}
\DoxyCodeLine{02829\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{frontend_8cpp_afc6b22a34f2f5ab48ef00dfc9bb82e00}{doThreadShutdownNotification}}(\mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data}{TLSData}}*\ tls,\ \textcolor{keywordtype}{bool}\ main\_thread)}
\DoxyCodeLine{02830\ \{}
\DoxyCodeLine{02831\ \ \ \ \ \mbox{\hyperlink{tbbmalloc__internal_8h_af1c1baacf37ff8d445664716b811ee39}{TRACEF}}((\ \textcolor{stringliteral}{"{}[ScalableMalloc\ trace]\ Thread\ id\ \%d\ blocks\ return\ start\ \%d\(\backslash\)n"{}},}
\DoxyCodeLine{02832\ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacerml_1_1internal_a2877b2db91c23b8b7eb1d37891c40b2b}{getThreadId}}(),\ \ threadGoingDownCount++\ ));}
\DoxyCodeLine{02833\ }
\DoxyCodeLine{02834\ \textcolor{preprocessor}{\#if\ USE\_PTHREAD}}
\DoxyCodeLine{02835\ \ \ \ \ \textcolor{keywordflow}{if}\ (tls)\ \{}
\DoxyCodeLine{02836\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{namespacerml_1_1internal_a93ecc803ce228488d5280172f0925c4a}{shutdownSync}}.threadDtorStart())\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{02837\ \ \ \ \ \ \ \ \ tls-\/>\mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data_aaec35d80922e4d30a6de64d5fa5d9d7f}{getMemPool}}()-\/>\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_a2a310517ff92f8e0e7dae29400ffeb61}{onThreadShutdown}}(tls);}
\DoxyCodeLine{02838\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacerml_1_1internal_a93ecc803ce228488d5280172f0925c4a}{shutdownSync}}.threadDtorDone();}
\DoxyCodeLine{02839\ \ \ \ \ \}\ \textcolor{keywordflow}{else}}
\DoxyCodeLine{02840\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02841\ \ \ \ \ \{}
\DoxyCodeLine{02842\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacerml_1_1internal_acf3df9c7e1c2baec44e3dab2d8f1ee42}{suppress\_unused\_warning}}(tls);\ \textcolor{comment}{//\ not\ used\ on\ Windows}}
\DoxyCodeLine{02843\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ The\ default\ pool\ is\ safe\ to\ use\ at\ this\ point:}}
\DoxyCodeLine{02844\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ on\ Linux,\ only\ the\ main\ thread\ can\ go\ here\ before\ destroying\ defaultMemPool;}}
\DoxyCodeLine{02845\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ on\ Windows,\ shutdown\ is\ synchronized\ via\ loader\ lock\ and\ isMallocInitialized().}}
\DoxyCodeLine{02846\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ See\ also\ \_\_TBB\_mallocProcessShutdownNotification()}}
\DoxyCodeLine{02847\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacerml_1_1internal_a775ef3ae8dd6b242d20f44ebd787a1be}{defaultMemPool}}-\/>onThreadShutdown(\mbox{\hyperlink{namespacerml_1_1internal_a775ef3ae8dd6b242d20f44ebd787a1be}{defaultMemPool}}-\/>getTLS(\textcolor{comment}{/*create=*/}\textcolor{keyword}{false}));}
\DoxyCodeLine{02848\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Take\ lock\ to\ walk\ through\ other\ pools;\ but\ waiting\ might\ be\ dangerous\ at\ this\ point}}
\DoxyCodeLine{02849\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ (e.g.\ on\ Windows\ the\ main\ thread\ might\ deadlock)}}
\DoxyCodeLine{02850\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ locked;}
\DoxyCodeLine{02851\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_malloc_mutex_1_1scoped__lock}{MallocMutex::scoped\_lock}}\ \mbox{\hyperlink{ittnotify__static_8h_a46e8be2e3aadb2f6ee62e762a36b9243}{lock}}(\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool_ae2f9869ec6e87cbdeabf13d365d49f62}{MemoryPool::memPoolListLock}},\ \textcolor{comment}{/*wait=*/}!main\_thread,\ \&locked);}
\DoxyCodeLine{02852\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (locked)\ \{\ \textcolor{comment}{//\ the\ list\ is\ safe\ to\ process}}
\DoxyCodeLine{02853\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{classrml_1_1internal_1_1_memory_pool}{MemoryPool}}\ *memPool\ =\ \mbox{\hyperlink{namespacerml_1_1internal_a775ef3ae8dd6b242d20f44ebd787a1be}{defaultMemPool}}-\/>next;\ memPool;\ memPool\ =\ memPool-\/>next)}
\DoxyCodeLine{02854\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ memPool-\/>onThreadShutdown(memPool-\/>getTLS(\textcolor{comment}{/*create=*/}\textcolor{keyword}{false}));}
\DoxyCodeLine{02855\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02856\ \ \ \ \ \}}
\DoxyCodeLine{02857\ }
\DoxyCodeLine{02858\ \ \ \ \ \mbox{\hyperlink{tbbmalloc__internal_8h_af1c1baacf37ff8d445664716b811ee39}{TRACEF}}((\ \textcolor{stringliteral}{"{}[ScalableMalloc\ trace]\ Thread\ id\ \%d\ blocks\ return\ end\(\backslash\)n"{}},\ \mbox{\hyperlink{namespacerml_1_1internal_a2877b2db91c23b8b7eb1d37891c40b2b}{getThreadId}}()\ ));}
\DoxyCodeLine{02859\ \}}
\DoxyCodeLine{02860\ }
\DoxyCodeLine{02861\ \textcolor{preprocessor}{\#if\ USE\_PTHREAD}}
\DoxyCodeLine{02862\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{frontend_8cpp_a80b659a5a1776ca131e47a7a68a2c4a3}{mallocThreadShutdownNotification}}(\textcolor{keywordtype}{void}*\ \mbox{\hyperlink{mimalloc_8h_ac9ca0390aa991912667416f6baf99e51}{arg}})}
\DoxyCodeLine{02863\ \{}
\DoxyCodeLine{02864\ \ \ \ \ \textcolor{comment}{//\ The\ routine\ is\ called\ for\ each\ pool\ (as\ TLS\ dtor)\ on\ each\ thread,\ except\ for\ the\ main\ thread}}
\DoxyCodeLine{02865\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{namespacerml_1_1internal_a61c4d632ea815cbeea8ed0ee72e06ac7}{isMallocInitialized}}())\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{02866\ \ \ \ \ \mbox{\hyperlink{frontend_8cpp_afc6b22a34f2f5ab48ef00dfc9bb82e00}{doThreadShutdownNotification}}((\mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data}{TLSData}}*)\mbox{\hyperlink{mimalloc_8h_ac9ca0390aa991912667416f6baf99e51}{arg}},\ \textcolor{keyword}{false});}
\DoxyCodeLine{02867\ \}}
\DoxyCodeLine{02868\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{02869\ \textcolor{keyword}{extern}\ \textcolor{stringliteral}{"{}C"{}}\ \textcolor{keywordtype}{void}\ \_\_TBB\_mallocThreadShutdownNotification()}
\DoxyCodeLine{02870\ \{}
\DoxyCodeLine{02871\ \ \ \ \ \textcolor{comment}{//\ The\ routine\ is\ called\ once\ per\ thread\ on\ Windows}}
\DoxyCodeLine{02872\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{namespacerml_1_1internal_a61c4d632ea815cbeea8ed0ee72e06ac7}{isMallocInitialized}}())\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{02873\ \ \ \ \ \mbox{\hyperlink{frontend_8cpp_afc6b22a34f2f5ab48ef00dfc9bb82e00}{doThreadShutdownNotification}}(\mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}},\ \textcolor{keyword}{false});}
\DoxyCodeLine{02874\ \}}
\DoxyCodeLine{02875\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02876\ }
\DoxyCodeLine{02877\ \textcolor{keyword}{extern}\ \textcolor{stringliteral}{"{}C"{}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{test__malloc__pure__c_8c_a665a2b0b2e2331f6a4687cb88c7dc239}{\_\_TBB\_mallocProcessShutdownNotification}}(\textcolor{keywordtype}{bool}\ windows\_process\_dying)}
\DoxyCodeLine{02878\ \{}
\DoxyCodeLine{02879\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{namespacerml_1_1internal_a61c4d632ea815cbeea8ed0ee72e06ac7}{isMallocInitialized}}())\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{02880\ }
\DoxyCodeLine{02881\ \ \ \ \ \textcolor{comment}{//\ Don't\ clean\ allocator\ internals\ if\ the\ entire\ process\ is\ exiting}}
\DoxyCodeLine{02882\ \ \ \ \ \textcolor{keywordflow}{if}\ (!windows\_process\_dying)\ \{}
\DoxyCodeLine{02883\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{frontend_8cpp_afc6b22a34f2f5ab48ef00dfc9bb82e00}{doThreadShutdownNotification}}(\mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}},\ \textcolor{comment}{/*main\_thread=*/}\textcolor{keyword}{true});}
\DoxyCodeLine{02884\ \ \ \ \ \}}
\DoxyCodeLine{02885\ \textcolor{preprocessor}{\#if\ \ \_\_TBB\_MALLOC\_LOCACHE\_STAT}}
\DoxyCodeLine{02886\ \ \ \ \ \mbox{\hyperlink{printf_8h_aee3ed3a831f25f07e7be3919fff2203a}{printf}}(\textcolor{stringliteral}{"{}cache\ hit\ ratio\ \%f,\ size\ hit\ \%f\(\backslash\)n"{}},}
\DoxyCodeLine{02887\ \ \ \ \ \ \ \ \ \ \ \ 1.*cacheHits/mallocCalls,\ 1.*memHitKB/memAllocKB);}
\DoxyCodeLine{02888\ \ \ \ \ \mbox{\hyperlink{namespacerml_1_1internal_a775ef3ae8dd6b242d20f44ebd787a1be}{defaultMemPool}}-\/>extMemPool.loc.reportStat(stdout);}
\DoxyCodeLine{02889\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02890\ }
\DoxyCodeLine{02891\ \ \ \ \ \mbox{\hyperlink{namespacerml_1_1internal_a93ecc803ce228488d5280172f0925c4a}{shutdownSync}}.processExit();}
\DoxyCodeLine{02892\ \textcolor{preprocessor}{\#if\ \_\_TBB\_SOURCE\_DIRECTLY\_INCLUDED}}
\DoxyCodeLine{02893\ \textcolor{comment}{/*\ Pthread\ keys\ must\ be\ deleted\ as\ soon\ as\ possible\ to\ not\ call\ key\ dtor}}
\DoxyCodeLine{02894\ \textcolor{comment}{\ \ \ on\ thread\ termination\ when\ then\ the\ tbbmalloc\ code\ can\ be\ already\ unloaded.}}
\DoxyCodeLine{02895\ \textcolor{comment}{*/}}
\DoxyCodeLine{02896\ \ \ \ \ \mbox{\hyperlink{namespacerml_1_1internal_a775ef3ae8dd6b242d20f44ebd787a1be}{defaultMemPool}}-\/>destroy();}
\DoxyCodeLine{02897\ \ \ \ \ \mbox{\hyperlink{namespacerml_1_1internal_aa12c65924c02c876057332f2f2d4df6b}{destroyBackRefMaster}}(\&\mbox{\hyperlink{namespacerml_1_1internal_a775ef3ae8dd6b242d20f44ebd787a1be}{defaultMemPool}}-\/>extMemPool.backend);}
\DoxyCodeLine{02898\ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_thread_id_ad5e9ae4af22d11ac614a530cdc3ad02f}{ThreadId::destroy}}();\ \ \ \ \ \ \textcolor{comment}{//\ Delete\ key\ for\ thread\ id}}
\DoxyCodeLine{02899\ \ \ \ \ \mbox{\hyperlink{namespacerml_1_1internal_a47aa4f0d1eb6a621e5830ea034495648}{hugePages}}.reset();}
\DoxyCodeLine{02900\ \ \ \ \ \textcolor{comment}{//\ new\ total\ malloc\ initialization\ is\ possible\ after\ this\ point}}
\DoxyCodeLine{02901\ \ \ \ \ \mbox{\hyperlink{_synchronize_8h_a19886ee3899c0a2435ea9840116ea325}{FencedStore}}(\mbox{\hyperlink{namespacerml_1_1internal_aff6ca9c05f9bd993c8b383d177c55b8e}{mallocInitialized}},\ 0);}
\DoxyCodeLine{02902\ \textcolor{preprocessor}{\#elif\ \_\_TBB\_USE\_DLOPEN\_REENTRANCY\_WORKAROUND}}
\DoxyCodeLine{02903\ \textcolor{comment}{/*\ In\ most\ cases\ we\ prevent\ unloading\ tbbmalloc,\ and\ don't\ clean\ up\ memory}}
\DoxyCodeLine{02904\ \textcolor{comment}{\ \ \ on\ process\ shutdown.\ When\ impossible\ to\ prevent,\ library\ unload\ results}}
\DoxyCodeLine{02905\ \textcolor{comment}{\ \ \ in\ shutdown\ notification,\ and\ it\ makes\ sense\ to\ release\ unused\ memory}}
\DoxyCodeLine{02906\ \textcolor{comment}{\ \ \ at\ that\ point\ (we\ can't\ release\ all\ memory\ because\ it's\ possible\ that}}
\DoxyCodeLine{02907\ \textcolor{comment}{\ \ \ it\ will\ be\ accessed\ after\ this\ point).}}
\DoxyCodeLine{02908\ \textcolor{comment}{\ \ \ TODO:\ better\ support\ systems\ where\ we\ can't\ prevent\ unloading\ by\ removing}}
\DoxyCodeLine{02909\ \textcolor{comment}{\ \ \ pthread\ destructors\ and\ releasing\ caches.}}
\DoxyCodeLine{02910\ \textcolor{comment}{\ */}}
\DoxyCodeLine{02911\ \ \ \ \ \mbox{\hyperlink{namespacerml_1_1internal_a775ef3ae8dd6b242d20f44ebd787a1be}{defaultMemPool}}-\/>extMemPool.hardCachesCleanup();}
\DoxyCodeLine{02912\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ \_\_TBB\_SOURCE\_DIRECTLY\_INCLUDED}}
\DoxyCodeLine{02913\ }
\DoxyCodeLine{02914\ \textcolor{preprocessor}{\#if\ COLLECT\_STATISTICS}}
\DoxyCodeLine{02915\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ nThreads\ =\ ThreadId::getMaxThreadId();}
\DoxyCodeLine{02916\ \ \ \ \ \textcolor{keywordflow}{for}(\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}=1;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}<=nThreads\ \&\&\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}<\mbox{\hyperlink{tbbmalloc_2statistics_8h_a8b5173357adb02a86c027316e0acdfa0}{MAX\_THREADS}};\ ++\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ )}
\DoxyCodeLine{02917\ \ \ \ \ \ \ \ \ STAT\_print(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}});}
\DoxyCodeLine{02918\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02919\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{namespacerml_1_1internal_adfef860fe0efd8df96bdddf72c66e7e2}{usedBySrcIncluded}})}
\DoxyCodeLine{02920\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_customize_8h_aa5c99d8e39de521b2be407fdd4568b04}{MALLOC\_ITT\_FINI\_ITTLIB}}();}
\DoxyCodeLine{02921\ \}}
\DoxyCodeLine{02922\ }
\DoxyCodeLine{02923\ \textcolor{keyword}{extern}\ \textcolor{stringliteral}{"{}C"{}}\ \textcolor{keywordtype}{void}\ *\ \mbox{\hyperlink{group__memory__allocation_ga2fcb23ca500304f69173dd13ad7e1389}{scalable\_malloc}}(\textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}})}
\DoxyCodeLine{02924\ \{}
\DoxyCodeLine{02925\ \ \ \ \ \textcolor{keywordtype}{void}\ *\mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}}\ =\ \mbox{\hyperlink{namespacerml_1_1internal_a19b0fbc5aaa4b08cc412bb5777b01f89}{internalMalloc}}(\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}});}
\DoxyCodeLine{02926\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}})\ errno\ =\ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_a6a05c923dad0c1208043e9c20a58c8e5}{ENOMEM}};}
\DoxyCodeLine{02927\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}};}
\DoxyCodeLine{02928\ \}}
\DoxyCodeLine{02929\ }
\DoxyCodeLine{02930\ \textcolor{keyword}{extern}\ \textcolor{stringliteral}{"{}C"{}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{group__memory__allocation_ga2ad3952b8c4dd7d293e02ae18fc37b84}{scalable\_free}}(\textcolor{keywordtype}{void}\ *\textcolor{keywordtype}{object})}
\DoxyCodeLine{02931\ \{}
\DoxyCodeLine{02932\ \ \ \ \ \mbox{\hyperlink{namespacerml_1_1internal_a91eeaa067e3fdf5618b5a65b8b368231}{internalFree}}(\textcolor{keywordtype}{object});}
\DoxyCodeLine{02933\ \}}
\DoxyCodeLine{02934\ }
\DoxyCodeLine{02935\ \textcolor{preprocessor}{\#if\ MALLOC\_ZONE\_OVERLOAD\_ENABLED}}
\DoxyCodeLine{02936\ \textcolor{keyword}{extern}\ \textcolor{stringliteral}{"{}C"{}}\ \textcolor{keywordtype}{void}\ \_\_TBB\_malloc\_free\_definite\_size(\textcolor{keywordtype}{void}\ *\textcolor{keywordtype}{object},\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}})}
\DoxyCodeLine{02937\ \{}
\DoxyCodeLine{02938\ \ \ \ \ \mbox{\hyperlink{namespacerml_1_1internal_a8bff2023b8463f38317c75980f21e0db}{internalPoolFree}}(\mbox{\hyperlink{namespacerml_1_1internal_a775ef3ae8dd6b242d20f44ebd787a1be}{defaultMemPool}},\ \textcolor{keywordtype}{object},\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}});}
\DoxyCodeLine{02939\ \}}
\DoxyCodeLine{02940\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02941\ }
\DoxyCodeLine{02942\ \textcolor{comment}{/*}}
\DoxyCodeLine{02943\ \textcolor{comment}{\ *\ A\ variant\ that\ provides\ additional\ memory\ safety,\ by\ checking\ whether\ the\ given\ address}}
\DoxyCodeLine{02944\ \textcolor{comment}{\ *\ was\ obtained\ with\ this\ allocator,\ and\ if\ not\ redirecting\ to\ the\ provided\ alternative\ call.}}
\DoxyCodeLine{02945\ \textcolor{comment}{\ */}}
\DoxyCodeLine{02946\ \textcolor{keyword}{extern}\ \textcolor{stringliteral}{"{}C"{}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{frontend_8cpp_a9652e20359376db6faf27d041605a9d6}{\_\_TBB\_malloc\_safer\_free}}(\textcolor{keywordtype}{void}\ *\textcolor{keywordtype}{object},\ \textcolor{keywordtype}{void}\ (*original\_free)(\textcolor{keywordtype}{void}*))}
\DoxyCodeLine{02947\ \{}
\DoxyCodeLine{02948\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\textcolor{keywordtype}{object})}
\DoxyCodeLine{02949\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{02950\ }
\DoxyCodeLine{02951\ \ \ \ \ \textcolor{comment}{//\ tbbmalloc\ can\ allocate\ object\ only\ when\ tbbmalloc\ has\ been\ initialized}}
\DoxyCodeLine{02952\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{_synchronize_8h_a0792980ea26344eaf2fc0a4112b5d848}{FencedLoad}}(\mbox{\hyperlink{namespacerml_1_1internal_aff6ca9c05f9bd993c8b383d177c55b8e}{mallocInitialized}})\ \&\&\ \mbox{\hyperlink{namespacerml_1_1internal_a775ef3ae8dd6b242d20f44ebd787a1be}{defaultMemPool}}-\/>extMemPool.backend.ptrCanBeValid(\textcolor{keywordtype}{object}))\ \{}
\DoxyCodeLine{02953\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacerml_1_1internal_a730f387568a0a522e003dca4246eb393}{isLargeObject<unknownMem>}}(\textcolor{keywordtype}{object}))\ \{}
\DoxyCodeLine{02954\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ must\ check\ 1st\ for\ large\ object,\ because\ small\ object\ check\ touches\ 4\ pages\ on\ left,}}
\DoxyCodeLine{02955\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ and\ it\ can\ be\ inaccessible}}
\DoxyCodeLine{02956\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data}{TLSData}}\ *tls\ =\ \mbox{\hyperlink{namespacerml_1_1internal_a775ef3ae8dd6b242d20f44ebd787a1be}{defaultMemPool}}-\/>getTLS(\textcolor{comment}{/*create=*/}\textcolor{keyword}{false});}
\DoxyCodeLine{02957\ }
\DoxyCodeLine{02958\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacerml_1_1internal_a775ef3ae8dd6b242d20f44ebd787a1be}{defaultMemPool}}-\/>putToLLOCache(tls,\ \textcolor{keywordtype}{object});}
\DoxyCodeLine{02959\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{02960\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacerml_1_1internal_a44371ad68e0e7931776e8e128764ae79}{isSmallObject}}(\textcolor{keywordtype}{object}))\ \{}
\DoxyCodeLine{02961\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacerml_1_1internal_adeac248637575859a6e8f733ba15060e}{freeSmallObject}}(\textcolor{keywordtype}{object});}
\DoxyCodeLine{02962\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{02963\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02964\ \ \ \ \ \}}
\DoxyCodeLine{02965\ \ \ \ \ \textcolor{keywordflow}{if}\ (original\_free)}
\DoxyCodeLine{02966\ \ \ \ \ \ \ \ \ original\_free(\textcolor{keywordtype}{object});}
\DoxyCodeLine{02967\ \}}
\DoxyCodeLine{02968\ }
\DoxyCodeLine{02969\ \textcolor{comment}{/*********\ End\ the\ free\ code\ \ \ \ \ \ \ \ *************/}}
\DoxyCodeLine{02970\ }
\DoxyCodeLine{02971\ \textcolor{comment}{/*********\ Code\ for\ scalable\_realloc\ \ \ \ \ \ \ ***********/}}
\DoxyCodeLine{02972\ }
\DoxyCodeLine{02973\ \textcolor{comment}{/*}}
\DoxyCodeLine{02974\ \textcolor{comment}{\ *\ From\ K\&R}}
\DoxyCodeLine{02975\ \textcolor{comment}{\ *\ "{}realloc\ changes\ the\ size\ of\ the\ object\ pointed\ to\ by\ p\ to\ size.\ The\ contents\ will}}
\DoxyCodeLine{02976\ \textcolor{comment}{\ *\ be\ unchanged\ up\ to\ the\ minimum\ of\ the\ old\ and\ the\ new\ sizes.\ If\ the\ new\ size\ is\ larger,}}
\DoxyCodeLine{02977\ \textcolor{comment}{\ *\ the\ new\ space\ is\ uninitialized.\ realloc\ returns\ a\ pointer\ to\ the\ new\ space,\ or}}
\DoxyCodeLine{02978\ \textcolor{comment}{\ *\ NULL\ if\ the\ request\ cannot\ be\ satisfied,\ in\ which\ case\ *p\ is\ unchanged."{}}}
\DoxyCodeLine{02979\ \textcolor{comment}{\ *}}
\DoxyCodeLine{02980\ \textcolor{comment}{\ */}}
\DoxyCodeLine{02981\ \textcolor{keyword}{extern}\ \textcolor{stringliteral}{"{}C"{}}\ \textcolor{keywordtype}{void}*\ \mbox{\hyperlink{group__memory__allocation_gac93d16776afe558dd518dc3ef69a4897}{scalable\_realloc}}(\textcolor{keywordtype}{void}*\ \mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}},\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}})}
\DoxyCodeLine{02982\ \{}
\DoxyCodeLine{02983\ \ \ \ \ \textcolor{keywordtype}{void}\ *tmp;}
\DoxyCodeLine{02984\ }
\DoxyCodeLine{02985\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}})}
\DoxyCodeLine{02986\ \ \ \ \ \ \ \ \ tmp\ =\ \mbox{\hyperlink{namespacerml_1_1internal_a19b0fbc5aaa4b08cc412bb5777b01f89}{internalMalloc}}(\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}});}
\DoxyCodeLine{02987\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}})\ \{}
\DoxyCodeLine{02988\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacerml_1_1internal_a91eeaa067e3fdf5618b5a65b8b368231}{internalFree}}(\mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}});}
\DoxyCodeLine{02989\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{02990\ \ \ \ \ \}\ \textcolor{keywordflow}{else}}
\DoxyCodeLine{02991\ \ \ \ \ \ \ \ \ tmp\ =\ \mbox{\hyperlink{namespacerml_1_1internal_a288f89b97757684760f283c91dbe8add}{reallocAligned}}(\mbox{\hyperlink{namespacerml_1_1internal_a775ef3ae8dd6b242d20f44ebd787a1be}{defaultMemPool}},\ \mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}},\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}},\ 0);}
\DoxyCodeLine{02992\ }
\DoxyCodeLine{02993\ \ \ \ \ \textcolor{keywordflow}{if}\ (!tmp)\ errno\ =\ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_a6a05c923dad0c1208043e9c20a58c8e5}{ENOMEM}};}
\DoxyCodeLine{02994\ \ \ \ \ \textcolor{keywordflow}{return}\ tmp;}
\DoxyCodeLine{02995\ \}}
\DoxyCodeLine{02996\ }
\DoxyCodeLine{02997\ \textcolor{comment}{/*}}
\DoxyCodeLine{02998\ \textcolor{comment}{\ *\ A\ variant\ that\ provides\ additional\ memory\ safety,\ by\ checking\ whether\ the\ given\ address}}
\DoxyCodeLine{02999\ \textcolor{comment}{\ *\ was\ obtained\ with\ this\ allocator,\ and\ if\ not\ redirecting\ to\ the\ provided\ alternative\ call.}}
\DoxyCodeLine{03000\ \textcolor{comment}{\ */}}
\DoxyCodeLine{03001\ \textcolor{keyword}{extern}\ \textcolor{stringliteral}{"{}C"{}}\ \textcolor{keywordtype}{void}*\ \mbox{\hyperlink{frontend_8cpp_a98a438ff58321dad89ceef80156318e1}{\_\_TBB\_malloc\_safer\_realloc}}(\textcolor{keywordtype}{void}*\ \mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}},\ \textcolor{keywordtype}{size\_t}\ sz,\ \textcolor{keywordtype}{void}*\ original\_realloc)}
\DoxyCodeLine{03002\ \{}
\DoxyCodeLine{03003\ \ \ \ \ \textcolor{keywordtype}{void}\ *tmp;\ \textcolor{comment}{//\ TODO:\ fix\ warnings\ about\ uninitialized\ use\ of\ tmp}}
\DoxyCodeLine{03004\ }
\DoxyCodeLine{03005\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}})\ \{}
\DoxyCodeLine{03006\ \ \ \ \ \ \ \ \ tmp\ =\ \mbox{\hyperlink{namespacerml_1_1internal_a19b0fbc5aaa4b08cc412bb5777b01f89}{internalMalloc}}(sz);}
\DoxyCodeLine{03007\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{_synchronize_8h_a0792980ea26344eaf2fc0a4112b5d848}{FencedLoad}}(\mbox{\hyperlink{namespacerml_1_1internal_aff6ca9c05f9bd993c8b383d177c55b8e}{mallocInitialized}})\ \&\&\ \mbox{\hyperlink{namespacerml_1_1internal_abe52e5f71a9571929c11e06738d0864f}{isRecognized}}(\mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}}))\ \{}
\DoxyCodeLine{03008\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!sz)\ \{}
\DoxyCodeLine{03009\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacerml_1_1internal_a91eeaa067e3fdf5618b5a65b8b368231}{internalFree}}(\mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}});}
\DoxyCodeLine{03010\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{03011\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{03012\ \ \ \ \ \ \ \ \ \ \ \ \ tmp\ =\ \mbox{\hyperlink{namespacerml_1_1internal_a288f89b97757684760f283c91dbe8add}{reallocAligned}}(\mbox{\hyperlink{namespacerml_1_1internal_a775ef3ae8dd6b242d20f44ebd787a1be}{defaultMemPool}},\ \mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}},\ sz,\ 0);}
\DoxyCodeLine{03013\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03014\ \ \ \ \ \}}
\DoxyCodeLine{03015\ \textcolor{preprocessor}{\#if\ USE\_WINTHREAD}}
\DoxyCodeLine{03016\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (original\_realloc\ \&\&\ sz)\ \{}
\DoxyCodeLine{03017\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structorig__ptrs}{orig\_ptrs}}\ *original\_ptrs\ =\ \textcolor{keyword}{static\_cast<}\mbox{\hyperlink{structorig__ptrs}{orig\_ptrs}}*\textcolor{keyword}{>}(original\_realloc);}
\DoxyCodeLine{03018\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\ original\_ptrs-\/>\mbox{\hyperlink{structorig__ptrs_aa99d27013c3dea9a794c4ec5232ddc3b}{msize}}\ )\{}
\DoxyCodeLine{03019\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ oldSize\ =\ original\_ptrs-\/>\mbox{\hyperlink{structorig__ptrs_aa99d27013c3dea9a794c4ec5232ddc3b}{msize}}(\mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}});}
\DoxyCodeLine{03020\ \ \ \ \ \ \ \ \ \ \ \ \ tmp\ =\ \mbox{\hyperlink{namespacerml_1_1internal_a19b0fbc5aaa4b08cc412bb5777b01f89}{internalMalloc}}(sz);}
\DoxyCodeLine{03021\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (tmp)\ \{}
\DoxyCodeLine{03022\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ memcpy(tmp,\ \mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}},\ sz<oldSize?\ sz\ :\ oldSize);}
\DoxyCodeLine{03023\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\ original\_ptrs-\/>\mbox{\hyperlink{structorig__ptrs_a60e7abed304a4b13c1e8e4556fc4c917}{free}}\ )\{}
\DoxyCodeLine{03024\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ original\_ptrs-\/>\mbox{\hyperlink{structorig__ptrs_a60e7abed304a4b13c1e8e4556fc4c917}{free}}(\ \mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}}\ );}
\DoxyCodeLine{03025\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03026\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03027\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}}
\DoxyCodeLine{03028\ \ \ \ \ \ \ \ \ \ \ \ \ tmp\ =\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{03029\ \ \ \ \ \}}
\DoxyCodeLine{03030\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{03031\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (original\_realloc)\ \{}
\DoxyCodeLine{03032\ \ \ \ \ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keywordtype}{void}*\ (*realloc\_ptr\_t)(\textcolor{keywordtype}{void}*,size\_t);}
\DoxyCodeLine{03033\ \ \ \ \ \ \ \ \ realloc\_ptr\_t\ original\_realloc\_ptr;}
\DoxyCodeLine{03034\ \ \ \ \ \ \ \ \ (\textcolor{keywordtype}{void}\ *\&)original\_realloc\_ptr\ =\ original\_realloc;}
\DoxyCodeLine{03035\ \ \ \ \ \ \ \ \ tmp\ =\ original\_realloc\_ptr(\mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}},sz);}
\DoxyCodeLine{03036\ \ \ \ \ \}}
\DoxyCodeLine{03037\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03038\ \ \ \ \ \textcolor{keywordflow}{else}\ tmp\ =\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{03039\ }
\DoxyCodeLine{03040\ \ \ \ \ \textcolor{keywordflow}{if}\ (!tmp)\ errno\ =\ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_a6a05c923dad0c1208043e9c20a58c8e5}{ENOMEM}};}
\DoxyCodeLine{03041\ \ \ \ \ \textcolor{keywordflow}{return}\ tmp;}
\DoxyCodeLine{03042\ \}}
\DoxyCodeLine{03043\ }
\DoxyCodeLine{03044\ \textcolor{comment}{/*********\ End\ code\ for\ scalable\_realloc\ \ \ ***********/}}
\DoxyCodeLine{03045\ }
\DoxyCodeLine{03046\ \textcolor{comment}{/*********\ Code\ for\ scalable\_calloc\ \ \ ***********/}}
\DoxyCodeLine{03047\ }
\DoxyCodeLine{03048\ \textcolor{comment}{/*}}
\DoxyCodeLine{03049\ \textcolor{comment}{\ *\ From\ K\&R}}
\DoxyCodeLine{03050\ \textcolor{comment}{\ *\ calloc\ returns\ a\ pointer\ to\ space\ for\ an\ array\ of\ nobj\ objects,}}
\DoxyCodeLine{03051\ \textcolor{comment}{\ *\ each\ of\ size\ size,\ or\ NULL\ if\ the\ request\ cannot\ be\ satisfied.}}
\DoxyCodeLine{03052\ \textcolor{comment}{\ *\ The\ space\ is\ initialized\ to\ zero\ bytes.}}
\DoxyCodeLine{03053\ \textcolor{comment}{\ *}}
\DoxyCodeLine{03054\ \textcolor{comment}{\ */}}
\DoxyCodeLine{03055\ }
\DoxyCodeLine{03056\ \textcolor{keyword}{extern}\ \textcolor{stringliteral}{"{}C"{}}\ \textcolor{keywordtype}{void}\ *\ \mbox{\hyperlink{group__memory__allocation_gadfc348601c072ba491c9efb1a9d62c2e}{scalable\_calloc}}(\textcolor{keywordtype}{size\_t}\ nobj,\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}})}
\DoxyCodeLine{03057\ \{}
\DoxyCodeLine{03058\ \ \ \ \ \textcolor{comment}{//\ it's\ square\ root\ of\ maximal\ size\_t\ value}}
\DoxyCodeLine{03059\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ mult\_not\_overflow\ =\ size\_t(1)\ <<\ (\textcolor{keyword}{sizeof}(size\_t)*CHAR\_BIT/2);}
\DoxyCodeLine{03060\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ arraySize\ =\ nobj\ *\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}};}
\DoxyCodeLine{03061\ }
\DoxyCodeLine{03062\ \ \ \ \ \textcolor{comment}{//\ check\ for\ overflow\ during\ multiplication:}}
\DoxyCodeLine{03063\ \ \ \ \ \textcolor{keywordflow}{if}\ (nobj>=mult\_not\_overflow\ ||\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}}>=mult\_not\_overflow)\ \textcolor{comment}{//\ 1)\ heuristic\ check}}
\DoxyCodeLine{03064\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (nobj\ \&\&\ arraySize\ /\ nobj\ !=\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}})\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ 2)\ exact\ check}}
\DoxyCodeLine{03065\ \ \ \ \ \ \ \ \ \ \ \ \ errno\ =\ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_a6a05c923dad0c1208043e9c20a58c8e5}{ENOMEM}};}
\DoxyCodeLine{03066\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{03067\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03068\ \ \ \ \ \textcolor{keywordtype}{void}*\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}}\ =\ \mbox{\hyperlink{namespacerml_1_1internal_a19b0fbc5aaa4b08cc412bb5777b01f89}{internalMalloc}}(arraySize);}
\DoxyCodeLine{03069\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}})}
\DoxyCodeLine{03070\ \ \ \ \ \ \ \ \ memset(\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}},\ 0,\ arraySize);}
\DoxyCodeLine{03071\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{03072\ \ \ \ \ \ \ \ \ errno\ =\ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_a6a05c923dad0c1208043e9c20a58c8e5}{ENOMEM}};}
\DoxyCodeLine{03073\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}};}
\DoxyCodeLine{03074\ \}}
\DoxyCodeLine{03075\ }
\DoxyCodeLine{03076\ \textcolor{comment}{/*********\ End\ code\ for\ scalable\_calloc\ \ \ ***********/}}
\DoxyCodeLine{03077\ }
\DoxyCodeLine{03078\ \textcolor{comment}{/*********\ Code\ for\ aligned\ allocation\ API\ **********/}}
\DoxyCodeLine{03079\ }
\DoxyCodeLine{03080\ \textcolor{keyword}{extern}\ \textcolor{stringliteral}{"{}C"{}}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{group__memory__allocation_gaf117b4994f719d539804da8dd115e28c}{scalable\_posix\_memalign}}(\textcolor{keywordtype}{void}\ **memptr,\ \textcolor{keywordtype}{size\_t}\ alignment,\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}})}
\DoxyCodeLine{03081\ \{}
\DoxyCodeLine{03082\ \ \ \ \ \textcolor{keywordflow}{if}\ (\ !\mbox{\hyperlink{_customize_8h_ad115b9282f1963612960057de0fb0bdb}{isPowerOfTwoAtLeast}}(alignment,\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{void}*))\ )}
\DoxyCodeLine{03083\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_a2d1678d5a7cc8ce499643f3b8957def4}{EINVAL}};}
\DoxyCodeLine{03084\ \ \ \ \ \textcolor{keywordtype}{void}\ *\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}}\ =\ \mbox{\hyperlink{namespacerml_1_1internal_a8de88aa18618ca387871e41654bef552}{allocateAligned}}(\mbox{\hyperlink{namespacerml_1_1internal_a775ef3ae8dd6b242d20f44ebd787a1be}{defaultMemPool}},\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}},\ alignment);}
\DoxyCodeLine{03085\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}})}
\DoxyCodeLine{03086\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_a6a05c923dad0c1208043e9c20a58c8e5}{ENOMEM}};}
\DoxyCodeLine{03087\ \ \ \ \ *memptr\ =\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}};}
\DoxyCodeLine{03088\ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{03089\ \}}
\DoxyCodeLine{03090\ }
\DoxyCodeLine{03091\ \textcolor{keyword}{extern}\ \textcolor{stringliteral}{"{}C"{}}\ \textcolor{keywordtype}{void}\ *\ \mbox{\hyperlink{group__memory__allocation_gaabbb96e401f5505e6c1a4a5f40f8ef13}{scalable\_aligned\_malloc}}(\textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}},\ \textcolor{keywordtype}{size\_t}\ alignment)}
\DoxyCodeLine{03092\ \{}
\DoxyCodeLine{03093\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{_customize_8h_acd7827300d6ae7b109ba374f9fd9e7dd}{isPowerOfTwo}}(alignment)\ ||\ 0==\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}})\ \{}
\DoxyCodeLine{03094\ \ \ \ \ \ \ \ \ errno\ =\ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_a2d1678d5a7cc8ce499643f3b8957def4}{EINVAL}};}
\DoxyCodeLine{03095\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{03096\ \ \ \ \ \}}
\DoxyCodeLine{03097\ \ \ \ \ \textcolor{keywordtype}{void}\ *tmp\ =\ \mbox{\hyperlink{namespacerml_1_1internal_a8de88aa18618ca387871e41654bef552}{allocateAligned}}(\mbox{\hyperlink{namespacerml_1_1internal_a775ef3ae8dd6b242d20f44ebd787a1be}{defaultMemPool}},\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}},\ alignment);}
\DoxyCodeLine{03098\ \ \ \ \ \textcolor{keywordflow}{if}\ (!tmp)\ errno\ =\ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_a6a05c923dad0c1208043e9c20a58c8e5}{ENOMEM}};}
\DoxyCodeLine{03099\ \ \ \ \ \textcolor{keywordflow}{return}\ tmp;}
\DoxyCodeLine{03100\ \}}
\DoxyCodeLine{03101\ }
\DoxyCodeLine{03102\ \textcolor{keyword}{extern}\ \textcolor{stringliteral}{"{}C"{}}\ \textcolor{keywordtype}{void}\ *\ \mbox{\hyperlink{group__memory__allocation_ga374519dcf7776bf866f3a8df0ee2a088}{scalable\_aligned\_realloc}}(\textcolor{keywordtype}{void}\ *\mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}},\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}},\ \textcolor{keywordtype}{size\_t}\ alignment)}
\DoxyCodeLine{03103\ \{}
\DoxyCodeLine{03104\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{_customize_8h_acd7827300d6ae7b109ba374f9fd9e7dd}{isPowerOfTwo}}(alignment))\ \{}
\DoxyCodeLine{03105\ \ \ \ \ \ \ \ \ errno\ =\ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_a2d1678d5a7cc8ce499643f3b8957def4}{EINVAL}};}
\DoxyCodeLine{03106\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{03107\ \ \ \ \ \}}
\DoxyCodeLine{03108\ \ \ \ \ \textcolor{keywordtype}{void}\ *tmp;}
\DoxyCodeLine{03109\ }
\DoxyCodeLine{03110\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}})}
\DoxyCodeLine{03111\ \ \ \ \ \ \ \ \ tmp\ =\ \mbox{\hyperlink{namespacerml_1_1internal_a8de88aa18618ca387871e41654bef552}{allocateAligned}}(\mbox{\hyperlink{namespacerml_1_1internal_a775ef3ae8dd6b242d20f44ebd787a1be}{defaultMemPool}},\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}},\ alignment);}
\DoxyCodeLine{03112\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}})\ \{}
\DoxyCodeLine{03113\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{group__memory__allocation_ga2ad3952b8c4dd7d293e02ae18fc37b84}{scalable\_free}}(\mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}});}
\DoxyCodeLine{03114\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{03115\ \ \ \ \ \}\ \textcolor{keywordflow}{else}}
\DoxyCodeLine{03116\ \ \ \ \ \ \ \ \ tmp\ =\ \mbox{\hyperlink{namespacerml_1_1internal_a288f89b97757684760f283c91dbe8add}{reallocAligned}}(\mbox{\hyperlink{namespacerml_1_1internal_a775ef3ae8dd6b242d20f44ebd787a1be}{defaultMemPool}},\ \mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}},\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}},\ alignment);}
\DoxyCodeLine{03117\ }
\DoxyCodeLine{03118\ \ \ \ \ \textcolor{keywordflow}{if}\ (!tmp)\ errno\ =\ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_a6a05c923dad0c1208043e9c20a58c8e5}{ENOMEM}};}
\DoxyCodeLine{03119\ \ \ \ \ \textcolor{keywordflow}{return}\ tmp;}
\DoxyCodeLine{03120\ \}}
\DoxyCodeLine{03121\ }
\DoxyCodeLine{03122\ \textcolor{keyword}{extern}\ \textcolor{stringliteral}{"{}C"{}}\ \textcolor{keywordtype}{void}\ *\ \mbox{\hyperlink{frontend_8cpp_af687fab85b0c684c24edf7fd7241cd52}{\_\_TBB\_malloc\_safer\_aligned\_realloc}}(\textcolor{keywordtype}{void}\ *\mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}},\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}},\ \textcolor{keywordtype}{size\_t}\ alignment,\ \textcolor{keywordtype}{void}*\ orig\_function)}
\DoxyCodeLine{03123\ \{}
\DoxyCodeLine{03124\ \ \ \ \ \textcolor{comment}{/*\ corner\ cases\ left\ out\ of\ reallocAligned\ to\ not\ deal\ with\ errno\ there\ */}}
\DoxyCodeLine{03125\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{_customize_8h_acd7827300d6ae7b109ba374f9fd9e7dd}{isPowerOfTwo}}(alignment))\ \{}
\DoxyCodeLine{03126\ \ \ \ \ \ \ \ \ errno\ =\ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_a2d1678d5a7cc8ce499643f3b8957def4}{EINVAL}};}
\DoxyCodeLine{03127\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{03128\ \ \ \ \ \}}
\DoxyCodeLine{03129\ \ \ \ \ \textcolor{keywordtype}{void}\ *tmp\ =\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{03130\ }
\DoxyCodeLine{03131\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}})\ \{}
\DoxyCodeLine{03132\ \ \ \ \ \ \ \ \ tmp\ =\ \mbox{\hyperlink{namespacerml_1_1internal_a8de88aa18618ca387871e41654bef552}{allocateAligned}}(\mbox{\hyperlink{namespacerml_1_1internal_a775ef3ae8dd6b242d20f44ebd787a1be}{defaultMemPool}},\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}},\ alignment);}
\DoxyCodeLine{03133\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{_synchronize_8h_a0792980ea26344eaf2fc0a4112b5d848}{FencedLoad}}(\mbox{\hyperlink{namespacerml_1_1internal_aff6ca9c05f9bd993c8b383d177c55b8e}{mallocInitialized}})\ \&\&\ \mbox{\hyperlink{namespacerml_1_1internal_abe52e5f71a9571929c11e06738d0864f}{isRecognized}}(\mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}}))\ \{}
\DoxyCodeLine{03134\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}})\ \{}
\DoxyCodeLine{03135\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacerml_1_1internal_a91eeaa067e3fdf5618b5a65b8b368231}{internalFree}}(\mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}});}
\DoxyCodeLine{03136\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{03137\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{03138\ \ \ \ \ \ \ \ \ \ \ \ \ tmp\ =\ \mbox{\hyperlink{namespacerml_1_1internal_a288f89b97757684760f283c91dbe8add}{reallocAligned}}(\mbox{\hyperlink{namespacerml_1_1internal_a775ef3ae8dd6b242d20f44ebd787a1be}{defaultMemPool}},\ \mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}},\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}},\ alignment);}
\DoxyCodeLine{03139\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03140\ \ \ \ \ \}}
\DoxyCodeLine{03141\ \textcolor{preprocessor}{\#if\ USE\_WINTHREAD}}
\DoxyCodeLine{03142\ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{03143\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structorig__aligned__ptrs}{orig\_aligned\_ptrs}}\ *original\_ptrs\ =\ \textcolor{keyword}{static\_cast<}\mbox{\hyperlink{structorig__aligned__ptrs}{orig\_aligned\_ptrs}}*\textcolor{keyword}{>}(orig\_function);}
\DoxyCodeLine{03144\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}})\ \{}
\DoxyCodeLine{03145\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Without\ orig\_msize,\ we\ can't\ do\ anything\ with\ this.}}
\DoxyCodeLine{03146\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Just\ keeping\ old\ pointer.}}
\DoxyCodeLine{03147\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\ original\_ptrs-\/>\mbox{\hyperlink{structorig__aligned__ptrs_a84de5ae83b684cd42080c2086b3ff2ed}{aligned\_msize}}\ )\{}
\DoxyCodeLine{03148\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ set\ alignment\ and\ offset\ to\ have\ possibly\ correct\ oldSize}}
\DoxyCodeLine{03149\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ oldSize\ =\ original\_ptrs-\/>\mbox{\hyperlink{structorig__aligned__ptrs_a84de5ae83b684cd42080c2086b3ff2ed}{aligned\_msize}}(\mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}},\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{void}*),\ 0);}
\DoxyCodeLine{03150\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tmp\ =\ \mbox{\hyperlink{namespacerml_1_1internal_a8de88aa18618ca387871e41654bef552}{allocateAligned}}(\mbox{\hyperlink{namespacerml_1_1internal_a775ef3ae8dd6b242d20f44ebd787a1be}{defaultMemPool}},\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}},\ alignment);}
\DoxyCodeLine{03151\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (tmp)\ \{}
\DoxyCodeLine{03152\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ memcpy(tmp,\ \mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}},\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}}<oldSize?\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}}\ :\ oldSize);}
\DoxyCodeLine{03153\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\ original\_ptrs-\/>\mbox{\hyperlink{structorig__aligned__ptrs_afbae0f7307fc17da9117faa286d93a50}{aligned\_free}}\ )\{}
\DoxyCodeLine{03154\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ original\_ptrs-\/>\mbox{\hyperlink{structorig__aligned__ptrs_afbae0f7307fc17da9117faa286d93a50}{aligned\_free}}(\ \mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}}\ );}
\DoxyCodeLine{03155\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03156\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03157\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03158\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{03159\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\ original\_ptrs-\/>\mbox{\hyperlink{structorig__aligned__ptrs_afbae0f7307fc17da9117faa286d93a50}{aligned\_free}}\ )\{}
\DoxyCodeLine{03160\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ original\_ptrs-\/>\mbox{\hyperlink{structorig__aligned__ptrs_afbae0f7307fc17da9117faa286d93a50}{aligned\_free}}(\ \mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}}\ );}
\DoxyCodeLine{03161\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03162\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{eabase_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{03163\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03164\ \ \ \ \ \}}
\DoxyCodeLine{03165\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{03166\ \ \ \ \ \textcolor{comment}{//\ As\ original\_realloc\ can't\ align\ result,\ and\ there\ is\ no\ way\ to\ find}}
\DoxyCodeLine{03167\ \ \ \ \ \textcolor{comment}{//\ size\ of\ reallocating\ object,\ we\ are\ giving\ up.}}
\DoxyCodeLine{03168\ \ \ \ \ \mbox{\hyperlink{namespacerml_1_1internal_acf3df9c7e1c2baec44e3dab2d8f1ee42}{suppress\_unused\_warning}}(orig\_function);}
\DoxyCodeLine{03169\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03170\ \ \ \ \ \textcolor{keywordflow}{if}\ (!tmp)\ errno\ =\ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_a6a05c923dad0c1208043e9c20a58c8e5}{ENOMEM}};}
\DoxyCodeLine{03171\ \ \ \ \ \textcolor{keywordflow}{return}\ tmp;}
\DoxyCodeLine{03172\ \}}
\DoxyCodeLine{03173\ }
\DoxyCodeLine{03174\ \textcolor{keyword}{extern}\ \textcolor{stringliteral}{"{}C"{}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{group__memory__allocation_gad9aa7595581a7bc5be193d7e034c8f61}{scalable\_aligned\_free}}(\textcolor{keywordtype}{void}\ *\mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}})}
\DoxyCodeLine{03175\ \{}
\DoxyCodeLine{03176\ \ \ \ \ \mbox{\hyperlink{namespacerml_1_1internal_a91eeaa067e3fdf5618b5a65b8b368231}{internalFree}}(\mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}});}
\DoxyCodeLine{03177\ \}}
\DoxyCodeLine{03178\ }
\DoxyCodeLine{03179\ \textcolor{comment}{/*********\ end\ code\ for\ aligned\ allocation\ API\ **********/}}
\DoxyCodeLine{03180\ }
\DoxyCodeLine{03181\ \textcolor{comment}{/*********\ Code\ for\ scalable\_msize\ \ \ \ \ \ \ ***********/}}
\DoxyCodeLine{03182\ }
\DoxyCodeLine{03183\ \textcolor{comment}{/*}}
\DoxyCodeLine{03184\ \textcolor{comment}{\ *\ Returns\ the\ size\ of\ a\ memory\ block\ allocated\ in\ the\ heap.}}
\DoxyCodeLine{03185\ \textcolor{comment}{\ */}}
\DoxyCodeLine{03186\ \textcolor{keyword}{extern}\ \textcolor{stringliteral}{"{}C"{}}\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{group__memory__allocation_ga2b718206e50acb6392b86e4877d98213}{scalable\_msize}}(\textcolor{keywordtype}{void}*\ \mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}})}
\DoxyCodeLine{03187\ \{}
\DoxyCodeLine{03188\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}})\ \{}
\DoxyCodeLine{03189\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_customize_8h_ab07698dd675204d120111c1300b4185c}{MALLOC\_ASSERT}}(\mbox{\hyperlink{namespacerml_1_1internal_abe52e5f71a9571929c11e06738d0864f}{isRecognized}}(\mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}}),\ \textcolor{stringliteral}{"{}Invalid\ pointer\ in\ scalable\_msize\ detected."{}});}
\DoxyCodeLine{03190\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacerml_1_1internal_a2687be7826e3608802f99d6d2d63f748}{internalMsize}}(\mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}});}
\DoxyCodeLine{03191\ \ \ \ \ \}}
\DoxyCodeLine{03192\ \ \ \ \ errno\ =\ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_a2d1678d5a7cc8ce499643f3b8957def4}{EINVAL}};}
\DoxyCodeLine{03193\ \ \ \ \ \textcolor{comment}{//\ Unlike\ \_msize,\ return\ 0\ in\ case\ of\ parameter\ error.}}
\DoxyCodeLine{03194\ \ \ \ \ \textcolor{comment}{//\ Returning\ size\_t(-\/1)\ looks\ more\ like\ the\ way\ to\ troubles.}}
\DoxyCodeLine{03195\ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{03196\ \}}
\DoxyCodeLine{03197\ }
\DoxyCodeLine{03198\ \textcolor{comment}{/*}}
\DoxyCodeLine{03199\ \textcolor{comment}{\ *\ A\ variant\ that\ provides\ additional\ memory\ safety,\ by\ checking\ whether\ the\ given\ address}}
\DoxyCodeLine{03200\ \textcolor{comment}{\ *\ was\ obtained\ with\ this\ allocator,\ and\ if\ not\ redirecting\ to\ the\ provided\ alternative\ call.}}
\DoxyCodeLine{03201\ \textcolor{comment}{\ */}}
\DoxyCodeLine{03202\ \textcolor{keyword}{extern}\ \textcolor{stringliteral}{"{}C"{}}\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{frontend_8cpp_a1880626319a708ab26ef0d5af087fbef}{\_\_TBB\_malloc\_safer\_msize}}(\textcolor{keywordtype}{void}\ *\textcolor{keywordtype}{object},\ \textcolor{keywordtype}{size\_t}\ (*original\_msize)(\textcolor{keywordtype}{void}*))}
\DoxyCodeLine{03203\ \{}
\DoxyCodeLine{03204\ \ \ \ \ \textcolor{keywordflow}{if}\ (\textcolor{keywordtype}{object})\ \{}
\DoxyCodeLine{03205\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Check\ if\ the\ memory\ was\ allocated\ by\ scalable\_malloc}}
\DoxyCodeLine{03206\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{_synchronize_8h_a0792980ea26344eaf2fc0a4112b5d848}{FencedLoad}}(\mbox{\hyperlink{namespacerml_1_1internal_aff6ca9c05f9bd993c8b383d177c55b8e}{mallocInitialized}})\ \&\&\ \mbox{\hyperlink{namespacerml_1_1internal_abe52e5f71a9571929c11e06738d0864f}{isRecognized}}(\textcolor{keywordtype}{object}))}
\DoxyCodeLine{03207\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacerml_1_1internal_a2687be7826e3608802f99d6d2d63f748}{internalMsize}}(\textcolor{keywordtype}{object});}
\DoxyCodeLine{03208\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (original\_msize)}
\DoxyCodeLine{03209\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ original\_msize(\textcolor{keywordtype}{object});}
\DoxyCodeLine{03210\ \ \ \ \ \}}
\DoxyCodeLine{03211\ \ \ \ \ \textcolor{comment}{//\ object\ is\ NULL\ or\ unknown,\ or\ foreign\ and\ no\ original\_msize}}
\DoxyCodeLine{03212\ \textcolor{preprocessor}{\#if\ USE\_WINTHREAD}}
\DoxyCodeLine{03213\ \ \ \ \ errno\ =\ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_a2d1678d5a7cc8ce499643f3b8957def4}{EINVAL}};\ \textcolor{comment}{//\ errno\ expected\ to\ be\ set\ only\ on\ this\ platform}}
\DoxyCodeLine{03214\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03215\ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{03216\ \}}
\DoxyCodeLine{03217\ }
\DoxyCodeLine{03218\ \textcolor{comment}{/*}}
\DoxyCodeLine{03219\ \textcolor{comment}{\ *\ The\ same\ as\ above\ but\ for\ \_aligned\_msize\ case}}
\DoxyCodeLine{03220\ \textcolor{comment}{\ */}}
\DoxyCodeLine{03221\ \textcolor{keyword}{extern}\ \textcolor{stringliteral}{"{}C"{}}\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{frontend_8cpp_a6bb912681e485d8954cc83856fd11d6c}{\_\_TBB\_malloc\_safer\_aligned\_msize}}(\textcolor{keywordtype}{void}\ *\textcolor{keywordtype}{object},\ \textcolor{keywordtype}{size\_t}\ alignment,\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ae1b92ae085ddef4b1cdca7d749339fb0}{offset}},\ \textcolor{keywordtype}{size\_t}\ (*orig\_aligned\_msize)(\textcolor{keywordtype}{void}*,\textcolor{keywordtype}{size\_t},\textcolor{keywordtype}{size\_t}))}
\DoxyCodeLine{03222\ \{}
\DoxyCodeLine{03223\ \ \ \ \ \textcolor{keywordflow}{if}\ (\textcolor{keywordtype}{object})\ \{}
\DoxyCodeLine{03224\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Check\ if\ the\ memory\ was\ allocated\ by\ scalable\_malloc}}
\DoxyCodeLine{03225\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{_synchronize_8h_a0792980ea26344eaf2fc0a4112b5d848}{FencedLoad}}(\mbox{\hyperlink{namespacerml_1_1internal_aff6ca9c05f9bd993c8b383d177c55b8e}{mallocInitialized}})\ \&\&\ \mbox{\hyperlink{namespacerml_1_1internal_abe52e5f71a9571929c11e06738d0864f}{isRecognized}}(\textcolor{keywordtype}{object}))}
\DoxyCodeLine{03226\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacerml_1_1internal_a2687be7826e3608802f99d6d2d63f748}{internalMsize}}(\textcolor{keywordtype}{object});}
\DoxyCodeLine{03227\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (orig\_aligned\_msize)}
\DoxyCodeLine{03228\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ orig\_aligned\_msize(\textcolor{keywordtype}{object},alignment,\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ae1b92ae085ddef4b1cdca7d749339fb0}{offset}});}
\DoxyCodeLine{03229\ \ \ \ \ \}}
\DoxyCodeLine{03230\ \ \ \ \ \textcolor{comment}{//\ object\ is\ NULL\ or\ unknown}}
\DoxyCodeLine{03231\ \ \ \ \ errno\ =\ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_a2d1678d5a7cc8ce499643f3b8957def4}{EINVAL}};}
\DoxyCodeLine{03232\ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{03233\ \}}
\DoxyCodeLine{03234\ }
\DoxyCodeLine{03235\ \textcolor{comment}{/*********\ End\ code\ for\ scalable\_msize\ \ \ ***********/}}
\DoxyCodeLine{03236\ }
\DoxyCodeLine{03237\ \textcolor{keyword}{extern}\ \textcolor{stringliteral}{"{}C"{}}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{group__memory__allocation_ga7f5029970f72ebbffee896c46a23958e}{scalable\_allocation\_mode}}(\textcolor{keywordtype}{int}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa18f5f638c58bcb864e367eacbb3380d}{param}},\ intptr\_t\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_abe8e049f756b5ba547bda825af81b645}{value}})}
\DoxyCodeLine{03238\ \{}
\DoxyCodeLine{03239\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa18f5f638c58bcb864e367eacbb3380d}{param}}\ ==\ \mbox{\hyperlink{scalable__allocator_8h_a75085058c147f85d8897858363b6e99ca8da63128955707fa82c2a901a12c1377}{TBBMALLOC\_SET\_SOFT\_HEAP\_LIMIT}})\ \{}
\DoxyCodeLine{03240\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacerml_1_1internal_a775ef3ae8dd6b242d20f44ebd787a1be}{defaultMemPool}}-\/>extMemPool.backend.setRecommendedMaxSize((\textcolor{keywordtype}{size\_t})\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_abe8e049f756b5ba547bda825af81b645}{value}});}
\DoxyCodeLine{03241\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{scalable__allocator_8h_abd5aafe33a307bbbe334f0049e625cd1a040a2f4f5c81f292946198d61b9b5a39}{TBBMALLOC\_OK}};}
\DoxyCodeLine{03242\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa18f5f638c58bcb864e367eacbb3380d}{param}}\ ==\ \mbox{\hyperlink{scalable__allocator_8h_a75085058c147f85d8897858363b6e99ca42a5f61902d75cf33d5c1bb25cbbdc61}{USE\_HUGE\_PAGES}})\ \{}
\DoxyCodeLine{03243\ \textcolor{preprocessor}{\#if\ \_\_linux\_\_}}
\DoxyCodeLine{03244\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{switch}\ (\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_abe8e049f756b5ba547bda825af81b645}{value}})\ \{}
\DoxyCodeLine{03245\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ 0:}
\DoxyCodeLine{03246\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ 1:}
\DoxyCodeLine{03247\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacerml_1_1internal_a47aa4f0d1eb6a621e5830ea034495648}{hugePages}}.setMode(\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_abe8e049f756b5ba547bda825af81b645}{value}});}
\DoxyCodeLine{03248\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{scalable__allocator_8h_abd5aafe33a307bbbe334f0049e625cd1a040a2f4f5c81f292946198d61b9b5a39}{TBBMALLOC\_OK}};}
\DoxyCodeLine{03249\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{03250\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{scalable__allocator_8h_abd5aafe33a307bbbe334f0049e625cd1a89b1508ac4a2edb73f257681977ee7ff}{TBBMALLOC\_INVALID\_PARAM}};}
\DoxyCodeLine{03251\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03252\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{03253\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{scalable__allocator_8h_abd5aafe33a307bbbe334f0049e625cd1a058a16359e636ec3199a51326cbfc6b4}{TBBMALLOC\_NO\_EFFECT}};}
\DoxyCodeLine{03254\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03255\ \textcolor{preprocessor}{\#if\ \_\_TBB\_SOURCE\_DIRECTLY\_INCLUDED}}
\DoxyCodeLine{03256\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa18f5f638c58bcb864e367eacbb3380d}{param}}\ ==\ \mbox{\hyperlink{tbbmalloc__internal__api_8h_a83a5aaa0e5117acd8033bfaadac18fbbabc5f81bf7589d33397908a0cbd2b81a8}{TBBMALLOC\_INTERNAL\_SOURCE\_INCLUDED}})\ \{}
\DoxyCodeLine{03257\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{switch}\ (\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_abe8e049f756b5ba547bda825af81b645}{value}})\ \{}
\DoxyCodeLine{03258\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ 0:\ \textcolor{comment}{//\ used\ by\ dynamic\ library}}
\DoxyCodeLine{03259\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ 1:\ \textcolor{comment}{//\ used\ by\ static\ library\ or\ directly\ included\ sources}}
\DoxyCodeLine{03260\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacerml_1_1internal_adfef860fe0efd8df96bdddf72c66e7e2}{usedBySrcIncluded}}\ =\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_abe8e049f756b5ba547bda825af81b645}{value}};}
\DoxyCodeLine{03261\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{scalable__allocator_8h_abd5aafe33a307bbbe334f0049e625cd1a040a2f4f5c81f292946198d61b9b5a39}{TBBMALLOC\_OK}};}
\DoxyCodeLine{03262\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{03263\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{scalable__allocator_8h_abd5aafe33a307bbbe334f0049e625cd1a89b1508ac4a2edb73f257681977ee7ff}{TBBMALLOC\_INVALID\_PARAM}};}
\DoxyCodeLine{03264\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03265\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03266\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa18f5f638c58bcb864e367eacbb3380d}{param}}\ ==\ \mbox{\hyperlink{scalable__allocator_8h_a75085058c147f85d8897858363b6e99ca7591d85ec680d25e36efce755f8c8feb}{TBBMALLOC\_SET\_HUGE\_SIZE\_THRESHOLD}})\ \{}
\DoxyCodeLine{03267\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacerml_1_1internal_a775ef3ae8dd6b242d20f44ebd787a1be}{defaultMemPool}}-\/>extMemPool.loc.setHugeSizeThreshold((\textcolor{keywordtype}{size\_t})\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_abe8e049f756b5ba547bda825af81b645}{value}});}
\DoxyCodeLine{03268\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{scalable__allocator_8h_abd5aafe33a307bbbe334f0049e625cd1a040a2f4f5c81f292946198d61b9b5a39}{TBBMALLOC\_OK}};}
\DoxyCodeLine{03269\ \ \ \ \ \}}
\DoxyCodeLine{03270\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{scalable__allocator_8h_abd5aafe33a307bbbe334f0049e625cd1a89b1508ac4a2edb73f257681977ee7ff}{TBBMALLOC\_INVALID\_PARAM}};}
\DoxyCodeLine{03271\ \}}
\DoxyCodeLine{03272\ }
\DoxyCodeLine{03273\ \textcolor{keyword}{extern}\ \textcolor{stringliteral}{"{}C"{}}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{group__memory__allocation_gabe5acd876b4d89bf89787c4e779c2518}{scalable\_allocation\_command}}(\textcolor{keywordtype}{int}\ cmd,\ \textcolor{keywordtype}{void}\ *\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa18f5f638c58bcb864e367eacbb3380d}{param}})}
\DoxyCodeLine{03274\ \{}
\DoxyCodeLine{03275\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa18f5f638c58bcb864e367eacbb3380d}{param}})}
\DoxyCodeLine{03276\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{scalable__allocator_8h_abd5aafe33a307bbbe334f0049e625cd1a89b1508ac4a2edb73f257681977ee7ff}{TBBMALLOC\_INVALID\_PARAM}};}
\DoxyCodeLine{03277\ }
\DoxyCodeLine{03278\ \ \ \ \ \textcolor{keywordtype}{bool}\ released\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{03279\ \ \ \ \ \textcolor{keywordflow}{switch}(cmd)\ \{}
\DoxyCodeLine{03280\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{scalable__allocator_8h_a57dd71201713941030ef626baa8fa0eba133d3695e619c963187473fab2f76554}{TBBMALLOC\_CLEAN\_THREAD\_BUFFERS}}:}
\DoxyCodeLine{03281\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classrml_1_1internal_1_1_t_l_s_data}{TLSData}}\ *tls\ =\ \mbox{\hyperlink{namespacerml_1_1internal_a775ef3ae8dd6b242d20f44ebd787a1be}{defaultMemPool}}-\/>getTLS(\textcolor{comment}{/*create=*/}\textcolor{keyword}{false}))}
\DoxyCodeLine{03282\ \ \ \ \ \ \ \ \ \ \ \ \ released\ =\ tls-\/>externalCleanup(\textcolor{comment}{/*cleanOnlyUnused*/}\textcolor{keyword}{false},\ \textcolor{comment}{/*cleanBins=*/}\textcolor{keyword}{true});}
\DoxyCodeLine{03283\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03284\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{scalable__allocator_8h_a57dd71201713941030ef626baa8fa0eba220951b44311a33baf906ddf94411655}{TBBMALLOC\_CLEAN\_ALL\_BUFFERS}}:}
\DoxyCodeLine{03285\ \ \ \ \ \ \ \ \ released\ =\ \mbox{\hyperlink{namespacerml_1_1internal_a775ef3ae8dd6b242d20f44ebd787a1be}{defaultMemPool}}-\/>extMemPool.hardCachesCleanup();}
\DoxyCodeLine{03286\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03287\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{03288\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{scalable__allocator_8h_abd5aafe33a307bbbe334f0049e625cd1a89b1508ac4a2edb73f257681977ee7ff}{TBBMALLOC\_INVALID\_PARAM}};}
\DoxyCodeLine{03289\ \ \ \ \ \}}
\DoxyCodeLine{03290\ \ \ \ \ \textcolor{keywordflow}{return}\ released\ ?\ \mbox{\hyperlink{scalable__allocator_8h_abd5aafe33a307bbbe334f0049e625cd1a040a2f4f5c81f292946198d61b9b5a39}{TBBMALLOC\_OK}}\ :\ \mbox{\hyperlink{scalable__allocator_8h_abd5aafe33a307bbbe334f0049e625cd1a058a16359e636ec3199a51326cbfc6b4}{TBBMALLOC\_NO\_EFFECT}};}
\DoxyCodeLine{03291\ \}}

\end{DoxyCode}
