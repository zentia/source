\doxysection{scan.\+hpp}
\hypertarget{taskflow_2cuda_2algorithm_2scan_8hpp_source}{}\label{taskflow_2cuda_2algorithm_2scan_8hpp_source}\index{external/taskflow/taskflow/cuda/algorithm/scan.hpp@{external/taskflow/taskflow/cuda/algorithm/scan.hpp}}
\mbox{\hyperlink{taskflow_2cuda_2algorithm_2scan_8hpp}{浏览该文件的文档.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00002\ }
\DoxyCodeLine{00003\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{taskflow_2cuda_2algorithm_2reduce_8hpp}{reduce.hpp}}"{}}}
\DoxyCodeLine{00004\ }
\DoxyCodeLine{00009\ }
\DoxyCodeLine{00010\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespacetf_1_1detail}{tf::detail}}\ \{}
\DoxyCodeLine{00011\ }
\DoxyCodeLine{00012\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00013\ \textcolor{comment}{//\ scan}}
\DoxyCodeLine{00014\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00015\ }
\DoxyCodeLine{00017\ \textcolor{keyword}{inline}\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacetf_1_1detail_acb48d657669121bb9dfd45662e5bf9e1}{cudaScanRecursionThreshold}}\ =\ 8;}
\DoxyCodeLine{00018\ }
\DoxyCodeLine{00020\ \textcolor{keyword}{enum\ class}\ \mbox{\hyperlink{namespacetf_1_1detail_a1f08990983d8305f1592fee1a3fdc593}{cudaScanType}}\ :\ \textcolor{keywordtype}{int}\ \{}
\DoxyCodeLine{00021\ \ \ \mbox{\hyperlink{namespacetf_1_1detail_a1f08990983d8305f1592fee1a3fdc593af45c3a0bb3687ed8e221253b3fd4a2ce}{EXCLUSIVE}}\ =\ 1,}
\DoxyCodeLine{00022\ \ \ \mbox{\hyperlink{namespacetf_1_1detail_a1f08990983d8305f1592fee1a3fdc593a572d795e2d044f895cc511e5c05030e5}{INCLUSIVE}}}
\DoxyCodeLine{00023\ \};}
\DoxyCodeLine{00024\ }
\DoxyCodeLine{00026\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ T,\ \textcolor{keywordtype}{unsigned}\ vt\ =\ 0,\ \textcolor{keywordtype}{bool}\ is\_array\ =\ (vt\ >\ 0)>}
\DoxyCodeLine{00027\ \textcolor{keyword}{struct}\ \mbox{\hyperlink{structtf_1_1detail_1_1cuda_scan_result}{cudaScanResult}}\ \{}
\DoxyCodeLine{00028\ \ \ \mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}}\ \mbox{\hyperlink{structtf_1_1detail_1_1cuda_scan_result_a2d18214ac96fce1c9b5523eb72646497}{scan}};}
\DoxyCodeLine{00029\ \ \ \mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}}\ \mbox{\hyperlink{structtf_1_1detail_1_1cuda_scan_result_ac4aeb7807ad442899dc62ac65d48df9c}{reduction}};}
\DoxyCodeLine{00030\ \};}
\DoxyCodeLine{00031\ }
\DoxyCodeLine{00033\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ T,\ \textcolor{keywordtype}{unsigned}\ vt>}
\DoxyCodeLine{00034\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structtf_1_1detail_1_1cuda_scan_result}{cudaScanResult}}<\mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}},\ vt,\ \mbox{\hyperlink{yyjson_8h_a41f9c5fb8b08eb5dc3edce4dcb37fee7}{true}}>\ \{}
\DoxyCodeLine{00035\ \ \ \mbox{\hyperlink{structtf_1_1cuda_array}{cudaArray<T,\ vt>}}\ \mbox{\hyperlink{structtf_1_1detail_1_1cuda_scan_result_3_01_t_00_01vt_00_01true_01_4_ae2631d1e70f8a1942022462b17e523cc}{scan}};}
\DoxyCodeLine{00036\ \ \ \mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}}\ \mbox{\hyperlink{structtf_1_1detail_1_1cuda_scan_result_3_01_t_00_01vt_00_01true_01_4_a1e4eda84a7da8e5b3c1c4e3c799a9021}{reduction}};}
\DoxyCodeLine{00037\ \};}
\DoxyCodeLine{00038\ }
\DoxyCodeLine{00039\ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00040\ }
\DoxyCodeLine{00042\ \textcolor{keyword}{template}<\textcolor{keywordtype}{unsigned}\ nt,\ \textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00043\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structtf_1_1detail_1_1cuda_block_scan}{cudaBlockScan}}\ \{}
\DoxyCodeLine{00044\ }
\DoxyCodeLine{00045\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{structtf_1_1detail_1_1cuda_block_scan_a64a40d4728c65b4019c8fffa8fc8605a}{num\_warps}}\ \ =\ nt\ /\ \mbox{\hyperlink{namespacetf_ab1e5a5b39dee82307021d84550491663}{CUDA\_WARP\_SIZE}};}
\DoxyCodeLine{00046\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{structtf_1_1detail_1_1cuda_block_scan_a358ff68745420d9e8aa027907c1aba64}{num\_passes}}\ =\ \mbox{\hyperlink{namespacetf_a908e0f3faf873e897b3e1bafbd4bb876}{static\_floor\_log2<nt>}}();}
\DoxyCodeLine{00047\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{structtf_1_1detail_1_1cuda_block_scan_a11126c1cbf8d463287478b8a5c04a036}{capacity}}\ \ \ =\ nt\ +\ \mbox{\hyperlink{structtf_1_1detail_1_1cuda_block_scan_a64a40d4728c65b4019c8fffa8fc8605a}{num\_warps}};}
\DoxyCodeLine{00048\ }
\DoxyCodeLine{00050\ \ \ \textcolor{keyword}{union\ }\mbox{\hyperlink{uniontf_1_1detail_1_1cuda_block_scan_1_1storage__t}{storage\_t}}\ \{}
\DoxyCodeLine{00051\ \ \ \ \ \mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}}\ \mbox{\hyperlink{uniontf_1_1detail_1_1cuda_block_scan_1_1storage__t_a9cc602c1e7c8358505637a42b958f398}{data}}[2\ *\ nt];}
\DoxyCodeLine{00052\ \ \ \ \ \textcolor{keyword}{struct\ }\{\ \mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}}\ \mbox{\hyperlink{uniontf_1_1detail_1_1cuda_block_scan_1_1storage__t_ac224c3be4b10b573062ca8c91b681553}{threads}}[nt],\ \mbox{\hyperlink{uniontf_1_1detail_1_1cuda_block_scan_1_1storage__t_a4568128897799803ea8d0ff0fa2524a0}{warps}}[\mbox{\hyperlink{structtf_1_1detail_1_1cuda_block_scan_a64a40d4728c65b4019c8fffa8fc8605a}{num\_warps}}];\ \};}
\DoxyCodeLine{00053\ \ \ \};}
\DoxyCodeLine{00054\ }
\DoxyCodeLine{00055\ \ \ \textcolor{comment}{//\ standard\ scan}}
\DoxyCodeLine{00056\ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ op\_t>}
\DoxyCodeLine{00057\ \ \ \_\_device\_\_\ \mbox{\hyperlink{structtf_1_1detail_1_1cuda_scan_result}{cudaScanResult<T>}}\ \mbox{\hyperlink{structtf_1_1detail_1_1cuda_block_scan_a5ac5687ea52d5b6378bd22f4e0bf3b2d}{operator\ ()}}(}
\DoxyCodeLine{00058\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ tid,}
\DoxyCodeLine{00059\ \ \ \ \ \mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}}\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}},}
\DoxyCodeLine{00060\ \ \ \ \ storage\_t\&\ storage,}
\DoxyCodeLine{00061\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}}\ =\ nt,}
\DoxyCodeLine{00062\ \ \ \ \ op\_t\ op\ =\ op\_t(),}
\DoxyCodeLine{00063\ \ \ \ \ \mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}}\ \mbox{\hyperlink{structinit}{init}}\ =\ \mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}}(),}
\DoxyCodeLine{00064\ \ \ \ \ \mbox{\hyperlink{namespacetf_1_1detail_a1f08990983d8305f1592fee1a3fdc593}{cudaScanType}}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ae8396ff85d63082521e3324820df1009}{type}}\ =\ \mbox{\hyperlink{namespacetf_1_1detail_a1f08990983d8305f1592fee1a3fdc593af45c3a0bb3687ed8e221253b3fd4a2ce}{cudaScanType::EXCLUSIVE}}}
\DoxyCodeLine{00065\ \ \ )\ \textcolor{keyword}{const};}
\DoxyCodeLine{00066\ }
\DoxyCodeLine{00067\ \ \ \textcolor{comment}{//\ vectorized\ scan.\ accepts\ multiple\ values\ per\ thread\ and\ adds\ in}}
\DoxyCodeLine{00068\ \ \ \textcolor{comment}{//\ optional\ global\ carry-\/in}}
\DoxyCodeLine{00069\ \ \ \textcolor{keyword}{template}<\textcolor{keywordtype}{unsigned}\ vt,\ \textcolor{keyword}{typename}\ op\_t>}
\DoxyCodeLine{00070\ \ \ \_\_device\_\_\ \mbox{\hyperlink{structtf_1_1detail_1_1cuda_scan_result}{cudaScanResult<T,\ vt>}}\ \mbox{\hyperlink{structtf_1_1detail_1_1cuda_block_scan_a5ac5687ea52d5b6378bd22f4e0bf3b2d}{operator()}}(}
\DoxyCodeLine{00071\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ tid,}
\DoxyCodeLine{00072\ \ \ \ \ \mbox{\hyperlink{structtf_1_1cuda_array}{cudaArray<T,\ vt>}}\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}},}
\DoxyCodeLine{00073\ \ \ \ \ storage\_t\&\ storage,}
\DoxyCodeLine{00074\ \ \ \ \ \mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}}\ carry\_in\ =\ \mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}}(),}
\DoxyCodeLine{00075\ \ \ \ \ \textcolor{keywordtype}{bool}\ use\_carry\_in\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{00076\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}}\ =\ nt,}
\DoxyCodeLine{00077\ \ \ \ \ op\_t\ op\ =\ op\_t(),}
\DoxyCodeLine{00078\ \ \ \ \ \mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}}\ \mbox{\hyperlink{structinit}{init}}\ =\ \mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}}(),}
\DoxyCodeLine{00079\ \ \ \ \ \mbox{\hyperlink{namespacetf_1_1detail_a1f08990983d8305f1592fee1a3fdc593}{cudaScanType}}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ae8396ff85d63082521e3324820df1009}{type}}\ =\ \mbox{\hyperlink{namespacetf_1_1detail_a1f08990983d8305f1592fee1a3fdc593af45c3a0bb3687ed8e221253b3fd4a2ce}{cudaScanType::EXCLUSIVE}}}
\DoxyCodeLine{00080\ \ \ )\ \textcolor{keyword}{const};}
\DoxyCodeLine{00081\ \};}
\DoxyCodeLine{00082\ }
\DoxyCodeLine{00083\ \textcolor{comment}{//\ standard\ scan}}
\DoxyCodeLine{00084\ \textcolor{keyword}{template}\ <\textcolor{keywordtype}{unsigned}\ nt,\ \textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00085\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ op\_t>}
\DoxyCodeLine{00086\ \_\_device\_\_\ \mbox{\hyperlink{structtf_1_1detail_1_1cuda_scan_result}{cudaScanResult<T>}}\ \mbox{\hyperlink{structtf_1_1detail_1_1cuda_block_scan_a5ac5687ea52d5b6378bd22f4e0bf3b2d}{cudaBlockScan<nt,\ T>::operator\ ()\ }}(}
\DoxyCodeLine{00087\ \ \ \textcolor{keywordtype}{unsigned}\ tid,\ \mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}}\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}},\ \mbox{\hyperlink{uniontf_1_1detail_1_1cuda_block_scan_1_1storage__t}{storage\_t}}\&\ storage,\ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}},\ op\_t\ op,}
\DoxyCodeLine{00088\ \ \ \mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}}\ \mbox{\hyperlink{structinit}{init}},\ \mbox{\hyperlink{namespacetf_1_1detail_a1f08990983d8305f1592fee1a3fdc593}{cudaScanType}}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ae8396ff85d63082521e3324820df1009}{type}}}
\DoxyCodeLine{00089\ )\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00090\ }
\DoxyCodeLine{00091\ \ \ \textcolor{keywordtype}{unsigned}\ first\ =\ 0;}
\DoxyCodeLine{00092\ \ \ storage.\mbox{\hyperlink{uniontf_1_1detail_1_1cuda_block_scan_1_1storage__t_a9cc602c1e7c8358505637a42b958f398}{data}}[first\ +\ tid]\ =\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}};}
\DoxyCodeLine{00093\ \ \ \_\_syncthreads();}
\DoxyCodeLine{00094\ }
\DoxyCodeLine{00095\ \ \ \mbox{\hyperlink{namespacetf_a55e1e8a489984141bc8e0785cd13f9bc}{cuda\_iterate<num\_passes>}}([\&](\textcolor{keyword}{auto}\ pass)\ \{}
\DoxyCodeLine{00096\ \ \ \ \ \textcolor{keywordflow}{if}(\textcolor{keyword}{auto}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ae1b92ae085ddef4b1cdca7d749339fb0}{offset}}\ =\ 1<<pass;\ tid\ >=\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ae1b92ae085ddef4b1cdca7d749339fb0}{offset}})\ \{}
\DoxyCodeLine{00097\ \ \ \ \ \ \ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}}\ =\ op(storage.\mbox{\hyperlink{uniontf_1_1detail_1_1cuda_block_scan_1_1storage__t_a9cc602c1e7c8358505637a42b958f398}{data}}[first\ +\ tid\ -\/\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ae1b92ae085ddef4b1cdca7d749339fb0}{offset}}],\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}});}
\DoxyCodeLine{00098\ \ \ \ \ \}}
\DoxyCodeLine{00099\ \ \ \ \ first\ =\ nt\ -\/\ first;}
\DoxyCodeLine{00100\ \ \ \ \ storage.\mbox{\hyperlink{uniontf_1_1detail_1_1cuda_block_scan_1_1storage__t_a9cc602c1e7c8358505637a42b958f398}{data}}[first\ +\ tid]\ =\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}};}
\DoxyCodeLine{00101\ \ \ \ \ \_\_syncthreads();}
\DoxyCodeLine{00102\ \ \ \});}
\DoxyCodeLine{00103\ }
\DoxyCodeLine{00104\ \ \ \mbox{\hyperlink{structtf_1_1detail_1_1cuda_scan_result}{cudaScanResult<T>}}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}};}
\DoxyCodeLine{00105\ \ \ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}}.reduction\ =\ storage.\mbox{\hyperlink{uniontf_1_1detail_1_1cuda_block_scan_1_1storage__t_a9cc602c1e7c8358505637a42b958f398}{data}}[first\ +\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}}\ -\/\ 1];}
\DoxyCodeLine{00106\ \ \ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}}.scan\ =\ (tid\ <\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}})\ ?}
\DoxyCodeLine{00107\ \ \ \ \ (\mbox{\hyperlink{namespacetf_1_1detail_a1f08990983d8305f1592fee1a3fdc593a572d795e2d044f895cc511e5c05030e5}{cudaScanType::INCLUSIVE}}\ ==\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ae8396ff85d63082521e3324820df1009}{type}}\ ?\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}}\ :}
\DoxyCodeLine{00108\ \ \ \ \ \ \ (tid\ ?\ storage.\mbox{\hyperlink{uniontf_1_1detail_1_1cuda_block_scan_1_1storage__t_a9cc602c1e7c8358505637a42b958f398}{data}}[first\ +\ tid\ -\/\ 1]\ :\ \mbox{\hyperlink{structinit}{init}}))\ :}
\DoxyCodeLine{00109\ \ \ \ \ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}}.reduction;}
\DoxyCodeLine{00110\ \ \ \_\_syncthreads();}
\DoxyCodeLine{00111\ }
\DoxyCodeLine{00112\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}};}
\DoxyCodeLine{00113\ \}}
\DoxyCodeLine{00114\ }
\DoxyCodeLine{00115\ \textcolor{comment}{//\ vectorized\ scan\ block}}
\DoxyCodeLine{00116\ \textcolor{keyword}{template}\ <\textcolor{keywordtype}{unsigned}\ nt,\ \textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00117\ \textcolor{keyword}{template}<\textcolor{keywordtype}{unsigned}\ vt,\ \textcolor{keyword}{typename}\ op\_t>}
\DoxyCodeLine{00118\ \_\_device\_\_\ \mbox{\hyperlink{structtf_1_1detail_1_1cuda_scan_result}{cudaScanResult<T,\ vt>}}\ \mbox{\hyperlink{structtf_1_1detail_1_1cuda_block_scan_a5ac5687ea52d5b6378bd22f4e0bf3b2d}{cudaBlockScan<nt,\ T>::operator()}}(}
\DoxyCodeLine{00119\ \ \ \textcolor{keywordtype}{unsigned}\ tid,}
\DoxyCodeLine{00120\ \ \ \mbox{\hyperlink{structtf_1_1cuda_array}{cudaArray<T,\ vt>}}\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}},}
\DoxyCodeLine{00121\ \ \ \mbox{\hyperlink{uniontf_1_1detail_1_1cuda_block_scan_1_1storage__t}{storage\_t}}\&\ storage,}
\DoxyCodeLine{00122\ \ \ \mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}}\ carry\_in,}
\DoxyCodeLine{00123\ \ \ \textcolor{keywordtype}{bool}\ use\_carry\_in,}
\DoxyCodeLine{00124\ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}},\ op\_t\ op,}
\DoxyCodeLine{00125\ \ \ \mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}}\ \mbox{\hyperlink{structinit}{init}},}
\DoxyCodeLine{00126\ \ \ \mbox{\hyperlink{namespacetf_1_1detail_a1f08990983d8305f1592fee1a3fdc593}{cudaScanType}}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ae8396ff85d63082521e3324820df1009}{type}}}
\DoxyCodeLine{00127\ )\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00128\ }
\DoxyCodeLine{00129\ \ \ \textcolor{comment}{//\ Start\ with\ an\ inclusive\ scan\ of\ the\ in-\/range\ elements.}}
\DoxyCodeLine{00130\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}}\ >=\ \mbox{\hyperlink{classtf_1_1cuda_execution_policy_abb1050526f45873c967976a99e9a370d}{nt}}\ *\ \mbox{\hyperlink{classtf_1_1cuda_execution_policy_a9410f1b3a5cb9a3cc5e8d640bc7d3990}{vt}})\ \{}
\DoxyCodeLine{00131\ \ \ \ \ \mbox{\hyperlink{namespacetf_a55e1e8a489984141bc8e0785cd13f9bc}{cuda\_iterate<vt>}}([\&](\textcolor{keyword}{auto}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ \{}
\DoxyCodeLine{00132\ \ \ \ \ \ \ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}]\ =\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ ?\ op(\mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}],\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ -\/\ 1])\ :\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}];}
\DoxyCodeLine{00133\ \ \ \ \ \});}
\DoxyCodeLine{00134\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00135\ \ \ \ \ \mbox{\hyperlink{namespacetf_a55e1e8a489984141bc8e0785cd13f9bc}{cuda\_iterate<vt>}}([\&](\textcolor{keyword}{auto}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ \{}
\DoxyCodeLine{00136\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ab47dd9958bcadea08866b42bf358e95e}{index}}\ =\ \mbox{\hyperlink{classtf_1_1cuda_execution_policy_a9410f1b3a5cb9a3cc5e8d640bc7d3990}{vt}}\ *\ tid\ +\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}};}
\DoxyCodeLine{00137\ \ \ \ \ \ \ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}]\ =\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ ?}
\DoxyCodeLine{00138\ \ \ \ \ \ \ \ \ ((\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ab47dd9958bcadea08866b42bf358e95e}{index}}\ <\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}})\ ?\ op(\mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}],\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ -\/\ 1])\ :\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ -\/\ 1])\ :}
\DoxyCodeLine{00139\ \ \ \ \ \ \ \ \ (\mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}]\ =\ (\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ab47dd9958bcadea08866b42bf358e95e}{index}}\ <\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}})\ ?\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}]\ :\ \mbox{\hyperlink{structinit}{init}});}
\DoxyCodeLine{00140\ \ \ \ \ \});}
\DoxyCodeLine{00141\ \ \ \}}
\DoxyCodeLine{00142\ }
\DoxyCodeLine{00143\ \ \ \textcolor{comment}{//\ Scan\ the\ thread-\/local\ reductions\ for\ a\ carry-\/in\ for\ each\ thread.}}
\DoxyCodeLine{00144\ \ \ \textcolor{keyword}{auto}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}}\ =\ operator()(}
\DoxyCodeLine{00145\ \ \ \ \ tid,\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}}[\mbox{\hyperlink{classtf_1_1cuda_execution_policy_a9410f1b3a5cb9a3cc5e8d640bc7d3990}{vt}}\ -\/\ 1],\ storage,}
\DoxyCodeLine{00146\ \ \ \ \ (\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}}\ +\ \mbox{\hyperlink{classtf_1_1cuda_execution_policy_a9410f1b3a5cb9a3cc5e8d640bc7d3990}{vt}}\ -\/\ 1)\ /\ \mbox{\hyperlink{classtf_1_1cuda_execution_policy_a9410f1b3a5cb9a3cc5e8d640bc7d3990}{vt}},\ op,\ \mbox{\hyperlink{structinit}{init}},\ \mbox{\hyperlink{namespacetf_1_1detail_a1f08990983d8305f1592fee1a3fdc593af45c3a0bb3687ed8e221253b3fd4a2ce}{cudaScanType::EXCLUSIVE}}}
\DoxyCodeLine{00147\ \ \ );}
\DoxyCodeLine{00148\ }
\DoxyCodeLine{00149\ \ \ \textcolor{comment}{//\ Perform\ the\ scan\ downsweep\ and\ add\ both\ the\ global\ carry-\/in\ and\ the}}
\DoxyCodeLine{00150\ \ \ \textcolor{comment}{//\ thread\ carry-\/in\ to\ the\ values.}}
\DoxyCodeLine{00151\ \ \ \textcolor{keywordflow}{if}(use\_carry\_in)\ \{}
\DoxyCodeLine{00152\ \ \ \ \ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}}.reduction\ =\ op(carry\_in,\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}}.reduction);}
\DoxyCodeLine{00153\ \ \ \ \ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}}.scan\ =\ tid\ ?\ op(carry\_in,\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}}.scan)\ :\ carry\_in;}
\DoxyCodeLine{00154\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00155\ \ \ \ \ use\_carry\_in\ =\ tid\ >\ 0;}
\DoxyCodeLine{00156\ \ \ \}}
\DoxyCodeLine{00157\ }
\DoxyCodeLine{00158\ \ \ \mbox{\hyperlink{structtf_1_1cuda_array}{cudaArray<T,\ vt>}}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a5e247fc24ceb70d83f6ad59149b8910a}{y}};}
\DoxyCodeLine{00159\ \ \ \mbox{\hyperlink{namespacetf_a55e1e8a489984141bc8e0785cd13f9bc}{cuda\_iterate<vt>}}([\&](\textcolor{keyword}{auto}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ \{}
\DoxyCodeLine{00160\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{namespacetf_1_1detail_a1f08990983d8305f1592fee1a3fdc593af45c3a0bb3687ed8e221253b3fd4a2ce}{cudaScanType::EXCLUSIVE}}\ ==\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ae8396ff85d63082521e3324820df1009}{type}})\ \{}
\DoxyCodeLine{00161\ \ \ \ \ \ \ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a5e247fc24ceb70d83f6ad59149b8910a}{y}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}]\ =\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ ?\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ -\/\ 1]\ :\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}}.scan;}
\DoxyCodeLine{00162\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(use\_carry\_in\ \&\&\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ >\ 0)\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a5e247fc24ceb70d83f6ad59149b8910a}{y}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}]\ =\ op(\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}}.scan,\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a5e247fc24ceb70d83f6ad59149b8910a}{y}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}]);}
\DoxyCodeLine{00163\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00164\ \ \ \ \ \ \ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a5e247fc24ceb70d83f6ad59149b8910a}{y}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}]\ =\ use\_carry\_in\ ?\ op(\mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}],\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}}.scan)\ :\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}];}
\DoxyCodeLine{00165\ \ \ \ \ \}}
\DoxyCodeLine{00166\ \ \ \});}
\DoxyCodeLine{00167\ }
\DoxyCodeLine{00168\ \ \ \textcolor{keywordflow}{return}\ cudaScanResult<T,\ vt>\ \{\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a5e247fc24ceb70d83f6ad59149b8910a}{y}},\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}}.reduction\ \};}
\DoxyCodeLine{00169\ \}}
\DoxyCodeLine{00170\ }
\DoxyCodeLine{00175\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ P,\ \textcolor{keyword}{typename}\ I,\ \textcolor{keyword}{typename}\ O,\ \textcolor{keyword}{typename}\ C>}
\DoxyCodeLine{00176\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{namespacetf_1_1detail_a2c9669b414231e12f66e9d40ca9ae3a3}{cuda\_single\_pass\_scan}}(}
\DoxyCodeLine{00177\ \ \ \mbox{\hyperlink{namespace_p}{P}}\&\&\ \mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}},}
\DoxyCodeLine{00178\ \ \ \mbox{\hyperlink{namespacetf_1_1detail_a1f08990983d8305f1592fee1a3fdc593}{cudaScanType}}\ scan\_type,}
\DoxyCodeLine{00179\ \ \ I\ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_ab7e6955a695fad0be513586926040b1a}{input}},}
\DoxyCodeLine{00180\ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}},}
\DoxyCodeLine{00181\ \ \ O\ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}},}
\DoxyCodeLine{00182\ \ \ \mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}}\ op}
\DoxyCodeLine{00183\ \ \ \textcolor{comment}{//reduction\_it\ reduction,}}
\DoxyCodeLine{00184\ )\ \{}
\DoxyCodeLine{00185\ }
\DoxyCodeLine{00186\ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}}\ =\ \textcolor{keyword}{typename}\ std::iterator\_traits<O>::value\_type;}
\DoxyCodeLine{00187\ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{sandbox_2strassen_2omp_8cpp_a4bfa035cad7c3258704669810cd5de5d}{E}}\ =\ std::decay\_t<P>;}
\DoxyCodeLine{00188\ }
\DoxyCodeLine{00189\ \ \ \textcolor{comment}{//\ Small\ input\ specialization.\ This\ is\ the\ non-\/recursive\ branch.}}
\DoxyCodeLine{00190\ \ \ \mbox{\hyperlink{namespacetf_a2fa23f4109147679d05a25ee952c4baf}{cuda\_kernel}}<<<1,\ E::nt,\ 0,\ \mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}}.stream()>>>([=]\ \_\_device\_\_\ (\textcolor{keyword}{auto}\ tid,\ \textcolor{keyword}{auto}\ bid)\ \{}
\DoxyCodeLine{00191\ }
\DoxyCodeLine{00192\ \ \ \ \ \textcolor{keyword}{using\ }scan\_t\ =\ \mbox{\hyperlink{structtf_1_1detail_1_1cuda_block_scan}{cudaBlockScan<E::nt,\ T>}};}
\DoxyCodeLine{00193\ }
\DoxyCodeLine{00194\ \ \ \ \ \_\_shared\_\_\ \textcolor{keyword}{union\ }\{}
\DoxyCodeLine{00195\ \ \ \ \ \ \ \textcolor{keyword}{typename}\ scan\_t::storage\_t\ scan;}
\DoxyCodeLine{00196\ \ \ \ \ \ \ \mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}}\ values[E::nv];}
\DoxyCodeLine{00197\ \ \ \ \ \}\ \mbox{\hyperlink{sugar_8h_ae0940e50b16abd6b40d3cb35b1913da0}{shared}};}
\DoxyCodeLine{00198\ }
\DoxyCodeLine{00199\ \ \ \ \ \textcolor{keyword}{auto}\ carry\_in\ =\ \mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}}();}
\DoxyCodeLine{00200\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ cur\ =\ 0;\ cur\ <\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}};\ cur\ +=\ E::nv)\ \{}
\DoxyCodeLine{00201\ \ \ \ \ \ \ \textcolor{comment}{//\ Cooperatively\ load\ values\ into\ register.}}
\DoxyCodeLine{00202\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ count2\ =\ \mbox{\hyperlink{datatypes_8h_ac6afabdc09a49a433ee19d8a9486056d}{min}}(\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}}\ -\/\ cur,\ E::nv);}
\DoxyCodeLine{00203\ }
\DoxyCodeLine{00204\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}}\ =\ \mbox{\hyperlink{namespacetf_a6927bc7edeed8a199a267e44bd3374c3}{cuda\_mem\_to\_reg\_thread<E::nt,\ E::vt>}}(\mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_ab7e6955a695fad0be513586926040b1a}{input}}\ +\ cur,}
\DoxyCodeLine{00205\ \ \ \ \ \ \ \ \ tid,\ count2,\ \mbox{\hyperlink{sugar_8h_ae0940e50b16abd6b40d3cb35b1913da0}{shared}}.values);}
\DoxyCodeLine{00206\ }
\DoxyCodeLine{00207\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}}\ =\ scan\_t()(tid,\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}},\ \mbox{\hyperlink{sugar_8h_ae0940e50b16abd6b40d3cb35b1913da0}{shared}}.scan,}
\DoxyCodeLine{00208\ \ \ \ \ \ \ \ \ carry\_in,\ cur\ >\ 0,\ count2,\ op,\ \mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}}(),\ scan\_type);}
\DoxyCodeLine{00209\ }
\DoxyCodeLine{00210\ \ \ \ \ \ \ \textcolor{comment}{//\ Store\ the\ scanned\ values\ back\ to\ global\ memory.}}
\DoxyCodeLine{00211\ \ \ \ \ \ \ \mbox{\hyperlink{namespacetf_a9b1d7b2192743447b2f0206b4510977f}{cuda\_reg\_to\_mem\_thread<E::nt,\ E::vt>}}(\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}}.scan,\ tid,\ count2,}
\DoxyCodeLine{00212\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}}\ +\ cur,\ \mbox{\hyperlink{sugar_8h_ae0940e50b16abd6b40d3cb35b1913da0}{shared}}.values);}
\DoxyCodeLine{00213\ }
\DoxyCodeLine{00214\ \ \ \ \ \ \ \textcolor{comment}{//\ Roll\ the\ reduction\ into\ carry\_in.}}
\DoxyCodeLine{00215\ \ \ \ \ \ \ carry\_in\ =\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_aa7f56a70231ed8bc64f97aa7c37fcb19}{result}}.reduction;}
\DoxyCodeLine{00216\ \ \ \ \ \}}
\DoxyCodeLine{00217\ }
\DoxyCodeLine{00218\ \ \ \ \ \textcolor{comment}{//\ Store\ the\ carry-\/out\ to\ the\ reduction\ pointer.\ This\ may\ be\ a}}
\DoxyCodeLine{00219\ \ \ \ \ \textcolor{comment}{//\ discard\_iterator\_t\ if\ no\ reduction\ is\ wanted.}}
\DoxyCodeLine{00220\ \ \ \ \ \textcolor{comment}{//if(!tid)\ *reduction\ =\ carry\_in;}}
\DoxyCodeLine{00221\ \ \ \});}
\DoxyCodeLine{00222\ \}}
\DoxyCodeLine{00223\ }
\DoxyCodeLine{00229\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ P,\ \textcolor{keyword}{typename}\ I,\ \textcolor{keyword}{typename}\ O,\ \textcolor{keyword}{typename}\ C>}
\DoxyCodeLine{00230\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{namespacetf_1_1detail_a10be6941d3e42a5583d07a092a7b083d}{cuda\_scan\_loop}}(}
\DoxyCodeLine{00231\ \ \ \mbox{\hyperlink{namespace_p}{P}}\&\&\ \mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}},}
\DoxyCodeLine{00232\ \ \ \mbox{\hyperlink{namespacetf_1_1detail_a1f08990983d8305f1592fee1a3fdc593}{cudaScanType}}\ scan\_type,}
\DoxyCodeLine{00233\ \ \ I\ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_ab7e6955a695fad0be513586926040b1a}{input}},}
\DoxyCodeLine{00234\ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}},}
\DoxyCodeLine{00235\ \ \ O\ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}},}
\DoxyCodeLine{00236\ \ \ \mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}}\ op,}
\DoxyCodeLine{00237\ \ \ \textcolor{comment}{//reduction\_it\ reduction,}}
\DoxyCodeLine{00238\ \ \ \textcolor{keywordtype}{void}*\ \mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}}}
\DoxyCodeLine{00239\ )\ \{}
\DoxyCodeLine{00240\ }
\DoxyCodeLine{00241\ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{sandbox_2strassen_2omp_8cpp_a4bfa035cad7c3258704669810cd5de5d}{E}}\ =\ std::decay\_t<P>;}
\DoxyCodeLine{00242\ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}}\ =\ \textcolor{keyword}{typename}\ std::iterator\_traits<O>::value\_type;}
\DoxyCodeLine{00243\ }
\DoxyCodeLine{00244\ \ \ \mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}}*\ \mbox{\hyperlink{sugar_8h_aaadc06b5dac8070de2c8677210967bdb}{buffer}}\ =\ \textcolor{keyword}{static\_cast<}\mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}}*\textcolor{keyword}{>}(\mbox{\hyperlink{yyjson_8h_a26c622783fa717b24fe0bbd3e060f74a}{ptr}});}
\DoxyCodeLine{00245\ }
\DoxyCodeLine{00246\ \ \ \textcolor{comment}{//launch\_t::cta\_dim(context).B(count);}}
\DoxyCodeLine{00247\ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{bench__gemm_8cpp_a37a83060ac796961b44991c836f083f7}{B}}\ =\ (\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}}\ +\ E::nv\ -\/\ 1)\ /\ E::nv;}
\DoxyCodeLine{00248\ }
\DoxyCodeLine{00249\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{bench__gemm_8cpp_a37a83060ac796961b44991c836f083f7}{B}}\ >\ \mbox{\hyperlink{namespacetf_1_1detail_acb48d657669121bb9dfd45662e5bf9e1}{cudaScanRecursionThreshold}})\ \{}
\DoxyCodeLine{00250\ }
\DoxyCodeLine{00251\ \ \ \ \ \textcolor{comment}{//cudaDeviceVector<T>\ partials(B);}}
\DoxyCodeLine{00252\ \ \ \ \ \textcolor{comment}{//auto\ buffer\ =\ partials.data();}}
\DoxyCodeLine{00253\ }
\DoxyCodeLine{00254\ \ \ \ \ \textcolor{comment}{//\ upsweep\ phase}}
\DoxyCodeLine{00255\ \ \ \ \ \mbox{\hyperlink{namespacetf_a2fa23f4109147679d05a25ee952c4baf}{cuda\_kernel}}<<<\mbox{\hyperlink{bench__gemm_8cpp_a37a83060ac796961b44991c836f083f7}{B}},\ E::nt,\ 0,\ \mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}}.stream()>>>([=]\ \_\_device\_\_\ (\textcolor{keyword}{auto}\ tid,\ \textcolor{keyword}{auto}\ bid)\ \{}
\DoxyCodeLine{00256\ }
\DoxyCodeLine{00257\ \ \ \ \ \ \ \_\_shared\_\_\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{structtf_1_1detail_1_1cuda_block_reduce_1_1_storage}{cudaBlockReduce<E::nt,\ T>::Storage}}\ shm;}
\DoxyCodeLine{00258\ }
\DoxyCodeLine{00259\ \ \ \ \ \ \ \textcolor{comment}{//\ Load\ the\ tile's\ data\ into\ register.}}
\DoxyCodeLine{00260\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ tile\ =\ \mbox{\hyperlink{namespacetf_a5a41760b383016bd1cebadcfd7f05476}{cuda\_get\_tile}}(bid,\ E::nv,\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}});}
\DoxyCodeLine{00261\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}}\ =\ \mbox{\hyperlink{namespacetf_a3efaad7a8e442f8cf312c296325b0e07}{cuda\_mem\_to\_reg\_strided<E::nt,\ E::vt>}}(}
\DoxyCodeLine{00262\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_ab7e6955a695fad0be513586926040b1a}{input}}\ +\ tile.begin,\ tid,\ tile.count()}
\DoxyCodeLine{00263\ \ \ \ \ \ \ );}
\DoxyCodeLine{00264\ }
\DoxyCodeLine{00265\ \ \ \ \ \ \ \textcolor{comment}{//\ Reduce\ the\ thread's\ values\ into\ a\ scalar.}}
\DoxyCodeLine{00266\ \ \ \ \ \ \ \mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}}\ scalar;}
\DoxyCodeLine{00267\ \ \ \ \ \ \ \mbox{\hyperlink{namespacetf_a24db9e13fd26535886a7efc723ec1477}{cuda\_strided\_iterate<E::nt,\ E::vt>}}(}
\DoxyCodeLine{00268\ \ \ \ \ \ \ \ \ [\&]\ (\textcolor{keyword}{auto}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}},\ \textcolor{keyword}{auto}\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}})\ \{\ scalar\ =\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ ?\ op(scalar,\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}])\ :\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}}[0];\ \},}
\DoxyCodeLine{00269\ \ \ \ \ \ \ \ \ tid,\ tile.count()}
\DoxyCodeLine{00270\ \ \ \ \ \ \ );}
\DoxyCodeLine{00271\ }
\DoxyCodeLine{00272\ \ \ \ \ \ \ \textcolor{comment}{//\ Reduce\ across\ all\ threads.}}
\DoxyCodeLine{00273\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ all\_reduce\ =\ \mbox{\hyperlink{structtf_1_1detail_1_1cuda_block_reduce}{cudaBlockReduce<E::nt,\ T>}}()(}
\DoxyCodeLine{00274\ \ \ \ \ \ \ \ \ tid,\ scalar,\ shm,\ tile.count(),\ op}
\DoxyCodeLine{00275\ \ \ \ \ \ \ );}
\DoxyCodeLine{00276\ }
\DoxyCodeLine{00277\ \ \ \ \ \ \ \textcolor{comment}{//\ Store\ the\ final\ reduction\ to\ the\ partials.}}
\DoxyCodeLine{00278\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!tid)\ \{}
\DoxyCodeLine{00279\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{sugar_8h_aaadc06b5dac8070de2c8677210967bdb}{buffer}}[bid]\ =\ all\_reduce;}
\DoxyCodeLine{00280\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00281\ \ \ \ \ \});}
\DoxyCodeLine{00282\ }
\DoxyCodeLine{00283\ \ \ \ \ \textcolor{comment}{//\ recursively\ call\ scan}}
\DoxyCodeLine{00284\ \ \ \ \ \textcolor{comment}{//cuda\_scan\_loop(p,\ cudaScanType::EXCLUSIVE,\ buffer,\ B,\ buffer,\ op,\ S);}}
\DoxyCodeLine{00285\ \ \ \ \ \mbox{\hyperlink{namespacetf_1_1detail_a10be6941d3e42a5583d07a092a7b083d}{cuda\_scan\_loop}}(}
\DoxyCodeLine{00286\ \ \ \ \ \ \ \mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}},\ \mbox{\hyperlink{namespacetf_1_1detail_a1f08990983d8305f1592fee1a3fdc593af45c3a0bb3687ed8e221253b3fd4a2ce}{cudaScanType::EXCLUSIVE}},\ \mbox{\hyperlink{sugar_8h_aaadc06b5dac8070de2c8677210967bdb}{buffer}},\ \mbox{\hyperlink{bench__gemm_8cpp_a37a83060ac796961b44991c836f083f7}{B}},\ \mbox{\hyperlink{sugar_8h_aaadc06b5dac8070de2c8677210967bdb}{buffer}},\ op,\ \mbox{\hyperlink{sugar_8h_aaadc06b5dac8070de2c8677210967bdb}{buffer}}+\mbox{\hyperlink{bench__gemm_8cpp_a37a83060ac796961b44991c836f083f7}{B}}}
\DoxyCodeLine{00287\ \ \ \ \ );}
\DoxyCodeLine{00288\ }
\DoxyCodeLine{00289\ \ \ \ \ \textcolor{comment}{//\ downsweep:\ perform\ an\ intra-\/tile\ scan\ and\ add\ the\ scan\ of\ the\ partials}}
\DoxyCodeLine{00290\ \ \ \ \ \textcolor{comment}{//\ as\ carry-\/in}}
\DoxyCodeLine{00291\ \ \ \ \ \mbox{\hyperlink{namespacetf_a2fa23f4109147679d05a25ee952c4baf}{cuda\_kernel}}<<<\mbox{\hyperlink{bench__gemm_8cpp_a37a83060ac796961b44991c836f083f7}{B}},\ E::nt,\ 0,\ \mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}}.stream()>>>([=]\ \_\_device\_\_\ (\textcolor{keyword}{auto}\ tid,\ \textcolor{keyword}{auto}\ bid)\ \{}
\DoxyCodeLine{00292\ }
\DoxyCodeLine{00293\ \ \ \ \ \ \ \textcolor{keyword}{using\ }scan\_t\ =\ \mbox{\hyperlink{structtf_1_1detail_1_1cuda_block_scan}{cudaBlockScan<E::nt,\ T>}};}
\DoxyCodeLine{00294\ }
\DoxyCodeLine{00295\ \ \ \ \ \ \ \_\_shared\_\_\ \textcolor{keyword}{union\ }\{}
\DoxyCodeLine{00296\ \ \ \ \ \ \ \ \ \textcolor{keyword}{typename}\ scan\_t::storage\_t\ scan;}
\DoxyCodeLine{00297\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}}\ values[E::nv];}
\DoxyCodeLine{00298\ \ \ \ \ \ \ \}\ \mbox{\hyperlink{sugar_8h_ae0940e50b16abd6b40d3cb35b1913da0}{shared}};}
\DoxyCodeLine{00299\ }
\DoxyCodeLine{00300\ \ \ \ \ \ \ \textcolor{comment}{//\ Load\ a\ tile\ to\ register\ in\ thread\ order.}}
\DoxyCodeLine{00301\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ tile\ =\ \mbox{\hyperlink{namespacetf_a5a41760b383016bd1cebadcfd7f05476}{cuda\_get\_tile}}(bid,\ E::nv,\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}});}
\DoxyCodeLine{00302\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}}\ =\ \mbox{\hyperlink{namespacetf_a6927bc7edeed8a199a267e44bd3374c3}{cuda\_mem\_to\_reg\_thread<E::nt,\ E::vt>}}(}
\DoxyCodeLine{00303\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_ab7e6955a695fad0be513586926040b1a}{input}}\ +\ tile.begin,\ tid,\ tile.count(),\ \mbox{\hyperlink{sugar_8h_ae0940e50b16abd6b40d3cb35b1913da0}{shared}}.values}
\DoxyCodeLine{00304\ \ \ \ \ \ \ );}
\DoxyCodeLine{00305\ }
\DoxyCodeLine{00306\ \ \ \ \ \ \ \textcolor{comment}{//\ Scan\ the\ array\ with\ carry-\/in\ from\ the\ partials.}}
\DoxyCodeLine{00307\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a5e247fc24ceb70d83f6ad59149b8910a}{y}}\ =\ scan\_t()(tid,\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}},\ \mbox{\hyperlink{sugar_8h_ae0940e50b16abd6b40d3cb35b1913da0}{shared}}.scan,}
\DoxyCodeLine{00308\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{sugar_8h_aaadc06b5dac8070de2c8677210967bdb}{buffer}}[bid],\ bid\ >\ 0,\ tile.count(),\ op,\ \mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}}(),}
\DoxyCodeLine{00309\ \ \ \ \ \ \ \ \ scan\_type).scan;}
\DoxyCodeLine{00310\ }
\DoxyCodeLine{00311\ \ \ \ \ \ \ \textcolor{comment}{//\ Store\ the\ scanned\ values\ to\ the\ output.}}
\DoxyCodeLine{00312\ \ \ \ \ \ \ \mbox{\hyperlink{namespacetf_a9b1d7b2192743447b2f0206b4510977f}{cuda\_reg\_to\_mem\_thread<E::nt,\ E::vt>}}(}
\DoxyCodeLine{00313\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a5e247fc24ceb70d83f6ad59149b8910a}{y}},\ tid,\ tile.count(),\ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}}\ +\ tile.begin,\ \mbox{\hyperlink{sugar_8h_ae0940e50b16abd6b40d3cb35b1913da0}{shared}}.values}
\DoxyCodeLine{00314\ \ \ \ \ \ \ );}
\DoxyCodeLine{00315\ \ \ \ \ \});}
\DoxyCodeLine{00316\ \ \ \}}
\DoxyCodeLine{00317\ \ \ \textcolor{comment}{//\ Small\ input\ specialization.\ This\ is\ the\ non-\/recursive\ branch.}}
\DoxyCodeLine{00318\ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00319\ \ \ \ \ \mbox{\hyperlink{namespacetf_1_1detail_a2c9669b414231e12f66e9d40ca9ae3a3}{cuda\_single\_pass\_scan}}(\mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}},\ scan\_type,\ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_ab7e6955a695fad0be513586926040b1a}{input}},\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}},\ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}},\ op);}
\DoxyCodeLine{00320\ \ \ \}}
\DoxyCodeLine{00321\ \}}
\DoxyCodeLine{00322\ }
\DoxyCodeLine{00323\ \}\ \ \textcolor{comment}{//\ namespace\ tf::detail\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00324\ }
\DoxyCodeLine{00325\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespacetf}{tf}}\ \{}
\DoxyCodeLine{00326\ }
\DoxyCodeLine{00327\ \textcolor{comment}{//\ Function:\ scan\_bufsz}}
\DoxyCodeLine{00328\ \textcolor{keyword}{template}\ <\textcolor{keywordtype}{unsigned}\ NT,\ \textcolor{keywordtype}{unsigned}\ VT>\ \ }
\DoxyCodeLine{00329\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00330\ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{classtf_1_1cuda_execution_policy_af25648b3269902b333cfcd58665005e8}{cudaExecutionPolicy<NT,\ VT>::scan\_bufsz}}(\textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}})\ \{}
\DoxyCodeLine{00331\ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{bench__gemm_8cpp_a37a83060ac796961b44991c836f083f7}{B}}\ =\ \mbox{\hyperlink{classtf_1_1cuda_execution_policy_ab96c478964fcba935aa99efe91a64e5c}{num\_blocks}}(\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}});}
\DoxyCodeLine{00332\ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}\ =\ 0;}
\DoxyCodeLine{00333\ \ \ \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}\ \mbox{\hyperlink{offscreen_8c_a846c9667e34d56c560bb7f0ac6e173f6}{b}}=\mbox{\hyperlink{bench__gemm_8cpp_a37a83060ac796961b44991c836f083f7}{B}};\ \mbox{\hyperlink{offscreen_8c_a846c9667e34d56c560bb7f0ac6e173f6}{b}}>\mbox{\hyperlink{namespacetf_1_1detail_acb48d657669121bb9dfd45662e5bf9e1}{detail::cudaScanRecursionThreshold}};\ \mbox{\hyperlink{offscreen_8c_a846c9667e34d56c560bb7f0ac6e173f6}{b}}=\mbox{\hyperlink{classtf_1_1cuda_execution_policy_ab96c478964fcba935aa99efe91a64e5c}{num\_blocks}}(\mbox{\hyperlink{offscreen_8c_a846c9667e34d56c560bb7f0ac6e173f6}{b}}))\ \{}
\DoxyCodeLine{00334\ \ \ \ \ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}\ +=\ \mbox{\hyperlink{offscreen_8c_a846c9667e34d56c560bb7f0ac6e173f6}{b}};}
\DoxyCodeLine{00335\ \ \ \}}
\DoxyCodeLine{00336\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}*\textcolor{keyword}{sizeof}(\mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}});}
\DoxyCodeLine{00337\ \}}
\DoxyCodeLine{00338\ }
\DoxyCodeLine{00339\ }
\DoxyCodeLine{00356\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ P,\ \textcolor{keyword}{typename}\ I,\ \textcolor{keyword}{typename}\ O,\ \textcolor{keyword}{typename}\ C>}
\DoxyCodeLine{00357\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{namespacetf_a2e1b44c84a09e0a8495a611cb9a7ea40}{cuda\_inclusive\_scan}}(}
\DoxyCodeLine{00358\ \ \ \mbox{\hyperlink{namespace_p}{P}}\&\&\ \mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}},\ I\ first,\ I\ last,\ O\ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}},\ \mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}}\ op,\ \textcolor{keywordtype}{void}*\ buf}
\DoxyCodeLine{00359\ )\ \{}
\DoxyCodeLine{00360\ }
\DoxyCodeLine{00361\ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}}\ =\ std::distance(first,\ last);}
\DoxyCodeLine{00362\ }
\DoxyCodeLine{00363\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}}\ ==\ 0)\ \{}
\DoxyCodeLine{00364\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00365\ \ \ \}}
\DoxyCodeLine{00366\ }
\DoxyCodeLine{00367\ \ \ \textcolor{comment}{//\ launch\ the\ scan\ loop}}
\DoxyCodeLine{00368\ \ \ \mbox{\hyperlink{namespacetf_1_1detail_a10be6941d3e42a5583d07a092a7b083d}{detail::cuda\_scan\_loop}}(}
\DoxyCodeLine{00369\ \ \ \ \ \mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}},\ \mbox{\hyperlink{namespacetf_1_1detail_a1f08990983d8305f1592fee1a3fdc593a572d795e2d044f895cc511e5c05030e5}{detail::cudaScanType::INCLUSIVE}},\ first,\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}},\ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}},\ op,\ buf}
\DoxyCodeLine{00370\ \ \ );}
\DoxyCodeLine{00371\ \}}
\DoxyCodeLine{00372\ }
\DoxyCodeLine{00391\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ P,\ \textcolor{keyword}{typename}\ I,\ \textcolor{keyword}{typename}\ O,\ \textcolor{keyword}{typename}\ C,\ \textcolor{keyword}{typename}\ U>}
\DoxyCodeLine{00392\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{namespacetf_afa4aa760ddb6efbda1b9bab505ad5baf}{cuda\_transform\_inclusive\_scan}}(}
\DoxyCodeLine{00393\ \ \ \mbox{\hyperlink{namespace_p}{P}}\&\&\ \mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}},\ I\ first,\ I\ last,\ O\ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}},\ \mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}}\ bop,\ U\ uop,\ \textcolor{keywordtype}{void}*\ buf}
\DoxyCodeLine{00394\ )\ \{}
\DoxyCodeLine{00395\ }
\DoxyCodeLine{00396\ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}}\ =\ \textcolor{keyword}{typename}\ std::iterator\_traits<O>::value\_type;}
\DoxyCodeLine{00397\ }
\DoxyCodeLine{00398\ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}}\ =\ std::distance(first,\ last);}
\DoxyCodeLine{00399\ }
\DoxyCodeLine{00400\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}}\ ==\ 0)\ \{}
\DoxyCodeLine{00401\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00402\ \ \ \}}
\DoxyCodeLine{00403\ }
\DoxyCodeLine{00404\ \ \ \textcolor{comment}{//\ launch\ the\ scan\ loop}}
\DoxyCodeLine{00405\ \ \ \mbox{\hyperlink{namespacetf_1_1detail_a10be6941d3e42a5583d07a092a7b083d}{detail::cuda\_scan\_loop}}(}
\DoxyCodeLine{00406\ \ \ \ \ \mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}},\ \mbox{\hyperlink{namespacetf_1_1detail_a1f08990983d8305f1592fee1a3fdc593a572d795e2d044f895cc511e5c05030e5}{detail::cudaScanType::INCLUSIVE}},}
\DoxyCodeLine{00407\ \ \ \ \ \mbox{\hyperlink{namespacetf_a8419f2a62fa1e991230fc3ca93c08c3b}{cuda\_make\_load\_iterator<T>}}([=]\_\_device\_\_(\textcolor{keyword}{auto}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\{\ \textcolor{keywordflow}{return}\ uop(*(first+\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}));\ \}),}
\DoxyCodeLine{00408\ \ \ \ \ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}},\ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}},\ bop,\ buf}
\DoxyCodeLine{00409\ \ \ );}
\DoxyCodeLine{00410\ \}}
\DoxyCodeLine{00411\ }
\DoxyCodeLine{00428\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ P,\ \textcolor{keyword}{typename}\ I,\ \textcolor{keyword}{typename}\ O,\ \textcolor{keyword}{typename}\ C>}
\DoxyCodeLine{00429\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{namespacetf_aeb391c40120844318fd715b8c3a716bb}{cuda\_exclusive\_scan}}(}
\DoxyCodeLine{00430\ \ \ \mbox{\hyperlink{namespace_p}{P}}\&\&\ \mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}},\ I\ first,\ I\ last,\ O\ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}},\ \mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}}\ op,\ \textcolor{keywordtype}{void}*\ buf}
\DoxyCodeLine{00431\ )\ \{}
\DoxyCodeLine{00432\ }
\DoxyCodeLine{00433\ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}}\ =\ std::distance(first,\ last);}
\DoxyCodeLine{00434\ }
\DoxyCodeLine{00435\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}}\ ==\ 0)\ \{}
\DoxyCodeLine{00436\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00437\ \ \ \}}
\DoxyCodeLine{00438\ }
\DoxyCodeLine{00439\ \ \ \textcolor{comment}{//\ launch\ the\ scan\ loop}}
\DoxyCodeLine{00440\ \ \ \mbox{\hyperlink{namespacetf_1_1detail_a10be6941d3e42a5583d07a092a7b083d}{detail::cuda\_scan\_loop}}(}
\DoxyCodeLine{00441\ \ \ \ \ \mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}},\ \mbox{\hyperlink{namespacetf_1_1detail_a1f08990983d8305f1592fee1a3fdc593af45c3a0bb3687ed8e221253b3fd4a2ce}{detail::cudaScanType::EXCLUSIVE}},\ first,\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}},\ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}},\ op,\ buf}
\DoxyCodeLine{00442\ \ \ );}
\DoxyCodeLine{00443\ \}}
\DoxyCodeLine{00444\ }
\DoxyCodeLine{00463\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ P,\ \textcolor{keyword}{typename}\ I,\ \textcolor{keyword}{typename}\ O,\ \textcolor{keyword}{typename}\ C,\ \textcolor{keyword}{typename}\ U>}
\DoxyCodeLine{00464\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{namespacetf_a2e739895c1c73538967af060ca714366}{cuda\_transform\_exclusive\_scan}}(}
\DoxyCodeLine{00465\ \ \ \mbox{\hyperlink{namespace_p}{P}}\&\&\ \mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}},\ I\ first,\ I\ last,\ O\ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}},\ \mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}}\ bop,\ U\ uop,\ \textcolor{keywordtype}{void}*\ buf}
\DoxyCodeLine{00466\ )\ \{}
\DoxyCodeLine{00467\ }
\DoxyCodeLine{00468\ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}}\ =\ \textcolor{keyword}{typename}\ std::iterator\_traits<O>::value\_type;}
\DoxyCodeLine{00469\ }
\DoxyCodeLine{00470\ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}}\ =\ std::distance(first,\ last);}
\DoxyCodeLine{00471\ }
\DoxyCodeLine{00472\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}}\ ==\ 0)\ \{}
\DoxyCodeLine{00473\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00474\ \ \ \}}
\DoxyCodeLine{00475\ }
\DoxyCodeLine{00476\ \ \ \textcolor{comment}{//\ launch\ the\ scan\ loop}}
\DoxyCodeLine{00477\ \ \ \mbox{\hyperlink{namespacetf_1_1detail_a10be6941d3e42a5583d07a092a7b083d}{detail::cuda\_scan\_loop}}(}
\DoxyCodeLine{00478\ \ \ \ \ \mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}},\ \mbox{\hyperlink{namespacetf_1_1detail_a1f08990983d8305f1592fee1a3fdc593af45c3a0bb3687ed8e221253b3fd4a2ce}{detail::cudaScanType::EXCLUSIVE}},}
\DoxyCodeLine{00479\ \ \ \ \ \mbox{\hyperlink{namespacetf_a8419f2a62fa1e991230fc3ca93c08c3b}{cuda\_make\_load\_iterator<T>}}([=]\_\_device\_\_(\textcolor{keyword}{auto}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\{\ \textcolor{keywordflow}{return}\ uop(*(first+\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}));\ \}),}
\DoxyCodeLine{00480\ \ \ \ \ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}},\ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}},\ bop,\ buf}
\DoxyCodeLine{00481\ \ \ );}
\DoxyCodeLine{00482\ \}}
\DoxyCodeLine{00483\ }
\DoxyCodeLine{00484\ }
\DoxyCodeLine{00485\ \}\ \ \textcolor{comment}{//\ end\ of\ namespace\ tf\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00486\ }
\DoxyCodeLine{00487\ }
\DoxyCodeLine{00488\ }

\end{DoxyCode}
