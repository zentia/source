\doxysection{binary\+\_\+buffer.\+h}
\hypertarget{binary__buffer_8h_source}{}\label{binary__buffer_8h_source}\index{runtime/core/binary\_buffer.h@{runtime/core/binary\_buffer.h}}
\mbox{\hyperlink{binary__buffer_8h}{浏览该文件的文档.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00002\ }
\DoxyCodeLine{00003\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{core_2stl_2vector_8h}{runtime/core/stl/vector.h}}>}}
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{core_2stl_2memory_8h}{runtime/core/stl/memory.h}}>}}
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{intrin_8h}{runtime/core/intrin.h}}>}}
\DoxyCodeLine{00006\ }
\DoxyCodeLine{00007\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespaceluisa}{luisa}}\ \{}
\DoxyCodeLine{00008\ }
\DoxyCodeLine{00009\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classluisa_1_1_binary_buffer_a67a9d20d0b51cf67e95d957ef6be1bb0}{BinaryBuffer}}\ \{}
\DoxyCodeLine{00010\ }
\DoxyCodeLine{00011\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00012\ \ \ \ \ luisa::vector<std::byte>\ \mbox{\hyperlink{classluisa_1_1_binary_buffer_a01bc5a88d46202ec8a8cdacc41411dec}{\_bytes}};}
\DoxyCodeLine{00013\ }
\DoxyCodeLine{00014\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00015\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classluisa_1_1_binary_buffer_a532d8ce670e9e121f7cbdf28fb879a55}{\_write\_bytes}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *\mbox{\hyperlink{classluisa_1_1_binary_buffer_afd9cb695188680fb66308ea68d605b29}{data}},\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classluisa_1_1_binary_buffer_ad407b7476867bb973dc51a4b54984339}{size}},\ \textcolor{keywordtype}{size\_t}\ alignment)\ \textcolor{keyword}{noexcept};}
\DoxyCodeLine{00016\ }
\DoxyCodeLine{00017\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00018\ \ \ \ \ \textcolor{keyword}{explicit}\ \mbox{\hyperlink{classluisa_1_1_binary_buffer_a67a9d20d0b51cf67e95d957ef6be1bb0}{BinaryBuffer}}(\textcolor{keywordtype}{size\_t}\ capacity\ =\ 1\_M)\ noexcept}
\DoxyCodeLine{00019\ \ \ \ \ \ \ \ \ :\ \mbox{\hyperlink{classluisa_1_1_binary_buffer_a01bc5a88d46202ec8a8cdacc41411dec}{\_bytes}}\{capacity\}\ \{\}}
\DoxyCodeLine{00020\ \ \ \ \ \textcolor{keyword}{explicit}\ \mbox{\hyperlink{classluisa_1_1_binary_buffer_abbc7d22ab5df15a01eb776d1024e478b}{BinaryBuffer}}(luisa::vector<std::byte>\ \&\&\mbox{\hyperlink{structbytes}{bytes}})\ noexcept}
\DoxyCodeLine{00021\ \ \ \ \ \ \ \ \ :\ \mbox{\hyperlink{classluisa_1_1_binary_buffer_a01bc5a88d46202ec8a8cdacc41411dec}{\_bytes}}\{std::move(\mbox{\hyperlink{structbytes}{bytes}})\}\ \{\}}
\DoxyCodeLine{00022\ \ \ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00023\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classluisa_1_1_binary_buffer_a2233cbacf5b9d921ac28c99cf24d94a8}{write}}(T\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a1b2be7bfa84f129a2690a62f3ad82d62}{value}})\ \textcolor{keyword}{noexcept}\ \{}
\DoxyCodeLine{00024\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classluisa_1_1_binary_buffer_a532d8ce670e9e121f7cbdf28fb879a55}{\_write\_bytes}}(\&\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a1b2be7bfa84f129a2690a62f3ad82d62}{value}},\ \textcolor{keyword}{sizeof}(T),\ \textcolor{keyword}{alignof}(T));}
\DoxyCodeLine{00025\ \ \ \ \ \}}
\DoxyCodeLine{00026\ \ \ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00027\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classluisa_1_1_binary_buffer_a90a2aff6541354b44276b053ec182f53}{write}}(\textcolor{keyword}{const}\ T\ *\mbox{\hyperlink{classluisa_1_1_binary_buffer_afd9cb695188680fb66308ea68d605b29}{data}},\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classluisa_1_1_binary_buffer_ad407b7476867bb973dc51a4b54984339}{size}})\ \textcolor{keyword}{noexcept}\ \{}
\DoxyCodeLine{00028\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classluisa_1_1_binary_buffer_a532d8ce670e9e121f7cbdf28fb879a55}{\_write\_bytes}}(\mbox{\hyperlink{classluisa_1_1_binary_buffer_afd9cb695188680fb66308ea68d605b29}{data}},\ \mbox{\hyperlink{classluisa_1_1_binary_buffer_ad407b7476867bb973dc51a4b54984339}{size}}\ *\ \textcolor{keyword}{sizeof}(T),\ \textcolor{keyword}{alignof}(T));}
\DoxyCodeLine{00029\ \ \ \ \ \}}
\DoxyCodeLine{00030\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classluisa_1_1_binary_buffer_a2b31b498c3847397853db32052dce152}{clear}}()\ noexcept\ \{\ \mbox{\hyperlink{classluisa_1_1_binary_buffer_a01bc5a88d46202ec8a8cdacc41411dec}{\_bytes}}.clear();\ \}}
\DoxyCodeLine{00031\ \ \ \ \ [[nodiscard]]\ \textcolor{keyword}{auto}\ \mbox{\hyperlink{classluisa_1_1_binary_buffer_afd9cb695188680fb66308ea68d605b29}{data}}()\ const\ noexcept\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classluisa_1_1_binary_buffer_a01bc5a88d46202ec8a8cdacc41411dec}{\_bytes}}.data();\ \}}
\DoxyCodeLine{00032\ \ \ \ \ [[nodiscard]]\ \textcolor{keyword}{auto}\ \mbox{\hyperlink{classluisa_1_1_binary_buffer_ad407b7476867bb973dc51a4b54984339}{size}}()\ const\ noexcept\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classluisa_1_1_binary_buffer_a01bc5a88d46202ec8a8cdacc41411dec}{\_bytes}}.size();\ \}}
\DoxyCodeLine{00033\ \ \ \ \ [[nodiscard]]\ \textcolor{keyword}{auto}\ \mbox{\hyperlink{classluisa_1_1_binary_buffer_abce64b4139f22c395d06fe71729e36fb}{move}}()\ noexcept\ \{\ \textcolor{keywordflow}{return}\ std::move(\mbox{\hyperlink{classluisa_1_1_binary_buffer_a01bc5a88d46202ec8a8cdacc41411dec}{\_bytes}});\ \}}
\DoxyCodeLine{00034\ \};}
\DoxyCodeLine{00035\ }
\DoxyCodeLine{00036\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classluisa_1_1_binary_buffer_reader_ab2e717eb62affdd53af6973bf5808699}{BinaryBufferReader}}\ \{}
\DoxyCodeLine{00037\ }
\DoxyCodeLine{00038\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00039\ \ \ \ \ \textcolor{keyword}{const}\ std::byte\ *\mbox{\hyperlink{classluisa_1_1_binary_buffer_reader_a49c90cca60547d6dede48c715ab2e2a0}{\_bytes}};}
\DoxyCodeLine{00040\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classluisa_1_1_binary_buffer_reader_af0b173f75b563604964f2c1fecec7c4e}{\_offset}};}
\DoxyCodeLine{00041\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classluisa_1_1_binary_buffer_reader_a35a69ffce0706bdfdb588ccfbd860262}{\_size}};}
\DoxyCodeLine{00042\ }
\DoxyCodeLine{00043\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00044\ \ \ \ \ \mbox{\hyperlink{classluisa_1_1_binary_buffer_reader_ab2e717eb62affdd53af6973bf5808699}{BinaryBufferReader}}(\textcolor{keyword}{const}\ std::byte\ *\mbox{\hyperlink{structbytes}{bytes}},\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a3d1e3edfcf61ca2d831883e1afbad89e}{size}})\ noexcept}
\DoxyCodeLine{00045\ \ \ \ \ \ \ \ \ :\ \mbox{\hyperlink{classluisa_1_1_binary_buffer_reader_a49c90cca60547d6dede48c715ab2e2a0}{\_bytes}}\{\mbox{\hyperlink{structbytes}{bytes}}\},\ \_offset\{0u\},\ \_size\{\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a3d1e3edfcf61ca2d831883e1afbad89e}{size}}\}\ \{\}}
\DoxyCodeLine{00046\ \ \ \ \ \textcolor{keyword}{explicit}\ \mbox{\hyperlink{classluisa_1_1_binary_buffer_reader_aa5f58e39462dc6e08ea0d8f1c69f44d5}{BinaryBufferReader}}(luisa::span<const\ std::byte>\ \mbox{\hyperlink{structbytes}{bytes}})\ noexcept}
\DoxyCodeLine{00047\ \ \ \ \ \ \ \ \ :\ \mbox{\hyperlink{classluisa_1_1_binary_buffer_reader_ab2e717eb62affdd53af6973bf5808699}{BinaryBufferReader}}\{\mbox{\hyperlink{structbytes}{bytes}}.\mbox{\hyperlink{structbytes_ae91a5605d84aee2211330e166635bd4e}{data}}(),\ \mbox{\hyperlink{structbytes}{bytes}}.size()\}\ \{\}}
\DoxyCodeLine{00048\ \ \ \ \ \textcolor{keyword}{explicit}\ \mbox{\hyperlink{classluisa_1_1_binary_buffer_reader_a9884c4fd7bbbfa523068cd46d9d27f4e}{BinaryBufferReader}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classluisa_1_1_binary_buffer}{BinaryBuffer}}\ \&\mbox{\hyperlink{sugar_8h_aaadc06b5dac8070de2c8677210967bdb}{buffer}})\ noexcept}
\DoxyCodeLine{00049\ \ \ \ \ \ \ \ \ :\ \mbox{\hyperlink{classluisa_1_1_binary_buffer_reader_ab2e717eb62affdd53af6973bf5808699}{BinaryBufferReader}}\{\mbox{\hyperlink{sugar_8h_aaadc06b5dac8070de2c8677210967bdb}{buffer}}.data(),\ \mbox{\hyperlink{sugar_8h_aaadc06b5dac8070de2c8677210967bdb}{buffer}}.size()\}\ \{\}}
\DoxyCodeLine{00050\ \ \ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00051\ \ \ \ \ [[nodiscard]]\ \textcolor{keyword}{auto}\ \mbox{\hyperlink{classluisa_1_1_binary_buffer_reader_afeb773683e9c947f363d4f258bb63021}{read}}()\ noexcept\ \{}
\DoxyCodeLine{00052\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classluisa_1_1_binary_buffer_reader_af0b173f75b563604964f2c1fecec7c4e}{\_offset}}\ =\ \mbox{\hyperlink{base_8h_a6c52c4bac77f6744fdc338766e9e8a6f}{align}}(\mbox{\hyperlink{classluisa_1_1_binary_buffer_reader_af0b173f75b563604964f2c1fecec7c4e}{\_offset}},\ \textcolor{keyword}{alignof}(T));}
\DoxyCodeLine{00053\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{intrin_8h_ad351e4b2eb5b3ef179845c849a96efac}{LUISA\_ASSUME}}(\mbox{\hyperlink{classluisa_1_1_binary_buffer_reader_af0b173f75b563604964f2c1fecec7c4e}{\_offset}}\ +\ \textcolor{keyword}{sizeof}(T)\ <=\ \mbox{\hyperlink{classluisa_1_1_binary_buffer_reader_a35a69ffce0706bdfdb588ccfbd860262}{\_size}});}
\DoxyCodeLine{00054\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ \mbox{\hyperlink{spdlog_2include_2spdlog_2fmt_2bundled_2format_8h_adb6e274f8eb0b74b2865215e1b49c535}{ptr}}\ =\ \mbox{\hyperlink{classluisa_1_1_binary_buffer_reader_a49c90cca60547d6dede48c715ab2e2a0}{\_bytes}}\ +\ \mbox{\hyperlink{classluisa_1_1_binary_buffer_reader_af0b173f75b563604964f2c1fecec7c4e}{\_offset}};}
\DoxyCodeLine{00055\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classluisa_1_1_binary_buffer_reader_af0b173f75b563604964f2c1fecec7c4e}{\_offset}}\ +=\ \textcolor{keyword}{sizeof}(T);}
\DoxyCodeLine{00056\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }T\ *\textcolor{keyword}{>}(\mbox{\hyperlink{spdlog_2include_2spdlog_2fmt_2bundled_2format_8h_adb6e274f8eb0b74b2865215e1b49c535}{ptr}});\textcolor{comment}{//\ FIXME:\ this\ is\ UB}}
\DoxyCodeLine{00057\ \ \ \ \ \}}
\DoxyCodeLine{00058\ \ \ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00059\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classluisa_1_1_binary_buffer_reader_a462d8e86da91ae1c712a3e331ca091f2}{read}}(T\ *dst,\ \textcolor{keywordtype}{size\_t}\ n)\ \textcolor{keyword}{noexcept}\ \{}
\DoxyCodeLine{00060\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classluisa_1_1_binary_buffer_reader_af0b173f75b563604964f2c1fecec7c4e}{\_offset}}\ =\ \mbox{\hyperlink{base_8h_a6c52c4bac77f6744fdc338766e9e8a6f}{align}}(\mbox{\hyperlink{classluisa_1_1_binary_buffer_reader_af0b173f75b563604964f2c1fecec7c4e}{\_offset}},\ \textcolor{keyword}{alignof}(T));}
\DoxyCodeLine{00061\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a3d1e3edfcf61ca2d831883e1afbad89e}{size}}\ =\ n\ *\ \textcolor{keyword}{sizeof}(T);}
\DoxyCodeLine{00062\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{intrin_8h_ad351e4b2eb5b3ef179845c849a96efac}{LUISA\_ASSUME}}(\mbox{\hyperlink{classluisa_1_1_binary_buffer_reader_af0b173f75b563604964f2c1fecec7c4e}{\_offset}}\ +\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a3d1e3edfcf61ca2d831883e1afbad89e}{size}}\ <=\ \mbox{\hyperlink{classluisa_1_1_binary_buffer_reader_a35a69ffce0706bdfdb588ccfbd860262}{\_size}});}
\DoxyCodeLine{00063\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ \mbox{\hyperlink{spdlog_2include_2spdlog_2fmt_2bundled_2format_8h_adb6e274f8eb0b74b2865215e1b49c535}{ptr}}\ =\ \mbox{\hyperlink{classluisa_1_1_binary_buffer_reader_a49c90cca60547d6dede48c715ab2e2a0}{\_bytes}}\ +\ \mbox{\hyperlink{classluisa_1_1_binary_buffer_reader_af0b173f75b563604964f2c1fecec7c4e}{\_offset}};}
\DoxyCodeLine{00064\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classluisa_1_1_binary_buffer_reader_af0b173f75b563604964f2c1fecec7c4e}{\_offset}}\ +=\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a3d1e3edfcf61ca2d831883e1afbad89e}{size}};}
\DoxyCodeLine{00065\ \ \ \ \ \ \ \ \ std::memcpy(dst,\ \mbox{\hyperlink{spdlog_2include_2spdlog_2fmt_2bundled_2format_8h_adb6e274f8eb0b74b2865215e1b49c535}{ptr}},\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a3d1e3edfcf61ca2d831883e1afbad89e}{size}});}
\DoxyCodeLine{00066\ \ \ \ \ \}}
\DoxyCodeLine{00067\ \};}
\DoxyCodeLine{00068\ }
\DoxyCodeLine{00069\ \}\textcolor{comment}{//\ namespace\ luisa}}
\DoxyCodeLine{00070\ }

\end{DoxyCode}
