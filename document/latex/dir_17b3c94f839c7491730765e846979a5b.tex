\doxysection{external/reflect-\/cpp/benchmarks 目录参考}
\hypertarget{dir_17b3c94f839c7491730765e846979a5b}{}\label{dir_17b3c94f839c7491730765e846979a5b}\index{external/reflect-\/cpp/benchmarks 目录参考@{external/reflect-\/cpp/benchmarks 目录参考}}
benchmarks 的目录依赖关系图
% FIG 0
\doxysubsubsection*{目录}
\begin{DoxyCompactItemize}
\item 
目录 \mbox{\hyperlink{dir_afd327ac50190181c362431514130030}{all}}
\item 
目录 \mbox{\hyperlink{dir_e829e2f0eb6c7c55ddc5ba42735ab6ed}{json}}
\end{DoxyCompactItemize}


\doxysubsection{详细描述}
reflect-\/cpp conducts continuuous benchmarking through its \href{https://github.com/getml/reflect-cpp/actions}{\texttt{ Github Actions}} pipelines for different compilers, operating systems and architectures. Currently, we benchmark the following\+:


\begin{DoxyEnumerate}
\item How reflect-\/cpp\textquotesingle{}s JSON parser compares to other JSON libraries for C or C++
\item How the different formats supported by reflect-\/cpp compare to each other
\end{DoxyEnumerate}\hypertarget{README.md_autotoc_md517}{}\doxysubsection{\texorpdfstring{Viewing the benchmark results}{Viewing the benchmark results}}\label{README.md_autotoc_md517}
To view the benchmark results, go to the \href{https://github.com/getml/reflect-cpp/actions}{\texttt{ Actions tab}} of this Github repository, click on a recent run you are interested in and scroll down to view the summary.\hypertarget{README.md_autotoc_md518}{}\doxysubsection{\texorpdfstring{Running the benchmark results on your own machine}{Running the benchmark results on your own machine}}\label{README.md_autotoc_md518}
Make sure that you have vcpkg installed. Refer to the README in the root folder of this repository to learn how to install vcpkg.

To compile the benchmarks, do the following\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{cmake\ -\/S\ .\ -\/B\ build\ -\/DCMAKE\_CXX\_STANDARD=20\ -\/DCMAKE\_BUILD\_TYPE=Release\ -\/DREFLECTCPP\_BUILD\_BENCHMARKS=ON}
\DoxyCodeLine{cmake\ -\/-\/build\ build\ -\/j\ 4\ \#\ gcc,\ clang}
\DoxyCodeLine{cmake\ -\/-\/build\ build\ -\/-\/config\ Release\ -\/j\ 4\ \#\ MSVC}

\end{DoxyCode}


To run the benchmarks, do the following\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{./build/benchmarks/json/reflect-\/cpp-\/json-\/benchmarks}
\DoxyCodeLine{./build/benchmarks/all/reflect-\/cpp-\/all-\/format-\/benchmarks}

\end{DoxyCode}


Note that the benchmarks are based on Google Benchmarks. You can use the {\ttfamily -\/-\/benchmark\+\_\+filter} flag to only run some of the benchmarks\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{./build/benchmarks/all/reflect-\/cpp-\/all-\/format-\/benchmarks\ -\/-\/benchmark\_filter=canada\_read}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md519}{}\doxysubsection{\texorpdfstring{Results summary}{Results summary}}\label{README.md_autotoc_md519}
\hypertarget{README.md_autotoc_md520}{}\doxysubsubsection{\texorpdfstring{How reflect-\/cpp compares to other JSON libraries}{How reflect-\/cpp compares to other JSON libraries}}\label{README.md_autotoc_md520}

\begin{DoxyItemize}
\item reflect-\/cpp is currently slightly slower than the fastest JSON libraries for C and C++, namely simd\+JSON and yyjson. We are working on getting that overhead down to zero.
\item reflect-\/cpp is consistently faster than Rapid\+JSON, usually about twice as fast.
\item reflect-\/cpp is consistently about 10 times faster than nlohmann/json, which is undeniably the most popular JSON library for C++.
\end{DoxyItemize}

In summary, it is fair to say that reflect-\/cpp is among the fastest JSON libraries for C++. It also considerably more convenient\+: If you look at the benchmark code, you will find that you can implement the serialization and deserialization using a single line of code with reflect-\/cpp, but you will need about 50-\/90 lines of code to do the same with other libraries (including nlohmann/json). ~\newline
\hypertarget{README.md_autotoc_md521}{}\doxysubsubsection{\texorpdfstring{How the different formats supported by reflect-\/cpp compare to each other}{How the different formats supported by reflect-\/cpp compare to each other}}\label{README.md_autotoc_md521}

\begin{DoxyItemize}
\item flexbuffers and msgpack are the fastest two formats supported by reflect-\/cpp. They are particularly fast on datasets with a lot of numerical data, such as {\itshape canada}. flexbuffers is usually the fastest at reading data and msgpack is the fastest at writing.
\item JSON is surprisingly fast. This is because reflect-\/cpp\textquotesingle{}s JSON parser is built on top of yyjson, arguably the fastest JSON library for C or C++.
\item The performance of CBOR is disappointing. We have tried swapping out the underlying library, Tiny\+CBOR, for libcbor, but the results are similar.
\item TOML and YAML are very slow when compared to the other formats. To be fair, these formats emphasize readability rather than speed.
\end{DoxyItemize}

In summary, if you are looking for a format that emphasizes speed, msgpack is probably your best bet. Not only does it perform very well on our benchmarks, but there are also many high-\/quality implementations in other languages. If you are looking for a good trade-\/off between speed and readability, you should probably just stick with JSON.

The benchmarks depicted below were conducted using gcc 11.\+4 on Ubuntu 22.\+4.


\begin{DoxyItemize}
\item {\bfseries{Canada}} -\/ dataset that is heavy on floats, few field names.
\end{DoxyItemize}

 


\begin{DoxyItemize}
\item {\bfseries{Licenses}} -\/ dataset that is nested, many strings.
\end{DoxyItemize}

 


\begin{DoxyItemize}
\item {\bfseries{Person}} -\/ very small dataset.
\end{DoxyItemize}

  