\doxysection{Single Task}
\hypertarget{_c_u_d_a_s_t_d_single_task}{}\label{_c_u_d_a_s_t_d_single_task}\index{Single \%Task@{Single \%Task}}
Taskflow provides a standard template method for running a callable using a single GPU thread.\hypertarget{_c_u_d_a_s_t_d_single_task_CUDASTDSingleTaskIncludeTheHeader}{}\doxysubsection{\texorpdfstring{Include the Header}{Include the Header}}\label{_c_u_d_a_s_t_d_single_task_CUDASTDSingleTaskIncludeTheHeader}
You need to include the header file, {\ttfamily taskflow/cuda/algorithm/for\+\_\+each.hpp}, for creating a single-\/threaded task.


\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{taskflow_2cuda_2algorithm_2for__each_8hpp}{taskflow/cuda/algorithm/for\_each.hpp}}>}}

\end{DoxyCode}
\hypertarget{_c_u_d_a_s_t_d_single_task_CUDASTDSingleTaskRunATaskWithASingleThread}{}\doxysubsection{\texorpdfstring{Run a Task with a Single Thread}{Run a Task with a Single Thread}}\label{_c_u_d_a_s_t_d_single_task_CUDASTDSingleTaskRunATaskWithASingleThread}
You can launch a kernel with only one GPU thread running it, which is handy when you want to set up a single or a few variables that do not need multiple threads. The following example creates a single-\/task kernel that sets a device variable to {\ttfamily 1}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\mbox{\hyperlink{namespacetf_af19c9b301dc0b0fe2a51a960fa427e83}{tf::cudaStream}}\ stream;}
\DoxyCodeLine{\mbox{\hyperlink{namespacetf_a0c8e4b43b5822445e2316659bbd44245}{tf::cudaDefaultExecutionPolicy}}\ policy(stream);}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{//\ launch\ the\ single-\/task\ kernel\ asynchronously\ through\ the\ policy}}
\DoxyCodeLine{\mbox{\hyperlink{namespacetf_a2ff1cf81426c856fc6db1f6ead47878f}{tf::cuda\_single\_task}}(policy,\ [gpu\_variable]\ \_\_device\_\_\ ()\ \{}
\DoxyCodeLine{\ \ *gpu\_Variable\ =\ 1;}
\DoxyCodeLine{\});}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{//\ wait\ for\ the\ kernel\ completes}}
\DoxyCodeLine{stream.\mbox{\hyperlink{classtf_1_1cuda_stream_base_a08857ff2874cd5378e578822e2e96dd0}{synchronize}}();}

\end{DoxyCode}


Since the callable runs on GPU, it must be declared with a {\ttfamily \+\_\+\+\_\+device\+\_\+\+\_\+} specifier. 