\doxysection{BDCSVD.\+h}
\hypertarget{_b_d_c_s_v_d_8h_source}{}\label{_b_d_c_s_v_d_8h_source}\index{external/taskflow/3rd-\/party/eigen-\/3.3.7/Eigen/src/SVD/BDCSVD.h@{external/taskflow/3rd-\/party/eigen-\/3.3.7/Eigen/src/SVD/BDCSVD.h}}
\mbox{\hyperlink{_b_d_c_s_v_d_8h}{浏览该文件的文档.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ This\ file\ is\ part\ of\ Eigen,\ a\ lightweight\ C++\ template\ library}}
\DoxyCodeLine{00002\ \textcolor{comment}{//\ for\ linear\ algebra.}}
\DoxyCodeLine{00003\ \textcolor{comment}{//\ }}
\DoxyCodeLine{00004\ \textcolor{comment}{//\ We\ used\ the\ "{}A\ Divide-\/And-\/Conquer\ Algorithm\ for\ the\ Bidiagonal\ SVD"{}}}
\DoxyCodeLine{00005\ \textcolor{comment}{//\ research\ report\ written\ by\ Ming\ Gu\ and\ Stanley\ C.Eisenstat}}
\DoxyCodeLine{00006\ \textcolor{comment}{//\ The\ code\ variable\ names\ correspond\ to\ the\ names\ they\ used\ in\ their\ }}
\DoxyCodeLine{00007\ \textcolor{comment}{//\ report}}
\DoxyCodeLine{00008\ \textcolor{comment}{//}}
\DoxyCodeLine{00009\ \textcolor{comment}{//\ Copyright\ (C)\ 2013\ Gauthier\ Brun\ <brun.gauthier@gmail.com>}}
\DoxyCodeLine{00010\ \textcolor{comment}{//\ Copyright\ (C)\ 2013\ Nicolas\ Carre\ <nicolas.carre@ensimag.fr>}}
\DoxyCodeLine{00011\ \textcolor{comment}{//\ Copyright\ (C)\ 2013\ Jean\ Ceccato\ <jean.ceccato@ensimag.fr>}}
\DoxyCodeLine{00012\ \textcolor{comment}{//\ Copyright\ (C)\ 2013\ Pierre\ Zoppitelli\ <pierre.zoppitelli@ensimag.fr>}}
\DoxyCodeLine{00013\ \textcolor{comment}{//\ Copyright\ (C)\ 2013\ Jitse\ Niesen\ <jitse@maths.leeds.ac.uk>}}
\DoxyCodeLine{00014\ \textcolor{comment}{//\ Copyright\ (C)\ 2014-\/2017\ Gael\ Guennebaud\ <gael.guennebaud@inria.fr>}}
\DoxyCodeLine{00015\ \textcolor{comment}{//}}
\DoxyCodeLine{00016\ \textcolor{comment}{//\ Source\ Code\ Form\ is\ subject\ to\ the\ terms\ of\ the\ Mozilla}}
\DoxyCodeLine{00017\ \textcolor{comment}{//\ Public\ License\ v.\ 2.0.\ If\ a\ copy\ of\ the\ MPL\ was\ not\ distributed}}
\DoxyCodeLine{00018\ \textcolor{comment}{//\ with\ this\ file,\ You\ can\ obtain\ one\ at\ http://mozilla.org/MPL/2.0/.}}
\DoxyCodeLine{00019\ }
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#ifndef\ EIGEN\_BDCSVD\_H}}
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#define\ EIGEN\_BDCSVD\_H}}
\DoxyCodeLine{00022\ \textcolor{comment}{//\ \#define\ EIGEN\_BDCSVD\_DEBUG\_VERBOSE}}
\DoxyCodeLine{00023\ \textcolor{comment}{//\ \#define\ EIGEN\_BDCSVD\_SANITY\_CHECKS}}
\DoxyCodeLine{00024\ }
\DoxyCodeLine{00025\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespace_eigen}{Eigen}}\ \{}
\DoxyCodeLine{00026\ }
\DoxyCodeLine{00027\ \textcolor{preprocessor}{\#ifdef\ EIGEN\_BDCSVD\_DEBUG\_VERBOSE}}
\DoxyCodeLine{00028\ \mbox{\hyperlink{struct_eigen_1_1_i_o_format}{IOFormat}}\ bdcsvdfmt(8,\ 0,\ \textcolor{stringliteral}{"{},\ "{}},\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}},\ \textcolor{stringliteral}{"{}\ \ ["{}},\ \textcolor{stringliteral}{"{}]"{}});}
\DoxyCodeLine{00029\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00030\ \ \ }
\DoxyCodeLine{00031\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ \_MatrixType>\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d}{BDCSVD}};}
\DoxyCodeLine{00032\ }
\DoxyCodeLine{00033\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespace_eigen_1_1internal}{internal}}\ \{}
\DoxyCodeLine{00034\ }
\DoxyCodeLine{00035\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ \_MatrixType>\ }
\DoxyCodeLine{00036\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_eigen_1_1internal_1_1traits}{traits}}<\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d}{BDCSVD}}<\_MatrixType>\ >}
\DoxyCodeLine{00037\ \{}
\DoxyCodeLine{00038\ \ \ \textcolor{keyword}{typedef}\ \_MatrixType\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1traits_3_01_b_d_c_s_v_d_3_01___matrix_type_01_4_01_4_afd85342058bafd2b0fd201db71b54f50}{MatrixType}};}
\DoxyCodeLine{00039\ \};\ \ }
\DoxyCodeLine{00040\ }
\DoxyCodeLine{00041\ \}\ \textcolor{comment}{//\ end\ namespace\ internal}}
\DoxyCodeLine{00042\ \ \ }
\DoxyCodeLine{00043\ \ \ }
\DoxyCodeLine{00066\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ \_MatrixType>\ }
\DoxyCodeLine{00067\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a39514816d38f9c418cf3f3514b511c2c}{BDCSVD}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base_abed06fc6f4b743e1f76a7b317539da87}{SVDBase}}<BDCSVD<\_MatrixType>\ >}
\DoxyCodeLine{00068\ \{}
\DoxyCodeLine{00069\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base_abed06fc6f4b743e1f76a7b317539da87}{SVDBase<BDCSVD>}}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a5c60affb78af5d30fd51b4c743bea9bb}{Base}};}
\DoxyCodeLine{00070\ \ \ \ \ }
\DoxyCodeLine{00071\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00072\ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{class_eigen_1_1_s_v_d_base_ab1a0d1fcc818a876c3cb2b32887604be}{Base::rows}};}
\DoxyCodeLine{00073\ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a083d99e05949bab974bbff2966606b7f}{Base::cols}};}
\DoxyCodeLine{00074\ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a705a7c2709e1624ccc19aa748a78d473}{Base::computeU}};}
\DoxyCodeLine{00075\ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a5f12efcb791eb007d4a4890ac5255ac4}{Base::computeV}};}
\DoxyCodeLine{00076\ \ \ }
\DoxyCodeLine{00077\ \ \ \textcolor{keyword}{typedef}\ \_MatrixType\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a8c3310eee662af4ca2428f7afd1472ed}{MatrixType}};}
\DoxyCodeLine{00078\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ MatrixType::Scalar\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_aaeab2cfc3f87e2a2c595a9d5b4d97c71}{Scalar}};}
\DoxyCodeLine{00079\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{struct_eigen_1_1_generic_num_traits_abca8573812593670795c41f22aa9d5e2}{NumTraits<typename\ MatrixType::Scalar>::Real}}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a1b429d828258ec58c1fc4ced6213d64d}{RealScalar}};}
\DoxyCodeLine{00080\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{struct_eigen_1_1_generic_num_traits_a34fa8e563e027d5e862f4031d020b631}{NumTraits<RealScalar>::Literal}}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_aad17038f9628ce5ed6e1461a67cd3a03}{Literal}};}
\DoxyCodeLine{00081\ \ \ \textcolor{keyword}{enum}\ \{}
\DoxyCodeLine{00082\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a562492e1de27e30563cee13095f02bccaa0222fb3be5089e2f7ca67e1e2882954}{RowsAtCompileTime}}\ =\ MatrixType::RowsAtCompileTime,\ }
\DoxyCodeLine{00083\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a562492e1de27e30563cee13095f02bccaf0a020e5fd77a8f6f2cfb7145c8da295}{ColsAtCompileTime}}\ =\ MatrixType::ColsAtCompileTime,\ }
\DoxyCodeLine{00084\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a562492e1de27e30563cee13095f02bcca135cfd5fd712f17e50bdc0efa61cc366}{DiagSizeAtCompileTime}}\ =\ \mbox{\hyperlink{eigen-3_83_87_2_eigen_2src_2_core_2util_2_macros_8h_a2a07ba221d47a7d636fd13678c8c75b3}{EIGEN\_SIZE\_MIN\_PREFER\_DYNAMIC}}(\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a562492e1de27e30563cee13095f02bccaa0222fb3be5089e2f7ca67e1e2882954}{RowsAtCompileTime}},\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a562492e1de27e30563cee13095f02bccaf0a020e5fd77a8f6f2cfb7145c8da295}{ColsAtCompileTime}}),\ }
\DoxyCodeLine{00085\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a562492e1de27e30563cee13095f02bcca75ab90cba2fd1bdc327e07d349be1fd9}{MaxRowsAtCompileTime}}\ =\ MatrixType::MaxRowsAtCompileTime,\ }
\DoxyCodeLine{00086\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a562492e1de27e30563cee13095f02bcca0d30a3a19367ab871e64a980aea219f0}{MaxColsAtCompileTime}}\ =\ MatrixType::MaxColsAtCompileTime,\ }
\DoxyCodeLine{00087\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a562492e1de27e30563cee13095f02bccab37c73c7ace3196b7a9b799a33492116}{MaxDiagSizeAtCompileTime}}\ =\ \mbox{\hyperlink{eigen-3_83_87_2_eigen_2src_2_core_2util_2_macros_8h_af2d58514e6156c4da2d4af66fafd0b12}{EIGEN\_SIZE\_MIN\_PREFER\_FIXED}}(\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a562492e1de27e30563cee13095f02bcca75ab90cba2fd1bdc327e07d349be1fd9}{MaxRowsAtCompileTime}},\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a562492e1de27e30563cee13095f02bcca0d30a3a19367ab871e64a980aea219f0}{MaxColsAtCompileTime}}),\ }
\DoxyCodeLine{00088\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a562492e1de27e30563cee13095f02bccaaac5b9fa1cd1464ae3ec6ffa7b86a95d}{MatrixOptions}}\ =\ MatrixType::Options}
\DoxyCodeLine{00089\ \ \ \};}
\DoxyCodeLine{00090\ }
\DoxyCodeLine{00091\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base_ab62c306c5d1efeae9bce88dee1b04965}{Base::MatrixUType}}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a4c38005126c75b1ba3b1b95117b4546d}{MatrixUType}};}
\DoxyCodeLine{00092\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base_af2ec05d33dd5be28df6fcf56346e23ec}{Base::MatrixVType}}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a1a1140cddb7727637b5e33d9f3b13299}{MatrixVType}};}
\DoxyCodeLine{00093\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a12b2496fb3a6e0e1faa3e6723ced20b7}{Base::SingularValuesType}}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a44cd685aa8d3807c006f6557bd69abf8}{SingularValuesType}};}
\DoxyCodeLine{00094\ \ \ }
\DoxyCodeLine{00095\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{class_eigen_1_1_matrix}{Matrix<Scalar,\ Dynamic,\ Dynamic,\ ColMajor>}}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_acf9211e5353d60fc3209d62fa0e2bdf7}{MatrixX}};}
\DoxyCodeLine{00096\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{class_eigen_1_1_matrix}{Matrix<RealScalar,\ Dynamic,\ Dynamic,\ ColMajor>}}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a7b32c2adca9f10283820f437f08f6271}{MatrixXr}};}
\DoxyCodeLine{00097\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{class_eigen_1_1_matrix}{Matrix<RealScalar,\ Dynamic,\ 1>}}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a0ea2c57bf088d5fc480ad81945157079}{VectorType}};}
\DoxyCodeLine{00098\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{class_eigen_1_1_array}{Array<RealScalar,\ Dynamic,\ 1>}}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a1e177918a1acf8153ff5f323fbeed9fe}{ArrayXr}};}
\DoxyCodeLine{00099\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{class_eigen_1_1_array}{Array<Index,1,Dynamic>}}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a9dea0e28217993ad7de85351357724a7}{ArrayXi}};}
\DoxyCodeLine{00100\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{class_eigen_1_1_ref}{Ref<ArrayXr>}}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_ad30a7a883b86028c45559593c7a678a2}{ArrayRef}};}
\DoxyCodeLine{00101\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{class_eigen_1_1_ref}{Ref<ArrayXi>}}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_aab1c377c616062cc85356e47312cb412}{IndicesRef}};}
\DoxyCodeLine{00102\ }
\DoxyCodeLine{00108\ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a39514816d38f9c418cf3f3514b511c2c}{BDCSVD}}()\ :\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a1e07b25c4a606cee8f34cdc75189a3b8}{m\_algoswap}}(16),\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_ade7ebb87b1735432218681831b1801cc}{m\_numIters}}(0)}
\DoxyCodeLine{00109\ \ \ \{\}}
\DoxyCodeLine{00110\ }
\DoxyCodeLine{00111\ }
\DoxyCodeLine{00118\ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a3e1fa48b3d042b7daf7392724a68bb60}{BDCSVD}}(\mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a3fb1d6a28b00ec36e9d5aaa1a98117c6}{rows}},\ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a9239b32c45bf81eff7be82bd4e97ee59}{cols}},\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ computationOptions\ =\ 0)}
\DoxyCodeLine{00119\ \ \ \ \ :\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a1e07b25c4a606cee8f34cdc75189a3b8}{m\_algoswap}}(16),\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_ade7ebb87b1735432218681831b1801cc}{m\_numIters}}(0)}
\DoxyCodeLine{00120\ \ \ \{}
\DoxyCodeLine{00121\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a870393d7d95401a45fd65a3ff8b38bfb}{allocate}}(\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a3fb1d6a28b00ec36e9d5aaa1a98117c6}{rows}},\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a9239b32c45bf81eff7be82bd4e97ee59}{cols}},\ computationOptions);}
\DoxyCodeLine{00122\ \ \ \}}
\DoxyCodeLine{00123\ }
\DoxyCodeLine{00134\ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a302746d9c534cd513c1df87c7ae4850d}{BDCSVD}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a8c3310eee662af4ca2428f7afd1472ed}{MatrixType}}\&\ \mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}},\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ computationOptions\ =\ 0)}
\DoxyCodeLine{00135\ \ \ \ \ :\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a1e07b25c4a606cee8f34cdc75189a3b8}{m\_algoswap}}(16),\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_ade7ebb87b1735432218681831b1801cc}{m\_numIters}}(0)}
\DoxyCodeLine{00136\ \ \ \{}
\DoxyCodeLine{00137\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a52e3c627775010775c64d16a00cdb770}{compute}}(\mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}},\ computationOptions);}
\DoxyCodeLine{00138\ \ \ \}}
\DoxyCodeLine{00139\ }
\DoxyCodeLine{00140\ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_abdf2b178ad413766bc1b292fcef701e2}{\string~BDCSVD}}()\ }
\DoxyCodeLine{00141\ \ \ \{}
\DoxyCodeLine{00142\ \ \ \}}
\DoxyCodeLine{00143\ \ \ }
\DoxyCodeLine{00154\ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d}{BDCSVD}}\&\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a52e3c627775010775c64d16a00cdb770}{compute}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_transform}{MatrixType}}\&\ \mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}},\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ computationOptions);}
\DoxyCodeLine{00155\ }
\DoxyCodeLine{00162\ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a39514816d38f9c418cf3f3514b511c2c}{BDCSVD}}\&\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a61880a5f6dbf7a14f91be80eaa3a22bc}{compute}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a8c3310eee662af4ca2428f7afd1472ed}{MatrixType}}\&\ \mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}})}
\DoxyCodeLine{00163\ \ \ \{}
\DoxyCodeLine{00164\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a52e3c627775010775c64d16a00cdb770}{compute}}(\mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}},\ this-\/>\mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a680646d2f3fa0de030cbf9b4815d6cda}{m\_computationOptions}});}
\DoxyCodeLine{00165\ \ \ \}}
\DoxyCodeLine{00166\ }
\DoxyCodeLine{00167\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_aa21c0cc5e99c861970bae45d94cae9ad}{setSwitchSize}}(\textcolor{keywordtype}{int}\ \mbox{\hyperlink{main-override_8cpp_a1384e7608274313a9433fa573868557b}{s}})\ }
\DoxyCodeLine{00168\ \ \ \{}
\DoxyCodeLine{00169\ \ \ \ \ \mbox{\hyperlink{eigen-3_83_87_2_eigen_2src_2_core_2util_2_macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(\mbox{\hyperlink{main-override_8cpp_a1384e7608274313a9433fa573868557b}{s}}>3\ \&\&\ \textcolor{stringliteral}{"{}BDCSVD\ the\ size\ of\ the\ algo\ switch\ has\ to\ be\ greater\ than\ 3"{}});}
\DoxyCodeLine{00170\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a1e07b25c4a606cee8f34cdc75189a3b8}{m\_algoswap}}\ =\ \mbox{\hyperlink{main-override_8cpp_a1384e7608274313a9433fa573868557b}{s}};}
\DoxyCodeLine{00171\ \ \ \}}
\DoxyCodeLine{00172\ \ }
\DoxyCodeLine{00173\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00174\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a870393d7d95401a45fd65a3ff8b38bfb}{allocate}}(\mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ \mbox{\hyperlink{_tutorial__commainit__02_8cpp_a061459acc9e078fa4699e0e349887215}{rows}},\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ \mbox{\hyperlink{_tutorial__commainit__02_8cpp_a4407a60bc4387adae24cee658711f2d9}{cols}},\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ computationOptions);}
\DoxyCodeLine{00175\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_aefd73cc6b7a9ffc922c8d615efba2a52}{divide}}(\mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ firstCol,\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ lastCol,\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ firstRowW,\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ firstColW,\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ shift);}
\DoxyCodeLine{00176\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_ae5909813a632db6095ebd8af8541858a}{computeSVDofM}}(\mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ firstCol,\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}},\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a7b32c2adca9f10283820f437f08f6271}{MatrixXr}}\&\ U,\ \mbox{\hyperlink{struct_vector_type}{VectorType}}\&\ singVals,\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a7b32c2adca9f10283820f437f08f6271}{MatrixXr}}\&\ \mbox{\hyperlink{_eigen_solver___eigen_solver___matrix_type_8cpp_a77c224aa52b434918ce65c33175aa8ad}{V}});}
\DoxyCodeLine{00177\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_ae1e384bc66726e45f96e7f0cc054487a}{computeSingVals}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_ad30a7a883b86028c45559593c7a678a2}{ArrayRef}}\&\ col0,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_ad30a7a883b86028c45559593c7a678a2}{ArrayRef}}\&\ diag,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_aab1c377c616062cc85356e47312cb412}{IndicesRef}}\&\ perm,\ \mbox{\hyperlink{struct_vector_type}{VectorType}}\&\ singVals,\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_ad30a7a883b86028c45559593c7a678a2}{ArrayRef}}\ shifts,\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_ad30a7a883b86028c45559593c7a678a2}{ArrayRef}}\ mus);}
\DoxyCodeLine{00178\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a7f023b27fd80bd56632fdad81c4c8b4b}{perturbCol0}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_ad30a7a883b86028c45559593c7a678a2}{ArrayRef}}\&\ col0,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_ad30a7a883b86028c45559593c7a678a2}{ArrayRef}}\&\ diag,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_aab1c377c616062cc85356e47312cb412}{IndicesRef}}\&\ perm,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_vector_type}{VectorType}}\&\ singVals,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_ad30a7a883b86028c45559593c7a678a2}{ArrayRef}}\&\ shifts,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_ad30a7a883b86028c45559593c7a678a2}{ArrayRef}}\&\ mus,\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_ad30a7a883b86028c45559593c7a678a2}{ArrayRef}}\ zhat);}
\DoxyCodeLine{00179\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a2e28be342355e1414d26cfd65325ba7f}{computeSingVecs}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_ad30a7a883b86028c45559593c7a678a2}{ArrayRef}}\&\ zhat,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_ad30a7a883b86028c45559593c7a678a2}{ArrayRef}}\&\ diag,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_aab1c377c616062cc85356e47312cb412}{IndicesRef}}\&\ perm,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_vector_type}{VectorType}}\&\ singVals,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_ad30a7a883b86028c45559593c7a678a2}{ArrayRef}}\&\ shifts,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_ad30a7a883b86028c45559593c7a678a2}{ArrayRef}}\&\ mus,\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a7b32c2adca9f10283820f437f08f6271}{MatrixXr}}\&\ U,\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a7b32c2adca9f10283820f437f08f6271}{MatrixXr}}\&\ \mbox{\hyperlink{_eigen_solver___eigen_solver___matrix_type_8cpp_a77c224aa52b434918ce65c33175aa8ad}{V}});}
\DoxyCodeLine{00180\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a7d8b1d486b13d72658b7ad44430e82e2}{deflation43}}(\mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ firstCol,\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ shift,\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}},\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}});}
\DoxyCodeLine{00181\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a2a3ab669d075f81714bafe4088ae6074}{deflation44}}(\mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ firstColu\ ,\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ firstColm,\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ firstRowW,\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ firstColW,\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}},\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}},\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}});}
\DoxyCodeLine{00182\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_abf371e539b921d6f4821bf8e87f7ef32}{deflation}}(\mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ firstCol,\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ lastCol,\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ k,\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ firstRowW,\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ firstColW,\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ shift);}
\DoxyCodeLine{00183\ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ HouseholderU,\ \textcolor{keyword}{typename}\ HouseholderV,\ \textcolor{keyword}{typename}\ NaiveU,\ \textcolor{keyword}{typename}\ NaiveV>}
\DoxyCodeLine{00184\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_aa059639383ca600f198cd178de5f116c}{copyUV}}(\textcolor{keyword}{const}\ HouseholderU\ \&householderU,\ \textcolor{keyword}{const}\ HouseholderV\ \&householderV,\ \textcolor{keyword}{const}\ NaiveU\ \&naiveU,\ \textcolor{keyword}{const}\ NaiveV\ \&naivev);}
\DoxyCodeLine{00185\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a06da4be04bf0815bfc692b2ce4485aec}{structured\_update}}(\mbox{\hyperlink{class_eigen_1_1_block}{Block<MatrixXr,Dynamic,Dynamic>}}\ \mbox{\hyperlink{bench__gemm_8cpp_addc86e8508f14411ec98f521c520f875}{A}},\ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a7b32c2adca9f10283820f437f08f6271}{MatrixXr}}\ \&\mbox{\hyperlink{bench__gemm_8cpp_a37a83060ac796961b44991c836f083f7}{B}},\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ n1);}
\DoxyCodeLine{00186\ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{bench__gemm_8cpp_acb5c3dc237f99cf17167e8a629f01b43}{RealScalar}}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a2f1d2d4ca5769579c4eb0f04e03e7e7a}{secularEq}}(\mbox{\hyperlink{bench__gemm_8cpp_acb5c3dc237f99cf17167e8a629f01b43}{RealScalar}}\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}},\ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_ad30a7a883b86028c45559593c7a678a2}{ArrayRef}}\&\ col0,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_ad30a7a883b86028c45559593c7a678a2}{ArrayRef}}\&\ diag,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_aab1c377c616062cc85356e47312cb412}{IndicesRef}}\ \&perm,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_ad30a7a883b86028c45559593c7a678a2}{ArrayRef}}\&\ diagShifted,\ \mbox{\hyperlink{bench__gemm_8cpp_acb5c3dc237f99cf17167e8a629f01b43}{RealScalar}}\ shift);}
\DoxyCodeLine{00187\ }
\DoxyCodeLine{00188\ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00189\ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a7b32c2adca9f10283820f437f08f6271}{MatrixXr}}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a857bb0e5f633e0600ea6861f14da8a1b}{m\_naiveU}},\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a94b71ee8ecf0b6b621a1267cf136adc9}{m\_naiveV}};}
\DoxyCodeLine{00190\ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a7b32c2adca9f10283820f437f08f6271}{MatrixXr}}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a76dcaed5bc2dd1c37832805fa8fed943}{m\_computed}};}
\DoxyCodeLine{00191\ \ \ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a43bb7c5a142ebde4c38967c5c3d42910}{m\_nRec}};}
\DoxyCodeLine{00192\ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a1e177918a1acf8153ff5f323fbeed9fe}{ArrayXr}}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_ad62998546febd86ba715a9eae4c47b4b}{m\_workspace}};}
\DoxyCodeLine{00193\ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a9dea0e28217993ad7de85351357724a7}{ArrayXi}}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a8bfc4be4bdc669038298ea29b940532f}{m\_workspaceI}};}
\DoxyCodeLine{00194\ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a1e07b25c4a606cee8f34cdc75189a3b8}{m\_algoswap}};}
\DoxyCodeLine{00195\ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a01ac6b6ddf81569780bf6449e8484a6c}{m\_isTranspose}},\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a63dc95af59e08a68b11268e98feea7fa}{m\_compU}},\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a707ea2d37a7024a6317f001a6971fbec}{m\_compV}};}
\DoxyCodeLine{00196\ \ \ }
\DoxyCodeLine{00197\ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{class_eigen_1_1_s_v_d_base_ab71e31e61c33f68ff2f499ed9f30e718}{Base::m\_singularValues}};}
\DoxyCodeLine{00198\ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6eca3829eb56684ca01c291c6630c8d8}{Base::m\_diagSize}};}
\DoxyCodeLine{00199\ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{class_eigen_1_1_s_v_d_base_ad6f49fd8f826a41109f8eb68e2f48dc4}{Base::m\_computeFullU}};}
\DoxyCodeLine{00200\ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a1eec8ead08bc9cd1729ba9ba7beb6b41}{Base::m\_computeFullV}};}
\DoxyCodeLine{00201\ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a47b67c55d69ba645bb7ae32bb5466138}{Base::m\_computeThinU}};}
\DoxyCodeLine{00202\ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{class_eigen_1_1_s_v_d_base_ac8321ff2cbf3b82f5c2638b9de6661af}{Base::m\_computeThinV}};}
\DoxyCodeLine{00203\ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{class_eigen_1_1_s_v_d_base_af0e0b3833c1d49286c0fdcbc023c3bd8}{Base::m\_matrixU}};}
\DoxyCodeLine{00204\ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a69cf1cfb527ff5562156c13bdca45ca5}{Base::m\_matrixV}};}
\DoxyCodeLine{00205\ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a633b92f4eb9c65911b943b93bb8b341c}{Base::m\_isInitialized}};}
\DoxyCodeLine{00206\ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{class_eigen_1_1_s_v_d_base_aa41b395662650f2e10652f76365877c4}{Base::m\_nonzeroSingularValues}};}
\DoxyCodeLine{00207\ }
\DoxyCodeLine{00208\ \textcolor{keyword}{public}:\ \ }
\DoxyCodeLine{00209\ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_ade7ebb87b1735432218681831b1801cc}{m\_numIters}};}
\DoxyCodeLine{00210\ \};\ \textcolor{comment}{//end\ class\ BDCSVD}}
\DoxyCodeLine{00211\ }
\DoxyCodeLine{00212\ }
\DoxyCodeLine{00213\ \textcolor{comment}{//\ Method\ to\ allocate\ and\ initialize\ matrix\ and\ attributes}}
\DoxyCodeLine{00214\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ MatrixType>}
\DoxyCodeLine{00215\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a870393d7d95401a45fd65a3ff8b38bfb}{BDCSVD<MatrixType>::allocate}}(\mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a3fb1d6a28b00ec36e9d5aaa1a98117c6}{rows}},\ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a9239b32c45bf81eff7be82bd4e97ee59}{cols}},\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ computationOptions)}
\DoxyCodeLine{00216\ \{}
\DoxyCodeLine{00217\ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a01ac6b6ddf81569780bf6449e8484a6c}{m\_isTranspose}}\ =\ (\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a9239b32c45bf81eff7be82bd4e97ee59}{cols}}\ >\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a3fb1d6a28b00ec36e9d5aaa1a98117c6}{rows}});}
\DoxyCodeLine{00218\ }
\DoxyCodeLine{00219\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a7be177a4c6e8e3fbf2bec40cb527321c}{Base::allocate}}(\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a3fb1d6a28b00ec36e9d5aaa1a98117c6}{rows}},\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a9239b32c45bf81eff7be82bd4e97ee59}{cols}},\ computationOptions))}
\DoxyCodeLine{00220\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00221\ \ \ }
\DoxyCodeLine{00222\ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a76dcaed5bc2dd1c37832805fa8fed943}{m\_computed}}\ =\ MatrixXr::Zero(\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a83ddb54aaad949f480c43513efc86d7f}{m\_diagSize}}\ +\ 1,\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a83ddb54aaad949f480c43513efc86d7f}{m\_diagSize}}\ );}
\DoxyCodeLine{00223\ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a63dc95af59e08a68b11268e98feea7fa}{m\_compU}}\ =\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_aea45b7e486d3333446b274f484b0c587}{computeV}}();}
\DoxyCodeLine{00224\ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a707ea2d37a7024a6317f001a6971fbec}{m\_compV}}\ =\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a51fcc2fbadec89148a5e4222c77e35ec}{computeU}}();}
\DoxyCodeLine{00225\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a01ac6b6ddf81569780bf6449e8484a6c}{m\_isTranspose}})}
\DoxyCodeLine{00226\ \ \ \ \ \mbox{\hyperlink{namespacestd_a3acbe51b6415e9284430194bf04944e1}{std::swap}}(\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a63dc95af59e08a68b11268e98feea7fa}{m\_compU}},\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a707ea2d37a7024a6317f001a6971fbec}{m\_compV}});}
\DoxyCodeLine{00227\ \ \ }
\DoxyCodeLine{00228\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a63dc95af59e08a68b11268e98feea7fa}{m\_compU}})\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a857bb0e5f633e0600ea6861f14da8a1b}{m\_naiveU}}\ =\ MatrixXr::Zero(\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a83ddb54aaad949f480c43513efc86d7f}{m\_diagSize}}\ +\ 1,\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a83ddb54aaad949f480c43513efc86d7f}{m\_diagSize}}\ +\ 1\ );}
\DoxyCodeLine{00229\ \ \ \textcolor{keywordflow}{else}\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a857bb0e5f633e0600ea6861f14da8a1b}{m\_naiveU}}\ =\ MatrixXr::Zero(2,\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a83ddb54aaad949f480c43513efc86d7f}{m\_diagSize}}\ +\ 1\ );}
\DoxyCodeLine{00230\ \ \ }
\DoxyCodeLine{00231\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a707ea2d37a7024a6317f001a6971fbec}{m\_compV}})\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a94b71ee8ecf0b6b621a1267cf136adc9}{m\_naiveV}}\ =\ MatrixXr::Zero(\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a83ddb54aaad949f480c43513efc86d7f}{m\_diagSize}},\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a83ddb54aaad949f480c43513efc86d7f}{m\_diagSize}});}
\DoxyCodeLine{00232\ \ \ }
\DoxyCodeLine{00233\ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_ad62998546febd86ba715a9eae4c47b4b}{m\_workspace}}.resize((\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a83ddb54aaad949f480c43513efc86d7f}{m\_diagSize}}+1)*(\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a83ddb54aaad949f480c43513efc86d7f}{m\_diagSize}}+1)*3);}
\DoxyCodeLine{00234\ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a8bfc4be4bdc669038298ea29b940532f}{m\_workspaceI}}.resize(3*\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a83ddb54aaad949f480c43513efc86d7f}{m\_diagSize}});}
\DoxyCodeLine{00235\ \}\textcolor{comment}{//\ end\ allocate}}
\DoxyCodeLine{00236\ }
\DoxyCodeLine{00237\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ MatrixType>}
\DoxyCodeLine{00238\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a39514816d38f9c418cf3f3514b511c2c}{BDCSVD<MatrixType>}}\&\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a52e3c627775010775c64d16a00cdb770}{BDCSVD<MatrixType>::compute}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a8c3310eee662af4ca2428f7afd1472ed}{MatrixType}}\&\ \mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}},\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ computationOptions)\ }
\DoxyCodeLine{00239\ \{}
\DoxyCodeLine{00240\ \textcolor{preprocessor}{\#ifdef\ EIGEN\_BDCSVD\_DEBUG\_VERBOSE}}
\DoxyCodeLine{00241\ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n\(\backslash\)n\(\backslash\)n======================================================================================================================\(\backslash\)n\(\backslash\)n\(\backslash\)n"{}};}
\DoxyCodeLine{00242\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00243\ \ \ \mbox{\hyperlink{allocator_8c_a3a4fc1fa103fa3a33fc168de4cd6703e}{allocate}}(\mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}}.rows(),\ \mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}}.cols(),\ computationOptions);}
\DoxyCodeLine{00244\ \ \ \textcolor{keyword}{using\ }std::abs;}
\DoxyCodeLine{00245\ }
\DoxyCodeLine{00246\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a1b429d828258ec58c1fc4ced6213d64d}{RealScalar}}\ considerZero\ =\ (std::numeric\_limits<RealScalar>::min)();}
\DoxyCodeLine{00247\ \ \ }
\DoxyCodeLine{00248\ \ \ \textcolor{comment}{//****\ step\ -\/1\ -\/\ If\ the\ problem\ is\ too\ small,\ directly\ falls\ back\ to\ JacobiSVD\ and\ return}}
\DoxyCodeLine{00249\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}}.cols()\ <\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a1e07b25c4a606cee8f34cdc75189a3b8}{m\_algoswap}})}
\DoxyCodeLine{00250\ \ \ \{}
\DoxyCodeLine{00251\ \ \ \ \ \textcolor{comment}{//\ FIXME\ this\ line\ involves\ temporaries}}
\DoxyCodeLine{00252\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d}{JacobiSVD<MatrixType>}}\ jsvd(\mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}},computationOptions);}
\DoxyCodeLine{00253\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a51fcc2fbadec89148a5e4222c77e35ec}{computeU}}())\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_ae9ed4ccca8e70fbe7ccd489fff306005}{m\_matrixU}}\ =\ jsvd.\mbox{\hyperlink{class_eigen_1_1_s_v_d_base_accbc8e3f9baab3a57a6eba8e4cc3ea27}{matrixU}}();}
\DoxyCodeLine{00254\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_aea45b7e486d3333446b274f484b0c587}{computeV}}())\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a0261bdb32abb9a5df992851c6e3802f2}{m\_matrixV}}\ =\ jsvd.\mbox{\hyperlink{class_eigen_1_1_s_v_d_base_af09f06357d7d7442f7ca7343713756fe}{matrixV}}();}
\DoxyCodeLine{00255\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a6c0b1dbfbe8ab8fe2a401f9d7ada163e}{m\_singularValues}}\ =\ jsvd.\mbox{\hyperlink{class_eigen_1_1_s_v_d_base_ac44c307a70731003003faf3a9bdf14f6}{singularValues}}();}
\DoxyCodeLine{00256\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a6f1ee723535811880269c78887c57af5}{m\_nonzeroSingularValues}}\ =\ jsvd.\mbox{\hyperlink{class_eigen_1_1_s_v_d_base_afe8a555f38393a319a71ec0f0331c9ef}{nonzeroSingularValues}}();}
\DoxyCodeLine{00257\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_ae62daca181d5d62926e711a54c9a66c9}{m\_isInitialized}}\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00258\ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{00259\ \ \ \}}
\DoxyCodeLine{00260\ \ \ }
\DoxyCodeLine{00261\ \ \ \textcolor{comment}{//****\ step\ 0\ -\/\ Copy\ the\ input\ matrix\ and\ apply\ scaling\ to\ reduce\ over/under-\/flows}}
\DoxyCodeLine{00262\ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a1b429d828258ec58c1fc4ced6213d64d}{RealScalar}}\ \mbox{\hyperlink{gnuplot__common__settings_8hh_a028be1055fb10c679b6153f8dcd0befa}{scale}}\ =\ \mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}}.cwiseAbs().maxCoeff();}
\DoxyCodeLine{00263\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{gnuplot__common__settings_8hh_a028be1055fb10c679b6153f8dcd0befa}{scale}}==\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_aad17038f9628ce5ed6e1461a67cd3a03}{Literal}}(0))\ \mbox{\hyperlink{gnuplot__common__settings_8hh_a028be1055fb10c679b6153f8dcd0befa}{scale}}\ =\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_aad17038f9628ce5ed6e1461a67cd3a03}{Literal}}(1);}
\DoxyCodeLine{00264\ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_acf9211e5353d60fc3209d62fa0e2bdf7}{MatrixX}}\ \mbox{\hyperlink{level1__impl_8h_a7ffc26122ca6f9bec01f9bc5e64f3006}{copy}};}
\DoxyCodeLine{00265\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a01ac6b6ddf81569780bf6449e8484a6c}{m\_isTranspose}})\ \mbox{\hyperlink{level1__impl_8h_a7ffc26122ca6f9bec01f9bc5e64f3006}{copy}}\ =\ \mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}}.adjoint()/\mbox{\hyperlink{gnuplot__common__settings_8hh_a028be1055fb10c679b6153f8dcd0befa}{scale}};}
\DoxyCodeLine{00266\ \ \ \textcolor{keywordflow}{else}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{level1__impl_8h_a7ffc26122ca6f9bec01f9bc5e64f3006}{copy}}\ =\ \mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}}/\mbox{\hyperlink{gnuplot__common__settings_8hh_a028be1055fb10c679b6153f8dcd0befa}{scale}};}
\DoxyCodeLine{00267\ \ \ }
\DoxyCodeLine{00268\ \ \ \textcolor{comment}{//****\ step\ 1\ -\/\ Bidiagonalization}}
\DoxyCodeLine{00269\ \ \ \textcolor{comment}{//\ FIXME\ this\ line\ involves\ temporaries}}
\DoxyCodeLine{00270\ \ \ \mbox{\hyperlink{class_eigen_1_1internal_1_1_upper_bidiagonalization}{internal::UpperBidiagonalization<MatrixX>}}\ bid(\mbox{\hyperlink{level1__impl_8h_a7ffc26122ca6f9bec01f9bc5e64f3006}{copy}});}
\DoxyCodeLine{00271\ }
\DoxyCodeLine{00272\ \ \ \textcolor{comment}{//****\ step\ 2\ -\/\ Divide\ \&\ Conquer}}
\DoxyCodeLine{00273\ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a857bb0e5f633e0600ea6861f14da8a1b}{m\_naiveU}}.setZero();}
\DoxyCodeLine{00274\ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a94b71ee8ecf0b6b621a1267cf136adc9}{m\_naiveV}}.setZero();}
\DoxyCodeLine{00275\ \ \ \textcolor{comment}{//\ FIXME\ this\ line\ involves\ a\ temporary\ matrix}}
\DoxyCodeLine{00276\ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a76dcaed5bc2dd1c37832805fa8fed943}{m\_computed}}.topRows(\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a83ddb54aaad949f480c43513efc86d7f}{m\_diagSize}})\ =\ bid.\mbox{\hyperlink{class_eigen_1_1internal_1_1_upper_bidiagonalization_ad02b11d2cc0e7510ede8fd992e082a08}{bidiagonal}}().\mbox{\hyperlink{class_eigen_1_1internal_1_1_band_matrix_base_aacfa0b85201b8503376a9998987f81f7}{toDenseMatrix}}().transpose();}
\DoxyCodeLine{00277\ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a76dcaed5bc2dd1c37832805fa8fed943}{m\_computed}}.template\ \mbox{\hyperlink{_block_methods_8h_ad2b68f08a5a1b8004b00baa4244c22c2}{bottomRows<1>}}().setZero();}
\DoxyCodeLine{00278\ \ \ \mbox{\hyperlink{convex__hull__bench_8cpp_a178d4fc6033b539193c4338dde6ccb60}{divide}}(0,\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a83ddb54aaad949f480c43513efc86d7f}{m\_diagSize}}\ -\/\ 1,\ 0,\ 0,\ 0);}
\DoxyCodeLine{00279\ }
\DoxyCodeLine{00280\ \ \ \textcolor{comment}{//****\ step\ 3\ -\/\ Copy\ singular\ values\ and\ vectors}}
\DoxyCodeLine{00281\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}=0;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}<\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a83ddb54aaad949f480c43513efc86d7f}{m\_diagSize}};\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}++)}
\DoxyCodeLine{00282\ \ \ \{}
\DoxyCodeLine{00283\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a1b429d828258ec58c1fc4ced6213d64d}{RealScalar}}\ \mbox{\hyperlink{_cwise__product_8cpp_ad2cbe4616e813eb9af81732dca777b24}{a}}\ =\ \mbox{\hyperlink{datatypes_8h_a3aa069ac3980707dae1e0530f50d59e4}{abs}}(\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a76dcaed5bc2dd1c37832805fa8fed943}{m\_computed}}.coeff(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}},\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}));}
\DoxyCodeLine{00284\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a6c0b1dbfbe8ab8fe2a401f9d7ada163e}{m\_singularValues}}.coeffRef(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ =\ \mbox{\hyperlink{_cwise__product_8cpp_ad2cbe4616e813eb9af81732dca777b24}{a}}\ *\ \mbox{\hyperlink{gnuplot__common__settings_8hh_a028be1055fb10c679b6153f8dcd0befa}{scale}};}
\DoxyCodeLine{00285\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{_cwise__product_8cpp_ad2cbe4616e813eb9af81732dca777b24}{a}}<considerZero)}
\DoxyCodeLine{00286\ \ \ \ \ \{}
\DoxyCodeLine{00287\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a6f1ee723535811880269c78887c57af5}{m\_nonzeroSingularValues}}\ =\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}};}
\DoxyCodeLine{00288\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a6c0b1dbfbe8ab8fe2a401f9d7ada163e}{m\_singularValues}}.tail(\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a83ddb54aaad949f480c43513efc86d7f}{m\_diagSize}}\ -\/\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ -\/\ 1).setZero();}
\DoxyCodeLine{00289\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00290\ \ \ \ \ \}}
\DoxyCodeLine{00291\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ ==\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a83ddb54aaad949f480c43513efc86d7f}{m\_diagSize}}\ -\/\ 1)}
\DoxyCodeLine{00292\ \ \ \ \ \{}
\DoxyCodeLine{00293\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a6f1ee723535811880269c78887c57af5}{m\_nonzeroSingularValues}}\ =\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ +\ 1;}
\DoxyCodeLine{00294\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00295\ \ \ \ \ \}}
\DoxyCodeLine{00296\ \ \ \}}
\DoxyCodeLine{00297\ }
\DoxyCodeLine{00298\ \textcolor{preprocessor}{\#ifdef\ EIGEN\_BDCSVD\_DEBUG\_VERBOSE}}
\DoxyCodeLine{00299\ \textcolor{comment}{//\ \ \ std::cout\ <<\ "{}m\_naiveU\(\backslash\)n"{}\ <<\ m\_naiveU\ <<\ "{}\(\backslash\)n\(\backslash\)n"{};}}
\DoxyCodeLine{00300\ \textcolor{comment}{//\ \ \ std::cout\ <<\ "{}m\_naiveV\(\backslash\)n"{}\ <<\ m\_naiveV\ <<\ "{}\(\backslash\)n\(\backslash\)n"{};}}
\DoxyCodeLine{00301\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00302\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a01ac6b6ddf81569780bf6449e8484a6c}{m\_isTranspose}})\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_aa059639383ca600f198cd178de5f116c}{copyUV}}(bid.\mbox{\hyperlink{class_eigen_1_1internal_1_1_upper_bidiagonalization_a6ab970ae51909e56ceb63a49e06fdc98}{householderV}}(),\ bid.\mbox{\hyperlink{class_eigen_1_1internal_1_1_upper_bidiagonalization_a39887f7712de5be5a0487e9f6357b9da}{householderU}}(),\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a94b71ee8ecf0b6b621a1267cf136adc9}{m\_naiveV}},\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a857bb0e5f633e0600ea6861f14da8a1b}{m\_naiveU}});}
\DoxyCodeLine{00303\ \ \ \textcolor{keywordflow}{else}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_aa059639383ca600f198cd178de5f116c}{copyUV}}(bid.\mbox{\hyperlink{class_eigen_1_1internal_1_1_upper_bidiagonalization_a39887f7712de5be5a0487e9f6357b9da}{householderU}}(),\ bid.\mbox{\hyperlink{class_eigen_1_1internal_1_1_upper_bidiagonalization_a6ab970ae51909e56ceb63a49e06fdc98}{householderV}}(),\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a857bb0e5f633e0600ea6861f14da8a1b}{m\_naiveU}},\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a94b71ee8ecf0b6b621a1267cf136adc9}{m\_naiveV}});}
\DoxyCodeLine{00304\ }
\DoxyCodeLine{00305\ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_ae62daca181d5d62926e711a54c9a66c9}{m\_isInitialized}}\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00306\ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{00307\ \}\textcolor{comment}{//\ end\ compute}}
\DoxyCodeLine{00308\ }
\DoxyCodeLine{00309\ }
\DoxyCodeLine{00310\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ MatrixType>}
\DoxyCodeLine{00311\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ HouseholderU,\ \textcolor{keyword}{typename}\ HouseholderV,\ \textcolor{keyword}{typename}\ NaiveU,\ \textcolor{keyword}{typename}\ NaiveV>}
\DoxyCodeLine{00312\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_aa059639383ca600f198cd178de5f116c}{BDCSVD<MatrixType>::copyUV}}(\textcolor{keyword}{const}\ HouseholderU\ \&householderU,\ \textcolor{keyword}{const}\ HouseholderV\ \&householderV,\ \textcolor{keyword}{const}\ NaiveU\ \&naiveU,\ \textcolor{keyword}{const}\ NaiveV\ \&naiveV)}
\DoxyCodeLine{00313\ \{}
\DoxyCodeLine{00314\ \ \ \textcolor{comment}{//\ Note\ exchange\ of\ U\ and\ V:\ m\_matrixU\ is\ set\ from\ m\_naiveV\ and\ vice\ versa}}
\DoxyCodeLine{00315\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a51fcc2fbadec89148a5e4222c77e35ec}{computeU}}())}
\DoxyCodeLine{00316\ \ \ \{}
\DoxyCodeLine{00317\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ Ucols\ =\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_adc522ba420a74c8506fc3991a54377d1}{m\_computeThinU}}\ ?\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a83ddb54aaad949f480c43513efc86d7f}{m\_diagSize}}\ :\ householderU.cols();}
\DoxyCodeLine{00318\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_ae9ed4ccca8e70fbe7ccd489fff306005}{m\_matrixU}}\ =\ MatrixX::Identity(householderU.cols(),\ Ucols);}
\DoxyCodeLine{00319\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_ae9ed4ccca8e70fbe7ccd489fff306005}{m\_matrixU}}.topLeftCorner(\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a83ddb54aaad949f480c43513efc86d7f}{m\_diagSize}},\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a83ddb54aaad949f480c43513efc86d7f}{m\_diagSize}})\ =\ naiveV.template\ \mbox{\hyperlink{_common_cwise_unary_ops_8h_aa89d007196125d10fa7d6e19811aca05}{cast<Scalar>}}().topLeftCorner(\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a83ddb54aaad949f480c43513efc86d7f}{m\_diagSize}},\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a83ddb54aaad949f480c43513efc86d7f}{m\_diagSize}});}
\DoxyCodeLine{00320\ \ \ \ \ householderU.applyThisOnTheLeft(\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_ae9ed4ccca8e70fbe7ccd489fff306005}{m\_matrixU}});\ \textcolor{comment}{//\ FIXME\ this\ line\ involves\ a\ temporary\ buffer}}
\DoxyCodeLine{00321\ \ \ \}}
\DoxyCodeLine{00322\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_aea45b7e486d3333446b274f484b0c587}{computeV}}())}
\DoxyCodeLine{00323\ \ \ \{}
\DoxyCodeLine{00324\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ Vcols\ =\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_acabca5e599af32d6fc8bd68e939d8875}{m\_computeThinV}}\ ?\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a83ddb54aaad949f480c43513efc86d7f}{m\_diagSize}}\ :\ householderV.cols();}
\DoxyCodeLine{00325\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a0261bdb32abb9a5df992851c6e3802f2}{m\_matrixV}}\ =\ MatrixX::Identity(householderV.cols(),\ Vcols);}
\DoxyCodeLine{00326\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a0261bdb32abb9a5df992851c6e3802f2}{m\_matrixV}}.topLeftCorner(\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a83ddb54aaad949f480c43513efc86d7f}{m\_diagSize}},\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a83ddb54aaad949f480c43513efc86d7f}{m\_diagSize}})\ =\ naiveU.template\ \mbox{\hyperlink{_common_cwise_unary_ops_8h_aa89d007196125d10fa7d6e19811aca05}{cast<Scalar>}}().topLeftCorner(\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a83ddb54aaad949f480c43513efc86d7f}{m\_diagSize}},\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a83ddb54aaad949f480c43513efc86d7f}{m\_diagSize}});}
\DoxyCodeLine{00327\ \ \ \ \ householderV.applyThisOnTheLeft(\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a0261bdb32abb9a5df992851c6e3802f2}{m\_matrixV}});\ \textcolor{comment}{//\ FIXME\ this\ line\ involves\ a\ temporary\ buffer}}
\DoxyCodeLine{00328\ \ \ \}}
\DoxyCodeLine{00329\ \}}
\DoxyCodeLine{00330\ }
\DoxyCodeLine{00339\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ MatrixType>}
\DoxyCodeLine{00340\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a06da4be04bf0815bfc692b2ce4485aec}{BDCSVD<MatrixType>::structured\_update}}(\mbox{\hyperlink{class_eigen_1_1_block}{Block<MatrixXr,Dynamic,Dynamic>}}\ \mbox{\hyperlink{bench__gemm_8cpp_addc86e8508f14411ec98f521c520f875}{A}},\ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a7b32c2adca9f10283820f437f08f6271}{MatrixXr}}\ \&\mbox{\hyperlink{bench__gemm_8cpp_a37a83060ac796961b44991c836f083f7}{B}},\ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ n1)}
\DoxyCodeLine{00341\ \{}
\DoxyCodeLine{00342\ \ \ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}\ =\ \mbox{\hyperlink{bench__gemm_8cpp_addc86e8508f14411ec98f521c520f875}{A}}.rows();}
\DoxyCodeLine{00343\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}>100)}
\DoxyCodeLine{00344\ \ \ \{}
\DoxyCodeLine{00345\ \ \ \ \ \textcolor{comment}{//\ If\ the\ matrices\ are\ large\ enough,\ let's\ exploit\ the\ sparse\ structure\ of\ A\ by}}
\DoxyCodeLine{00346\ \ \ \ \ \textcolor{comment}{//\ splitting\ it\ in\ half\ (wrt\ n1),\ and\ packing\ the\ non-\/zero\ columns.}}
\DoxyCodeLine{00347\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ n2\ =\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}\ -\/\ n1;}
\DoxyCodeLine{00348\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_map}{Map<MatrixXr>}}\ A1(\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_ad62998546febd86ba715a9eae4c47b4b}{m\_workspace}}.data()\ \ \ \ \ \ ,\ n1,\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}});}
\DoxyCodeLine{00349\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_map}{Map<MatrixXr>}}\ A2(\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_ad62998546febd86ba715a9eae4c47b4b}{m\_workspace}}.data()+\ n1*\mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}},\ n2,\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}});}
\DoxyCodeLine{00350\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_map}{Map<MatrixXr>}}\ B1(\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_ad62998546febd86ba715a9eae4c47b4b}{m\_workspace}}.data()+\ \ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}*\mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}},\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}},\ \ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}});}
\DoxyCodeLine{00351\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_map}{Map<MatrixXr>}}\ B2(\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_ad62998546febd86ba715a9eae4c47b4b}{m\_workspace}}.data()+2*\mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}*\mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}},\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}},\ \ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}});}
\DoxyCodeLine{00352\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ k1=0,\ k2=0;}
\DoxyCodeLine{00353\ \ \ \ \ \textcolor{keywordflow}{for}(\mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}=0;\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}<\mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}};\ ++\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}})}
\DoxyCodeLine{00354\ \ \ \ \ \{}
\DoxyCodeLine{00355\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ (\mbox{\hyperlink{bench__gemm_8cpp_addc86e8508f14411ec98f521c520f875}{A}}.col(\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}).head(n1).array()!=\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_aad17038f9628ce5ed6e1461a67cd3a03}{Literal}}(0)).any()\ )}
\DoxyCodeLine{00356\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00357\ \ \ \ \ \ \ \ \ A1.col(k1)\ =\ \mbox{\hyperlink{bench__gemm_8cpp_addc86e8508f14411ec98f521c520f875}{A}}.col(\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}).head(n1);}
\DoxyCodeLine{00358\ \ \ \ \ \ \ \ \ B1.row(k1)\ =\ \mbox{\hyperlink{bench__gemm_8cpp_a37a83060ac796961b44991c836f083f7}{B}}.row(\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}});}
\DoxyCodeLine{00359\ \ \ \ \ \ \ \ \ ++k1;}
\DoxyCodeLine{00360\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00361\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ (\mbox{\hyperlink{bench__gemm_8cpp_addc86e8508f14411ec98f521c520f875}{A}}.col(\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}).tail(n2).array()!=\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_aad17038f9628ce5ed6e1461a67cd3a03}{Literal}}(0)).any()\ )}
\DoxyCodeLine{00362\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00363\ \ \ \ \ \ \ \ \ A2.col(k2)\ =\ \mbox{\hyperlink{bench__gemm_8cpp_addc86e8508f14411ec98f521c520f875}{A}}.col(\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}).tail(n2);}
\DoxyCodeLine{00364\ \ \ \ \ \ \ \ \ B2.row(k2)\ =\ \mbox{\hyperlink{bench__gemm_8cpp_a37a83060ac796961b44991c836f083f7}{B}}.row(\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}});}
\DoxyCodeLine{00365\ \ \ \ \ \ \ \ \ ++k2;}
\DoxyCodeLine{00366\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00367\ \ \ \ \ \}}
\DoxyCodeLine{00368\ \ \ }
\DoxyCodeLine{00369\ \ \ \ \ \mbox{\hyperlink{bench__gemm_8cpp_addc86e8508f14411ec98f521c520f875}{A}}.topRows(n1).noalias()\ \ \ \ =\ A1.leftCols(k1)\ *\ B1.topRows(k1);}
\DoxyCodeLine{00370\ \ \ \ \ \mbox{\hyperlink{bench__gemm_8cpp_addc86e8508f14411ec98f521c520f875}{A}}.bottomRows(n2).noalias()\ =\ A2.leftCols(k2)\ *\ B2.topRows(k2);}
\DoxyCodeLine{00371\ \ \ \}}
\DoxyCodeLine{00372\ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00373\ \ \ \{}
\DoxyCodeLine{00374\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_map}{Map<MatrixXr,Aligned>}}\ \mbox{\hyperlink{namespacegenerate__static__link__cmd__macos_a7c2dcd7f9bee7a5258b5c61341deb157}{tmp}}(m\_workspace.data(),\mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}},\mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}});}
\DoxyCodeLine{00375\ \ \ \ \ \mbox{\hyperlink{namespacegenerate__static__link__cmd__macos_a7c2dcd7f9bee7a5258b5c61341deb157}{tmp}}.noalias()\ =\ \mbox{\hyperlink{bench__gemm_8cpp_addc86e8508f14411ec98f521c520f875}{A}}*\mbox{\hyperlink{bench__gemm_8cpp_a37a83060ac796961b44991c836f083f7}{B}};}
\DoxyCodeLine{00376\ \ \ \ \ \mbox{\hyperlink{bench__gemm_8cpp_addc86e8508f14411ec98f521c520f875}{A}}\ =\ \mbox{\hyperlink{namespacegenerate__static__link__cmd__macos_a7c2dcd7f9bee7a5258b5c61341deb157}{tmp}};}
\DoxyCodeLine{00377\ \ \ \}}
\DoxyCodeLine{00378\ \}}
\DoxyCodeLine{00379\ }
\DoxyCodeLine{00380\ \textcolor{comment}{//\ The\ divide\ algorithm\ is\ done\ "{}in\ place"{},\ we\ are\ always\ working\ on\ subsets\ of\ the\ same\ matrix.\ The\ divide\ methods\ takes\ as\ argument\ the\ }}
\DoxyCodeLine{00381\ \textcolor{comment}{//\ place\ of\ the\ submatrix\ we\ are\ currently\ working\ on.}}
\DoxyCodeLine{00382\ }
\DoxyCodeLine{00383\ \textcolor{comment}{//@param\ firstCol\ :\ The\ Index\ of\ the\ first\ column\ of\ the\ submatrix\ of\ m\_computed\ and\ for\ m\_naiveU;}}
\DoxyCodeLine{00384\ \textcolor{comment}{//@param\ lastCol\ :\ The\ Index\ of\ the\ last\ column\ of\ the\ submatrix\ of\ m\_computed\ and\ for\ m\_naiveU;\ }}
\DoxyCodeLine{00385\ \textcolor{comment}{//\ lastCol\ +\ 1\ -\/\ firstCol\ is\ the\ size\ of\ the\ submatrix.}}
\DoxyCodeLine{00386\ \textcolor{comment}{//@param\ firstRowW\ :\ The\ Index\ of\ the\ first\ row\ of\ the\ matrix\ W\ that\ we\ are\ to\ change.\ (see\ the\ reference\ paper\ section\ 1\ for\ more\ information\ on\ W)}}
\DoxyCodeLine{00387\ \textcolor{comment}{//@param\ firstRowW\ :\ Same\ as\ firstRowW\ with\ the\ column.}}
\DoxyCodeLine{00388\ \textcolor{comment}{//@param\ shift\ :\ Each\ time\ one\ takes\ the\ left\ submatrix,\ one\ must\ add\ 1\ to\ the\ shift.\ Why?\ Because!\ We\ actually\ want\ the\ last\ column\ of\ the\ U\ submatrix\ }}
\DoxyCodeLine{00389\ \textcolor{comment}{//\ to\ become\ the\ first\ column\ (*coeff)\ and\ to\ shift\ all\ the\ other\ columns\ to\ the\ right.\ There\ are\ more\ details\ on\ the\ reference\ paper.}}
\DoxyCodeLine{00390\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ MatrixType>}
\DoxyCodeLine{00391\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_aefd73cc6b7a9ffc922c8d615efba2a52}{BDCSVD<MatrixType>::divide}}\ (\mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ firstCol,\ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ lastCol,\ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ firstRowW,\ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ firstColW,\ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ shift)}
\DoxyCodeLine{00392\ \{}
\DoxyCodeLine{00393\ \ \ \textcolor{comment}{//\ requires\ rows\ =\ cols\ +\ 1;}}
\DoxyCodeLine{00394\ \ \ \textcolor{keyword}{using\ }std::pow;}
\DoxyCodeLine{00395\ \ \ \textcolor{keyword}{using\ }std::sqrt;}
\DoxyCodeLine{00396\ \ \ \textcolor{keyword}{using\ }std::abs;}
\DoxyCodeLine{00397\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}\ =\ lastCol\ -\/\ firstCol\ +\ 1;}
\DoxyCodeLine{00398\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ k\ =\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}/2;}
\DoxyCodeLine{00399\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a1b429d828258ec58c1fc4ced6213d64d}{RealScalar}}\ considerZero\ =\ (std::numeric\_limits<RealScalar>::min)();}
\DoxyCodeLine{00400\ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a1b429d828258ec58c1fc4ced6213d64d}{RealScalar}}\ alphaK;}
\DoxyCodeLine{00401\ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a1b429d828258ec58c1fc4ced6213d64d}{RealScalar}}\ betaK;\ }
\DoxyCodeLine{00402\ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a1b429d828258ec58c1fc4ced6213d64d}{RealScalar}}\ r0;\ }
\DoxyCodeLine{00403\ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a1b429d828258ec58c1fc4ced6213d64d}{RealScalar}}\ \mbox{\hyperlink{sugar_8h_aa2bc5aa57d417f3226228d9058ab9f20}{lambda}},\ phi,\ c0,\ s0;}
\DoxyCodeLine{00404\ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a0ea2c57bf088d5fc480ad81945157079}{VectorType}}\ l,\ \mbox{\hyperlink{cxx11__tensor__map_8cpp_a7f507fea02198f6cb81c86640c7b1a4e}{f}};}
\DoxyCodeLine{00405\ \ \ \textcolor{comment}{//\ We\ use\ the\ other\ algorithm\ which\ is\ more\ efficient\ for\ small\ }}
\DoxyCodeLine{00406\ \ \ \textcolor{comment}{//\ matrices.}}
\DoxyCodeLine{00407\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}\ <\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a1e07b25c4a606cee8f34cdc75189a3b8}{m\_algoswap}})}
\DoxyCodeLine{00408\ \ \ \{}
\DoxyCodeLine{00409\ \ \ \ \ \textcolor{comment}{//\ FIXME\ this\ line\ involves\ temporaries}}
\DoxyCodeLine{00410\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d}{JacobiSVD<MatrixXr>}}\ \mbox{\hyperlink{offscreen_8c_a846c9667e34d56c560bb7f0ac6e173f6}{b}}(\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a76dcaed5bc2dd1c37832805fa8fed943}{m\_computed}}.block(firstCol,\ firstCol,\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}\ +\ 1,\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}),\ \mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a9fa9302d510cee20c26311154937e23f}{ComputeFullU}}\ |\ (\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a707ea2d37a7024a6317f001a6971fbec}{m\_compV}}\ ?\ \mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a36581f7c662f7def31efd500c284f930}{ComputeFullV}}\ :\ 0));}
\DoxyCodeLine{00411\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a63dc95af59e08a68b11268e98feea7fa}{m\_compU}})}
\DoxyCodeLine{00412\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a857bb0e5f633e0600ea6861f14da8a1b}{m\_naiveU}}.block(firstCol,\ firstCol,\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}\ +\ 1,\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}\ +\ 1).real()\ =\ \mbox{\hyperlink{offscreen_8c_a846c9667e34d56c560bb7f0ac6e173f6}{b}}.matrixU();}
\DoxyCodeLine{00413\ \ \ \ \ \textcolor{keywordflow}{else}\ }
\DoxyCodeLine{00414\ \ \ \ \ \{}
\DoxyCodeLine{00415\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a857bb0e5f633e0600ea6861f14da8a1b}{m\_naiveU}}.row(0).segment(firstCol,\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}\ +\ 1).real()\ =\ \mbox{\hyperlink{offscreen_8c_a846c9667e34d56c560bb7f0ac6e173f6}{b}}.matrixU().row(0);}
\DoxyCodeLine{00416\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a857bb0e5f633e0600ea6861f14da8a1b}{m\_naiveU}}.row(1).segment(firstCol,\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}\ +\ 1).real()\ =\ \mbox{\hyperlink{offscreen_8c_a846c9667e34d56c560bb7f0ac6e173f6}{b}}.matrixU().row(\mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}});}
\DoxyCodeLine{00417\ \ \ \ \ \}}
\DoxyCodeLine{00418\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a707ea2d37a7024a6317f001a6971fbec}{m\_compV}})\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a94b71ee8ecf0b6b621a1267cf136adc9}{m\_naiveV}}.block(firstRowW,\ firstColW,\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}},\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}).real()\ =\ \mbox{\hyperlink{offscreen_8c_a846c9667e34d56c560bb7f0ac6e173f6}{b}}.matrixV();}
\DoxyCodeLine{00419\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a76dcaed5bc2dd1c37832805fa8fed943}{m\_computed}}.block(firstCol\ +\ shift,\ firstCol\ +\ shift,\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}\ +\ 1,\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}).setZero();}
\DoxyCodeLine{00420\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a76dcaed5bc2dd1c37832805fa8fed943}{m\_computed}}.diagonal().segment(firstCol\ +\ shift,\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}})\ =\ \mbox{\hyperlink{offscreen_8c_a846c9667e34d56c560bb7f0ac6e173f6}{b}}.singularValues().head(\mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}});}
\DoxyCodeLine{00421\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00422\ \ \ \}}
\DoxyCodeLine{00423\ \ \ \textcolor{comment}{//\ We\ use\ the\ divide\ and\ conquer\ algorithm}}
\DoxyCodeLine{00424\ \ \ alphaK\ =\ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a76dcaed5bc2dd1c37832805fa8fed943}{m\_computed}}(firstCol\ +\ k,\ firstCol\ +\ k);}
\DoxyCodeLine{00425\ \ \ betaK\ =\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a76dcaed5bc2dd1c37832805fa8fed943}{m\_computed}}(firstCol\ +\ k\ +\ 1,\ firstCol\ +\ k);}
\DoxyCodeLine{00426\ \ \ \textcolor{comment}{//\ The\ divide\ must\ be\ done\ in\ that\ order\ in\ order\ to\ have\ good\ results.\ Divide\ change\ the\ data\ inside\ the\ submatrices}}
\DoxyCodeLine{00427\ \ \ \textcolor{comment}{//\ and\ the\ divide\ of\ the\ right\ submatrice\ reads\ one\ column\ of\ the\ left\ submatrice.\ That's\ why\ we\ need\ to\ treat\ the\ }}
\DoxyCodeLine{00428\ \ \ \textcolor{comment}{//\ right\ submatrix\ before\ the\ left\ one.\ }}
\DoxyCodeLine{00429\ \ \ \mbox{\hyperlink{convex__hull__bench_8cpp_a178d4fc6033b539193c4338dde6ccb60}{divide}}(k\ +\ 1\ +\ firstCol,\ lastCol,\ k\ +\ 1\ +\ firstRowW,\ k\ +\ 1\ +\ firstColW,\ shift);}
\DoxyCodeLine{00430\ \ \ \mbox{\hyperlink{convex__hull__bench_8cpp_a178d4fc6033b539193c4338dde6ccb60}{divide}}(firstCol,\ k\ -\/\ 1\ +\ firstCol,\ firstRowW,\ firstColW\ +\ 1,\ shift\ +\ 1);}
\DoxyCodeLine{00431\ }
\DoxyCodeLine{00432\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a63dc95af59e08a68b11268e98feea7fa}{m\_compU}})}
\DoxyCodeLine{00433\ \ \ \{}
\DoxyCodeLine{00434\ \ \ \ \ \mbox{\hyperlink{sugar_8h_aa2bc5aa57d417f3226228d9058ab9f20}{lambda}}\ =\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a857bb0e5f633e0600ea6861f14da8a1b}{m\_naiveU}}(firstCol\ +\ k,\ firstCol\ +\ k);}
\DoxyCodeLine{00435\ \ \ \ \ phi\ =\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a857bb0e5f633e0600ea6861f14da8a1b}{m\_naiveU}}(firstCol\ +\ k\ +\ 1,\ lastCol\ +\ 1);}
\DoxyCodeLine{00436\ \ \ \}\ }
\DoxyCodeLine{00437\ \ \ \textcolor{keywordflow}{else}\ }
\DoxyCodeLine{00438\ \ \ \{}
\DoxyCodeLine{00439\ \ \ \ \ \mbox{\hyperlink{sugar_8h_aa2bc5aa57d417f3226228d9058ab9f20}{lambda}}\ =\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a857bb0e5f633e0600ea6861f14da8a1b}{m\_naiveU}}(1,\ firstCol\ +\ k);}
\DoxyCodeLine{00440\ \ \ \ \ phi\ =\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a857bb0e5f633e0600ea6861f14da8a1b}{m\_naiveU}}(0,\ lastCol\ +\ 1);}
\DoxyCodeLine{00441\ \ \ \}}
\DoxyCodeLine{00442\ \ \ r0\ =\ \mbox{\hyperlink{_array_cwise_unary_ops_8h_a656b9217a2fcb6de59dc8d1eb3079cc7}{sqrt}}((\mbox{\hyperlink{datatypes_8h_a3aa069ac3980707dae1e0530f50d59e4}{abs}}(alphaK\ *\ \mbox{\hyperlink{sugar_8h_aa2bc5aa57d417f3226228d9058ab9f20}{lambda}})\ *\ \mbox{\hyperlink{datatypes_8h_a3aa069ac3980707dae1e0530f50d59e4}{abs}}(alphaK\ *\ \mbox{\hyperlink{sugar_8h_aa2bc5aa57d417f3226228d9058ab9f20}{lambda}}))\ +\ \mbox{\hyperlink{datatypes_8h_a3aa069ac3980707dae1e0530f50d59e4}{abs}}(betaK\ *\ phi)\ *\ \mbox{\hyperlink{datatypes_8h_a3aa069ac3980707dae1e0530f50d59e4}{abs}}(betaK\ *\ phi));}
\DoxyCodeLine{00443\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a63dc95af59e08a68b11268e98feea7fa}{m\_compU}})}
\DoxyCodeLine{00444\ \ \ \{}
\DoxyCodeLine{00445\ \ \ \ \ l\ =\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a857bb0e5f633e0600ea6861f14da8a1b}{m\_naiveU}}.row(firstCol\ +\ k).segment(firstCol,\ k);}
\DoxyCodeLine{00446\ \ \ \ \ \mbox{\hyperlink{cxx11__tensor__map_8cpp_a7f507fea02198f6cb81c86640c7b1a4e}{f}}\ =\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a857bb0e5f633e0600ea6861f14da8a1b}{m\_naiveU}}.row(firstCol\ +\ k\ +\ 1).segment(firstCol\ +\ k\ +\ 1,\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}\ -\/\ k\ -\/\ 1);}
\DoxyCodeLine{00447\ \ \ \}\ }
\DoxyCodeLine{00448\ \ \ \textcolor{keywordflow}{else}\ }
\DoxyCodeLine{00449\ \ \ \{}
\DoxyCodeLine{00450\ \ \ \ \ l\ =\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a857bb0e5f633e0600ea6861f14da8a1b}{m\_naiveU}}.row(1).segment(firstCol,\ k);}
\DoxyCodeLine{00451\ \ \ \ \ \mbox{\hyperlink{cxx11__tensor__map_8cpp_a7f507fea02198f6cb81c86640c7b1a4e}{f}}\ =\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a857bb0e5f633e0600ea6861f14da8a1b}{m\_naiveU}}.row(0).segment(firstCol\ +\ k\ +\ 1,\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}\ -\/\ k\ -\/\ 1);}
\DoxyCodeLine{00452\ \ \ \}}
\DoxyCodeLine{00453\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a707ea2d37a7024a6317f001a6971fbec}{m\_compV}})\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a94b71ee8ecf0b6b621a1267cf136adc9}{m\_naiveV}}(firstRowW+k,\ firstColW)\ =\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_aad17038f9628ce5ed6e1461a67cd3a03}{Literal}}(1);}
\DoxyCodeLine{00454\ \ \ \textcolor{keywordflow}{if}\ (r0<considerZero)}
\DoxyCodeLine{00455\ \ \ \{}
\DoxyCodeLine{00456\ \ \ \ \ c0\ =\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_aad17038f9628ce5ed6e1461a67cd3a03}{Literal}}(1);}
\DoxyCodeLine{00457\ \ \ \ \ s0\ =\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_aad17038f9628ce5ed6e1461a67cd3a03}{Literal}}(0);}
\DoxyCodeLine{00458\ \ \ \}}
\DoxyCodeLine{00459\ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00460\ \ \ \{}
\DoxyCodeLine{00461\ \ \ \ \ c0\ =\ alphaK\ *\ \mbox{\hyperlink{sugar_8h_aa2bc5aa57d417f3226228d9058ab9f20}{lambda}}\ /\ r0;}
\DoxyCodeLine{00462\ \ \ \ \ s0\ =\ betaK\ *\ phi\ /\ r0;}
\DoxyCodeLine{00463\ \ \ \}}
\DoxyCodeLine{00464\ \ \ }
\DoxyCodeLine{00465\ \textcolor{preprocessor}{\#ifdef\ EIGEN\_BDCSVD\_SANITY\_CHECKS}}
\DoxyCodeLine{00466\ \ \ assert(\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a857bb0e5f633e0600ea6861f14da8a1b}{m\_naiveU}}.allFinite());}
\DoxyCodeLine{00467\ \ \ assert(\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a94b71ee8ecf0b6b621a1267cf136adc9}{m\_naiveV}}.allFinite());}
\DoxyCodeLine{00468\ \ \ assert(\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a76dcaed5bc2dd1c37832805fa8fed943}{m\_computed}}.allFinite());}
\DoxyCodeLine{00469\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00470\ \ \ }
\DoxyCodeLine{00471\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a63dc95af59e08a68b11268e98feea7fa}{m\_compU}})}
\DoxyCodeLine{00472\ \ \ \{}
\DoxyCodeLine{00473\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a7b32c2adca9f10283820f437f08f6271}{MatrixXr}}\ q1\ (\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a857bb0e5f633e0600ea6861f14da8a1b}{m\_naiveU}}.col(firstCol\ +\ k).segment(firstCol,\ k\ +\ 1));\ \ \ \ \ }
\DoxyCodeLine{00474\ \ \ \ \ \textcolor{comment}{//\ we\ shiftW\ Q1\ to\ the\ right}}
\DoxyCodeLine{00475\ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ =\ firstCol\ +\ k\ -\/\ 1;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ >=\ firstCol;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}-\/-\/)\ }
\DoxyCodeLine{00476\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a857bb0e5f633e0600ea6861f14da8a1b}{m\_naiveU}}.col(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ +\ 1).segment(firstCol,\ k\ +\ 1)\ =\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a857bb0e5f633e0600ea6861f14da8a1b}{m\_naiveU}}.col(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}).segment(firstCol,\ k\ +\ 1);}
\DoxyCodeLine{00477\ \ \ \ \ \textcolor{comment}{//\ we\ shift\ q1\ at\ the\ left\ with\ a\ factor\ c0}}
\DoxyCodeLine{00478\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a857bb0e5f633e0600ea6861f14da8a1b}{m\_naiveU}}.col(firstCol).segment(\ firstCol,\ k\ +\ 1)\ =\ (q1\ *\ c0);}
\DoxyCodeLine{00479\ \ \ \ \ \textcolor{comment}{//\ last\ column\ =\ q1\ *\ -\/\ s0}}
\DoxyCodeLine{00480\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a857bb0e5f633e0600ea6861f14da8a1b}{m\_naiveU}}.col(lastCol\ +\ 1).segment(firstCol,\ k\ +\ 1)\ =\ (q1\ *\ (\ -\/\ s0));}
\DoxyCodeLine{00481\ \ \ \ \ \textcolor{comment}{//\ first\ column\ =\ q2\ *\ s0}}
\DoxyCodeLine{00482\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a857bb0e5f633e0600ea6861f14da8a1b}{m\_naiveU}}.col(firstCol).segment(firstCol\ +\ k\ +\ 1,\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}\ -\/\ k)\ =\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a857bb0e5f633e0600ea6861f14da8a1b}{m\_naiveU}}.col(lastCol\ +\ 1).segment(firstCol\ +\ k\ +\ 1,\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}\ -\/\ k)\ *\ s0;\ }
\DoxyCodeLine{00483\ \ \ \ \ \textcolor{comment}{//\ q2\ *=\ c0}}
\DoxyCodeLine{00484\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a857bb0e5f633e0600ea6861f14da8a1b}{m\_naiveU}}.col(lastCol\ +\ 1).segment(firstCol\ +\ k\ +\ 1,\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}\ -\/\ k)\ *=\ c0;}
\DoxyCodeLine{00485\ \ \ \}\ }
\DoxyCodeLine{00486\ \ \ \textcolor{keywordflow}{else}\ }
\DoxyCodeLine{00487\ \ \ \{}
\DoxyCodeLine{00488\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a1b429d828258ec58c1fc4ced6213d64d}{RealScalar}}\ q1\ =\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a857bb0e5f633e0600ea6861f14da8a1b}{m\_naiveU}}(0,\ firstCol\ +\ k);}
\DoxyCodeLine{00489\ \ \ \ \ \textcolor{comment}{//\ we\ shift\ Q1\ to\ the\ right}}
\DoxyCodeLine{00490\ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ =\ firstCol\ +\ k\ -\/\ 1;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ >=\ firstCol;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}-\/-\/)\ }
\DoxyCodeLine{00491\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a857bb0e5f633e0600ea6861f14da8a1b}{m\_naiveU}}(0,\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ +\ 1)\ =\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a857bb0e5f633e0600ea6861f14da8a1b}{m\_naiveU}}(0,\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}});}
\DoxyCodeLine{00492\ \ \ \ \ \textcolor{comment}{//\ we\ shift\ q1\ at\ the\ left\ with\ a\ factor\ c0}}
\DoxyCodeLine{00493\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a857bb0e5f633e0600ea6861f14da8a1b}{m\_naiveU}}(0,\ firstCol)\ =\ (q1\ *\ c0);}
\DoxyCodeLine{00494\ \ \ \ \ \textcolor{comment}{//\ last\ column\ =\ q1\ *\ -\/\ s0}}
\DoxyCodeLine{00495\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a857bb0e5f633e0600ea6861f14da8a1b}{m\_naiveU}}(0,\ lastCol\ +\ 1)\ =\ (q1\ *\ (\ -\/\ s0));}
\DoxyCodeLine{00496\ \ \ \ \ \textcolor{comment}{//\ first\ column\ =\ q2\ *\ s0}}
\DoxyCodeLine{00497\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a857bb0e5f633e0600ea6861f14da8a1b}{m\_naiveU}}(1,\ firstCol)\ =\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a857bb0e5f633e0600ea6861f14da8a1b}{m\_naiveU}}(1,\ lastCol\ +\ 1)\ *s0;\ }
\DoxyCodeLine{00498\ \ \ \ \ \textcolor{comment}{//\ q2\ *=\ c0}}
\DoxyCodeLine{00499\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a857bb0e5f633e0600ea6861f14da8a1b}{m\_naiveU}}(1,\ lastCol\ +\ 1)\ *=\ c0;}
\DoxyCodeLine{00500\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a857bb0e5f633e0600ea6861f14da8a1b}{m\_naiveU}}.row(1).segment(firstCol\ +\ 1,\ k).setZero();}
\DoxyCodeLine{00501\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a857bb0e5f633e0600ea6861f14da8a1b}{m\_naiveU}}.row(0).segment(firstCol\ +\ k\ +\ 1,\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}\ -\/\ k\ -\/\ 1).setZero();}
\DoxyCodeLine{00502\ \ \ \}}
\DoxyCodeLine{00503\ \ \ }
\DoxyCodeLine{00504\ \textcolor{preprocessor}{\#ifdef\ EIGEN\_BDCSVD\_SANITY\_CHECKS}}
\DoxyCodeLine{00505\ \ \ assert(\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a857bb0e5f633e0600ea6861f14da8a1b}{m\_naiveU}}.allFinite());}
\DoxyCodeLine{00506\ \ \ assert(\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a94b71ee8ecf0b6b621a1267cf136adc9}{m\_naiveV}}.allFinite());}
\DoxyCodeLine{00507\ \ \ assert(\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a76dcaed5bc2dd1c37832805fa8fed943}{m\_computed}}.allFinite());}
\DoxyCodeLine{00508\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00509\ \ \ }
\DoxyCodeLine{00510\ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a76dcaed5bc2dd1c37832805fa8fed943}{m\_computed}}(firstCol\ +\ shift,\ firstCol\ +\ shift)\ =\ r0;}
\DoxyCodeLine{00511\ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a76dcaed5bc2dd1c37832805fa8fed943}{m\_computed}}.col(firstCol\ +\ shift).segment(firstCol\ +\ shift\ +\ 1,\ k)\ =\ alphaK\ *\ l.transpose().real();}
\DoxyCodeLine{00512\ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a76dcaed5bc2dd1c37832805fa8fed943}{m\_computed}}.col(firstCol\ +\ shift).segment(firstCol\ +\ shift\ +\ k\ +\ 1,\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}\ -\/\ k\ -\/\ 1)\ =\ betaK\ *\ \mbox{\hyperlink{cxx11__tensor__map_8cpp_a7f507fea02198f6cb81c86640c7b1a4e}{f}}.transpose().real();}
\DoxyCodeLine{00513\ }
\DoxyCodeLine{00514\ \textcolor{preprocessor}{\#ifdef\ EIGEN\_BDCSVD\_DEBUG\_VERBOSE}}
\DoxyCodeLine{00515\ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a1e177918a1acf8153ff5f323fbeed9fe}{ArrayXr}}\ tmp1\ =\ (\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a76dcaed5bc2dd1c37832805fa8fed943}{m\_computed}}.block(firstCol+shift,\ firstCol+shift,\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}},\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}})).jacobiSvd().singularValues();}
\DoxyCodeLine{00516\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00517\ \ \ \textcolor{comment}{//\ Second\ part:\ try\ to\ deflate\ singular\ values\ in\ combined\ matrix}}
\DoxyCodeLine{00518\ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_abf371e539b921d6f4821bf8e87f7ef32}{deflation}}(firstCol,\ lastCol,\ k,\ firstRowW,\ firstColW,\ shift);}
\DoxyCodeLine{00519\ \textcolor{preprocessor}{\#ifdef\ EIGEN\_BDCSVD\_DEBUG\_VERBOSE}}
\DoxyCodeLine{00520\ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a1e177918a1acf8153ff5f323fbeed9fe}{ArrayXr}}\ tmp2\ =\ (\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a76dcaed5bc2dd1c37832805fa8fed943}{m\_computed}}.block(firstCol+shift,\ firstCol+shift,\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}},\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}})).jacobiSvd().singularValues();}
\DoxyCodeLine{00521\ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n\(\backslash\)nj1\ =\ "{}}\ <<\ tmp1.transpose().format(bdcsvdfmt)\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00522\ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}j2\ =\ "{}}\ <<\ tmp2.transpose().format(bdcsvdfmt)\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n\(\backslash\)n"{}};}
\DoxyCodeLine{00523\ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}err:\ \ \ \ \ \ "{}}\ <<\ ((tmp1-\/tmp2).abs()>1\mbox{\hyperlink{_cwise__array__power__array_8cpp_a9cb86ff854760bf91a154f2724a9101d}{e}}-\/12*tmp2.abs()).transpose()\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00524\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}}\ =\ 0;}
\DoxyCodeLine{00525\ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}\#\ "{}}\ <<\ ++\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}}\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n\(\backslash\)n"{}};}
\DoxyCodeLine{00526\ \ \ assert((tmp1-\/tmp2).\mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}}().norm()\ <\ 1\mbox{\hyperlink{_cwise__array__power__array_8cpp_a9cb86ff854760bf91a154f2724a9101d}{e}}-\/14*tmp2.matrix().norm());}
\DoxyCodeLine{00527\ \textcolor{comment}{//\ \ \ assert(count<681);}}
\DoxyCodeLine{00528\ \textcolor{comment}{//\ \ \ assert(((tmp1-\/tmp2).abs()<1e-\/13*tmp2.abs()).all());}}
\DoxyCodeLine{00529\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00530\ \ \ }
\DoxyCodeLine{00531\ \ \ \textcolor{comment}{//\ Third\ part:\ compute\ SVD\ of\ combined\ matrix}}
\DoxyCodeLine{00532\ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a7b32c2adca9f10283820f437f08f6271}{MatrixXr}}\ UofSVD,\ VofSVD;}
\DoxyCodeLine{00533\ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a0ea2c57bf088d5fc480ad81945157079}{VectorType}}\ singVals;}
\DoxyCodeLine{00534\ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_ae5909813a632db6095ebd8af8541858a}{computeSVDofM}}(firstCol\ +\ shift,\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}},\ UofSVD,\ singVals,\ VofSVD);}
\DoxyCodeLine{00535\ \ \ }
\DoxyCodeLine{00536\ \textcolor{preprocessor}{\#ifdef\ EIGEN\_BDCSVD\_SANITY\_CHECKS}}
\DoxyCodeLine{00537\ \ \ assert(UofSVD.allFinite());}
\DoxyCodeLine{00538\ \ \ assert(VofSVD.allFinite());}
\DoxyCodeLine{00539\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00540\ \ \ }
\DoxyCodeLine{00541\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a63dc95af59e08a68b11268e98feea7fa}{m\_compU}})}
\DoxyCodeLine{00542\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a06da4be04bf0815bfc692b2ce4485aec}{structured\_update}}(\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a857bb0e5f633e0600ea6861f14da8a1b}{m\_naiveU}}.block(firstCol,\ firstCol,\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}\ +\ 1,\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}\ +\ 1),\ UofSVD,\ (\mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}+2)/2);}
\DoxyCodeLine{00543\ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00544\ \ \ \{}
\DoxyCodeLine{00545\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_map}{Map<Matrix<RealScalar,2,Dynamic>}},\mbox{\hyperlink{group__enums_gga45fe06e29902b7a2773de05ba27b47a1ae12d0f8f869c40c76128260af2242bc8}{Aligned}}>\ tmp(\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_ad62998546febd86ba715a9eae4c47b4b}{m\_workspace}}.data(),2,\mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}+1);}
\DoxyCodeLine{00546\ \ \ \ \ tmp.noalias()\ =\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a857bb0e5f633e0600ea6861f14da8a1b}{m\_naiveU}}.middleCols(firstCol,\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}+1)\ *\ UofSVD;}
\DoxyCodeLine{00547\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a857bb0e5f633e0600ea6861f14da8a1b}{m\_naiveU}}.middleCols(firstCol,\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}\ +\ 1)\ =\ tmp;}
\DoxyCodeLine{00548\ \ \ \}}
\DoxyCodeLine{00549\ \ \ }
\DoxyCodeLine{00550\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a707ea2d37a7024a6317f001a6971fbec}{m\_compV}})\ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a06da4be04bf0815bfc692b2ce4485aec}{structured\_update}}(\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a94b71ee8ecf0b6b621a1267cf136adc9}{m\_naiveV}}.block(firstRowW,\ firstColW,\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}},\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}),\ VofSVD,\ (\mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}+1)/2);}
\DoxyCodeLine{00551\ \ \ }
\DoxyCodeLine{00552\ \textcolor{preprocessor}{\#ifdef\ EIGEN\_BDCSVD\_SANITY\_CHECKS}}
\DoxyCodeLine{00553\ \ \ assert(\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a857bb0e5f633e0600ea6861f14da8a1b}{m\_naiveU}}.allFinite());}
\DoxyCodeLine{00554\ \ \ assert(\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a94b71ee8ecf0b6b621a1267cf136adc9}{m\_naiveV}}.allFinite());}
\DoxyCodeLine{00555\ \ \ assert(\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a76dcaed5bc2dd1c37832805fa8fed943}{m\_computed}}.allFinite());}
\DoxyCodeLine{00556\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00557\ \ \ }
\DoxyCodeLine{00558\ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a76dcaed5bc2dd1c37832805fa8fed943}{m\_computed}}.block(firstCol\ +\ shift,\ firstCol\ +\ shift,\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}},\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}).setZero();}
\DoxyCodeLine{00559\ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a76dcaed5bc2dd1c37832805fa8fed943}{m\_computed}}.block(firstCol\ +\ shift,\ firstCol\ +\ shift,\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}},\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}).diagonal()\ =\ singVals;}
\DoxyCodeLine{00560\ \}\textcolor{comment}{//\ end\ divide}}
\DoxyCodeLine{00561\ }
\DoxyCodeLine{00562\ \textcolor{comment}{//\ Compute\ SVD\ of\ m\_computed.block(firstCol,\ firstCol,\ n\ +\ 1,\ n);\ this\ block\ only\ has\ non-\/zeros\ in}}
\DoxyCodeLine{00563\ \textcolor{comment}{//\ the\ first\ column\ and\ on\ the\ diagonal\ and\ has\ undergone\ deflation,\ so\ diagonal\ is\ in\ increasing}}
\DoxyCodeLine{00564\ \textcolor{comment}{//\ order\ except\ for\ possibly\ the\ (0,0)\ entry.\ The\ computed\ SVD\ is\ stored\ U,\ singVals\ and\ V,\ except}}
\DoxyCodeLine{00565\ \textcolor{comment}{//\ that\ if\ m\_compV\ is\ false,\ then\ V\ is\ not\ computed.\ Singular\ values\ are\ sorted\ in\ decreasing\ order.}}
\DoxyCodeLine{00566\ \textcolor{comment}{//}}
\DoxyCodeLine{00567\ \textcolor{comment}{//\ TODO\ Opportunities\ for\ optimization:\ better\ root\ finding\ algo,\ better\ stopping\ criterion,\ better}}
\DoxyCodeLine{00568\ \textcolor{comment}{//\ handling\ of\ round-\/off\ errors,\ be\ consistent\ in\ ordering}}
\DoxyCodeLine{00569\ \textcolor{comment}{//\ For\ instance,\ to\ solve\ the\ secular\ equation\ using\ FMM,\ see\ http://www.stat.uchicago.edu/\string~lekheng/courses/302/classics/greengard-\/rokhlin.pdf}}
\DoxyCodeLine{00570\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ MatrixType>}
\DoxyCodeLine{00571\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_ae5909813a632db6095ebd8af8541858a}{BDCSVD<MatrixType>::computeSVDofM}}(\mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ firstCol,\ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}},\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a7b32c2adca9f10283820f437f08f6271}{MatrixXr}}\&\ U,\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a0ea2c57bf088d5fc480ad81945157079}{VectorType}}\&\ singVals,\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a7b32c2adca9f10283820f437f08f6271}{MatrixXr}}\&\ \mbox{\hyperlink{_eigen_solver___eigen_solver___matrix_type_8cpp_a77c224aa52b434918ce65c33175aa8ad}{V}})}
\DoxyCodeLine{00572\ \{}
\DoxyCodeLine{00573\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a1b429d828258ec58c1fc4ced6213d64d}{RealScalar}}\ considerZero\ =\ (std::numeric\_limits<RealScalar>::min)();}
\DoxyCodeLine{00574\ \ \ \textcolor{keyword}{using\ }std::abs;}
\DoxyCodeLine{00575\ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_ad30a7a883b86028c45559593c7a678a2}{ArrayRef}}\ col0\ =\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a76dcaed5bc2dd1c37832805fa8fed943}{m\_computed}}.col(firstCol).segment(firstCol,\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}});}
\DoxyCodeLine{00576\ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_ad62998546febd86ba715a9eae4c47b4b}{m\_workspace}}.head(\mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}})\ =\ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a76dcaed5bc2dd1c37832805fa8fed943}{m\_computed}}.block(firstCol,\ firstCol,\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}},\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}).diagonal();}
\DoxyCodeLine{00577\ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_ad30a7a883b86028c45559593c7a678a2}{ArrayRef}}\ diag\ =\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_ad62998546febd86ba715a9eae4c47b4b}{m\_workspace}}.head(\mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}});}
\DoxyCodeLine{00578\ \ \ diag(0)\ =\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_aad17038f9628ce5ed6e1461a67cd3a03}{Literal}}(0);}
\DoxyCodeLine{00579\ }
\DoxyCodeLine{00580\ \ \ \textcolor{comment}{//\ Allocate\ space\ for\ singular\ values\ and\ vectors}}
\DoxyCodeLine{00581\ \ \ singVals.\mbox{\hyperlink{class_eigen_1_1_plain_object_base_a99d9054ee2d5a40c6e00ded0265e9cea}{resize}}(\mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}});}
\DoxyCodeLine{00582\ \ \ U.\mbox{\hyperlink{class_eigen_1_1_plain_object_base_a99d9054ee2d5a40c6e00ded0265e9cea}{resize}}(\mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}+1,\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}+1);}
\DoxyCodeLine{00583\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a707ea2d37a7024a6317f001a6971fbec}{m\_compV}})\ \mbox{\hyperlink{_eigen_solver___eigen_solver___matrix_type_8cpp_a77c224aa52b434918ce65c33175aa8ad}{V}}.resize(\mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}},\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}});}
\DoxyCodeLine{00584\ }
\DoxyCodeLine{00585\ \textcolor{preprocessor}{\#ifdef\ EIGEN\_BDCSVD\_DEBUG\_VERBOSE}}
\DoxyCodeLine{00586\ \ \ \textcolor{keywordflow}{if}\ (col0.hasNaN()\ ||\ diag.hasNaN())}
\DoxyCodeLine{00587\ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n\(\backslash\)nHAS\ NAN\(\backslash\)n\(\backslash\)n"{}};}
\DoxyCodeLine{00588\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00589\ \ \ }
\DoxyCodeLine{00590\ \ \ \textcolor{comment}{//\ Many\ singular\ values\ might\ have\ been\ deflated,\ the\ zero\ ones\ have\ been\ moved\ to\ the\ end,}}
\DoxyCodeLine{00591\ \ \ \textcolor{comment}{//\ but\ others\ are\ interleaved\ and\ we\ must\ ignore\ them\ at\ this\ stage.}}
\DoxyCodeLine{00592\ \ \ \textcolor{comment}{//\ To\ this\ end,\ let's\ compute\ a\ permutation\ skipping\ them:}}
\DoxyCodeLine{00593\ \ \ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ actual\_n\ =\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}};}
\DoxyCodeLine{00594\ \ \ \textcolor{keywordflow}{while}(actual\_n>1\ \&\&\ diag(actual\_n-\/1)==\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_aad17038f9628ce5ed6e1461a67cd3a03}{Literal}}(0))\ -\/-\/actual\_n;}
\DoxyCodeLine{00595\ \ \ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ \mbox{\hyperlink{_angle_axis__mimic__euler_8cpp_ab3cd915d758008bd19d0f2428fbb354a}{m}}\ =\ 0;\ \textcolor{comment}{//\ size\ of\ the\ deflated\ problem}}
\DoxyCodeLine{00596\ \ \ \textcolor{keywordflow}{for}(\mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ k=0;k<actual\_n;++k)}
\DoxyCodeLine{00597\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{datatypes_8h_a3aa069ac3980707dae1e0530f50d59e4}{abs}}(col0(k))>considerZero)}
\DoxyCodeLine{00598\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a8bfc4be4bdc669038298ea29b940532f}{m\_workspaceI}}(\mbox{\hyperlink{_angle_axis__mimic__euler_8cpp_ab3cd915d758008bd19d0f2428fbb354a}{m}}++)\ =\ k;}
\DoxyCodeLine{00599\ \ \ \mbox{\hyperlink{class_eigen_1_1_map}{Map<ArrayXi>}}\ perm(\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a8bfc4be4bdc669038298ea29b940532f}{m\_workspaceI}}.data(),\mbox{\hyperlink{_angle_axis__mimic__euler_8cpp_ab3cd915d758008bd19d0f2428fbb354a}{m}});}
\DoxyCodeLine{00600\ \ \ }
\DoxyCodeLine{00601\ \ \ \mbox{\hyperlink{class_eigen_1_1_map}{Map<ArrayXr>}}\ shifts(\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_ad62998546febd86ba715a9eae4c47b4b}{m\_workspace}}.data()+1*\mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}},\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}});}
\DoxyCodeLine{00602\ \ \ \mbox{\hyperlink{class_eigen_1_1_map}{Map<ArrayXr>}}\ mus(\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_ad62998546febd86ba715a9eae4c47b4b}{m\_workspace}}.data()+2*\mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}},\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}});}
\DoxyCodeLine{00603\ \ \ \mbox{\hyperlink{class_eigen_1_1_map}{Map<ArrayXr>}}\ zhat(\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_ad62998546febd86ba715a9eae4c47b4b}{m\_workspace}}.data()+3*\mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}},\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}});}
\DoxyCodeLine{00604\ }
\DoxyCodeLine{00605\ \textcolor{preprocessor}{\#ifdef\ EIGEN\_BDCSVD\_DEBUG\_VERBOSE}}
\DoxyCodeLine{00606\ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}computeSVDofM\ using:\(\backslash\)n"{}};}
\DoxyCodeLine{00607\ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}\ \ z:\ "{}}\ <<\ col0.transpose()\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00608\ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}\ \ d:\ "{}}\ <<\ diag.transpose()\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00609\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00610\ \ \ }
\DoxyCodeLine{00611\ \ \ \textcolor{comment}{//\ Compute\ singVals,\ shifts,\ and\ mus}}
\DoxyCodeLine{00612\ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_ae1e384bc66726e45f96e7f0cc054487a}{computeSingVals}}(col0,\ diag,\ perm,\ singVals,\ shifts,\ mus);}
\DoxyCodeLine{00613\ \ \ }
\DoxyCodeLine{00614\ \textcolor{preprocessor}{\#ifdef\ EIGEN\_BDCSVD\_DEBUG\_VERBOSE}}
\DoxyCodeLine{00615\ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}\ \ j:\ \ \ \ \ \ \ \ "{}}\ <<\ (\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a76dcaed5bc2dd1c37832805fa8fed943}{m\_computed}}.block(firstCol,\ firstCol,\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}},\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}})).jacobiSvd().singularValues().transpose().reverse()\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n\(\backslash\)n"{}};}
\DoxyCodeLine{00616\ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}\ \ sing-\/val:\ "{}}\ <<\ singVals.transpose()\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00617\ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}\ \ mu:\ \ \ \ \ \ \ "{}}\ <<\ mus.transpose()\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00618\ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}\ \ shift:\ \ \ \ "{}}\ <<\ shifts.transpose()\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00619\ \ \ }
\DoxyCodeLine{00620\ \ \ \{}
\DoxyCodeLine{00621\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ actual\_n\ =\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}};}
\DoxyCodeLine{00622\ \ \ \ \ \textcolor{keywordflow}{while}(actual\_n>1\ \&\&\ \mbox{\hyperlink{datatypes_8h_a3aa069ac3980707dae1e0530f50d59e4}{abs}}(col0(actual\_n-\/1))<considerZero)\ -\/-\/actual\_n;}
\DoxyCodeLine{00623\ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n\(\backslash\)n\ \ \ \ mus:\ \ \ \ "{}}\ <<\ mus.head(actual\_n).transpose()\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n\(\backslash\)n"{}};}
\DoxyCodeLine{00624\ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}\ \ \ \ check1\ (expect0)\ :\ "{}}\ <<\ ((singVals.array()-\/(shifts+mus))\ /\ singVals.array()).head(actual\_n).transpose()\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n\(\backslash\)n"{}};}
\DoxyCodeLine{00625\ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}\ \ \ \ check2\ (>0)\ \ \ \ \ \ :\ "{}}\ <<\ ((singVals.array()-\/diag)\ /\ singVals.array()).head(actual\_n).transpose()\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n\(\backslash\)n"{}};}
\DoxyCodeLine{00626\ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}\ \ \ \ check3\ (>0)\ \ \ \ \ \ :\ "{}}\ <<\ ((diag.segment(1,actual\_n-\/1)-\/singVals.head(actual\_n-\/1).array())\ /\ singVals.head(actual\_n-\/1).array()).transpose()\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n\(\backslash\)n\(\backslash\)n"{}};}
\DoxyCodeLine{00627\ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}\ \ \ \ check4\ (>0)\ \ \ \ \ \ :\ "{}}\ <<\ ((singVals.segment(1,actual\_n-\/1)-\/singVals.head(actual\_n-\/1))).transpose()\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n\(\backslash\)n\(\backslash\)n"{}};}
\DoxyCodeLine{00628\ \ \ \}}
\DoxyCodeLine{00629\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00630\ \ \ }
\DoxyCodeLine{00631\ \textcolor{preprocessor}{\#ifdef\ EIGEN\_BDCSVD\_SANITY\_CHECKS}}
\DoxyCodeLine{00632\ \ \ assert(singVals.allFinite());}
\DoxyCodeLine{00633\ \ \ assert(mus.allFinite());}
\DoxyCodeLine{00634\ \ \ assert(shifts.allFinite());}
\DoxyCodeLine{00635\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00636\ \ \ }
\DoxyCodeLine{00637\ \ \ \textcolor{comment}{//\ Compute\ zhat}}
\DoxyCodeLine{00638\ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a7f023b27fd80bd56632fdad81c4c8b4b}{perturbCol0}}(col0,\ diag,\ perm,\ singVals,\ shifts,\ mus,\ zhat);}
\DoxyCodeLine{00639\ \textcolor{preprocessor}{\#ifdef\ \ EIGEN\_BDCSVD\_DEBUG\_VERBOSE}}
\DoxyCodeLine{00640\ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}\ \ zhat:\ "{}}\ <<\ zhat.transpose()\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00641\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00642\ \ \ }
\DoxyCodeLine{00643\ \textcolor{preprocessor}{\#ifdef\ EIGEN\_BDCSVD\_SANITY\_CHECKS}}
\DoxyCodeLine{00644\ \ \ assert(zhat.allFinite());}
\DoxyCodeLine{00645\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00646\ \ \ }
\DoxyCodeLine{00647\ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a2e28be342355e1414d26cfd65325ba7f}{computeSingVecs}}(zhat,\ diag,\ perm,\ singVals,\ shifts,\ mus,\ U,\ \mbox{\hyperlink{_eigen_solver___eigen_solver___matrix_type_8cpp_a77c224aa52b434918ce65c33175aa8ad}{V}});}
\DoxyCodeLine{00648\ \ \ }
\DoxyCodeLine{00649\ \textcolor{preprocessor}{\#ifdef\ \ EIGEN\_BDCSVD\_DEBUG\_VERBOSE}}
\DoxyCodeLine{00650\ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}U\string^T\ U:\ "{}}\ <<\ (U.transpose()\ *\ U\ -\/\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a7b32c2adca9f10283820f437f08f6271}{MatrixXr}}(MatrixXr::Identity(U.\mbox{\hyperlink{class_eigen_1_1_plain_object_base_a10b8b33b7587da564415561aa246f78f}{cols}}(),U.\mbox{\hyperlink{class_eigen_1_1_plain_object_base_a10b8b33b7587da564415561aa246f78f}{cols}}()))).norm()\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00651\ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}V\string^T\ V:\ "{}}\ <<\ (\mbox{\hyperlink{_eigen_solver___eigen_solver___matrix_type_8cpp_a77c224aa52b434918ce65c33175aa8ad}{V}}.transpose()\ *\ \mbox{\hyperlink{_eigen_solver___eigen_solver___matrix_type_8cpp_a77c224aa52b434918ce65c33175aa8ad}{V}}\ -\/\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a7b32c2adca9f10283820f437f08f6271}{MatrixXr}}(MatrixXr::Identity(\mbox{\hyperlink{_eigen_solver___eigen_solver___matrix_type_8cpp_a77c224aa52b434918ce65c33175aa8ad}{V}}.cols(),\mbox{\hyperlink{_eigen_solver___eigen_solver___matrix_type_8cpp_a77c224aa52b434918ce65c33175aa8ad}{V}}.cols()))).norm()\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00652\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00653\ \ \ }
\DoxyCodeLine{00654\ \textcolor{preprocessor}{\#ifdef\ EIGEN\_BDCSVD\_SANITY\_CHECKS}}
\DoxyCodeLine{00655\ \ \ assert(U.allFinite());}
\DoxyCodeLine{00656\ \ \ assert(\mbox{\hyperlink{_eigen_solver___eigen_solver___matrix_type_8cpp_a77c224aa52b434918ce65c33175aa8ad}{V}}.allFinite());}
\DoxyCodeLine{00657\ \ \ assert((U.transpose()\ *\ U\ -\/\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a7b32c2adca9f10283820f437f08f6271}{MatrixXr}}(MatrixXr::Identity(U.\mbox{\hyperlink{class_eigen_1_1_plain_object_base_a10b8b33b7587da564415561aa246f78f}{cols}}(),U.\mbox{\hyperlink{class_eigen_1_1_plain_object_base_a10b8b33b7587da564415561aa246f78f}{cols}}()))).norm()\ <\ 1\mbox{\hyperlink{_cwise__array__power__array_8cpp_a9cb86ff854760bf91a154f2724a9101d}{e}}-\/14\ *\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}});}
\DoxyCodeLine{00658\ \ \ assert((\mbox{\hyperlink{_eigen_solver___eigen_solver___matrix_type_8cpp_a77c224aa52b434918ce65c33175aa8ad}{V}}.transpose()\ *\ \mbox{\hyperlink{_eigen_solver___eigen_solver___matrix_type_8cpp_a77c224aa52b434918ce65c33175aa8ad}{V}}\ -\/\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a7b32c2adca9f10283820f437f08f6271}{MatrixXr}}(MatrixXr::Identity(\mbox{\hyperlink{_eigen_solver___eigen_solver___matrix_type_8cpp_a77c224aa52b434918ce65c33175aa8ad}{V}}.cols(),\mbox{\hyperlink{_eigen_solver___eigen_solver___matrix_type_8cpp_a77c224aa52b434918ce65c33175aa8ad}{V}}.cols()))).norm()\ <\ 1\mbox{\hyperlink{_cwise__array__power__array_8cpp_a9cb86ff854760bf91a154f2724a9101d}{e}}-\/14\ *\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}});}
\DoxyCodeLine{00659\ \ \ assert(\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a857bb0e5f633e0600ea6861f14da8a1b}{m\_naiveU}}.allFinite());}
\DoxyCodeLine{00660\ \ \ assert(\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a94b71ee8ecf0b6b621a1267cf136adc9}{m\_naiveV}}.allFinite());}
\DoxyCodeLine{00661\ \ \ assert(\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a76dcaed5bc2dd1c37832805fa8fed943}{m\_computed}}.allFinite());}
\DoxyCodeLine{00662\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00663\ \ \ }
\DoxyCodeLine{00664\ \ \ \textcolor{comment}{//\ Because\ of\ deflation,\ the\ singular\ values\ might\ not\ be\ completely\ sorted.}}
\DoxyCodeLine{00665\ \ \ \textcolor{comment}{//\ Fortunately,\ reordering\ them\ is\ a\ O(n)\ problem}}
\DoxyCodeLine{00666\ \ \ \textcolor{keywordflow}{for}(\mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}=0;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}<actual\_n-\/1;\ ++\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})}
\DoxyCodeLine{00667\ \ \ \{}
\DoxyCodeLine{00668\ \ \ \ \ \textcolor{keywordflow}{if}(singVals(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})>singVals(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}+1))}
\DoxyCodeLine{00669\ \ \ \ \ \{}
\DoxyCodeLine{00670\ \ \ \ \ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{namespacestd_a3acbe51b6415e9284430194bf04944e1}{std::swap}};}
\DoxyCodeLine{00671\ \ \ \ \ \ \ \mbox{\hyperlink{level1__impl_8h_a2e2212d2e55ad7479d212e08b2eb0345}{swap}}(singVals(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}),singVals(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}+1));}
\DoxyCodeLine{00672\ \ \ \ \ \ \ U.col(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}).\mbox{\hyperlink{class_eigen_1_1_plain_object_base_aa86254240c534cc55143f38af58c8bdf}{swap}}(U.col(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}+1));}
\DoxyCodeLine{00673\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a707ea2d37a7024a6317f001a6971fbec}{m\_compV}})\ \mbox{\hyperlink{_eigen_solver___eigen_solver___matrix_type_8cpp_a77c224aa52b434918ce65c33175aa8ad}{V}}.col(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}).swap(\mbox{\hyperlink{_eigen_solver___eigen_solver___matrix_type_8cpp_a77c224aa52b434918ce65c33175aa8ad}{V}}.col(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}+1));}
\DoxyCodeLine{00674\ \ \ \ \ \}}
\DoxyCodeLine{00675\ \ \ \}}
\DoxyCodeLine{00676\ \ \ }
\DoxyCodeLine{00677\ \ \ \textcolor{comment}{//\ Reverse\ order\ so\ that\ singular\ values\ in\ increased\ order}}
\DoxyCodeLine{00678\ \ \ \textcolor{comment}{//\ Because\ of\ deflation,\ the\ zeros\ singular-\/values\ are\ already\ at\ the\ end}}
\DoxyCodeLine{00679\ \ \ singVals.head(actual\_n).reverseInPlace();}
\DoxyCodeLine{00680\ \ \ U.leftCols(actual\_n).rowwise().reverseInPlace();}
\DoxyCodeLine{00681\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a707ea2d37a7024a6317f001a6971fbec}{m\_compV}})\ \mbox{\hyperlink{_eigen_solver___eigen_solver___matrix_type_8cpp_a77c224aa52b434918ce65c33175aa8ad}{V}}.leftCols(actual\_n).rowwise().reverseInPlace();}
\DoxyCodeLine{00682\ \ \ }
\DoxyCodeLine{00683\ \textcolor{preprocessor}{\#ifdef\ EIGEN\_BDCSVD\_DEBUG\_VERBOSE}}
\DoxyCodeLine{00684\ \ \ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d}{JacobiSVD<MatrixXr>}}\ jsvd(\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a76dcaed5bc2dd1c37832805fa8fed943}{m\_computed}}.block(firstCol,\ firstCol,\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}},\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}})\ );}
\DoxyCodeLine{00685\ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}\ \ *\ j:\ \ \ \ \ \ \ \ "{}}\ <<\ jsvd.\mbox{\hyperlink{class_eigen_1_1_s_v_d_base_ac44c307a70731003003faf3a9bdf14f6}{singularValues}}().transpose()\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n\(\backslash\)n"{}};}
\DoxyCodeLine{00686\ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}\ \ *\ sing-\/val:\ "{}}\ <<\ singVals.transpose()\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00687\ \textcolor{comment}{//\ \ \ std::cout\ <<\ "{}\ \ *\ err:\ \ \ \ \ \ "{}\ <<\ ((jsvd.singularValues()-\/singVals)>1e-\/13*singVals.norm()).transpose()\ <<\ "{}\(\backslash\)n"{};}}
\DoxyCodeLine{00688\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00689\ \}}
\DoxyCodeLine{00690\ }
\DoxyCodeLine{00691\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ MatrixType>}
\DoxyCodeLine{00692\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a1b429d828258ec58c1fc4ced6213d64d}{BDCSVD<MatrixType>::RealScalar}}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a2f1d2d4ca5769579c4eb0f04e03e7e7a}{BDCSVD<MatrixType>::secularEq}}(\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a1b429d828258ec58c1fc4ced6213d64d}{RealScalar}}\ mu,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_ad30a7a883b86028c45559593c7a678a2}{ArrayRef}}\&\ col0,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_ad30a7a883b86028c45559593c7a678a2}{ArrayRef}}\&\ diag,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_aab1c377c616062cc85356e47312cb412}{IndicesRef}}\ \&perm,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_ad30a7a883b86028c45559593c7a678a2}{ArrayRef}}\&\ diagShifted,\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a1b429d828258ec58c1fc4ced6213d64d}{RealScalar}}\ shift)}
\DoxyCodeLine{00693\ \{}
\DoxyCodeLine{00694\ \ \ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ \mbox{\hyperlink{_angle_axis__mimic__euler_8cpp_ab3cd915d758008bd19d0f2428fbb354a}{m}}\ =\ perm.size();}
\DoxyCodeLine{00695\ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a1b429d828258ec58c1fc4ced6213d64d}{RealScalar}}\ \mbox{\hyperlink{_partial_redux__count_8cpp_acbe60897559b79afc28b79b0687b5f29}{res}}\ =\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_aad17038f9628ce5ed6e1461a67cd3a03}{Literal}}(1);}
\DoxyCodeLine{00696\ \ \ \textcolor{keywordflow}{for}(\mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}=0;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}<\mbox{\hyperlink{_angle_axis__mimic__euler_8cpp_ab3cd915d758008bd19d0f2428fbb354a}{m}};\ ++\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})}
\DoxyCodeLine{00697\ \ \ \{}
\DoxyCodeLine{00698\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}\ =\ perm(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}});}
\DoxyCodeLine{00699\ \ \ \ \ \textcolor{comment}{//\ The\ following\ expression\ could\ be\ rewritten\ to\ involve\ only\ a\ single\ division,}}
\DoxyCodeLine{00700\ \ \ \ \ \textcolor{comment}{//\ but\ this\ would\ make\ the\ expression\ more\ sensitive\ to\ overflow.}}
\DoxyCodeLine{00701\ \ \ \ \ \mbox{\hyperlink{_partial_redux__count_8cpp_acbe60897559b79afc28b79b0687b5f29}{res}}\ +=\ (col0(\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}})\ /\ (diagShifted(\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}})\ -\/\ mu))\ *\ (col0(\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}})\ /\ (diag(\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}})\ +\ shift\ +\ mu));}
\DoxyCodeLine{00702\ \ \ \}}
\DoxyCodeLine{00703\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{_partial_redux__count_8cpp_acbe60897559b79afc28b79b0687b5f29}{res}};}
\DoxyCodeLine{00704\ }
\DoxyCodeLine{00705\ \}}
\DoxyCodeLine{00706\ }
\DoxyCodeLine{00707\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ MatrixType>}
\DoxyCodeLine{00708\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_ae1e384bc66726e45f96e7f0cc054487a}{BDCSVD<MatrixType>::computeSingVals}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_ad30a7a883b86028c45559593c7a678a2}{ArrayRef}}\&\ col0,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_ad30a7a883b86028c45559593c7a678a2}{ArrayRef}}\&\ diag,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_aab1c377c616062cc85356e47312cb412}{IndicesRef}}\ \&perm,}
\DoxyCodeLine{00709\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a0ea2c57bf088d5fc480ad81945157079}{VectorType}}\&\ singVals,\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_ad30a7a883b86028c45559593c7a678a2}{ArrayRef}}\ shifts,\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_ad30a7a883b86028c45559593c7a678a2}{ArrayRef}}\ mus)}
\DoxyCodeLine{00710\ \{}
\DoxyCodeLine{00711\ \ \ \textcolor{keyword}{using\ }std::abs;}
\DoxyCodeLine{00712\ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{namespacestd_a3acbe51b6415e9284430194bf04944e1}{std::swap}};}
\DoxyCodeLine{00713\ \ \ \textcolor{keyword}{using\ }std::sqrt;}
\DoxyCodeLine{00714\ }
\DoxyCodeLine{00715\ \ \ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}\ =\ col0.size();}
\DoxyCodeLine{00716\ \ \ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ actual\_n\ =\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}};}
\DoxyCodeLine{00717\ \ \ \textcolor{comment}{//\ Note\ that\ here\ actual\_n\ is\ computed\ based\ on\ col0(i)==0\ instead\ of\ diag(i)==0\ as\ above}}
\DoxyCodeLine{00718\ \ \ \textcolor{comment}{//\ because\ 1)\ we\ have\ diag(i)==0\ =>\ col0(i)==0\ and\ 2)\ if\ col0(i)==0,\ then\ diag(i)\ is\ already\ a\ singular\ value.}}
\DoxyCodeLine{00719\ \ \ \textcolor{keywordflow}{while}(actual\_n>1\ \&\&\ col0(actual\_n-\/1)==\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_aad17038f9628ce5ed6e1461a67cd3a03}{Literal}}(0))\ -\/-\/actual\_n;}
\DoxyCodeLine{00720\ }
\DoxyCodeLine{00721\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ k\ =\ 0;\ k\ <\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}};\ ++k)}
\DoxyCodeLine{00722\ \ \ \{}
\DoxyCodeLine{00723\ \ \ \ \ \textcolor{keywordflow}{if}\ (col0(k)\ ==\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_aad17038f9628ce5ed6e1461a67cd3a03}{Literal}}(0)\ ||\ actual\_n==1)}
\DoxyCodeLine{00724\ \ \ \ \ \{}
\DoxyCodeLine{00725\ \ \ \ \ \ \ \textcolor{comment}{//\ if\ col0(k)\ ==\ 0,\ then\ entry\ is\ deflated,\ so\ singular\ value\ is\ on\ diagonal}}
\DoxyCodeLine{00726\ \ \ \ \ \ \ \textcolor{comment}{//\ if\ actual\_n==1,\ then\ the\ deflated\ problem\ is\ already\ diagonalized}}
\DoxyCodeLine{00727\ \ \ \ \ \ \ singVals(k)\ =\ k==0\ ?\ col0(0)\ :\ diag(k);}
\DoxyCodeLine{00728\ \ \ \ \ \ \ mus(k)\ =\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_aad17038f9628ce5ed6e1461a67cd3a03}{Literal}}(0);}
\DoxyCodeLine{00729\ \ \ \ \ \ \ shifts(k)\ =\ k==0\ ?\ col0(0)\ :\ diag(k);}
\DoxyCodeLine{00730\ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00731\ \ \ \ \ \}\ }
\DoxyCodeLine{00732\ }
\DoxyCodeLine{00733\ \ \ \ \ \textcolor{comment}{//\ otherwise,\ use\ secular\ equation\ to\ find\ singular\ value}}
\DoxyCodeLine{00734\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a1b429d828258ec58c1fc4ced6213d64d}{RealScalar}}\ \mbox{\hyperlink{blas__interface_8hh_af32074257ed1b575dfd1ab2f6e6ba59f}{left}}\ =\ diag(k);}
\DoxyCodeLine{00735\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a1b429d828258ec58c1fc4ced6213d64d}{RealScalar}}\ \mbox{\hyperlink{blas__interface_8hh_ae258f4b5364eaaabd106893a19064f76}{right}};\ \textcolor{comment}{//\ was:\ =\ (k\ !=\ actual\_n-\/1)\ ?\ diag(k+1)\ :\ (diag(actual\_n-\/1)\ +\ col0.matrix().norm());}}
\DoxyCodeLine{00736\ \ \ \ \ \textcolor{keywordflow}{if}(k==actual\_n-\/1)}
\DoxyCodeLine{00737\ \ \ \ \ \ \ \mbox{\hyperlink{blas__interface_8hh_ae258f4b5364eaaabd106893a19064f76}{right}}\ =\ (diag(actual\_n-\/1)\ +\ col0.matrix().norm());}
\DoxyCodeLine{00738\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00739\ \ \ \ \ \{}
\DoxyCodeLine{00740\ \ \ \ \ \ \ \textcolor{comment}{//\ Skip\ deflated\ singular\ values,}}
\DoxyCodeLine{00741\ \ \ \ \ \ \ \textcolor{comment}{//\ recall\ that\ at\ this\ stage\ we\ assume\ that\ z[j]!=0\ and\ all\ entries\ for\ which\ z[j]==0\ have\ been\ put\ aside.}}
\DoxyCodeLine{00742\ \ \ \ \ \ \ \textcolor{comment}{//\ This\ should\ be\ equivalent\ to\ using\ perm[]}}
\DoxyCodeLine{00743\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ l\ =\ k+1;}
\DoxyCodeLine{00744\ \ \ \ \ \ \ \textcolor{keywordflow}{while}(col0(l)==\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_aad17038f9628ce5ed6e1461a67cd3a03}{Literal}}(0))\ \{\ ++l;\ \mbox{\hyperlink{eigen-3_83_87_2_eigen_2src_2_core_2util_2_macros_8h_a4e742b5a08636a61784c0e173b61e710}{eigen\_internal\_assert}}(l<actual\_n);\ \}}
\DoxyCodeLine{00745\ \ \ \ \ \ \ \mbox{\hyperlink{blas__interface_8hh_ae258f4b5364eaaabd106893a19064f76}{right}}\ =\ diag(l);}
\DoxyCodeLine{00746\ \ \ \ \ \}}
\DoxyCodeLine{00747\ }
\DoxyCodeLine{00748\ \ \ \ \ \textcolor{comment}{//\ first\ decide\ whether\ it's\ closer\ to\ the\ left\ end\ or\ the\ right\ end}}
\DoxyCodeLine{00749\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a1b429d828258ec58c1fc4ced6213d64d}{RealScalar}}\ mid\ =\ \mbox{\hyperlink{blas__interface_8hh_af32074257ed1b575dfd1ab2f6e6ba59f}{left}}\ +\ (\mbox{\hyperlink{blas__interface_8hh_ae258f4b5364eaaabd106893a19064f76}{right}}-\/\mbox{\hyperlink{blas__interface_8hh_af32074257ed1b575dfd1ab2f6e6ba59f}{left}})\ /\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_aad17038f9628ce5ed6e1461a67cd3a03}{Literal}}(2);}
\DoxyCodeLine{00750\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a1b429d828258ec58c1fc4ced6213d64d}{RealScalar}}\ fMid\ =\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a2f1d2d4ca5769579c4eb0f04e03e7e7a}{secularEq}}(mid,\ col0,\ diag,\ perm,\ diag,\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_aad17038f9628ce5ed6e1461a67cd3a03}{Literal}}(0));}
\DoxyCodeLine{00751\ \textcolor{preprocessor}{\#ifdef\ EIGEN\_BDCSVD\_DEBUG\_VERBOSE}}
\DoxyCodeLine{00752\ \ \ \ \ std::cout\ <<\ \mbox{\hyperlink{blas__interface_8hh_ae258f4b5364eaaabd106893a19064f76}{right}}-\/\mbox{\hyperlink{blas__interface_8hh_af32074257ed1b575dfd1ab2f6e6ba59f}{left}}\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00753\ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}fMid\ =\ "{}}\ <<\ fMid\ <<\ \textcolor{stringliteral}{"{}\ "{}}\ <<\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a2f1d2d4ca5769579c4eb0f04e03e7e7a}{secularEq}}(mid-\/\mbox{\hyperlink{blas__interface_8hh_af32074257ed1b575dfd1ab2f6e6ba59f}{left}},\ col0,\ diag,\ perm,\ diag-\/\mbox{\hyperlink{blas__interface_8hh_af32074257ed1b575dfd1ab2f6e6ba59f}{left}},\ \mbox{\hyperlink{blas__interface_8hh_af32074257ed1b575dfd1ab2f6e6ba59f}{left}})\ <<\ \textcolor{stringliteral}{"{}\ "{}}\ <<\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a2f1d2d4ca5769579c4eb0f04e03e7e7a}{secularEq}}(mid-\/\mbox{\hyperlink{blas__interface_8hh_ae258f4b5364eaaabd106893a19064f76}{right}},\ col0,\ diag,\ perm,\ diag-\/\mbox{\hyperlink{blas__interface_8hh_ae258f4b5364eaaabd106893a19064f76}{right}},\ \mbox{\hyperlink{blas__interface_8hh_ae258f4b5364eaaabd106893a19064f76}{right}})\ \ \ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00754\ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}\ \ \ \ \ =\ "{}}\ <<\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a2f1d2d4ca5769579c4eb0f04e03e7e7a}{secularEq}}(0.1*(\mbox{\hyperlink{blas__interface_8hh_af32074257ed1b575dfd1ab2f6e6ba59f}{left}}+\mbox{\hyperlink{blas__interface_8hh_ae258f4b5364eaaabd106893a19064f76}{right}}),\ col0,\ diag,\ perm,\ diag,\ 0)}
\DoxyCodeLine{00755\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ "{}}\ \ \ \ \ \ \ <<\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a2f1d2d4ca5769579c4eb0f04e03e7e7a}{secularEq}}(0.2*(\mbox{\hyperlink{blas__interface_8hh_af32074257ed1b575dfd1ab2f6e6ba59f}{left}}+\mbox{\hyperlink{blas__interface_8hh_ae258f4b5364eaaabd106893a19064f76}{right}}),\ col0,\ diag,\ perm,\ diag,\ 0)}
\DoxyCodeLine{00756\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ "{}}\ \ \ \ \ \ \ <<\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a2f1d2d4ca5769579c4eb0f04e03e7e7a}{secularEq}}(0.3*(\mbox{\hyperlink{blas__interface_8hh_af32074257ed1b575dfd1ab2f6e6ba59f}{left}}+\mbox{\hyperlink{blas__interface_8hh_ae258f4b5364eaaabd106893a19064f76}{right}}),\ col0,\ diag,\ perm,\ diag,\ 0)}
\DoxyCodeLine{00757\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ "{}}\ \ \ \ \ \ \ <<\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a2f1d2d4ca5769579c4eb0f04e03e7e7a}{secularEq}}(0.4*(\mbox{\hyperlink{blas__interface_8hh_af32074257ed1b575dfd1ab2f6e6ba59f}{left}}+\mbox{\hyperlink{blas__interface_8hh_ae258f4b5364eaaabd106893a19064f76}{right}}),\ col0,\ diag,\ perm,\ diag,\ 0)}
\DoxyCodeLine{00758\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ "{}}\ \ \ \ \ \ \ <<\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a2f1d2d4ca5769579c4eb0f04e03e7e7a}{secularEq}}(0.49*(\mbox{\hyperlink{blas__interface_8hh_af32074257ed1b575dfd1ab2f6e6ba59f}{left}}+\mbox{\hyperlink{blas__interface_8hh_ae258f4b5364eaaabd106893a19064f76}{right}}),\ col0,\ diag,\ perm,\ diag,\ 0)}
\DoxyCodeLine{00759\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ "{}}\ \ \ \ \ \ \ <<\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a2f1d2d4ca5769579c4eb0f04e03e7e7a}{secularEq}}(0.5*(\mbox{\hyperlink{blas__interface_8hh_af32074257ed1b575dfd1ab2f6e6ba59f}{left}}+\mbox{\hyperlink{blas__interface_8hh_ae258f4b5364eaaabd106893a19064f76}{right}}),\ col0,\ diag,\ perm,\ diag,\ 0)}
\DoxyCodeLine{00760\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ "{}}\ \ \ \ \ \ \ <<\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a2f1d2d4ca5769579c4eb0f04e03e7e7a}{secularEq}}(0.51*(\mbox{\hyperlink{blas__interface_8hh_af32074257ed1b575dfd1ab2f6e6ba59f}{left}}+\mbox{\hyperlink{blas__interface_8hh_ae258f4b5364eaaabd106893a19064f76}{right}}),\ col0,\ diag,\ perm,\ diag,\ 0)}
\DoxyCodeLine{00761\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ "{}}\ \ \ \ \ \ \ <<\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a2f1d2d4ca5769579c4eb0f04e03e7e7a}{secularEq}}(0.6*(\mbox{\hyperlink{blas__interface_8hh_af32074257ed1b575dfd1ab2f6e6ba59f}{left}}+\mbox{\hyperlink{blas__interface_8hh_ae258f4b5364eaaabd106893a19064f76}{right}}),\ col0,\ diag,\ perm,\ diag,\ 0)}
\DoxyCodeLine{00762\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ "{}}\ \ \ \ \ \ \ <<\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a2f1d2d4ca5769579c4eb0f04e03e7e7a}{secularEq}}(0.7*(\mbox{\hyperlink{blas__interface_8hh_af32074257ed1b575dfd1ab2f6e6ba59f}{left}}+\mbox{\hyperlink{blas__interface_8hh_ae258f4b5364eaaabd106893a19064f76}{right}}),\ col0,\ diag,\ perm,\ diag,\ 0)}
\DoxyCodeLine{00763\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ "{}}\ \ \ \ \ \ \ <<\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a2f1d2d4ca5769579c4eb0f04e03e7e7a}{secularEq}}(0.8*(\mbox{\hyperlink{blas__interface_8hh_af32074257ed1b575dfd1ab2f6e6ba59f}{left}}+\mbox{\hyperlink{blas__interface_8hh_ae258f4b5364eaaabd106893a19064f76}{right}}),\ col0,\ diag,\ perm,\ diag,\ 0)}
\DoxyCodeLine{00764\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ "{}}\ \ \ \ \ \ \ <<\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a2f1d2d4ca5769579c4eb0f04e03e7e7a}{secularEq}}(0.9*(\mbox{\hyperlink{blas__interface_8hh_af32074257ed1b575dfd1ab2f6e6ba59f}{left}}+\mbox{\hyperlink{blas__interface_8hh_ae258f4b5364eaaabd106893a19064f76}{right}}),\ col0,\ diag,\ perm,\ diag,\ 0)\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00765\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00766\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a1b429d828258ec58c1fc4ced6213d64d}{RealScalar}}\ shift\ =\ (k\ ==\ actual\_n-\/1\ ||\ fMid\ >\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_aad17038f9628ce5ed6e1461a67cd3a03}{Literal}}(0))\ ?\ \mbox{\hyperlink{blas__interface_8hh_af32074257ed1b575dfd1ab2f6e6ba59f}{left}}\ :\ \mbox{\hyperlink{blas__interface_8hh_ae258f4b5364eaaabd106893a19064f76}{right}};}
\DoxyCodeLine{00767\ \ \ \ \ }
\DoxyCodeLine{00768\ \ \ \ \ \textcolor{comment}{//\ measure\ everything\ relative\ to\ shift}}
\DoxyCodeLine{00769\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_map}{Map<ArrayXr>}}\ diagShifted(\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_ad62998546febd86ba715a9eae4c47b4b}{m\_workspace}}.data()+4*\mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}},\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}});}
\DoxyCodeLine{00770\ \ \ \ \ diagShifted\ =\ diag\ -\/\ shift;}
\DoxyCodeLine{00771\ \ \ \ \ }
\DoxyCodeLine{00772\ \ \ \ \ \textcolor{comment}{//\ initial\ guess}}
\DoxyCodeLine{00773\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a1b429d828258ec58c1fc4ced6213d64d}{RealScalar}}\ muPrev,\ muCur;}
\DoxyCodeLine{00774\ \ \ \ \ \textcolor{keywordflow}{if}\ (shift\ ==\ \mbox{\hyperlink{blas__interface_8hh_af32074257ed1b575dfd1ab2f6e6ba59f}{left}})}
\DoxyCodeLine{00775\ \ \ \ \ \{}
\DoxyCodeLine{00776\ \ \ \ \ \ \ muPrev\ =\ (\mbox{\hyperlink{blas__interface_8hh_ae258f4b5364eaaabd106893a19064f76}{right}}\ -\/\ \mbox{\hyperlink{blas__interface_8hh_af32074257ed1b575dfd1ab2f6e6ba59f}{left}})\ *\ \mbox{\hyperlink{bench__gemm_8cpp_acb5c3dc237f99cf17167e8a629f01b43}{RealScalar}}(0.1);}
\DoxyCodeLine{00777\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (k\ ==\ actual\_n-\/1)\ muCur\ =\ \mbox{\hyperlink{blas__interface_8hh_ae258f4b5364eaaabd106893a19064f76}{right}}\ -\/\ \mbox{\hyperlink{blas__interface_8hh_af32074257ed1b575dfd1ab2f6e6ba59f}{left}};}
\DoxyCodeLine{00778\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ muCur\ =\ (\mbox{\hyperlink{blas__interface_8hh_ae258f4b5364eaaabd106893a19064f76}{right}}\ -\/\ \mbox{\hyperlink{blas__interface_8hh_af32074257ed1b575dfd1ab2f6e6ba59f}{left}})\ *\ \mbox{\hyperlink{bench__gemm_8cpp_acb5c3dc237f99cf17167e8a629f01b43}{RealScalar}}(0.5);}
\DoxyCodeLine{00779\ \ \ \ \ \}}
\DoxyCodeLine{00780\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00781\ \ \ \ \ \{}
\DoxyCodeLine{00782\ \ \ \ \ \ \ muPrev\ =\ -\/(\mbox{\hyperlink{blas__interface_8hh_ae258f4b5364eaaabd106893a19064f76}{right}}\ -\/\ \mbox{\hyperlink{blas__interface_8hh_af32074257ed1b575dfd1ab2f6e6ba59f}{left}})\ *\ \mbox{\hyperlink{bench__gemm_8cpp_acb5c3dc237f99cf17167e8a629f01b43}{RealScalar}}(0.1);}
\DoxyCodeLine{00783\ \ \ \ \ \ \ muCur\ =\ -\/(\mbox{\hyperlink{blas__interface_8hh_ae258f4b5364eaaabd106893a19064f76}{right}}\ -\/\ \mbox{\hyperlink{blas__interface_8hh_af32074257ed1b575dfd1ab2f6e6ba59f}{left}})\ *\ \mbox{\hyperlink{bench__gemm_8cpp_acb5c3dc237f99cf17167e8a629f01b43}{RealScalar}}(0.5);}
\DoxyCodeLine{00784\ \ \ \ \ \}}
\DoxyCodeLine{00785\ }
\DoxyCodeLine{00786\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a1b429d828258ec58c1fc4ced6213d64d}{RealScalar}}\ fPrev\ =\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a2f1d2d4ca5769579c4eb0f04e03e7e7a}{secularEq}}(muPrev,\ col0,\ diag,\ perm,\ diagShifted,\ shift);}
\DoxyCodeLine{00787\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a1b429d828258ec58c1fc4ced6213d64d}{RealScalar}}\ fCur\ =\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a2f1d2d4ca5769579c4eb0f04e03e7e7a}{secularEq}}(muCur,\ col0,\ diag,\ perm,\ diagShifted,\ shift);}
\DoxyCodeLine{00788\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{datatypes_8h_a3aa069ac3980707dae1e0530f50d59e4}{abs}}(fPrev)\ <\ \mbox{\hyperlink{datatypes_8h_a3aa069ac3980707dae1e0530f50d59e4}{abs}}(fCur))}
\DoxyCodeLine{00789\ \ \ \ \ \{}
\DoxyCodeLine{00790\ \ \ \ \ \ \ \mbox{\hyperlink{level1__impl_8h_a2e2212d2e55ad7479d212e08b2eb0345}{swap}}(fPrev,\ fCur);}
\DoxyCodeLine{00791\ \ \ \ \ \ \ \mbox{\hyperlink{level1__impl_8h_a2e2212d2e55ad7479d212e08b2eb0345}{swap}}(muPrev,\ muCur);}
\DoxyCodeLine{00792\ \ \ \ \ \}}
\DoxyCodeLine{00793\ }
\DoxyCodeLine{00794\ \ \ \ \ \textcolor{comment}{//\ rational\ interpolation:\ fit\ a\ function\ of\ the\ form\ a\ /\ mu\ +\ b\ through\ the\ two\ previous}}
\DoxyCodeLine{00795\ \ \ \ \ \textcolor{comment}{//\ iterates\ and\ use\ its\ zero\ to\ compute\ the\ next\ iterate}}
\DoxyCodeLine{00796\ \ \ \ \ \textcolor{keywordtype}{bool}\ useBisection\ =\ fPrev*fCur>\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_aad17038f9628ce5ed6e1461a67cd3a03}{Literal}}(0);}
\DoxyCodeLine{00797\ \ \ \ \ \textcolor{keywordflow}{while}\ (fCur!=\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_aad17038f9628ce5ed6e1461a67cd3a03}{Literal}}(0)\ \&\&\ \mbox{\hyperlink{datatypes_8h_a3aa069ac3980707dae1e0530f50d59e4}{abs}}(muCur\ -\/\ muPrev)\ >\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_aad17038f9628ce5ed6e1461a67cd3a03}{Literal}}(8)\ *\ \mbox{\hyperlink{struct_eigen_1_1_generic_num_traits_aadcf7fa75b2bc9a0e461a3b851d836a7}{NumTraits<RealScalar>::epsilon}}()\ *\ \mbox{\hyperlink{namespace_eigen_1_1numext_a29d502349f2ec9897c808e65e0f96eb4}{numext::maxi<RealScalar>}}(\mbox{\hyperlink{datatypes_8h_a3aa069ac3980707dae1e0530f50d59e4}{abs}}(muCur),\ \mbox{\hyperlink{datatypes_8h_a3aa069ac3980707dae1e0530f50d59e4}{abs}}(muPrev))\ \&\&\ \mbox{\hyperlink{datatypes_8h_a3aa069ac3980707dae1e0530f50d59e4}{abs}}(fCur\ -\/\ fPrev)>\mbox{\hyperlink{struct_eigen_1_1_generic_num_traits_aadcf7fa75b2bc9a0e461a3b851d836a7}{NumTraits<RealScalar>::epsilon}}()\ \&\&\ !useBisection)}
\DoxyCodeLine{00798\ \ \ \ \ \{}
\DoxyCodeLine{00799\ \ \ \ \ \ \ ++\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_ade7ebb87b1735432218681831b1801cc}{m\_numIters}};}
\DoxyCodeLine{00800\ }
\DoxyCodeLine{00801\ \ \ \ \ \ \ \textcolor{comment}{//\ Find\ a\ and\ b\ such\ that\ the\ function\ f(mu)\ =\ a\ /\ mu\ +\ b\ matches\ the\ current\ and\ previous\ samples.}}
\DoxyCodeLine{00802\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a1b429d828258ec58c1fc4ced6213d64d}{RealScalar}}\ \mbox{\hyperlink{_cwise__product_8cpp_ad2cbe4616e813eb9af81732dca777b24}{a}}\ =\ (fCur\ -\/\ fPrev)\ /\ (\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_aad17038f9628ce5ed6e1461a67cd3a03}{Literal}}(1)/muCur\ -\/\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_aad17038f9628ce5ed6e1461a67cd3a03}{Literal}}(1)/muPrev);}
\DoxyCodeLine{00803\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a1b429d828258ec58c1fc4ced6213d64d}{RealScalar}}\ \mbox{\hyperlink{offscreen_8c_a846c9667e34d56c560bb7f0ac6e173f6}{b}}\ =\ fCur\ -\/\ \mbox{\hyperlink{_cwise__product_8cpp_ad2cbe4616e813eb9af81732dca777b24}{a}}\ /\ muCur;}
\DoxyCodeLine{00804\ \ \ \ \ \ \ \textcolor{comment}{//\ And\ find\ mu\ such\ that\ f(mu)==0:}}
\DoxyCodeLine{00805\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a1b429d828258ec58c1fc4ced6213d64d}{RealScalar}}\ muZero\ =\ -\/\mbox{\hyperlink{_cwise__product_8cpp_ad2cbe4616e813eb9af81732dca777b24}{a}}/\mbox{\hyperlink{offscreen_8c_a846c9667e34d56c560bb7f0ac6e173f6}{b}};}
\DoxyCodeLine{00806\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a1b429d828258ec58c1fc4ced6213d64d}{RealScalar}}\ fZero\ =\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a2f1d2d4ca5769579c4eb0f04e03e7e7a}{secularEq}}(muZero,\ col0,\ diag,\ perm,\ diagShifted,\ shift);}
\DoxyCodeLine{00807\ \ \ \ \ \ \ }
\DoxyCodeLine{00808\ \ \ \ \ \ \ muPrev\ =\ muCur;}
\DoxyCodeLine{00809\ \ \ \ \ \ \ fPrev\ =\ fCur;}
\DoxyCodeLine{00810\ \ \ \ \ \ \ muCur\ =\ muZero;}
\DoxyCodeLine{00811\ \ \ \ \ \ \ fCur\ =\ fZero;}
\DoxyCodeLine{00812\ \ \ \ \ \ \ }
\DoxyCodeLine{00813\ \ \ \ \ \ \ }
\DoxyCodeLine{00814\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (shift\ ==\ \mbox{\hyperlink{blas__interface_8hh_af32074257ed1b575dfd1ab2f6e6ba59f}{left}}\ \ \&\&\ (muCur\ <\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_aad17038f9628ce5ed6e1461a67cd3a03}{Literal}}(0)\ ||\ muCur\ >\ \mbox{\hyperlink{blas__interface_8hh_ae258f4b5364eaaabd106893a19064f76}{right}}\ -\/\ \mbox{\hyperlink{blas__interface_8hh_af32074257ed1b575dfd1ab2f6e6ba59f}{left}}))\ useBisection\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00815\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (shift\ ==\ \mbox{\hyperlink{blas__interface_8hh_ae258f4b5364eaaabd106893a19064f76}{right}}\ \&\&\ (muCur\ <\ -\/(\mbox{\hyperlink{blas__interface_8hh_ae258f4b5364eaaabd106893a19064f76}{right}}\ -\/\ \mbox{\hyperlink{blas__interface_8hh_af32074257ed1b575dfd1ab2f6e6ba59f}{left}})\ ||\ muCur\ >\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_aad17038f9628ce5ed6e1461a67cd3a03}{Literal}}(0)))\ useBisection\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00816\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{datatypes_8h_a3aa069ac3980707dae1e0530f50d59e4}{abs}}(fCur)>\mbox{\hyperlink{datatypes_8h_a3aa069ac3980707dae1e0530f50d59e4}{abs}}(fPrev))\ useBisection\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00817\ \ \ \ \ \}}
\DoxyCodeLine{00818\ }
\DoxyCodeLine{00819\ \ \ \ \ \textcolor{comment}{//\ fall\ back\ on\ bisection\ method\ if\ rational\ interpolation\ did\ not\ work}}
\DoxyCodeLine{00820\ \ \ \ \ \textcolor{keywordflow}{if}\ (useBisection)}
\DoxyCodeLine{00821\ \ \ \ \ \{}
\DoxyCodeLine{00822\ \textcolor{preprocessor}{\#ifdef\ \ EIGEN\_BDCSVD\_DEBUG\_VERBOSE}}
\DoxyCodeLine{00823\ \ \ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}useBisection\ for\ k\ =\ "{}}\ <<\ k\ <<\ \textcolor{stringliteral}{"{},\ actual\_n\ =\ "{}}\ <<\ actual\_n\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00824\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00825\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a1b429d828258ec58c1fc4ced6213d64d}{RealScalar}}\ leftShifted,\ rightShifted;}
\DoxyCodeLine{00826\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (shift\ ==\ \mbox{\hyperlink{blas__interface_8hh_af32074257ed1b575dfd1ab2f6e6ba59f}{left}})}
\DoxyCodeLine{00827\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00828\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ to\ avoid\ overflow,\ we\ must\ have\ mu\ >\ max(real\_min,\ |z(k)|/sqrt(real\_max)),}}
\DoxyCodeLine{00829\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ the\ factor\ 2\ is\ to\ be\ more\ conservative}}
\DoxyCodeLine{00830\ \ \ \ \ \ \ \ \ leftShifted\ =\ \mbox{\hyperlink{namespace_eigen_1_1numext_a29d502349f2ec9897c808e65e0f96eb4}{numext::maxi<RealScalar>}}(\ (std::numeric\_limits<RealScalar>::min)(),\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_aad17038f9628ce5ed6e1461a67cd3a03}{Literal}}(2)\ *\ \mbox{\hyperlink{datatypes_8h_a3aa069ac3980707dae1e0530f50d59e4}{abs}}(col0(k))\ /\ \mbox{\hyperlink{_array_cwise_unary_ops_8h_a656b9217a2fcb6de59dc8d1eb3079cc7}{sqrt}}((std::numeric\_limits<RealScalar>::max)())\ );}
\DoxyCodeLine{00831\ }
\DoxyCodeLine{00832\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ check\ that\ we\ did\ it\ right:}}
\DoxyCodeLine{00833\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{eigen-3_83_87_2_eigen_2src_2_core_2util_2_macros_8h_a4e742b5a08636a61784c0e173b61e710}{eigen\_internal\_assert}}(\ (\mbox{\hyperlink{namespace_eigen_1_1numext_a7e14263bc3784b17cbd6f13c69c97003}{numext::isfinite}})(\ (col0(k)/leftShifted)*(col0(k)/(diag(k)+shift+leftShifted))\ )\ );}
\DoxyCodeLine{00834\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ I\ don't\ understand\ why\ the\ case\ k==0\ would\ be\ special\ there:}}
\DoxyCodeLine{00835\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ if\ (k\ ==\ 0)\ rightShifted\ =\ right\ -\/\ left;\ else}}
\DoxyCodeLine{00836\ \ \ \ \ \ \ \ \ rightShifted\ =\ (k==actual\_n-\/1)\ ?\ \mbox{\hyperlink{blas__interface_8hh_ae258f4b5364eaaabd106893a19064f76}{right}}\ :\ ((\mbox{\hyperlink{blas__interface_8hh_ae258f4b5364eaaabd106893a19064f76}{right}}\ -\/\ \mbox{\hyperlink{blas__interface_8hh_af32074257ed1b575dfd1ab2f6e6ba59f}{left}})\ *\ \mbox{\hyperlink{bench__gemm_8cpp_acb5c3dc237f99cf17167e8a629f01b43}{RealScalar}}(0.51));\ \textcolor{comment}{//\ theoretically\ we\ can\ take\ 0.5,\ but\ let's\ be\ safe}}
\DoxyCodeLine{00837\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00838\ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00839\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00840\ \ \ \ \ \ \ \ \ leftShifted\ =\ -\/(\mbox{\hyperlink{blas__interface_8hh_ae258f4b5364eaaabd106893a19064f76}{right}}\ -\/\ \mbox{\hyperlink{blas__interface_8hh_af32074257ed1b575dfd1ab2f6e6ba59f}{left}})\ *\ \mbox{\hyperlink{bench__gemm_8cpp_acb5c3dc237f99cf17167e8a629f01b43}{RealScalar}}(0.51);}
\DoxyCodeLine{00841\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(k+1<\mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}})}
\DoxyCodeLine{00842\ \ \ \ \ \ \ \ \ \ \ rightShifted\ =\ -\/\mbox{\hyperlink{namespace_eigen_1_1numext_a29d502349f2ec9897c808e65e0f96eb4}{numext::maxi<RealScalar>}}(\ (std::numeric\_limits<RealScalar>::min)(),\ \mbox{\hyperlink{datatypes_8h_a3aa069ac3980707dae1e0530f50d59e4}{abs}}(col0(k+1))\ /\ \mbox{\hyperlink{_array_cwise_unary_ops_8h_a656b9217a2fcb6de59dc8d1eb3079cc7}{sqrt}}((std::numeric\_limits<RealScalar>::max)())\ );}
\DoxyCodeLine{00843\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00844\ \ \ \ \ \ \ \ \ \ \ rightShifted\ =\ -\/(std::numeric\_limits<RealScalar>::min)();}
\DoxyCodeLine{00845\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00846\ \ \ \ \ \ \ }
\DoxyCodeLine{00847\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a1b429d828258ec58c1fc4ced6213d64d}{RealScalar}}\ fLeft\ =\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a2f1d2d4ca5769579c4eb0f04e03e7e7a}{secularEq}}(leftShifted,\ col0,\ diag,\ perm,\ diagShifted,\ shift);}
\DoxyCodeLine{00848\ }
\DoxyCodeLine{00849\ \textcolor{preprocessor}{\#if\ defined\ EIGEN\_INTERNAL\_DEBUGGING\ ||\ defined\ EIGEN\_BDCSVD\_DEBUG\_VERBOSE}}
\DoxyCodeLine{00850\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a1b429d828258ec58c1fc4ced6213d64d}{RealScalar}}\ fRight\ =\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a2f1d2d4ca5769579c4eb0f04e03e7e7a}{secularEq}}(rightShifted,\ col0,\ diag,\ perm,\ diagShifted,\ shift);}
\DoxyCodeLine{00851\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00852\ }
\DoxyCodeLine{00853\ \textcolor{preprocessor}{\#ifdef\ \ EIGEN\_BDCSVD\_DEBUG\_VERBOSE}}
\DoxyCodeLine{00854\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!(fLeft\ *\ fRight<0))}
\DoxyCodeLine{00855\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00856\ \ \ \ \ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}fLeft:\ "{}}\ <<\ leftShifted\ <<\ \textcolor{stringliteral}{"{}\ -\/\ "{}}\ <<\ diagShifted.head(10).transpose()\ \ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n\ ;\ "{}}\ <<\ \mbox{\hyperlink{sugar_8h_abb452686968e48b67397da5f97445f5b}{bool}}(\mbox{\hyperlink{blas__interface_8hh_af32074257ed1b575dfd1ab2f6e6ba59f}{left}}==shift)\ <<\ \textcolor{stringliteral}{"{}\ "{}}\ <<\ (\mbox{\hyperlink{blas__interface_8hh_af32074257ed1b575dfd1ab2f6e6ba59f}{left}}-\/shift)\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00857\ \ \ \ \ \ \ \ \ std::cout\ <<\ k\ <<\ \textcolor{stringliteral}{"{}\ :\ "{}}\ <<\ \ fLeft\ <<\ \textcolor{stringliteral}{"{}\ *\ "{}}\ <<\ fRight\ <<\ \textcolor{stringliteral}{"{}\ ==\ "{}}\ <<\ fLeft\ *\ fRight\ <<\ \textcolor{stringliteral}{"{}\ \ ;\ \ "{}}\ <<\ \mbox{\hyperlink{blas__interface_8hh_af32074257ed1b575dfd1ab2f6e6ba59f}{left}}\ <<\ \textcolor{stringliteral}{"{}\ -\/\ "{}}\ <<\ \mbox{\hyperlink{blas__interface_8hh_ae258f4b5364eaaabd106893a19064f76}{right}}\ <<\ \textcolor{stringliteral}{"{}\ -\/>\ "{}}\ <<\ \ leftShifted\ <<\ \textcolor{stringliteral}{"{}\ "{}}\ <<\ rightShifted\ <<\ \textcolor{stringliteral}{"{}\ \ \ shift="{}}\ <<\ shift\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00858\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00859\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00860\ \ \ \ \ \ \ \mbox{\hyperlink{eigen-3_83_87_2_eigen_2src_2_core_2util_2_macros_8h_a4e742b5a08636a61784c0e173b61e710}{eigen\_internal\_assert}}(fLeft\ *\ fRight\ <\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_aad17038f9628ce5ed6e1461a67cd3a03}{Literal}}(0));}
\DoxyCodeLine{00861\ \ \ \ \ \ \ }
\DoxyCodeLine{00862\ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (rightShifted\ -\/\ leftShifted\ >\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_aad17038f9628ce5ed6e1461a67cd3a03}{Literal}}(2)\ *\ \mbox{\hyperlink{struct_eigen_1_1_generic_num_traits_aadcf7fa75b2bc9a0e461a3b851d836a7}{NumTraits<RealScalar>::epsilon}}()\ *\ \mbox{\hyperlink{namespace_eigen_1_1numext_a29d502349f2ec9897c808e65e0f96eb4}{numext::maxi<RealScalar>}}(\mbox{\hyperlink{datatypes_8h_a3aa069ac3980707dae1e0530f50d59e4}{abs}}(leftShifted),\ \mbox{\hyperlink{datatypes_8h_a3aa069ac3980707dae1e0530f50d59e4}{abs}}(rightShifted)))}
\DoxyCodeLine{00863\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00864\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a1b429d828258ec58c1fc4ced6213d64d}{RealScalar}}\ midShifted\ =\ (leftShifted\ +\ rightShifted)\ /\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_aad17038f9628ce5ed6e1461a67cd3a03}{Literal}}(2);}
\DoxyCodeLine{00865\ \ \ \ \ \ \ \ \ fMid\ =\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a2f1d2d4ca5769579c4eb0f04e03e7e7a}{secularEq}}(midShifted,\ col0,\ diag,\ perm,\ diagShifted,\ shift);}
\DoxyCodeLine{00866\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (fLeft\ *\ fMid\ <\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_aad17038f9628ce5ed6e1461a67cd3a03}{Literal}}(0))}
\DoxyCodeLine{00867\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00868\ \ \ \ \ \ \ \ \ \ \ rightShifted\ =\ midShifted;}
\DoxyCodeLine{00869\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00870\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00871\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00872\ \ \ \ \ \ \ \ \ \ \ leftShifted\ =\ midShifted;}
\DoxyCodeLine{00873\ \ \ \ \ \ \ \ \ \ \ fLeft\ =\ fMid;}
\DoxyCodeLine{00874\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00875\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00876\ }
\DoxyCodeLine{00877\ \ \ \ \ \ \ muCur\ =\ (leftShifted\ +\ rightShifted)\ /\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_aad17038f9628ce5ed6e1461a67cd3a03}{Literal}}(2);}
\DoxyCodeLine{00878\ \ \ \ \ \}}
\DoxyCodeLine{00879\ \ \ \ \ \ \ }
\DoxyCodeLine{00880\ \ \ \ \ singVals[k]\ =\ shift\ +\ muCur;}
\DoxyCodeLine{00881\ \ \ \ \ shifts[k]\ =\ shift;}
\DoxyCodeLine{00882\ \ \ \ \ mus[k]\ =\ muCur;}
\DoxyCodeLine{00883\ }
\DoxyCodeLine{00884\ \ \ \ \ \textcolor{comment}{//\ perturb\ singular\ value\ slightly\ if\ it\ equals\ diagonal\ entry\ to\ avoid\ division\ by\ zero\ later}}
\DoxyCodeLine{00885\ \ \ \ \ \textcolor{comment}{//\ (deflation\ is\ supposed\ to\ avoid\ this\ from\ happening)}}
\DoxyCodeLine{00886\ \ \ \ \ \textcolor{comment}{//\ -\/\ this\ does\ no\ seem\ to\ be\ necessary\ anymore\ -\/}}
\DoxyCodeLine{00887\ \textcolor{comment}{//\ \ \ \ \ if\ (singVals[k]\ ==\ left)\ singVals[k]\ *=\ 1\ +\ NumTraits<RealScalar>::epsilon();}}
\DoxyCodeLine{00888\ \textcolor{comment}{//\ \ \ \ \ if\ (singVals[k]\ ==\ right)\ singVals[k]\ *=\ 1\ -\/\ NumTraits<RealScalar>::epsilon();}}
\DoxyCodeLine{00889\ \ \ \}}
\DoxyCodeLine{00890\ \}}
\DoxyCodeLine{00891\ }
\DoxyCodeLine{00892\ }
\DoxyCodeLine{00893\ \textcolor{comment}{//\ zhat\ is\ perturbation\ of\ col0\ for\ which\ singular\ vectors\ can\ be\ computed\ stably\ (see\ Section\ 3.1)}}
\DoxyCodeLine{00894\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ MatrixType>}
\DoxyCodeLine{00895\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a7f023b27fd80bd56632fdad81c4c8b4b}{BDCSVD<MatrixType>::perturbCol0}}}
\DoxyCodeLine{00896\ \ \ \ (\textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_ad30a7a883b86028c45559593c7a678a2}{ArrayRef}}\&\ col0,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_ad30a7a883b86028c45559593c7a678a2}{ArrayRef}}\&\ diag,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_aab1c377c616062cc85356e47312cb412}{IndicesRef}}\ \&perm,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a0ea2c57bf088d5fc480ad81945157079}{VectorType}}\&\ singVals,}
\DoxyCodeLine{00897\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_ad30a7a883b86028c45559593c7a678a2}{ArrayRef}}\&\ shifts,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_ad30a7a883b86028c45559593c7a678a2}{ArrayRef}}\&\ mus,\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_ad30a7a883b86028c45559593c7a678a2}{ArrayRef}}\ zhat)}
\DoxyCodeLine{00898\ \{}
\DoxyCodeLine{00899\ \ \ \textcolor{keyword}{using\ }std::sqrt;}
\DoxyCodeLine{00900\ \ \ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}\ =\ col0.size();}
\DoxyCodeLine{00901\ \ \ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ \mbox{\hyperlink{_angle_axis__mimic__euler_8cpp_ab3cd915d758008bd19d0f2428fbb354a}{m}}\ =\ perm.size();}
\DoxyCodeLine{00902\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{_angle_axis__mimic__euler_8cpp_ab3cd915d758008bd19d0f2428fbb354a}{m}}==0)}
\DoxyCodeLine{00903\ \ \ \{}
\DoxyCodeLine{00904\ \ \ \ \ zhat.setZero();}
\DoxyCodeLine{00905\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00906\ \ \ \}}
\DoxyCodeLine{00907\ \ \ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ last\ =\ perm(\mbox{\hyperlink{_angle_axis__mimic__euler_8cpp_ab3cd915d758008bd19d0f2428fbb354a}{m}}-\/1);}
\DoxyCodeLine{00908\ \ \ \textcolor{comment}{//\ The\ offset\ permits\ to\ skip\ deflated\ entries\ while\ computing\ zhat}}
\DoxyCodeLine{00909\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ k\ =\ 0;\ k\ <\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}};\ ++k)}
\DoxyCodeLine{00910\ \ \ \{}
\DoxyCodeLine{00911\ \ \ \ \ \textcolor{keywordflow}{if}\ (col0(k)\ ==\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_aad17038f9628ce5ed6e1461a67cd3a03}{Literal}}(0))\ \textcolor{comment}{//\ deflated}}
\DoxyCodeLine{00912\ \ \ \ \ \ \ zhat(k)\ =\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_aad17038f9628ce5ed6e1461a67cd3a03}{Literal}}(0);}
\DoxyCodeLine{00913\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00914\ \ \ \ \ \{}
\DoxyCodeLine{00915\ \ \ \ \ \ \ \textcolor{comment}{//\ see\ equation\ (3.6)}}
\DoxyCodeLine{00916\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a1b429d828258ec58c1fc4ced6213d64d}{RealScalar}}\ dk\ =\ diag(k);}
\DoxyCodeLine{00917\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a1b429d828258ec58c1fc4ced6213d64d}{RealScalar}}\ \mbox{\hyperlink{namespace_eigen_a6dd0fb5de9a0e3196003928a28bb151b}{prod}}\ =\ (singVals(last)\ +\ dk)\ *\ (mus(last)\ +\ (shifts(last)\ -\/\ dk));}
\DoxyCodeLine{00918\ }
\DoxyCodeLine{00919\ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ l\ =\ 0;\ l<\mbox{\hyperlink{_angle_axis__mimic__euler_8cpp_ab3cd915d758008bd19d0f2428fbb354a}{m}};\ ++l)}
\DoxyCodeLine{00920\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00921\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ =\ perm(l);}
\DoxyCodeLine{00922\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}!=k)}
\DoxyCodeLine{00923\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00924\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}\ =\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}<k\ ?\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ :\ perm(l-\/1);}
\DoxyCodeLine{00925\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_eigen_a6dd0fb5de9a0e3196003928a28bb151b}{prod}}\ *=\ ((singVals(\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}})+dk)\ /\ ((diag(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})+dk)))\ *\ ((mus(\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}})+(shifts(\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}})-\/dk))\ /\ ((diag(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})-\/dk)));}
\DoxyCodeLine{00926\ \textcolor{preprocessor}{\#ifdef\ EIGEN\_BDCSVD\_DEBUG\_VERBOSE}}
\DoxyCodeLine{00927\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}!=k\ \&\&\ std::abs(((singVals(\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}})+dk)*(mus(\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}})+(shifts(\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}})-\/dk)))/((diag(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})+dk)*(diag(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})-\/dk))\ -\/\ 1)\ >\ 0.9\ )}
\DoxyCodeLine{00928\ \ \ \ \ \ \ \ \ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}\ \ \ \ \ "{}}\ <<\ ((singVals(\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}})+dk)*(mus(\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}})+(shifts(\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}})-\/dk)))/((diag(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})+dk)*(diag(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})-\/dk))\ <<\ \textcolor{stringliteral}{"{}\ ==\ ("{}}\ <<\ (singVals(\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}})+dk)\ <<\ \textcolor{stringliteral}{"{}\ *\ "{}}\ <<\ (mus(\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}})+(shifts(\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}})-\/dk))}
\DoxyCodeLine{00929\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{})\ /\ ("{}}\ <<\ (diag(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})+dk)\ <<\ \textcolor{stringliteral}{"{}\ *\ "{}}\ <<\ (diag(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})-\/dk)\ <<\ \textcolor{stringliteral}{"{})\(\backslash\)n"{}};}
\DoxyCodeLine{00930\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00931\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00932\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00933\ \textcolor{preprocessor}{\#ifdef\ EIGEN\_BDCSVD\_DEBUG\_VERBOSE}}
\DoxyCodeLine{00934\ \ \ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}zhat("{}}\ <<\ k\ <<\ \textcolor{stringliteral}{"{})\ =\ \ sqrt(\ "{}}\ <<\ \mbox{\hyperlink{namespace_eigen_a6dd0fb5de9a0e3196003928a28bb151b}{prod}}\ <<\ \textcolor{stringliteral}{"{})\ \ ;\ \ "{}}\ <<\ (singVals(last)\ +\ dk)\ <<\ \textcolor{stringliteral}{"{}\ *\ "{}}\ <<\ mus(last)\ +\ shifts(last)\ <<\ \textcolor{stringliteral}{"{}\ -\/\ "{}}\ <<\ dk\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00935\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00936\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a1b429d828258ec58c1fc4ced6213d64d}{RealScalar}}\ tmp\ =\ \mbox{\hyperlink{_array_cwise_unary_ops_8h_a656b9217a2fcb6de59dc8d1eb3079cc7}{sqrt}}(\mbox{\hyperlink{namespace_eigen_a6dd0fb5de9a0e3196003928a28bb151b}{prod}});}
\DoxyCodeLine{00937\ \ \ \ \ \ \ zhat(k)\ =\ col0(k)\ >\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_aad17038f9628ce5ed6e1461a67cd3a03}{Literal}}(0)\ ?\ tmp\ :\ -\/tmp;}
\DoxyCodeLine{00938\ \ \ \ \ \}}
\DoxyCodeLine{00939\ \ \ \}}
\DoxyCodeLine{00940\ \}}
\DoxyCodeLine{00941\ }
\DoxyCodeLine{00942\ \textcolor{comment}{//\ compute\ singular\ vectors}}
\DoxyCodeLine{00943\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ MatrixType>}
\DoxyCodeLine{00944\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a2e28be342355e1414d26cfd65325ba7f}{BDCSVD<MatrixType>::computeSingVecs}}}
\DoxyCodeLine{00945\ \ \ \ (\textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_ad30a7a883b86028c45559593c7a678a2}{ArrayRef}}\&\ zhat,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_ad30a7a883b86028c45559593c7a678a2}{ArrayRef}}\&\ diag,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_aab1c377c616062cc85356e47312cb412}{IndicesRef}}\ \&perm,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a0ea2c57bf088d5fc480ad81945157079}{VectorType}}\&\ singVals,}
\DoxyCodeLine{00946\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_ad30a7a883b86028c45559593c7a678a2}{ArrayRef}}\&\ shifts,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_ad30a7a883b86028c45559593c7a678a2}{ArrayRef}}\&\ mus,\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a7b32c2adca9f10283820f437f08f6271}{MatrixXr}}\&\ U,\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a7b32c2adca9f10283820f437f08f6271}{MatrixXr}}\&\ \mbox{\hyperlink{_eigen_solver___eigen_solver___matrix_type_8cpp_a77c224aa52b434918ce65c33175aa8ad}{V}})}
\DoxyCodeLine{00947\ \{}
\DoxyCodeLine{00948\ \ \ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}\ =\ zhat.size();}
\DoxyCodeLine{00949\ \ \ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ \mbox{\hyperlink{_angle_axis__mimic__euler_8cpp_ab3cd915d758008bd19d0f2428fbb354a}{m}}\ =\ perm.size();}
\DoxyCodeLine{00950\ \ \ }
\DoxyCodeLine{00951\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ k\ =\ 0;\ k\ <\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}};\ ++k)}
\DoxyCodeLine{00952\ \ \ \{}
\DoxyCodeLine{00953\ \ \ \ \ \textcolor{keywordflow}{if}\ (zhat(k)\ ==\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_aad17038f9628ce5ed6e1461a67cd3a03}{Literal}}(0))}
\DoxyCodeLine{00954\ \ \ \ \ \{}
\DoxyCodeLine{00955\ \ \ \ \ \ \ U.col(k)\ =\ VectorType::Unit(\mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}+1,\ k);}
\DoxyCodeLine{00956\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a707ea2d37a7024a6317f001a6971fbec}{m\_compV}})\ \mbox{\hyperlink{_eigen_solver___eigen_solver___matrix_type_8cpp_a77c224aa52b434918ce65c33175aa8ad}{V}}.col(k)\ =\ VectorType::Unit(\mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}},\ k);}
\DoxyCodeLine{00957\ \ \ \ \ \}}
\DoxyCodeLine{00958\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00959\ \ \ \ \ \{}
\DoxyCodeLine{00960\ \ \ \ \ \ \ U.col(k).\mbox{\hyperlink{class_eigen_1_1_plain_object_base_ac21ad5f989f320e46958b75ac8d9a1da}{setZero}}();}
\DoxyCodeLine{00961\ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ l=0;l<\mbox{\hyperlink{_angle_axis__mimic__euler_8cpp_ab3cd915d758008bd19d0f2428fbb354a}{m}};++l)}
\DoxyCodeLine{00962\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00963\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ =\ perm(l);}
\DoxyCodeLine{00964\ \ \ \ \ \ \ \ \ U(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}},k)\ =\ zhat(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})/(((diag(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ -\/\ shifts(k))\ -\/\ mus(k))\ )/(\ (diag(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ +\ singVals[k]));}
\DoxyCodeLine{00965\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00966\ \ \ \ \ \ \ U(\mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}},k)\ =\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_aad17038f9628ce5ed6e1461a67cd3a03}{Literal}}(0);}
\DoxyCodeLine{00967\ \ \ \ \ \ \ U.col(k).normalize();}
\DoxyCodeLine{00968\ \ \ \ \ }
\DoxyCodeLine{00969\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a707ea2d37a7024a6317f001a6971fbec}{m\_compV}})}
\DoxyCodeLine{00970\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00971\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_eigen_solver___eigen_solver___matrix_type_8cpp_a77c224aa52b434918ce65c33175aa8ad}{V}}.col(k).setZero();}
\DoxyCodeLine{00972\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ l=1;l<\mbox{\hyperlink{_angle_axis__mimic__euler_8cpp_ab3cd915d758008bd19d0f2428fbb354a}{m}};++l)}
\DoxyCodeLine{00973\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00974\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ =\ perm(l);}
\DoxyCodeLine{00975\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_eigen_solver___eigen_solver___matrix_type_8cpp_a77c224aa52b434918ce65c33175aa8ad}{V}}(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}},k)\ =\ diag(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ *\ zhat(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ /\ (((diag(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ -\/\ shifts(k))\ -\/\ mus(k))\ )/(\ (diag(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ +\ singVals[k]));}
\DoxyCodeLine{00976\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00977\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_eigen_solver___eigen_solver___matrix_type_8cpp_a77c224aa52b434918ce65c33175aa8ad}{V}}(0,k)\ =\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_aad17038f9628ce5ed6e1461a67cd3a03}{Literal}}(-\/1);}
\DoxyCodeLine{00978\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_eigen_solver___eigen_solver___matrix_type_8cpp_a77c224aa52b434918ce65c33175aa8ad}{V}}.col(k).normalize();}
\DoxyCodeLine{00979\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00980\ \ \ \ \ \}}
\DoxyCodeLine{00981\ \ \ \}}
\DoxyCodeLine{00982\ \ \ U.col(\mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}})\ =\ VectorType::Unit(\mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}+1,\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}});}
\DoxyCodeLine{00983\ \}}
\DoxyCodeLine{00984\ }
\DoxyCodeLine{00985\ }
\DoxyCodeLine{00986\ \textcolor{comment}{//\ page\ 12\_13}}
\DoxyCodeLine{00987\ \textcolor{comment}{//\ i\ >=\ 1,\ di\ almost\ null\ and\ zi\ non\ null.}}
\DoxyCodeLine{00988\ \textcolor{comment}{//\ We\ use\ a\ rotation\ to\ zero\ out\ zi\ applied\ to\ the\ left\ of\ M}}
\DoxyCodeLine{00989\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ MatrixType>}
\DoxyCodeLine{00990\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a7d8b1d486b13d72658b7ad44430e82e2}{BDCSVD<MatrixType>::deflation43}}(\mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ firstCol,\ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ shift,\ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}},\ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}})}
\DoxyCodeLine{00991\ \{}
\DoxyCodeLine{00992\ \ \ \textcolor{keyword}{using\ }std::abs;}
\DoxyCodeLine{00993\ \ \ \textcolor{keyword}{using\ }std::sqrt;}
\DoxyCodeLine{00994\ \ \ \textcolor{keyword}{using\ }std::pow;}
\DoxyCodeLine{00995\ \ \ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ \mbox{\hyperlink{cpq__pdes_8cpp_a455a4d1d80a69762a133ad026f1cba43}{start}}\ =\ firstCol\ +\ shift;}
\DoxyCodeLine{00996\ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a1b429d828258ec58c1fc4ced6213d64d}{RealScalar}}\ \mbox{\hyperlink{bench_vec_add_8cpp_a41689956983587b085f9da3e48f31d99}{c}}\ =\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a76dcaed5bc2dd1c37832805fa8fed943}{m\_computed}}(\mbox{\hyperlink{cpq__pdes_8cpp_a455a4d1d80a69762a133ad026f1cba43}{start}},\ \mbox{\hyperlink{cpq__pdes_8cpp_a455a4d1d80a69762a133ad026f1cba43}{start}});}
\DoxyCodeLine{00997\ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a1b429d828258ec58c1fc4ced6213d64d}{RealScalar}}\ \mbox{\hyperlink{main-override_8cpp_a1384e7608274313a9433fa573868557b}{s}}\ =\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a76dcaed5bc2dd1c37832805fa8fed943}{m\_computed}}(\mbox{\hyperlink{cpq__pdes_8cpp_a455a4d1d80a69762a133ad026f1cba43}{start}}+\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}},\ \mbox{\hyperlink{cpq__pdes_8cpp_a455a4d1d80a69762a133ad026f1cba43}{start}});}
\DoxyCodeLine{00998\ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a1b429d828258ec58c1fc4ced6213d64d}{RealScalar}}\ \mbox{\hyperlink{offscreen_8c_a4788d82c901b9367dd5c0daff8a7616b}{r}}\ =\ numext::hypot(\mbox{\hyperlink{bench_vec_add_8cpp_a41689956983587b085f9da3e48f31d99}{c}},\mbox{\hyperlink{main-override_8cpp_a1384e7608274313a9433fa573868557b}{s}});}
\DoxyCodeLine{00999\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{offscreen_8c_a4788d82c901b9367dd5c0daff8a7616b}{r}}\ ==\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_aad17038f9628ce5ed6e1461a67cd3a03}{Literal}}(0))}
\DoxyCodeLine{01000\ \ \ \{}
\DoxyCodeLine{01001\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a76dcaed5bc2dd1c37832805fa8fed943}{m\_computed}}(\mbox{\hyperlink{cpq__pdes_8cpp_a455a4d1d80a69762a133ad026f1cba43}{start}}+\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}},\ \mbox{\hyperlink{cpq__pdes_8cpp_a455a4d1d80a69762a133ad026f1cba43}{start}}+\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ =\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_aad17038f9628ce5ed6e1461a67cd3a03}{Literal}}(0);}
\DoxyCodeLine{01002\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{01003\ \ \ \}}
\DoxyCodeLine{01004\ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a76dcaed5bc2dd1c37832805fa8fed943}{m\_computed}}(\mbox{\hyperlink{cpq__pdes_8cpp_a455a4d1d80a69762a133ad026f1cba43}{start}},\mbox{\hyperlink{cpq__pdes_8cpp_a455a4d1d80a69762a133ad026f1cba43}{start}})\ =\ \mbox{\hyperlink{offscreen_8c_a4788d82c901b9367dd5c0daff8a7616b}{r}};\ \ }
\DoxyCodeLine{01005\ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a76dcaed5bc2dd1c37832805fa8fed943}{m\_computed}}(\mbox{\hyperlink{cpq__pdes_8cpp_a455a4d1d80a69762a133ad026f1cba43}{start}}+\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}},\ \mbox{\hyperlink{cpq__pdes_8cpp_a455a4d1d80a69762a133ad026f1cba43}{start}})\ =\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_aad17038f9628ce5ed6e1461a67cd3a03}{Literal}}(0);}
\DoxyCodeLine{01006\ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a76dcaed5bc2dd1c37832805fa8fed943}{m\_computed}}(\mbox{\hyperlink{cpq__pdes_8cpp_a455a4d1d80a69762a133ad026f1cba43}{start}}+\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}},\ \mbox{\hyperlink{cpq__pdes_8cpp_a455a4d1d80a69762a133ad026f1cba43}{start}}+\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ =\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_aad17038f9628ce5ed6e1461a67cd3a03}{Literal}}(0);}
\DoxyCodeLine{01007\ \ \ }
\DoxyCodeLine{01008\ \ \ \mbox{\hyperlink{class_eigen_1_1_jacobi_rotation}{JacobiRotation<RealScalar>}}\ \mbox{\hyperlink{_jacobi__make_jacobi_8cpp_a4804f9d1c212b9655934738d0ae395ab}{J}}(\mbox{\hyperlink{bench_vec_add_8cpp_a41689956983587b085f9da3e48f31d99}{c}}/\mbox{\hyperlink{offscreen_8c_a4788d82c901b9367dd5c0daff8a7616b}{r}},-\/\mbox{\hyperlink{main-override_8cpp_a1384e7608274313a9433fa573868557b}{s}}/\mbox{\hyperlink{offscreen_8c_a4788d82c901b9367dd5c0daff8a7616b}{r}});}
\DoxyCodeLine{01009\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a63dc95af59e08a68b11268e98feea7fa}{m\_compU}})\ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a857bb0e5f633e0600ea6861f14da8a1b}{m\_naiveU}}.middleRows(firstCol,\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}}+1).applyOnTheRight(firstCol,\ firstCol+\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}},\ \mbox{\hyperlink{_jacobi__make_jacobi_8cpp_a4804f9d1c212b9655934738d0ae395ab}{J}});}
\DoxyCodeLine{01010\ \ \ \textcolor{keywordflow}{else}\ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a857bb0e5f633e0600ea6861f14da8a1b}{m\_naiveU}}.applyOnTheRight(firstCol,\ firstCol+\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}},\ \mbox{\hyperlink{_jacobi__make_jacobi_8cpp_a4804f9d1c212b9655934738d0ae395ab}{J}});}
\DoxyCodeLine{01011\ \}\textcolor{comment}{//\ end\ deflation\ 43}}
\DoxyCodeLine{01012\ }
\DoxyCodeLine{01013\ }
\DoxyCodeLine{01014\ \textcolor{comment}{//\ page\ 13}}
\DoxyCodeLine{01015\ \textcolor{comment}{//\ i,j\ >=\ 1,\ i!=j\ and\ |di\ -\/\ dj|\ <\ epsilon\ *\ norm2(M)}}
\DoxyCodeLine{01016\ \textcolor{comment}{//\ We\ apply\ two\ rotations\ to\ have\ zj\ =\ 0;}}
\DoxyCodeLine{01017\ \textcolor{comment}{//\ TODO\ deflation44\ is\ still\ broken\ and\ not\ properly\ tested}}
\DoxyCodeLine{01018\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ MatrixType>}
\DoxyCodeLine{01019\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a2a3ab669d075f81714bafe4088ae6074}{BDCSVD<MatrixType>::deflation44}}(\mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ firstColu\ ,\ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ firstColm,\ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ firstRowW,\ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ firstColW,\ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}},\ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}},\ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}})}
\DoxyCodeLine{01020\ \{}
\DoxyCodeLine{01021\ \ \ \textcolor{keyword}{using\ }std::abs;}
\DoxyCodeLine{01022\ \ \ \textcolor{keyword}{using\ }std::sqrt;}
\DoxyCodeLine{01023\ \ \ \textcolor{keyword}{using\ }std::conj;}
\DoxyCodeLine{01024\ \ \ \textcolor{keyword}{using\ }std::pow;}
\DoxyCodeLine{01025\ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a1b429d828258ec58c1fc4ced6213d64d}{RealScalar}}\ \mbox{\hyperlink{bench_vec_add_8cpp_a41689956983587b085f9da3e48f31d99}{c}}\ =\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a76dcaed5bc2dd1c37832805fa8fed943}{m\_computed}}(firstColm+\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}},\ firstColm);}
\DoxyCodeLine{01026\ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a1b429d828258ec58c1fc4ced6213d64d}{RealScalar}}\ \mbox{\hyperlink{main-override_8cpp_a1384e7608274313a9433fa573868557b}{s}}\ =\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a76dcaed5bc2dd1c37832805fa8fed943}{m\_computed}}(firstColm+\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}},\ firstColm);}
\DoxyCodeLine{01027\ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a1b429d828258ec58c1fc4ced6213d64d}{RealScalar}}\ \mbox{\hyperlink{offscreen_8c_a4788d82c901b9367dd5c0daff8a7616b}{r}}\ =\ \mbox{\hyperlink{_array_cwise_unary_ops_8h_a656b9217a2fcb6de59dc8d1eb3079cc7}{sqrt}}(numext::abs2(\mbox{\hyperlink{bench_vec_add_8cpp_a41689956983587b085f9da3e48f31d99}{c}})\ +\ numext::abs2(\mbox{\hyperlink{main-override_8cpp_a1384e7608274313a9433fa573868557b}{s}}));}
\DoxyCodeLine{01028\ \textcolor{preprocessor}{\#ifdef\ \ EIGEN\_BDCSVD\_DEBUG\_VERBOSE}}
\DoxyCodeLine{01029\ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}deflation\ 4.4:\ "{}}\ <<\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ <<\ \textcolor{stringliteral}{"{},"{}}\ <<\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}\ <<\ \textcolor{stringliteral}{"{}\ -\/>\ "{}}\ <<\ \mbox{\hyperlink{bench_vec_add_8cpp_a41689956983587b085f9da3e48f31d99}{c}}\ <<\ \textcolor{stringliteral}{"{}\ "{}}\ <<\ \mbox{\hyperlink{main-override_8cpp_a1384e7608274313a9433fa573868557b}{s}}\ <<\ \textcolor{stringliteral}{"{}\ "{}}\ <<\ \mbox{\hyperlink{offscreen_8c_a4788d82c901b9367dd5c0daff8a7616b}{r}}\ <<\ \textcolor{stringliteral}{"{}\ ;\ "{}}}
\DoxyCodeLine{01030\ \ \ \ \ <<\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a76dcaed5bc2dd1c37832805fa8fed943}{m\_computed}}(firstColm\ +\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}-\/1,\ firstColm)\ \ <<\ \textcolor{stringliteral}{"{}\ "{}}}
\DoxyCodeLine{01031\ \ \ \ \ <<\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a76dcaed5bc2dd1c37832805fa8fed943}{m\_computed}}(firstColm\ +\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}},\ firstColm)\ \ <<\ \textcolor{stringliteral}{"{}\ "{}}}
\DoxyCodeLine{01032\ \ \ \ \ <<\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a76dcaed5bc2dd1c37832805fa8fed943}{m\_computed}}(firstColm\ +\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}+1,\ firstColm)\ <<\ \textcolor{stringliteral}{"{}\ "{}}}
\DoxyCodeLine{01033\ \ \ \ \ <<\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a76dcaed5bc2dd1c37832805fa8fed943}{m\_computed}}(firstColm\ +\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}+2,\ firstColm)\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{01034\ \ \ std::cout\ <<\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a76dcaed5bc2dd1c37832805fa8fed943}{m\_computed}}(firstColm\ +\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}-\/1,\ firstColm\ +\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}-\/1)\ \ <<\ \textcolor{stringliteral}{"{}\ "{}}}
\DoxyCodeLine{01035\ \ \ \ \ <<\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a76dcaed5bc2dd1c37832805fa8fed943}{m\_computed}}(firstColm\ +\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}},\ firstColm+\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ \ <<\ \textcolor{stringliteral}{"{}\ "{}}}
\DoxyCodeLine{01036\ \ \ \ \ <<\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a76dcaed5bc2dd1c37832805fa8fed943}{m\_computed}}(firstColm\ +\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}+1,\ firstColm+\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}+1)\ <<\ \textcolor{stringliteral}{"{}\ "{}}}
\DoxyCodeLine{01037\ \ \ \ \ <<\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a76dcaed5bc2dd1c37832805fa8fed943}{m\_computed}}(firstColm\ +\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}+2,\ firstColm+\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}+2)\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{01038\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01039\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{offscreen_8c_a4788d82c901b9367dd5c0daff8a7616b}{r}}==\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_aad17038f9628ce5ed6e1461a67cd3a03}{Literal}}(0))}
\DoxyCodeLine{01040\ \ \ \{}
\DoxyCodeLine{01041\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a76dcaed5bc2dd1c37832805fa8fed943}{m\_computed}}(firstColm\ +\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}},\ firstColm\ +\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ =\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a76dcaed5bc2dd1c37832805fa8fed943}{m\_computed}}(firstColm\ +\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}},\ firstColm\ +\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}});}
\DoxyCodeLine{01042\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{01043\ \ \ \}}
\DoxyCodeLine{01044\ \ \ \mbox{\hyperlink{bench_vec_add_8cpp_a41689956983587b085f9da3e48f31d99}{c}}/=\mbox{\hyperlink{offscreen_8c_a4788d82c901b9367dd5c0daff8a7616b}{r}};}
\DoxyCodeLine{01045\ \ \ \mbox{\hyperlink{main-override_8cpp_a1384e7608274313a9433fa573868557b}{s}}/=\mbox{\hyperlink{offscreen_8c_a4788d82c901b9367dd5c0daff8a7616b}{r}};}
\DoxyCodeLine{01046\ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a76dcaed5bc2dd1c37832805fa8fed943}{m\_computed}}(firstColm\ +\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}},\ firstColm)\ =\ \mbox{\hyperlink{offscreen_8c_a4788d82c901b9367dd5c0daff8a7616b}{r}};\ \ }
\DoxyCodeLine{01047\ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a76dcaed5bc2dd1c37832805fa8fed943}{m\_computed}}(firstColm\ +\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}},\ firstColm\ +\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}})\ =\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a76dcaed5bc2dd1c37832805fa8fed943}{m\_computed}}(firstColm\ +\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}},\ firstColm\ +\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}});}
\DoxyCodeLine{01048\ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a76dcaed5bc2dd1c37832805fa8fed943}{m\_computed}}(firstColm\ +\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}},\ firstColm)\ =\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_aad17038f9628ce5ed6e1461a67cd3a03}{Literal}}(0);}
\DoxyCodeLine{01049\ }
\DoxyCodeLine{01050\ \ \ \mbox{\hyperlink{class_eigen_1_1_jacobi_rotation}{JacobiRotation<RealScalar>}}\ \mbox{\hyperlink{_jacobi__make_jacobi_8cpp_a4804f9d1c212b9655934738d0ae395ab}{J}}(\mbox{\hyperlink{bench_vec_add_8cpp_a41689956983587b085f9da3e48f31d99}{c}},-\/\mbox{\hyperlink{main-override_8cpp_a1384e7608274313a9433fa573868557b}{s}});}
\DoxyCodeLine{01051\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a63dc95af59e08a68b11268e98feea7fa}{m\_compU}})\ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a857bb0e5f633e0600ea6861f14da8a1b}{m\_naiveU}}.middleRows(firstColu,\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}}+1).applyOnTheRight(firstColu\ +\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}},\ firstColu\ +\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}},\ \mbox{\hyperlink{_jacobi__make_jacobi_8cpp_a4804f9d1c212b9655934738d0ae395ab}{J}});}
\DoxyCodeLine{01052\ \ \ \textcolor{keywordflow}{else}\ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a857bb0e5f633e0600ea6861f14da8a1b}{m\_naiveU}}.applyOnTheRight(firstColu+\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}},\ firstColu+\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}},\ \mbox{\hyperlink{_jacobi__make_jacobi_8cpp_a4804f9d1c212b9655934738d0ae395ab}{J}});}
\DoxyCodeLine{01053\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a707ea2d37a7024a6317f001a6971fbec}{m\_compV}})\ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a94b71ee8ecf0b6b621a1267cf136adc9}{m\_naiveV}}.middleRows(firstRowW,\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}}).applyOnTheRight(firstColW\ +\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}},\ firstColW\ +\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}},\ \mbox{\hyperlink{_jacobi__make_jacobi_8cpp_a4804f9d1c212b9655934738d0ae395ab}{J}});}
\DoxyCodeLine{01054\ \}\textcolor{comment}{//\ end\ deflation\ 44}}
\DoxyCodeLine{01055\ }
\DoxyCodeLine{01056\ }
\DoxyCodeLine{01057\ \textcolor{comment}{//\ acts\ on\ block\ from\ (firstCol+shift,\ firstCol+shift)\ to\ (lastCol+shift,\ lastCol+shift)\ [inclusive]}}
\DoxyCodeLine{01058\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ MatrixType>}
\DoxyCodeLine{01059\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_abf371e539b921d6f4821bf8e87f7ef32}{BDCSVD<MatrixType>::deflation}}(\mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ firstCol,\ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ lastCol,\ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ k,\ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ firstRowW,\ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ firstColW,\ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ shift)}
\DoxyCodeLine{01060\ \{}
\DoxyCodeLine{01061\ \ \ \textcolor{keyword}{using\ }std::sqrt;}
\DoxyCodeLine{01062\ \ \ \textcolor{keyword}{using\ }std::abs;}
\DoxyCodeLine{01063\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a8d1f7eae43fb4349a6a6f3f0c7eb7e0b}{length}}\ =\ lastCol\ +\ 1\ -\/\ firstCol;}
\DoxyCodeLine{01064\ \ \ }
\DoxyCodeLine{01065\ \ \ \mbox{\hyperlink{class_eigen_1_1_block}{Block<MatrixXr,Dynamic,1>}}\ col0(\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a76dcaed5bc2dd1c37832805fa8fed943}{m\_computed}},\ firstCol+shift,\ firstCol+shift,\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a8d1f7eae43fb4349a6a6f3f0c7eb7e0b}{length}},\ 1);}
\DoxyCodeLine{01066\ \ \ \mbox{\hyperlink{class_eigen_1_1_diagonal}{Diagonal<MatrixXr>}}\ fulldiag(\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a76dcaed5bc2dd1c37832805fa8fed943}{m\_computed}});}
\DoxyCodeLine{01067\ \ \ \mbox{\hyperlink{class_eigen_1_1_vector_block}{VectorBlock<Diagonal<MatrixXr>}},\mbox{\hyperlink{namespace_eigen_ad81fa7195215a0ce30017dfac309f0b2}{Dynamic}}>\ diag(fulldiag,\ firstCol+shift,\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a8d1f7eae43fb4349a6a6f3f0c7eb7e0b}{length}});}
\DoxyCodeLine{01068\ \ \ }
\DoxyCodeLine{01069\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a1b429d828258ec58c1fc4ced6213d64d}{RealScalar}}\ considerZero\ =\ (std::numeric\_limits<RealScalar>::min)();}
\DoxyCodeLine{01070\ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a1b429d828258ec58c1fc4ced6213d64d}{RealScalar}}\ maxDiag\ =\ diag.tail((std::max)(\mbox{\hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}(1),\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a8d1f7eae43fb4349a6a6f3f0c7eb7e0b}{length}}-\/1)).cwiseAbs().maxCoeff();}
\DoxyCodeLine{01071\ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a1b429d828258ec58c1fc4ced6213d64d}{RealScalar}}\ epsilon\_strict\ =\ \mbox{\hyperlink{namespace_eigen_1_1numext_a29d502349f2ec9897c808e65e0f96eb4}{numext::maxi<RealScalar>}}(considerZero,\mbox{\hyperlink{struct_eigen_1_1_generic_num_traits_aadcf7fa75b2bc9a0e461a3b851d836a7}{NumTraits<RealScalar>::epsilon}}()\ *\ maxDiag);}
\DoxyCodeLine{01072\ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a1b429d828258ec58c1fc4ced6213d64d}{RealScalar}}\ epsilon\_coarse\ =\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_aad17038f9628ce5ed6e1461a67cd3a03}{Literal}}(8)\ *\ \mbox{\hyperlink{struct_eigen_1_1_generic_num_traits_aadcf7fa75b2bc9a0e461a3b851d836a7}{NumTraits<RealScalar>::epsilon}}()\ *\ \mbox{\hyperlink{namespace_eigen_1_1numext_a29d502349f2ec9897c808e65e0f96eb4}{numext::maxi<RealScalar>}}(col0.cwiseAbs().maxCoeff(),\ maxDiag);}
\DoxyCodeLine{01073\ \ \ }
\DoxyCodeLine{01074\ \textcolor{preprocessor}{\#ifdef\ EIGEN\_BDCSVD\_SANITY\_CHECKS}}
\DoxyCodeLine{01075\ \ \ assert(\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a857bb0e5f633e0600ea6861f14da8a1b}{m\_naiveU}}.allFinite());}
\DoxyCodeLine{01076\ \ \ assert(\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a94b71ee8ecf0b6b621a1267cf136adc9}{m\_naiveV}}.allFinite());}
\DoxyCodeLine{01077\ \ \ assert(\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a76dcaed5bc2dd1c37832805fa8fed943}{m\_computed}}.allFinite());}
\DoxyCodeLine{01078\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01079\ }
\DoxyCodeLine{01080\ \textcolor{preprocessor}{\#ifdef\ \ EIGEN\_BDCSVD\_DEBUG\_VERBOSE\ \ }}
\DoxyCodeLine{01081\ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)ndeflate:"{}}\ <<\ diag.head(k+1).transpose()\ <<\ \textcolor{stringliteral}{"{}\ \ |\ \ "{}}\ <<\ diag.segment(k+1,\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a8d1f7eae43fb4349a6a6f3f0c7eb7e0b}{length}}-\/k-\/1).transpose()\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{01082\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01083\ \ \ }
\DoxyCodeLine{01084\ \ \ \textcolor{comment}{//condition\ 4.1}}
\DoxyCodeLine{01085\ \ \ \textcolor{keywordflow}{if}\ (diag(0)\ <\ epsilon\_coarse)}
\DoxyCodeLine{01086\ \ \ \{\ }
\DoxyCodeLine{01087\ \textcolor{preprocessor}{\#ifdef\ \ EIGEN\_BDCSVD\_DEBUG\_VERBOSE}}
\DoxyCodeLine{01088\ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}deflation\ 4.1,\ because\ "{}}\ <<\ diag(0)\ <<\ \textcolor{stringliteral}{"{}\ <\ "{}}\ <<\ epsilon\_coarse\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{01089\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01090\ \ \ \ \ diag(0)\ =\ epsilon\_coarse;}
\DoxyCodeLine{01091\ \ \ \}}
\DoxyCodeLine{01092\ }
\DoxyCodeLine{01093\ \ \ \textcolor{comment}{//condition\ 4.2}}
\DoxyCodeLine{01094\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}=1;\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}<\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a8d1f7eae43fb4349a6a6f3f0c7eb7e0b}{length}};++\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})}
\DoxyCodeLine{01095\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{datatypes_8h_a3aa069ac3980707dae1e0530f50d59e4}{abs}}(col0(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}))\ <\ epsilon\_strict)}
\DoxyCodeLine{01096\ \ \ \ \ \{}
\DoxyCodeLine{01097\ \textcolor{preprocessor}{\#ifdef\ \ EIGEN\_BDCSVD\_DEBUG\_VERBOSE}}
\DoxyCodeLine{01098\ \ \ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}deflation\ 4.2,\ set\ z("{}}\ <<\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ <<\ \textcolor{stringliteral}{"{})\ to\ zero\ because\ "{}}\ <<\ \mbox{\hyperlink{datatypes_8h_a3aa069ac3980707dae1e0530f50d59e4}{abs}}(col0(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}))\ <<\ \textcolor{stringliteral}{"{}\ <\ "{}}\ <<\ epsilon\_strict\ <<\ \textcolor{stringliteral}{"{}\ \ (diag("{}}\ <<\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ <<\ \textcolor{stringliteral}{"{})="{}}\ <<\ diag(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ <<\ \textcolor{stringliteral}{"{})\(\backslash\)n"{}};}
\DoxyCodeLine{01099\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01100\ \ \ \ \ \ \ col0(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ =\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_aad17038f9628ce5ed6e1461a67cd3a03}{Literal}}(0);}
\DoxyCodeLine{01101\ \ \ \ \ \}}
\DoxyCodeLine{01102\ }
\DoxyCodeLine{01103\ \ \ \textcolor{comment}{//condition\ 4.3}}
\DoxyCodeLine{01104\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}=1;\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}<\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a8d1f7eae43fb4349a6a6f3f0c7eb7e0b}{length}};\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}++)}
\DoxyCodeLine{01105\ \ \ \ \ \textcolor{keywordflow}{if}\ (diag(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ <\ epsilon\_coarse)}
\DoxyCodeLine{01106\ \ \ \ \ \{}
\DoxyCodeLine{01107\ \textcolor{preprocessor}{\#ifdef\ \ EIGEN\_BDCSVD\_DEBUG\_VERBOSE}}
\DoxyCodeLine{01108\ \ \ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}deflation\ 4.3,\ cancel\ z("{}}\ <<\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ <<\ \textcolor{stringliteral}{"{})="{}}\ <<\ col0(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ <<\ \textcolor{stringliteral}{"{}\ because\ diag("{}}\ <<\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ <<\ \textcolor{stringliteral}{"{})="{}}\ <<\ diag(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ <<\ \textcolor{stringliteral}{"{}\ <\ "{}}\ <<\ epsilon\_coarse\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{01109\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01110\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a7d8b1d486b13d72658b7ad44430e82e2}{deflation43}}(firstCol,\ shift,\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}},\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a8d1f7eae43fb4349a6a6f3f0c7eb7e0b}{length}});}
\DoxyCodeLine{01111\ \ \ \ \ \}}
\DoxyCodeLine{01112\ }
\DoxyCodeLine{01113\ \textcolor{preprocessor}{\#ifdef\ EIGEN\_BDCSVD\_SANITY\_CHECKS}}
\DoxyCodeLine{01114\ \ \ assert(\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a857bb0e5f633e0600ea6861f14da8a1b}{m\_naiveU}}.allFinite());}
\DoxyCodeLine{01115\ \ \ assert(\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a94b71ee8ecf0b6b621a1267cf136adc9}{m\_naiveV}}.allFinite());}
\DoxyCodeLine{01116\ \ \ assert(\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a76dcaed5bc2dd1c37832805fa8fed943}{m\_computed}}.allFinite());}
\DoxyCodeLine{01117\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01118\ \textcolor{preprocessor}{\#ifdef\ EIGEN\_BDCSVD\_DEBUG\_VERBOSE}}
\DoxyCodeLine{01119\ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}to\ be\ sorted:\ "{}}\ <<\ diag.transpose()\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n\(\backslash\)n"{}};}
\DoxyCodeLine{01120\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01121\ \ \ \{}
\DoxyCodeLine{01122\ \ \ \ \ \textcolor{comment}{//\ Check\ for\ total\ deflation}}
\DoxyCodeLine{01123\ \ \ \ \ \textcolor{comment}{//\ If\ we\ have\ a\ total\ deflation,\ then\ we\ have\ to\ consider\ col0(0)==diag(0)\ as\ a\ singular\ value\ during\ sorting}}
\DoxyCodeLine{01124\ \ \ \ \ \textcolor{keywordtype}{bool}\ total\_deflation\ =\ (col0.tail(\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a8d1f7eae43fb4349a6a6f3f0c7eb7e0b}{length}}-\/1).\mbox{\hyperlink{sugar_8h_af6228a2253f88b2affbe0c54d8b5b321}{array}}()<considerZero).all();}
\DoxyCodeLine{01125\ \ \ \ \ }
\DoxyCodeLine{01126\ \ \ \ \ \textcolor{comment}{//\ Sort\ the\ diagonal\ entries,\ since\ diag(1:k-\/1)\ and\ diag(k:length)\ are\ already\ sorted,\ let's\ do\ a\ sorted\ merge.}}
\DoxyCodeLine{01127\ \ \ \ \ \textcolor{comment}{//\ First,\ compute\ the\ respective\ permutation.}}
\DoxyCodeLine{01128\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ *permutation\ =\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a8bfc4be4bdc669038298ea29b940532f}{m\_workspaceI}}.data();}
\DoxyCodeLine{01129\ \ \ \ \ \{}
\DoxyCodeLine{01130\ \ \ \ \ \ \ permutation[0]\ =\ 0;}
\DoxyCodeLine{01131\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ \mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}}\ =\ 1;}
\DoxyCodeLine{01132\ \ \ \ \ \ \ }
\DoxyCodeLine{01133\ \ \ \ \ \ \ \textcolor{comment}{//\ Move\ deflated\ diagonal\ entries\ at\ the\ end.}}
\DoxyCodeLine{01134\ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}=1;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}<\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a8d1f7eae43fb4349a6a6f3f0c7eb7e0b}{length}};\ ++\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})}
\DoxyCodeLine{01135\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{datatypes_8h_a3aa069ac3980707dae1e0530f50d59e4}{abs}}(diag(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}))<considerZero)}
\DoxyCodeLine{01136\ \ \ \ \ \ \ \ \ \ \ permutation[\mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}}++]\ =\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}};}
\DoxyCodeLine{01137\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{01138\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}=1,\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}=k+1;}
\DoxyCodeLine{01139\ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\ ;\ \mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}}\ <\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a8d1f7eae43fb4349a6a6f3f0c7eb7e0b}{length}};\ ++\mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}})}
\DoxyCodeLine{01140\ \ \ \ \ \ \ \{}
\DoxyCodeLine{01141\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ >\ k)\ \ \ \ \ \ \ \ \ \ \ \ \ permutation[\mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}}]\ =\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}++;}
\DoxyCodeLine{01142\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}\ >=\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a8d1f7eae43fb4349a6a6f3f0c7eb7e0b}{length}})\ \ \ \ \ \ \ permutation[\mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}}]\ =\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}++;}
\DoxyCodeLine{01143\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (diag(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ <\ diag(\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}))\ permutation[\mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}}]\ =\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}++;}
\DoxyCodeLine{01144\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ permutation[\mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}}]\ =\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}++;}
\DoxyCodeLine{01145\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01146\ \ \ \ \ \}}
\DoxyCodeLine{01147\ \ \ \ \ }
\DoxyCodeLine{01148\ \ \ \ \ \textcolor{comment}{//\ If\ we\ have\ a\ total\ deflation,\ then\ we\ have\ to\ insert\ diag(0)\ at\ the\ right\ place}}
\DoxyCodeLine{01149\ \ \ \ \ \textcolor{keywordflow}{if}(total\_deflation)}
\DoxyCodeLine{01150\ \ \ \ \ \{}
\DoxyCodeLine{01151\ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}=1;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}<\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a8d1f7eae43fb4349a6a6f3f0c7eb7e0b}{length}};\ ++\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})}
\DoxyCodeLine{01152\ \ \ \ \ \ \ \{}
\DoxyCodeLine{01153\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ pi\ =\ permutation[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}];}
\DoxyCodeLine{01154\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{datatypes_8h_a3aa069ac3980707dae1e0530f50d59e4}{abs}}(diag(pi))<considerZero\ ||\ diag(0)<diag(pi))}
\DoxyCodeLine{01155\ \ \ \ \ \ \ \ \ \ \ permutation[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}-\/1]\ =\ permutation[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}];}
\DoxyCodeLine{01156\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{01157\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01158\ \ \ \ \ \ \ \ \ \ \ permutation[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}-\/1]\ =\ 0;}
\DoxyCodeLine{01159\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01160\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01161\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01162\ \ \ \ \ \}}
\DoxyCodeLine{01163\ \ \ \ \ }
\DoxyCodeLine{01164\ \ \ \ \ \textcolor{comment}{//\ Current\ index\ of\ each\ col,\ and\ current\ column\ of\ each\ index}}
\DoxyCodeLine{01165\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ *realInd\ =\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a8bfc4be4bdc669038298ea29b940532f}{m\_workspaceI}}.data()+\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a8d1f7eae43fb4349a6a6f3f0c7eb7e0b}{length}};}
\DoxyCodeLine{01166\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ *realCol\ =\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a8bfc4be4bdc669038298ea29b940532f}{m\_workspaceI}}.data()+2*\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a8d1f7eae43fb4349a6a6f3f0c7eb7e0b}{length}};}
\DoxyCodeLine{01167\ \ \ \ \ }
\DoxyCodeLine{01168\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ pos\ =\ 0;\ pos<\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a8d1f7eae43fb4349a6a6f3f0c7eb7e0b}{length}};\ pos++)}
\DoxyCodeLine{01169\ \ \ \ \ \{}
\DoxyCodeLine{01170\ \ \ \ \ \ \ realCol[pos]\ =\ pos;}
\DoxyCodeLine{01171\ \ \ \ \ \ \ realInd[pos]\ =\ pos;}
\DoxyCodeLine{01172\ \ \ \ \ \}}
\DoxyCodeLine{01173\ \ \ \ \ }
\DoxyCodeLine{01174\ \ \ \ \ \textcolor{keywordflow}{for}(\mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ =\ total\_deflation?0:1;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ <\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a8d1f7eae43fb4349a6a6f3f0c7eb7e0b}{length}};\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}++)}
\DoxyCodeLine{01175\ \ \ \ \ \{}
\DoxyCodeLine{01176\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ pi\ =\ permutation[\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a8d1f7eae43fb4349a6a6f3f0c7eb7e0b}{length}}\ -\/\ (total\_deflation\ ?\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}+1\ :\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})];}
\DoxyCodeLine{01177\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ \mbox{\hyperlink{_jacobi__make_jacobi_8cpp_a4804f9d1c212b9655934738d0ae395ab}{J}}\ =\ realCol[pi];}
\DoxyCodeLine{01178\ \ \ \ \ \ \ }
\DoxyCodeLine{01179\ \ \ \ \ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{namespacestd_a3acbe51b6415e9284430194bf04944e1}{std::swap}};}
\DoxyCodeLine{01180\ \ \ \ \ \ \ \textcolor{comment}{//\ swap\ diagonal\ and\ first\ column\ entries:}}
\DoxyCodeLine{01181\ \ \ \ \ \ \ \mbox{\hyperlink{level1__impl_8h_a2e2212d2e55ad7479d212e08b2eb0345}{swap}}(diag(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}),\ diag(\mbox{\hyperlink{_jacobi__make_jacobi_8cpp_a4804f9d1c212b9655934738d0ae395ab}{J}}));}
\DoxyCodeLine{01182\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}!=0\ \&\&\ \mbox{\hyperlink{_jacobi__make_jacobi_8cpp_a4804f9d1c212b9655934738d0ae395ab}{J}}!=0)\ \mbox{\hyperlink{level1__impl_8h_a2e2212d2e55ad7479d212e08b2eb0345}{swap}}(col0(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}),\ col0(\mbox{\hyperlink{_jacobi__make_jacobi_8cpp_a4804f9d1c212b9655934738d0ae395ab}{J}}));}
\DoxyCodeLine{01183\ }
\DoxyCodeLine{01184\ \ \ \ \ \ \ \textcolor{comment}{//\ change\ columns}}
\DoxyCodeLine{01185\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a63dc95af59e08a68b11268e98feea7fa}{m\_compU}})\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a857bb0e5f633e0600ea6861f14da8a1b}{m\_naiveU}}.col(firstCol+\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}).segment(firstCol,\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a8d1f7eae43fb4349a6a6f3f0c7eb7e0b}{length}}\ +\ 1).swap(\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a857bb0e5f633e0600ea6861f14da8a1b}{m\_naiveU}}.col(firstCol+\mbox{\hyperlink{_jacobi__make_jacobi_8cpp_a4804f9d1c212b9655934738d0ae395ab}{J}}).segment(firstCol,\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a8d1f7eae43fb4349a6a6f3f0c7eb7e0b}{length}}\ +\ 1));}
\DoxyCodeLine{01186\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a857bb0e5f633e0600ea6861f14da8a1b}{m\_naiveU}}.col(firstCol+\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}).segment(0,\ 2)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ .swap(\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a857bb0e5f633e0600ea6861f14da8a1b}{m\_naiveU}}.col(firstCol+\mbox{\hyperlink{_jacobi__make_jacobi_8cpp_a4804f9d1c212b9655934738d0ae395ab}{J}}).segment(0,\ 2));}
\DoxyCodeLine{01187\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a707ea2d37a7024a6317f001a6971fbec}{m\_compV}})\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a94b71ee8ecf0b6b621a1267cf136adc9}{m\_naiveV}}.col(firstColW\ +\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}).segment(firstRowW,\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a8d1f7eae43fb4349a6a6f3f0c7eb7e0b}{length}}).swap(\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a94b71ee8ecf0b6b621a1267cf136adc9}{m\_naiveV}}.col(firstColW\ +\ \mbox{\hyperlink{_jacobi__make_jacobi_8cpp_a4804f9d1c212b9655934738d0ae395ab}{J}}).segment(firstRowW,\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a8d1f7eae43fb4349a6a6f3f0c7eb7e0b}{length}}));}
\DoxyCodeLine{01188\ }
\DoxyCodeLine{01189\ \ \ \ \ \ \ \textcolor{comment}{//update\ real\ pos}}
\DoxyCodeLine{01190\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ realI\ =\ realInd[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}];}
\DoxyCodeLine{01191\ \ \ \ \ \ \ realCol[realI]\ =\ \mbox{\hyperlink{_jacobi__make_jacobi_8cpp_a4804f9d1c212b9655934738d0ae395ab}{J}};}
\DoxyCodeLine{01192\ \ \ \ \ \ \ realCol[pi]\ =\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}};}
\DoxyCodeLine{01193\ \ \ \ \ \ \ realInd[\mbox{\hyperlink{_jacobi__make_jacobi_8cpp_a4804f9d1c212b9655934738d0ae395ab}{J}}]\ =\ realI;}
\DoxyCodeLine{01194\ \ \ \ \ \ \ realInd[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}]\ =\ pi;}
\DoxyCodeLine{01195\ \ \ \ \ \}}
\DoxyCodeLine{01196\ \ \ \}}
\DoxyCodeLine{01197\ \textcolor{preprocessor}{\#ifdef\ EIGEN\_BDCSVD\_DEBUG\_VERBOSE}}
\DoxyCodeLine{01198\ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}sorted:\ "{}}\ <<\ diag.transpose().format(bdcsvdfmt)\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{01199\ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}\ \ \ \ \ \ :\ "{}}\ <<\ col0.transpose()\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n\(\backslash\)n"{}};}
\DoxyCodeLine{01200\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01201\ \ \ \ \ }
\DoxyCodeLine{01202\ \ \ \textcolor{comment}{//condition\ 4.4}}
\DoxyCodeLine{01203\ \ \ \{}
\DoxyCodeLine{01204\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ =\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a8d1f7eae43fb4349a6a6f3f0c7eb7e0b}{length}}-\/1;}
\DoxyCodeLine{01205\ \ \ \ \ \textcolor{keywordflow}{while}(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}>0\ \&\&\ (\mbox{\hyperlink{datatypes_8h_a3aa069ac3980707dae1e0530f50d59e4}{abs}}(diag(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}))<considerZero\ ||\ \mbox{\hyperlink{datatypes_8h_a3aa069ac3980707dae1e0530f50d59e4}{abs}}(col0(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}))<considerZero))\ -\/-\/\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}};}
\DoxyCodeLine{01206\ \ \ \ \ \textcolor{keywordflow}{for}(;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}>1;-\/-\/\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})}
\DoxyCodeLine{01207\ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ (diag(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ -\/\ diag(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}-\/1))\ <\ \mbox{\hyperlink{struct_eigen_1_1_generic_num_traits_aadcf7fa75b2bc9a0e461a3b851d836a7}{NumTraits<RealScalar>::epsilon}}()*maxDiag\ )}
\DoxyCodeLine{01208\ \ \ \ \ \ \ \{}
\DoxyCodeLine{01209\ \textcolor{preprocessor}{\#ifdef\ EIGEN\_BDCSVD\_DEBUG\_VERBOSE}}
\DoxyCodeLine{01210\ \ \ \ \ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}deflation\ 4.4\ with\ i\ =\ "{}}\ <<\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ <<\ \textcolor{stringliteral}{"{}\ because\ "{}}\ <<\ (diag(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ -\/\ diag(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}-\/1))\ <<\ \textcolor{stringliteral}{"{}\ <\ "{}}\ <<\ \mbox{\hyperlink{struct_eigen_1_1_generic_num_traits_aadcf7fa75b2bc9a0e461a3b851d836a7}{NumTraits<RealScalar>::epsilon}}()*diag(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{01211\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01212\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{eigen-3_83_87_2_eigen_2src_2_core_2util_2_macros_8h_a4e742b5a08636a61784c0e173b61e710}{eigen\_internal\_assert}}(\mbox{\hyperlink{datatypes_8h_a3aa069ac3980707dae1e0530f50d59e4}{abs}}(diag(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ -\/\ diag(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}-\/1))<epsilon\_coarse\ \&\&\ \textcolor{stringliteral}{"{}\ diagonal\ entries\ are\ not\ properly\ sorted"{}});}
\DoxyCodeLine{01213\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a2a3ab669d075f81714bafe4088ae6074}{deflation44}}(firstCol,\ firstCol\ +\ shift,\ firstRowW,\ firstColW,\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}-\/1,\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}},\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a8d1f7eae43fb4349a6a6f3f0c7eb7e0b}{length}});}
\DoxyCodeLine{01214\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01215\ \ \ \}}
\DoxyCodeLine{01216\ \ \ }
\DoxyCodeLine{01217\ \textcolor{preprocessor}{\#ifdef\ EIGEN\_BDCSVD\_SANITY\_CHECKS}}
\DoxyCodeLine{01218\ \ \ \textcolor{keywordflow}{for}(\mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a6229a37997eca1072b52cca5ee7a2bec}{Index}}\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}=2;\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}<\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a8d1f7eae43fb4349a6a6f3f0c7eb7e0b}{length}};++\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}})}
\DoxyCodeLine{01219\ \ \ \ \ assert(diag(\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}-\/1)<=diag(\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}})\ ||\ \mbox{\hyperlink{datatypes_8h_a3aa069ac3980707dae1e0530f50d59e4}{abs}}(diag(\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}))<considerZero);}
\DoxyCodeLine{01220\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01221\ \ \ }
\DoxyCodeLine{01222\ \textcolor{preprocessor}{\#ifdef\ EIGEN\_BDCSVD\_SANITY\_CHECKS}}
\DoxyCodeLine{01223\ \ \ assert(\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a857bb0e5f633e0600ea6861f14da8a1b}{m\_naiveU}}.allFinite());}
\DoxyCodeLine{01224\ \ \ assert(\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a94b71ee8ecf0b6b621a1267cf136adc9}{m\_naiveV}}.allFinite());}
\DoxyCodeLine{01225\ \ \ assert(\mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d_a76dcaed5bc2dd1c37832805fa8fed943}{m\_computed}}.allFinite());}
\DoxyCodeLine{01226\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01227\ \}\textcolor{comment}{//end\ deflation}}
\DoxyCodeLine{01228\ }
\DoxyCodeLine{01229\ \textcolor{preprocessor}{\#ifndef\ \_\_CUDACC\_\_}\textcolor{preprocessor}{}}
\DoxyCodeLine{01236\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ Derived>}
\DoxyCodeLine{01237\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d}{BDCSVD<typename\ MatrixBase<Derived>::PlainObject}}>}
\DoxyCodeLine{01238\ \mbox{\hyperlink{class_eigen_1_1_matrix_base_ae171b74b5d530846ee0836135ffcf837}{MatrixBase<Derived>::bdcSvd}}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ computationOptions)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01239\ \textcolor{keyword}{}\{}
\DoxyCodeLine{01240\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{class_eigen_1_1_b_d_c_s_v_d}{BDCSVD<PlainObject>}}(*\textcolor{keyword}{this},\ computationOptions);}
\DoxyCodeLine{01241\ \}}
\DoxyCodeLine{01242\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01243\ }
\DoxyCodeLine{01244\ \}\ \textcolor{comment}{//\ end\ namespace\ Eigen}}
\DoxyCodeLine{01245\ }
\DoxyCodeLine{01246\ \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
