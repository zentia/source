\doxysection{runtime.\+hpp}
\hypertarget{runtime_8hpp_source}{}\label{runtime_8hpp_source}\index{external/taskflow/taskflow/core/runtime.hpp@{external/taskflow/taskflow/core/runtime.hpp}}
\mbox{\hyperlink{runtime_8hpp}{浏览该文件的文档.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00002\ }
\DoxyCodeLine{00003\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{executor_8hpp}{executor.hpp}}"{}}}
\DoxyCodeLine{00004\ }
\DoxyCodeLine{00005\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespacetf}{tf}}\ \{}
\DoxyCodeLine{00006\ }
\DoxyCodeLine{00035\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classtf_1_1_runtime_abe76e072e64f5d1b1fe09c7e7c22777e}{Runtime}}\ \{}
\DoxyCodeLine{00036\ }
\DoxyCodeLine{00037\ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classtf_1_1_runtime_a763b2f90bc53f92d680a635fe28e858e}{Executor}};}
\DoxyCodeLine{00038\ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classtf_1_1_runtime_a61184f9bd9c801d0a5eccecfdbddc641}{FlowBuilder}};}
\DoxyCodeLine{00039\ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classtf_1_1_runtime_adb56fdbfd3879bf32dbc9b766e797b55}{PreemptionGuard}};}
\DoxyCodeLine{00040\ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classtf_1_1_runtime_ab016b9124e80f55ad92e01579c060f08}{Algorithm}};}
\DoxyCodeLine{00041\ \ \ }
\DoxyCodeLine{00042\ \textcolor{preprocessor}{\ \ \#define\ TF\_RUNTIME\_CHECK\_CALLER(msg)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00043\ \textcolor{preprocessor}{\ \ if(pt::this\_worker\ ==\ nullptr\ ||\ pt::this\_worker-\/>\_executor\ !=\ \&\_executor)\ \{\ \ \(\backslash\)}}
\DoxyCodeLine{00044\ \textcolor{preprocessor}{\ \ \ \ TF\_THROW(msg);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00045\ \textcolor{preprocessor}{\ \ \}}}
\DoxyCodeLine{00046\ }
\DoxyCodeLine{00047\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00048\ \ \ }
\DoxyCodeLine{00064\ \ \ \mbox{\hyperlink{classtf_1_1_runtime_a763b2f90bc53f92d680a635fe28e858e}{Executor}}\&\ \mbox{\hyperlink{classtf_1_1_runtime_a4ee48a82df1f9758a999d18e6015cec4}{executor}}();}
\DoxyCodeLine{00065\ \ \ }
\DoxyCodeLine{00069\ \ \ \textcolor{keyword}{inline}\ Worker\&\ \mbox{\hyperlink{classtf_1_1_runtime_ae1dbce75fd7375ae3bf38948638e34ec}{worker}}();}
\DoxyCodeLine{00070\ }
\DoxyCodeLine{00106\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtf_1_1_runtime_aa7e72cc0f298475195b252c8f1793343}{schedule}}(Task\ \mbox{\hyperlink{test__partitioner__whitebox_8h_a5c4cf3d37a4eee22275de22cb9619863}{task}});}
\DoxyCodeLine{00107\ \ \ }
\DoxyCodeLine{00166\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ F>}
\DoxyCodeLine{00167\ \ \ \textcolor{keyword}{auto}\ \mbox{\hyperlink{classtf_1_1_runtime_a5688b13034f179c4a8b2b0ebbb215051}{async}}(\mbox{\hyperlink{test__flow__graph_8cpp_a1c83625ec20fd09ecaf0e5b37c75f6f8}{F}}\&\&\ \mbox{\hyperlink{cxx11__tensor__map_8cpp_a7f507fea02198f6cb81c86640c7b1a4e}{f}});}
\DoxyCodeLine{00168\ \ \ }
\DoxyCodeLine{00188\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ P,\ \textcolor{keyword}{typename}\ F>}
\DoxyCodeLine{00189\ \ \ \textcolor{keyword}{auto}\ \mbox{\hyperlink{classtf_1_1_runtime_a5688b13034f179c4a8b2b0ebbb215051}{async}}(\mbox{\hyperlink{namespace_p}{P}}\&\&\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a22557289048c77f6913601e8537ceeea}{params}},\ \mbox{\hyperlink{test__flow__graph_8cpp_a1c83625ec20fd09ecaf0e5b37c75f6f8}{F}}\&\&\ \mbox{\hyperlink{cxx11__tensor__map_8cpp_a7f507fea02198f6cb81c86640c7b1a4e}{f}});}
\DoxyCodeLine{00190\ }
\DoxyCodeLine{00213\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ F>}
\DoxyCodeLine{00214\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtf_1_1_runtime_a0ce29efa2106c8c5a1432e4a55ab2e05}{silent\_async}}(\mbox{\hyperlink{test__flow__graph_8cpp_a1c83625ec20fd09ecaf0e5b37c75f6f8}{F}}\&\&\ \mbox{\hyperlink{cxx11__tensor__map_8cpp_a7f507fea02198f6cb81c86640c7b1a4e}{f}});}
\DoxyCodeLine{00215\ \ \ }
\DoxyCodeLine{00232\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ P,\ \textcolor{keyword}{typename}\ F>}
\DoxyCodeLine{00233\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtf_1_1_runtime_a0ce29efa2106c8c5a1432e4a55ab2e05}{silent\_async}}(\mbox{\hyperlink{namespace_p}{P}}\&\&\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a22557289048c77f6913601e8537ceeea}{params}},\ \mbox{\hyperlink{test__flow__graph_8cpp_a1c83625ec20fd09ecaf0e5b37c75f6f8}{F}}\&\&\ \mbox{\hyperlink{cxx11__tensor__map_8cpp_a7f507fea02198f6cb81c86640c7b1a4e}{f}});}
\DoxyCodeLine{00234\ \ \ }
\DoxyCodeLine{00259\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00260\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtf_1_1_runtime_a1c772e90614302024cfa52fa86d75cac}{corun}}(\mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}}\&\&\ target);}
\DoxyCodeLine{00261\ }
\DoxyCodeLine{00291\ \ \ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtf_1_1_runtime_afcc18484a95fd2a834940d878eaf4dfc}{corun\_all}}();}
\DoxyCodeLine{00292\ }
\DoxyCodeLine{00293\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00294\ \ \ }
\DoxyCodeLine{00298\ \ \ \textcolor{keyword}{explicit}\ \mbox{\hyperlink{classtf_1_1_runtime_abe76e072e64f5d1b1fe09c7e7c22777e}{Runtime}}(\mbox{\hyperlink{classtf_1_1_runtime_a763b2f90bc53f92d680a635fe28e858e}{Executor}}\&,\ Worker\&,\ \mbox{\hyperlink{class_node}{Node}}*);}
\DoxyCodeLine{00299\ \ \ }
\DoxyCodeLine{00303\ \ \ \mbox{\hyperlink{classtf_1_1_runtime_a763b2f90bc53f92d680a635fe28e858e}{Executor}}\&\ \mbox{\hyperlink{classtf_1_1_runtime_a8074028372bb09946927b1b6ec01c6e1}{\_executor}};}
\DoxyCodeLine{00304\ \ \ }
\DoxyCodeLine{00308\ \ \ \mbox{\hyperlink{classtf_1_1_worker}{Worker}}\&\ \mbox{\hyperlink{classtf_1_1_runtime_ae9bd2bcb1e004b078f627472fb9e0371}{\_worker}};}
\DoxyCodeLine{00309\ \ \ }
\DoxyCodeLine{00313\ \ \ \mbox{\hyperlink{classtf_1_1_node}{Node}}*\ \mbox{\hyperlink{classtf_1_1_runtime_ac040d7410fbb82703ac39ac3b1baf8fd}{\_parent}};}
\DoxyCodeLine{00314\ \ \ }
\DoxyCodeLine{00318\ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classtf_1_1_runtime_aa4c26b9b5bbec85a948daf8934b7feba}{\_preempted}}\ \{\textcolor{keyword}{false}\};}
\DoxyCodeLine{00319\ \};}
\DoxyCodeLine{00320\ }
\DoxyCodeLine{00321\ \textcolor{comment}{//\ constructor}}
\DoxyCodeLine{00322\ \textcolor{keyword}{inline}\ \mbox{\hyperlink{classtf_1_1_runtime_abe76e072e64f5d1b1fe09c7e7c22777e}{Runtime::Runtime}}(\mbox{\hyperlink{classtf_1_1_runtime_a763b2f90bc53f92d680a635fe28e858e}{Executor}}\&\ \mbox{\hyperlink{classtf_1_1_runtime_a4ee48a82df1f9758a999d18e6015cec4}{executor}},\ \mbox{\hyperlink{classtf_1_1_worker}{Worker}}\&\ \mbox{\hyperlink{classtf_1_1_runtime_ae1dbce75fd7375ae3bf38948638e34ec}{worker}},\ \mbox{\hyperlink{classtf_1_1_node}{Node}}*\ \mbox{\hyperlink{ittnotify__static_8h_ab242ec323769be8fbbf53617a69d14ff}{parent}})\ :}
\DoxyCodeLine{00323\ \ \ \mbox{\hyperlink{classtf_1_1_runtime_a8074028372bb09946927b1b6ec01c6e1}{\_executor}}\ \{\mbox{\hyperlink{classtf_1_1_runtime_a4ee48a82df1f9758a999d18e6015cec4}{executor}}\},}
\DoxyCodeLine{00324\ \ \ \mbox{\hyperlink{classtf_1_1_runtime_ae9bd2bcb1e004b078f627472fb9e0371}{\_worker}}\ \ \ \{\mbox{\hyperlink{classtf_1_1_runtime_ae1dbce75fd7375ae3bf38948638e34ec}{worker}}\},}
\DoxyCodeLine{00325\ \ \ \mbox{\hyperlink{classtf_1_1_runtime_ac040d7410fbb82703ac39ac3b1baf8fd}{\_parent}}\ \ \ \{\mbox{\hyperlink{ittnotify__static_8h_ab242ec323769be8fbbf53617a69d14ff}{parent}}\}\ \{}
\DoxyCodeLine{00326\ \}}
\DoxyCodeLine{00327\ }
\DoxyCodeLine{00328\ \textcolor{comment}{//\ Function:\ executor}}
\DoxyCodeLine{00329\ \textcolor{keyword}{inline}\ \mbox{\hyperlink{classtf_1_1_runtime_a763b2f90bc53f92d680a635fe28e858e}{Executor}}\&\ \mbox{\hyperlink{classtf_1_1_runtime_a4ee48a82df1f9758a999d18e6015cec4}{Runtime::executor}}()\ \{}
\DoxyCodeLine{00330\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classtf_1_1_runtime_a8074028372bb09946927b1b6ec01c6e1}{\_executor}};}
\DoxyCodeLine{00331\ \}}
\DoxyCodeLine{00332\ }
\DoxyCodeLine{00333\ \textcolor{comment}{//\ Function:\ worker}}
\DoxyCodeLine{00334\ \textcolor{keyword}{inline}\ \mbox{\hyperlink{classtf_1_1_worker}{Worker}}\&\ \mbox{\hyperlink{classtf_1_1_runtime_ae1dbce75fd7375ae3bf38948638e34ec}{Runtime::worker}}()\ \{}
\DoxyCodeLine{00335\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classtf_1_1_runtime_ae9bd2bcb1e004b078f627472fb9e0371}{\_worker}};}
\DoxyCodeLine{00336\ \}}
\DoxyCodeLine{00337\ }
\DoxyCodeLine{00338\ \textcolor{comment}{//\ Procedure:\ schedule}}
\DoxyCodeLine{00339\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtf_1_1_runtime_aa7e72cc0f298475195b252c8f1793343}{Runtime::schedule}}(\mbox{\hyperlink{classtf_1_1_task}{Task}}\ \mbox{\hyperlink{test__partitioner__whitebox_8h_a5c4cf3d37a4eee22275de22cb9619863}{task}})\ \{}
\DoxyCodeLine{00340\ \ \ }
\DoxyCodeLine{00341\ \ \ \mbox{\hyperlink{runtime_8hpp_a0b140fb327db1df313203abc7782693b}{TF\_RUNTIME\_CHECK\_CALLER}}(\textcolor{stringliteral}{"{}schedule\ must\ be\ called\ by\ a\ worker\ of\ runtime's\ executor"{}});}
\DoxyCodeLine{00342\ \ \ }
\DoxyCodeLine{00343\ \ \ \textcolor{keyword}{auto}\ node\ =\ \mbox{\hyperlink{test__partitioner__whitebox_8h_a5c4cf3d37a4eee22275de22cb9619863}{task}}.\_node;}
\DoxyCodeLine{00344\ \ \ \textcolor{comment}{//\ need\ to\ keep\ the\ invariant:\ when\ scheduling\ a\ task,\ the\ task\ must\ have}}
\DoxyCodeLine{00345\ \ \ \textcolor{comment}{//\ zero\ dependency\ (join\ counter\ is\ 0)}}
\DoxyCodeLine{00346\ \ \ \textcolor{comment}{//\ or\ we\ can\ encounter\ bug\ when\ inserting\ a\ nested\ flow\ (e.g.,\ module\ task)}}
\DoxyCodeLine{00347\ \ \ node-\/>\_join\_counter.store(0,\ std::memory\_order\_relaxed);}
\DoxyCodeLine{00348\ }
\DoxyCodeLine{00349\ \ \ \textcolor{keyword}{auto}\&\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}\ =\ node-\/>\_parent\ ?\ node-\/>\_parent-\/>\_join\_counter\ :}
\DoxyCodeLine{00350\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ node-\/>\_topology-\/>\_join\_counter;}
\DoxyCodeLine{00351\ \ \ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}.fetch\_add(1,\ std::memory\_order\_relaxed);}
\DoxyCodeLine{00352\ \ \ \mbox{\hyperlink{classtf_1_1_runtime_a8074028372bb09946927b1b6ec01c6e1}{\_executor}}.\mbox{\hyperlink{classtf_1_1_executor_ab8d98f12a62d10ad6cf1a4011a4d0034}{\_schedule}}(\mbox{\hyperlink{classtf_1_1_runtime_ae9bd2bcb1e004b078f627472fb9e0371}{\_worker}},\ node);}
\DoxyCodeLine{00353\ \}}
\DoxyCodeLine{00354\ }
\DoxyCodeLine{00355\ \textcolor{comment}{//\ Procedure:\ corun}}
\DoxyCodeLine{00356\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00357\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtf_1_1_runtime_a1c772e90614302024cfa52fa86d75cac}{Runtime::corun}}(\mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}}\&\&\ target)\ \{}
\DoxyCodeLine{00358\ }
\DoxyCodeLine{00359\ \ \ \textcolor{keyword}{static\_assert}(\mbox{\hyperlink{namespacetf_aea3945d9b15c96a72540ea4fe61947e7}{has\_graph\_v<T>}},\ \textcolor{stringliteral}{"{}target\ must\ define\ a\ member\ function\ 'Graph\&\ graph()'"{}});}
\DoxyCodeLine{00360\ }
\DoxyCodeLine{00361\ \ \ \mbox{\hyperlink{runtime_8hpp_a0b140fb327db1df313203abc7782693b}{TF\_RUNTIME\_CHECK\_CALLER}}(\textcolor{stringliteral}{"{}corun\ must\ be\ called\ by\ a\ worker\ of\ runtime's\ executor"{}});}
\DoxyCodeLine{00362\ \ \ \mbox{\hyperlink{classtf_1_1_runtime_a8074028372bb09946927b1b6ec01c6e1}{\_executor}}.\mbox{\hyperlink{classtf_1_1_executor_a6202243d809e524d196a9c0e3092ce41}{\_corun\_graph}}(*\mbox{\hyperlink{namespacetf_1_1pt_a70a6dd7df97bb7da11a723d96fdef945}{pt::this\_worker}},\ \mbox{\hyperlink{classtf_1_1_runtime_ac040d7410fbb82703ac39ac3b1baf8fd}{\_parent}},\ target.graph().begin(),\ target.graph().end());}
\DoxyCodeLine{00363\ \}}
\DoxyCodeLine{00364\ }
\DoxyCodeLine{00365\ \textcolor{comment}{//\ Function:\ corun\_all}}
\DoxyCodeLine{00366\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtf_1_1_runtime_afcc18484a95fd2a834940d878eaf4dfc}{Runtime::corun\_all}}()\ \{}
\DoxyCodeLine{00367\ \ \ \mbox{\hyperlink{runtime_8hpp_a0b140fb327db1df313203abc7782693b}{TF\_RUNTIME\_CHECK\_CALLER}}(\textcolor{stringliteral}{"{}corun\_all\ must\ be\ called\ by\ a\ worker\ of\ runtime's\ executor"{}});}
\DoxyCodeLine{00368\ \ \ \{}
\DoxyCodeLine{00369\ \ \ \ \ AnchorGuard\ anchor(\mbox{\hyperlink{classtf_1_1_runtime_ac040d7410fbb82703ac39ac3b1baf8fd}{\_parent}});}
\DoxyCodeLine{00370\ \ \ \ \ \mbox{\hyperlink{classtf_1_1_runtime_a8074028372bb09946927b1b6ec01c6e1}{\_executor}}.\_corun\_until(\mbox{\hyperlink{classtf_1_1_runtime_ae9bd2bcb1e004b078f627472fb9e0371}{\_worker}},\ [\textcolor{keyword}{this}]\ ()\ -\/>\ \textcolor{keywordtype}{bool}\ \{}
\DoxyCodeLine{00371\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classtf_1_1_runtime_ac040d7410fbb82703ac39ac3b1baf8fd}{\_parent}}-\/>\_join\_counter.load(std::memory\_order\_acquire)\ ==\ 0;}
\DoxyCodeLine{00372\ \ \ \ \ \});}
\DoxyCodeLine{00373\ \ \ \}}
\DoxyCodeLine{00374\ \ \ \mbox{\hyperlink{classtf_1_1_runtime_ac040d7410fbb82703ac39ac3b1baf8fd}{\_parent}}-\/>\_rethrow\_exception();}
\DoxyCodeLine{00375\ \}}
\DoxyCodeLine{00376\ }
\DoxyCodeLine{00377\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00378\ \textcolor{comment}{//\ Runtime::silent\_async\ series}}
\DoxyCodeLine{00379\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00380\ }
\DoxyCodeLine{00381\ \textcolor{comment}{//\ Function:\ silent\_async}}
\DoxyCodeLine{00382\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ F>}
\DoxyCodeLine{00383\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtf_1_1_runtime_a0ce29efa2106c8c5a1432e4a55ab2e05}{Runtime::silent\_async}}(\mbox{\hyperlink{test__flow__graph_8cpp_a1c83625ec20fd09ecaf0e5b37c75f6f8}{F}}\&\&\ \mbox{\hyperlink{cxx11__tensor__map_8cpp_a7f507fea02198f6cb81c86640c7b1a4e}{f}})\ \{}
\DoxyCodeLine{00384\ \ \ \mbox{\hyperlink{classtf_1_1_runtime_a0ce29efa2106c8c5a1432e4a55ab2e05}{silent\_async}}(DefaultTaskParams\{\},\ std::forward<F>(\mbox{\hyperlink{cxx11__tensor__map_8cpp_a7f507fea02198f6cb81c86640c7b1a4e}{f}}));}
\DoxyCodeLine{00385\ \}}
\DoxyCodeLine{00386\ }
\DoxyCodeLine{00387\ \textcolor{comment}{//\ Function:\ silent\_async}}
\DoxyCodeLine{00388\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ P,\ \textcolor{keyword}{typename}\ F>}
\DoxyCodeLine{00389\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtf_1_1_runtime_a0ce29efa2106c8c5a1432e4a55ab2e05}{Runtime::silent\_async}}(P\&\&\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a22557289048c77f6913601e8537ceeea}{params}},\ \mbox{\hyperlink{test__flow__graph_8cpp_a1c83625ec20fd09ecaf0e5b37c75f6f8}{F}}\&\&\ \mbox{\hyperlink{cxx11__tensor__map_8cpp_a7f507fea02198f6cb81c86640c7b1a4e}{f}})\ \{}
\DoxyCodeLine{00390\ \ \ \mbox{\hyperlink{classtf_1_1_runtime_ac040d7410fbb82703ac39ac3b1baf8fd}{\_parent}}-\/>\_join\_counter.fetch\_add(1,\ std::memory\_order\_relaxed);}
\DoxyCodeLine{00391\ \ \ \mbox{\hyperlink{classtf_1_1_runtime_a8074028372bb09946927b1b6ec01c6e1}{\_executor}}.\_silent\_async(}
\DoxyCodeLine{00392\ \ \ \ \ std::forward<P>(\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a22557289048c77f6913601e8537ceeea}{params}}),\ std::forward<F>(\mbox{\hyperlink{cxx11__tensor__map_8cpp_a7f507fea02198f6cb81c86640c7b1a4e}{f}}),\ \mbox{\hyperlink{classtf_1_1_runtime_ac040d7410fbb82703ac39ac3b1baf8fd}{\_parent}}-\/>\_topology,\ \mbox{\hyperlink{classtf_1_1_runtime_ac040d7410fbb82703ac39ac3b1baf8fd}{\_parent}}}
\DoxyCodeLine{00393\ \ \ );}
\DoxyCodeLine{00394\ \}}
\DoxyCodeLine{00395\ }
\DoxyCodeLine{00396\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00397\ \textcolor{comment}{//\ Runtime::async\ series}}
\DoxyCodeLine{00398\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00399\ }
\DoxyCodeLine{00400\ \textcolor{comment}{//\ Function:\ async}}
\DoxyCodeLine{00401\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ F>}
\DoxyCodeLine{00402\ \textcolor{keyword}{auto}\ \mbox{\hyperlink{classtf_1_1_runtime_a5688b13034f179c4a8b2b0ebbb215051}{Runtime::async}}(\mbox{\hyperlink{test__flow__graph_8cpp_a1c83625ec20fd09ecaf0e5b37c75f6f8}{F}}\&\&\ \mbox{\hyperlink{cxx11__tensor__map_8cpp_a7f507fea02198f6cb81c86640c7b1a4e}{f}})\ \{}
\DoxyCodeLine{00403\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classtf_1_1_runtime_a5688b13034f179c4a8b2b0ebbb215051}{async}}(DefaultTaskParams\{\},\ std::forward<F>(\mbox{\hyperlink{cxx11__tensor__map_8cpp_a7f507fea02198f6cb81c86640c7b1a4e}{f}}));}
\DoxyCodeLine{00404\ \}}
\DoxyCodeLine{00405\ }
\DoxyCodeLine{00406\ \textcolor{comment}{//\ Function:\ async}}
\DoxyCodeLine{00407\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ P,\ \textcolor{keyword}{typename}\ F>}
\DoxyCodeLine{00408\ \textcolor{keyword}{auto}\ \mbox{\hyperlink{classtf_1_1_runtime_a5688b13034f179c4a8b2b0ebbb215051}{Runtime::async}}(P\&\&\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a22557289048c77f6913601e8537ceeea}{params}},\ \mbox{\hyperlink{test__flow__graph_8cpp_a1c83625ec20fd09ecaf0e5b37c75f6f8}{F}}\&\&\ \mbox{\hyperlink{cxx11__tensor__map_8cpp_a7f507fea02198f6cb81c86640c7b1a4e}{f}})\ \{}
\DoxyCodeLine{00409\ \ \ \mbox{\hyperlink{classtf_1_1_runtime_ac040d7410fbb82703ac39ac3b1baf8fd}{\_parent}}-\/>\_join\_counter.fetch\_add(1,\ std::memory\_order\_relaxed);}
\DoxyCodeLine{00410\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classtf_1_1_runtime_a8074028372bb09946927b1b6ec01c6e1}{\_executor}}.\_async(}
\DoxyCodeLine{00411\ \ \ \ \ std::forward<P>(\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a22557289048c77f6913601e8537ceeea}{params}}),\ std::forward<F>(\mbox{\hyperlink{cxx11__tensor__map_8cpp_a7f507fea02198f6cb81c86640c7b1a4e}{f}}),\ \mbox{\hyperlink{classtf_1_1_runtime_ac040d7410fbb82703ac39ac3b1baf8fd}{\_parent}}-\/>\_topology,\ \mbox{\hyperlink{classtf_1_1_runtime_ac040d7410fbb82703ac39ac3b1baf8fd}{\_parent}}}
\DoxyCodeLine{00412\ \ \ );}
\DoxyCodeLine{00413\ \}}
\DoxyCodeLine{00414\ }
\DoxyCodeLine{00415\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00416\ \textcolor{comment}{//\ Preemption\ guard}}
\DoxyCodeLine{00417\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00418\ }
\DoxyCodeLine{00422\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classtf_1_1_preemption_guard_a8c426fc91c06f5ffe824fa572598e8e6}{PreemptionGuard}}\ \{}
\DoxyCodeLine{00423\ }
\DoxyCodeLine{00424\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00425\ }
\DoxyCodeLine{00426\ \ \ \mbox{\hyperlink{classtf_1_1_preemption_guard_a8c426fc91c06f5ffe824fa572598e8e6}{PreemptionGuard}}(\mbox{\hyperlink{classtf_1_1_runtime}{Runtime}}\&\ \mbox{\hyperlink{runtime_2spdlog_2include_2spdlog_2fmt_2bundled_2base_8h_a8c5f2060819744fc66f8fbce25a480be}{runtime}})\ :\ \mbox{\hyperlink{classtf_1_1_preemption_guard_a2427d7e7df9507d42897403dc3e57fed}{\_runtime}}\ \{\mbox{\hyperlink{runtime_2spdlog_2include_2spdlog_2fmt_2bundled_2base_8h_a8c5f2060819744fc66f8fbce25a480be}{runtime}}\}\ \{}
\DoxyCodeLine{00427\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classtf_1_1_preemption_guard_a2427d7e7df9507d42897403dc3e57fed}{\_runtime}}.\_preempted\ ==\ \textcolor{keyword}{true})\ \{}
\DoxyCodeLine{00428\ \ \ \ \ \ \ \mbox{\hyperlink{error_8hpp_aecd66f17d01de60aeb9cae992c9dd4bf}{TF\_THROW}}(\textcolor{stringliteral}{"{}runtime\ is\ not\ preemptible"{}});}
\DoxyCodeLine{00429\ \ \ \ \ \}}
\DoxyCodeLine{00430\ \ \ \ \ \mbox{\hyperlink{classtf_1_1_preemption_guard_a2427d7e7df9507d42897403dc3e57fed}{\_runtime}}.\_parent-\/>\_nstate\ |=\ \mbox{\hyperlink{structtf_1_1_n_s_t_a_t_e_a8da6205c0944eb6ec6f0c453cc4f1d93}{NSTATE::PREEMPTED}};}
\DoxyCodeLine{00431\ \ \ \ \ \mbox{\hyperlink{classtf_1_1_preemption_guard_a2427d7e7df9507d42897403dc3e57fed}{\_runtime}}.\_preempted\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00432\ \ \ \ \ \mbox{\hyperlink{classtf_1_1_preemption_guard_a2427d7e7df9507d42897403dc3e57fed}{\_runtime}}.\_parent-\/>\_join\_counter.fetch\_add(1,\ std::memory\_order\_release);}
\DoxyCodeLine{00433\ \ \ \}}
\DoxyCodeLine{00434\ }
\DoxyCodeLine{00435\ \ \ \mbox{\hyperlink{classtf_1_1_preemption_guard_ac30e13a5d3ec23150a6cf940edb2a986}{\string~PreemptionGuard}}()\ \{}
\DoxyCodeLine{00436\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classtf_1_1_preemption_guard_a2427d7e7df9507d42897403dc3e57fed}{\_runtime}}.\_parent-\/>\_join\_counter.fetch\_sub(1,\ std::memory\_order\_acq\_rel)\ ==\ 1)\ \{}
\DoxyCodeLine{00437\ \ \ \ \ \ \ \mbox{\hyperlink{classtf_1_1_preemption_guard_a2427d7e7df9507d42897403dc3e57fed}{\_runtime}}.\_preempted\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00438\ \ \ \ \ \ \ \mbox{\hyperlink{classtf_1_1_preemption_guard_a2427d7e7df9507d42897403dc3e57fed}{\_runtime}}.\_parent-\/>\_nstate\ \&=\ \mbox{\hyperlink{structtf_1_1_n_s_t_a_t_e}{\string~NSTATE}}::PREEMPTED;}
\DoxyCodeLine{00439\ \ \ \ \ \}}
\DoxyCodeLine{00440\ \ \ \}}
\DoxyCodeLine{00441\ }
\DoxyCodeLine{00442\ \ \ \mbox{\hyperlink{classtf_1_1_preemption_guard_ae1c7a6eac52f4f50a548f63efab08c08}{PreemptionGuard}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtf_1_1_preemption_guard_a8c426fc91c06f5ffe824fa572598e8e6}{PreemptionGuard}}\&)\ =\ \textcolor{keyword}{delete};}
\DoxyCodeLine{00443\ \ \ \mbox{\hyperlink{classtf_1_1_preemption_guard_ad2f3c41a590eabf4d4c6880b0253db70}{PreemptionGuard}}(\mbox{\hyperlink{classtf_1_1_preemption_guard_a8c426fc91c06f5ffe824fa572598e8e6}{PreemptionGuard}}\&\&)\ =\ \textcolor{keyword}{delete};}
\DoxyCodeLine{00444\ }
\DoxyCodeLine{00445\ \ \ \mbox{\hyperlink{classtf_1_1_preemption_guard_a8c426fc91c06f5ffe824fa572598e8e6}{PreemptionGuard}}\&\ \mbox{\hyperlink{classtf_1_1_preemption_guard_a292c1fc3d60a840d1e3393c6ca6bde49}{operator\ =\ }}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtf_1_1_preemption_guard_a8c426fc91c06f5ffe824fa572598e8e6}{PreemptionGuard}}\&)\ =\ \textcolor{keyword}{delete};}
\DoxyCodeLine{00446\ \ \ \mbox{\hyperlink{classtf_1_1_preemption_guard_a8c426fc91c06f5ffe824fa572598e8e6}{PreemptionGuard}}\&\ \mbox{\hyperlink{classtf_1_1_preemption_guard_a292c1fc3d60a840d1e3393c6ca6bde49}{operator\ =\ }}(\mbox{\hyperlink{classtf_1_1_preemption_guard_a8c426fc91c06f5ffe824fa572598e8e6}{PreemptionGuard}}\&\&)\ =\ \textcolor{keyword}{delete};}
\DoxyCodeLine{00447\ \ \ }
\DoxyCodeLine{00448\ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00449\ }
\DoxyCodeLine{00450\ \ \ \mbox{\hyperlink{classtf_1_1_runtime}{Runtime}}\&\ \mbox{\hyperlink{classtf_1_1_preemption_guard_a2427d7e7df9507d42897403dc3e57fed}{\_runtime}};}
\DoxyCodeLine{00451\ \};}
\DoxyCodeLine{00452\ }
\DoxyCodeLine{00453\ }
\DoxyCodeLine{00454\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00455\ \textcolor{comment}{//\ Executor\ Forward\ Declaration}}
\DoxyCodeLine{00456\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00457\ }
\DoxyCodeLine{00458\ \textcolor{comment}{//\ Procedure:\ \_invoke\_runtime\_task}}
\DoxyCodeLine{00459\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classtf_1_1_executor_a324dfe88e4b227fce0fdc76b667c40ce}{Executor::\_invoke\_runtime\_task}}(\mbox{\hyperlink{classtf_1_1_worker}{Worker}}\&\ worker,\ \mbox{\hyperlink{classtf_1_1_node}{Node}}*\ node)\ \{}
\DoxyCodeLine{00460\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classtf_1_1_executor_a7dbf235bdda813dd63e851cbae573bb4}{\_invoke\_runtime\_task\_impl}}(}
\DoxyCodeLine{00461\ \ \ \ \ worker,\ node,\ std::get\_if<Node::Runtime>(\&node-\/>\_handle)-\/>work}
\DoxyCodeLine{00462\ \ \ );}
\DoxyCodeLine{00463\ \}}
\DoxyCodeLine{00464\ }
\DoxyCodeLine{00465\ \textcolor{comment}{//\ Function:\ \_invoke\_runtime\_task\_impl}}
\DoxyCodeLine{00466\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classtf_1_1_executor_a7dbf235bdda813dd63e851cbae573bb4}{Executor::\_invoke\_runtime\_task\_impl}}(}
\DoxyCodeLine{00467\ \ \ \mbox{\hyperlink{classtf_1_1_worker}{Worker}}\&\ worker,\ \mbox{\hyperlink{classtf_1_1_node}{Node}}*\ node,\ std::function<\textcolor{keywordtype}{void}(\mbox{\hyperlink{classtf_1_1_executor_a5b17fd70021887be0e396dd96f9dd5e3}{Runtime}}\&)>\&\ \mbox{\hyperlink{graph__pipeline_2levelgraph_8hpp_aa24fdf691a71c708fccdc6e29a805b42}{work}}}
\DoxyCodeLine{00468\ )\ \{}
\DoxyCodeLine{00469\ \ \ \textcolor{comment}{//\ first\ time}}
\DoxyCodeLine{00470\ \ \ \textcolor{keywordflow}{if}((node-\/>\_nstate\ \&\ \mbox{\hyperlink{structtf_1_1_n_s_t_a_t_e_a8da6205c0944eb6ec6f0c453cc4f1d93}{NSTATE::PREEMPTED}})\ ==\ 0)\ \{}
\DoxyCodeLine{00471\ }
\DoxyCodeLine{00472\ \ \ \ \ \mbox{\hyperlink{classtf_1_1_executor_a5b17fd70021887be0e396dd96f9dd5e3}{Runtime}}\ rt(*\textcolor{keyword}{this},\ worker,\ node);}
\DoxyCodeLine{00473\ }
\DoxyCodeLine{00474\ \ \ \ \ \mbox{\hyperlink{classtf_1_1_executor_ae023614977a19def9e04cf7212eab65b}{\_observer\_prologue}}(worker,\ node);}
\DoxyCodeLine{00475\ \ \ \ \ \mbox{\hyperlink{macros_8hpp_a1d1458372ef134863ab272284ccf100d}{TF\_EXECUTOR\_EXCEPTION\_HANDLER}}(worker,\ node,\ \{}
\DoxyCodeLine{00476\ \ \ \ \ \ \ \mbox{\hyperlink{graph__pipeline_2levelgraph_8hpp_a974702416f67274752dac351d6e73b30}{work}}(rt);}
\DoxyCodeLine{00477\ \ \ \ \ \});}
\DoxyCodeLine{00478\ \ \ \ \ \mbox{\hyperlink{classtf_1_1_executor_a9cd8c1a72af4477bc0f9575b68ffb16a}{\_observer\_epilogue}}(worker,\ node);}
\DoxyCodeLine{00479\ \ \ \ \ }
\DoxyCodeLine{00480\ \ \ \ \ \textcolor{comment}{//\ here,\ we\ cannot\ check\ the\ state\ from\ node-\/>\_nstate\ due\ to\ data\ race}}
\DoxyCodeLine{00481\ \ \ \ \ \textcolor{keywordflow}{if}(rt.\mbox{\hyperlink{classtf_1_1_runtime_aa4c26b9b5bbec85a948daf8934b7feba}{\_preempted}})\ \{}
\DoxyCodeLine{00482\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00483\ \ \ \ \ \}}
\DoxyCodeLine{00484\ \ \ \}}
\DoxyCodeLine{00485\ \ \ \textcolor{comment}{//\ second\ time\ -\/\ previously\ preempted}}
\DoxyCodeLine{00486\ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00487\ \ \ \ \ node-\/>\_nstate\ \&=\ \mbox{\hyperlink{structtf_1_1_n_s_t_a_t_e}{\string~NSTATE}}::PREEMPTED;}
\DoxyCodeLine{00488\ \ \ \}}
\DoxyCodeLine{00489\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00490\ \}}
\DoxyCodeLine{00491\ }
\DoxyCodeLine{00492\ \textcolor{comment}{//\ Function:\ \_invoke\_runtime\_task\_impl}}
\DoxyCodeLine{00493\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classtf_1_1_executor_a7dbf235bdda813dd63e851cbae573bb4}{Executor::\_invoke\_runtime\_task\_impl}}(}
\DoxyCodeLine{00494\ \ \ \mbox{\hyperlink{classtf_1_1_worker}{Worker}}\&\ worker,\ \mbox{\hyperlink{classtf_1_1_node}{Node}}*\ node,\ std::function<\textcolor{keywordtype}{void}(\mbox{\hyperlink{classtf_1_1_executor_a5b17fd70021887be0e396dd96f9dd5e3}{Runtime}}\&,\ \textcolor{keywordtype}{bool})>\&\ \mbox{\hyperlink{graph__pipeline_2levelgraph_8hpp_aa24fdf691a71c708fccdc6e29a805b42}{work}}}
\DoxyCodeLine{00495\ )\ \{}
\DoxyCodeLine{00496\ \ \ \ \ }
\DoxyCodeLine{00497\ \ \ \mbox{\hyperlink{classtf_1_1_executor_a5b17fd70021887be0e396dd96f9dd5e3}{Runtime}}\ rt(*\textcolor{keyword}{this},\ worker,\ node);}
\DoxyCodeLine{00498\ }
\DoxyCodeLine{00499\ \ \ \textcolor{comment}{//\ first\ time}}
\DoxyCodeLine{00500\ \ \ \textcolor{keywordflow}{if}((node-\/>\_nstate\ \&\ \mbox{\hyperlink{structtf_1_1_n_s_t_a_t_e_a8da6205c0944eb6ec6f0c453cc4f1d93}{NSTATE::PREEMPTED}})\ ==\ 0)\ \{}
\DoxyCodeLine{00501\ }
\DoxyCodeLine{00502\ \ \ \ \ \mbox{\hyperlink{classtf_1_1_executor_ae023614977a19def9e04cf7212eab65b}{\_observer\_prologue}}(worker,\ node);}
\DoxyCodeLine{00503\ \ \ \ \ \mbox{\hyperlink{macros_8hpp_a1d1458372ef134863ab272284ccf100d}{TF\_EXECUTOR\_EXCEPTION\_HANDLER}}(worker,\ node,\ \{}
\DoxyCodeLine{00504\ \ \ \ \ \ \ \mbox{\hyperlink{graph__pipeline_2levelgraph_8hpp_a974702416f67274752dac351d6e73b30}{work}}(rt,\ \textcolor{keyword}{false});}
\DoxyCodeLine{00505\ \ \ \ \ \});}
\DoxyCodeLine{00506\ \ \ \ \ \mbox{\hyperlink{classtf_1_1_executor_a9cd8c1a72af4477bc0f9575b68ffb16a}{\_observer\_epilogue}}(worker,\ node);}
\DoxyCodeLine{00507\ \ \ \ \ }
\DoxyCodeLine{00508\ \ \ \ \ \textcolor{comment}{//\ here,\ we\ cannot\ check\ the\ state\ from\ node-\/>\_nstate\ due\ to\ data\ race}}
\DoxyCodeLine{00509\ \ \ \ \ \textcolor{keywordflow}{if}(rt.\mbox{\hyperlink{classtf_1_1_runtime_aa4c26b9b5bbec85a948daf8934b7feba}{\_preempted}})\ \{}
\DoxyCodeLine{00510\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00511\ \ \ \ \ \}}
\DoxyCodeLine{00512\ \ \ \}}
\DoxyCodeLine{00513\ \ \ \textcolor{comment}{//\ second\ time\ -\/\ previously\ preempted}}
\DoxyCodeLine{00514\ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00515\ \ \ \ \ node-\/>\_nstate\ \&=\ \mbox{\hyperlink{structtf_1_1_n_s_t_a_t_e}{\string~NSTATE}}::PREEMPTED;}
\DoxyCodeLine{00516\ \ \ \}}
\DoxyCodeLine{00517\ }
\DoxyCodeLine{00518\ \ \ \textcolor{comment}{//\ clean\ up\ outstanding\ work}}
\DoxyCodeLine{00519\ \ \ \mbox{\hyperlink{graph__pipeline_2levelgraph_8hpp_a974702416f67274752dac351d6e73b30}{work}}(rt,\ \textcolor{keyword}{true});}
\DoxyCodeLine{00520\ }
\DoxyCodeLine{00521\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00522\ \}}
\DoxyCodeLine{00523\ }
\DoxyCodeLine{00524\ }
\DoxyCodeLine{00525\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00526\ \textcolor{comment}{//\ Executor\ Members\ that\ Depend\ on\ Runtime}}
\DoxyCodeLine{00527\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00528\ }
\DoxyCodeLine{00529\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ P,\ \textcolor{keyword}{typename}\ F>}
\DoxyCodeLine{00530\ \textcolor{keyword}{auto}\ \mbox{\hyperlink{classtf_1_1_executor_ac568bd686aba3bedabe63b42c43d94a8}{Executor::\_async}}(\mbox{\hyperlink{namespace_p}{P}}\&\&\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a22557289048c77f6913601e8537ceeea}{params}},\ \mbox{\hyperlink{test__flow__graph_8cpp_a1c83625ec20fd09ecaf0e5b37c75f6f8}{F}}\&\&\ \mbox{\hyperlink{cxx11__tensor__map_8cpp_a7f507fea02198f6cb81c86640c7b1a4e}{f}},\ \mbox{\hyperlink{classtf_1_1_topology}{Topology}}*\ tpg,\ \mbox{\hyperlink{classtf_1_1_node}{Node}}*\ \mbox{\hyperlink{ittnotify__static_8h_ab242ec323769be8fbbf53617a69d14ff}{parent}})\ \{}
\DoxyCodeLine{00531\ \ \ }
\DoxyCodeLine{00532\ \ \ \textcolor{comment}{//\ async\ task\ with\ runtime:\ []\ (tf::Runtime\&)\ \{\ ...\ \}}}
\DoxyCodeLine{00533\ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (\mbox{\hyperlink{namespacetf_af3d94f0be0f7b49e195c4e92737b1f85}{is\_runtime\_task\_v<F>}})\ \{}
\DoxyCodeLine{00534\ }
\DoxyCodeLine{00535\ \ \ \ \ std::promise<void>\ \mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}};}
\DoxyCodeLine{00536\ \ \ \ \ \textcolor{keyword}{auto}\ fu\{\mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}}.get\_future()\};}
\DoxyCodeLine{00537\ \ \ \ \ }
\DoxyCodeLine{00538\ \ \ \ \ \mbox{\hyperlink{classtf_1_1_executor_af5acda8c6e9a1564c9d665336ea091d0}{\_schedule\_async\_task}}(\mbox{\hyperlink{gears_8c_af7a75874690301f56bcd3fa511ba39a8}{animate}}(}
\DoxyCodeLine{00539\ \ \ \ \ \ \ \mbox{\hyperlink{structtf_1_1_n_s_t_a_t_e_a722ef9d612f6f3f8aa2ba65ce4f32ef5}{NSTATE::NONE}},\ \mbox{\hyperlink{structtf_1_1_e_s_t_a_t_e_acb87e40cf84e3a484c6c62ddbd4091ab}{ESTATE::ANCHORED}},\ std::forward<P>(\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a22557289048c77f6913601e8537ceeea}{params}}),\ tpg,\ \mbox{\hyperlink{ittnotify__static_8h_ab242ec323769be8fbbf53617a69d14ff}{parent}},\ 0,\ }
\DoxyCodeLine{00540\ \ \ \ \ \ \ std::in\_place\_type\_t<Node::Async>\{\},\ }
\DoxyCodeLine{00541\ \ \ \ \ \ \ [\mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}}=\mbox{\hyperlink{structtf_1_1_mo_c}{MoC}}\{std::move(\mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}})\},\ \mbox{\hyperlink{cxx11__tensor__map_8cpp_a7f507fea02198f6cb81c86640c7b1a4e}{f}}=std::forward<F>(\mbox{\hyperlink{cxx11__tensor__map_8cpp_a7f507fea02198f6cb81c86640c7b1a4e}{f}})](\mbox{\hyperlink{classtf_1_1_executor_a5b17fd70021887be0e396dd96f9dd5e3}{Runtime}}\&\ rt,\ \textcolor{keywordtype}{bool}\ reentered)\ \textcolor{keyword}{mutable}\ \{\ }
\DoxyCodeLine{00542\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!reentered)\ \{}
\DoxyCodeLine{00543\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{cxx11__tensor__map_8cpp_a7f507fea02198f6cb81c86640c7b1a4e}{f}}(rt);}
\DoxyCodeLine{00544\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00545\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00546\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\&\ eptr\ =\ rt.\_parent-\/>\_exception\_ptr;}
\DoxyCodeLine{00547\ \ \ \ \ \ \ \ \ \ \ eptr\ ?\ \mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}}.object.set\_exception(eptr)\ :\ \mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}}.object.set\_value();}
\DoxyCodeLine{00548\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00549\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00550\ \ \ \ \ ));}
\DoxyCodeLine{00551\ \ \ \ \ \textcolor{keywordflow}{return}\ fu;}
\DoxyCodeLine{00552\ \ \ \}}
\DoxyCodeLine{00553\ \ \ \textcolor{comment}{//\ async\ task\ with\ closure:\ []\ ()\ \{\ ...\ \}}}
\DoxyCodeLine{00554\ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_invocable\_v<F>)\{}
\DoxyCodeLine{00555\ \ \ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{test__broadcast__node_8cpp_a554e63228b946db0d44c4f398b18e212}{R}}\ =\ std::invoke\_result\_t<F>;}
\DoxyCodeLine{00556\ \ \ \ \ std::packaged\_task<\mbox{\hyperlink{test__broadcast__node_8cpp_a554e63228b946db0d44c4f398b18e212}{R}}()>\ \mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}}(std::forward<F>(\mbox{\hyperlink{cxx11__tensor__map_8cpp_a7f507fea02198f6cb81c86640c7b1a4e}{f}}));}
\DoxyCodeLine{00557\ \ \ \ \ \textcolor{keyword}{auto}\ fu\{\mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}}.get\_future()\};}
\DoxyCodeLine{00558\ \ \ \ \ \mbox{\hyperlink{classtf_1_1_executor_af5acda8c6e9a1564c9d665336ea091d0}{\_schedule\_async\_task}}(\mbox{\hyperlink{gears_8c_af7a75874690301f56bcd3fa511ba39a8}{animate}}(}
\DoxyCodeLine{00559\ \ \ \ \ \ \ \mbox{\hyperlink{structtf_1_1_n_s_t_a_t_e_a722ef9d612f6f3f8aa2ba65ce4f32ef5}{NSTATE::NONE}},\ \mbox{\hyperlink{structtf_1_1_e_s_t_a_t_e_a9a8cf630467f60943d7e9488e095619c}{ESTATE::NONE}},\ std::forward<P>(\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a22557289048c77f6913601e8537ceeea}{params}}),\ tpg,\ \mbox{\hyperlink{ittnotify__static_8h_ab242ec323769be8fbbf53617a69d14ff}{parent}},\ 0,\ }
\DoxyCodeLine{00560\ \ \ \ \ \ \ std::in\_place\_type\_t<Node::Async>\{\},\ }
\DoxyCodeLine{00561\ \ \ \ \ \ \ [\mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}}=\mbox{\hyperlink{namespacetf_a7ddc987133ce85bd85c883b9e113c71b}{make\_moc}}(std::move(\mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}}))]()\ \textcolor{keyword}{mutable}\ \{\ \mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}}.object();\ \}}
\DoxyCodeLine{00562\ \ \ \ \ ));}
\DoxyCodeLine{00563\ \ \ \ \ \textcolor{keywordflow}{return}\ fu;}
\DoxyCodeLine{00564\ \ \ \}}
\DoxyCodeLine{00565\ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00566\ \ \ \ \ \textcolor{keyword}{static\_assert}(\mbox{\hyperlink{namespacetf_a036d82b3ab21beea2ed89611e2930db7}{dependent\_false\_v<F>}},\ }
\DoxyCodeLine{00567\ \ \ \ \ \ \ \textcolor{stringliteral}{"{}invalid\ async\ target\ -\/\ must\ be\ one\ of\ the\ following\ types:\(\backslash\)n\(\backslash\)}}
\DoxyCodeLine{00568\ \textcolor{stringliteral}{\ \ \ \ \ \ (1)\ []\ (tf::Runtime\&)\ -\/>\ void\ \{\}\(\backslash\)n\(\backslash\)}}
\DoxyCodeLine{00569\ \textcolor{stringliteral}{\ \ \ \ \ \ (2)\ []\ ()\ -\/>\ auto\ \{\ ...\ return\ ...\ \}\(\backslash\)n"{}}}
\DoxyCodeLine{00570\ \ \ \ \ );}
\DoxyCodeLine{00571\ \ \ \}}
\DoxyCodeLine{00572\ }
\DoxyCodeLine{00573\ \}}
\DoxyCodeLine{00574\ }
\DoxyCodeLine{00575\ \textcolor{comment}{//\ Function:\ \_silent\_async}}
\DoxyCodeLine{00576\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ P,\ \textcolor{keyword}{typename}\ F>}
\DoxyCodeLine{00577\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtf_1_1_executor_aa3b32388be14b03249de29bae34b7b52}{Executor::\_silent\_async}}(\mbox{\hyperlink{namespace_p}{P}}\&\&\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a22557289048c77f6913601e8537ceeea}{params}},\ \mbox{\hyperlink{test__flow__graph_8cpp_a1c83625ec20fd09ecaf0e5b37c75f6f8}{F}}\&\&\ \mbox{\hyperlink{cxx11__tensor__map_8cpp_a7f507fea02198f6cb81c86640c7b1a4e}{f}},\ \mbox{\hyperlink{classtf_1_1_topology}{Topology}}*\ tpg,\ \mbox{\hyperlink{classtf_1_1_node}{Node}}*\ \mbox{\hyperlink{ittnotify__static_8h_ab242ec323769be8fbbf53617a69d14ff}{parent}})\ \{}
\DoxyCodeLine{00578\ \ \ \textcolor{comment}{//\ silent\ task\ }}
\DoxyCodeLine{00579\ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (\mbox{\hyperlink{namespacetf_af3d94f0be0f7b49e195c4e92737b1f85}{is\_runtime\_task\_v<F>}}\ ||\ std::is\_invocable\_v<F>)\ \{}
\DoxyCodeLine{00580\ \ \ \ \ \mbox{\hyperlink{classtf_1_1_executor_af5acda8c6e9a1564c9d665336ea091d0}{\_schedule\_async\_task}}(\mbox{\hyperlink{gears_8c_af7a75874690301f56bcd3fa511ba39a8}{animate}}(}
\DoxyCodeLine{00581\ \ \ \ \ \ \ \mbox{\hyperlink{structtf_1_1_n_s_t_a_t_e_a722ef9d612f6f3f8aa2ba65ce4f32ef5}{NSTATE::NONE}},\ \mbox{\hyperlink{structtf_1_1_e_s_t_a_t_e_a9a8cf630467f60943d7e9488e095619c}{ESTATE::NONE}},\ std::forward<P>(\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a22557289048c77f6913601e8537ceeea}{params}}),\ tpg,\ \mbox{\hyperlink{ittnotify__static_8h_ab242ec323769be8fbbf53617a69d14ff}{parent}},\ 0,}
\DoxyCodeLine{00582\ \ \ \ \ \ \ std::in\_place\_type\_t<Node::Async>\{\},\ std::forward<F>(\mbox{\hyperlink{cxx11__tensor__map_8cpp_a7f507fea02198f6cb81c86640c7b1a4e}{f}})}
\DoxyCodeLine{00583\ \ \ \ \ ));}
\DoxyCodeLine{00584\ \ \ \}}
\DoxyCodeLine{00585\ \ \ \textcolor{comment}{//\ invalid\ silent\ async\ target}}
\DoxyCodeLine{00586\ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00587\ \ \ \ \ \textcolor{keyword}{static\_assert}(\mbox{\hyperlink{namespacetf_a036d82b3ab21beea2ed89611e2930db7}{dependent\_false\_v<F>}},\ }
\DoxyCodeLine{00588\ \ \ \ \ \ \ \textcolor{stringliteral}{"{}invalid\ silent\_async\ target\ -\/\ must\ be\ one\ of\ the\ following\ types:\(\backslash\)n\(\backslash\)}}
\DoxyCodeLine{00589\ \textcolor{stringliteral}{\ \ \ \ \ \ (1)\ []\ (tf::Runtime\&)\ -\/>\ void\ \{\}\(\backslash\)n\(\backslash\)}}
\DoxyCodeLine{00590\ \textcolor{stringliteral}{\ \ \ \ \ \ (2)\ []\ ()\ -\/>\ auto\ \{\ ...\ return\ ...\ \}\(\backslash\)n"{}}}
\DoxyCodeLine{00591\ \ \ \ \ );}
\DoxyCodeLine{00592\ \ \ \}}
\DoxyCodeLine{00593\ \}}
\DoxyCodeLine{00594\ }
\DoxyCodeLine{00595\ }
\DoxyCodeLine{00596\ \}\ \ \textcolor{comment}{//\ end\ of\ namespace\ tf\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00597\ }
\DoxyCodeLine{00598\ }
\DoxyCodeLine{00599\ }
\DoxyCodeLine{00600\ }
\DoxyCodeLine{00601\ }
\DoxyCodeLine{00602\ }
\DoxyCodeLine{00603\ }
\DoxyCodeLine{00604\ }
\DoxyCodeLine{00605\ }

\end{DoxyCode}
