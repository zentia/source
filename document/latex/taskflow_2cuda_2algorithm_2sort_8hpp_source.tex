\doxysection{sort.\+hpp}
\hypertarget{taskflow_2cuda_2algorithm_2sort_8hpp_source}{}\label{taskflow_2cuda_2algorithm_2sort_8hpp_source}\index{external/taskflow/taskflow/cuda/algorithm/sort.hpp@{external/taskflow/taskflow/cuda/algorithm/sort.hpp}}
\mbox{\hyperlink{taskflow_2cuda_2algorithm_2sort_8hpp}{浏览该文件的文档.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00002\ }
\DoxyCodeLine{00003\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{merge_8hpp}{merge.hpp}}"{}}}
\DoxyCodeLine{00004\ }
\DoxyCodeLine{00009\ }
\DoxyCodeLine{00010\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespacetf_1_1detail}{tf::detail}}\ \{}
\DoxyCodeLine{00011\ }
\DoxyCodeLine{00012\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00013\ \textcolor{comment}{//\ odd-\/even\ sort\ in\ register}}
\DoxyCodeLine{00014\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00015\ }
\DoxyCodeLine{00020\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{namespacetf_1_1detail_a95a5212f3d79eb1bba3ca3f8e373ae16}{cuda\_clz}}(\textcolor{keywordtype}{int}\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}})\ \{}
\DoxyCodeLine{00021\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ =\ 31;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ >=\ 0;\ -\/-\/\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ \{}
\DoxyCodeLine{00022\ \ \ \ \ \textcolor{keywordflow}{if}((1<<\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ \&\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}})\ \{}
\DoxyCodeLine{00023\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 31\ -\/\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}};}
\DoxyCodeLine{00024\ \ \ \ \ \}}
\DoxyCodeLine{00025\ \ \ \}}
\DoxyCodeLine{00026\ \ \ \textcolor{keywordflow}{return}\ 32;}
\DoxyCodeLine{00027\ \}}
\DoxyCodeLine{00028\ }
\DoxyCodeLine{00033\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{namespacetf_1_1detail_a9a76c046987683e12f4a4381d1559a69}{cuda\_find\_log2}}(\textcolor{keywordtype}{int}\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}},\ \textcolor{keywordtype}{bool}\ round\_up\ =\ \textcolor{keyword}{false})\ \{}
\DoxyCodeLine{00034\ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{_cwise__product_8cpp_ad2cbe4616e813eb9af81732dca777b24}{a}}\ =\ 31\ -\/\ \mbox{\hyperlink{namespacetf_1_1detail_a95a5212f3d79eb1bba3ca3f8e373ae16}{cuda\_clz}}(\mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}});}
\DoxyCodeLine{00035\ \ \ \textcolor{keywordflow}{if}(round\_up)\ \{}
\DoxyCodeLine{00036\ \ \ \ \ \mbox{\hyperlink{_cwise__product_8cpp_ad2cbe4616e813eb9af81732dca777b24}{a}}\ +=\ !\mbox{\hyperlink{namespacetf_a8d48a5014f34a9f97aae5269c2367e38}{is\_pow2}}(\mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}});}
\DoxyCodeLine{00037\ \ \ \}}
\DoxyCodeLine{00038\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{_cwise__product_8cpp_ad2cbe4616e813eb9af81732dca777b24}{a}};}
\DoxyCodeLine{00039\ \}}
\DoxyCodeLine{00040\ }
\DoxyCodeLine{00042\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ T,\ \textcolor{keywordtype}{unsigned}\ vt,\ \textcolor{keyword}{typename}\ C>}
\DoxyCodeLine{00043\ \_\_device\_\_\ \textcolor{keyword}{auto}\ \mbox{\hyperlink{namespacetf_1_1detail_a899f77e74e47867dac8c4eb08b92577e}{cuda\_odd\_even\_sort}}(}
\DoxyCodeLine{00044\ \ \ \mbox{\hyperlink{structtf_1_1cuda_array}{cudaArray<T,\ vt>}}\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}},\ \mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}}\ \mbox{\hyperlink{external_2taskflow_2sandbox_2jacobi_2main_8cpp_aaa178026ff13e667efcb0104a55252e7}{comp}},\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{test__split__node_8cpp_afea5520dffc22c33fbcc0eb5f7e3d448}{flags}}\ =\ 0}
\DoxyCodeLine{00045\ )\ \{}
\DoxyCodeLine{00046\ \ \ \mbox{\hyperlink{namespacetf_a55e1e8a489984141bc8e0785cd13f9bc}{cuda\_iterate<vt>}}([\&](\textcolor{keyword}{auto}\ I)\ \{}
\DoxyCodeLine{00047\ \textcolor{preprocessor}{\ \ \ \ \#pragma\ unroll}}
\DoxyCodeLine{00048\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ =\ 1\ \&\ I;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ <\ vt\ -\/\ 1;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ +=\ 2)\ \{}
\DoxyCodeLine{00049\ \ \ \ \ \ \ \textcolor{keywordflow}{if}((0\ ==\ ((2<<\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ \&\ \mbox{\hyperlink{test__split__node_8cpp_afea5520dffc22c33fbcc0eb5f7e3d448}{flags}}))\ \&\&\ \mbox{\hyperlink{external_2taskflow_2sandbox_2jacobi_2main_8cpp_aaa178026ff13e667efcb0104a55252e7}{comp}}(\mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ +\ 1],\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}]))}
\DoxyCodeLine{00050\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacetf_ae7b4a888f7b8a530c63dd1d96b5b5862}{cuda\_swap}}(\mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}],\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ +\ 1]);}
\DoxyCodeLine{00051\ \ \ \ \ \}}
\DoxyCodeLine{00052\ \ \ \});}
\DoxyCodeLine{00053\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}};}
\DoxyCodeLine{00054\ \}}
\DoxyCodeLine{00055\ }
\DoxyCodeLine{00057\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ K,\ \textcolor{keyword}{typename}\ V,\ \textcolor{keywordtype}{unsigned}\ vt,\ \textcolor{keyword}{typename}\ C>}
\DoxyCodeLine{00058\ \_\_device\_\_\ \textcolor{keyword}{auto}\ \mbox{\hyperlink{namespacetf_1_1detail_a899f77e74e47867dac8c4eb08b92577e}{cuda\_odd\_even\_sort}}(}
\DoxyCodeLine{00059\ \ \ \mbox{\hyperlink{structtf_1_1cuda_k_v_array}{cudaKVArray<K,\ V,\ vt>}}\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}},\ \mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}}\ \mbox{\hyperlink{external_2taskflow_2sandbox_2jacobi_2main_8cpp_aaa178026ff13e667efcb0104a55252e7}{comp}},\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{test__split__node_8cpp_afea5520dffc22c33fbcc0eb5f7e3d448}{flags}}\ =\ 0}
\DoxyCodeLine{00060\ )\ \{}
\DoxyCodeLine{00061\ \ \ \mbox{\hyperlink{namespacetf_a55e1e8a489984141bc8e0785cd13f9bc}{cuda\_iterate<vt>}}([\&](\textcolor{keyword}{auto}\ I)\ \{}
\DoxyCodeLine{00062\ \textcolor{preprocessor}{\ \ \ \ \#pragma\ unroll}}
\DoxyCodeLine{00063\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ =\ 1\ \&\ I;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ <\ vt\ -\/\ 1;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ +=\ 2)\ \{}
\DoxyCodeLine{00064\ \ \ \ \ \ \ \textcolor{keywordflow}{if}((0\ ==\ ((2<<\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ \&\ \mbox{\hyperlink{test__split__node_8cpp_afea5520dffc22c33fbcc0eb5f7e3d448}{flags}}))\ \&\&\ \mbox{\hyperlink{external_2taskflow_2sandbox_2jacobi_2main_8cpp_aaa178026ff13e667efcb0104a55252e7}{comp}}(\mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}}.keys[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ +\ 1],\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}}.keys[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}]))\ \{}
\DoxyCodeLine{00065\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacetf_ae7b4a888f7b8a530c63dd1d96b5b5862}{cuda\_swap}}(\mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}}.keys[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}],\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}}.keys[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ +\ 1]);}
\DoxyCodeLine{00066\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacetf_ae7b4a888f7b8a530c63dd1d96b5b5862}{cuda\_swap}}(\mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}}.vals[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}],\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}}.vals[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ +\ 1]);}
\DoxyCodeLine{00067\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00068\ \ \ \ \ \}}
\DoxyCodeLine{00069\ \ \ \});}
\DoxyCodeLine{00070\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}};}
\DoxyCodeLine{00071\ \}}
\DoxyCodeLine{00072\ }
\DoxyCodeLine{00073\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00074\ \textcolor{comment}{//\ range\ check}}
\DoxyCodeLine{00075\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00076\ }
\DoxyCodeLine{00078\ \_\_device\_\_\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{namespacetf_1_1detail_a2b01469cc11053017b1cfea2a6409057}{cuda\_out\_of\_range\_flags}}(\textcolor{keywordtype}{int}\ first,\ \textcolor{keywordtype}{int}\ vt,\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}})\ \{}
\DoxyCodeLine{00079\ \ \ \textcolor{keywordtype}{int}\ out\_of\_range\ =\ \mbox{\hyperlink{datatypes_8h_ac6afabdc09a49a433ee19d8a9486056d}{min}}(vt,\ first\ +\ vt\ -\/\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}});}
\DoxyCodeLine{00080\ \ \ \textcolor{keywordtype}{int}\ head\_flags\ =\ 0;}
\DoxyCodeLine{00081\ \ \ \textcolor{keywordflow}{if}(out\_of\_range\ >\ 0)\ \{}
\DoxyCodeLine{00082\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{ittnotify__static_8h_a2dea65f740c088e6408d62d6a9500c9e}{mask}}\ =\ (1<<\ vt)\ -\/\ 1;}
\DoxyCodeLine{00083\ \ \ \ \ head\_flags\ =\ \mbox{\hyperlink{ittnotify__static_8h_a2dea65f740c088e6408d62d6a9500c9e}{mask}}\ \&\ (\mbox{\hyperlink{ittnotify__static_8h_a2dea65f740c088e6408d62d6a9500c9e}{\string~mask}}>>\ out\_of\_range);}
\DoxyCodeLine{00084\ \ \ \}}
\DoxyCodeLine{00085\ \ \ \textcolor{keywordflow}{return}\ head\_flags;}
\DoxyCodeLine{00086\ \}}
\DoxyCodeLine{00087\ }
\DoxyCodeLine{00089\ \_\_device\_\_\ \textcolor{keyword}{inline}\ \textcolor{keyword}{auto}\ \mbox{\hyperlink{namespacetf_1_1detail_af2d7d0e939a7d1a07ced94221a24683c}{cuda\_compute\_merge\_sort\_frame}}(}
\DoxyCodeLine{00090\ \ \ \textcolor{keywordtype}{unsigned}\ partition,\ \textcolor{keywordtype}{unsigned}\ coop,\ \textcolor{keywordtype}{unsigned}\ spacing}
\DoxyCodeLine{00091\ )\ \{}
\DoxyCodeLine{00092\ }
\DoxyCodeLine{00093\ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}}\ =\ spacing\ *\ (coop\ /\ 2);}
\DoxyCodeLine{00094\ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{cpq__pdes_8cpp_a455a4d1d80a69762a133ad026f1cba43}{start}}\ =\ \string~(coop\ -\/\ 1)\ \&\ partition;}
\DoxyCodeLine{00095\ \ \ \textcolor{keywordtype}{unsigned}\ a\_begin\ =\ spacing\ *\ \mbox{\hyperlink{cpq__pdes_8cpp_a455a4d1d80a69762a133ad026f1cba43}{start}};}
\DoxyCodeLine{00096\ \ \ \textcolor{keywordtype}{unsigned}\ b\_begin\ =\ spacing\ *\ \mbox{\hyperlink{cpq__pdes_8cpp_a455a4d1d80a69762a133ad026f1cba43}{start}}\ +\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}};}
\DoxyCodeLine{00097\ }
\DoxyCodeLine{00098\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structtf_1_1detail_1_1cuda_merge_range}{cudaMergeRange}}\ \{}
\DoxyCodeLine{00099\ \ \ \ \ a\_begin,}
\DoxyCodeLine{00100\ \ \ \ \ a\_begin\ +\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}},}
\DoxyCodeLine{00101\ \ \ \ \ b\_begin,}
\DoxyCodeLine{00102\ \ \ \ \ b\_begin\ +\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}}}
\DoxyCodeLine{00103\ \ \ \};}
\DoxyCodeLine{00104\ \}}
\DoxyCodeLine{00105\ }
\DoxyCodeLine{00107\ \_\_device\_\_\ \textcolor{keyword}{inline}\ \textcolor{keyword}{auto}\ \mbox{\hyperlink{namespacetf_1_1detail_a1a8d810065126154d47114e93bbfea57}{cuda\_compute\_merge\_sort\_range}}(}
\DoxyCodeLine{00108\ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}},\ \textcolor{keywordtype}{unsigned}\ partition,\ \textcolor{keywordtype}{unsigned}\ coop,\ \textcolor{keywordtype}{unsigned}\ spacing}
\DoxyCodeLine{00109\ )\ \{}
\DoxyCodeLine{00110\ }
\DoxyCodeLine{00111\ \ \ \textcolor{keyword}{auto}\ \mbox{\hyperlink{structframe}{frame}}\ =\ \mbox{\hyperlink{namespacetf_1_1detail_af2d7d0e939a7d1a07ced94221a24683c}{cuda\_compute\_merge\_sort\_frame}}(partition,\ coop,\ spacing);}
\DoxyCodeLine{00112\ }
\DoxyCodeLine{00113\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structtf_1_1detail_1_1cuda_merge_range}{cudaMergeRange}}\ \{}
\DoxyCodeLine{00114\ \ \ \ \ \mbox{\hyperlink{structframe}{frame}}.a\_begin,}
\DoxyCodeLine{00115\ \ \ \ \ \mbox{\hyperlink{datatypes_8h_ac6afabdc09a49a433ee19d8a9486056d}{min}}(\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}},\ \mbox{\hyperlink{structframe}{frame}}.a\_end),}
\DoxyCodeLine{00116\ \ \ \ \ \mbox{\hyperlink{datatypes_8h_ac6afabdc09a49a433ee19d8a9486056d}{min}}(\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}},\ \mbox{\hyperlink{structframe}{frame}}.b\_begin),}
\DoxyCodeLine{00117\ \ \ \ \ \mbox{\hyperlink{datatypes_8h_ac6afabdc09a49a433ee19d8a9486056d}{min}}(\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}},\ \mbox{\hyperlink{structframe}{frame}}.b\_end)}
\DoxyCodeLine{00118\ \ \ \};}
\DoxyCodeLine{00119\ \}}
\DoxyCodeLine{00120\ }
\DoxyCodeLine{00122\ \_\_device\_\_\ \textcolor{keyword}{inline}\ \textcolor{keyword}{auto}\ \mbox{\hyperlink{namespacetf_1_1detail_a1a8d810065126154d47114e93bbfea57}{cuda\_compute\_merge\_sort\_range}}(}
\DoxyCodeLine{00123\ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}},\ \textcolor{keywordtype}{unsigned}\ partition,\ \textcolor{keywordtype}{unsigned}\ coop,\ \textcolor{keywordtype}{unsigned}\ spacing,}
\DoxyCodeLine{00124\ \ \ \textcolor{keywordtype}{unsigned}\ mp0,\ \textcolor{keywordtype}{unsigned}\ mp1}
\DoxyCodeLine{00125\ )\ \{}
\DoxyCodeLine{00126\ }
\DoxyCodeLine{00127\ \ \ \textcolor{keyword}{auto}\ range\ =\ \mbox{\hyperlink{namespacetf_1_1detail_a1a8d810065126154d47114e93bbfea57}{cuda\_compute\_merge\_sort\_range}}(\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}},\ partition,\ coop,\ spacing);}
\DoxyCodeLine{00128\ }
\DoxyCodeLine{00129\ \ \ \textcolor{comment}{//\ Locate\ the\ diagonal\ from\ the\ start\ of\ the\ A\ sublist.}}
\DoxyCodeLine{00130\ \ \ \textcolor{keywordtype}{unsigned}\ diag\ =\ spacing\ *\ partition\ -\/\ range.a\_begin;}
\DoxyCodeLine{00131\ }
\DoxyCodeLine{00132\ \ \ \textcolor{comment}{//\ The\ end\ partition\ of\ the\ last\ cta\ for\ each\ merge\ operation\ is\ computed}}
\DoxyCodeLine{00133\ \ \ \textcolor{comment}{//\ and\ stored\ as\ the\ begin\ partition\ for\ the\ subsequent\ merge.\ i.e.\ it\ is}}
\DoxyCodeLine{00134\ \ \ \textcolor{comment}{//\ the\ same\ partition\ but\ in\ the\ wrong\ coordinate\ system,\ so\ its\ 0\ when\ it}}
\DoxyCodeLine{00135\ \ \ \textcolor{comment}{//\ should\ be\ listSize.\ Correct\ that\ by\ checking\ if\ this\ is\ the\ last\ cta}}
\DoxyCodeLine{00136\ \ \ \textcolor{comment}{//\ in\ this\ merge\ operation.}}
\DoxyCodeLine{00137\ \ \ \textcolor{keywordflow}{if}(coop\ -\/\ 1\ !=\ ((coop\ -\/\ 1)\ \&\ partition))\ \{}
\DoxyCodeLine{00138\ \ \ \ \ range.a\_end\ =\ range.a\_begin\ +\ mp1;}
\DoxyCodeLine{00139\ \ \ \ \ range.b\_end\ =\ \mbox{\hyperlink{datatypes_8h_ac6afabdc09a49a433ee19d8a9486056d}{min}}(\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}},\ range.b\_begin\ +\ diag\ +\ spacing\ -\/\ mp1);}
\DoxyCodeLine{00140\ \ \ \}}
\DoxyCodeLine{00141\ }
\DoxyCodeLine{00142\ \ \ range.a\_begin\ =\ range.a\_begin\ +\ mp0;}
\DoxyCodeLine{00143\ \ \ range.b\_begin\ =\ \mbox{\hyperlink{datatypes_8h_ac6afabdc09a49a433ee19d8a9486056d}{min}}(\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}},\ range.b\_begin\ +\ diag\ -\/\ mp0);}
\DoxyCodeLine{00144\ }
\DoxyCodeLine{00145\ \ \ \textcolor{keywordflow}{return}\ range;}
\DoxyCodeLine{00146\ \}}
\DoxyCodeLine{00147\ }
\DoxyCodeLine{00149\ \textcolor{keyword}{template}<\textcolor{keywordtype}{unsigned}\ nt,\ \textcolor{keywordtype}{unsigned}\ vt,\ \textcolor{keyword}{typename}\ K,\ \textcolor{keyword}{typename}\ V>}
\DoxyCodeLine{00150\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structtf_1_1detail_1_1cuda_block_sort}{cudaBlockSort}}\ \{}
\DoxyCodeLine{00151\ }
\DoxyCodeLine{00152\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{structtf_1_1detail_1_1cuda_block_sort_ab08e7fc6dcfebd4c091bf742558a004e}{has\_values}}\ =\ !std::is\_same<V,\ cudaEmpty>::value;}
\DoxyCodeLine{00153\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{structtf_1_1detail_1_1cuda_block_sort_a09986d68c8c99159902e9c2ab9182079}{num\_passes}}\ =\ \mbox{\hyperlink{namespacetf_a908e0f3faf873e897b3e1bafbd4bb876}{static\_floor\_log2<nt>}}();}
\DoxyCodeLine{00154\ }
\DoxyCodeLine{00156\ \ \ \textcolor{keyword}{union\ }\mbox{\hyperlink{uniontf_1_1detail_1_1cuda_block_sort_1_1_storage}{Storage}}\ \{}
\DoxyCodeLine{00157\ \ \ \ \ K\ \mbox{\hyperlink{uniontf_1_1detail_1_1cuda_block_sort_1_1_storage_a08bff3542e11e199012d1ca64b14881c}{keys}}[nt\ *\ vt\ +\ 1];}
\DoxyCodeLine{00158\ \ \ \ \ \mbox{\hyperlink{_eigen_solver___eigen_solver___matrix_type_8cpp_a77c224aa52b434918ce65c33175aa8ad}{V}}\ \mbox{\hyperlink{uniontf_1_1detail_1_1cuda_block_sort_1_1_storage_a45d6a1f7e31ddb9905bc4c802f7e3e7a}{vals}}[nt\ *\ vt];}
\DoxyCodeLine{00159\ \ \ \};}
\DoxyCodeLine{00160\ }
\DoxyCodeLine{00161\ \ \ \textcolor{keyword}{static\_assert}(\mbox{\hyperlink{namespacetf_a8d48a5014f34a9f97aae5269c2367e38}{is\_pow2}}(nt),\ \textcolor{stringliteral}{"{}cudaBlockSort\ requires\ pow2\ number\ of\ threads"{}});}
\DoxyCodeLine{00162\ }
\DoxyCodeLine{00163\ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ C>}
\DoxyCodeLine{00164\ \ \ \_\_device\_\_\ \textcolor{keyword}{auto}\ \mbox{\hyperlink{structtf_1_1detail_1_1cuda_block_sort_a8a4821a2ba1e2412cfa78ae5f8fbfb5e}{merge\_pass}}(}
\DoxyCodeLine{00165\ \ \ \ \ \mbox{\hyperlink{structtf_1_1cuda_k_v_array}{cudaKVArray<K,\ V,\ vt>}}\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}},}
\DoxyCodeLine{00166\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ tid,\ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}},\ \textcolor{keywordtype}{unsigned}\ pass,}
\DoxyCodeLine{00167\ \ \ \ \ \mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}}\ \mbox{\hyperlink{external_2taskflow_2sandbox_2jacobi_2main_8cpp_aaa178026ff13e667efcb0104a55252e7}{comp}},\ \mbox{\hyperlink{uniontf_1_1detail_1_1cuda_block_sort_1_1_storage}{Storage}}\&\ storage}
\DoxyCodeLine{00168\ \ \ )\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00169\ }
\DoxyCodeLine{00170\ \ \ \ \ \textcolor{comment}{//\ Divide\ the\ CTA's\ keys\ into\ lists.}}
\DoxyCodeLine{00171\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ coop\ =\ 2\ <<\ pass;}
\DoxyCodeLine{00172\ \ \ \ \ \textcolor{keyword}{auto}\ range\ =\ \mbox{\hyperlink{namespacetf_1_1detail_a1a8d810065126154d47114e93bbfea57}{cuda\_compute\_merge\_sort\_range}}(\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}},\ tid,\ coop,\ vt);}
\DoxyCodeLine{00173\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ diag\ =\ vt\ *\ tid\ -\/\ range.a\_begin;}
\DoxyCodeLine{00174\ }
\DoxyCodeLine{00175\ \ \ \ \ \textcolor{comment}{//\ Store\ the\ keys\ into\ shared\ memory\ for\ searching.}}
\DoxyCodeLine{00176\ \ \ \ \ \mbox{\hyperlink{namespacetf_acd55bba23e1c41278644438a91cf218b}{cuda\_reg\_to\_shared\_thread<nt,\ vt>}}(\mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}}.keys,\ tid,\ storage.\mbox{\hyperlink{uniontf_1_1detail_1_1cuda_block_sort_1_1_storage_a08bff3542e11e199012d1ca64b14881c}{keys}});}
\DoxyCodeLine{00177\ }
\DoxyCodeLine{00178\ \ \ \ \ \textcolor{comment}{//\ Search\ for\ the\ merge\ path\ for\ this\ thread\ within\ its\ list.}}
\DoxyCodeLine{00179\ \ \ \ \ \textcolor{keyword}{auto}\ \mbox{\hyperlink{namespaceboost_1_1multiprecision}{mp}}\ =\ \mbox{\hyperlink{namespacetf_1_1detail_ae9d3db5c9457ebec7cbdd3a3d8c65e94}{cuda\_merge\_path<cudaMergeBoundType::LOWER>}}(}
\DoxyCodeLine{00180\ \ \ \ \ \ \ storage.\mbox{\hyperlink{uniontf_1_1detail_1_1cuda_block_sort_1_1_storage_a08bff3542e11e199012d1ca64b14881c}{keys}},\ range,\ diag,\ \mbox{\hyperlink{external_2taskflow_2sandbox_2jacobi_2main_8cpp_aaa178026ff13e667efcb0104a55252e7}{comp}}}
\DoxyCodeLine{00181\ \ \ \ \ );}
\DoxyCodeLine{00182\ }
\DoxyCodeLine{00183\ \ \ \ \ \textcolor{comment}{//\ Run\ a\ serial\ merge\ and\ return.}}
\DoxyCodeLine{00184\ \ \ \ \ \textcolor{keyword}{auto}\ merge\ =\ \mbox{\hyperlink{namespacetf_1_1detail_a9d4d00a3dbc0158eac24e4603548bdbd}{cuda\_serial\_merge<cudaMergeBoundType::LOWER,\ vt>}}(}
\DoxyCodeLine{00185\ \ \ \ \ \ \ storage.\mbox{\hyperlink{uniontf_1_1detail_1_1cuda_block_sort_1_1_storage_a08bff3542e11e199012d1ca64b14881c}{keys}},\ range.partition(\mbox{\hyperlink{namespaceboost_1_1multiprecision}{mp}},\ diag),\ \mbox{\hyperlink{external_2taskflow_2sandbox_2jacobi_2main_8cpp_aaa178026ff13e667efcb0104a55252e7}{comp}}}
\DoxyCodeLine{00186\ \ \ \ \ );}
\DoxyCodeLine{00187\ \ \ \ \ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}}.keys\ =\ merge.keys;}
\DoxyCodeLine{00188\ }
\DoxyCodeLine{00189\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{structtf_1_1detail_1_1cuda_block_sort_ab08e7fc6dcfebd4c091bf742558a004e}{has\_values}})\ \{}
\DoxyCodeLine{00190\ \ \ \ \ \ \ \textcolor{comment}{//\ Reorder\ values\ through\ shared\ memory.}}
\DoxyCodeLine{00191\ \ \ \ \ \ \ \mbox{\hyperlink{namespacetf_acd55bba23e1c41278644438a91cf218b}{cuda\_reg\_to\_shared\_thread<nt,\ vt>}}(\mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}}.vals,\ tid,\ storage.\mbox{\hyperlink{uniontf_1_1detail_1_1cuda_block_sort_1_1_storage_a45d6a1f7e31ddb9905bc4c802f7e3e7a}{vals}});}
\DoxyCodeLine{00192\ \ \ \ \ \ \ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}}.vals\ =\ \mbox{\hyperlink{namespacetf_a2f05fa9a07c8c88641da1db69d4d5707}{cuda\_shared\_gather<nt,\ vt>}}(storage.\mbox{\hyperlink{uniontf_1_1detail_1_1cuda_block_sort_1_1_storage_a45d6a1f7e31ddb9905bc4c802f7e3e7a}{vals}},\ merge.indices);}
\DoxyCodeLine{00193\ \ \ \ \ \}}
\DoxyCodeLine{00194\ }
\DoxyCodeLine{00195\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}};}
\DoxyCodeLine{00196\ \ \ \}}
\DoxyCodeLine{00197\ }
\DoxyCodeLine{00198\ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ C>}
\DoxyCodeLine{00199\ \ \ \_\_device\_\_\ \textcolor{keyword}{auto}\ \mbox{\hyperlink{structtf_1_1detail_1_1cuda_block_sort_a79d7cd8115842d64e15b91bb7f6c31a7}{block\_sort}}(\mbox{\hyperlink{structtf_1_1cuda_k_v_array}{cudaKVArray<K,\ V,\ vt>}}\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}},}
\DoxyCodeLine{00200\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ tid,\ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}},\ \mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}}\ \mbox{\hyperlink{external_2taskflow_2sandbox_2jacobi_2main_8cpp_aaa178026ff13e667efcb0104a55252e7}{comp}},\ \mbox{\hyperlink{uniontf_1_1detail_1_1cuda_block_sort_1_1_storage}{Storage}}\&\ storage}
\DoxyCodeLine{00201\ \ \ )\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00202\ }
\DoxyCodeLine{00203\ \ \ \ \ \textcolor{comment}{//\ Sort\ the\ inputs\ within\ each\ thread.\ If\ any\ threads\ have\ fewer\ than}}
\DoxyCodeLine{00204\ \ \ \ \ \textcolor{comment}{//\ vt\ items,\ use\ the\ segmented\ sort\ network\ to\ prevent\ out-\/of-\/range}}
\DoxyCodeLine{00205\ \ \ \ \ \textcolor{comment}{//\ elements\ from\ contaminating\ the\ sort.}}
\DoxyCodeLine{00206\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}}\ <\ nt\ *\ vt)\ \{}
\DoxyCodeLine{00207\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ head\_flags\ =\ \mbox{\hyperlink{namespacetf_1_1detail_a2b01469cc11053017b1cfea2a6409057}{cuda\_out\_of\_range\_flags}}(vt\ *\ tid,\ vt,\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}});}
\DoxyCodeLine{00208\ \ \ \ \ \ \ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}}\ =\ \mbox{\hyperlink{namespacetf_1_1detail_a899f77e74e47867dac8c4eb08b92577e}{cuda\_odd\_even\_sort}}(\mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}},\ \mbox{\hyperlink{external_2taskflow_2sandbox_2jacobi_2main_8cpp_aaa178026ff13e667efcb0104a55252e7}{comp}},\ head\_flags);}
\DoxyCodeLine{00209\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00210\ \ \ \ \ \ \ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}}\ =\ \mbox{\hyperlink{namespacetf_1_1detail_a899f77e74e47867dac8c4eb08b92577e}{cuda\_odd\_even\_sort}}(\mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}},\ \mbox{\hyperlink{external_2taskflow_2sandbox_2jacobi_2main_8cpp_aaa178026ff13e667efcb0104a55252e7}{comp}});}
\DoxyCodeLine{00211\ \ \ \ \ \}}
\DoxyCodeLine{00212\ }
\DoxyCodeLine{00213\ \ \ \ \ \textcolor{comment}{//\ Merge\ threads\ starting\ with\ a\ pair\ until\ all\ values\ are\ merged.}}
\DoxyCodeLine{00214\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ pass\ =\ 0;\ pass\ <\ \mbox{\hyperlink{structtf_1_1detail_1_1cuda_block_sort_a09986d68c8c99159902e9c2ab9182079}{num\_passes}};\ ++pass)\ \{}
\DoxyCodeLine{00215\ \ \ \ \ \ \ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}}\ =\ \mbox{\hyperlink{structtf_1_1detail_1_1cuda_block_sort_a8a4821a2ba1e2412cfa78ae5f8fbfb5e}{merge\_pass}}(\mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}},\ tid,\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}},\ pass,\ \mbox{\hyperlink{external_2taskflow_2sandbox_2jacobi_2main_8cpp_aaa178026ff13e667efcb0104a55252e7}{comp}},\ storage);}
\DoxyCodeLine{00216\ \ \ \ \ \}}
\DoxyCodeLine{00217\ }
\DoxyCodeLine{00218\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}};}
\DoxyCodeLine{00219\ \ \ \}}
\DoxyCodeLine{00220\ \};}
\DoxyCodeLine{00221\ }
\DoxyCodeLine{00223\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ P,\ \textcolor{keyword}{typename}\ K,\ \textcolor{keyword}{typename}\ C>}
\DoxyCodeLine{00224\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{namespacetf_1_1detail_ab4d357fb63d82334ea784ee72beaf600}{cuda\_merge\_sort\_partitions}}(}
\DoxyCodeLine{00225\ \ \ \mbox{\hyperlink{namespace_p}{P}}\&\&\ \mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}},\ K\ keys,\ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}},}
\DoxyCodeLine{00226\ \ \ \textcolor{keywordtype}{unsigned}\ coop,\ \textcolor{keywordtype}{unsigned}\ spacing,\ \mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}}\ \mbox{\hyperlink{external_2taskflow_2sandbox_2jacobi_2main_8cpp_aaa178026ff13e667efcb0104a55252e7}{comp}},\ \textcolor{keywordtype}{unsigned}*\ buf}
\DoxyCodeLine{00227\ )\ \{}
\DoxyCodeLine{00228\ }
\DoxyCodeLine{00229\ \ \ \textcolor{comment}{//\ buffer\ size\ is\ num\_partitions\ +\ 1}}
\DoxyCodeLine{00230\ \ \ \textcolor{keywordtype}{unsigned}\ num\_partitions\ =\ (\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}}\ +\ spacing\ -\/\ 1)\ /\ spacing\ +\ 1;}
\DoxyCodeLine{00231\ }
\DoxyCodeLine{00232\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ nt\ =\ 128;}
\DoxyCodeLine{00233\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ vt\ =\ 1;}
\DoxyCodeLine{00234\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ nv\ =\ nt\ *\ vt;}
\DoxyCodeLine{00235\ }
\DoxyCodeLine{00236\ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{bench__gemm_8cpp_a37a83060ac796961b44991c836f083f7}{B}}\ =\ (num\_partitions\ +\ nv\ -\/\ 1)\ /\ nv;\ \ \textcolor{comment}{//\ nt\ =\ 128,\ vt\ =\ 1}}
\DoxyCodeLine{00237\ }
\DoxyCodeLine{00238\ \ \ \mbox{\hyperlink{namespacetf_a2fa23f4109147679d05a25ee952c4baf}{cuda\_kernel}}<<<\mbox{\hyperlink{bench__gemm_8cpp_a37a83060ac796961b44991c836f083f7}{B}},\ nt,\ 0,\ \mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}}.stream()>>>([=]\ \_\_device\_\_\ (\textcolor{keyword}{auto}\ tid,\ \textcolor{keyword}{auto}\ bid)\ \{}
\DoxyCodeLine{00239\ \ \ \ \ \textcolor{keyword}{auto}\ range\ =\ \mbox{\hyperlink{namespacetf_a5a41760b383016bd1cebadcfd7f05476}{cuda\_get\_tile}}(bid,\ nt\ *\ vt,\ num\_partitions);}
\DoxyCodeLine{00240\ \ \ \ \ \mbox{\hyperlink{namespacetf_a24db9e13fd26535886a7efc723ec1477}{cuda\_strided\_iterate<nt,\ vt>}}([=](\textcolor{keyword}{auto},\ \textcolor{keyword}{auto}\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}})\ \{}
\DoxyCodeLine{00241\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ab47dd9958bcadea08866b42bf358e95e}{index}}\ =\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}\ +\ range.begin;}
\DoxyCodeLine{00242\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ range\ =\ \mbox{\hyperlink{namespacetf_1_1detail_a1a8d810065126154d47114e93bbfea57}{cuda\_compute\_merge\_sort\_range}}(\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}},\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ab47dd9958bcadea08866b42bf358e95e}{index}},\ coop,\ spacing);}
\DoxyCodeLine{00243\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ diag\ =\ \mbox{\hyperlink{datatypes_8h_ac6afabdc09a49a433ee19d8a9486056d}{min}}(spacing\ *\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ab47dd9958bcadea08866b42bf358e95e}{index}},\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}})\ -\/\ range.a\_begin;}
\DoxyCodeLine{00244\ \ \ \ \ \ \ buf[\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ab47dd9958bcadea08866b42bf358e95e}{index}}]\ =\ \mbox{\hyperlink{namespacetf_1_1detail_ae9d3db5c9457ebec7cbdd3a3d8c65e94}{cuda\_merge\_path<cudaMergeBoundType::LOWER>}}(}
\DoxyCodeLine{00245\ \ \ \ \ \ \ \ \ keys\ +\ range.a\_begin,\ range.a\_count(),}
\DoxyCodeLine{00246\ \ \ \ \ \ \ \ \ keys\ +\ range.b\_begin,\ range.b\_count(),}
\DoxyCodeLine{00247\ \ \ \ \ \ \ \ \ diag,\ \mbox{\hyperlink{external_2taskflow_2sandbox_2jacobi_2main_8cpp_aaa178026ff13e667efcb0104a55252e7}{comp}}}
\DoxyCodeLine{00248\ \ \ \ \ \ \ );}
\DoxyCodeLine{00249\ \ \ \ \ \},\ tid,\ range.count());}
\DoxyCodeLine{00250\ \ \ \});}
\DoxyCodeLine{00251\ \}}
\DoxyCodeLine{00252\ }
\DoxyCodeLine{00254\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ P,\ \textcolor{keyword}{typename}\ K\_it,\ \textcolor{keyword}{typename}\ V\_it,\ \textcolor{keyword}{typename}\ C>}
\DoxyCodeLine{00255\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{namespacetf_1_1detail_a1d70c013b280d4f811275e892af15c18}{merge\_sort\_loop}}(}
\DoxyCodeLine{00256\ \ \ \mbox{\hyperlink{namespace_p}{P}}\&\&\ \mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}},\ K\_it\ keys\_input,\ V\_it\ vals\_input,\ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}},\ \mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}}\ \mbox{\hyperlink{external_2taskflow_2sandbox_2jacobi_2main_8cpp_aaa178026ff13e667efcb0104a55252e7}{comp}},\ \textcolor{keywordtype}{void}*\ buf}
\DoxyCodeLine{00257\ )\ \{}
\DoxyCodeLine{00258\ }
\DoxyCodeLine{00259\ \ \ \textcolor{keyword}{using\ }K\ =\ \textcolor{keyword}{typename}\ std::iterator\_traits<K\_it>::value\_type;}
\DoxyCodeLine{00260\ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{_eigen_solver___eigen_solver___matrix_type_8cpp_a77c224aa52b434918ce65c33175aa8ad}{V}}\ =\ \textcolor{keyword}{typename}\ std::iterator\_traits<V\_it>::value\_type;}
\DoxyCodeLine{00261\ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{sandbox_2strassen_2omp_8cpp_a4bfa035cad7c3258704669810cd5de5d}{E}}\ =\ std::decay\_t<P>;}
\DoxyCodeLine{00262\ }
\DoxyCodeLine{00263\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ has\_values\ =\ !std::is\_same<V,\ cudaEmpty>::value;}
\DoxyCodeLine{00264\ }
\DoxyCodeLine{00265\ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{bench__gemm_8cpp_a37a83060ac796961b44991c836f083f7}{B}}\ =\ (\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}}\ +\ E::nv\ -\/\ 1)\ /\ E::nv;}
\DoxyCodeLine{00266\ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{test__broadcast__node_8cpp_a554e63228b946db0d44c4f398b18e212}{R}}\ =\ \mbox{\hyperlink{namespacetf_1_1detail_a9a76c046987683e12f4a4381d1559a69}{cuda\_find\_log2}}(\mbox{\hyperlink{bench__gemm_8cpp_a37a83060ac796961b44991c836f083f7}{B}},\ \textcolor{keyword}{true});}
\DoxyCodeLine{00267\ }
\DoxyCodeLine{00268\ \ \ K*\ keys\_output\ \ \ \ \{\textcolor{keyword}{nullptr}\};}
\DoxyCodeLine{00269\ \ \ \mbox{\hyperlink{_eigen_solver___eigen_solver___matrix_type_8cpp_a77c224aa52b434918ce65c33175aa8ad}{V}}*\ vals\_output\ \ \ \ \{\textcolor{keyword}{nullptr}\};}
\DoxyCodeLine{00270\ \ \ \textcolor{keywordtype}{unsigned}\ *mp\_data\ \{\textcolor{keyword}{nullptr}\};}
\DoxyCodeLine{00271\ }
\DoxyCodeLine{00272\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{test__broadcast__node_8cpp_a554e63228b946db0d44c4f398b18e212}{R}})\ \{}
\DoxyCodeLine{00273\ \ \ \ \ keys\_output\ =\ (K*)(buf);}
\DoxyCodeLine{00274\ \ \ \ \ \textcolor{keywordflow}{if}(has\_values)\ \{}
\DoxyCodeLine{00275\ \ \ \ \ \ \ vals\_output\ =\ (\mbox{\hyperlink{_eigen_solver___eigen_solver___matrix_type_8cpp_a77c224aa52b434918ce65c33175aa8ad}{V}}*)(keys\_output\ +\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}});}
\DoxyCodeLine{00276\ \ \ \ \ \ \ mp\_data\ =\ (\textcolor{keywordtype}{unsigned}*)(vals\_output\ +\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}});}
\DoxyCodeLine{00277\ \ \ \ \ \}}
\DoxyCodeLine{00278\ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00279\ \ \ \ \ \ \ mp\_data\ =\ (\textcolor{keywordtype}{unsigned}*)(keys\_output\ +\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}});}
\DoxyCodeLine{00280\ \ \ \ \ \}}
\DoxyCodeLine{00281\ \ \ \}}
\DoxyCodeLine{00282\ }
\DoxyCodeLine{00283\ \ \ \textcolor{comment}{//cudaDeviceVector<K>\ keys\_temp(R\ ?\ count\ :\ 0);}}
\DoxyCodeLine{00284\ \ \ \textcolor{comment}{//auto\ keys\_output\ =\ keys\_temp.data();}}
\DoxyCodeLine{00286\ }
\DoxyCodeLine{00287\ \ \ \textcolor{comment}{//cudaDeviceVector<V>\ vals\_temp((has\_values\ \&\&\ R)\ ?\ count\ :\ 0);}}
\DoxyCodeLine{00288\ \ \ \textcolor{comment}{//auto\ vals\_output\ =\ vals\_temp.data();}}
\DoxyCodeLine{00289\ \ \ \textcolor{comment}{//std::cout\ <<\ "{}vals\_output\ =\ "{}\ <<\ vals\_temp.size()*sizeof(V)\ <<\ std::endl;}}
\DoxyCodeLine{00290\ }
\DoxyCodeLine{00291\ \ \ \textcolor{keyword}{auto}\ keys\_blocksort\ =\ (1\ \&\ \mbox{\hyperlink{test__broadcast__node_8cpp_a554e63228b946db0d44c4f398b18e212}{R}})\ ?\ keys\_output\ :\ keys\_input;}
\DoxyCodeLine{00292\ \ \ \textcolor{keyword}{auto}\ vals\_blocksort\ =\ (1\ \&\ \mbox{\hyperlink{test__broadcast__node_8cpp_a554e63228b946db0d44c4f398b18e212}{R}})\ ?\ vals\_output\ :\ vals\_input;}
\DoxyCodeLine{00293\ }
\DoxyCodeLine{00294\ \ \ \textcolor{comment}{//printf("{}B=\%u,\ R=\%u\(\backslash\)n"{},\ B,\ R);}}
\DoxyCodeLine{00295\ }
\DoxyCodeLine{00296\ \ \ \mbox{\hyperlink{namespacetf_a2fa23f4109147679d05a25ee952c4baf}{cuda\_kernel}}<<<\mbox{\hyperlink{bench__gemm_8cpp_a37a83060ac796961b44991c836f083f7}{B}},\ E::nt,\ 0,\ \mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}}.stream()>>>([=]\ \_\_device\_\_\ (\textcolor{keyword}{auto}\ tid,\ \textcolor{keyword}{auto}\ bid)\ \{}
\DoxyCodeLine{00297\ }
\DoxyCodeLine{00298\ \ \ \ \ \textcolor{keyword}{using\ }sort\_t\ =\ \mbox{\hyperlink{structtf_1_1detail_1_1cuda_block_sort}{cudaBlockSort<E::nt,\ E::vt,\ K,\ V>}};}
\DoxyCodeLine{00299\ }
\DoxyCodeLine{00300\ \ \ \ \ \_\_shared\_\_\ \textcolor{keyword}{union\ }\{}
\DoxyCodeLine{00301\ \ \ \ \ \ \ \textcolor{keyword}{typename}\ sort\_t::Storage\ sort;}
\DoxyCodeLine{00302\ \ \ \ \ \ \ K\ keys[E::nv];}
\DoxyCodeLine{00303\ \ \ \ \ \ \ \mbox{\hyperlink{_eigen_solver___eigen_solver___matrix_type_8cpp_a77c224aa52b434918ce65c33175aa8ad}{V}}\ vals[E::nv];}
\DoxyCodeLine{00304\ \ \ \ \ \}\ \mbox{\hyperlink{sugar_8h_ae0940e50b16abd6b40d3cb35b1913da0}{shared}};}
\DoxyCodeLine{00305\ }
\DoxyCodeLine{00306\ \ \ \ \ \textcolor{keyword}{auto}\ tile\ =\ \mbox{\hyperlink{namespacetf_a5a41760b383016bd1cebadcfd7f05476}{cuda\_get\_tile}}(bid,\ E::nv,\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}});}
\DoxyCodeLine{00307\ }
\DoxyCodeLine{00308\ \ \ \ \ \textcolor{comment}{//\ Load\ the\ keys\ and\ values.}}
\DoxyCodeLine{00309\ \ \ \ \ \mbox{\hyperlink{structtf_1_1cuda_k_v_array}{cudaKVArray<K,\ V,\ E::vt>}}\ unsorted;}
\DoxyCodeLine{00310\ \ \ \ \ unsorted.\mbox{\hyperlink{structtf_1_1cuda_k_v_array_af97e2cbc31dc2b0bb77afb3e5c29ddfd}{keys}}\ =\ \mbox{\hyperlink{namespacetf_a6927bc7edeed8a199a267e44bd3374c3}{cuda\_mem\_to\_reg\_thread<E::nt,\ E::vt>}}(}
\DoxyCodeLine{00311\ \ \ \ \ \ \ keys\_input\ +\ tile.begin,\ tid,\ tile.count(),\ \mbox{\hyperlink{sugar_8h_ae0940e50b16abd6b40d3cb35b1913da0}{shared}}.keys}
\DoxyCodeLine{00312\ \ \ \ \ );}
\DoxyCodeLine{00313\ }
\DoxyCodeLine{00314\ \ \ \ \ \textcolor{keywordflow}{if}(has\_values)\ \{}
\DoxyCodeLine{00315\ \ \ \ \ \ \ unsorted.\mbox{\hyperlink{structtf_1_1cuda_k_v_array_a21569e17a3c7fb0ddb2ae5376c342869}{vals}}\ =\ \mbox{\hyperlink{namespacetf_a6927bc7edeed8a199a267e44bd3374c3}{cuda\_mem\_to\_reg\_thread<E::nt,\ E::vt>}}(}
\DoxyCodeLine{00316\ \ \ \ \ \ \ \ \ vals\_input\ +\ tile.begin,\ tid,\ tile.count(),\ \mbox{\hyperlink{sugar_8h_ae0940e50b16abd6b40d3cb35b1913da0}{shared}}.vals}
\DoxyCodeLine{00317\ \ \ \ \ \ \ );}
\DoxyCodeLine{00318\ \ \ \ \ \}}
\DoxyCodeLine{00319\ }
\DoxyCodeLine{00320\ \ \ \ \ \textcolor{comment}{//\ Blocksort.}}
\DoxyCodeLine{00321\ \ \ \ \ \textcolor{keyword}{auto}\ sorted\ =\ sort\_t().block\_sort(unsorted,\ tid,\ tile.count(),\ \mbox{\hyperlink{external_2taskflow_2sandbox_2jacobi_2main_8cpp_aaa178026ff13e667efcb0104a55252e7}{comp}},\ \mbox{\hyperlink{sugar_8h_ae0940e50b16abd6b40d3cb35b1913da0}{shared}}.sort);}
\DoxyCodeLine{00322\ }
\DoxyCodeLine{00323\ \ \ \ \ \textcolor{comment}{//\ Store\ the\ keys\ and\ values.}}
\DoxyCodeLine{00324\ \ \ \ \ \mbox{\hyperlink{namespacetf_a9b1d7b2192743447b2f0206b4510977f}{cuda\_reg\_to\_mem\_thread<E::nt,\ E::vt>}}(}
\DoxyCodeLine{00325\ \ \ \ \ \ \ sorted.keys,\ tid,\ tile.count(),\ keys\_blocksort\ +\ tile.begin,\ \mbox{\hyperlink{sugar_8h_ae0940e50b16abd6b40d3cb35b1913da0}{shared}}.keys}
\DoxyCodeLine{00326\ \ \ \ \ );}
\DoxyCodeLine{00327\ }
\DoxyCodeLine{00328\ \ \ \ \ \textcolor{keywordflow}{if}(has\_values)\ \{}
\DoxyCodeLine{00329\ \ \ \ \ \ \ \mbox{\hyperlink{namespacetf_a9b1d7b2192743447b2f0206b4510977f}{cuda\_reg\_to\_mem\_thread<E::nt,\ E::vt>}}(}
\DoxyCodeLine{00330\ \ \ \ \ \ \ \ \ sorted.vals,\ tid,\ tile.count(),\ vals\_blocksort\ +\ tile.begin,\ \mbox{\hyperlink{sugar_8h_ae0940e50b16abd6b40d3cb35b1913da0}{shared}}.vals}
\DoxyCodeLine{00331\ \ \ \ \ \ \ );}
\DoxyCodeLine{00332\ \ \ \ \ \}}
\DoxyCodeLine{00333\ \ \ \});}
\DoxyCodeLine{00334\ }
\DoxyCodeLine{00335\ \ \ \textcolor{comment}{//\ merge\ passes}}
\DoxyCodeLine{00336\ }
\DoxyCodeLine{00337\ \ \ \textcolor{keywordflow}{if}(1\ \&\ \mbox{\hyperlink{test__broadcast__node_8cpp_a554e63228b946db0d44c4f398b18e212}{R}})\ \{}
\DoxyCodeLine{00338\ \ \ \ \ \mbox{\hyperlink{namespacestd_a3acbe51b6415e9284430194bf04944e1}{std::swap}}(keys\_input,\ keys\_output);}
\DoxyCodeLine{00339\ \ \ \ \ \mbox{\hyperlink{namespacestd_a3acbe51b6415e9284430194bf04944e1}{std::swap}}(vals\_input,\ vals\_output);}
\DoxyCodeLine{00340\ \ \ \}}
\DoxyCodeLine{00341\ }
\DoxyCodeLine{00342\ \ \ \textcolor{comment}{//\ number\ of\ partitions}}
\DoxyCodeLine{00343\ \ \ \textcolor{comment}{//unsigned\ num\_partitions\ =\ B\ +\ 1;}}
\DoxyCodeLine{00344\ \ \ \textcolor{comment}{//cudaDeviceVector<unsigned>\ mem(num\_partitions);}}
\DoxyCodeLine{00345\ \ \ \textcolor{comment}{//auto\ mp\_data\ =\ mem.data();}}
\DoxyCodeLine{00346\ \ \ \textcolor{comment}{//std::cout\ <<\ "{}num\_partitions\ =\ "{}\ <<\ (B+1)*sizeof(unsigned)\ <<\ std::endl;}}
\DoxyCodeLine{00347\ }
\DoxyCodeLine{00348\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ pass\ =\ 0;\ pass\ <\ \mbox{\hyperlink{test__broadcast__node_8cpp_a554e63228b946db0d44c4f398b18e212}{R}};\ ++pass)\ \{}
\DoxyCodeLine{00349\ }
\DoxyCodeLine{00350\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ coop\ =\ 2\ <<\ pass;}
\DoxyCodeLine{00351\ }
\DoxyCodeLine{00352\ \ \ \ \ \mbox{\hyperlink{namespacetf_1_1detail_ab4d357fb63d82334ea784ee72beaf600}{cuda\_merge\_sort\_partitions}}(}
\DoxyCodeLine{00353\ \ \ \ \ \ \ \mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}},\ keys\_input,\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}},\ coop,\ E::nv,\ \mbox{\hyperlink{external_2taskflow_2sandbox_2jacobi_2main_8cpp_aaa178026ff13e667efcb0104a55252e7}{comp}},\ mp\_data}
\DoxyCodeLine{00354\ \ \ \ \ );}
\DoxyCodeLine{00355\ }
\DoxyCodeLine{00356\ \ \ \ \ \mbox{\hyperlink{namespacetf_a2fa23f4109147679d05a25ee952c4baf}{cuda\_kernel}}<<<\mbox{\hyperlink{bench__gemm_8cpp_a37a83060ac796961b44991c836f083f7}{B}},\ E::nt,\ 0,\ \mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}}.stream()>>>([=]\_\_device\_\_(\textcolor{keyword}{auto}\ tid,\ \textcolor{keyword}{auto}\ bid)\ \{}
\DoxyCodeLine{00357\ }
\DoxyCodeLine{00358\ \ \ \ \ \ \ \_\_shared\_\_\ \textcolor{keyword}{union\ }\{}
\DoxyCodeLine{00359\ \ \ \ \ \ \ \ \ K\ keys[E::nv\ +\ 1];}
\DoxyCodeLine{00360\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a94ae715eebfc1eb65456c0ab9b97f1e9}{indices}}[E::nv];}
\DoxyCodeLine{00361\ \ \ \ \ \ \ \}\ \mbox{\hyperlink{sugar_8h_ae0940e50b16abd6b40d3cb35b1913da0}{shared}};}
\DoxyCodeLine{00362\ }
\DoxyCodeLine{00363\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ tile\ =\ \mbox{\hyperlink{namespacetf_a5a41760b383016bd1cebadcfd7f05476}{cuda\_get\_tile}}(bid,\ E::nv,\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}});}
\DoxyCodeLine{00364\ }
\DoxyCodeLine{00365\ \ \ \ \ \ \ \textcolor{comment}{//\ Load\ the\ range\ for\ this\ CTA\ and\ merge\ the\ values\ into\ register.}}
\DoxyCodeLine{00366\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ range\ =\ \mbox{\hyperlink{namespacetf_1_1detail_a1a8d810065126154d47114e93bbfea57}{cuda\_compute\_merge\_sort\_range}}(}
\DoxyCodeLine{00367\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}},\ bid,\ coop,\ E::nv,\ mp\_data[bid\ +\ 0],\ mp\_data[bid\ +\ 1]}
\DoxyCodeLine{00368\ \ \ \ \ \ \ );}
\DoxyCodeLine{00369\ }
\DoxyCodeLine{00370\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ merge\ =\ \mbox{\hyperlink{namespacetf_1_1detail_a79b4c5f2bace6ae958abd8573e00a849}{block\_merge\_from\_mem<cudaMergeBoundType::LOWER,\ E::nt,\ E::vt>}}(}
\DoxyCodeLine{00371\ \ \ \ \ \ \ \ \ keys\_input,\ keys\_input,\ range,\ tid,\ \mbox{\hyperlink{external_2taskflow_2sandbox_2jacobi_2main_8cpp_aaa178026ff13e667efcb0104a55252e7}{comp}},\ \mbox{\hyperlink{sugar_8h_ae0940e50b16abd6b40d3cb35b1913da0}{shared}}.keys}
\DoxyCodeLine{00372\ \ \ \ \ \ \ );}
\DoxyCodeLine{00373\ }
\DoxyCodeLine{00374\ \ \ \ \ \ \ \textcolor{comment}{//\ Store\ merged\ values\ back\ out.}}
\DoxyCodeLine{00375\ \ \ \ \ \ \ \mbox{\hyperlink{namespacetf_a9b1d7b2192743447b2f0206b4510977f}{cuda\_reg\_to\_mem\_thread<E::nt>}}(}
\DoxyCodeLine{00376\ \ \ \ \ \ \ \ \ merge.keys,\ tid,\ tile.count(),\ keys\_output\ +\ tile.begin,\ \mbox{\hyperlink{sugar_8h_ae0940e50b16abd6b40d3cb35b1913da0}{shared}}.keys}
\DoxyCodeLine{00377\ \ \ \ \ \ \ );}
\DoxyCodeLine{00378\ }
\DoxyCodeLine{00379\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(has\_values)\ \{}
\DoxyCodeLine{00380\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Transpose\ the\ indices\ from\ thread\ order\ to\ strided\ order.}}
\DoxyCodeLine{00381\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a94ae715eebfc1eb65456c0ab9b97f1e9}{indices}}\ =\ \mbox{\hyperlink{namespacetf_ac670e8234ab71b14dfcccb87074b69de}{cuda\_reg\_thread\_to\_strided<E::nt>}}(}
\DoxyCodeLine{00382\ \ \ \ \ \ \ \ \ \ \ merge.indices,\ tid,\ \mbox{\hyperlink{sugar_8h_ae0940e50b16abd6b40d3cb35b1913da0}{shared}}.indices}
\DoxyCodeLine{00383\ \ \ \ \ \ \ \ \ );}
\DoxyCodeLine{00384\ }
\DoxyCodeLine{00385\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Gather\ the\ input\ values\ and\ merge\ into\ the\ output\ values.}}
\DoxyCodeLine{00386\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacetf_1_1detail_ac4e1e83b946b3ef78e5dcb3e9bfc3c48}{cuda\_transfer\_two\_streams\_strided<E::nt>}}(}
\DoxyCodeLine{00387\ \ \ \ \ \ \ \ \ \ \ vals\_input\ +\ range.a\_begin,\ range.a\_count(),}
\DoxyCodeLine{00388\ \ \ \ \ \ \ \ \ \ \ vals\_input\ +\ range.b\_begin,\ range.b\_count(),}
\DoxyCodeLine{00389\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a94ae715eebfc1eb65456c0ab9b97f1e9}{indices}},\ tid,\ vals\_output\ +\ tile.begin}
\DoxyCodeLine{00390\ \ \ \ \ \ \ \ \ );}
\DoxyCodeLine{00391\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00392\ \ \ \ \ \});}
\DoxyCodeLine{00393\ }
\DoxyCodeLine{00394\ \ \ \ \ \mbox{\hyperlink{namespacestd_a3acbe51b6415e9284430194bf04944e1}{std::swap}}(keys\_input,\ keys\_output);}
\DoxyCodeLine{00395\ \ \ \ \ \mbox{\hyperlink{namespacestd_a3acbe51b6415e9284430194bf04944e1}{std::swap}}(vals\_input,\ vals\_output);}
\DoxyCodeLine{00396\ \ \ \}}
\DoxyCodeLine{00397\ \}}
\DoxyCodeLine{00398\ }
\DoxyCodeLine{00399\ \}\ \ \textcolor{comment}{//\ end\ of\ namespace\ tf::detail\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00400\ }
\DoxyCodeLine{00401\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespacetf}{tf}}\ \{}
\DoxyCodeLine{00402\ }
\DoxyCodeLine{00416\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ P,\ \textcolor{keyword}{typename}\ K,\ \textcolor{keyword}{typename}\ V\ =\ cudaEmpty>}
\DoxyCodeLine{00417\ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacetf_a9c69906a4dfd1e2d0cd7ed496d29dafd}{cuda\_sort\_buffer\_size}}(\textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}})\ \{}
\DoxyCodeLine{00418\ }
\DoxyCodeLine{00419\ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{sandbox_2strassen_2omp_8cpp_a4bfa035cad7c3258704669810cd5de5d}{E}}\ =\ std::decay\_t<P>;}
\DoxyCodeLine{00420\ }
\DoxyCodeLine{00421\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ has\_values\ =\ !std::is\_same<V,\ cudaEmpty>::value;}
\DoxyCodeLine{00422\ }
\DoxyCodeLine{00423\ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{bench__gemm_8cpp_a37a83060ac796961b44991c836f083f7}{B}}\ =\ (\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}}\ +\ E::nv\ -\/\ 1)\ /\ E::nv;}
\DoxyCodeLine{00424\ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{test__broadcast__node_8cpp_a554e63228b946db0d44c4f398b18e212}{R}}\ =\ \mbox{\hyperlink{namespacetf_1_1detail_a9a76c046987683e12f4a4381d1559a69}{detail::cuda\_find\_log2}}(\mbox{\hyperlink{bench__gemm_8cpp_a37a83060ac796961b44991c836f083f7}{B}},\ \textcolor{keyword}{true});}
\DoxyCodeLine{00425\ }
\DoxyCodeLine{00426\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{test__broadcast__node_8cpp_a554e63228b946db0d44c4f398b18e212}{R}}\ ?\ (\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}}\ *\ \textcolor{keyword}{sizeof}(K)\ +\ (has\_values\ ?\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a78e23769680a273f948d4bd3e946fcae}{count}}*\textcolor{keyword}{sizeof}(\mbox{\hyperlink{_eigen_solver___eigen_solver___matrix_type_8cpp_a77c224aa52b434918ce65c33175aa8ad}{V}})\ :\ 0)\ +}
\DoxyCodeLine{00427\ \ \ \ \ \ \ \ \ \ \ \ \ \ (\mbox{\hyperlink{bench__gemm_8cpp_a37a83060ac796961b44991c836f083f7}{B}}+1)*\textcolor{keyword}{sizeof}(unsigned))\ :\ 0;}
\DoxyCodeLine{00428\ \}}
\DoxyCodeLine{00429\ }
\DoxyCodeLine{00430\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00431\ \textcolor{comment}{//\ key-\/value\ sort}}
\DoxyCodeLine{00432\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00433\ }
\DoxyCodeLine{00466\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ P,\ \textcolor{keyword}{typename}\ K\_it,\ \textcolor{keyword}{typename}\ V\_it,\ \textcolor{keyword}{typename}\ C>}
\DoxyCodeLine{00467\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{namespacetf_a3461b9179221dd7230ce2a0e45156c7f}{cuda\_sort\_by\_key}}(}
\DoxyCodeLine{00468\ \ \ \mbox{\hyperlink{namespace_p}{P}}\&\&\ \mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}},\ K\_it\ k\_first,\ K\_it\ k\_last,\ V\_it\ v\_first,\ \mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}}\ \mbox{\hyperlink{external_2taskflow_2sandbox_2jacobi_2main_8cpp_aaa178026ff13e667efcb0104a55252e7}{comp}},\ \textcolor{keywordtype}{void}*\ buf}
\DoxyCodeLine{00469\ )\ \{}
\DoxyCodeLine{00470\ }
\DoxyCodeLine{00471\ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{main-override-static_8c_a0240ac851181b84ac374872dc5434ee4}{N}}\ =\ std::distance(k\_first,\ k\_last);}
\DoxyCodeLine{00472\ }
\DoxyCodeLine{00473\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{main-override-static_8c_a0240ac851181b84ac374872dc5434ee4}{N}}\ <=\ 1)\ \{}
\DoxyCodeLine{00474\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00475\ \ \ \}}
\DoxyCodeLine{00476\ }
\DoxyCodeLine{00477\ \ \ \mbox{\hyperlink{namespacetf_1_1detail_a1d70c013b280d4f811275e892af15c18}{detail::merge\_sort\_loop}}(\mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}},\ k\_first,\ v\_first,\ \mbox{\hyperlink{main-override-static_8c_a0240ac851181b84ac374872dc5434ee4}{N}},\ \mbox{\hyperlink{external_2taskflow_2sandbox_2jacobi_2main_8cpp_aaa178026ff13e667efcb0104a55252e7}{comp}},\ buf);}
\DoxyCodeLine{00478\ \}}
\DoxyCodeLine{00479\ }
\DoxyCodeLine{00480\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00481\ \textcolor{comment}{//\ key\ sort}}
\DoxyCodeLine{00482\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00483\ }
\DoxyCodeLine{00500\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ P,\ \textcolor{keyword}{typename}\ K\_it,\ \textcolor{keyword}{typename}\ C>}
\DoxyCodeLine{00501\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{namespacetf_a06804cb1598e965febc7bd35fc0fbbb0}{cuda\_sort}}(\mbox{\hyperlink{namespace_p}{P}}\&\&\ \mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}},\ K\_it\ k\_first,\ K\_it\ k\_last,\ \mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}}\ \mbox{\hyperlink{external_2taskflow_2sandbox_2jacobi_2main_8cpp_aaa178026ff13e667efcb0104a55252e7}{comp}},\ \textcolor{keywordtype}{void}*\ buf)\ \{}
\DoxyCodeLine{00502\ \ \ \mbox{\hyperlink{namespacetf_a3461b9179221dd7230ce2a0e45156c7f}{cuda\_sort\_by\_key}}(\mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}},\ k\_first,\ k\_last,\ (\mbox{\hyperlink{structtf_1_1cuda_empty}{cudaEmpty}}*)\textcolor{keyword}{nullptr},\ \mbox{\hyperlink{external_2taskflow_2sandbox_2jacobi_2main_8cpp_aaa178026ff13e667efcb0104a55252e7}{comp}},\ buf);}
\DoxyCodeLine{00503\ \}}
\DoxyCodeLine{00504\ }
\DoxyCodeLine{00505\ \}\ \ \textcolor{comment}{//\ end\ of\ namespace\ tf\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00506\ }

\end{DoxyCode}
