\doxysection{DGMRES.\+h}
\hypertarget{_d_g_m_r_e_s_8h_source}{}\label{_d_g_m_r_e_s_8h_source}\index{external/taskflow/3rd-\/party/eigen-\/3.3.7/unsupported/Eigen/src/IterativeSolvers/DGMRES.h@{external/taskflow/3rd-\/party/eigen-\/3.3.7/unsupported/Eigen/src/IterativeSolvers/DGMRES.h}}
\mbox{\hyperlink{_d_g_m_r_e_s_8h}{浏览该文件的文档.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ This\ file\ is\ part\ of\ Eigen,\ a\ lightweight\ C++\ template\ library}}
\DoxyCodeLine{00002\ \textcolor{comment}{//\ for\ linear\ algebra.}}
\DoxyCodeLine{00003\ \textcolor{comment}{//}}
\DoxyCodeLine{00004\ \textcolor{comment}{//\ Copyright\ (C)\ 2012\ Désiré\ Nuentsa-\/Wakam\ <desire.nuentsa\_wakam@inria.fr>}}
\DoxyCodeLine{00005\ \textcolor{comment}{//}}
\DoxyCodeLine{00006\ \textcolor{comment}{//\ This\ Source\ Code\ Form\ is\ subject\ to\ the\ terms\ of\ the\ Mozilla}}
\DoxyCodeLine{00007\ \textcolor{comment}{//\ Public\ License\ v.\ 2.0.\ If\ a\ copy\ of\ the\ MPL\ was\ not\ distributed}}
\DoxyCodeLine{00008\ \textcolor{comment}{//\ with\ this\ file,\ You\ can\ obtain\ one\ at\ http://mozilla.org/MPL/2.0/.}}
\DoxyCodeLine{00009\ }
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#ifndef\ EIGEN\_DGMRES\_H}}
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#define\ EIGEN\_DGMRES\_H}}
\DoxyCodeLine{00012\ }
\DoxyCodeLine{00013\ \textcolor{preprocessor}{\#include\ <Eigen/Eigenvalues>}}
\DoxyCodeLine{00014\ }
\DoxyCodeLine{00015\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespace_eigen}{Eigen}}\ \{\ }
\DoxyCodeLine{00016\ \ \ }
\DoxyCodeLine{00017\ \textcolor{keyword}{template}<\ \textcolor{keyword}{typename}\ \_MatrixType,}
\DoxyCodeLine{00018\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{typename}\ \_Preconditioner\ =\ \mbox{\hyperlink{class_eigen_1_1_diagonal_preconditioner}{DiagonalPreconditioner<typename\ \_MatrixType::Scalar>}}\ >}
\DoxyCodeLine{00019\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s}{DGMRES}};}
\DoxyCodeLine{00020\ }
\DoxyCodeLine{00021\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespace_eigen_1_1internal}{internal}}\ \{}
\DoxyCodeLine{00022\ }
\DoxyCodeLine{00023\ \textcolor{keyword}{template}<\ \textcolor{keyword}{typename}\ \_MatrixType,\ \textcolor{keyword}{typename}\ \_Preconditioner>}
\DoxyCodeLine{00024\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_eigen_1_1internal_1_1traits}{traits}}<\mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s}{DGMRES}}<\_MatrixType,\_Preconditioner>\ >}
\DoxyCodeLine{00025\ \{}
\DoxyCodeLine{00026\ \ \ \textcolor{keyword}{typedef}\ \_MatrixType\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1traits_3_01_d_g_m_r_e_s_3_01___matrix_type_00_01___preconditioner_01_4_01_4_ac484f53f4a4d6333189bc3eea934fe70}{MatrixType}};}
\DoxyCodeLine{00027\ \ \ \textcolor{keyword}{typedef}\ \_Preconditioner\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1traits_3_01_d_g_m_r_e_s_3_01___matrix_type_00_01___preconditioner_01_4_01_4_a9202fcd39a676b35549434edb6680877}{Preconditioner}};}
\DoxyCodeLine{00028\ \};}
\DoxyCodeLine{00029\ }
\DoxyCodeLine{00038\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ VectorType,\ \textcolor{keyword}{typename}\ IndexType>}
\DoxyCodeLine{00039\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{namespace_eigen_1_1internal_afe2a11c61eff70f7f68681a557fa21e7}{sortWithPermutation}}\ (\mbox{\hyperlink{struct_vector_type}{VectorType}}\&\ \mbox{\hyperlink{benchmarks_2for__each_2for__each_8hpp_ad86cbaae2e3f21959301250e9f7c2701}{vec}},\ IndexType\&\ perm,\ \textcolor{keyword}{typename}\ IndexType::Scalar\&\ ncut)}
\DoxyCodeLine{00040\ \{}
\DoxyCodeLine{00041\ \ \ \mbox{\hyperlink{eigen-3_83_87_2_eigen_2src_2_core_2util_2_macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(\mbox{\hyperlink{benchmarks_2for__each_2for__each_8hpp_ad86cbaae2e3f21959301250e9f7c2701}{vec}}.size()\ ==\ perm.size());}
\DoxyCodeLine{00042\ \ \ \textcolor{keywordtype}{bool}\ flag;\ }
\DoxyCodeLine{00043\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{struct_eigen_1_1internal_1_1traits}{Index}}\ k\ \ =\ 0;\ k\ <\ ncut;\ k++)}
\DoxyCodeLine{00044\ \ \ \{}
\DoxyCodeLine{00045\ \ \ \ \ flag\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00046\ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{struct_eigen_1_1internal_1_1traits}{Index}}\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}\ =\ 0;\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}\ <\ \mbox{\hyperlink{benchmarks_2for__each_2for__each_8hpp_ad86cbaae2e3f21959301250e9f7c2701}{vec}}.size()-\/1;\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}++)}
\DoxyCodeLine{00047\ \ \ \ \ \{}
\DoxyCodeLine{00048\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\ \mbox{\hyperlink{benchmarks_2for__each_2for__each_8hpp_ad86cbaae2e3f21959301250e9f7c2701}{vec}}(perm(\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}))\ <\ \mbox{\hyperlink{benchmarks_2for__each_2for__each_8hpp_ad86cbaae2e3f21959301250e9f7c2701}{vec}}(perm(\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}+1))\ )}
\DoxyCodeLine{00049\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00050\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacestd_a3acbe51b6415e9284430194bf04944e1}{std::swap}}(perm(\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}),perm(\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}+1));\ }
\DoxyCodeLine{00051\ \ \ \ \ \ \ \ \ flag\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00052\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00053\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!flag)\ \textcolor{keywordflow}{break};\ \textcolor{comment}{//\ The\ vector\ is\ in\ sorted\ order}}
\DoxyCodeLine{00054\ \ \ \ \ \}}
\DoxyCodeLine{00055\ \ \ \}}
\DoxyCodeLine{00056\ \}}
\DoxyCodeLine{00057\ }
\DoxyCodeLine{00058\ \}}
\DoxyCodeLine{00100\ \textcolor{keyword}{template}<\ \textcolor{keyword}{typename}\ \_MatrixType,\ \textcolor{keyword}{typename}\ \_Preconditioner>}
\DoxyCodeLine{00101\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a17bd25826b56c39bc7cc4ce8fbf8a848}{DGMRES}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{class_eigen_1_1_iterative_solver_base_a0922f2be45082690d7734aa6732fc493}{IterativeSolverBase}}<DGMRES<\_MatrixType,\_Preconditioner>\ >}
\DoxyCodeLine{00102\ \{}
\DoxyCodeLine{00103\ \ \ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{class_eigen_1_1_iterative_solver_base_a0922f2be45082690d7734aa6732fc493}{IterativeSolverBase<DGMRES>}}\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a8768ba8e54bea8b7dd308c66300db074}{Base}};}
\DoxyCodeLine{00104\ \ \ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{class_eigen_1_1_iterative_solver_base_af24f53813d56a98491957dabc1d2f7eb}{Base::matrix}};}
\DoxyCodeLine{00105\ \ \ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{class_eigen_1_1_iterative_solver_base_a9140af00eb517cb5677dd6e1a60fab80}{Base::m\_error}};}
\DoxyCodeLine{00106\ \ \ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{class_eigen_1_1_iterative_solver_base_aa1e43c88482d7d73394ec3229f6e8a4a}{Base::m\_iterations}};}
\DoxyCodeLine{00107\ \ \ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{class_eigen_1_1_iterative_solver_base_a283a3c6136f76e77ac29184352c3e940}{Base::m\_info}};}
\DoxyCodeLine{00108\ \ \ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{class_eigen_1_1_iterative_solver_base_ac52101f69d048d5c4b036eadf1f13673}{Base::m\_isInitialized}};}
\DoxyCodeLine{00109\ \ \ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{class_eigen_1_1_iterative_solver_base_acf34fdb3eb17a876810b9d6c5031e175}{Base::m\_tolerance}};\ }
\DoxyCodeLine{00110\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00111\ \ \ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{class_eigen_1_1_iterative_solver_base_a7c2a35dde0ddb891b4030143ed286743}{Base::\_solve\_impl}};}
\DoxyCodeLine{00112\ \ \ \ \ \textcolor{keyword}{typedef}\ \_MatrixType\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_abebf2c0dc490d410fbf5f24dedc60712}{MatrixType}};}
\DoxyCodeLine{00113\ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ MatrixType::Scalar\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_aa2172314b09dbddeb3661ca9c809b371}{Scalar}};}
\DoxyCodeLine{00114\ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ MatrixType::StorageIndex\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a5e96d9b5ca6098272003550ef87c32d2}{StorageIndex}};}
\DoxyCodeLine{00115\ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ MatrixType::RealScalar\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a7e47d437b590be8af0e9972e60adbe34}{RealScalar}};}
\DoxyCodeLine{00116\ \ \ \ \ \textcolor{keyword}{typedef}\ \_Preconditioner\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_acae98b6f30d350a136ed4bc3a270834b}{Preconditioner}};}
\DoxyCodeLine{00117\ \ \ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{class_eigen_1_1_matrix}{Matrix<Scalar,Dynamic,Dynamic>}}\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a87d1411656955d8c3f053cfc2be4a856}{DenseMatrix}};\ }
\DoxyCodeLine{00118\ \ \ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{class_eigen_1_1_matrix}{Matrix<RealScalar,Dynamic,Dynamic>}}\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a4c15bd34c5956f8b78020dc5c0d2e667}{DenseRealMatrix}};\ }
\DoxyCodeLine{00119\ \ \ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{class_eigen_1_1_matrix}{Matrix<Scalar,Dynamic,1>}}\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a1d85b943c99dabf606c6c537e550b11b}{DenseVector}};}
\DoxyCodeLine{00120\ \ \ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{class_eigen_1_1_matrix}{Matrix<RealScalar,Dynamic,1>}}\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a9ffdf6b47010f636fcc1a071a9e9e16c}{DenseRealVector}};\ }
\DoxyCodeLine{00121\ \ \ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{class_eigen_1_1_matrix}{Matrix<std::complex<RealScalar>}},\ \mbox{\hyperlink{namespace_eigen_ad81fa7195215a0ce30017dfac309f0b2}{Dynamic}},\ 1>\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_aeace9fdbc1373362c29409003482d66a}{ComplexVector}};}
\DoxyCodeLine{00122\ \ }
\DoxyCodeLine{00123\ \ \ \ \ }
\DoxyCodeLine{00125\ \ \ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a17bd25826b56c39bc7cc4ce8fbf8a848}{DGMRES}}()\ :\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a8768ba8e54bea8b7dd308c66300db074}{Base}}(),\mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_ab5f0105c1ff3d035054a12624f69181b}{m\_restart}}(30),\mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a30674252b8ac12e303f0ec114e574492}{m\_neig}}(0),\mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a5a3ef71312bce5745aaeaced22b48d91}{m\_r}}(0),\mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a08debe5d30604a03a674d4ba3f7a3bbc}{m\_maxNeig}}(5),\mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a38beee7707cc020cb666061bdd7c6f7e}{m\_isDeflAllocated}}(\mbox{\hyperlink{yyjson_8h_a65e9886d74aaee76545e83dd09011727}{false}}),\mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_afc8a3fc0175e8a0905cb6870703ef2f9}{m\_isDeflInitialized}}(\mbox{\hyperlink{yyjson_8h_a65e9886d74aaee76545e83dd09011727}{false}})\ \{\}}
\DoxyCodeLine{00126\ }
\DoxyCodeLine{00137\ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ MatrixDerived>}
\DoxyCodeLine{00138\ \ \ \textcolor{keyword}{explicit}\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a800fcf37c0ac66f76d5c070e4aeae2a7}{DGMRES}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_eigen_1_1_eigen_base}{EigenBase<MatrixDerived>}}\&\ \mbox{\hyperlink{bench__gemm_8cpp_addc86e8508f14411ec98f521c520f875}{A}})\ :\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a8768ba8e54bea8b7dd308c66300db074}{Base}}(\mbox{\hyperlink{bench__gemm_8cpp_addc86e8508f14411ec98f521c520f875}{A}}.\mbox{\hyperlink{class_eigen_1_1_iterative_solver_base_ac8c149c121511c2f7e00a4b83d8b6791}{derived}}()),\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_ab5f0105c1ff3d035054a12624f69181b}{m\_restart}}(30),\mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a30674252b8ac12e303f0ec114e574492}{m\_neig}}(0),\mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a5a3ef71312bce5745aaeaced22b48d91}{m\_r}}(0),\mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a08debe5d30604a03a674d4ba3f7a3bbc}{m\_maxNeig}}(5),\mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a38beee7707cc020cb666061bdd7c6f7e}{m\_isDeflAllocated}}(\mbox{\hyperlink{yyjson_8h_a65e9886d74aaee76545e83dd09011727}{false}}),\mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_afc8a3fc0175e8a0905cb6870703ef2f9}{m\_isDeflInitialized}}(\mbox{\hyperlink{yyjson_8h_a65e9886d74aaee76545e83dd09011727}{false}})\ \{\}}
\DoxyCodeLine{00139\ }
\DoxyCodeLine{00140\ \ \ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a3cb89704ebc2dd5ed042aebeb7df7753}{\string~DGMRES}}()\ \{\}}
\DoxyCodeLine{00141\ \ \ }
\DoxyCodeLine{00143\ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ Rhs,\textcolor{keyword}{typename}\ Dest>}
\DoxyCodeLine{00144\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_aa339fee66d9861ae803bdc898ddf6a34}{\_solve\_with\_guess\_impl}}(\textcolor{keyword}{const}\ Rhs\&\ \mbox{\hyperlink{offscreen_8c_a846c9667e34d56c560bb7f0ac6e173f6}{b}},\ Dest\&\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}})\textcolor{keyword}{\ const}}
\DoxyCodeLine{00145\ \textcolor{keyword}{\ \ }\{\ \ \ \ }
\DoxyCodeLine{00146\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{testhelper_8h_ad4ec5aab9b62fbbe9b8fc2d8ac0a5989}{failed}}\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00147\ \ \ \ \ \textcolor{keywordflow}{for}(\mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}=0;\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}<\mbox{\hyperlink{offscreen_8c_a846c9667e34d56c560bb7f0ac6e173f6}{b}}.cols();\ ++\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}})}
\DoxyCodeLine{00148\ \ \ \ \ \{}
\DoxyCodeLine{00149\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a8055c459b5a984a1a2fa6dcb2ccaaf88}{m\_iterations}}\ =\ \mbox{\hyperlink{class_eigen_1_1_iterative_solver_base_a168a74c8dceb6233b220031fdd756ba0}{Base::maxIterations}}();}
\DoxyCodeLine{00150\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a87ced7feba8050ad4c5216f03f639314}{m\_error}}\ =\ \mbox{\hyperlink{class_eigen_1_1_iterative_solver_base_acf34fdb3eb17a876810b9d6c5031e175}{Base::m\_tolerance}};}
\DoxyCodeLine{00151\ \ \ \ \ \ \ }
\DoxyCodeLine{00152\ \ \ \ \ \ \ \textcolor{keyword}{typename}\ Dest::ColXpr\ xj(\mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}},\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}});}
\DoxyCodeLine{00153\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a1b06062ec16932d3a20ea4767d9de51d}{dgmres}}(\mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_aa06ef0435026fe3ad6e5f285155debb5}{matrix}}(),\ \mbox{\hyperlink{offscreen_8c_a846c9667e34d56c560bb7f0ac6e173f6}{b}}.col(\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}),\ xj,\ \mbox{\hyperlink{class_eigen_1_1_iterative_solver_base_a965e3600bc2a59bc24af0bdf8e7f4dd4}{Base::m\_preconditioner}});}
\DoxyCodeLine{00154\ \ \ \ \ \}}
\DoxyCodeLine{00155\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a8138d5bb2cbcf249c2453292dd9a9085}{m\_info}}\ =\ \mbox{\hyperlink{testhelper_8h_ad4ec5aab9b62fbbe9b8fc2d8ac0a5989}{failed}}\ ?\ \mbox{\hyperlink{group__enums_gga85fad7b87587764e5cf6b513a9e0ee5ea1c6e20706575a629b27a105f07f1883b}{NumericalIssue}}}
\DoxyCodeLine{00156\ \ \ \ \ \ \ \ \ \ \ \ :\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a87ced7feba8050ad4c5216f03f639314}{m\_error}}\ <=\ \mbox{\hyperlink{class_eigen_1_1_iterative_solver_base_acf34fdb3eb17a876810b9d6c5031e175}{Base::m\_tolerance}}\ ?\ \mbox{\hyperlink{group__enums_gga85fad7b87587764e5cf6b513a9e0ee5ea671a2aeb0f527802806a441d58a80fcf}{Success}}}
\DoxyCodeLine{00157\ \ \ \ \ \ \ \ \ \ \ \ :\ \mbox{\hyperlink{group__enums_gga85fad7b87587764e5cf6b513a9e0ee5ea6a68dfb88a8336108a30588bdf356c57}{NoConvergence}};}
\DoxyCodeLine{00158\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_aed3f568ed89da13035409958eee3d416}{m\_isInitialized}}\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00159\ \ \ \}}
\DoxyCodeLine{00160\ }
\DoxyCodeLine{00162\ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ Rhs,\textcolor{keyword}{typename}\ Dest>}
\DoxyCodeLine{00163\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_ab8325945ebdbd9d75cc796b6cde5a96e}{\_solve\_impl}}(\textcolor{keyword}{const}\ Rhs\&\ \mbox{\hyperlink{offscreen_8c_a846c9667e34d56c560bb7f0ac6e173f6}{b}},\ \mbox{\hyperlink{class_eigen_1_1_matrix_base}{MatrixBase<Dest>}}\&\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}})\textcolor{keyword}{\ const}}
\DoxyCodeLine{00164\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00165\ \ \ \ \ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}}\ =\ \mbox{\hyperlink{offscreen_8c_a846c9667e34d56c560bb7f0ac6e173f6}{b}};}
\DoxyCodeLine{00166\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_aa339fee66d9861ae803bdc898ddf6a34}{\_solve\_with\_guess\_impl}}(\mbox{\hyperlink{offscreen_8c_a846c9667e34d56c560bb7f0ac6e173f6}{b}},\mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}}.derived());}
\DoxyCodeLine{00167\ \ \ \}}
\DoxyCodeLine{00171\ \ \ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_afba35ad9e10dba460a9658075ade4d57}{restart}}()\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_ab5f0105c1ff3d035054a12624f69181b}{m\_restart}};\ \}}
\DoxyCodeLine{00172\ \ \ }
\DoxyCodeLine{00176\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_abc4c4e02112c861b122a19a2742319f0}{set\_restart}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_afba35ad9e10dba460a9658075ade4d57}{restart}})\ \{\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_ab5f0105c1ff3d035054a12624f69181b}{m\_restart}}=\mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_afba35ad9e10dba460a9658075ade4d57}{restart}};\ \}}
\DoxyCodeLine{00177\ \ \ }
\DoxyCodeLine{00181\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_ae74eb1faaaf3559bcf73b4d7703ea629}{setEigenv}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ neig)\ }
\DoxyCodeLine{00182\ \ \ \{}
\DoxyCodeLine{00183\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a30674252b8ac12e303f0ec114e574492}{m\_neig}}\ =\ neig;}
\DoxyCodeLine{00184\ \ \ \ \ \textcolor{keywordflow}{if}\ (neig+1\ >\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a08debe5d30604a03a674d4ba3f7a3bbc}{m\_maxNeig}})\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a08debe5d30604a03a674d4ba3f7a3bbc}{m\_maxNeig}}\ =\ neig+1;\ \textcolor{comment}{//\ To\ allow\ for\ complex\ conjugates}}
\DoxyCodeLine{00185\ \ \ \}}
\DoxyCodeLine{00186\ \ \ \ }
\DoxyCodeLine{00190\ \ \ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_ab80013fc06926d2067b677a021367363}{deflSize}}()\ \{\textcolor{keywordflow}{return}\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a5a3ef71312bce5745aaeaced22b48d91}{m\_r}};\ \}}
\DoxyCodeLine{00191\ \ \ }
\DoxyCodeLine{00195\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a6e715bd5199a6a4474a9bc9e8481f9bd}{setMaxEigenv}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ maxNeig)\ \{\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a08debe5d30604a03a674d4ba3f7a3bbc}{m\_maxNeig}}\ =\ maxNeig;\ \}}
\DoxyCodeLine{00196\ \ \ }
\DoxyCodeLine{00197\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00198\ \ \ \ \ \textcolor{comment}{//\ DGMRES\ algorithm\ }}
\DoxyCodeLine{00199\ \ \ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ Rhs,\ \textcolor{keyword}{typename}\ Dest>}
\DoxyCodeLine{00200\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a1b06062ec16932d3a20ea4767d9de51d}{dgmres}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_transform}{MatrixType}}\&\ \mbox{\hyperlink{_tutorial___advanced_initialization___comma_temporary_8cpp_a5d2ded7a4c8830608d7b218f5f27c0a0}{mat}},\textcolor{keyword}{const}\ Rhs\&\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}},\ Dest\&\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}},\ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_acae98b6f30d350a136ed4bc3a270834b}{Preconditioner}}\&\ precond)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00201\ \ \ \ \ \textcolor{comment}{//\ Perform\ one\ cycle\ of\ GMRES}}
\DoxyCodeLine{00202\ \ \ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ Dest>}
\DoxyCodeLine{00203\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_ab77d66ef7f84ff15b6bd55fb76619218}{dgmresCycle}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_transform}{MatrixType}}\&\ \mbox{\hyperlink{_tutorial___advanced_initialization___comma_temporary_8cpp_a5d2ded7a4c8830608d7b218f5f27c0a0}{mat}},\ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_acae98b6f30d350a136ed4bc3a270834b}{Preconditioner}}\&\ precond,\ Dest\&\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}},\ \mbox{\hyperlink{_bench_sparse_util_8h_a2f3f67c514b9315305427f94ed179c53}{DenseVector}}\&\ r0,\ \mbox{\hyperlink{bench__gemm_8cpp_acb5c3dc237f99cf17167e8a629f01b43}{RealScalar}}\&\ \mbox{\hyperlink{wave_8c_aabc9b3ee8fafa62b353f3956f8e3c269}{beta}},\ \textcolor{keyword}{const}\ \mbox{\hyperlink{bench__gemm_8cpp_acb5c3dc237f99cf17167e8a629f01b43}{RealScalar}}\&\ normRhs,\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\&\ nbIts)\ \textcolor{keyword}{const};\ }
\DoxyCodeLine{00204\ \ \ \ \ \textcolor{comment}{//\ Compute\ data\ to\ use\ for\ deflation\ }}
\DoxyCodeLine{00205\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a7bada6df49a235ad404802bc4e04b598}{dgmresComputeDeflationData}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_transform}{MatrixType}}\&\ \mbox{\hyperlink{_tutorial___advanced_initialization___comma_temporary_8cpp_a5d2ded7a4c8830608d7b218f5f27c0a0}{mat}},\ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_acae98b6f30d350a136ed4bc3a270834b}{Preconditioner}}\&\ precond,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\&\ it,\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a5e96d9b5ca6098272003550ef87c32d2}{StorageIndex}}\&\ neig)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00206\ \ \ \ \ \textcolor{comment}{//\ Apply\ deflation\ to\ a\ vector}}
\DoxyCodeLine{00207\ \ \ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ RhsType,\ \textcolor{keyword}{typename}\ DestType>}
\DoxyCodeLine{00208\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_af0cb72e1c8fa37895d1543b1bb09f9d2}{dgmresApplyDeflation}}(\textcolor{keyword}{const}\ RhsType\&\ In,\ DestType\&\ Out)\ \textcolor{keyword}{const};\ }
\DoxyCodeLine{00209\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_aeace9fdbc1373362c29409003482d66a}{ComplexVector}}\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a92363374b8dbe7832b2b7560362c47e7}{schurValues}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_complex_schur}{ComplexSchur<DenseMatrix>}}\&\ schurofH)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00210\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_aeace9fdbc1373362c29409003482d66a}{ComplexVector}}\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a92363374b8dbe7832b2b7560362c47e7}{schurValues}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_real_schur}{RealSchur<DenseMatrix>}}\&\ schurofH)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00211\ \ \ \ \ \textcolor{comment}{//\ Init\ data\ for\ deflation}}
\DoxyCodeLine{00212\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a505c49553b8df373734e1a02e1c5ca70}{dgmresInitDeflation}}(\mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\&\ \mbox{\hyperlink{_tutorial__commainit__02_8cpp_a061459acc9e078fa4699e0e349887215}{rows}})\ \textcolor{keyword}{const};\ }
\DoxyCodeLine{00213\ \ \ \ \ \textcolor{keyword}{mutable}\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a87d1411656955d8c3f053cfc2be4a856}{DenseMatrix}}\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a0fc43b2cca1d84701f629466d39d52b6}{m\_V}};\ \textcolor{comment}{//\ Krylov\ basis\ vectors}}
\DoxyCodeLine{00214\ \ \ \ \ \textcolor{keyword}{mutable}\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a87d1411656955d8c3f053cfc2be4a856}{DenseMatrix}}\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_abaa2292705aa731d5051b01c1be41dfb}{m\_H}};\ \textcolor{comment}{//\ Hessenberg\ matrix\ }}
\DoxyCodeLine{00215\ \ \ \ \ \textcolor{keyword}{mutable}\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a87d1411656955d8c3f053cfc2be4a856}{DenseMatrix}}\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a3a611fc8ad4380f552d8ee7080b27c04}{m\_Hes}};\ \textcolor{comment}{//\ Initial\ hessenberg\ matrix\ wihout\ Givens\ rotations\ applied}}
\DoxyCodeLine{00216\ \ \ \ \ \textcolor{keyword}{mutable}\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_ab5f0105c1ff3d035054a12624f69181b}{m\_restart}};\ \textcolor{comment}{//\ Maximum\ size\ of\ the\ Krylov\ subspace}}
\DoxyCodeLine{00217\ \ \ \ \ \textcolor{keyword}{mutable}\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a87d1411656955d8c3f053cfc2be4a856}{DenseMatrix}}\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a42caf1bb06f1833c434a1b169db79ac3}{m\_U}};\ \textcolor{comment}{//\ Vectors\ that\ form\ the\ basis\ of\ the\ invariant\ subspace\ }}
\DoxyCodeLine{00218\ \ \ \ \ \textcolor{keyword}{mutable}\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a87d1411656955d8c3f053cfc2be4a856}{DenseMatrix}}\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a19258f96b65369998943d21b5487cf56}{m\_MU}};\ \textcolor{comment}{//\ matrix\ operator\ applied\ to\ m\_U\ (for\ next\ cycles)}}
\DoxyCodeLine{00219\ \ \ \ \ \textcolor{keyword}{mutable}\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a87d1411656955d8c3f053cfc2be4a856}{DenseMatrix}}\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_ad37060ad7b0dd4136bc217fa6078965a}{m\_T}};\ \textcolor{comment}{/*\ T=U\string^T*M\string^\{-\/1\}*A*U\ */}}
\DoxyCodeLine{00220\ \ \ \ \ \textcolor{keyword}{mutable}\ \mbox{\hyperlink{class_eigen_1_1_partial_piv_l_u}{PartialPivLU<DenseMatrix>}}\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a5238b52b109ff6a22415f7be5b325e4b}{m\_luT}};\ \textcolor{comment}{//\ LU\ factorization\ of\ m\_T}}
\DoxyCodeLine{00221\ \ \ \ \ \textcolor{keyword}{mutable}\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a5e96d9b5ca6098272003550ef87c32d2}{StorageIndex}}\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a30674252b8ac12e303f0ec114e574492}{m\_neig}};\ \textcolor{comment}{//Number\ of\ eigenvalues\ to\ extract\ at\ each\ restart}}
\DoxyCodeLine{00222\ \ \ \ \ \textcolor{keyword}{mutable}\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a5a3ef71312bce5745aaeaced22b48d91}{m\_r}};\ \textcolor{comment}{//\ Current\ number\ of\ deflated\ eigenvalues,\ size\ of\ m\_U}}
\DoxyCodeLine{00223\ \ \ \ \ \textcolor{keyword}{mutable}\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a08debe5d30604a03a674d4ba3f7a3bbc}{m\_maxNeig}};\ \textcolor{comment}{//\ Maximum\ number\ of\ eigenvalues\ to\ deflate}}
\DoxyCodeLine{00224\ \ \ \ \ \textcolor{keyword}{mutable}\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a7e47d437b590be8af0e9972e60adbe34}{RealScalar}}\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a1df5e45bd1aeef2c34a0d4777fd3f95b}{m\_lambdaN}};\ \textcolor{comment}{//Modulus\ of\ the\ largest\ eigenvalue\ of\ A}}
\DoxyCodeLine{00225\ \ \ \ \ \textcolor{keyword}{mutable}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a38beee7707cc020cb666061bdd7c6f7e}{m\_isDeflAllocated}};}
\DoxyCodeLine{00226\ \ \ \ \ \textcolor{keyword}{mutable}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_afc8a3fc0175e8a0905cb6870703ef2f9}{m\_isDeflInitialized}};}
\DoxyCodeLine{00227\ \ \ \ \ }
\DoxyCodeLine{00228\ \ \ \ \ \textcolor{comment}{//Adaptive\ strategy\ }}
\DoxyCodeLine{00229\ \ \ \ \ \textcolor{keyword}{mutable}\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a7e47d437b590be8af0e9972e60adbe34}{RealScalar}}\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_abb458f4403c029af772bfe4ff13843e4}{m\_smv}};\ \textcolor{comment}{//\ Smaller\ multiple\ of\ the\ remaining\ number\ of\ steps\ allowed}}
\DoxyCodeLine{00230\ \ \ \ \ \textcolor{keyword}{mutable}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a168ad0062ed979171817bf7cce9d6a64}{m\_force}};\ \textcolor{comment}{//\ Force\ the\ use\ of\ deflation\ at\ each\ restart}}
\DoxyCodeLine{00231\ \ \ \ \ }
\DoxyCodeLine{00232\ \};\ }
\DoxyCodeLine{00239\ \textcolor{keyword}{template}<\ \textcolor{keyword}{typename}\ \_MatrixType,\ \textcolor{keyword}{typename}\ \_Preconditioner>}
\DoxyCodeLine{00240\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ Rhs,\ \textcolor{keyword}{typename}\ Dest>}
\DoxyCodeLine{00241\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a1b06062ec16932d3a20ea4767d9de51d}{DGMRES<\_MatrixType,\ \_Preconditioner>::dgmres}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_abebf2c0dc490d410fbf5f24dedc60712}{MatrixType}}\&\ \mbox{\hyperlink{_tutorial___advanced_initialization___comma_temporary_8cpp_a5d2ded7a4c8830608d7b218f5f27c0a0}{mat}},\textcolor{keyword}{const}\ Rhs\&\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}},\ Dest\&\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}},}
\DoxyCodeLine{00242\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_acae98b6f30d350a136ed4bc3a270834b}{Preconditioner}}\&\ precond)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00243\ \textcolor{keyword}{}\{}
\DoxyCodeLine{00244\ \ \ \textcolor{comment}{//Initialization}}
\DoxyCodeLine{00245\ \ \ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}\ =\ \mbox{\hyperlink{_tutorial___advanced_initialization___comma_temporary_8cpp_a5d2ded7a4c8830608d7b218f5f27c0a0}{mat}}.rows();\ }
\DoxyCodeLine{00246\ \ \ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a1d85b943c99dabf606c6c537e550b11b}{DenseVector}}\ r0(\mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}});\ }
\DoxyCodeLine{00247\ \ \ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ nbIts\ =\ 0;\ }
\DoxyCodeLine{00248\ \ \ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_abaa2292705aa731d5051b01c1be41dfb}{m\_H}}.resize(\mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_ab5f0105c1ff3d035054a12624f69181b}{m\_restart}}+1,\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_ab5f0105c1ff3d035054a12624f69181b}{m\_restart}});}
\DoxyCodeLine{00249\ \ \ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a3a611fc8ad4380f552d8ee7080b27c04}{m\_Hes}}.resize(\mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_ab5f0105c1ff3d035054a12624f69181b}{m\_restart}},\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_ab5f0105c1ff3d035054a12624f69181b}{m\_restart}});}
\DoxyCodeLine{00250\ \ \ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a0fc43b2cca1d84701f629466d39d52b6}{m\_V}}.resize(\mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}},\mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_ab5f0105c1ff3d035054a12624f69181b}{m\_restart}}+1);}
\DoxyCodeLine{00251\ \ \ \textcolor{comment}{//Initial\ residual\ vector\ and\ intial\ norm}}
\DoxyCodeLine{00252\ \ \ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}}\ =\ precond.solve(\mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}});}
\DoxyCodeLine{00253\ \ \ r0\ =\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}\ -\/\ \mbox{\hyperlink{_tutorial___advanced_initialization___comma_temporary_8cpp_a5d2ded7a4c8830608d7b218f5f27c0a0}{mat}}\ *\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}};\ }
\DoxyCodeLine{00254\ \ \ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a7e47d437b590be8af0e9972e60adbe34}{RealScalar}}\ \mbox{\hyperlink{wave_8c_aabc9b3ee8fafa62b353f3956f8e3c269}{beta}}\ =\ r0.norm();\ }
\DoxyCodeLine{00255\ \ \ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a7e47d437b590be8af0e9972e60adbe34}{RealScalar}}\ normRhs\ =\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}.norm();}
\DoxyCodeLine{00256\ \ \ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a87ced7feba8050ad4c5216f03f639314}{m\_error}}\ =\ \mbox{\hyperlink{wave_8c_aabc9b3ee8fafa62b353f3956f8e3c269}{beta}}/normRhs;\ }
\DoxyCodeLine{00257\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a87ced7feba8050ad4c5216f03f639314}{m\_error}}\ <\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a9a35eca68b78f8905c7b28f08de10ba2}{m\_tolerance}})}
\DoxyCodeLine{00258\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a8138d5bb2cbcf249c2453292dd9a9085}{m\_info}}\ =\ \mbox{\hyperlink{group__enums_gga85fad7b87587764e5cf6b513a9e0ee5ea671a2aeb0f527802806a441d58a80fcf}{Success}};\ }
\DoxyCodeLine{00259\ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00260\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a8138d5bb2cbcf249c2453292dd9a9085}{m\_info}}\ =\ \mbox{\hyperlink{group__enums_gga85fad7b87587764e5cf6b513a9e0ee5ea6a68dfb88a8336108a30588bdf356c57}{NoConvergence}};}
\DoxyCodeLine{00261\ \ \ }
\DoxyCodeLine{00262\ \ \ \textcolor{comment}{//\ Iterative\ process}}
\DoxyCodeLine{00263\ \ \ \textcolor{keywordflow}{while}\ (nbIts\ <\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a8055c459b5a984a1a2fa6dcb2ccaaf88}{m\_iterations}}\ \&\&\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a8138d5bb2cbcf249c2453292dd9a9085}{m\_info}}\ ==\ \mbox{\hyperlink{group__enums_gga85fad7b87587764e5cf6b513a9e0ee5ea6a68dfb88a8336108a30588bdf356c57}{NoConvergence}})}
\DoxyCodeLine{00264\ \ \ \{}
\DoxyCodeLine{00265\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_ab77d66ef7f84ff15b6bd55fb76619218}{dgmresCycle}}(\mbox{\hyperlink{_tutorial___advanced_initialization___comma_temporary_8cpp_a5d2ded7a4c8830608d7b218f5f27c0a0}{mat}},\ precond,\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}},\ r0,\ \mbox{\hyperlink{wave_8c_aabc9b3ee8fafa62b353f3956f8e3c269}{beta}},\ normRhs,\ nbIts);\ }
\DoxyCodeLine{00266\ \ \ \ \ }
\DoxyCodeLine{00267\ \ \ \ \ \textcolor{comment}{//\ Compute\ the\ new\ residual\ vector\ for\ the\ restart\ }}
\DoxyCodeLine{00268\ \ \ \ \ \textcolor{keywordflow}{if}\ (nbIts\ <\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a8055c459b5a984a1a2fa6dcb2ccaaf88}{m\_iterations}}\ \&\&\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a8138d5bb2cbcf249c2453292dd9a9085}{m\_info}}\ ==\ \mbox{\hyperlink{group__enums_gga85fad7b87587764e5cf6b513a9e0ee5ea6a68dfb88a8336108a30588bdf356c57}{NoConvergence}})}
\DoxyCodeLine{00269\ \ \ \ \ \ \ r0\ =\ \mbox{\hyperlink{poisson_8cpp_a38c677f5cc4e47bc7505aef707c1bb83}{rhs}}\ -\/\ \mbox{\hyperlink{_tutorial___advanced_initialization___comma_temporary_8cpp_a5d2ded7a4c8830608d7b218f5f27c0a0}{mat}}\ *\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}};\ }
\DoxyCodeLine{00270\ \ \ \}}
\DoxyCodeLine{00271\ \}\ }
\DoxyCodeLine{00272\ }
\DoxyCodeLine{00283\ \textcolor{keyword}{template}<\ \textcolor{keyword}{typename}\ \_MatrixType,\ \textcolor{keyword}{typename}\ \_Preconditioner>}
\DoxyCodeLine{00284\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ Dest>}
\DoxyCodeLine{00285\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_ab77d66ef7f84ff15b6bd55fb76619218}{DGMRES<\_MatrixType,\ \_Preconditioner>::dgmresCycle}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_abebf2c0dc490d410fbf5f24dedc60712}{MatrixType}}\&\ \mbox{\hyperlink{_tutorial___advanced_initialization___comma_temporary_8cpp_a5d2ded7a4c8830608d7b218f5f27c0a0}{mat}},\ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_acae98b6f30d350a136ed4bc3a270834b}{Preconditioner}}\&\ precond,\ Dest\&\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}},\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a1d85b943c99dabf606c6c537e550b11b}{DenseVector}}\&\ r0,\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a7e47d437b590be8af0e9972e60adbe34}{RealScalar}}\&\ \mbox{\hyperlink{wave_8c_aabc9b3ee8fafa62b353f3956f8e3c269}{beta}},\ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a7e47d437b590be8af0e9972e60adbe34}{RealScalar}}\&\ normRhs,\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\&\ nbIts)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00286\ \textcolor{keyword}{}\{}
\DoxyCodeLine{00287\ \ \ \textcolor{comment}{//Initialization\ }}
\DoxyCodeLine{00288\ \ \ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a1d85b943c99dabf606c6c537e550b11b}{DenseVector}}\ \mbox{\hyperlink{offscreen_8c_a8cf17d727651616de6f2b79ef32170cd}{g}}(\mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_ab5f0105c1ff3d035054a12624f69181b}{m\_restart}}+1);\ \textcolor{comment}{//\ Right\ hand\ side\ of\ the\ least\ square\ problem}}
\DoxyCodeLine{00289\ \ \ \mbox{\hyperlink{offscreen_8c_a8cf17d727651616de6f2b79ef32170cd}{g}}.setZero();\ \ }
\DoxyCodeLine{00290\ \ \ \mbox{\hyperlink{offscreen_8c_a8cf17d727651616de6f2b79ef32170cd}{g}}(0)\ =\ \mbox{\hyperlink{bench__gemm_8cpp_a052eb942d12b6404aade6fae4b075fb9}{Scalar}}(\mbox{\hyperlink{wave_8c_aabc9b3ee8fafa62b353f3956f8e3c269}{beta}});\ }
\DoxyCodeLine{00291\ \ \ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a0fc43b2cca1d84701f629466d39d52b6}{m\_V}}.col(0)\ =\ r0/\mbox{\hyperlink{wave_8c_aabc9b3ee8fafa62b353f3956f8e3c269}{beta}};\ }
\DoxyCodeLine{00292\ \ \ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a8138d5bb2cbcf249c2453292dd9a9085}{m\_info}}\ =\ \mbox{\hyperlink{group__enums_gga85fad7b87587764e5cf6b513a9e0ee5ea6a68dfb88a8336108a30588bdf356c57}{NoConvergence}};\ }
\DoxyCodeLine{00293\ \ \ std::vector<JacobiRotation<Scalar>\ >gr(\mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_ab5f0105c1ff3d035054a12624f69181b}{m\_restart}});\ \textcolor{comment}{//\ Givens\ rotations}}
\DoxyCodeLine{00294\ \ \ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ it\ =\ 0;\ \textcolor{comment}{//\ Number\ of\ inner\ iterations\ }}
\DoxyCodeLine{00295\ \ \ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}\ =\ \mbox{\hyperlink{_tutorial___advanced_initialization___comma_temporary_8cpp_a5d2ded7a4c8830608d7b218f5f27c0a0}{mat}}.rows();}
\DoxyCodeLine{00296\ \ \ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a1d85b943c99dabf606c6c537e550b11b}{DenseVector}}\ tv1(\mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}),\ tv2(\mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}});\ \ \textcolor{comment}{//Temporary\ vectors}}
\DoxyCodeLine{00297\ \ \ \textcolor{keywordflow}{while}\ (\mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a8138d5bb2cbcf249c2453292dd9a9085}{m\_info}}\ ==\ \mbox{\hyperlink{group__enums_gga85fad7b87587764e5cf6b513a9e0ee5ea6a68dfb88a8336108a30588bdf356c57}{NoConvergence}}\ \&\&\ it\ <\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_ab5f0105c1ff3d035054a12624f69181b}{m\_restart}}\ \&\&\ nbIts\ <\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a8055c459b5a984a1a2fa6dcb2ccaaf88}{m\_iterations}})}
\DoxyCodeLine{00298\ \ \ \{\ \ \ \ }
\DoxyCodeLine{00299\ \ \ \ \ \textcolor{comment}{//\ Apply\ preconditioner(s)\ at\ right}}
\DoxyCodeLine{00300\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_afc8a3fc0175e8a0905cb6870703ef2f9}{m\_isDeflInitialized}}\ )}
\DoxyCodeLine{00301\ \ \ \ \ \{}
\DoxyCodeLine{00302\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_af0cb72e1c8fa37895d1543b1bb09f9d2}{dgmresApplyDeflation}}(\mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a0fc43b2cca1d84701f629466d39d52b6}{m\_V}}.col(it),\ tv1);\ \textcolor{comment}{//\ Deflation}}
\DoxyCodeLine{00303\ \ \ \ \ \ \ tv2\ =\ precond.solve(tv1);\ }
\DoxyCodeLine{00304\ \ \ \ \ \}}
\DoxyCodeLine{00305\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00306\ \ \ \ \ \{}
\DoxyCodeLine{00307\ \ \ \ \ \ \ tv2\ =\ precond.solve(\mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a0fc43b2cca1d84701f629466d39d52b6}{m\_V}}.col(it));\ \textcolor{comment}{//\ User's\ selected\ preconditioner}}
\DoxyCodeLine{00308\ \ \ \ \ \}}
\DoxyCodeLine{00309\ \ \ \ \ tv1\ =\ \mbox{\hyperlink{_tutorial___advanced_initialization___comma_temporary_8cpp_a5d2ded7a4c8830608d7b218f5f27c0a0}{mat}}\ *\ tv2;\ }
\DoxyCodeLine{00310\ \ \ \ }
\DoxyCodeLine{00311\ \ \ \ \ \textcolor{comment}{//\ Orthogonalize\ it\ with\ the\ previous\ basis\ in\ the\ basis\ using\ modified\ Gram-\/Schmidt}}
\DoxyCodeLine{00312\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_aa2172314b09dbddeb3661ca9c809b371}{Scalar}}\ coef;\ }
\DoxyCodeLine{00313\ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ =\ 0;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ <=\ it;\ ++\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})}
\DoxyCodeLine{00314\ \ \ \ \ \{\ }
\DoxyCodeLine{00315\ \ \ \ \ \ \ coef\ =\ tv1.dot(\mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a0fc43b2cca1d84701f629466d39d52b6}{m\_V}}.col(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}));}
\DoxyCodeLine{00316\ \ \ \ \ \ \ tv1\ =\ tv1\ -\/\ coef\ *\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a0fc43b2cca1d84701f629466d39d52b6}{m\_V}}.col(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}});\ }
\DoxyCodeLine{00317\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_abaa2292705aa731d5051b01c1be41dfb}{m\_H}}(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}},it)\ =\ coef;\ }
\DoxyCodeLine{00318\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a3a611fc8ad4380f552d8ee7080b27c04}{m\_Hes}}(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}},it)\ =\ coef;\ }
\DoxyCodeLine{00319\ \ \ \ \ \}}
\DoxyCodeLine{00320\ \ \ \ \ \textcolor{comment}{//\ Normalize\ the\ vector\ }}
\DoxyCodeLine{00321\ \ \ \ \ coef\ =\ tv1.norm();\ }
\DoxyCodeLine{00322\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a0fc43b2cca1d84701f629466d39d52b6}{m\_V}}.col(it+1)\ =\ tv1/coef;}
\DoxyCodeLine{00323\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_abaa2292705aa731d5051b01c1be41dfb}{m\_H}}(it+1,\ it)\ =\ coef;}
\DoxyCodeLine{00324\ \textcolor{comment}{//\ \ \ \ \ m\_Hes(it+1,it)\ =\ coef;\ }}
\DoxyCodeLine{00325\ \ \ \ \ }
\DoxyCodeLine{00326\ \ \ \ \ \textcolor{comment}{//\ FIXME\ Check\ for\ happy\ breakdown\ }}
\DoxyCodeLine{00327\ \ \ \ \ }
\DoxyCodeLine{00328\ \ \ \ \ \textcolor{comment}{//\ Update\ Hessenberg\ matrix\ with\ Givens\ rotations}}
\DoxyCodeLine{00329\ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ =\ 1;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ <=\ it;\ ++\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})\ }
\DoxyCodeLine{00330\ \ \ \ \ \{}
\DoxyCodeLine{00331\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_abaa2292705aa731d5051b01c1be41dfb}{m\_H}}.col(it).applyOnTheLeft(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}-\/1,\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}},gr[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}-\/1].\mbox{\hyperlink{adjoint_8cpp_a7333648f53414b05be9e4fd2f009fc22}{adjoint}}());}
\DoxyCodeLine{00332\ \ \ \ \ \}}
\DoxyCodeLine{00333\ \ \ \ \ \textcolor{comment}{//\ Compute\ the\ new\ plane\ rotation\ }}
\DoxyCodeLine{00334\ \ \ \ \ gr[it].makeGivens(\mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_abaa2292705aa731d5051b01c1be41dfb}{m\_H}}(it,\ it),\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_abaa2292705aa731d5051b01c1be41dfb}{m\_H}}(it+1,it));\ }
\DoxyCodeLine{00335\ \ \ \ \ \textcolor{comment}{//\ Apply\ the\ new\ rotation}}
\DoxyCodeLine{00336\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_abaa2292705aa731d5051b01c1be41dfb}{m\_H}}.col(it).applyOnTheLeft(it,it+1,gr[it].\mbox{\hyperlink{adjoint_8cpp_a7333648f53414b05be9e4fd2f009fc22}{adjoint}}());}
\DoxyCodeLine{00337\ \ \ \ \ \mbox{\hyperlink{offscreen_8c_a8cf17d727651616de6f2b79ef32170cd}{g}}.applyOnTheLeft(it,it+1,\ gr[it].\mbox{\hyperlink{adjoint_8cpp_a7333648f53414b05be9e4fd2f009fc22}{adjoint}}());\ }
\DoxyCodeLine{00338\ \ \ \ \ }
\DoxyCodeLine{00339\ \ \ \ \ \mbox{\hyperlink{wave_8c_aabc9b3ee8fafa62b353f3956f8e3c269}{beta}}\ =\ std::abs(\mbox{\hyperlink{offscreen_8c_a8cf17d727651616de6f2b79ef32170cd}{g}}(it+1));}
\DoxyCodeLine{00340\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a87ced7feba8050ad4c5216f03f639314}{m\_error}}\ =\ \mbox{\hyperlink{wave_8c_aabc9b3ee8fafa62b353f3956f8e3c269}{beta}}/normRhs;\ }
\DoxyCodeLine{00341\ \ \ \ \ \textcolor{comment}{//\ std::cerr\ <<\ nbIts\ <<\ "{}\ Relative\ Residual\ Norm\ "{}\ <<\ m\_error\ <<\ std::endl;}}
\DoxyCodeLine{00342\ \ \ \ \ it++;\ nbIts++;\ }
\DoxyCodeLine{00343\ \ \ \ \ }
\DoxyCodeLine{00344\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a87ced7feba8050ad4c5216f03f639314}{m\_error}}\ <\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a9a35eca68b78f8905c7b28f08de10ba2}{m\_tolerance}})}
\DoxyCodeLine{00345\ \ \ \ \ \{}
\DoxyCodeLine{00346\ \ \ \ \ \ \ \textcolor{comment}{//\ The\ method\ has\ converged}}
\DoxyCodeLine{00347\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a8138d5bb2cbcf249c2453292dd9a9085}{m\_info}}\ =\ \mbox{\hyperlink{group__enums_gga85fad7b87587764e5cf6b513a9e0ee5ea671a2aeb0f527802806a441d58a80fcf}{Success}};}
\DoxyCodeLine{00348\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00349\ \ \ \ \ \}}
\DoxyCodeLine{00350\ \ \ \}}
\DoxyCodeLine{00351\ \ \ }
\DoxyCodeLine{00352\ \ \ \textcolor{comment}{//\ Compute\ the\ new\ coefficients\ by\ solving\ the\ least\ square\ problem}}
\DoxyCodeLine{00353\ \textcolor{comment}{//\ \ \ it++;}}
\DoxyCodeLine{00354\ \ \ \textcolor{comment}{//FIXME\ \ Check\ first\ if\ the\ matrix\ is\ singular\ ...\ zero\ diagonal}}
\DoxyCodeLine{00355\ \ \ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a1d85b943c99dabf606c6c537e550b11b}{DenseVector}}\ nrs(\mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_ab5f0105c1ff3d035054a12624f69181b}{m\_restart}});\ }
\DoxyCodeLine{00356\ \ \ nrs\ =\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_abaa2292705aa731d5051b01c1be41dfb}{m\_H}}.topLeftCorner(it,it).template\ triangularView<Upper>().solve(\mbox{\hyperlink{offscreen_8c_a8cf17d727651616de6f2b79ef32170cd}{g}}.head(it));\ }
\DoxyCodeLine{00357\ \ \ }
\DoxyCodeLine{00358\ \ \ \textcolor{comment}{//\ Form\ the\ new\ solution}}
\DoxyCodeLine{00359\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_afc8a3fc0175e8a0905cb6870703ef2f9}{m\_isDeflInitialized}})}
\DoxyCodeLine{00360\ \ \ \{}
\DoxyCodeLine{00361\ \ \ \ \ tv1\ =\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a0fc43b2cca1d84701f629466d39d52b6}{m\_V}}.leftCols(it)\ *\ nrs;\ }
\DoxyCodeLine{00362\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_af0cb72e1c8fa37895d1543b1bb09f9d2}{dgmresApplyDeflation}}(tv1,\ tv2);\ }
\DoxyCodeLine{00363\ \ \ \ \ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}}\ =\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}}\ +\ precond.solve(tv2);}
\DoxyCodeLine{00364\ \ \ \}}
\DoxyCodeLine{00365\ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00366\ \ \ \ \ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}}\ =\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}}\ +\ precond.solve(\mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a0fc43b2cca1d84701f629466d39d52b6}{m\_V}}.leftCols(it)\ *\ nrs);\ }
\DoxyCodeLine{00367\ \ \ }
\DoxyCodeLine{00368\ \ \ \textcolor{comment}{//\ Go\ for\ a\ new\ cycle\ and\ compute\ data\ for\ deflation}}
\DoxyCodeLine{00369\ \ \ \textcolor{keywordflow}{if}(nbIts\ <\ m\_iterations\ \&\&\ m\_info\ ==\ NoConvergence\ \&\&\ m\_neig\ >\ 0\ \&\&\ (\mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a5a3ef71312bce5745aaeaced22b48d91}{m\_r}}+\mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a30674252b8ac12e303f0ec114e574492}{m\_neig}})\ <\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a08debe5d30604a03a674d4ba3f7a3bbc}{m\_maxNeig}})}
\DoxyCodeLine{00370\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a7bada6df49a235ad404802bc4e04b598}{dgmresComputeDeflationData}}(\mbox{\hyperlink{_tutorial___advanced_initialization___comma_temporary_8cpp_a5d2ded7a4c8830608d7b218f5f27c0a0}{mat}},\ precond,\ it,\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a30674252b8ac12e303f0ec114e574492}{m\_neig}});\ }
\DoxyCodeLine{00371\ \ \ \textcolor{keywordflow}{return}\ 0;\ }
\DoxyCodeLine{00372\ \ \ }
\DoxyCodeLine{00373\ \}}
\DoxyCodeLine{00374\ }
\DoxyCodeLine{00375\ }
\DoxyCodeLine{00376\ \textcolor{keyword}{template}<\ \textcolor{keyword}{typename}\ \_MatrixType,\ \textcolor{keyword}{typename}\ \_Preconditioner>}
\DoxyCodeLine{00377\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a505c49553b8df373734e1a02e1c5ca70}{DGMRES<\_MatrixType,\ \_Preconditioner>::dgmresInitDeflation}}(\mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\&\ \mbox{\hyperlink{class_eigen_1_1_iterative_solver_base_a51213f927ba8c833807544bf5e58c8b9}{rows}})\textcolor{keyword}{\ const}}
\DoxyCodeLine{00378\ \textcolor{keyword}{}\{}
\DoxyCodeLine{00379\ \ \ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a42caf1bb06f1833c434a1b169db79ac3}{m\_U}}.resize(\mbox{\hyperlink{class_eigen_1_1_iterative_solver_base_a51213f927ba8c833807544bf5e58c8b9}{rows}},\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a08debe5d30604a03a674d4ba3f7a3bbc}{m\_maxNeig}});}
\DoxyCodeLine{00380\ \ \ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a19258f96b65369998943d21b5487cf56}{m\_MU}}.resize(\mbox{\hyperlink{class_eigen_1_1_iterative_solver_base_a51213f927ba8c833807544bf5e58c8b9}{rows}},\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a08debe5d30604a03a674d4ba3f7a3bbc}{m\_maxNeig}});\ }
\DoxyCodeLine{00381\ \ \ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_ad37060ad7b0dd4136bc217fa6078965a}{m\_T}}.resize(\mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a08debe5d30604a03a674d4ba3f7a3bbc}{m\_maxNeig}},\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a08debe5d30604a03a674d4ba3f7a3bbc}{m\_maxNeig}});}
\DoxyCodeLine{00382\ \ \ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a1df5e45bd1aeef2c34a0d4777fd3f95b}{m\_lambdaN}}\ =\ 0.0;\ }
\DoxyCodeLine{00383\ \ \ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a38beee7707cc020cb666061bdd7c6f7e}{m\_isDeflAllocated}}\ =\ \textcolor{keyword}{true};\ }
\DoxyCodeLine{00384\ \}}
\DoxyCodeLine{00385\ }
\DoxyCodeLine{00386\ \textcolor{keyword}{template}<\ \textcolor{keyword}{typename}\ \_MatrixType,\ \textcolor{keyword}{typename}\ \_Preconditioner>}
\DoxyCodeLine{00387\ \textcolor{keyword}{inline}\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_aeace9fdbc1373362c29409003482d66a}{DGMRES<\_MatrixType,\ \_Preconditioner>::ComplexVector}}\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a92363374b8dbe7832b2b7560362c47e7}{DGMRES<\_MatrixType,\ \_Preconditioner>::schurValues}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_complex_schur}{ComplexSchur<DenseMatrix>}}\&\ schurofH)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00388\ \textcolor{keyword}{}\{}
\DoxyCodeLine{00389\ \ \ \textcolor{keywordflow}{return}\ schurofH.\mbox{\hyperlink{class_eigen_1_1_complex_schur_a210b9d7e6c26fdde18aa5720da1d3e3c}{matrixT}}().diagonal();}
\DoxyCodeLine{00390\ \}}
\DoxyCodeLine{00391\ }
\DoxyCodeLine{00392\ \textcolor{keyword}{template}<\ \textcolor{keyword}{typename}\ \_MatrixType,\ \textcolor{keyword}{typename}\ \_Preconditioner>}
\DoxyCodeLine{00393\ \textcolor{keyword}{inline}\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_aeace9fdbc1373362c29409003482d66a}{DGMRES<\_MatrixType,\ \_Preconditioner>::ComplexVector}}\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a92363374b8dbe7832b2b7560362c47e7}{DGMRES<\_MatrixType,\ \_Preconditioner>::schurValues}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_real_schur}{RealSchur<DenseMatrix>}}\&\ schurofH)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00394\ \textcolor{keyword}{}\{}
\DoxyCodeLine{00395\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a87d1411656955d8c3f053cfc2be4a856}{DenseMatrix}}\&\ \mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}}\ =\ schurofH.\mbox{\hyperlink{class_eigen_1_1_real_schur_a8d900b181760973d894d71e32597e998}{matrixT}}();}
\DoxyCodeLine{00396\ \ \ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ it\ =\ \mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}}.rows();}
\DoxyCodeLine{00397\ \ \ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_aeace9fdbc1373362c29409003482d66a}{ComplexVector}}\ \mbox{\hyperlink{eigenvalues_8cpp_a2207d894607fb09f7abc525577172078}{eig}}(it);}
\DoxyCodeLine{00398\ \ \ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}\ =\ 0;}
\DoxyCodeLine{00399\ \ \ \textcolor{keywordflow}{while}\ (\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}\ <\ it-\/1)}
\DoxyCodeLine{00400\ \ \ \{}
\DoxyCodeLine{00401\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}}(\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}+1,\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}})\ ==\mbox{\hyperlink{bench__gemm_8cpp_a052eb942d12b6404aade6fae4b075fb9}{Scalar}}(0))}
\DoxyCodeLine{00402\ \ \ \ \ \{}
\DoxyCodeLine{00403\ \ \ \ \ \ \ \mbox{\hyperlink{eigenvalues_8cpp_a2207d894607fb09f7abc525577172078}{eig}}(\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}})\ =\ std::complex<RealScalar>(\mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}}(\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}},\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}),\mbox{\hyperlink{bench__gemm_8cpp_acb5c3dc237f99cf17167e8a629f01b43}{RealScalar}}(0));\ }
\DoxyCodeLine{00404\ \ \ \ \ \ \ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}++;\ }
\DoxyCodeLine{00405\ \ \ \ \ \}}
\DoxyCodeLine{00406\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00407\ \ \ \ \ \{}
\DoxyCodeLine{00408\ \ \ \ \ \ \ \mbox{\hyperlink{eigenvalues_8cpp_a2207d894607fb09f7abc525577172078}{eig}}(\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}})\ =\ std::complex<RealScalar>(\mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}}(\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}},\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}),\mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}}(\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}+1,\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}));\ }
\DoxyCodeLine{00409\ \ \ \ \ \ \ \mbox{\hyperlink{eigenvalues_8cpp_a2207d894607fb09f7abc525577172078}{eig}}(\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}+1)\ =\ std::complex<RealScalar>(\mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}}(\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}},\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}+1),\mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}}(\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}+1,\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}+1));}
\DoxyCodeLine{00410\ \ \ \ \ \ \ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}++;}
\DoxyCodeLine{00411\ \ \ \ \ \}}
\DoxyCodeLine{00412\ \ \ \}}
\DoxyCodeLine{00413\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}\ <\ it-\/1)\ \mbox{\hyperlink{eigenvalues_8cpp_a2207d894607fb09f7abc525577172078}{eig}}(\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}})\ =\ std::complex<RealScalar>(\mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}}(\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}},\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}),\mbox{\hyperlink{bench__gemm_8cpp_acb5c3dc237f99cf17167e8a629f01b43}{RealScalar}}(0));}
\DoxyCodeLine{00414\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{eigenvalues_8cpp_a2207d894607fb09f7abc525577172078}{eig}};}
\DoxyCodeLine{00415\ \}}
\DoxyCodeLine{00416\ }
\DoxyCodeLine{00417\ \textcolor{keyword}{template}<\ \textcolor{keyword}{typename}\ \_MatrixType,\ \textcolor{keyword}{typename}\ \_Preconditioner>}
\DoxyCodeLine{00418\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a7bada6df49a235ad404802bc4e04b598}{DGMRES<\_MatrixType,\ \_Preconditioner>::dgmresComputeDeflationData}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_abebf2c0dc490d410fbf5f24dedc60712}{MatrixType}}\&\ \mbox{\hyperlink{_tutorial___advanced_initialization___comma_temporary_8cpp_a5d2ded7a4c8830608d7b218f5f27c0a0}{mat}},\ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_acae98b6f30d350a136ed4bc3a270834b}{Preconditioner}}\&\ precond,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\&\ it,\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a5e96d9b5ca6098272003550ef87c32d2}{StorageIndex}}\&\ neig)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00419\ \textcolor{keyword}{}\{}
\DoxyCodeLine{00420\ \ \ \textcolor{comment}{//\ First,\ find\ the\ Schur\ form\ of\ the\ Hessenberg\ matrix\ H}}
\DoxyCodeLine{00421\ \ \ \textcolor{keyword}{typename}\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1conditional}{internal::conditional<NumTraits<Scalar>::IsComplex}},\ \mbox{\hyperlink{class_eigen_1_1_complex_schur}{ComplexSchur<DenseMatrix>}},\ \mbox{\hyperlink{class_eigen_1_1_real_schur}{RealSchur<DenseMatrix>}}\ >\mbox{\hyperlink{struct_eigen_1_1_packet_type}{::type}}\ schurofH;\ }
\DoxyCodeLine{00422\ \ \ \textcolor{keywordtype}{bool}\ computeU\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00423\ \ \ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a87d1411656955d8c3f053cfc2be4a856}{DenseMatrix}}\ matrixQ(it,it);\ }
\DoxyCodeLine{00424\ \ \ matrixQ.setIdentity();}
\DoxyCodeLine{00425\ \ \ schurofH.computeFromHessenberg(\mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a3a611fc8ad4380f552d8ee7080b27c04}{m\_Hes}}.topLeftCorner(it,it),\ matrixQ,\ computeU);\ }
\DoxyCodeLine{00426\ \ \ }
\DoxyCodeLine{00427\ \ \ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_aeace9fdbc1373362c29409003482d66a}{ComplexVector}}\ \mbox{\hyperlink{eigenvalues_8cpp_a2207d894607fb09f7abc525577172078}{eig}}(it);}
\DoxyCodeLine{00428\ \ \ \mbox{\hyperlink{class_eigen_1_1_matrix}{Matrix<StorageIndex,Dynamic,1>}}perm(it);}
\DoxyCodeLine{00429\ \ \ \mbox{\hyperlink{eigenvalues_8cpp_a2207d894607fb09f7abc525577172078}{eig}}\ =\ this-\/>\mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a92363374b8dbe7832b2b7560362c47e7}{schurValues}}(schurofH);}
\DoxyCodeLine{00430\ \ \ }
\DoxyCodeLine{00431\ \ \ \textcolor{comment}{//\ Reorder\ the\ absolute\ values\ of\ Schur\ values}}
\DoxyCodeLine{00432\ \ \ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a9ffdf6b47010f636fcc1a071a9e9e16c}{DenseRealVector}}\ modulEig(it);\ }
\DoxyCodeLine{00433\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}=0;\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}<it;\ ++\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}})\ modulEig(\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}})\ =\ std::abs(\mbox{\hyperlink{eigenvalues_8cpp_a2207d894607fb09f7abc525577172078}{eig}}(\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}));\ }
\DoxyCodeLine{00434\ \ \ perm.setLinSpaced(it,0,\mbox{\hyperlink{namespace_eigen_1_1internal_a66f17ef65b1821965dcb8ad9a660b064}{internal::convert\_index<StorageIndex>}}(it-\/1));}
\DoxyCodeLine{00435\ \ \ \mbox{\hyperlink{namespace_eigen_1_1internal_afe2a11c61eff70f7f68681a557fa21e7}{internal::sortWithPermutation}}(modulEig,\ perm,\ neig);}
\DoxyCodeLine{00436\ \ \ }
\DoxyCodeLine{00437\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a1df5e45bd1aeef2c34a0d4777fd3f95b}{m\_lambdaN}})}
\DoxyCodeLine{00438\ \ \ \{}
\DoxyCodeLine{00439\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a1df5e45bd1aeef2c34a0d4777fd3f95b}{m\_lambdaN}}\ =\ (std::max)(modulEig.maxCoeff(),\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a1df5e45bd1aeef2c34a0d4777fd3f95b}{m\_lambdaN}});}
\DoxyCodeLine{00440\ \ \ \}}
\DoxyCodeLine{00441\ \ \ \textcolor{comment}{//Count\ the\ real\ number\ of\ extracted\ eigenvalues\ (with\ complex\ conjugates)}}
\DoxyCodeLine{00442\ \ \ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ nbrEig\ =\ 0;\ }
\DoxyCodeLine{00443\ \ \ \textcolor{keywordflow}{while}\ (nbrEig\ <\ neig)}
\DoxyCodeLine{00444\ \ \ \{}
\DoxyCodeLine{00445\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{eigenvalues_8cpp_a2207d894607fb09f7abc525577172078}{eig}}(perm(it-\/nbrEig-\/1)).\mbox{\hyperlink{_common_cwise_unary_ops_8h_a8cc3d2f4413a156b2ec6a3097efd3aa4}{imag}}()\ ==\ \mbox{\hyperlink{bench__gemm_8cpp_acb5c3dc237f99cf17167e8a629f01b43}{RealScalar}}(0))\ nbrEig++;\ }
\DoxyCodeLine{00446\ \ \ \ \ \textcolor{keywordflow}{else}\ nbrEig\ +=\ 2;\ }
\DoxyCodeLine{00447\ \ \ \}}
\DoxyCodeLine{00448\ \ \ \textcolor{comment}{//\ Extract\ the\ \ Schur\ vectors\ corresponding\ to\ the\ smallest\ Ritz\ values}}
\DoxyCodeLine{00449\ \ \ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a87d1411656955d8c3f053cfc2be4a856}{DenseMatrix}}\ Sr(it,\ nbrEig);\ }
\DoxyCodeLine{00450\ \ \ Sr.\mbox{\hyperlink{class_eigen_1_1_plain_object_base_ac21ad5f989f320e46958b75ac8d9a1da}{setZero}}();}
\DoxyCodeLine{00451\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}\ =\ 0;\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}\ <\ nbrEig;\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}++)}
\DoxyCodeLine{00452\ \ \ \{}
\DoxyCodeLine{00453\ \ \ \ \ Sr.col(\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}})\ =\ schurofH.matrixU().col(perm(it-\/\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}-\/1));}
\DoxyCodeLine{00454\ \ \ \}}
\DoxyCodeLine{00455\ \ \ }
\DoxyCodeLine{00456\ \ \ \textcolor{comment}{//\ Form\ the\ Schur\ vectors\ of\ the\ initial\ matrix\ using\ the\ Krylov\ basis}}
\DoxyCodeLine{00457\ \ \ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a87d1411656955d8c3f053cfc2be4a856}{DenseMatrix}}\ \mbox{\hyperlink{icosphere_8cpp_a207fd5507206d307cd63f95374fcd00d}{X}};\ }
\DoxyCodeLine{00458\ \ \ \mbox{\hyperlink{icosphere_8cpp_a207fd5507206d307cd63f95374fcd00d}{X}}\ =\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a0fc43b2cca1d84701f629466d39d52b6}{m\_V}}.leftCols(it)\ *\ Sr;}
\DoxyCodeLine{00459\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a5a3ef71312bce5745aaeaced22b48d91}{m\_r}})}
\DoxyCodeLine{00460\ \ \ \{}
\DoxyCodeLine{00461\ \ \ \ \textcolor{comment}{//\ Orthogonalize\ X\ against\ m\_U\ using\ modified\ Gram-\/Schmidt}}
\DoxyCodeLine{00462\ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}\ =\ 0;\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}\ <\ nbrEig;\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}++)}
\DoxyCodeLine{00463\ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ k\ =0;\ k\ <\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a5a3ef71312bce5745aaeaced22b48d91}{m\_r}};\ k++)}
\DoxyCodeLine{00464\ \ \ \ \ \ \ \mbox{\hyperlink{icosphere_8cpp_a207fd5507206d307cd63f95374fcd00d}{X}}.col(\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}})\ =\ \mbox{\hyperlink{icosphere_8cpp_a207fd5507206d307cd63f95374fcd00d}{X}}.col(\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}})\ -\/\ (\mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a42caf1bb06f1833c434a1b169db79ac3}{m\_U}}.col(k).\mbox{\hyperlink{level1__real__impl_8h_a7a40e5a367460d00c6cdeeb23e8b780b}{dot}}(\mbox{\hyperlink{icosphere_8cpp_a207fd5507206d307cd63f95374fcd00d}{X}}.col(\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}})))*\mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a42caf1bb06f1833c434a1b169db79ac3}{m\_U}}.col(k);\ }
\DoxyCodeLine{00465\ \ \ \}}
\DoxyCodeLine{00466\ \ \ }
\DoxyCodeLine{00467\ \ \ \textcolor{comment}{//\ Compute\ m\_MX\ =\ A\ *\ M\string^-\/1\ *\ X}}
\DoxyCodeLine{00468\ \ \ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ \mbox{\hyperlink{_angle_axis__mimic__euler_8cpp_ab3cd915d758008bd19d0f2428fbb354a}{m}}\ =\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a0fc43b2cca1d84701f629466d39d52b6}{m\_V}}.rows();}
\DoxyCodeLine{00469\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a38beee7707cc020cb666061bdd7c6f7e}{m\_isDeflAllocated}})\ }
\DoxyCodeLine{00470\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a505c49553b8df373734e1a02e1c5ca70}{dgmresInitDeflation}}(\mbox{\hyperlink{_angle_axis__mimic__euler_8cpp_ab3cd915d758008bd19d0f2428fbb354a}{m}});\ }
\DoxyCodeLine{00471\ \ \ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a87d1411656955d8c3f053cfc2be4a856}{DenseMatrix}}\ MX(\mbox{\hyperlink{_angle_axis__mimic__euler_8cpp_ab3cd915d758008bd19d0f2428fbb354a}{m}},\ nbrEig);}
\DoxyCodeLine{00472\ \ \ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a1d85b943c99dabf606c6c537e550b11b}{DenseVector}}\ tv1(\mbox{\hyperlink{_angle_axis__mimic__euler_8cpp_ab3cd915d758008bd19d0f2428fbb354a}{m}});}
\DoxyCodeLine{00473\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}\ =\ 0;\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}\ <\ nbrEig;\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}++)}
\DoxyCodeLine{00474\ \ \ \{}
\DoxyCodeLine{00475\ \ \ \ \ tv1\ =\ \mbox{\hyperlink{_tutorial___advanced_initialization___comma_temporary_8cpp_a5d2ded7a4c8830608d7b218f5f27c0a0}{mat}}\ *\ \mbox{\hyperlink{icosphere_8cpp_a207fd5507206d307cd63f95374fcd00d}{X}}.col(\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}});}
\DoxyCodeLine{00476\ \ \ \ \ MX.col(\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}})\ =\ precond.solve(tv1);}
\DoxyCodeLine{00477\ \ \ \}}
\DoxyCodeLine{00478\ \ \ }
\DoxyCodeLine{00479\ \ \ \textcolor{comment}{//Update\ m\_T\ =\ [U'MU\ U'MX;\ X'MU\ X'MX]}}
\DoxyCodeLine{00480\ \ \ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_ad37060ad7b0dd4136bc217fa6078965a}{m\_T}}.block(\mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a5a3ef71312bce5745aaeaced22b48d91}{m\_r}},\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a5a3ef71312bce5745aaeaced22b48d91}{m\_r}},\ nbrEig,\ nbrEig)\ =\ \mbox{\hyperlink{icosphere_8cpp_a207fd5507206d307cd63f95374fcd00d}{X}}.transpose()\ *\ MX;\ }
\DoxyCodeLine{00481\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a5a3ef71312bce5745aaeaced22b48d91}{m\_r}})}
\DoxyCodeLine{00482\ \ \ \{}
\DoxyCodeLine{00483\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_ad37060ad7b0dd4136bc217fa6078965a}{m\_T}}.block(0,\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a5a3ef71312bce5745aaeaced22b48d91}{m\_r}},\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a5a3ef71312bce5745aaeaced22b48d91}{m\_r}},\ nbrEig)\ =\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a42caf1bb06f1833c434a1b169db79ac3}{m\_U}}.leftCols(\mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a5a3ef71312bce5745aaeaced22b48d91}{m\_r}}).transpose()\ *\ MX;\ }
\DoxyCodeLine{00484\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_ad37060ad7b0dd4136bc217fa6078965a}{m\_T}}.block(\mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a5a3ef71312bce5745aaeaced22b48d91}{m\_r}},\ 0,\ nbrEig,\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a5a3ef71312bce5745aaeaced22b48d91}{m\_r}})\ =\ \mbox{\hyperlink{icosphere_8cpp_a207fd5507206d307cd63f95374fcd00d}{X}}.transpose()\ *\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a19258f96b65369998943d21b5487cf56}{m\_MU}}.leftCols(\mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a5a3ef71312bce5745aaeaced22b48d91}{m\_r}});}
\DoxyCodeLine{00485\ \ \ \}}
\DoxyCodeLine{00486\ \ \ }
\DoxyCodeLine{00487\ \ \ \textcolor{comment}{//\ Save\ X\ into\ m\_U\ and\ m\_MX\ in\ m\_MU}}
\DoxyCodeLine{00488\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}\ =\ 0;\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}\ <\ nbrEig;\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}++)\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a42caf1bb06f1833c434a1b169db79ac3}{m\_U}}.col(\mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a5a3ef71312bce5745aaeaced22b48d91}{m\_r}}+\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}})\ =\ \mbox{\hyperlink{icosphere_8cpp_a207fd5507206d307cd63f95374fcd00d}{X}}.col(\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}});}
\DoxyCodeLine{00489\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}\ =\ 0;\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}\ <\ nbrEig;\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}++)\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a19258f96b65369998943d21b5487cf56}{m\_MU}}.col(\mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a5a3ef71312bce5745aaeaced22b48d91}{m\_r}}+\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}})\ =\ MX.col(\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}});}
\DoxyCodeLine{00490\ \ \ \textcolor{comment}{//\ Increase\ the\ size\ of\ the\ invariant\ subspace}}
\DoxyCodeLine{00491\ \ \ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a5a3ef71312bce5745aaeaced22b48d91}{m\_r}}\ +=\ nbrEig;\ }
\DoxyCodeLine{00492\ \ \ }
\DoxyCodeLine{00493\ \ \ \textcolor{comment}{//\ Factorize\ m\_T\ into\ m\_luT}}
\DoxyCodeLine{00494\ \ \ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a5238b52b109ff6a22415f7be5b325e4b}{m\_luT}}.compute(\mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_ad37060ad7b0dd4136bc217fa6078965a}{m\_T}}.topLeftCorner(\mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a5a3ef71312bce5745aaeaced22b48d91}{m\_r}},\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a5a3ef71312bce5745aaeaced22b48d91}{m\_r}}));}
\DoxyCodeLine{00495\ \ \ }
\DoxyCodeLine{00496\ \ \ \textcolor{comment}{//FIXME\ CHeck\ if\ the\ factorization\ was\ correctly\ done\ (nonsingular\ matrix)}}
\DoxyCodeLine{00497\ \ \ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_afc8a3fc0175e8a0905cb6870703ef2f9}{m\_isDeflInitialized}}\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00498\ \ \ \textcolor{keywordflow}{return}\ 0;\ }
\DoxyCodeLine{00499\ \}}
\DoxyCodeLine{00500\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ \_MatrixType,\ \textcolor{keyword}{typename}\ \_Preconditioner>}
\DoxyCodeLine{00501\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ RhsType,\ \textcolor{keyword}{typename}\ DestType>}
\DoxyCodeLine{00502\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_af0cb72e1c8fa37895d1543b1bb09f9d2}{DGMRES<\_MatrixType,\ \_Preconditioner>::dgmresApplyDeflation}}(\textcolor{keyword}{const}\ RhsType\ \&\mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}},\ DestType\ \&\mbox{\hyperlink{namespace_eigen_ae998329a5bd49a32b6048a27e1a232a0}{y}})\textcolor{keyword}{\ const}}
\DoxyCodeLine{00503\ \textcolor{keyword}{}\{}
\DoxyCodeLine{00504\ \ \ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a1d85b943c99dabf606c6c537e550b11b}{DenseVector}}\ x1\ =\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a42caf1bb06f1833c434a1b169db79ac3}{m\_U}}.leftCols(\mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a5a3ef71312bce5745aaeaced22b48d91}{m\_r}}).transpose()\ *\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}};\ }
\DoxyCodeLine{00505\ \ \ \mbox{\hyperlink{namespace_eigen_ae998329a5bd49a32b6048a27e1a232a0}{y}}\ =\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}}\ +\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a42caf1bb06f1833c434a1b169db79ac3}{m\_U}}.leftCols(\mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a5a3ef71312bce5745aaeaced22b48d91}{m\_r}})\ *\ (\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a1df5e45bd1aeef2c34a0d4777fd3f95b}{m\_lambdaN}}\ *\ \mbox{\hyperlink{class_eigen_1_1_d_g_m_r_e_s_a5238b52b109ff6a22415f7be5b325e4b}{m\_luT}}.solve(x1)\ -\/\ x1);}
\DoxyCodeLine{00506\ \ \ \textcolor{keywordflow}{return}\ 0;\ }
\DoxyCodeLine{00507\ \}}
\DoxyCodeLine{00508\ }
\DoxyCodeLine{00509\ \}\ \textcolor{comment}{//\ end\ namespace\ Eigen}}
\DoxyCodeLine{00510\ \textcolor{preprocessor}{\#endif\ }}

\end{DoxyCode}
