\doxysection{strassen.\+hpp}
\hypertarget{strassen_8hpp_source}{}\label{strassen_8hpp_source}\index{external/taskflow/sandbox/strassen/strassen.hpp@{external/taskflow/sandbox/strassen/strassen.hpp}}
\mbox{\hyperlink{strassen_8hpp}{浏览该文件的文档.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{/**********************************************************************************************/}}
\DoxyCodeLine{00002\ \textcolor{comment}{/*\ \ This\ program\ is\ part\ of\ the\ Barcelona\ OpenMP\ Tasks\ Suite\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{00003\ \textcolor{comment}{/*\ \ Copyright\ (C)\ 2009\ Barcelona\ Supercomputing\ Center\ -\/\ Centro\ Nacional\ de\ Supercomputacion\ \ */}}
\DoxyCodeLine{00004\ \textcolor{comment}{/*\ \ Copyright\ (C)\ 2009\ Universitat\ Politecnica\ de\ Catalunya\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{00005\ \textcolor{comment}{/*\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{00006\ \textcolor{comment}{/*\ \ This\ program\ is\ free\ software;\ you\ can\ redistribute\ it\ and/or\ modify\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{00007\ \textcolor{comment}{/*\ \ it\ under\ the\ terms\ of\ the\ GNU\ General\ Public\ License\ as\ published\ by\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{00008\ \textcolor{comment}{/*\ \ the\ Free\ Software\ Foundation;\ either\ version\ 2\ of\ the\ License,\ or\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{00009\ \textcolor{comment}{/*\ \ (at\ your\ option)\ any\ later\ version.\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{00010\ \textcolor{comment}{/*\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{00011\ \textcolor{comment}{/*\ \ This\ program\ is\ distributed\ in\ the\ hope\ that\ it\ will\ be\ useful,\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{00012\ \textcolor{comment}{/*\ \ but\ WITHOUT\ ANY\ WARRANTY;\ without\ even\ the\ implied\ warranty\ of\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{00013\ \textcolor{comment}{/*\ \ MERCHANTABILITY\ or\ FITNESS\ FOR\ A\ PARTICULAR\ PURPOSE.\ \ See\ the\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{00014\ \textcolor{comment}{/*\ \ GNU\ General\ Public\ License\ for\ more\ details.\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{00015\ \textcolor{comment}{/*\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{00016\ \textcolor{comment}{/*\ \ You\ should\ have\ received\ a\ copy\ of\ the\ GNU\ General\ Public\ License\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{00017\ \textcolor{comment}{/*\ \ along\ with\ this\ program;\ if\ not,\ write\ to\ the\ Free\ Software\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{00018\ \textcolor{comment}{/*\ \ Foundation,\ Inc.,\ 51\ Franklin\ Street,\ Fifth\ Floor,\ Boston,\ MA\ \ 02110-\/1301\ \ USA\ \ \ \ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{00019\ \textcolor{comment}{/**********************************************************************************************/}}
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#include\ <iostream>}}
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#include\ <random>}}
\DoxyCodeLine{00022\ \textcolor{preprocessor}{\#include\ <chrono>}}
\DoxyCodeLine{00023\ \textcolor{preprocessor}{\#include\ <cassert>}}
\DoxyCodeLine{00024\ \textcolor{preprocessor}{\#include\ <fstream>}}
\DoxyCodeLine{00025\ }
\DoxyCodeLine{00026\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00027\ }
\DoxyCodeLine{00028\ \textcolor{keyword}{typedef}\ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}};}
\DoxyCodeLine{00029\ \textcolor{keyword}{typedef}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{long}\ \mbox{\hyperlink{strassen_8hpp_a2f208551ae3b0941151ca120866b9f1f}{PTR}};}
\DoxyCodeLine{00030\ }
\DoxyCodeLine{00031\ \textcolor{comment}{/*\ MATRIX\_SIZE\ must\ be\ a\ power\ of\ 2\ and\ a\ multiple\ of\ 16\ */}}
\DoxyCodeLine{00032\ \textcolor{preprocessor}{\#define\ MATRIX\_SIZE\ 1024}}
\DoxyCodeLine{00033\ }
\DoxyCodeLine{00034\ \textcolor{comment}{/*\ Below\ this\ cut\ off\ strassen\ uses\ MultiplyByDivideAndConquer()\ algorithm\ */}}
\DoxyCodeLine{00035\ \textcolor{comment}{//\#define\ CUTOFF\_SIZE\ 2*1024}}
\DoxyCodeLine{00036\ \textcolor{preprocessor}{\#define\ CUTOFF\_SIZE\ 64}}
\DoxyCodeLine{00037\ }
\DoxyCodeLine{00038\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{double}\ *\mbox{\hyperlink{strassen_8hpp_ac0b9586faeb85e585dd720351e9d399e}{MatrixA}},\ *\mbox{\hyperlink{strassen_8hpp_a91ae22cb3f1a5f70eb0adf4e00e0731d}{MatrixB}},\ *\mbox{\hyperlink{strassen_8hpp_afdefc717c9d7bec9b9ab61bc50d75a54}{MatrixC}};}
\DoxyCodeLine{00039\ }
\DoxyCodeLine{00040\ }
\DoxyCodeLine{00041\ \textcolor{comment}{/*\ *******************************************************************\ */}}
\DoxyCodeLine{00042\ \textcolor{comment}{/*\ STRASSEN\ APPLICATION\ CUT\ OFF's\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{00043\ \textcolor{comment}{/*\ *******************************************************************\ */}}
\DoxyCodeLine{00044\ \textcolor{comment}{/*\ Strassen\ uses\ three\ different\ functions\ to\ compute\ Matrix\ Multiply.\ */}}
\DoxyCodeLine{00045\ \textcolor{comment}{/*\ Each\ of\ them\ is\ related\ to\ an\ application\ cut\ off\ value:\ \ \ \ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{00046\ \textcolor{comment}{/*\ \ -\/\ Initial\ algorithm:\ OptimizedStrassenMultiply()\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{00047\ \textcolor{comment}{/*\ \ -\/\ bots\_app\_cutoff\_value:\ MultiplyByDivideAndConquer()\ \ \ \ \ \ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{00048\ \textcolor{comment}{/*\ \ -\/\ SizeAtWhichNaiveAlgorithmIsMoreEfficient:\ FastAdditiveNaiveMatrixMultiply()\ */}}
\DoxyCodeLine{00049\ \textcolor{comment}{/*\ *******************************************************************\ */}}
\DoxyCodeLine{00050\ }
\DoxyCodeLine{00051\ \textcolor{comment}{/*FIXME:\ at\ the\ moment\ we\ use\ a\ constant\ value,\ change\ to\ parameter\ ???*/}}
\DoxyCodeLine{00052\ \textcolor{comment}{/*\ Below\ this\ cut\ off\ \ strassen\ uses\ FastAdditiveNaiveMatrixMultiply\ algorithm\ */}}
\DoxyCodeLine{00053\ \textcolor{preprocessor}{\#define\ SizeAtWhichNaiveAlgorithmIsMoreEfficient\ 16}}
\DoxyCodeLine{00054\ }
\DoxyCodeLine{00055\ \textcolor{comment}{/***********************************************************************}}
\DoxyCodeLine{00056\ \textcolor{comment}{\ *\ maximum\ tolerable\ relative\ error\ (for\ the\ checking\ routine)}}
\DoxyCodeLine{00057\ \textcolor{comment}{\ **********************************************************************/}}
\DoxyCodeLine{00058\ \textcolor{preprocessor}{\#define\ EPSILON\ (1.0E-\/6)}}
\DoxyCodeLine{00059\ \textcolor{comment}{/***********************************************************************}}
\DoxyCodeLine{00060\ \textcolor{comment}{\ *\ Matrices\ are\ stored\ in\ row-\/major\ order;\ A\ is\ a\ pointer\ to}}
\DoxyCodeLine{00061\ \textcolor{comment}{\ *\ the\ first\ element\ of\ the\ matrix,\ and\ an\ is\ the\ number\ of\ elements}}
\DoxyCodeLine{00062\ \textcolor{comment}{\ *\ between\ two\ rows.\ This\ macro\ produces\ the\ element\ A[i,j]}}
\DoxyCodeLine{00063\ \textcolor{comment}{\ *\ given\ A,\ an,\ i\ and\ j}}
\DoxyCodeLine{00064\ \textcolor{comment}{\ **********************************************************************/}}
\DoxyCodeLine{00065\ \textcolor{preprocessor}{\#define\ ELEM(A,\ an,\ i,\ j)\ (A[(i)*(an)+(j)])}}
\DoxyCodeLine{00066\ }
\DoxyCodeLine{00067\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{strassen_8hpp_aebcfced9273d2a0e8017388e84937fe3}{FastNaiveMatrixMultiply}}(\mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ *\mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}},\ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ *\mbox{\hyperlink{bench__gemm_8cpp_addc86e8508f14411ec98f521c520f875}{A}},\ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ *\mbox{\hyperlink{bench__gemm_8cpp_a37a83060ac796961b44991c836f083f7}{B}},\ \textcolor{keywordtype}{unsigned}\ MatrixSize,}
\DoxyCodeLine{00068\ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ RowWidthC,\ \textcolor{keywordtype}{unsigned}\ RowWidthA,\ \textcolor{keywordtype}{unsigned}\ RowWidthB);}
\DoxyCodeLine{00069\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{strassen_8hpp_aae90e33322dd8d76c32cc70d39a3c92b}{FastAdditiveNaiveMatrixMultiply}}(\mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ *\mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}},\ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ *\mbox{\hyperlink{bench__gemm_8cpp_addc86e8508f14411ec98f521c520f875}{A}},\ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ *\mbox{\hyperlink{bench__gemm_8cpp_a37a83060ac796961b44991c836f083f7}{B}},\ \textcolor{keywordtype}{unsigned}\ MatrixSize,}
\DoxyCodeLine{00070\ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ RowWidthC,\ \textcolor{keywordtype}{unsigned}\ RowWidthA,\ \textcolor{keywordtype}{unsigned}\ RowWidthB);}
\DoxyCodeLine{00071\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{strassen_8hpp_a000f61531e7126f47b6e9b81740f1ac4}{MultiplyByDivideAndConquer}}(\mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ *\mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}},\ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ *\mbox{\hyperlink{bench__gemm_8cpp_addc86e8508f14411ec98f521c520f875}{A}},\ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ *\mbox{\hyperlink{bench__gemm_8cpp_a37a83060ac796961b44991c836f083f7}{B}},}
\DoxyCodeLine{00072\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ MatrixSize,}
\DoxyCodeLine{00073\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ RowWidthC,}
\DoxyCodeLine{00074\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ RowWidthA,}
\DoxyCodeLine{00075\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ RowWidthB,}
\DoxyCodeLine{00076\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ AdditiveMode}
\DoxyCodeLine{00077\ \ \ \ \ \ \ \ \ \ \ \ \ );}
\DoxyCodeLine{00078\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{strassen_8hpp_a0f4bccc077eb19f180dece44600d83f6}{OptimizedStrassenMultiply\_par}}(\mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ *\mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}},\ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ *\mbox{\hyperlink{bench__gemm_8cpp_addc86e8508f14411ec98f521c520f875}{A}},\ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ *\mbox{\hyperlink{bench__gemm_8cpp_a37a83060ac796961b44991c836f083f7}{B}},\ \textcolor{keywordtype}{unsigned}\ MatrixSize,}
\DoxyCodeLine{00079\ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ RowWidthC,\ \textcolor{keywordtype}{unsigned}\ RowWidthA,\ \textcolor{keywordtype}{unsigned}\ RowWidthB,\ \textcolor{keywordtype}{int}\ Depth);}
\DoxyCodeLine{00080\ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ *\mbox{\hyperlink{strassen_8hpp_abc7241a501dd1ea04fae2015ebcc972d}{alloc\_matrix}}(\textcolor{keywordtype}{int}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}});}
\DoxyCodeLine{00081\ }
\DoxyCodeLine{00082\ }
\DoxyCodeLine{00083\ }
\DoxyCodeLine{00084\ }
\DoxyCodeLine{00085\ }
\DoxyCodeLine{00086\ \textcolor{comment}{/************************************************************************}}
\DoxyCodeLine{00087\ \textcolor{comment}{\ *\ Set\ an\ n\ by\ n\ matrix\ A\ to\ random\ values.\ \ The\ distance\ between}}
\DoxyCodeLine{00088\ \textcolor{comment}{\ *\ rows\ is\ an}}
\DoxyCodeLine{00089\ \textcolor{comment}{\ ************************************************************************/}}
\DoxyCodeLine{00090\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{matrix_8hpp_a21bb302efd69cdbe9ecc131ea2413bf9}{init\_matrix}}(\textcolor{keywordtype}{int}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}},\ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ *\mbox{\hyperlink{bench__gemm_8cpp_addc86e8508f14411ec98f521c520f875}{A}},\ \textcolor{keywordtype}{int}\ an)\ \{}
\DoxyCodeLine{00091\ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}},\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}};}
\DoxyCodeLine{00092\ }
\DoxyCodeLine{00093\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ =\ 0;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ <\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}};\ ++\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})}
\DoxyCodeLine{00094\ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}\ =\ 0;\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}\ <\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}};\ ++\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}})}
\DoxyCodeLine{00095\ \ \ \ \ \ \ \mbox{\hyperlink{strassen_8hpp_a7b3243d836fb727c1eaf066a20b9969b}{ELEM}}(\mbox{\hyperlink{bench__gemm_8cpp_addc86e8508f14411ec98f521c520f875}{A}},\ an,\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}},\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}})\ =\ ((double)\ rand())\ /\ (\textcolor{keywordtype}{double})\ \mbox{\hyperlink{boing_8c_a690f251553b39fd4f31894826141b61a}{RAND\_MAX}};}
\DoxyCodeLine{00096\ \}}
\DoxyCodeLine{00097\ }
\DoxyCodeLine{00098\ \textcolor{comment}{/************************************************************************}}
\DoxyCodeLine{00099\ \textcolor{comment}{\ *\ Compare\ two\ matrices.\ \ Print\ an\ error\ message\ if\ they\ differ\ by}}
\DoxyCodeLine{00100\ \textcolor{comment}{\ *\ more\ than\ EPSILON.}}
\DoxyCodeLine{00101\ \textcolor{comment}{\ ************************************************************************/}}
\DoxyCodeLine{00102\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{strassen_8hpp_a4b31c622a934171d8bcfb4f1e8be965f}{compare\_matrix}}(\textcolor{keywordtype}{int}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}},\ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ *\mbox{\hyperlink{bench__gemm_8cpp_addc86e8508f14411ec98f521c520f875}{A}},\ \textcolor{keywordtype}{int}\ an,\ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ *\mbox{\hyperlink{bench__gemm_8cpp_a37a83060ac796961b44991c836f083f7}{B}},\ \textcolor{keywordtype}{int}\ bn)\ \{}
\DoxyCodeLine{00103\ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}},\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}};}
\DoxyCodeLine{00104\ \ \ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ \mbox{\hyperlink{bench_vec_add_8cpp_a41689956983587b085f9da3e48f31d99}{c}};}
\DoxyCodeLine{00105\ }
\DoxyCodeLine{00106\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ =\ 0;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ <\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}};\ ++\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})}
\DoxyCodeLine{00107\ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}\ =\ 0;\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}\ <\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}};\ ++\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}})\ \{}
\DoxyCodeLine{00108\ \ \ \ \ \ \ \textcolor{comment}{/*\ compute\ the\ relative\ error\ c\ */}}
\DoxyCodeLine{00109\ \ \ \ \ \ \ \mbox{\hyperlink{bench_vec_add_8cpp_a41689956983587b085f9da3e48f31d99}{c}}\ =\ \mbox{\hyperlink{strassen_8hpp_a7b3243d836fb727c1eaf066a20b9969b}{ELEM}}(\mbox{\hyperlink{bench__gemm_8cpp_addc86e8508f14411ec98f521c520f875}{A}},\ an,\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}},\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}})\ -\/\ \mbox{\hyperlink{strassen_8hpp_a7b3243d836fb727c1eaf066a20b9969b}{ELEM}}(\mbox{\hyperlink{bench__gemm_8cpp_a37a83060ac796961b44991c836f083f7}{B}},\ bn,\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}},\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}});}
\DoxyCodeLine{00110\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{bench_vec_add_8cpp_a41689956983587b085f9da3e48f31d99}{c}}\ <\ 0.0)}
\DoxyCodeLine{00111\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{bench_vec_add_8cpp_a41689956983587b085f9da3e48f31d99}{c}}\ =\ -\/\mbox{\hyperlink{bench_vec_add_8cpp_a41689956983587b085f9da3e48f31d99}{c}};}
\DoxyCodeLine{00112\ }
\DoxyCodeLine{00113\ \ \ \ \ \ \ \mbox{\hyperlink{bench_vec_add_8cpp_a41689956983587b085f9da3e48f31d99}{c}}\ =\ \mbox{\hyperlink{bench_vec_add_8cpp_a41689956983587b085f9da3e48f31d99}{c}}\ /\ \mbox{\hyperlink{strassen_8hpp_a7b3243d836fb727c1eaf066a20b9969b}{ELEM}}(\mbox{\hyperlink{bench__gemm_8cpp_addc86e8508f14411ec98f521c520f875}{A}},\ an,\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}},\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}});}
\DoxyCodeLine{00114\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{bench_vec_add_8cpp_a41689956983587b085f9da3e48f31d99}{c}}\ >\ \mbox{\hyperlink{_path_constraint_8c_a002b2f4894492820fe708b1b7e7c5e70}{EPSILON}})\ \{}
\DoxyCodeLine{00115\ \ \ \ \ \ \ \ \ std::cerr\ <<\ \textcolor{stringliteral}{"{}Strassen:\ Wrong\ answer!\ :\ "{}}\ <<\ \mbox{\hyperlink{bench_vec_add_8cpp_a41689956983587b085f9da3e48f31d99}{c}}\ <<\ \textcolor{charliteral}{'/'}\ <<\ \mbox{\hyperlink{_path_constraint_8c_a002b2f4894492820fe708b1b7e7c5e70}{EPSILON}}\ <<\ std::endl;}
\DoxyCodeLine{00116\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ FAIL}}
\DoxyCodeLine{00117\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00118\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00119\ \ \ \ \ \}}
\DoxyCodeLine{00120\ }
\DoxyCodeLine{00121\ \ \ \textcolor{comment}{//\ SUCCESS}}
\DoxyCodeLine{00122\ \ \ \textcolor{keywordflow}{return}\ 1;}
\DoxyCodeLine{00123\ \}}
\DoxyCodeLine{00124\ }
\DoxyCodeLine{00125\ }
\DoxyCodeLine{00126\ }
\DoxyCodeLine{00127\ \textcolor{comment}{/***********************************************************************}}
\DoxyCodeLine{00128\ \textcolor{comment}{\ *\ Allocate\ a\ matrix\ of\ side\ n\ (therefore\ n\string^2\ elements)}}
\DoxyCodeLine{00129\ \textcolor{comment}{\ **********************************************************************/}}
\DoxyCodeLine{00130\ \textcolor{keyword}{inline}\ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ *\mbox{\hyperlink{strassen_8hpp_abc7241a501dd1ea04fae2015ebcc972d}{alloc\_matrix}}(\textcolor{keywordtype}{int}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}})\ \{}
\DoxyCodeLine{00131\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{static\_cast<}\mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}*\textcolor{keyword}{>}(\mbox{\hyperlink{mimalloc-override_8h_a99aa8fd9f4831e1b0fa9e1cdcde3e249}{malloc}}(\mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}\ *\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}\ *\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}})));}
\DoxyCodeLine{00132\ \}}
\DoxyCodeLine{00133\ }
\DoxyCodeLine{00134\ }
\DoxyCodeLine{00135\ \textcolor{comment}{/***********************************************************************}}
\DoxyCodeLine{00136\ \textcolor{comment}{\ *\ Naive\ sequential\ algorithm,\ for\ comparison\ purposes}}
\DoxyCodeLine{00137\ \textcolor{comment}{\ **********************************************************************/}}
\DoxyCodeLine{00138\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{strassen_8hpp_aaabfe3435189e395859df1ec8e977fbc}{matrixmul}}(\textcolor{keywordtype}{int}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}},\ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ *\mbox{\hyperlink{bench__gemm_8cpp_addc86e8508f14411ec98f521c520f875}{A}},\ \textcolor{keywordtype}{int}\ an,\ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ *\mbox{\hyperlink{bench__gemm_8cpp_a37a83060ac796961b44991c836f083f7}{B}},\ \textcolor{keywordtype}{int}\ bn,\ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ *\mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}},\ \textcolor{keywordtype}{int}\ cn)\ \{}
\DoxyCodeLine{00139\ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}},\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}},\ k;}
\DoxyCodeLine{00140\ \ \ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ \mbox{\hyperlink{main-override_8cpp_a1384e7608274313a9433fa573868557b}{s}};}
\DoxyCodeLine{00141\ }
\DoxyCodeLine{00142\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ =\ 0;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ <\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}};\ ++\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})}
\DoxyCodeLine{00143\ \ \ \{}
\DoxyCodeLine{00144\ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}\ =\ 0;\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}\ <\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}};\ ++\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}})}
\DoxyCodeLine{00145\ \ \ \ \ \{}
\DoxyCodeLine{00146\ \ \ \ \ \ \ \mbox{\hyperlink{main-override_8cpp_a1384e7608274313a9433fa573868557b}{s}}\ =\ 0.0;}
\DoxyCodeLine{00147\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (k\ =\ 0;\ k\ <\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}};\ ++k)\ \mbox{\hyperlink{main-override_8cpp_a1384e7608274313a9433fa573868557b}{s}}\ +=\ \mbox{\hyperlink{strassen_8hpp_a7b3243d836fb727c1eaf066a20b9969b}{ELEM}}(\mbox{\hyperlink{bench__gemm_8cpp_addc86e8508f14411ec98f521c520f875}{A}},\ an,\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}},\ k)\ *\ \mbox{\hyperlink{strassen_8hpp_a7b3243d836fb727c1eaf066a20b9969b}{ELEM}}(\mbox{\hyperlink{bench__gemm_8cpp_a37a83060ac796961b44991c836f083f7}{B}},\ bn,\ k,\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}});}
\DoxyCodeLine{00148\ \ \ \ \ \ \ \mbox{\hyperlink{strassen_8hpp_a7b3243d836fb727c1eaf066a20b9969b}{ELEM}}(\mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}},\ cn,\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}},\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}})\ =\ \mbox{\hyperlink{main-override_8cpp_a1384e7608274313a9433fa573868557b}{s}};}
\DoxyCodeLine{00149\ \ \ \ \ \}}
\DoxyCodeLine{00150\ \ \ \}}
\DoxyCodeLine{00151\ \}}
\DoxyCodeLine{00152\ }
\DoxyCodeLine{00153\ }
\DoxyCodeLine{00154\ \textcolor{comment}{/***********************************************************************}}
\DoxyCodeLine{00155\ \textcolor{comment}{\ *\ Naive\ sequential\ strassen\ algorithm,\ for\ comparison\ purposes}}
\DoxyCodeLine{00156\ \textcolor{comment}{\ **********************************************************************/}}
\DoxyCodeLine{00157\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{strassen_8hpp_ad94a3e25ffa1ae94be56058f75bf17a0}{OptimizedStrassenMultiply\_seq}}(\mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ *\mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}},\ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ *\mbox{\hyperlink{bench__gemm_8cpp_addc86e8508f14411ec98f521c520f875}{A}},\ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ *\mbox{\hyperlink{bench__gemm_8cpp_a37a83060ac796961b44991c836f083f7}{B}},\ \textcolor{keywordtype}{unsigned}\ MatrixSize,}
\DoxyCodeLine{00158\ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ RowWidthC,\ \textcolor{keywordtype}{unsigned}\ RowWidthA,\ \textcolor{keywordtype}{unsigned}\ RowWidthB,\ \textcolor{keywordtype}{int}\ Depth)}
\DoxyCodeLine{00159\ \{}
\DoxyCodeLine{00160\ \ \ \textcolor{keywordtype}{unsigned}\ QuadrantSize\ =\ MatrixSize\ >>\ 1;\ \textcolor{comment}{/*\ MatixSize\ /\ 2\ */}}
\DoxyCodeLine{00161\ \ \ \textcolor{keywordtype}{unsigned}\ QuadrantSizeInBytes\ =\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}})\ *\ QuadrantSize\ *\ QuadrantSize}
\DoxyCodeLine{00162\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ +\ 32;}
\DoxyCodeLine{00163\ \ \ \textcolor{keywordtype}{unsigned}\ Column,\ Row;}
\DoxyCodeLine{00164\ }
\DoxyCodeLine{00165\ \textcolor{comment}{\ \ /************************************************************************}}
\DoxyCodeLine{00166\ \textcolor{comment}{\ \ **\ For\ each\ matrix\ A,\ B,\ and\ C,\ we'll\ want\ pointers\ to\ each\ quandrant}}
\DoxyCodeLine{00167\ \textcolor{comment}{\ \ **\ in\ the\ matrix.\ These\ quandrants\ will\ be\ addressed\ as\ follows:}}
\DoxyCodeLine{00168\ \textcolor{comment}{\ \ **\ \ -\/-\/\ \ \ \ \ \ \ \ -\/-\/}}
\DoxyCodeLine{00169\ \textcolor{comment}{\ \ **\ \ |\ A11\ \ A12\ |}}
\DoxyCodeLine{00170\ \textcolor{comment}{\ \ **\ \ |\ \ \ \ \ \ \ \ \ \ |}}
\DoxyCodeLine{00171\ \textcolor{comment}{\ \ **\ \ |\ A21\ \ A22\ |}}
\DoxyCodeLine{00172\ \textcolor{comment}{\ \ **\ \ -\/-\/\ \ \ \ \ \ \ \ -\/-\/}}
\DoxyCodeLine{00173\ \textcolor{comment}{\ \ ************************************************************************/}}
\DoxyCodeLine{00174\ \ \ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ \textcolor{comment}{/*\ *A11,\ *B11,\ *C11,\ */}\ *A12,\ *B12,\ *C12,}
\DoxyCodeLine{00175\ \ \ \ \ \ \ \ *A21,\ *B21,\ *C21,\ *A22,\ *B22,\ *C22;}
\DoxyCodeLine{00176\ }
\DoxyCodeLine{00177\ \ \ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ *S1,*S2,*S3,*S4,*S5,*S6,*S7,*S8,*\mbox{\hyperlink{_tutorial___reshape_mat2_mat_8cpp_ae3dc3553f10a3c3e5d701dc35895d1e4}{M2}},*M5,*T1sMULT;}
\DoxyCodeLine{00178\ \textcolor{preprocessor}{\ \ \#define\ T2sMULT\ C22}}
\DoxyCodeLine{00179\ \textcolor{preprocessor}{\ \ \#define\ NumberOfVariables\ 11}}
\DoxyCodeLine{00180\ }
\DoxyCodeLine{00181\ \ \ \mbox{\hyperlink{strassen_8hpp_a2f208551ae3b0941151ca120866b9f1f}{PTR}}\ TempMatrixOffset\ =\ 0;}
\DoxyCodeLine{00182\ \ \ \mbox{\hyperlink{strassen_8hpp_a2f208551ae3b0941151ca120866b9f1f}{PTR}}\ MatrixOffsetA\ =\ 0;}
\DoxyCodeLine{00183\ \ \ \mbox{\hyperlink{strassen_8hpp_a2f208551ae3b0941151ca120866b9f1f}{PTR}}\ MatrixOffsetB\ =\ 0;}
\DoxyCodeLine{00184\ }
\DoxyCodeLine{00185\ \ \ \textcolor{keywordtype}{char}\ *Heap;}
\DoxyCodeLine{00186\ \ \ \textcolor{keywordtype}{void}\ *StartHeap;}
\DoxyCodeLine{00187\ }
\DoxyCodeLine{00188\ \ \ \textcolor{comment}{/*\ Distance\ between\ the\ end\ of\ a\ matrix\ row\ and\ the\ start\ of\ the\ next\ row\ */}}
\DoxyCodeLine{00189\ \ \ \mbox{\hyperlink{strassen_8hpp_a2f208551ae3b0941151ca120866b9f1f}{PTR}}\ RowIncrementA\ =\ (\ RowWidthA\ -\/\ QuadrantSize\ )\ <<\ 3;}
\DoxyCodeLine{00190\ \ \ \mbox{\hyperlink{strassen_8hpp_a2f208551ae3b0941151ca120866b9f1f}{PTR}}\ RowIncrementB\ =\ (\ RowWidthB\ -\/\ QuadrantSize\ )\ <<\ 3;}
\DoxyCodeLine{00191\ \ \ \mbox{\hyperlink{strassen_8hpp_a2f208551ae3b0941151ca120866b9f1f}{PTR}}\ RowIncrementC\ =\ (\ RowWidthC\ -\/\ QuadrantSize\ )\ <<\ 3;}
\DoxyCodeLine{00192\ }
\DoxyCodeLine{00193\ \ \ \textcolor{keywordflow}{if}\ (MatrixSize\ <=\ \mbox{\hyperlink{strassen_8hpp_a874ef7e5f7ff03682018a4312d4783f1}{CUTOFF\_SIZE}})\ \{}
\DoxyCodeLine{00194\ \ \ \ \ \mbox{\hyperlink{strassen_8hpp_a000f61531e7126f47b6e9b81740f1ac4}{MultiplyByDivideAndConquer}}(\mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}},\ \mbox{\hyperlink{bench__gemm_8cpp_addc86e8508f14411ec98f521c520f875}{A}},\ \mbox{\hyperlink{bench__gemm_8cpp_a37a83060ac796961b44991c836f083f7}{B}},\ MatrixSize,\ RowWidthC,\ RowWidthA,\ RowWidthB,\ 0);}
\DoxyCodeLine{00195\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00196\ \ \ \}}
\DoxyCodeLine{00197\ }
\DoxyCodeLine{00199\ \ \ \textcolor{comment}{//\#define\ A11\ A}}
\DoxyCodeLine{00200\ \ \ \textcolor{comment}{//\#define\ B11\ B}}
\DoxyCodeLine{00201\ \ \ \textcolor{comment}{//\#define\ C11\ C}}
\DoxyCodeLine{00202\ }
\DoxyCodeLine{00203\ \ \ \textcolor{keyword}{auto}\ \mbox{\hyperlink{sandbox_2strassen_2omp_8cpp_aa8394a82104d1917c30c5e017ccf6176}{A11}}\ =\ \mbox{\hyperlink{bench__gemm_8cpp_addc86e8508f14411ec98f521c520f875}{A}};}
\DoxyCodeLine{00204\ \ \ \textcolor{keyword}{auto}\ \mbox{\hyperlink{sandbox_2strassen_2omp_8cpp_ac66ad09c1f6644f8338cb98304d019cf}{B11}}\ =\ \mbox{\hyperlink{bench__gemm_8cpp_a37a83060ac796961b44991c836f083f7}{B}};}
\DoxyCodeLine{00205\ \ \ \textcolor{keyword}{auto}\ \mbox{\hyperlink{sandbox_2strassen_2omp_8cpp_ad1e82072c033df09d8b00f6d7d77e401}{C11}}\ =\ \mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}};}
\DoxyCodeLine{00206\ }
\DoxyCodeLine{00207\ \ \ A12\ =\ \mbox{\hyperlink{sandbox_2strassen_2omp_8cpp_aa8394a82104d1917c30c5e017ccf6176}{A11}}\ +\ QuadrantSize;}
\DoxyCodeLine{00208\ \ \ B12\ =\ \mbox{\hyperlink{sandbox_2strassen_2omp_8cpp_ac66ad09c1f6644f8338cb98304d019cf}{B11}}\ +\ QuadrantSize;}
\DoxyCodeLine{00209\ \ \ C12\ =\ \mbox{\hyperlink{sandbox_2strassen_2omp_8cpp_ad1e82072c033df09d8b00f6d7d77e401}{C11}}\ +\ QuadrantSize;}
\DoxyCodeLine{00210\ \ \ A21\ =\ \mbox{\hyperlink{bench__gemm_8cpp_addc86e8508f14411ec98f521c520f875}{A}}\ +\ (RowWidthA\ *\ QuadrantSize);}
\DoxyCodeLine{00211\ \ \ B21\ =\ \mbox{\hyperlink{bench__gemm_8cpp_a37a83060ac796961b44991c836f083f7}{B}}\ +\ (RowWidthB\ *\ QuadrantSize);}
\DoxyCodeLine{00212\ \ \ C21\ =\ \mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}}\ +\ (RowWidthC\ *\ QuadrantSize);}
\DoxyCodeLine{00213\ \ \ A22\ =\ A21\ +\ QuadrantSize;}
\DoxyCodeLine{00214\ \ \ B22\ =\ B21\ +\ QuadrantSize;}
\DoxyCodeLine{00215\ \ \ C22\ =\ C21\ +\ QuadrantSize;}
\DoxyCodeLine{00216\ }
\DoxyCodeLine{00217\ \ \ \textcolor{comment}{/*\ Allocate\ Heap\ Space\ Here\ */}}
\DoxyCodeLine{00218\ \ \ StartHeap\ =\ Heap\ =\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{char}*\textcolor{keyword}{>}(\mbox{\hyperlink{mimalloc-override_8h_a99aa8fd9f4831e1b0fa9e1cdcde3e249}{malloc}}(QuadrantSizeInBytes\ *\ \mbox{\hyperlink{sandbox_2strassen_2omp_8cpp_af3eb3c15267f29eabc6cfa20af2f4c86}{NumberOfVariables}}));}
\DoxyCodeLine{00219\ \ \ \textcolor{comment}{/*\ ensure\ that\ heap\ is\ on\ cache\ boundary\ */}}
\DoxyCodeLine{00220\ \ \ \textcolor{keywordflow}{if}\ (\ ((\mbox{\hyperlink{strassen_8hpp_a2f208551ae3b0941151ca120866b9f1f}{PTR}})\ Heap)\ \&\ 31)}
\DoxyCodeLine{00221\ \ \ \ \ \ Heap\ =\ (\textcolor{keywordtype}{char}*)\ (\ ((\mbox{\hyperlink{strassen_8hpp_a2f208551ae3b0941151ca120866b9f1f}{PTR}})\ Heap)\ +\ 32\ -\/\ (\ ((\mbox{\hyperlink{strassen_8hpp_a2f208551ae3b0941151ca120866b9f1f}{PTR}})\ Heap)\ \&\ 31)\ );}
\DoxyCodeLine{00222\ }
\DoxyCodeLine{00223\ \ \ \textcolor{comment}{/*\ Distribute\ the\ heap\ space\ over\ the\ variables\ */}}
\DoxyCodeLine{00224\ \ \ S1\ =\ (\mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}*)\ Heap;\ Heap\ +=\ QuadrantSizeInBytes;}
\DoxyCodeLine{00225\ \ \ S2\ =\ (\mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}*)\ Heap;\ Heap\ +=\ QuadrantSizeInBytes;}
\DoxyCodeLine{00226\ \ \ S3\ =\ (\mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}*)\ Heap;\ Heap\ +=\ QuadrantSizeInBytes;}
\DoxyCodeLine{00227\ \ \ S4\ =\ (\mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}*)\ Heap;\ Heap\ +=\ QuadrantSizeInBytes;}
\DoxyCodeLine{00228\ \ \ S5\ =\ (\mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}*)\ Heap;\ Heap\ +=\ QuadrantSizeInBytes;}
\DoxyCodeLine{00229\ \ \ S6\ =\ (\mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}*)\ Heap;\ Heap\ +=\ QuadrantSizeInBytes;}
\DoxyCodeLine{00230\ \ \ S7\ =\ (\mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}*)\ Heap;\ Heap\ +=\ QuadrantSizeInBytes;}
\DoxyCodeLine{00231\ \ \ S8\ =\ (\mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}*)\ Heap;\ Heap\ +=\ QuadrantSizeInBytes;}
\DoxyCodeLine{00232\ \ \ \mbox{\hyperlink{_tutorial___reshape_mat2_mat_8cpp_ae3dc3553f10a3c3e5d701dc35895d1e4}{M2}}\ =\ (\mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}*)\ Heap;\ Heap\ +=\ QuadrantSizeInBytes;}
\DoxyCodeLine{00233\ \ \ M5\ =\ (\mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}*)\ Heap;\ Heap\ +=\ QuadrantSizeInBytes;}
\DoxyCodeLine{00234\ \ \ T1sMULT\ =\ (\mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}*)\ Heap;\ Heap\ +=\ QuadrantSizeInBytes;}
\DoxyCodeLine{00235\ }
\DoxyCodeLine{00236\ \textcolor{comment}{\ \ /***************************************************************************}}
\DoxyCodeLine{00237\ \textcolor{comment}{\ \ **\ Step\ through\ all\ columns\ row\ by\ row\ (vertically)}}
\DoxyCodeLine{00238\ \textcolor{comment}{\ \ **\ (jumps\ in\ memory\ by\ RowWidth\ =>\ bad\ locality)}}
\DoxyCodeLine{00239\ \textcolor{comment}{\ \ **\ (but\ we\ want\ the\ best\ locality\ on\ the\ innermost\ loop)}}
\DoxyCodeLine{00240\ \textcolor{comment}{\ \ ***************************************************************************/}}
\DoxyCodeLine{00241\ \ \ \textcolor{keywordflow}{for}\ (Row\ =\ 0;\ Row\ <\ QuadrantSize;\ Row++)\ \{}
\DoxyCodeLine{00242\ }
\DoxyCodeLine{00243\ \textcolor{comment}{\ \ \ \ /*************************************************************************}}
\DoxyCodeLine{00244\ \textcolor{comment}{\ \ \ \ **\ Step\ through\ each\ row\ horizontally\ (addressing\ elements\ in\ each\ column)}}
\DoxyCodeLine{00245\ \textcolor{comment}{\ \ \ \ **\ (jumps\ linearly\ througn\ memory\ =>\ good\ locality)}}
\DoxyCodeLine{00246\ \textcolor{comment}{\ \ \ \ *************************************************************************/}}
\DoxyCodeLine{00247\ \ \ \ \ \textcolor{keywordflow}{for}\ (Column\ =\ 0;\ Column\ <\ QuadrantSize;\ Column++)\ \{}
\DoxyCodeLine{00248\ }
\DoxyCodeLine{00249\ \textcolor{comment}{\ \ \ \ \ \ /***********************************************************}}
\DoxyCodeLine{00250\ \textcolor{comment}{\ \ \ \ \ \ **\ Within\ this\ loop,\ the\ following\ holds\ for\ MatrixOffset:}}
\DoxyCodeLine{00251\ \textcolor{comment}{\ \ \ \ \ \ **\ MatrixOffset\ =\ (Row\ *\ RowWidth)\ +\ Column}}
\DoxyCodeLine{00252\ \textcolor{comment}{\ \ \ \ \ \ **\ (note:\ that\ the\ unit\ of\ the\ offset\ is\ number\ of\ reals)}}
\DoxyCodeLine{00253\ \textcolor{comment}{\ \ \ \ \ \ ***********************************************************/}}
\DoxyCodeLine{00254\ \ \ \ \ \ \ \textcolor{comment}{/*\ Element\ of\ Global\ Matrix,\ such\ as\ A,\ B,\ C\ */}}
\DoxyCodeLine{00255\ \textcolor{preprocessor}{\ \ \ \ \ \ \#define\ E(Matrix)\ \ \ (*\ (REAL*)\ (\ ((PTR)\ Matrix)\ +\ TempMatrixOffset\ )\ )}}
\DoxyCodeLine{00256\ \textcolor{preprocessor}{\ \ \ \ \ \ \#define\ EA(Matrix)\ \ (*\ (REAL*)\ (\ ((PTR)\ Matrix)\ +\ MatrixOffsetA\ )\ )}}
\DoxyCodeLine{00257\ \textcolor{preprocessor}{\ \ \ \ \ \ \#define\ EB(Matrix)\ \ (*\ (REAL*)\ (\ ((PTR)\ Matrix)\ +\ MatrixOffsetB\ )\ )}}
\DoxyCodeLine{00258\ }
\DoxyCodeLine{00259\ \ \ \ \ \ \ \textcolor{comment}{/*\ FIXME\ -\/\ may\ pay\ to\ expand\ these\ out\ -\/\ got\ higher\ speed-\/ups\ below\ */}}
\DoxyCodeLine{00260\ \ \ \ \ \ \ \textcolor{comment}{/*\ S4\ =\ A12\ -\/\ (\ S2\ =\ (\ S1\ =\ A21\ +\ A22\ )\ -\/\ A11\ )\ */}}
\DoxyCodeLine{00261\ \ \ \ \ \ \ \mbox{\hyperlink{strassen_8hpp_a4bfa035cad7c3258704669810cd5de5d}{E}}(S4)\ =\ \mbox{\hyperlink{strassen_8hpp_a80392b602af09cf12506ae2812f0aeaf}{EA}}(A12)\ -\/\ (\ \mbox{\hyperlink{strassen_8hpp_a4bfa035cad7c3258704669810cd5de5d}{E}}(S2)\ =\ (\ \mbox{\hyperlink{strassen_8hpp_a4bfa035cad7c3258704669810cd5de5d}{E}}(S1)\ =\ \mbox{\hyperlink{strassen_8hpp_a80392b602af09cf12506ae2812f0aeaf}{EA}}(A21)\ +\ \mbox{\hyperlink{strassen_8hpp_a80392b602af09cf12506ae2812f0aeaf}{EA}}(A22)\ )\ -\/\ \mbox{\hyperlink{strassen_8hpp_a80392b602af09cf12506ae2812f0aeaf}{EA}}(\mbox{\hyperlink{sandbox_2strassen_2omp_8cpp_aa8394a82104d1917c30c5e017ccf6176}{A11}})\ );}
\DoxyCodeLine{00262\ }
\DoxyCodeLine{00263\ \ \ \ \ \ \ \textcolor{comment}{/*\ S8\ =\ (S6\ =\ B22\ -\/\ (\ S5\ =\ B12\ -\/\ B11\ )\ )\ -\/\ B21\ */}}
\DoxyCodeLine{00264\ \ \ \ \ \ \ \mbox{\hyperlink{strassen_8hpp_a4bfa035cad7c3258704669810cd5de5d}{E}}(S8)\ =\ (\ \mbox{\hyperlink{strassen_8hpp_a4bfa035cad7c3258704669810cd5de5d}{E}}(S6)\ =\ \mbox{\hyperlink{strassen_8hpp_ae0cb380a7eeac4fcf3829f8471058059}{EB}}(B22)\ -\/\ (\ \mbox{\hyperlink{strassen_8hpp_a4bfa035cad7c3258704669810cd5de5d}{E}}(S5)\ =\ \mbox{\hyperlink{strassen_8hpp_ae0cb380a7eeac4fcf3829f8471058059}{EB}}(B12)\ -\/\ \mbox{\hyperlink{strassen_8hpp_ae0cb380a7eeac4fcf3829f8471058059}{EB}}(\mbox{\hyperlink{sandbox_2strassen_2omp_8cpp_ac66ad09c1f6644f8338cb98304d019cf}{B11}})\ )\ )\ -\/\ \mbox{\hyperlink{strassen_8hpp_ae0cb380a7eeac4fcf3829f8471058059}{EB}}(B21);}
\DoxyCodeLine{00265\ }
\DoxyCodeLine{00266\ \ \ \ \ \ \ \textcolor{comment}{/*\ S3\ =\ A11\ -\/\ A21\ */}}
\DoxyCodeLine{00267\ \ \ \ \ \ \ \mbox{\hyperlink{strassen_8hpp_a4bfa035cad7c3258704669810cd5de5d}{E}}(S3)\ =\ \mbox{\hyperlink{strassen_8hpp_a80392b602af09cf12506ae2812f0aeaf}{EA}}(\mbox{\hyperlink{sandbox_2strassen_2omp_8cpp_aa8394a82104d1917c30c5e017ccf6176}{A11}})\ -\/\ \mbox{\hyperlink{strassen_8hpp_a80392b602af09cf12506ae2812f0aeaf}{EA}}(A21);}
\DoxyCodeLine{00268\ }
\DoxyCodeLine{00269\ \ \ \ \ \ \ \textcolor{comment}{/*\ S7\ =\ B22\ -\/\ B12\ */}}
\DoxyCodeLine{00270\ \ \ \ \ \ \ \mbox{\hyperlink{strassen_8hpp_a4bfa035cad7c3258704669810cd5de5d}{E}}(S7)\ =\ \mbox{\hyperlink{strassen_8hpp_ae0cb380a7eeac4fcf3829f8471058059}{EB}}(B22)\ -\/\ \mbox{\hyperlink{strassen_8hpp_ae0cb380a7eeac4fcf3829f8471058059}{EB}}(B12);}
\DoxyCodeLine{00271\ }
\DoxyCodeLine{00272\ \ \ \ \ \ \ TempMatrixOffset\ +=\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}});}
\DoxyCodeLine{00273\ \ \ \ \ \ \ MatrixOffsetA\ +=\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}});}
\DoxyCodeLine{00274\ \ \ \ \ \ \ MatrixOffsetB\ +=\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}});}
\DoxyCodeLine{00275\ \ \ \ \ \}\ \textcolor{comment}{/*\ end\ row\ loop*/}}
\DoxyCodeLine{00276\ }
\DoxyCodeLine{00277\ \ \ \ \ MatrixOffsetA\ +=\ RowIncrementA;}
\DoxyCodeLine{00278\ \ \ \ \ MatrixOffsetB\ +=\ RowIncrementB;}
\DoxyCodeLine{00279\ \ \ \}\ \textcolor{comment}{/*\ end\ column\ loop\ */}}
\DoxyCodeLine{00280\ }
\DoxyCodeLine{00281\ \ \ \textcolor{comment}{/*\ M2\ =\ A11\ x\ B11\ */}}
\DoxyCodeLine{00282\ \ \ \mbox{\hyperlink{strassen_8hpp_ad94a3e25ffa1ae94be56058f75bf17a0}{OptimizedStrassenMultiply\_seq}}(\mbox{\hyperlink{_tutorial___reshape_mat2_mat_8cpp_ae3dc3553f10a3c3e5d701dc35895d1e4}{M2}},\ \mbox{\hyperlink{sandbox_2strassen_2omp_8cpp_aa8394a82104d1917c30c5e017ccf6176}{A11}},\ \mbox{\hyperlink{sandbox_2strassen_2omp_8cpp_ac66ad09c1f6644f8338cb98304d019cf}{B11}},\ QuadrantSize,\ QuadrantSize,\ RowWidthA,\ RowWidthB,\ Depth+1);}
\DoxyCodeLine{00283\ }
\DoxyCodeLine{00284\ \ \ \textcolor{comment}{/*\ M5\ =\ S1\ *\ S5\ */}}
\DoxyCodeLine{00285\ \ \ \mbox{\hyperlink{strassen_8hpp_ad94a3e25ffa1ae94be56058f75bf17a0}{OptimizedStrassenMultiply\_seq}}(M5,\ S1,\ S5,\ QuadrantSize,\ QuadrantSize,\ QuadrantSize,\ QuadrantSize,\ Depth+1);}
\DoxyCodeLine{00286\ }
\DoxyCodeLine{00287\ \ \ \textcolor{comment}{/*\ Step\ 1\ of\ T1\ =\ S2\ x\ S6\ +\ M2\ */}}
\DoxyCodeLine{00288\ \ \ \mbox{\hyperlink{strassen_8hpp_ad94a3e25ffa1ae94be56058f75bf17a0}{OptimizedStrassenMultiply\_seq}}(T1sMULT,\ S2,\ S6,\ \ QuadrantSize,\ QuadrantSize,\ QuadrantSize,\ QuadrantSize,\ Depth+1);}
\DoxyCodeLine{00289\ }
\DoxyCodeLine{00290\ \ \ \textcolor{comment}{/*\ Step\ 1\ of\ T2\ =\ T1\ +\ S3\ x\ S7\ */}}
\DoxyCodeLine{00291\ \ \ \mbox{\hyperlink{strassen_8hpp_ad94a3e25ffa1ae94be56058f75bf17a0}{OptimizedStrassenMultiply\_seq}}(C22,\ S3,\ S7,\ QuadrantSize,\ RowWidthC\ \textcolor{comment}{/*FIXME*/},\ QuadrantSize,\ QuadrantSize,\ Depth+1);}
\DoxyCodeLine{00292\ }
\DoxyCodeLine{00293\ \ \ \textcolor{comment}{/*\ Step\ 1\ of\ C11\ =\ M2\ +\ A12\ *\ B21\ */}}
\DoxyCodeLine{00294\ \ \ \mbox{\hyperlink{strassen_8hpp_ad94a3e25ffa1ae94be56058f75bf17a0}{OptimizedStrassenMultiply\_seq}}(\mbox{\hyperlink{sandbox_2strassen_2omp_8cpp_ad1e82072c033df09d8b00f6d7d77e401}{C11}},\ A12,\ B21,\ QuadrantSize,\ RowWidthC,\ RowWidthA,\ RowWidthB,\ Depth+1);}
\DoxyCodeLine{00295\ }
\DoxyCodeLine{00296\ \ \ \textcolor{comment}{/*\ Step\ 1\ of\ C12\ =\ S4\ x\ B22\ +\ T1\ +\ M5\ */}}
\DoxyCodeLine{00297\ \ \ \mbox{\hyperlink{strassen_8hpp_ad94a3e25ffa1ae94be56058f75bf17a0}{OptimizedStrassenMultiply\_seq}}(C12,\ S4,\ B22,\ QuadrantSize,\ RowWidthC,\ QuadrantSize,\ RowWidthB,\ Depth+1);}
\DoxyCodeLine{00298\ }
\DoxyCodeLine{00299\ \ \ \textcolor{comment}{/*\ Step\ 1\ of\ C21\ =\ T2\ -\/\ A22\ *\ S8\ */}}
\DoxyCodeLine{00300\ \ \ \mbox{\hyperlink{strassen_8hpp_ad94a3e25ffa1ae94be56058f75bf17a0}{OptimizedStrassenMultiply\_seq}}(C21,\ A22,\ S8,\ QuadrantSize,\ RowWidthC,\ RowWidthA,\ QuadrantSize,\ Depth+1);}
\DoxyCodeLine{00301\ }
\DoxyCodeLine{00302\ \textcolor{comment}{\ \ /***************************************************************************}}
\DoxyCodeLine{00303\ \textcolor{comment}{\ \ **\ Step\ through\ all\ columns\ row\ by\ row\ (vertically)}}
\DoxyCodeLine{00304\ \textcolor{comment}{\ \ **\ (jumps\ in\ memory\ by\ RowWidth\ =>\ bad\ locality)}}
\DoxyCodeLine{00305\ \textcolor{comment}{\ \ **\ (but\ we\ want\ the\ best\ locality\ on\ the\ innermost\ loop)}}
\DoxyCodeLine{00306\ \textcolor{comment}{\ \ ***************************************************************************/}}
\DoxyCodeLine{00307\ \ \ \textcolor{keywordflow}{for}\ (Row\ =\ 0;\ Row\ <\ QuadrantSize;\ Row++)\ \{}
\DoxyCodeLine{00308\ \textcolor{comment}{\ \ \ \ /*************************************************************************}}
\DoxyCodeLine{00309\ \textcolor{comment}{\ \ \ \ **\ Step\ through\ each\ row\ horizontally\ (addressing\ elements\ in\ each\ column)}}
\DoxyCodeLine{00310\ \textcolor{comment}{\ \ \ \ **\ (jumps\ linearly\ througn\ memory\ =>\ good\ locality)}}
\DoxyCodeLine{00311\ \textcolor{comment}{\ \ \ \ *************************************************************************/}}
\DoxyCodeLine{00312\ \ \ \ \ \textcolor{keywordflow}{for}\ (Column\ =\ 0;\ Column\ <\ QuadrantSize;\ Column\ +=\ 4)\ \{}
\DoxyCodeLine{00313\ \ \ \ \ \ \ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ LocalM5\_0\ =\ *(M5);}
\DoxyCodeLine{00314\ \ \ \ \ \ \ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ LocalM5\_1\ =\ *(M5+1);}
\DoxyCodeLine{00315\ \ \ \ \ \ \ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ LocalM5\_2\ =\ *(M5+2);}
\DoxyCodeLine{00316\ \ \ \ \ \ \ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ LocalM5\_3\ =\ *(M5+3);}
\DoxyCodeLine{00317\ \ \ \ \ \ \ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ LocalM2\_0\ =\ *(\mbox{\hyperlink{_tutorial___reshape_mat2_mat_8cpp_ae3dc3553f10a3c3e5d701dc35895d1e4}{M2}});}
\DoxyCodeLine{00318\ \ \ \ \ \ \ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ LocalM2\_1\ =\ *(\mbox{\hyperlink{_tutorial___reshape_mat2_mat_8cpp_ae3dc3553f10a3c3e5d701dc35895d1e4}{M2}}+1);}
\DoxyCodeLine{00319\ \ \ \ \ \ \ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ LocalM2\_2\ =\ *(\mbox{\hyperlink{_tutorial___reshape_mat2_mat_8cpp_ae3dc3553f10a3c3e5d701dc35895d1e4}{M2}}+2);}
\DoxyCodeLine{00320\ \ \ \ \ \ \ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ LocalM2\_3\ =\ *(\mbox{\hyperlink{_tutorial___reshape_mat2_mat_8cpp_ae3dc3553f10a3c3e5d701dc35895d1e4}{M2}}+3);}
\DoxyCodeLine{00321\ \ \ \ \ \ \ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ T1\_0\ =\ *(T1sMULT)\ +\ LocalM2\_0;}
\DoxyCodeLine{00322\ \ \ \ \ \ \ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ T1\_1\ =\ *(T1sMULT+1)\ +\ LocalM2\_1;}
\DoxyCodeLine{00323\ \ \ \ \ \ \ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ T1\_2\ =\ *(T1sMULT+2)\ +\ LocalM2\_2;}
\DoxyCodeLine{00324\ \ \ \ \ \ \ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ T1\_3\ =\ *(T1sMULT+3)\ +\ LocalM2\_3;}
\DoxyCodeLine{00325\ \ \ \ \ \ \ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ T2\_0\ =\ *(C22)\ +\ T1\_0;}
\DoxyCodeLine{00326\ \ \ \ \ \ \ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ T2\_1\ =\ *(C22+1)\ +\ T1\_1;}
\DoxyCodeLine{00327\ \ \ \ \ \ \ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ T2\_2\ =\ *(C22+2)\ +\ T1\_2;}
\DoxyCodeLine{00328\ \ \ \ \ \ \ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ T2\_3\ =\ *(C22+3)\ +\ T1\_3;}
\DoxyCodeLine{00329\ \ \ \ \ \ \ (*(\mbox{\hyperlink{sandbox_2strassen_2omp_8cpp_ad1e82072c033df09d8b00f6d7d77e401}{C11}}))\ \ \ +=\ LocalM2\_0;}
\DoxyCodeLine{00330\ \ \ \ \ \ \ (*(\mbox{\hyperlink{sandbox_2strassen_2omp_8cpp_ad1e82072c033df09d8b00f6d7d77e401}{C11}}+1))\ +=\ LocalM2\_1;}
\DoxyCodeLine{00331\ \ \ \ \ \ \ (*(\mbox{\hyperlink{sandbox_2strassen_2omp_8cpp_ad1e82072c033df09d8b00f6d7d77e401}{C11}}+2))\ +=\ LocalM2\_2;}
\DoxyCodeLine{00332\ \ \ \ \ \ \ (*(\mbox{\hyperlink{sandbox_2strassen_2omp_8cpp_ad1e82072c033df09d8b00f6d7d77e401}{C11}}+3))\ +=\ LocalM2\_3;}
\DoxyCodeLine{00333\ \ \ \ \ \ \ (*(C12))\ \ \ +=\ LocalM5\_0\ +\ T1\_0;}
\DoxyCodeLine{00334\ \ \ \ \ \ \ (*(C12+1))\ +=\ LocalM5\_1\ +\ T1\_1;}
\DoxyCodeLine{00335\ \ \ \ \ \ \ (*(C12+2))\ +=\ LocalM5\_2\ +\ T1\_2;}
\DoxyCodeLine{00336\ \ \ \ \ \ \ (*(C12+3))\ +=\ LocalM5\_3\ +\ T1\_3;}
\DoxyCodeLine{00337\ \ \ \ \ \ \ (*(C22))\ \ \ =\ LocalM5\_0\ +\ T2\_0;}
\DoxyCodeLine{00338\ \ \ \ \ \ \ (*(C22+1))\ =\ LocalM5\_1\ +\ T2\_1;}
\DoxyCodeLine{00339\ \ \ \ \ \ \ (*(C22+2))\ =\ LocalM5\_2\ +\ T2\_2;}
\DoxyCodeLine{00340\ \ \ \ \ \ \ (*(C22+3))\ =\ LocalM5\_3\ +\ T2\_3;}
\DoxyCodeLine{00341\ \ \ \ \ \ \ (*(C21\ \ ))\ =\ (-\/\ *(C21\ \ ))\ +\ T2\_0;}
\DoxyCodeLine{00342\ \ \ \ \ \ \ (*(C21+1))\ =\ (-\/\ *(C21+1))\ +\ T2\_1;}
\DoxyCodeLine{00343\ \ \ \ \ \ \ (*(C21+2))\ =\ (-\/\ *(C21+2))\ +\ T2\_2;}
\DoxyCodeLine{00344\ \ \ \ \ \ \ (*(C21+3))\ =\ (-\/\ *(C21+3))\ +\ T2\_3;}
\DoxyCodeLine{00345\ \ \ \ \ \ \ M5\ +=\ 4;}
\DoxyCodeLine{00346\ \ \ \ \ \ \ \mbox{\hyperlink{_tutorial___reshape_mat2_mat_8cpp_ae3dc3553f10a3c3e5d701dc35895d1e4}{M2}}\ +=\ 4;}
\DoxyCodeLine{00347\ \ \ \ \ \ \ T1sMULT\ +=\ 4;}
\DoxyCodeLine{00348\ \ \ \ \ \ \ \mbox{\hyperlink{sandbox_2strassen_2omp_8cpp_ad1e82072c033df09d8b00f6d7d77e401}{C11}}\ +=\ 4;}
\DoxyCodeLine{00349\ \ \ \ \ \ \ C12\ +=\ 4;}
\DoxyCodeLine{00350\ \ \ \ \ \ \ C21\ +=\ 4;}
\DoxyCodeLine{00351\ \ \ \ \ \ \ C22\ +=\ 4;}
\DoxyCodeLine{00352\ \ \ \ \ \}}
\DoxyCodeLine{00353\ \ \ \ \ \mbox{\hyperlink{sandbox_2strassen_2omp_8cpp_ad1e82072c033df09d8b00f6d7d77e401}{C11}}\ =\ (\mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}*)\ (\ ((\mbox{\hyperlink{strassen_8hpp_a2f208551ae3b0941151ca120866b9f1f}{PTR}})\ \mbox{\hyperlink{sandbox_2strassen_2omp_8cpp_ad1e82072c033df09d8b00f6d7d77e401}{C11}}\ )\ +\ RowIncrementC);}
\DoxyCodeLine{00354\ \ \ \ \ C12\ =\ (\mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}*)\ (\ ((\mbox{\hyperlink{strassen_8hpp_a2f208551ae3b0941151ca120866b9f1f}{PTR}})\ C12\ )\ +\ RowIncrementC);}
\DoxyCodeLine{00355\ \ \ \ \ C21\ =\ (\mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}*)\ (\ ((\mbox{\hyperlink{strassen_8hpp_a2f208551ae3b0941151ca120866b9f1f}{PTR}})\ C21\ )\ +\ RowIncrementC);}
\DoxyCodeLine{00356\ \ \ \ \ C22\ =\ (\mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}*)\ (\ ((\mbox{\hyperlink{strassen_8hpp_a2f208551ae3b0941151ca120866b9f1f}{PTR}})\ C22\ )\ +\ RowIncrementC);}
\DoxyCodeLine{00357\ \ \ \}}
\DoxyCodeLine{00358\ \ \ \mbox{\hyperlink{mimalloc-override_8h_a9d4b5df3530d1bc733070a4669ba6ebc}{free}}(StartHeap);}
\DoxyCodeLine{00359\ \}}
\DoxyCodeLine{00360\ }
\DoxyCodeLine{00361\ }
\DoxyCodeLine{00362\ }
\DoxyCodeLine{00363\ }
\DoxyCodeLine{00364\ }
\DoxyCodeLine{00365\ \textcolor{comment}{/*****************************************************************************}}
\DoxyCodeLine{00366\ \textcolor{comment}{**}}
\DoxyCodeLine{00367\ \textcolor{comment}{**\ FastNaiveMatrixMultiply}}
\DoxyCodeLine{00368\ \textcolor{comment}{**}}
\DoxyCodeLine{00369\ \textcolor{comment}{**\ For\ small\ to\ medium\ sized\ matrices\ A,\ B,\ and\ C\ of\ size}}
\DoxyCodeLine{00370\ \textcolor{comment}{**\ MatrixSize\ *\ MatrixSize\ this\ function\ performs\ the\ operation}}
\DoxyCodeLine{00371\ \textcolor{comment}{**\ C\ =\ A\ x\ B\ efficiently.}}
\DoxyCodeLine{00372\ \textcolor{comment}{**}}
\DoxyCodeLine{00373\ \textcolor{comment}{**\ Note\ MatrixSize\ must\ be\ divisible\ by\ 8.}}
\DoxyCodeLine{00374\ \textcolor{comment}{**}}
\DoxyCodeLine{00375\ \textcolor{comment}{**\ INPUT:}}
\DoxyCodeLine{00376\ \textcolor{comment}{**\ \ \ \ C\ =\ (*C\ WRITE)\ Address\ of\ top\ left\ element\ of\ matrix\ C.}}
\DoxyCodeLine{00377\ \textcolor{comment}{**\ \ \ \ A\ =\ (*A\ IS\ READ\ ONLY)\ Address\ of\ top\ left\ element\ of\ matrix\ A.}}
\DoxyCodeLine{00378\ \textcolor{comment}{**\ \ \ \ B\ =\ (*B\ IS\ READ\ ONLY)\ Address\ of\ top\ left\ element\ of\ matrix\ B.}}
\DoxyCodeLine{00379\ \textcolor{comment}{**\ \ \ \ MatrixSize\ =\ Size\ of\ matrices\ (for\ n*n\ matrix,\ MatrixSize\ =\ n)}}
\DoxyCodeLine{00380\ \textcolor{comment}{**\ \ \ \ RowWidthA\ =\ Number\ of\ elements\ in\ memory\ between\ A[x,y]\ and\ A[x,y+1]}}
\DoxyCodeLine{00381\ \textcolor{comment}{**\ \ \ \ RowWidthB\ =\ Number\ of\ elements\ in\ memory\ between\ B[x,y]\ and\ B[x,y+1]}}
\DoxyCodeLine{00382\ \textcolor{comment}{**\ \ \ \ RowWidthC\ =\ Number\ of\ elements\ in\ memory\ between\ C[x,y]\ and\ C[x,y+1]}}
\DoxyCodeLine{00383\ \textcolor{comment}{**}}
\DoxyCodeLine{00384\ \textcolor{comment}{**\ OUTPUT:}}
\DoxyCodeLine{00385\ \textcolor{comment}{**\ \ \ \ C\ =\ (*C\ WRITE)\ Matrix\ C\ contains\ A\ x\ B.\ (Initial\ value\ of\ *C\ undefined.)}}
\DoxyCodeLine{00386\ \textcolor{comment}{**}}
\DoxyCodeLine{00387\ \textcolor{comment}{*****************************************************************************/}}
\DoxyCodeLine{00388\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{strassen_8hpp_aebcfced9273d2a0e8017388e84937fe3}{FastNaiveMatrixMultiply}}(\mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ *\mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}},\ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ *\mbox{\hyperlink{bench__gemm_8cpp_addc86e8508f14411ec98f521c520f875}{A}},\ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ *\mbox{\hyperlink{bench__gemm_8cpp_a37a83060ac796961b44991c836f083f7}{B}},\ \textcolor{keywordtype}{unsigned}\ MatrixSize,}
\DoxyCodeLine{00389\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ RowWidthC,\ \textcolor{keywordtype}{unsigned}\ RowWidthA,\ \textcolor{keywordtype}{unsigned}\ RowWidthB)\ \{}
\DoxyCodeLine{00390\ \ \ \textcolor{comment}{/*\ Assumes\ size\ of\ real\ is\ 8\ bytes\ */}}
\DoxyCodeLine{00391\ \ \ \mbox{\hyperlink{strassen_8hpp_a2f208551ae3b0941151ca120866b9f1f}{PTR}}\ RowWidthBInBytes\ =\ RowWidthB\ \ <<\ 3;}
\DoxyCodeLine{00392\ \ \ \mbox{\hyperlink{strassen_8hpp_a2f208551ae3b0941151ca120866b9f1f}{PTR}}\ RowWidthAInBytes\ =\ RowWidthA\ <<\ 3;}
\DoxyCodeLine{00393\ \ \ \mbox{\hyperlink{strassen_8hpp_a2f208551ae3b0941151ca120866b9f1f}{PTR}}\ MatrixWidthInBytes\ =\ MatrixSize\ <<\ 3;}
\DoxyCodeLine{00394\ \ \ \mbox{\hyperlink{strassen_8hpp_a2f208551ae3b0941151ca120866b9f1f}{PTR}}\ RowIncrementC\ =\ (\ RowWidthC\ -\/\ MatrixSize)\ <<\ 3;}
\DoxyCodeLine{00395\ \ \ \textcolor{keywordtype}{unsigned}\ Horizontal,\ Vertical;}
\DoxyCodeLine{00396\ }
\DoxyCodeLine{00397\ \ \ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ *ARowStart\ =\ \mbox{\hyperlink{bench__gemm_8cpp_addc86e8508f14411ec98f521c520f875}{A}};}
\DoxyCodeLine{00398\ \ \ \textcolor{keywordflow}{for}\ (Vertical\ =\ 0;\ Vertical\ <\ MatrixSize;\ Vertical++)\ \{}
\DoxyCodeLine{00399\ \ \ \ \ \textcolor{keywordflow}{for}\ (Horizontal\ =\ 0;\ Horizontal\ <\ MatrixSize;\ Horizontal\ +=\ 8)\ \{}
\DoxyCodeLine{00400\ \ \ \ \ \ \ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ *BColumnStart\ =\ \mbox{\hyperlink{bench__gemm_8cpp_a37a83060ac796961b44991c836f083f7}{B}}\ +\ Horizontal;}
\DoxyCodeLine{00401\ \ \ \ \ \ \ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ FirstARowValue\ =\ *ARowStart++;}
\DoxyCodeLine{00402\ }
\DoxyCodeLine{00403\ \ \ \ \ \ \ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ Sum0\ =\ FirstARowValue\ *\ (*BColumnStart);}
\DoxyCodeLine{00404\ \ \ \ \ \ \ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ Sum1\ =\ FirstARowValue\ *\ (*(BColumnStart+1));}
\DoxyCodeLine{00405\ \ \ \ \ \ \ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ Sum2\ =\ FirstARowValue\ *\ (*(BColumnStart+2));}
\DoxyCodeLine{00406\ \ \ \ \ \ \ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ Sum3\ =\ FirstARowValue\ *\ (*(BColumnStart+3));}
\DoxyCodeLine{00407\ \ \ \ \ \ \ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ Sum4\ =\ FirstARowValue\ *\ (*(BColumnStart+4));}
\DoxyCodeLine{00408\ \ \ \ \ \ \ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ Sum5\ =\ FirstARowValue\ *\ (*(BColumnStart+5));}
\DoxyCodeLine{00409\ \ \ \ \ \ \ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ Sum6\ =\ FirstARowValue\ *\ (*(BColumnStart+6));}
\DoxyCodeLine{00410\ \ \ \ \ \ \ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ Sum7\ =\ FirstARowValue\ *\ (*(BColumnStart+7));}
\DoxyCodeLine{00411\ }
\DoxyCodeLine{00412\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ Products;}
\DoxyCodeLine{00413\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (Products\ =\ 1;\ Products\ <\ MatrixSize;\ Products++)\ \{}
\DoxyCodeLine{00414\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ ARowValue\ =\ *ARowStart++;}
\DoxyCodeLine{00415\ \ \ \ \ \ \ \ \ BColumnStart\ =\ (\mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}*)\ (((\mbox{\hyperlink{strassen_8hpp_a2f208551ae3b0941151ca120866b9f1f}{PTR}})\ BColumnStart)\ +\ RowWidthBInBytes);}
\DoxyCodeLine{00416\ \ \ \ \ \ \ \ \ Sum0\ +=\ ARowValue\ *\ (*BColumnStart);}
\DoxyCodeLine{00417\ \ \ \ \ \ \ \ \ Sum1\ +=\ ARowValue\ *\ (*(BColumnStart+1));}
\DoxyCodeLine{00418\ \ \ \ \ \ \ \ \ Sum2\ +=\ ARowValue\ *\ (*(BColumnStart+2));}
\DoxyCodeLine{00419\ \ \ \ \ \ \ \ \ Sum3\ +=\ ARowValue\ *\ (*(BColumnStart+3));}
\DoxyCodeLine{00420\ \ \ \ \ \ \ \ \ Sum4\ +=\ ARowValue\ *\ (*(BColumnStart+4));}
\DoxyCodeLine{00421\ \ \ \ \ \ \ \ \ Sum5\ +=\ ARowValue\ *\ (*(BColumnStart+5));}
\DoxyCodeLine{00422\ \ \ \ \ \ \ \ \ Sum6\ +=\ ARowValue\ *\ (*(BColumnStart+6));}
\DoxyCodeLine{00423\ \ \ \ \ \ \ \ \ Sum7\ +=\ ARowValue\ *\ (*(BColumnStart+7));}
\DoxyCodeLine{00424\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00425\ \ \ \ \ \ \ ARowStart\ =\ (\mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}*)\ (\ ((\mbox{\hyperlink{strassen_8hpp_a2f208551ae3b0941151ca120866b9f1f}{PTR}})\ ARowStart)\ -\/\ MatrixWidthInBytes);}
\DoxyCodeLine{00426\ }
\DoxyCodeLine{00427\ \ \ \ \ \ \ *(\mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}})\ =\ Sum0;}
\DoxyCodeLine{00428\ \ \ \ \ \ \ *(\mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}}+1)\ =\ Sum1;}
\DoxyCodeLine{00429\ \ \ \ \ \ \ *(\mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}}+2)\ =\ Sum2;}
\DoxyCodeLine{00430\ \ \ \ \ \ \ *(\mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}}+3)\ =\ Sum3;}
\DoxyCodeLine{00431\ \ \ \ \ \ \ *(\mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}}+4)\ =\ Sum4;}
\DoxyCodeLine{00432\ \ \ \ \ \ \ *(\mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}}+5)\ =\ Sum5;}
\DoxyCodeLine{00433\ \ \ \ \ \ \ *(\mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}}+6)\ =\ Sum6;}
\DoxyCodeLine{00434\ \ \ \ \ \ \ *(\mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}}+7)\ =\ Sum7;}
\DoxyCodeLine{00435\ \ \ \ \ \ \ \mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}}+=8;}
\DoxyCodeLine{00436\ \ \ \ \ \}}
\DoxyCodeLine{00437\ \ \ \ \ ARowStart\ =\ (\mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}*)\ (\ ((\mbox{\hyperlink{strassen_8hpp_a2f208551ae3b0941151ca120866b9f1f}{PTR}})\ ARowStart)\ +\ RowWidthAInBytes\ );}
\DoxyCodeLine{00438\ \ \ \ \ \mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}}\ =\ (\mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}*)\ (\ ((\mbox{\hyperlink{strassen_8hpp_a2f208551ae3b0941151ca120866b9f1f}{PTR}})\ \mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}})\ +\ RowIncrementC\ );}
\DoxyCodeLine{00439\ \ \ \}}
\DoxyCodeLine{00440\ \}}
\DoxyCodeLine{00441\ }
\DoxyCodeLine{00442\ }
\DoxyCodeLine{00443\ \textcolor{comment}{/*****************************************************************************}}
\DoxyCodeLine{00444\ \textcolor{comment}{**}}
\DoxyCodeLine{00445\ \textcolor{comment}{**\ FastAdditiveNaiveMatrixMultiply}}
\DoxyCodeLine{00446\ \textcolor{comment}{**}}
\DoxyCodeLine{00447\ \textcolor{comment}{**\ For\ small\ to\ medium\ sized\ matrices\ A,\ B,\ and\ C\ of\ size}}
\DoxyCodeLine{00448\ \textcolor{comment}{**\ MatrixSize\ *\ MatrixSize\ this\ function\ performs\ the\ operation}}
\DoxyCodeLine{00449\ \textcolor{comment}{**\ C\ +=\ A\ x\ B\ efficiently.}}
\DoxyCodeLine{00450\ \textcolor{comment}{**}}
\DoxyCodeLine{00451\ \textcolor{comment}{**\ Note\ MatrixSize\ must\ be\ divisible\ by\ 8.}}
\DoxyCodeLine{00452\ \textcolor{comment}{**}}
\DoxyCodeLine{00453\ \textcolor{comment}{**\ INPUT:}}
\DoxyCodeLine{00454\ \textcolor{comment}{**\ \ \ \ C\ =\ (*C\ READ/WRITE)\ Address\ of\ top\ left\ element\ of\ matrix\ C.}}
\DoxyCodeLine{00455\ \textcolor{comment}{**\ \ \ \ A\ =\ (*A\ IS\ READ\ ONLY)\ Address\ of\ top\ left\ element\ of\ matrix\ A.}}
\DoxyCodeLine{00456\ \textcolor{comment}{**\ \ \ \ B\ =\ (*B\ IS\ READ\ ONLY)\ Address\ of\ top\ left\ element\ of\ matrix\ B.}}
\DoxyCodeLine{00457\ \textcolor{comment}{**\ \ \ \ MatrixSize\ =\ Size\ of\ matrices\ (for\ n*n\ matrix,\ MatrixSize\ =\ n)}}
\DoxyCodeLine{00458\ \textcolor{comment}{**\ \ \ \ RowWidthA\ =\ Number\ of\ elements\ in\ memory\ between\ A[x,y]\ and\ A[x,y+1]}}
\DoxyCodeLine{00459\ \textcolor{comment}{**\ \ \ \ RowWidthB\ =\ Number\ of\ elements\ in\ memory\ between\ B[x,y]\ and\ B[x,y+1]}}
\DoxyCodeLine{00460\ \textcolor{comment}{**\ \ \ \ RowWidthC\ =\ Number\ of\ elements\ in\ memory\ between\ C[x,y]\ and\ C[x,y+1]}}
\DoxyCodeLine{00461\ \textcolor{comment}{**}}
\DoxyCodeLine{00462\ \textcolor{comment}{**\ OUTPUT:}}
\DoxyCodeLine{00463\ \textcolor{comment}{**\ \ \ \ C\ =\ (*C\ READ/WRITE)\ Matrix\ C\ contains\ C\ +\ A\ x\ B.}}
\DoxyCodeLine{00464\ \textcolor{comment}{**}}
\DoxyCodeLine{00465\ \textcolor{comment}{*****************************************************************************/}}
\DoxyCodeLine{00466\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{strassen_8hpp_aae90e33322dd8d76c32cc70d39a3c92b}{FastAdditiveNaiveMatrixMultiply}}(\mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ *\mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}},\ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ *\mbox{\hyperlink{bench__gemm_8cpp_addc86e8508f14411ec98f521c520f875}{A}},\ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ *\mbox{\hyperlink{bench__gemm_8cpp_a37a83060ac796961b44991c836f083f7}{B}},\ \textcolor{keywordtype}{unsigned}\ MatrixSize,}
\DoxyCodeLine{00467\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ RowWidthC,\ \textcolor{keywordtype}{unsigned}\ RowWidthA,\ \textcolor{keywordtype}{unsigned}\ RowWidthB)\ \{}
\DoxyCodeLine{00468\ \ \ \textcolor{comment}{/*\ Assumes\ size\ of\ real\ is\ 8\ bytes\ */}}
\DoxyCodeLine{00469\ \ \ \mbox{\hyperlink{strassen_8hpp_a2f208551ae3b0941151ca120866b9f1f}{PTR}}\ RowWidthBInBytes\ =\ RowWidthB\ \ <<\ 3;}
\DoxyCodeLine{00470\ \ \ \mbox{\hyperlink{strassen_8hpp_a2f208551ae3b0941151ca120866b9f1f}{PTR}}\ RowWidthAInBytes\ =\ RowWidthA\ <<\ 3;}
\DoxyCodeLine{00471\ \ \ \mbox{\hyperlink{strassen_8hpp_a2f208551ae3b0941151ca120866b9f1f}{PTR}}\ MatrixWidthInBytes\ =\ MatrixSize\ <<\ 3;}
\DoxyCodeLine{00472\ \ \ \mbox{\hyperlink{strassen_8hpp_a2f208551ae3b0941151ca120866b9f1f}{PTR}}\ RowIncrementC\ =\ (\ RowWidthC\ -\/\ MatrixSize)\ <<\ 3;}
\DoxyCodeLine{00473\ \ \ \textcolor{keywordtype}{unsigned}\ Horizontal,\ Vertical;}
\DoxyCodeLine{00474\ }
\DoxyCodeLine{00475\ \ \ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ *ARowStart\ =\ \mbox{\hyperlink{bench__gemm_8cpp_addc86e8508f14411ec98f521c520f875}{A}};}
\DoxyCodeLine{00476\ \ \ \textcolor{keywordflow}{for}\ (Vertical\ =\ 0;\ Vertical\ <\ MatrixSize;\ Vertical++)\ \{}
\DoxyCodeLine{00477\ \ \ \ \ \textcolor{keywordflow}{for}\ (Horizontal\ =\ 0;\ Horizontal\ <\ MatrixSize;\ Horizontal\ +=\ 8)\ \{}
\DoxyCodeLine{00478\ \ \ \ \ \ \ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ *BColumnStart\ =\ \mbox{\hyperlink{bench__gemm_8cpp_a37a83060ac796961b44991c836f083f7}{B}}\ +\ Horizontal;}
\DoxyCodeLine{00479\ }
\DoxyCodeLine{00480\ \ \ \ \ \ \ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ Sum0\ =\ *\mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}};}
\DoxyCodeLine{00481\ \ \ \ \ \ \ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ Sum1\ =\ *(\mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}}+1);}
\DoxyCodeLine{00482\ \ \ \ \ \ \ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ Sum2\ =\ *(\mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}}+2);}
\DoxyCodeLine{00483\ \ \ \ \ \ \ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ Sum3\ =\ *(\mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}}+3);}
\DoxyCodeLine{00484\ \ \ \ \ \ \ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ Sum4\ =\ *(\mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}}+4);}
\DoxyCodeLine{00485\ \ \ \ \ \ \ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ Sum5\ =\ *(\mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}}+5);}
\DoxyCodeLine{00486\ \ \ \ \ \ \ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ Sum6\ =\ *(\mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}}+6);}
\DoxyCodeLine{00487\ \ \ \ \ \ \ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ Sum7\ =\ *(\mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}}+7);}
\DoxyCodeLine{00488\ }
\DoxyCodeLine{00489\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ Products;}
\DoxyCodeLine{00490\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (Products\ =\ 0;\ Products\ <\ MatrixSize;\ Products++)\ \{}
\DoxyCodeLine{00491\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ ARowValue\ =\ *ARowStart++;}
\DoxyCodeLine{00492\ }
\DoxyCodeLine{00493\ \ \ \ \ \ \ \ \ Sum0\ +=\ ARowValue\ *\ (*BColumnStart);}
\DoxyCodeLine{00494\ \ \ \ \ \ \ \ \ Sum1\ +=\ ARowValue\ *\ (*(BColumnStart+1));}
\DoxyCodeLine{00495\ \ \ \ \ \ \ \ \ Sum2\ +=\ ARowValue\ *\ (*(BColumnStart+2));}
\DoxyCodeLine{00496\ \ \ \ \ \ \ \ \ Sum3\ +=\ ARowValue\ *\ (*(BColumnStart+3));}
\DoxyCodeLine{00497\ \ \ \ \ \ \ \ \ Sum4\ +=\ ARowValue\ *\ (*(BColumnStart+4));}
\DoxyCodeLine{00498\ \ \ \ \ \ \ \ \ Sum5\ +=\ ARowValue\ *\ (*(BColumnStart+5));}
\DoxyCodeLine{00499\ \ \ \ \ \ \ \ \ Sum6\ +=\ ARowValue\ *\ (*(BColumnStart+6));}
\DoxyCodeLine{00500\ \ \ \ \ \ \ \ \ Sum7\ +=\ ARowValue\ *\ (*(BColumnStart+7));}
\DoxyCodeLine{00501\ }
\DoxyCodeLine{00502\ \ \ \ \ \ \ \ \ BColumnStart\ =\ (\mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}*)\ (((\mbox{\hyperlink{strassen_8hpp_a2f208551ae3b0941151ca120866b9f1f}{PTR}})\ BColumnStart)\ +\ RowWidthBInBytes);}
\DoxyCodeLine{00503\ }
\DoxyCodeLine{00504\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00505\ \ \ \ \ \ \ ARowStart\ =\ (\mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}*)\ (\ ((\mbox{\hyperlink{strassen_8hpp_a2f208551ae3b0941151ca120866b9f1f}{PTR}})\ ARowStart)\ -\/\ MatrixWidthInBytes);}
\DoxyCodeLine{00506\ }
\DoxyCodeLine{00507\ \ \ \ \ \ \ *(\mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}})\ =\ Sum0;}
\DoxyCodeLine{00508\ \ \ \ \ \ \ *(\mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}}+1)\ =\ Sum1;}
\DoxyCodeLine{00509\ \ \ \ \ \ \ *(\mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}}+2)\ =\ Sum2;}
\DoxyCodeLine{00510\ \ \ \ \ \ \ *(\mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}}+3)\ =\ Sum3;}
\DoxyCodeLine{00511\ \ \ \ \ \ \ *(\mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}}+4)\ =\ Sum4;}
\DoxyCodeLine{00512\ \ \ \ \ \ \ *(\mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}}+5)\ =\ Sum5;}
\DoxyCodeLine{00513\ \ \ \ \ \ \ *(\mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}}+6)\ =\ Sum6;}
\DoxyCodeLine{00514\ \ \ \ \ \ \ *(\mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}}+7)\ =\ Sum7;}
\DoxyCodeLine{00515\ \ \ \ \ \ \ \mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}}+=8;}
\DoxyCodeLine{00516\ \ \ \ \ \}}
\DoxyCodeLine{00517\ }
\DoxyCodeLine{00518\ \ \ \ \ ARowStart\ =\ (\mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}*)\ (\ ((\mbox{\hyperlink{strassen_8hpp_a2f208551ae3b0941151ca120866b9f1f}{PTR}})\ ARowStart)\ +\ RowWidthAInBytes\ );}
\DoxyCodeLine{00519\ \ \ \ \ \mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}}\ =\ (\mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}*)\ (\ ((\mbox{\hyperlink{strassen_8hpp_a2f208551ae3b0941151ca120866b9f1f}{PTR}})\ \mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}})\ +\ RowIncrementC\ );}
\DoxyCodeLine{00520\ \ \ \}}
\DoxyCodeLine{00521\ \}}
\DoxyCodeLine{00522\ }
\DoxyCodeLine{00523\ }
\DoxyCodeLine{00524\ }
\DoxyCodeLine{00525\ \textcolor{comment}{/*****************************************************************************}}
\DoxyCodeLine{00526\ \textcolor{comment}{**}}
\DoxyCodeLine{00527\ \textcolor{comment}{**\ MultiplyByDivideAndConquer}}
\DoxyCodeLine{00528\ \textcolor{comment}{**}}
\DoxyCodeLine{00529\ \textcolor{comment}{**\ For\ medium\ to\ medium-\/large\ (would\ you\ like\ fries\ with\ that)\ sized}}
\DoxyCodeLine{00530\ \textcolor{comment}{**\ matrices\ A,\ B,\ and\ C\ of\ size\ MatrixSize\ *\ MatrixSize\ this\ function}}
\DoxyCodeLine{00531\ \textcolor{comment}{**\ efficiently\ performs\ the\ operation}}
\DoxyCodeLine{00532\ \textcolor{comment}{**\ \ \ \ C\ \ =\ A\ x\ B\ (if\ AdditiveMode\ ==\ 0)}}
\DoxyCodeLine{00533\ \textcolor{comment}{**\ \ \ \ C\ +=\ A\ x\ B\ (if\ AdditiveMode\ !=\ 0)}}
\DoxyCodeLine{00534\ \textcolor{comment}{**}}
\DoxyCodeLine{00535\ \textcolor{comment}{**\ Note\ MatrixSize\ must\ be\ divisible\ by\ 16.}}
\DoxyCodeLine{00536\ \textcolor{comment}{**}}
\DoxyCodeLine{00537\ \textcolor{comment}{**\ INPUT:}}
\DoxyCodeLine{00538\ \textcolor{comment}{**\ \ \ \ C\ =\ (*C\ READ/WRITE)\ Address\ of\ top\ left\ element\ of\ matrix\ C.}}
\DoxyCodeLine{00539\ \textcolor{comment}{**\ \ \ \ A\ =\ (*A\ IS\ READ\ ONLY)\ Address\ of\ top\ left\ element\ of\ matrix\ A.}}
\DoxyCodeLine{00540\ \textcolor{comment}{**\ \ \ \ B\ =\ (*B\ IS\ READ\ ONLY)\ Address\ of\ top\ left\ element\ of\ matrix\ B.}}
\DoxyCodeLine{00541\ \textcolor{comment}{**\ \ \ \ MatrixSize\ =\ Size\ of\ matrices\ (for\ n*n\ matrix,\ MatrixSize\ =\ n)}}
\DoxyCodeLine{00542\ \textcolor{comment}{**\ \ \ \ RowWidthA\ =\ Number\ of\ elements\ in\ memory\ between\ A[x,y]\ and\ A[x,y+1]}}
\DoxyCodeLine{00543\ \textcolor{comment}{**\ \ \ \ RowWidthB\ =\ Number\ of\ elements\ in\ memory\ between\ B[x,y]\ and\ B[x,y+1]}}
\DoxyCodeLine{00544\ \textcolor{comment}{**\ \ \ \ RowWidthC\ =\ Number\ of\ elements\ in\ memory\ between\ C[x,y]\ and\ C[x,y+1]}}
\DoxyCodeLine{00545\ \textcolor{comment}{**\ \ \ \ AdditiveMode\ =\ 0\ if\ we\ want\ C\ =\ A\ x\ B,\ otherwise\ we'll\ do\ C\ +=\ A\ x\ B}}
\DoxyCodeLine{00546\ \textcolor{comment}{**}}
\DoxyCodeLine{00547\ \textcolor{comment}{**\ OUTPUT:}}
\DoxyCodeLine{00548\ \textcolor{comment}{**\ \ \ \ C\ (+)=\ A\ x\ B.\ (+\ if\ AdditiveMode\ !=\ 0)}}
\DoxyCodeLine{00549\ \textcolor{comment}{**}}
\DoxyCodeLine{00550\ \textcolor{comment}{*****************************************************************************/}}
\DoxyCodeLine{00551\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{strassen_8hpp_a000f61531e7126f47b6e9b81740f1ac4}{MultiplyByDivideAndConquer}}(\mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ *\mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}},\ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ *\mbox{\hyperlink{bench__gemm_8cpp_addc86e8508f14411ec98f521c520f875}{A}},\ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ *\mbox{\hyperlink{bench__gemm_8cpp_a37a83060ac796961b44991c836f083f7}{B}},}
\DoxyCodeLine{00552\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ MatrixSize,}
\DoxyCodeLine{00553\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ RowWidthC,}
\DoxyCodeLine{00554\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ RowWidthA,}
\DoxyCodeLine{00555\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ RowWidthB,}
\DoxyCodeLine{00556\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ AdditiveMode}
\DoxyCodeLine{00557\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{00558\ \{}
\DoxyCodeLine{00559\ \textcolor{preprocessor}{\ \ \#define\ A00\ A}}
\DoxyCodeLine{00560\ \textcolor{preprocessor}{\ \ \#define\ B00\ B}}
\DoxyCodeLine{00561\ \textcolor{preprocessor}{\ \ \#define\ C00\ C}}
\DoxyCodeLine{00562\ \ \ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ \ *A01,\ *A10,\ *\mbox{\hyperlink{sandbox_2strassen_2omp_8cpp_aa8394a82104d1917c30c5e017ccf6176}{A11}},\ *B01,\ *B10,\ *\mbox{\hyperlink{sandbox_2strassen_2omp_8cpp_ac66ad09c1f6644f8338cb98304d019cf}{B11}},\ *C01,\ *C10,\ *\mbox{\hyperlink{sandbox_2strassen_2omp_8cpp_ad1e82072c033df09d8b00f6d7d77e401}{C11}};}
\DoxyCodeLine{00563\ \ \ \textcolor{keywordtype}{unsigned}\ QuadrantSize\ =\ MatrixSize\ >>\ 1;}
\DoxyCodeLine{00564\ }
\DoxyCodeLine{00565\ \ \ \textcolor{comment}{/*\ partition\ the\ matrix\ */}}
\DoxyCodeLine{00566\ \ \ A01\ =\ \mbox{\hyperlink{strassen_8hpp_a29ab8f304572bfb421e3f7666da0fe4d}{A00}}\ +\ QuadrantSize;}
\DoxyCodeLine{00567\ \ \ A10\ =\ \mbox{\hyperlink{strassen_8hpp_a29ab8f304572bfb421e3f7666da0fe4d}{A00}}\ +\ RowWidthA\ *\ QuadrantSize;}
\DoxyCodeLine{00568\ \ \ \mbox{\hyperlink{sandbox_2strassen_2omp_8cpp_aa8394a82104d1917c30c5e017ccf6176}{A11}}\ =\ A10\ +\ QuadrantSize;}
\DoxyCodeLine{00569\ }
\DoxyCodeLine{00570\ \ \ B01\ =\ \mbox{\hyperlink{strassen_8hpp_a82be54ac04b76c471d998505a822f7e6}{B00}}\ +\ QuadrantSize;}
\DoxyCodeLine{00571\ \ \ B10\ =\ \mbox{\hyperlink{strassen_8hpp_a82be54ac04b76c471d998505a822f7e6}{B00}}\ +\ RowWidthB\ *\ QuadrantSize;}
\DoxyCodeLine{00572\ \ \ \mbox{\hyperlink{sandbox_2strassen_2omp_8cpp_ac66ad09c1f6644f8338cb98304d019cf}{B11}}\ =\ B10\ +\ QuadrantSize;}
\DoxyCodeLine{00573\ }
\DoxyCodeLine{00574\ \ \ C01\ =\ \mbox{\hyperlink{strassen_8hpp_af26a222c4256d614176446168d797234}{C00}}\ +\ QuadrantSize;}
\DoxyCodeLine{00575\ \ \ C10\ =\ \mbox{\hyperlink{strassen_8hpp_af26a222c4256d614176446168d797234}{C00}}\ +\ RowWidthC\ *\ QuadrantSize;}
\DoxyCodeLine{00576\ \ \ \mbox{\hyperlink{sandbox_2strassen_2omp_8cpp_ad1e82072c033df09d8b00f6d7d77e401}{C11}}\ =\ C10\ +\ QuadrantSize;}
\DoxyCodeLine{00577\ }
\DoxyCodeLine{00578\ \ \ \textcolor{keywordflow}{if}\ (QuadrantSize\ >\ \mbox{\hyperlink{strassen_8hpp_ab47507821aebb8cd0afe01e1b79d2ac2}{SizeAtWhichNaiveAlgorithmIsMoreEfficient}})\ \{}
\DoxyCodeLine{00579\ }
\DoxyCodeLine{00580\ \ \ \ \ \mbox{\hyperlink{strassen_8hpp_a000f61531e7126f47b6e9b81740f1ac4}{MultiplyByDivideAndConquer}}(\mbox{\hyperlink{strassen_8hpp_af26a222c4256d614176446168d797234}{C00}},\ \mbox{\hyperlink{strassen_8hpp_a29ab8f304572bfb421e3f7666da0fe4d}{A00}},\ \mbox{\hyperlink{strassen_8hpp_a82be54ac04b76c471d998505a822f7e6}{B00}},\ QuadrantSize,}
\DoxyCodeLine{00581\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ RowWidthC,\ RowWidthA,\ RowWidthB,}
\DoxyCodeLine{00582\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ AdditiveMode);}
\DoxyCodeLine{00583\ }
\DoxyCodeLine{00584\ \ \ \ \ \mbox{\hyperlink{strassen_8hpp_a000f61531e7126f47b6e9b81740f1ac4}{MultiplyByDivideAndConquer}}(C01,\ \mbox{\hyperlink{strassen_8hpp_a29ab8f304572bfb421e3f7666da0fe4d}{A00}},\ B01,\ QuadrantSize,}
\DoxyCodeLine{00585\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ RowWidthC,\ RowWidthA,\ RowWidthB,}
\DoxyCodeLine{00586\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ AdditiveMode);}
\DoxyCodeLine{00587\ }
\DoxyCodeLine{00588\ \ \ \ \ \mbox{\hyperlink{strassen_8hpp_a000f61531e7126f47b6e9b81740f1ac4}{MultiplyByDivideAndConquer}}(\mbox{\hyperlink{sandbox_2strassen_2omp_8cpp_ad1e82072c033df09d8b00f6d7d77e401}{C11}},\ A10,\ B01,\ QuadrantSize,}
\DoxyCodeLine{00589\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ RowWidthC,\ RowWidthA,\ RowWidthB,}
\DoxyCodeLine{00590\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ AdditiveMode);}
\DoxyCodeLine{00591\ }
\DoxyCodeLine{00592\ \ \ \ \ \mbox{\hyperlink{strassen_8hpp_a000f61531e7126f47b6e9b81740f1ac4}{MultiplyByDivideAndConquer}}(C10,\ A10,\ \mbox{\hyperlink{strassen_8hpp_a82be54ac04b76c471d998505a822f7e6}{B00}},\ QuadrantSize,}
\DoxyCodeLine{00593\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ RowWidthC,\ RowWidthA,\ RowWidthB,}
\DoxyCodeLine{00594\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ AdditiveMode);}
\DoxyCodeLine{00595\ }
\DoxyCodeLine{00596\ \ \ \ \ \mbox{\hyperlink{strassen_8hpp_a000f61531e7126f47b6e9b81740f1ac4}{MultiplyByDivideAndConquer}}(\mbox{\hyperlink{strassen_8hpp_af26a222c4256d614176446168d797234}{C00}},\ A01,\ B10,\ QuadrantSize,}
\DoxyCodeLine{00597\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ RowWidthC,\ RowWidthA,\ RowWidthB,}
\DoxyCodeLine{00598\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 1);}
\DoxyCodeLine{00599\ }
\DoxyCodeLine{00600\ \ \ \ \ \mbox{\hyperlink{strassen_8hpp_a000f61531e7126f47b6e9b81740f1ac4}{MultiplyByDivideAndConquer}}(C01,\ A01,\ \mbox{\hyperlink{sandbox_2strassen_2omp_8cpp_ac66ad09c1f6644f8338cb98304d019cf}{B11}},\ QuadrantSize,}
\DoxyCodeLine{00601\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ RowWidthC,\ RowWidthA,\ RowWidthB,}
\DoxyCodeLine{00602\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 1);}
\DoxyCodeLine{00603\ }
\DoxyCodeLine{00604\ \ \ \ \ \mbox{\hyperlink{strassen_8hpp_a000f61531e7126f47b6e9b81740f1ac4}{MultiplyByDivideAndConquer}}(\mbox{\hyperlink{sandbox_2strassen_2omp_8cpp_ad1e82072c033df09d8b00f6d7d77e401}{C11}},\ \mbox{\hyperlink{sandbox_2strassen_2omp_8cpp_aa8394a82104d1917c30c5e017ccf6176}{A11}},\ \mbox{\hyperlink{sandbox_2strassen_2omp_8cpp_ac66ad09c1f6644f8338cb98304d019cf}{B11}},\ QuadrantSize,}
\DoxyCodeLine{00605\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ RowWidthC,\ RowWidthA,\ RowWidthB,}
\DoxyCodeLine{00606\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 1);}
\DoxyCodeLine{00607\ }
\DoxyCodeLine{00608\ \ \ \ \ \mbox{\hyperlink{strassen_8hpp_a000f61531e7126f47b6e9b81740f1ac4}{MultiplyByDivideAndConquer}}(C10,\ \mbox{\hyperlink{sandbox_2strassen_2omp_8cpp_aa8394a82104d1917c30c5e017ccf6176}{A11}},\ B10,\ QuadrantSize,}
\DoxyCodeLine{00609\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ RowWidthC,\ RowWidthA,\ RowWidthB,}
\DoxyCodeLine{00610\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 1);}
\DoxyCodeLine{00611\ }
\DoxyCodeLine{00612\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00613\ }
\DoxyCodeLine{00614\ \ \ \ \ \textcolor{keywordflow}{if}\ (AdditiveMode)\ \{}
\DoxyCodeLine{00615\ \ \ \ \ \ \ \mbox{\hyperlink{strassen_8hpp_aae90e33322dd8d76c32cc70d39a3c92b}{FastAdditiveNaiveMatrixMultiply}}(\mbox{\hyperlink{strassen_8hpp_af26a222c4256d614176446168d797234}{C00}},\ \mbox{\hyperlink{strassen_8hpp_a29ab8f304572bfb421e3f7666da0fe4d}{A00}},\ \mbox{\hyperlink{strassen_8hpp_a82be54ac04b76c471d998505a822f7e6}{B00}},\ QuadrantSize,}
\DoxyCodeLine{00616\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ RowWidthC,\ RowWidthA,\ RowWidthB);}
\DoxyCodeLine{00617\ }
\DoxyCodeLine{00618\ \ \ \ \ \ \ \mbox{\hyperlink{strassen_8hpp_aae90e33322dd8d76c32cc70d39a3c92b}{FastAdditiveNaiveMatrixMultiply}}(C01,\ \mbox{\hyperlink{strassen_8hpp_a29ab8f304572bfb421e3f7666da0fe4d}{A00}},\ B01,\ QuadrantSize,}
\DoxyCodeLine{00619\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ RowWidthC,\ RowWidthA,\ RowWidthB);}
\DoxyCodeLine{00620\ }
\DoxyCodeLine{00621\ \ \ \ \ \ \ \mbox{\hyperlink{strassen_8hpp_aae90e33322dd8d76c32cc70d39a3c92b}{FastAdditiveNaiveMatrixMultiply}}(\mbox{\hyperlink{sandbox_2strassen_2omp_8cpp_ad1e82072c033df09d8b00f6d7d77e401}{C11}},\ A10,\ B01,\ QuadrantSize,}
\DoxyCodeLine{00622\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ RowWidthC,\ RowWidthA,\ RowWidthB);}
\DoxyCodeLine{00623\ }
\DoxyCodeLine{00624\ \ \ \ \ \ \ \mbox{\hyperlink{strassen_8hpp_aae90e33322dd8d76c32cc70d39a3c92b}{FastAdditiveNaiveMatrixMultiply}}(C10,\ A10,\ \mbox{\hyperlink{strassen_8hpp_a82be54ac04b76c471d998505a822f7e6}{B00}},\ QuadrantSize,}
\DoxyCodeLine{00625\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ RowWidthC,\ RowWidthA,\ RowWidthB);}
\DoxyCodeLine{00626\ }
\DoxyCodeLine{00627\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00628\ }
\DoxyCodeLine{00629\ \ \ \ \ \ \ \mbox{\hyperlink{strassen_8hpp_aebcfced9273d2a0e8017388e84937fe3}{FastNaiveMatrixMultiply}}(\mbox{\hyperlink{strassen_8hpp_af26a222c4256d614176446168d797234}{C00}},\ \mbox{\hyperlink{strassen_8hpp_a29ab8f304572bfb421e3f7666da0fe4d}{A00}},\ \mbox{\hyperlink{strassen_8hpp_a82be54ac04b76c471d998505a822f7e6}{B00}},\ QuadrantSize,}
\DoxyCodeLine{00630\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ RowWidthC,\ RowWidthA,\ RowWidthB);}
\DoxyCodeLine{00631\ }
\DoxyCodeLine{00632\ \ \ \ \ \ \ \mbox{\hyperlink{strassen_8hpp_aebcfced9273d2a0e8017388e84937fe3}{FastNaiveMatrixMultiply}}(C01,\ \mbox{\hyperlink{strassen_8hpp_a29ab8f304572bfb421e3f7666da0fe4d}{A00}},\ B01,\ QuadrantSize,}
\DoxyCodeLine{00633\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ RowWidthC,\ RowWidthA,\ RowWidthB);}
\DoxyCodeLine{00634\ }
\DoxyCodeLine{00635\ \ \ \ \ \ \ \mbox{\hyperlink{strassen_8hpp_aebcfced9273d2a0e8017388e84937fe3}{FastNaiveMatrixMultiply}}(\mbox{\hyperlink{sandbox_2strassen_2omp_8cpp_ad1e82072c033df09d8b00f6d7d77e401}{C11}},\ A10,\ B01,\ QuadrantSize,}
\DoxyCodeLine{00636\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ RowWidthC,\ RowWidthA,\ RowWidthB);}
\DoxyCodeLine{00637\ }
\DoxyCodeLine{00638\ \ \ \ \ \ \ \mbox{\hyperlink{strassen_8hpp_aebcfced9273d2a0e8017388e84937fe3}{FastNaiveMatrixMultiply}}(C10,\ A10,\ \mbox{\hyperlink{strassen_8hpp_a82be54ac04b76c471d998505a822f7e6}{B00}},\ QuadrantSize,}
\DoxyCodeLine{00639\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ RowWidthC,\ RowWidthA,\ RowWidthB);}
\DoxyCodeLine{00640\ \ \ \ \ \}}
\DoxyCodeLine{00641\ }
\DoxyCodeLine{00642\ \ \ \ \ \mbox{\hyperlink{strassen_8hpp_aae90e33322dd8d76c32cc70d39a3c92b}{FastAdditiveNaiveMatrixMultiply}}(\mbox{\hyperlink{strassen_8hpp_af26a222c4256d614176446168d797234}{C00}},\ A01,\ B10,\ QuadrantSize,}
\DoxyCodeLine{00643\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ RowWidthC,\ RowWidthA,\ RowWidthB);}
\DoxyCodeLine{00644\ }
\DoxyCodeLine{00645\ \ \ \ \ \mbox{\hyperlink{strassen_8hpp_aae90e33322dd8d76c32cc70d39a3c92b}{FastAdditiveNaiveMatrixMultiply}}(C01,\ A01,\ \mbox{\hyperlink{sandbox_2strassen_2omp_8cpp_ac66ad09c1f6644f8338cb98304d019cf}{B11}},\ QuadrantSize,}
\DoxyCodeLine{00646\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ RowWidthC,\ RowWidthA,\ RowWidthB);}
\DoxyCodeLine{00647\ }
\DoxyCodeLine{00648\ \ \ \ \ \mbox{\hyperlink{strassen_8hpp_aae90e33322dd8d76c32cc70d39a3c92b}{FastAdditiveNaiveMatrixMultiply}}(\mbox{\hyperlink{sandbox_2strassen_2omp_8cpp_ad1e82072c033df09d8b00f6d7d77e401}{C11}},\ \mbox{\hyperlink{sandbox_2strassen_2omp_8cpp_aa8394a82104d1917c30c5e017ccf6176}{A11}},\ \mbox{\hyperlink{sandbox_2strassen_2omp_8cpp_ac66ad09c1f6644f8338cb98304d019cf}{B11}},\ QuadrantSize,}
\DoxyCodeLine{00649\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ RowWidthC,\ RowWidthA,\ RowWidthB);}
\DoxyCodeLine{00650\ }
\DoxyCodeLine{00651\ \ \ \ \ \mbox{\hyperlink{strassen_8hpp_aae90e33322dd8d76c32cc70d39a3c92b}{FastAdditiveNaiveMatrixMultiply}}(C10,\ \mbox{\hyperlink{sandbox_2strassen_2omp_8cpp_aa8394a82104d1917c30c5e017ccf6176}{A11}},\ B10,\ QuadrantSize,}
\DoxyCodeLine{00652\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ RowWidthC,\ RowWidthA,\ RowWidthB);}
\DoxyCodeLine{00653\ \ \ \}}
\DoxyCodeLine{00654\ \}}
\DoxyCodeLine{00655\ }
\DoxyCodeLine{00656\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{strassen_8hpp_a27f250312e9d5f7048e55445cfc84063}{dump\_matrix}}(\textcolor{keywordtype}{double}\ *\mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}},\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ sz,\ std::string\&\&\ fname)\ \{}
\DoxyCodeLine{00657\ \ \ std::ofstream\ ofs\ \{fname\};}
\DoxyCodeLine{00658\ }
\DoxyCodeLine{00659\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}=0;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}<sz;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}++)\ \{}
\DoxyCodeLine{00660\ \ \ \ \ ofs\ <<\ \mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}}[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}]\ <<\ \textcolor{charliteral}{'\ '};}
\DoxyCodeLine{00661\ \ \ \}}
\DoxyCodeLine{00662\ \}}
\DoxyCodeLine{00663\ }
\DoxyCodeLine{00664\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{strassen_8hpp_adc8e0f5870bdec1d5180536153ac7e4c}{init\_ABC}}()\ \{}
\DoxyCodeLine{00665\ \ \ \mbox{\hyperlink{strassen_8hpp_ac0b9586faeb85e585dd720351e9d399e}{MatrixA}}\ =\ \mbox{\hyperlink{strassen_8hpp_abc7241a501dd1ea04fae2015ebcc972d}{alloc\_matrix}}(\mbox{\hyperlink{strassen_8hpp_a2bd32349fcbeb6ee86434a65226cba1a}{MATRIX\_SIZE}});}
\DoxyCodeLine{00666\ \ \ \mbox{\hyperlink{strassen_8hpp_a91ae22cb3f1a5f70eb0adf4e00e0731d}{MatrixB}}\ =\ \mbox{\hyperlink{strassen_8hpp_abc7241a501dd1ea04fae2015ebcc972d}{alloc\_matrix}}(\mbox{\hyperlink{strassen_8hpp_a2bd32349fcbeb6ee86434a65226cba1a}{MATRIX\_SIZE}});}
\DoxyCodeLine{00667\ \ \ \mbox{\hyperlink{strassen_8hpp_afdefc717c9d7bec9b9ab61bc50d75a54}{MatrixC}}\ =\ \mbox{\hyperlink{strassen_8hpp_abc7241a501dd1ea04fae2015ebcc972d}{alloc\_matrix}}(\mbox{\hyperlink{strassen_8hpp_a2bd32349fcbeb6ee86434a65226cba1a}{MATRIX\_SIZE}});}
\DoxyCodeLine{00668\ }
\DoxyCodeLine{00669\ \ \ ::srand(1);}
\DoxyCodeLine{00670\ \ \ \mbox{\hyperlink{matrix_8hpp_a21bb302efd69cdbe9ecc131ea2413bf9}{init\_matrix}}(\mbox{\hyperlink{strassen_8hpp_a2bd32349fcbeb6ee86434a65226cba1a}{MATRIX\_SIZE}},\ \mbox{\hyperlink{strassen_8hpp_ac0b9586faeb85e585dd720351e9d399e}{MatrixA}},\ \mbox{\hyperlink{strassen_8hpp_a2bd32349fcbeb6ee86434a65226cba1a}{MATRIX\_SIZE}});}
\DoxyCodeLine{00671\ \ \ \mbox{\hyperlink{matrix_8hpp_a21bb302efd69cdbe9ecc131ea2413bf9}{init\_matrix}}(\mbox{\hyperlink{strassen_8hpp_a2bd32349fcbeb6ee86434a65226cba1a}{MATRIX\_SIZE}},\ \mbox{\hyperlink{strassen_8hpp_a91ae22cb3f1a5f70eb0adf4e00e0731d}{MatrixB}},\ \mbox{\hyperlink{strassen_8hpp_a2bd32349fcbeb6ee86434a65226cba1a}{MATRIX\_SIZE}});}
\DoxyCodeLine{00672\ \}}
\DoxyCodeLine{00673\ }
\DoxyCodeLine{00674\ std::chrono::microseconds\ \mbox{\hyperlink{strassen_8hpp_ae4a7847081521abcf13dd891fd0c1dea}{measure\_time\_omp}}(\textcolor{keywordtype}{unsigned},\ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ *,\ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ *,\ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ *,\ \textcolor{keywordtype}{int});}
\DoxyCodeLine{00675\ std::chrono::microseconds\ \mbox{\hyperlink{strassen_8hpp_a20b22737da41ed01647f564c28f8db76}{measure\_time\_tbb}}(\textcolor{keywordtype}{unsigned},\ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ *,\ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ *,\ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ *,\ \textcolor{keywordtype}{int});}
\DoxyCodeLine{00676\ std::chrono::microseconds\ \mbox{\hyperlink{strassen_8hpp_ae8a20ac81cc339de1a00b07b25e9ea09}{measure\_time\_taskflow}}(\textcolor{keywordtype}{unsigned},\ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ *,\ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ *,\ \mbox{\hyperlink{fft_8h_a5821460e95a0800cf9f24c38915cbbde}{REAL}}\ *,\ \textcolor{keywordtype}{int});}
\DoxyCodeLine{00677\ }

\end{DoxyCode}
