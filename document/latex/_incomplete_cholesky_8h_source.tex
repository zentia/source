\doxysection{Incomplete\+Cholesky.\+h}
\hypertarget{_incomplete_cholesky_8h_source}{}\label{_incomplete_cholesky_8h_source}\index{external/taskflow/3rd-\/party/eigen-\/3.3.7/Eigen/src/IterativeLinearSolvers/IncompleteCholesky.h@{external/taskflow/3rd-\/party/eigen-\/3.3.7/Eigen/src/IterativeLinearSolvers/IncompleteCholesky.h}}
\mbox{\hyperlink{_incomplete_cholesky_8h}{浏览该文件的文档.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ This\ file\ is\ part\ of\ Eigen,\ a\ lightweight\ C++\ template\ library}}
\DoxyCodeLine{00002\ \textcolor{comment}{//\ for\ linear\ algebra.}}
\DoxyCodeLine{00003\ \textcolor{comment}{//}}
\DoxyCodeLine{00004\ \textcolor{comment}{//\ Copyright\ (C)\ 2012\ Désiré\ Nuentsa-\/Wakam\ <desire.nuentsa\_wakam@inria.fr>}}
\DoxyCodeLine{00005\ \textcolor{comment}{//\ Copyright\ (C)\ 2015\ Gael\ Guennebaud\ <gael.guennebaud@inria.fr>}}
\DoxyCodeLine{00006\ \textcolor{comment}{//}}
\DoxyCodeLine{00007\ \textcolor{comment}{//\ This\ Source\ Code\ Form\ is\ subject\ to\ the\ terms\ of\ the\ Mozilla}}
\DoxyCodeLine{00008\ \textcolor{comment}{//\ Public\ License\ v.\ 2.0.\ If\ a\ copy\ of\ the\ MPL\ was\ not\ distributed}}
\DoxyCodeLine{00009\ \textcolor{comment}{//\ with\ this\ file,\ You\ can\ obtain\ one\ at\ http://mozilla.org/MPL/2.0/.}}
\DoxyCodeLine{00010\ }
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#ifndef\ EIGEN\_INCOMPLETE\_CHOlESKY\_H}}
\DoxyCodeLine{00012\ \textcolor{preprocessor}{\#define\ EIGEN\_INCOMPLETE\_CHOlESKY\_H}}
\DoxyCodeLine{00013\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ <vector>}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ <list>}}
\DoxyCodeLine{00016\ }
\DoxyCodeLine{00017\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespace_eigen}{Eigen}}\ \{\ \ }
\DoxyCodeLine{00044\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ \mbox{\hyperlink{class_eigen_1_1_product}{Scalar}},\ \textcolor{keywordtype}{int}\ \_UpLo\ =\ \mbox{\hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cdaf581029282d421eee5aae14238c6f749}{Lower}},\ \textcolor{keyword}{typename}\ \_OrderingType\ =}
\DoxyCodeLine{00045\ \textcolor{preprocessor}{\#ifndef\ EIGEN\_MPL2\_ONLY}}
\DoxyCodeLine{00046\ \mbox{\hyperlink{class_eigen_1_1_a_m_d_ordering}{AMDOrdering<int>}}}
\DoxyCodeLine{00047\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00048\ \mbox{\hyperlink{class_eigen_1_1_natural_ordering}{NaturalOrdering<int>}}}
\DoxyCodeLine{00049\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00050\ >}
\DoxyCodeLine{00051\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_adaaa3975b8cf53f910d6a3344af92379}{IncompleteCholesky}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{class_eigen_1_1_sparse_solver_base_aacd99fa17db475e74d3834767f392f33}{SparseSolverBase}}<IncompleteCholesky<Scalar,\_UpLo,\_OrderingType>\ >}
\DoxyCodeLine{00052\ \{}
\DoxyCodeLine{00053\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00054\ \ \ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{class_eigen_1_1_sparse_solver_base_aacd99fa17db475e74d3834767f392f33}{SparseSolverBase<IncompleteCholesky<Scalar,\_UpLo,\_OrderingType>}}\ >\ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_a954c3b3807af067ab2f2440e8cb3e751}{Base}};}
\DoxyCodeLine{00055\ \ \ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{class_eigen_1_1_sparse_solver_base_ac52101f69d048d5c4b036eadf1f13673}{Base::m\_isInitialized}};}
\DoxyCodeLine{00056\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00057\ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{struct_eigen_1_1_generic_num_traits_abca8573812593670795c41f22aa9d5e2}{NumTraits<Scalar>::Real}}\ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_ae906362ed4ef090681a625b30a8a2352}{RealScalar}};\ }
\DoxyCodeLine{00058\ \ \ \ \ \textcolor{keyword}{typedef}\ \_OrderingType\ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_ac9632ffaca343c90320ca8cf58c76cb4}{OrderingType}};}
\DoxyCodeLine{00059\ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ OrderingType::PermutationType\ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_aa85d6c80b460b94f23b5da2a7169adbf}{PermutationType}};}
\DoxyCodeLine{00060\ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ PermutationType::StorageIndex\ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_a121d37da7609158f8c9d3645da0318cc}{StorageIndex}};\ }
\DoxyCodeLine{00061\ \ \ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{class_eigen_1_1_sparse_matrix}{SparseMatrix<Scalar,ColMajor,StorageIndex>}}\ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_a22b4aeb158ca4d5a5a276bd16dd1d1e1}{FactorType}};}
\DoxyCodeLine{00062\ \ \ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{class_eigen_1_1_matrix}{Matrix<Scalar,Dynamic,1>}}\ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_a559694dda108ecd08a5a6b8339d62446}{VectorSx}};}
\DoxyCodeLine{00063\ \ \ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{class_eigen_1_1_matrix}{Matrix<RealScalar,Dynamic,1>}}\ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_aed6cab509254b9056381df357b3cbd07}{VectorRx}};}
\DoxyCodeLine{00064\ \ \ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{class_eigen_1_1_matrix}{Matrix<StorageIndex,Dynamic,\ 1>}}\ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_a1c096f4e4f262a94148e697eaa7890d9}{VectorIx}};}
\DoxyCodeLine{00065\ \ \ \ \ \textcolor{keyword}{typedef}\ std::vector<std::list<StorageIndex>\ >\ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_aa758310799b31522f525e29cd8af7d46}{VectorList}};\ }
\DoxyCodeLine{00066\ \ \ \ \ \textcolor{keyword}{enum}\ \{\ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_ad2246ad4d53544a04a67bb959fea71dead6c19f6c3a9314c44b77510c88631e6e}{UpLo}}\ =\ \_UpLo\ \};}
\DoxyCodeLine{00067\ \ \ \ \ \textcolor{keyword}{enum}\ \{}
\DoxyCodeLine{00068\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_a45833fdfcf1a030b89993ce0d0a1f546a839702a09ba67e4d019a9685fb9d4218}{ColsAtCompileTime}}\ =\ \mbox{\hyperlink{namespace_eigen_ad81fa7195215a0ce30017dfac309f0b2}{Dynamic}},}
\DoxyCodeLine{00069\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_a45833fdfcf1a030b89993ce0d0a1f546a34de452309f33073cf71e346ba13916f}{MaxColsAtCompileTime}}\ =\ \mbox{\hyperlink{namespace_eigen_ad81fa7195215a0ce30017dfac309f0b2}{Dynamic}}}
\DoxyCodeLine{00070\ \ \ \ \ \};}
\DoxyCodeLine{00071\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00072\ }
\DoxyCodeLine{00079\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_adaaa3975b8cf53f910d6a3344af92379}{IncompleteCholesky}}()\ :\ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_a3a42e45e865228d446a3c6b49f474e87}{m\_initialShift}}(1\mbox{\hyperlink{_cwise__array__power__array_8cpp_a9cb86ff854760bf91a154f2724a9101d}{e}}-\/3),\mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_aab7215c08a43657abdaef848c3b90947}{m\_factorizationIsOk}}(\mbox{\hyperlink{yyjson_8h_a65e9886d74aaee76545e83dd09011727}{false}})\ \{\}}
\DoxyCodeLine{00080\ \ \ \ \ }
\DoxyCodeLine{00083\ \ \ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ MatrixType>}
\DoxyCodeLine{00084\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_a757499fc814988a5b112b1f34d0295e1}{IncompleteCholesky}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_transform}{MatrixType}}\&\ \mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}})\ :\ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_a3a42e45e865228d446a3c6b49f474e87}{m\_initialShift}}(1\mbox{\hyperlink{_cwise__array__power__array_8cpp_a9cb86ff854760bf91a154f2724a9101d}{e}}-\/3),\mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_aab7215c08a43657abdaef848c3b90947}{m\_factorizationIsOk}}(\mbox{\hyperlink{yyjson_8h_a65e9886d74aaee76545e83dd09011727}{false}})}
\DoxyCodeLine{00085\ \ \ \ \ \{}
\DoxyCodeLine{00086\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_a7966bedeebbeaa7a8fe4dd1da3797a0b}{compute}}(\mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}});}
\DoxyCodeLine{00087\ \ \ \ \ \}}
\DoxyCodeLine{00088\ \ \ \ \ }
\DoxyCodeLine{00090\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_a4780a83266c871782595081021268b5a}{rows}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_ac9bb29d22c7a1ecbb32212d9ea228b40}{m\_L}}.rows();\ \}}
\DoxyCodeLine{00091\ \ \ \ \ }
\DoxyCodeLine{00093\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_a0d66a1c8e340617e7ff404e63186fedb}{cols}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_ac9bb29d22c7a1ecbb32212d9ea228b40}{m\_L}}.cols();\ \}}
\DoxyCodeLine{00094\ \ \ \ \ }
\DoxyCodeLine{00095\ }
\DoxyCodeLine{00104\ \ \ \ \ \mbox{\hyperlink{group__enums_ga85fad7b87587764e5cf6b513a9e0ee5e}{ComputationInfo}}\ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_ada0e68cb22601849464506f5986a88c1}{info}}()\textcolor{keyword}{\ const}}
\DoxyCodeLine{00105\ \textcolor{keyword}{\ \ \ \ }\{}
\DoxyCodeLine{00106\ \ \ \ \ \ \ \mbox{\hyperlink{eigen-3_83_87_2_eigen_2src_2_core_2util_2_macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(\mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_a83538d4e0e7cfac5072b31b27baafb74}{m\_isInitialized}}\ \&\&\ \textcolor{stringliteral}{"{}IncompleteCholesky\ is\ not\ initialized."{}});}
\DoxyCodeLine{00107\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_abe5b6ad3c0a85dcd824a00697b490eac}{m\_info}};}
\DoxyCodeLine{00108\ \ \ \ \ \}}
\DoxyCodeLine{00109\ \ \ \ \ }
\DoxyCodeLine{00112\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_a409c9586e7d29566dda2c8f5e38a1228}{setInitialShift}}(\mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_ae906362ed4ef090681a625b30a8a2352}{RealScalar}}\ shift)\ \{\ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_a3a42e45e865228d446a3c6b49f474e87}{m\_initialShift}}\ =\ shift;\ \}}
\DoxyCodeLine{00113\ \ \ \ \ }
\DoxyCodeLine{00116\ \ \ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ MatrixType>}
\DoxyCodeLine{00117\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_a702560ecdddef77dc51d20ab22bd974e}{analyzePattern}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_transform}{MatrixType}}\&\ \mbox{\hyperlink{_tutorial___advanced_initialization___comma_temporary_8cpp_a5d2ded7a4c8830608d7b218f5f27c0a0}{mat}})}
\DoxyCodeLine{00118\ \ \ \ \ \{}
\DoxyCodeLine{00119\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_ac9632ffaca343c90320ca8cf58c76cb4}{OrderingType}}\ ord;\ }
\DoxyCodeLine{00120\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_aa85d6c80b460b94f23b5da2a7169adbf}{PermutationType}}\ pinv;}
\DoxyCodeLine{00121\ \ \ \ \ \ \ ord(\mbox{\hyperlink{_tutorial___advanced_initialization___comma_temporary_8cpp_a5d2ded7a4c8830608d7b218f5f27c0a0}{mat}}.template\ selfadjointView<UpLo>(),\ pinv);\ }
\DoxyCodeLine{00122\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(pinv.size()>0)\ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_acf5b562033401cd9b308259cd91a663e}{m\_perm}}\ =\ pinv.inverse();}
\DoxyCodeLine{00123\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_acf5b562033401cd9b308259cd91a663e}{m\_perm}}.resize(0);}
\DoxyCodeLine{00124\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_ac9bb29d22c7a1ecbb32212d9ea228b40}{m\_L}}.resize(\mbox{\hyperlink{_tutorial___advanced_initialization___comma_temporary_8cpp_a5d2ded7a4c8830608d7b218f5f27c0a0}{mat}}.rows(),\ \mbox{\hyperlink{_tutorial___advanced_initialization___comma_temporary_8cpp_a5d2ded7a4c8830608d7b218f5f27c0a0}{mat}}.cols());}
\DoxyCodeLine{00125\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_a5f034fe49d026dfef22a97a403d8aa4c}{m\_analysisIsOk}}\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00126\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_a83538d4e0e7cfac5072b31b27baafb74}{m\_isInitialized}}\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00127\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_abe5b6ad3c0a85dcd824a00697b490eac}{m\_info}}\ =\ \mbox{\hyperlink{group__enums_gga85fad7b87587764e5cf6b513a9e0ee5ea671a2aeb0f527802806a441d58a80fcf}{Success}};}
\DoxyCodeLine{00128\ \ \ \ \ \}}
\DoxyCodeLine{00129\ \ \ \ \ }
\DoxyCodeLine{00137\ \ \ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ MatrixType>}
\DoxyCodeLine{00138\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_ac39c75ff7ca5d2db9a9f03b937e12601}{factorize}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_transform}{MatrixType}}\&\ \mbox{\hyperlink{_tutorial___advanced_initialization___comma_temporary_8cpp_a5d2ded7a4c8830608d7b218f5f27c0a0}{mat}});}
\DoxyCodeLine{00139\ \ \ \ \ }
\DoxyCodeLine{00146\ \ \ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ MatrixType>}
\DoxyCodeLine{00147\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_a7966bedeebbeaa7a8fe4dd1da3797a0b}{compute}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_transform}{MatrixType}}\&\ \mbox{\hyperlink{_tutorial___advanced_initialization___comma_temporary_8cpp_a5d2ded7a4c8830608d7b218f5f27c0a0}{mat}})}
\DoxyCodeLine{00148\ \ \ \ \ \{}
\DoxyCodeLine{00149\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_a702560ecdddef77dc51d20ab22bd974e}{analyzePattern}}(\mbox{\hyperlink{_tutorial___advanced_initialization___comma_temporary_8cpp_a5d2ded7a4c8830608d7b218f5f27c0a0}{mat}});}
\DoxyCodeLine{00150\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_ac39c75ff7ca5d2db9a9f03b937e12601}{factorize}}(\mbox{\hyperlink{_tutorial___advanced_initialization___comma_temporary_8cpp_a5d2ded7a4c8830608d7b218f5f27c0a0}{mat}});}
\DoxyCodeLine{00151\ \ \ \ \ \}}
\DoxyCodeLine{00152\ \ \ \ \ }
\DoxyCodeLine{00153\ \ \ \ \ \textcolor{comment}{//\ internal}}
\DoxyCodeLine{00154\ \ \ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ Rhs,\ \textcolor{keyword}{typename}\ Dest>}
\DoxyCodeLine{00155\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_a7df2a13e73f1ac4a2fc7a6524bd93f84}{\_solve\_impl}}(\textcolor{keyword}{const}\ Rhs\&\ \mbox{\hyperlink{offscreen_8c_a846c9667e34d56c560bb7f0ac6e173f6}{b}},\ Dest\&\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}})\textcolor{keyword}{\ const}}
\DoxyCodeLine{00156\ \textcolor{keyword}{\ \ \ \ }\{}
\DoxyCodeLine{00157\ \ \ \ \ \ \ \mbox{\hyperlink{eigen-3_83_87_2_eigen_2src_2_core_2util_2_macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(\mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_aab7215c08a43657abdaef848c3b90947}{m\_factorizationIsOk}}\ \&\&\ \textcolor{stringliteral}{"{}factorize()\ should\ be\ called\ first"{}});}
\DoxyCodeLine{00158\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_acf5b562033401cd9b308259cd91a663e}{m\_perm}}.rows()\ ==\ \mbox{\hyperlink{offscreen_8c_a846c9667e34d56c560bb7f0ac6e173f6}{b}}.rows())\ \ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}}\ =\ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_acf5b562033401cd9b308259cd91a663e}{m\_perm}}\ *\ \mbox{\hyperlink{offscreen_8c_a846c9667e34d56c560bb7f0ac6e173f6}{b}};}
\DoxyCodeLine{00159\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}}\ =\ \mbox{\hyperlink{offscreen_8c_a846c9667e34d56c560bb7f0ac6e173f6}{b}};}
\DoxyCodeLine{00160\ \ \ \ \ \ \ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}}\ =\ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_aa4281d82edea96d9b2c7f696140c7401}{m\_scale}}.asDiagonal()\ *\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}};}
\DoxyCodeLine{00161\ \ \ \ \ \ \ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}}\ =\ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_ac9bb29d22c7a1ecbb32212d9ea228b40}{m\_L}}.template\ \mbox{\hyperlink{eigen-3_83_87_2lapack_2cholesky_8cpp_accba35e157cff07f839ca4634f76c472}{triangularView<Lower>}}().solve(\mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}});}
\DoxyCodeLine{00162\ \ \ \ \ \ \ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}}\ =\ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_ac9bb29d22c7a1ecbb32212d9ea228b40}{m\_L}}.adjoint().template\ triangularView<Upper>().solve(\mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}});}
\DoxyCodeLine{00163\ \ \ \ \ \ \ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}}\ =\ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_aa4281d82edea96d9b2c7f696140c7401}{m\_scale}}.asDiagonal()\ *\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}};}
\DoxyCodeLine{00164\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_acf5b562033401cd9b308259cd91a663e}{m\_perm}}.rows()\ ==\ \mbox{\hyperlink{offscreen_8c_a846c9667e34d56c560bb7f0ac6e173f6}{b}}.rows())}
\DoxyCodeLine{00165\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}}\ =\ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_acf5b562033401cd9b308259cd91a663e}{m\_perm}}.inverse()\ *\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}};}
\DoxyCodeLine{00166\ \ \ \ \ \}}
\DoxyCodeLine{00167\ }
\DoxyCodeLine{00169\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_a22b4aeb158ca4d5a5a276bd16dd1d1e1}{FactorType}}\&\ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_ae731a1e5b3e8d86b4eb87fd07a4e3532}{matrixL}}()\textcolor{keyword}{\ const\ }\{\ \mbox{\hyperlink{eigen-3_83_87_2_eigen_2src_2_core_2util_2_macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(\textcolor{stringliteral}{"{}m\_factorizationIsOk"{}});\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_ac9bb29d22c7a1ecbb32212d9ea228b40}{m\_L}};\ \}}
\DoxyCodeLine{00170\ }
\DoxyCodeLine{00172\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_aed6cab509254b9056381df357b3cbd07}{VectorRx}}\&\ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_a781d291f3dc3cb5fd339ab99a18cddd0}{scalingS}}()\textcolor{keyword}{\ const\ }\{\ \mbox{\hyperlink{eigen-3_83_87_2_eigen_2src_2_core_2util_2_macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(\textcolor{stringliteral}{"{}m\_factorizationIsOk"{}});\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_aa4281d82edea96d9b2c7f696140c7401}{m\_scale}};\ \}}
\DoxyCodeLine{00173\ }
\DoxyCodeLine{00175\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_aa85d6c80b460b94f23b5da2a7169adbf}{PermutationType}}\&\ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_abd97f2b0c2463f009edbe8f9f7e6599a}{permutationP}}()\textcolor{keyword}{\ const\ }\{\ \mbox{\hyperlink{eigen-3_83_87_2_eigen_2src_2_core_2util_2_macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(\textcolor{stringliteral}{"{}m\_analysisIsOk"{}});\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_acf5b562033401cd9b308259cd91a663e}{m\_perm}};\ \}}
\DoxyCodeLine{00176\ }
\DoxyCodeLine{00177\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00178\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_a22b4aeb158ca4d5a5a276bd16dd1d1e1}{FactorType}}\ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_ac9bb29d22c7a1ecbb32212d9ea228b40}{m\_L}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ The\ lower\ part\ stored\ in\ CSC}}
\DoxyCodeLine{00179\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_aed6cab509254b9056381df357b3cbd07}{VectorRx}}\ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_aa4281d82edea96d9b2c7f696140c7401}{m\_scale}};\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ The\ vector\ for\ scaling\ the\ matrix\ }}
\DoxyCodeLine{00180\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_ae906362ed4ef090681a625b30a8a2352}{RealScalar}}\ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_a3a42e45e865228d446a3c6b49f474e87}{m\_initialShift}};\ \ \ \textcolor{comment}{//\ The\ initial\ shift\ parameter}}
\DoxyCodeLine{00181\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_a5f034fe49d026dfef22a97a403d8aa4c}{m\_analysisIsOk}};\ }
\DoxyCodeLine{00182\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_aab7215c08a43657abdaef848c3b90947}{m\_factorizationIsOk}};\ }
\DoxyCodeLine{00183\ \ \ \ \ \mbox{\hyperlink{group__enums_ga85fad7b87587764e5cf6b513a9e0ee5e}{ComputationInfo}}\ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_abe5b6ad3c0a85dcd824a00697b490eac}{m\_info}};}
\DoxyCodeLine{00184\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_aa85d6c80b460b94f23b5da2a7169adbf}{PermutationType}}\ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_acf5b562033401cd9b308259cd91a663e}{m\_perm}};\ }
\DoxyCodeLine{00185\ }
\DoxyCodeLine{00186\ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00187\ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_afcdddb7639f27132c691ce7e79d11073}{updateList}}(\mbox{\hyperlink{class_eigen_1_1_ref}{Ref<const\ VectorIx>}}\ colPtr,\ \mbox{\hyperlink{class_eigen_1_1_ref}{Ref<VectorIx>}}\ rowIdx,\ \mbox{\hyperlink{class_eigen_1_1_ref}{Ref<VectorSx>}}\ vals,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\&\ \mbox{\hyperlink{_matrix_base__col_8cpp_aa168d9544aa6d49fce0cbfc0bec849b0}{col}},\ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\&\ jk,\ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_a1c096f4e4f262a94148e697eaa7890d9}{VectorIx}}\&\ firstElt,\ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_aa758310799b31522f525e29cd8af7d46}{VectorList}}\&\ listCol);\ }
\DoxyCodeLine{00188\ \};\ }
\DoxyCodeLine{00189\ }
\DoxyCodeLine{00190\ \textcolor{comment}{//\ Based\ on\ the\ following\ paper:}}
\DoxyCodeLine{00191\ \textcolor{comment}{//\ \ \ C-\/J.\ Lin\ and\ J.\ J.\ Moré,\ Incomplete\ Cholesky\ Factorizations\ with}}
\DoxyCodeLine{00192\ \textcolor{comment}{//\ \ \ Limited\ memory,\ SIAM\ J.\ Sci.\ Comput.\ \ 21(1),\ pp.\ 24-\/45,\ 1999}}
\DoxyCodeLine{00193\ \textcolor{comment}{//\ \ \ http://ftp.mcs.anl.gov/pub/tech\_reports/reports/P682.pdf}}
\DoxyCodeLine{00194\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ Scalar,\ \textcolor{keywordtype}{int}\ \_UpLo,\ \textcolor{keyword}{typename}\ OrderingType>}
\DoxyCodeLine{00195\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ \_MatrixType>}
\DoxyCodeLine{00196\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_ac39c75ff7ca5d2db9a9f03b937e12601}{IncompleteCholesky<Scalar,\_UpLo,\ OrderingType>::factorize}}(\textcolor{keyword}{const}\ \_MatrixType\&\ \mbox{\hyperlink{_tutorial___advanced_initialization___comma_temporary_8cpp_a5d2ded7a4c8830608d7b218f5f27c0a0}{mat}})}
\DoxyCodeLine{00197\ \{}
\DoxyCodeLine{00198\ \ \ \textcolor{keyword}{using\ }std::sqrt;}
\DoxyCodeLine{00199\ \ \ \mbox{\hyperlink{eigen-3_83_87_2_eigen_2src_2_core_2util_2_macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(\mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_a5f034fe49d026dfef22a97a403d8aa4c}{m\_analysisIsOk}}\ \&\&\ \textcolor{stringliteral}{"{}analyzePattern()\ should\ be\ called\ first"{}});\ }
\DoxyCodeLine{00200\ \ \ \ \ }
\DoxyCodeLine{00201\ \ \ \textcolor{comment}{//\ Dropping\ strategy\ :\ Keep\ only\ the\ p\ largest\ elements\ per\ column,\ where\ p\ is\ the\ number\ of\ elements\ in\ the\ column\ of\ the\ original\ matrix.\ Other\ strategies\ will\ be\ added}}
\DoxyCodeLine{00202\ \ \ }
\DoxyCodeLine{00203\ \ \ \textcolor{comment}{//\ Apply\ the\ fill-\/reducing\ permutation\ computed\ in\ analyzePattern()}}
\DoxyCodeLine{00204\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_acf5b562033401cd9b308259cd91a663e}{m\_perm}}.rows()\ ==\ \mbox{\hyperlink{_tutorial___advanced_initialization___comma_temporary_8cpp_a5d2ded7a4c8830608d7b218f5f27c0a0}{mat}}.rows()\ )\ \textcolor{comment}{//\ To\ detect\ the\ null\ permutation}}
\DoxyCodeLine{00205\ \ \ \{}
\DoxyCodeLine{00206\ \ \ \ \ \textcolor{comment}{//\ The\ temporary\ is\ needed\ to\ make\ sure\ that\ the\ diagonal\ entry\ is\ properly\ sorted}}
\DoxyCodeLine{00207\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_a22b4aeb158ca4d5a5a276bd16dd1d1e1}{FactorType}}\ tmp(\mbox{\hyperlink{_tutorial___advanced_initialization___comma_temporary_8cpp_a5d2ded7a4c8830608d7b218f5f27c0a0}{mat}}.rows(),\ \mbox{\hyperlink{_tutorial___advanced_initialization___comma_temporary_8cpp_a5d2ded7a4c8830608d7b218f5f27c0a0}{mat}}.cols());}
\DoxyCodeLine{00208\ \ \ \ \ tmp\ =\ \mbox{\hyperlink{_tutorial___advanced_initialization___comma_temporary_8cpp_a5d2ded7a4c8830608d7b218f5f27c0a0}{mat}}.template\ selfadjointView<\_UpLo>().twistedBy(\mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_acf5b562033401cd9b308259cd91a663e}{m\_perm}});}
\DoxyCodeLine{00209\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_ac9bb29d22c7a1ecbb32212d9ea228b40}{m\_L}}.template\ selfadjointView<Lower>()\ =\ tmp.template\ selfadjointView<Lower>();}
\DoxyCodeLine{00210\ \ \ \}}
\DoxyCodeLine{00211\ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00212\ \ \ \{}
\DoxyCodeLine{00213\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_ac9bb29d22c7a1ecbb32212d9ea228b40}{m\_L}}.template\ selfadjointView<Lower>()\ =\ \mbox{\hyperlink{_tutorial___advanced_initialization___comma_temporary_8cpp_a5d2ded7a4c8830608d7b218f5f27c0a0}{mat}}.template\ selfadjointView<\_UpLo>();}
\DoxyCodeLine{00214\ \ \ \}}
\DoxyCodeLine{00215\ \ \ }
\DoxyCodeLine{00216\ \ \ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}\ =\ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_ac9bb29d22c7a1ecbb32212d9ea228b40}{m\_L}}.cols();\ }
\DoxyCodeLine{00217\ \ \ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ nnz\ =\ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_ac9bb29d22c7a1ecbb32212d9ea228b40}{m\_L}}.nonZeros();}
\DoxyCodeLine{00218\ \ \ \mbox{\hyperlink{class_eigen_1_1_map}{Map<VectorSx>}}\ vals(\mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_ac9bb29d22c7a1ecbb32212d9ea228b40}{m\_L}}.valuePtr(),\ nnz);\ \ \ \ \ \ \ \ \ \textcolor{comment}{//values}}
\DoxyCodeLine{00219\ \ \ \mbox{\hyperlink{class_eigen_1_1_map}{Map<VectorIx>}}\ rowIdx(\mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_ac9bb29d22c7a1ecbb32212d9ea228b40}{m\_L}}.innerIndexPtr(),\ nnz);\ \ \textcolor{comment}{//Row\ indices}}
\DoxyCodeLine{00220\ \ \ \mbox{\hyperlink{class_eigen_1_1_map}{Map<VectorIx>}}\ colPtr(\ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_ac9bb29d22c7a1ecbb32212d9ea228b40}{m\_L}}.outerIndexPtr(),\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}+1);\ \textcolor{comment}{//\ Pointer\ to\ the\ beginning\ of\ each\ row}}
\DoxyCodeLine{00221\ \ \ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_a1c096f4e4f262a94148e697eaa7890d9}{VectorIx}}\ firstElt(\mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}-\/1);\ \textcolor{comment}{//\ for\ each\ j,\ points\ to\ the\ next\ entry\ in\ vals\ that\ will\ be\ used\ in\ the\ factorization}}
\DoxyCodeLine{00222\ \ \ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_aa758310799b31522f525e29cd8af7d46}{VectorList}}\ listCol(\mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}});\ \ \textcolor{comment}{//\ listCol(j)\ is\ a\ linked\ list\ of\ columns\ to\ update\ column\ j}}
\DoxyCodeLine{00223\ \ \ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_a559694dda108ecd08a5a6b8339d62446}{VectorSx}}\ col\_vals(\mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}});\ \ \ \textcolor{comment}{//\ Store\ a\ \ nonzero\ values\ in\ each\ column}}
\DoxyCodeLine{00224\ \ \ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_a1c096f4e4f262a94148e697eaa7890d9}{VectorIx}}\ col\_irow(\mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}});\ \ \ \textcolor{comment}{//\ Row\ indices\ of\ nonzero\ elements\ in\ each\ column}}
\DoxyCodeLine{00225\ \ \ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_a1c096f4e4f262a94148e697eaa7890d9}{VectorIx}}\ col\_pattern(\mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}});}
\DoxyCodeLine{00226\ \ \ col\_pattern.fill(-\/1);}
\DoxyCodeLine{00227\ \ \ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_a121d37da7609158f8c9d3645da0318cc}{StorageIndex}}\ col\_nnz;}
\DoxyCodeLine{00228\ \ \ }
\DoxyCodeLine{00229\ \ \ }
\DoxyCodeLine{00230\ \ \ \textcolor{comment}{//\ Computes\ the\ scaling\ factors\ }}
\DoxyCodeLine{00231\ \ \ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_aa4281d82edea96d9b2c7f696140c7401}{m\_scale}}.resize(\mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}});}
\DoxyCodeLine{00232\ \ \ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_aa4281d82edea96d9b2c7f696140c7401}{m\_scale}}.setZero();}
\DoxyCodeLine{00233\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}\ =\ 0;\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}\ <\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}};\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}++)}
\DoxyCodeLine{00234\ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ k\ =\ colPtr[\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}];\ k\ <\ colPtr[\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}+1];\ k++)}
\DoxyCodeLine{00235\ \ \ \ \ \{}
\DoxyCodeLine{00236\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_aa4281d82edea96d9b2c7f696140c7401}{m\_scale}}(\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}})\ +=\ numext::abs2(vals(k));}
\DoxyCodeLine{00237\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(rowIdx[k]!=\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}})}
\DoxyCodeLine{00238\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_aa4281d82edea96d9b2c7f696140c7401}{m\_scale}}(rowIdx[k])\ +=\ numext::abs2(vals(k));}
\DoxyCodeLine{00239\ \ \ \ \ \}}
\DoxyCodeLine{00240\ \ \ }
\DoxyCodeLine{00241\ \ \ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_aa4281d82edea96d9b2c7f696140c7401}{m\_scale}}\ =\ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_aa4281d82edea96d9b2c7f696140c7401}{m\_scale}}.cwiseSqrt().cwiseSqrt();}
\DoxyCodeLine{00242\ }
\DoxyCodeLine{00243\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}\ =\ 0;\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}\ <\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}};\ ++\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}})}
\DoxyCodeLine{00244\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_aa4281d82edea96d9b2c7f696140c7401}{m\_scale}}(\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}})>(std::numeric\_limits<RealScalar>::min)())}
\DoxyCodeLine{00245\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_aa4281d82edea96d9b2c7f696140c7401}{m\_scale}}(\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}})\ =\ \mbox{\hyperlink{bench__gemm_8cpp_acb5c3dc237f99cf17167e8a629f01b43}{RealScalar}}(1)/\mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_aa4281d82edea96d9b2c7f696140c7401}{m\_scale}}(\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}});}
\DoxyCodeLine{00246\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00247\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_aa4281d82edea96d9b2c7f696140c7401}{m\_scale}}(\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}})\ =\ 1;}
\DoxyCodeLine{00248\ }
\DoxyCodeLine{00249\ \ \ \textcolor{comment}{//\ TODO\ disable\ scaling\ if\ not\ needed,\ i.e.,\ if\ it\ is\ roughly\ uniform?\ (this\ will\ make\ solve()\ faster)}}
\DoxyCodeLine{00250\ \ \ }
\DoxyCodeLine{00251\ \ \ \textcolor{comment}{//\ Scale\ and\ compute\ the\ shift\ for\ the\ matrix\ }}
\DoxyCodeLine{00252\ \ \ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_ae906362ed4ef090681a625b30a8a2352}{RealScalar}}\ mindiag\ =\ \mbox{\hyperlink{struct_eigen_1_1_generic_num_traits_a65bdb77320d731419c061b91b8c4c5be}{NumTraits<RealScalar>::highest}}();}
\DoxyCodeLine{00253\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}\ =\ 0;\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}\ <\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}};\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}++)}
\DoxyCodeLine{00254\ \ \ \{}
\DoxyCodeLine{00255\ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ k\ =\ colPtr[\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}];\ k\ <\ colPtr[\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}+1];\ k++)}
\DoxyCodeLine{00256\ \ \ \ \ \ \ vals[k]\ *=\ (\mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_aa4281d82edea96d9b2c7f696140c7401}{m\_scale}}(\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}})*\mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_aa4281d82edea96d9b2c7f696140c7401}{m\_scale}}(rowIdx[k]));}
\DoxyCodeLine{00257\ \ \ \ \ \mbox{\hyperlink{eigen-3_83_87_2_eigen_2src_2_core_2util_2_macros_8h_a4e742b5a08636a61784c0e173b61e710}{eigen\_internal\_assert}}(rowIdx[colPtr[\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}]]==\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}\ \&\&\ \textcolor{stringliteral}{"{}IncompleteCholesky:\ only\ the\ lower\ triangular\ part\ must\ be\ stored"{}});}
\DoxyCodeLine{00258\ \ \ \ \ mindiag\ =\ \mbox{\hyperlink{namespace_eigen_1_1numext_ab3b30bf0bcfa1ad91dbec75fabb3bea0}{numext::mini}}(numext::real(vals[colPtr[\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}]]),\ mindiag);}
\DoxyCodeLine{00259\ \ \ \}}
\DoxyCodeLine{00260\ }
\DoxyCodeLine{00261\ \ \ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_a22b4aeb158ca4d5a5a276bd16dd1d1e1}{FactorType}}\ L\_save\ =\ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_ac9bb29d22c7a1ecbb32212d9ea228b40}{m\_L}};}
\DoxyCodeLine{00262\ \ \ }
\DoxyCodeLine{00263\ \ \ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_ae906362ed4ef090681a625b30a8a2352}{RealScalar}}\ shift\ =\ 0;}
\DoxyCodeLine{00264\ \ \ \textcolor{keywordflow}{if}(mindiag\ <=\ \mbox{\hyperlink{bench__gemm_8cpp_acb5c3dc237f99cf17167e8a629f01b43}{RealScalar}}(0.))}
\DoxyCodeLine{00265\ \ \ \ \ shift\ =\ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_a3a42e45e865228d446a3c6b49f474e87}{m\_initialShift}}\ -\/\ mindiag;}
\DoxyCodeLine{00266\ }
\DoxyCodeLine{00267\ \ \ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_abe5b6ad3c0a85dcd824a00697b490eac}{m\_info}}\ =\ \mbox{\hyperlink{group__enums_gga85fad7b87587764e5cf6b513a9e0ee5ea1c6e20706575a629b27a105f07f1883b}{NumericalIssue}};}
\DoxyCodeLine{00268\ }
\DoxyCodeLine{00269\ \ \ \textcolor{comment}{//\ Try\ to\ perform\ the\ incomplete\ factorization\ using\ the\ current\ shift}}
\DoxyCodeLine{00270\ \ \ \textcolor{keywordtype}{int}\ iter\ =\ 0;}
\DoxyCodeLine{00271\ \ \ \textcolor{keywordflow}{do}}
\DoxyCodeLine{00272\ \ \ \{}
\DoxyCodeLine{00273\ \ \ \ \ \textcolor{comment}{//\ Apply\ the\ shift\ to\ the\ diagonal\ elements\ of\ the\ matrix}}
\DoxyCodeLine{00274\ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}\ =\ 0;\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}\ <\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}};\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}++)}
\DoxyCodeLine{00275\ \ \ \ \ \ \ vals[colPtr[\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}]]\ +=\ shift;}
\DoxyCodeLine{00276\ }
\DoxyCodeLine{00277\ \ \ \ \ \textcolor{comment}{//\ jki\ version\ of\ the\ Cholesky\ factorization}}
\DoxyCodeLine{00278\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}=0;}
\DoxyCodeLine{00279\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}\ <\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}};\ ++\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}})}
\DoxyCodeLine{00280\ \ \ \ \ \{}
\DoxyCodeLine{00281\ \ \ \ \ \ \ \textcolor{comment}{//\ Left-\/looking\ factorization\ of\ the\ j-\/th\ column}}
\DoxyCodeLine{00282\ \ \ \ \ \ \ \textcolor{comment}{//\ First,\ load\ the\ j-\/th\ column\ into\ col\_vals}}
\DoxyCodeLine{00283\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_product}{Scalar}}\ diag\ =\ vals[colPtr[\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}]];\ \ \textcolor{comment}{//\ It\ is\ assumed\ that\ only\ the\ lower\ part\ is\ stored}}
\DoxyCodeLine{00284\ \ \ \ \ \ \ col\_nnz\ =\ 0;}
\DoxyCodeLine{00285\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ =\ colPtr[\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}]\ +\ 1;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ <\ colPtr[\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}+1];\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}++)}
\DoxyCodeLine{00286\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00287\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_a121d37da7609158f8c9d3645da0318cc}{StorageIndex}}\ l\ =\ rowIdx[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}];}
\DoxyCodeLine{00288\ \ \ \ \ \ \ \ \ col\_vals(col\_nnz)\ =\ vals[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}];}
\DoxyCodeLine{00289\ \ \ \ \ \ \ \ \ col\_irow(col\_nnz)\ =\ l;}
\DoxyCodeLine{00290\ \ \ \ \ \ \ \ \ col\_pattern(l)\ =\ col\_nnz;}
\DoxyCodeLine{00291\ \ \ \ \ \ \ \ \ col\_nnz++;}
\DoxyCodeLine{00292\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00293\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00294\ \ \ \ \ \ \ \ \ \textcolor{keyword}{typename}\ std::list<StorageIndex>::iterator\ k;}
\DoxyCodeLine{00295\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Browse\ all\ previous\ columns\ that\ will\ update\ column\ j}}
\DoxyCodeLine{00296\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(k\ =\ listCol[\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}].\mbox{\hyperlink{ittnotify__static_8h_a50deeaccd8b2b4be185e1befc7860258}{begin}}();\ k\ !=\ listCol[\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}].end();\ k++)}
\DoxyCodeLine{00297\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00298\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ jk\ =\ firstElt(*k);\ \textcolor{comment}{//\ First\ element\ to\ use\ in\ the\ column}}
\DoxyCodeLine{00299\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{eigen-3_83_87_2_eigen_2src_2_core_2util_2_macros_8h_a4e742b5a08636a61784c0e173b61e710}{eigen\_internal\_assert}}(rowIdx[jk]==\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}});}
\DoxyCodeLine{00300\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_product}{Scalar}}\ v\_j\_jk\ =\ numext::conj(vals[jk]);}
\DoxyCodeLine{00301\ }
\DoxyCodeLine{00302\ \ \ \ \ \ \ \ \ \ \ jk\ +=\ 1;}
\DoxyCodeLine{00303\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ =\ jk;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ <\ colPtr[*k+1];\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}++)}
\DoxyCodeLine{00304\ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00305\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_a121d37da7609158f8c9d3645da0318cc}{StorageIndex}}\ l\ =\ rowIdx[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}];}
\DoxyCodeLine{00306\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(col\_pattern[l]<0)}
\DoxyCodeLine{00307\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00308\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ col\_vals(col\_nnz)\ =\ vals[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}]\ *\ v\_j\_jk;}
\DoxyCodeLine{00309\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ col\_irow[col\_nnz]\ =\ l;}
\DoxyCodeLine{00310\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ col\_pattern(l)\ =\ col\_nnz;}
\DoxyCodeLine{00311\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ col\_nnz++;}
\DoxyCodeLine{00312\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00313\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00314\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ col\_vals(col\_pattern[l])\ -\/=\ vals[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}]\ *\ v\_j\_jk;}
\DoxyCodeLine{00315\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00316\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_afcdddb7639f27132c691ce7e79d11073}{updateList}}(colPtr,rowIdx,vals,\ *k,\ jk,\ firstElt,\ listCol);}
\DoxyCodeLine{00317\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00318\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00319\ }
\DoxyCodeLine{00320\ \ \ \ \ \ \ \textcolor{comment}{//\ Scale\ the\ current\ column}}
\DoxyCodeLine{00321\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(numext::real(diag)\ <=\ 0)}
\DoxyCodeLine{00322\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00323\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(++iter>=10)}
\DoxyCodeLine{00324\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00325\ }
\DoxyCodeLine{00326\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ increase\ shift}}
\DoxyCodeLine{00327\ \ \ \ \ \ \ \ \ shift\ =\ \mbox{\hyperlink{namespace_eigen_1_1numext_a29d502349f2ec9897c808e65e0f96eb4}{numext::maxi}}(\mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_a3a42e45e865228d446a3c6b49f474e87}{m\_initialShift}},\mbox{\hyperlink{bench__gemm_8cpp_acb5c3dc237f99cf17167e8a629f01b43}{RealScalar}}(2)*shift);}
\DoxyCodeLine{00328\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ restore\ m\_L,\ col\_pattern,\ and\ listCol}}
\DoxyCodeLine{00329\ \ \ \ \ \ \ \ \ vals\ =\ \mbox{\hyperlink{class_eigen_1_1_map}{Map<const\ VectorSx>}}(L\_save.\mbox{\hyperlink{class_eigen_1_1_sparse_matrix_ab5f971ff967ee031ab8941b76c5af940}{valuePtr}}(),\ nnz);}
\DoxyCodeLine{00330\ \ \ \ \ \ \ \ \ rowIdx\ =\ \mbox{\hyperlink{class_eigen_1_1_map}{Map<const\ VectorIx>}}(L\_save.\mbox{\hyperlink{class_eigen_1_1_sparse_matrix_a7f88ee2d9b1ab77555fa039a6f5034f7}{innerIndexPtr}}(),\ nnz);}
\DoxyCodeLine{00331\ \ \ \ \ \ \ \ \ colPtr\ =\ \mbox{\hyperlink{class_eigen_1_1_map}{Map<const\ VectorIx>}}(L\_save.\mbox{\hyperlink{class_eigen_1_1_sparse_matrix_a8036c2ed19ca4c506641a6db8a3c9daf}{outerIndexPtr}}(),\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}+1);}
\DoxyCodeLine{00332\ \ \ \ \ \ \ \ \ col\_pattern.fill(-\/1);}
\DoxyCodeLine{00333\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}=0;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}<\mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}};\ ++\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})}
\DoxyCodeLine{00334\ \ \ \ \ \ \ \ \ \ \ listCol[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}].clear();}
\DoxyCodeLine{00335\ }
\DoxyCodeLine{00336\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00337\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00338\ }
\DoxyCodeLine{00339\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_ae906362ed4ef090681a625b30a8a2352}{RealScalar}}\ rdiag\ =\ \mbox{\hyperlink{_array_cwise_unary_ops_8h_a656b9217a2fcb6de59dc8d1eb3079cc7}{sqrt}}(numext::real(diag));}
\DoxyCodeLine{00340\ \ \ \ \ \ \ vals[colPtr[\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}]]\ =\ rdiag;}
\DoxyCodeLine{00341\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ k\ =\ 0;\ k<col\_nnz;\ ++k)}
\DoxyCodeLine{00342\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00343\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ =\ col\_irow[k];}
\DoxyCodeLine{00344\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Scale}}
\DoxyCodeLine{00345\ \ \ \ \ \ \ \ \ col\_vals(k)\ /=\ rdiag;}
\DoxyCodeLine{00346\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Update\ the\ remaining\ diagonals\ with\ col\_vals}}
\DoxyCodeLine{00347\ \ \ \ \ \ \ \ \ vals[colPtr[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}]]\ -\/=\ numext::abs2(col\_vals(k));}
\DoxyCodeLine{00348\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00349\ \ \ \ \ \ \ \textcolor{comment}{//\ Select\ the\ largest\ p\ elements}}
\DoxyCodeLine{00350\ \ \ \ \ \ \ \textcolor{comment}{//\ p\ is\ the\ original\ number\ of\ elements\ in\ the\ column\ (without\ the\ diagonal)}}
\DoxyCodeLine{00351\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ \mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}}\ =\ colPtr[\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}+1]\ -\/\ colPtr[\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}]\ -\/\ 1\ ;}
\DoxyCodeLine{00352\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_ref}{Ref<VectorSx>}}\ cvals\ =\ col\_vals.head(col\_nnz);}
\DoxyCodeLine{00353\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_ref}{Ref<VectorIx>}}\ cirow\ =\ col\_irow.head(col\_nnz);}
\DoxyCodeLine{00354\ \ \ \ \ \ \ \mbox{\hyperlink{namespace_eigen_1_1internal_a78664f5a9fe806690984dc3a31738a6b}{internal::QuickSplit}}(cvals,cirow,\ \mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}});}
\DoxyCodeLine{00355\ \ \ \ \ \ \ \textcolor{comment}{//\ Insert\ the\ largest\ p\ elements\ in\ the\ matrix}}
\DoxyCodeLine{00356\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ cpt\ =\ 0;}
\DoxyCodeLine{00357\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ =\ colPtr[\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}]+1;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ <\ colPtr[\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}+1];\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}++)}
\DoxyCodeLine{00358\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00359\ \ \ \ \ \ \ \ \ vals[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}]\ =\ col\_vals(cpt);}
\DoxyCodeLine{00360\ \ \ \ \ \ \ \ \ rowIdx[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}]\ =\ col\_irow(cpt);}
\DoxyCodeLine{00361\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ restore\ col\_pattern:}}
\DoxyCodeLine{00362\ \ \ \ \ \ \ \ \ col\_pattern(col\_irow(cpt))\ =\ -\/1;}
\DoxyCodeLine{00363\ \ \ \ \ \ \ \ \ cpt++;}
\DoxyCodeLine{00364\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00365\ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ the\ first\ smallest\ row\ index\ and\ put\ it\ after\ the\ diagonal\ element}}
\DoxyCodeLine{00366\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ jk\ =\ colPtr(\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}})+1;}
\DoxyCodeLine{00367\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_afcdddb7639f27132c691ce7e79d11073}{updateList}}(colPtr,rowIdx,vals,\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}},jk,firstElt,listCol);}
\DoxyCodeLine{00368\ \ \ \ \ \}}
\DoxyCodeLine{00369\ }
\DoxyCodeLine{00370\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}==\mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}})}
\DoxyCodeLine{00371\ \ \ \ \ \{}
\DoxyCodeLine{00372\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_aab7215c08a43657abdaef848c3b90947}{m\_factorizationIsOk}}\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00373\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_abe5b6ad3c0a85dcd824a00697b490eac}{m\_info}}\ =\ \mbox{\hyperlink{group__enums_gga85fad7b87587764e5cf6b513a9e0ee5ea671a2aeb0f527802806a441d58a80fcf}{Success}};}
\DoxyCodeLine{00374\ \ \ \ \ \}}
\DoxyCodeLine{00375\ \ \ \}\ \textcolor{keywordflow}{while}(\mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_abe5b6ad3c0a85dcd824a00697b490eac}{m\_info}}!=\mbox{\hyperlink{group__enums_gga85fad7b87587764e5cf6b513a9e0ee5ea671a2aeb0f527802806a441d58a80fcf}{Success}});}
\DoxyCodeLine{00376\ \}}
\DoxyCodeLine{00377\ }
\DoxyCodeLine{00378\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ Scalar,\ \textcolor{keywordtype}{int}\ \_UpLo,\ \textcolor{keyword}{typename}\ OrderingType>}
\DoxyCodeLine{00379\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_afcdddb7639f27132c691ce7e79d11073}{IncompleteCholesky<Scalar,\_UpLo,\ OrderingType>::updateList}}(\mbox{\hyperlink{class_eigen_1_1_ref}{Ref<const\ VectorIx>}}\ colPtr,\ \mbox{\hyperlink{class_eigen_1_1_ref}{Ref<VectorIx>}}\ rowIdx,\ \mbox{\hyperlink{class_eigen_1_1_ref}{Ref<VectorSx>}}\ vals,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\&\ \mbox{\hyperlink{_matrix_base__col_8cpp_aa168d9544aa6d49fce0cbfc0bec849b0}{col}},\ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\&\ jk,\ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_a1c096f4e4f262a94148e697eaa7890d9}{VectorIx}}\&\ firstElt,\ \mbox{\hyperlink{class_eigen_1_1_incomplete_cholesky_aa758310799b31522f525e29cd8af7d46}{VectorList}}\&\ listCol)}
\DoxyCodeLine{00380\ \{}
\DoxyCodeLine{00381\ \ \ \textcolor{keywordflow}{if}\ (jk\ <\ colPtr(\mbox{\hyperlink{_matrix_base__col_8cpp_aa168d9544aa6d49fce0cbfc0bec849b0}{col}}+1)\ )}
\DoxyCodeLine{00382\ \ \ \{}
\DoxyCodeLine{00383\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ \mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}}\ =\ colPtr(\mbox{\hyperlink{_matrix_base__col_8cpp_aa168d9544aa6d49fce0cbfc0bec849b0}{col}}+1)\ -\/\ jk;}
\DoxyCodeLine{00384\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ minpos;\ }
\DoxyCodeLine{00385\ \ \ \ \ rowIdx.segment(jk,\mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}}).minCoeff(\&minpos);}
\DoxyCodeLine{00386\ \ \ \ \ minpos\ +=\ jk;}
\DoxyCodeLine{00387\ \ \ \ \ \textcolor{keywordflow}{if}\ (rowIdx(minpos)\ !=\ rowIdx(jk))}
\DoxyCodeLine{00388\ \ \ \ \ \{}
\DoxyCodeLine{00389\ \ \ \ \ \ \ \textcolor{comment}{//Swap}}
\DoxyCodeLine{00390\ \ \ \ \ \ \ \mbox{\hyperlink{namespacestd_a3acbe51b6415e9284430194bf04944e1}{std::swap}}(rowIdx(jk),rowIdx(minpos));}
\DoxyCodeLine{00391\ \ \ \ \ \ \ \mbox{\hyperlink{namespacestd_a3acbe51b6415e9284430194bf04944e1}{std::swap}}(vals(jk),vals(minpos));}
\DoxyCodeLine{00392\ \ \ \ \ \}}
\DoxyCodeLine{00393\ \ \ \ \ firstElt(\mbox{\hyperlink{_matrix_base__col_8cpp_aa168d9544aa6d49fce0cbfc0bec849b0}{col}})\ =\ \mbox{\hyperlink{namespace_eigen_1_1internal_a66f17ef65b1821965dcb8ad9a660b064}{internal::convert\_index<StorageIndex,Index>}}(jk);}
\DoxyCodeLine{00394\ \ \ \ \ listCol[rowIdx(jk)].push\_back(\mbox{\hyperlink{namespace_eigen_1_1internal_a66f17ef65b1821965dcb8ad9a660b064}{internal::convert\_index<StorageIndex,Index>}}(\mbox{\hyperlink{_matrix_base__col_8cpp_aa168d9544aa6d49fce0cbfc0bec849b0}{col}}));}
\DoxyCodeLine{00395\ \ \ \}}
\DoxyCodeLine{00396\ \}}
\DoxyCodeLine{00397\ }
\DoxyCodeLine{00398\ \}\ \textcolor{comment}{//\ end\ namespace\ Eigen\ }}
\DoxyCodeLine{00399\ }
\DoxyCodeLine{00400\ \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
