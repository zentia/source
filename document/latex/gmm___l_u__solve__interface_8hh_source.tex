\doxysection{gmm\+\_\+\+LU\+\_\+solve\+\_\+interface.\+hh}
\hypertarget{gmm___l_u__solve__interface_8hh_source}{}\label{gmm___l_u__solve__interface_8hh_source}\index{external/taskflow/3rd-\/party/eigen-\/3.3.7/bench/btl/libs/gmm/gmm\_LU\_solve\_interface.hh@{external/taskflow/3rd-\/party/eigen-\/3.3.7/bench/btl/libs/gmm/gmm\_LU\_solve\_interface.hh}}
\mbox{\hyperlink{gmm___l_u__solve__interface_8hh}{浏览该文件的文档.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//=====================================================}}
\DoxyCodeLine{00002\ \textcolor{comment}{//\ File\ \ \ :\ \ blitz\_LU\_solve\_interface.hh}}
\DoxyCodeLine{00003\ \textcolor{comment}{//\ Author\ :\ \ L.\ Plagne\ <laurent.plagne@edf.fr)>\ \ \ \ \ \ \ \ }}
\DoxyCodeLine{00004\ \textcolor{comment}{//\ Copyright\ (C)\ EDF\ R\&D,\ \ lun\ sep\ 30\ 14:23:31\ CEST\ 2002}}
\DoxyCodeLine{00005\ \textcolor{comment}{//=====================================================}}
\DoxyCodeLine{00006\ \textcolor{comment}{//\ }}
\DoxyCodeLine{00007\ \textcolor{comment}{//\ This\ program\ is\ free\ software;\ you\ can\ redistribute\ it\ and/or}}
\DoxyCodeLine{00008\ \textcolor{comment}{//\ modify\ it\ under\ the\ terms\ of\ the\ GNU\ General\ Public\ License}}
\DoxyCodeLine{00009\ \textcolor{comment}{//\ as\ published\ by\ the\ Free\ Software\ Foundation;\ either\ version\ 2}}
\DoxyCodeLine{00010\ \textcolor{comment}{//\ of\ the\ License,\ or\ (at\ your\ option)\ any\ later\ version.}}
\DoxyCodeLine{00011\ \textcolor{comment}{//\ }}
\DoxyCodeLine{00012\ \textcolor{comment}{//\ This\ program\ is\ distributed\ in\ the\ hope\ that\ it\ will\ be\ useful,}}
\DoxyCodeLine{00013\ \textcolor{comment}{//\ but\ WITHOUT\ ANY\ WARRANTY;\ without\ even\ the\ implied\ warranty\ of}}
\DoxyCodeLine{00014\ \textcolor{comment}{//\ MERCHANTABILITY\ or\ FITNESS\ FOR\ A\ PARTICULAR\ PURPOSE.\ \ See\ the}}
\DoxyCodeLine{00015\ \textcolor{comment}{//\ GNU\ General\ Public\ License\ for\ more\ details.}}
\DoxyCodeLine{00016\ \textcolor{comment}{//\ You\ should\ have\ received\ a\ copy\ of\ the\ GNU\ General\ Public\ License}}
\DoxyCodeLine{00017\ \textcolor{comment}{//\ along\ with\ this\ program;\ if\ not,\ write\ to\ the\ Free\ Software}}
\DoxyCodeLine{00018\ \textcolor{comment}{//\ Foundation,\ Inc.,\ 59\ Temple\ Place\ -\/\ Suite\ 330,\ Boston,\ MA\ \ 02111-\/1307,\ USA.}}
\DoxyCodeLine{00019\ \textcolor{comment}{//\ }}
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#ifndef\ BLITZ\_LU\_SOLVE\_INTERFACE\_HH}}
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#define\ BLITZ\_LU\_SOLVE\_INTERFACE\_HH}}
\DoxyCodeLine{00022\ }
\DoxyCodeLine{00023\ \textcolor{preprocessor}{\#include\ "{}blitz/array.h"{}}}
\DoxyCodeLine{00024\ \textcolor{preprocessor}{\#include\ <vector>}}
\DoxyCodeLine{00025\ }
\DoxyCodeLine{00026\ BZ\_USING\_NAMESPACE(blitz)}
\DoxyCodeLine{00027\ }
\DoxyCodeLine{00028\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ real>}
\DoxyCodeLine{00029\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classblitz___l_u__solve__interface}{blitz\_LU\_solve\_interface}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{classblitz__interface}{blitz\_interface}}<real>}
\DoxyCodeLine{00030\ \{}
\DoxyCodeLine{00031\ }
\DoxyCodeLine{00032\ public\ :}
\DoxyCodeLine{00033\ }
\DoxyCodeLine{00034\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{classblitz__interface_aa24290043187ce20da802ad0f225b3f6}{blitz\_interface<real>::gene\_matrix}}\ \mbox{\hyperlink{classblitz___l_u__solve__interface_a9cca961da94b2f5ab7c4153d90e6ed00}{gene\_matrix}};}
\DoxyCodeLine{00035\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{classblitz__interface_ad808bd31468f44d2ef93007ff178274c}{blitz\_interface<real>::gene\_vector}}\ \mbox{\hyperlink{classblitz___l_u__solve__interface_ac862c1169c7df1756379a78763594345}{gene\_vector}};}
\DoxyCodeLine{00036\ }
\DoxyCodeLine{00037\ \ \ \textcolor{keyword}{typedef}\ blitz::Array<int,1>\ \mbox{\hyperlink{classblitz___l_u__solve__interface_a29fb02ff26df347be16bda17d851b47f}{Pivot\_Vector}};}
\DoxyCodeLine{00038\ }
\DoxyCodeLine{00039\ \ \ \textcolor{keyword}{inline}\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classblitz___l_u__solve__interface_adafba612b512655463cd9d1fa7239d8c}{new\_Pivot\_Vector}}(\mbox{\hyperlink{classblitz___l_u__solve__interface_a29fb02ff26df347be16bda17d851b47f}{Pivot\_Vector}}\ \&\ pivot,\textcolor{keywordtype}{int}\ \mbox{\hyperlink{main-override-static_8c_a0240ac851181b84ac374872dc5434ee4}{N}})}
\DoxyCodeLine{00040\ \ \ \{}
\DoxyCodeLine{00041\ }
\DoxyCodeLine{00042\ \ \ \ \ pivot.resize(\mbox{\hyperlink{main-override-static_8c_a0240ac851181b84ac374872dc5434ee4}{N}});}
\DoxyCodeLine{00043\ }
\DoxyCodeLine{00044\ \ \ \}}
\DoxyCodeLine{00045\ }
\DoxyCodeLine{00046\ \ \ \textcolor{keyword}{inline}\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classblitz___l_u__solve__interface_ae58840dbbcb44f84500e26d0a212b219}{free\_Pivot\_Vector}}(\mbox{\hyperlink{classblitz___l_u__solve__interface_a29fb02ff26df347be16bda17d851b47f}{Pivot\_Vector}}\ \&\ pivot)}
\DoxyCodeLine{00047\ \ \ \{}
\DoxyCodeLine{00048\ \ \ \ \ }
\DoxyCodeLine{00049\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00050\ }
\DoxyCodeLine{00051\ \ \ \}}
\DoxyCodeLine{00052\ }
\DoxyCodeLine{00053\ }
\DoxyCodeLine{00054\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \mbox{\hyperlink{datatypes_8h_a1bb7bda9eb99a2427c358ecb686be221}{real}}\ \mbox{\hyperlink{classblitz___l_u__solve__interface_a9ffd8f9541d9559c4b0f6d0532587e76}{matrix\_vector\_product\_sliced}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classblitz___l_u__solve__interface_a9cca961da94b2f5ab7c4153d90e6ed00}{gene\_matrix}}\ \&\ \mbox{\hyperlink{bench__gemm_8cpp_addc86e8508f14411ec98f521c520f875}{A}},\ \mbox{\hyperlink{classblitz___l_u__solve__interface_ac862c1169c7df1756379a78763594345}{gene\_vector}}\ \mbox{\hyperlink{bench__gemm_8cpp_a37a83060ac796961b44991c836f083f7}{B}},\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{_matrix_base__row_8cpp_a64ef8efef59f875033a27e7cbbc879ec}{row}},\ \textcolor{keywordtype}{int}\ col\_start,\ \textcolor{keywordtype}{int}\ col\_end)}
\DoxyCodeLine{00055\ \ \ \{}
\DoxyCodeLine{00056\ \ \ \ \ }
\DoxyCodeLine{00057\ \ \ \ \ \mbox{\hyperlink{datatypes_8h_a1bb7bda9eb99a2427c358ecb686be221}{real}}\ somme=0.;}
\DoxyCodeLine{00058\ \ \ \ \ }
\DoxyCodeLine{00059\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}=col\_start\ ;\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}<col\_end+1\ ;\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}++)\{}
\DoxyCodeLine{00060\ \ \ \ \ }
\DoxyCodeLine{00061\ \ \ \ \ somme+=\mbox{\hyperlink{bench__gemm_8cpp_addc86e8508f14411ec98f521c520f875}{A}}(\mbox{\hyperlink{_matrix_base__row_8cpp_a64ef8efef59f875033a27e7cbbc879ec}{row}},\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}})*\mbox{\hyperlink{bench__gemm_8cpp_a37a83060ac796961b44991c836f083f7}{B}}(\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}});}
\DoxyCodeLine{00062\ \ \ \ \ }
\DoxyCodeLine{00063\ \ \ \ \ \}}
\DoxyCodeLine{00064\ }
\DoxyCodeLine{00065\ \ \ \ \ \textcolor{keywordflow}{return}\ somme;}
\DoxyCodeLine{00066\ }
\DoxyCodeLine{00067\ \ \ \}}
\DoxyCodeLine{00068\ }
\DoxyCodeLine{00069\ }
\DoxyCodeLine{00070\ }
\DoxyCodeLine{00071\ }
\DoxyCodeLine{00072\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \mbox{\hyperlink{datatypes_8h_a1bb7bda9eb99a2427c358ecb686be221}{real}}\ \mbox{\hyperlink{classblitz___l_u__solve__interface_afebfcffc1b05ad809cc704a0aa54a26e}{matrix\_matrix\_product\_sliced}}(\mbox{\hyperlink{classblitz___l_u__solve__interface_a9cca961da94b2f5ab7c4153d90e6ed00}{gene\_matrix}}\ \&\ \mbox{\hyperlink{bench__gemm_8cpp_addc86e8508f14411ec98f521c520f875}{A}},\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{_matrix_base__row_8cpp_a64ef8efef59f875033a27e7cbbc879ec}{row}},\ \textcolor{keywordtype}{int}\ col\_start,\ \textcolor{keywordtype}{int}\ col\_end,\ \mbox{\hyperlink{classblitz___l_u__solve__interface_a9cca961da94b2f5ab7c4153d90e6ed00}{gene\_matrix}}\ \&\ \mbox{\hyperlink{bench__gemm_8cpp_a37a83060ac796961b44991c836f083f7}{B}},\ \textcolor{keywordtype}{int}\ row\_shift,\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{_matrix_base__col_8cpp_aa168d9544aa6d49fce0cbfc0bec849b0}{col}}\ )}
\DoxyCodeLine{00073\ \ \ \{}
\DoxyCodeLine{00074\ \ \ \ \ }
\DoxyCodeLine{00075\ \ \ \ \ \mbox{\hyperlink{datatypes_8h_a1bb7bda9eb99a2427c358ecb686be221}{real}}\ somme=0.;}
\DoxyCodeLine{00076\ \ \ \ \ }
\DoxyCodeLine{00077\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}=col\_start\ ;\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}<col\_end+1\ ;\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}++)\{}
\DoxyCodeLine{00078\ \ \ \ \ }
\DoxyCodeLine{00079\ \ \ \ \ somme+=\mbox{\hyperlink{bench__gemm_8cpp_addc86e8508f14411ec98f521c520f875}{A}}(\mbox{\hyperlink{_matrix_base__row_8cpp_a64ef8efef59f875033a27e7cbbc879ec}{row}},\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}})*\mbox{\hyperlink{bench__gemm_8cpp_a37a83060ac796961b44991c836f083f7}{B}}(\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}+row\_shift,\mbox{\hyperlink{_matrix_base__col_8cpp_aa168d9544aa6d49fce0cbfc0bec849b0}{col}});}
\DoxyCodeLine{00080\ \ \ \ \ }
\DoxyCodeLine{00081\ \ \ \ \ \}}
\DoxyCodeLine{00082\ }
\DoxyCodeLine{00083\ \ \ \ \ \textcolor{keywordflow}{return}\ somme;}
\DoxyCodeLine{00084\ }
\DoxyCodeLine{00085\ \ \ \}}
\DoxyCodeLine{00086\ }
\DoxyCodeLine{00087\ \ \ \textcolor{keyword}{inline}\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classblitz___l_u__solve__interface_a35ac67142990402c20597bf9a8d8d9b9}{LU\_factor}}(\mbox{\hyperlink{classblitz___l_u__solve__interface_a9cca961da94b2f5ab7c4153d90e6ed00}{gene\_matrix}}\ \&\ LU,\ \mbox{\hyperlink{classblitz___l_u__solve__interface_a29fb02ff26df347be16bda17d851b47f}{Pivot\_Vector}}\ \&\ pivot,\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{main-override-static_8c_a0240ac851181b84ac374872dc5434ee4}{N}})}
\DoxyCodeLine{00088\ \ \ \{}
\DoxyCodeLine{00089\ }
\DoxyCodeLine{00090\ \ \ \ \ \mbox{\hyperlink{_mini_cpp_unit_8hxx_a092bd7bb2cb7fd9f483b6995cee61bc0}{ASSERT}}(\ LU.rows()==LU.cols()\ )\ ;}
\DoxyCodeLine{00091\ \ \ \ \ \textcolor{keywordtype}{int}\ index\_max\ =\ 0\ ;}
\DoxyCodeLine{00092\ \ \ \ \ \mbox{\hyperlink{datatypes_8h_a1bb7bda9eb99a2427c358ecb686be221}{real}}\ big\ =\ 0.\ ;}
\DoxyCodeLine{00093\ \ \ \ \ \mbox{\hyperlink{datatypes_8h_a1bb7bda9eb99a2427c358ecb686be221}{real}}\ theSum\ =\ 0.\ ;}
\DoxyCodeLine{00094\ \ \ \ \ \mbox{\hyperlink{datatypes_8h_a1bb7bda9eb99a2427c358ecb686be221}{real}}\ dum\ =\ 0.\ ;}
\DoxyCodeLine{00095\ \ \ \ \ \textcolor{comment}{//\ Get\ the\ implicit\ scaling\ information\ :}}
\DoxyCodeLine{00096\ \ \ \ \ \mbox{\hyperlink{classblitz___l_u__solve__interface_ac862c1169c7df1756379a78763594345}{gene\_vector}}\ ImplicitScaling(\ \mbox{\hyperlink{main-override-static_8c_a0240ac851181b84ac374872dc5434ee4}{N}}\ )\ ;}
\DoxyCodeLine{00097\ \ \ \ \ \textcolor{keywordflow}{for}(\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}=0;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}<\mbox{\hyperlink{main-override-static_8c_a0240ac851181b84ac374872dc5434ee4}{N}};\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}++\ )\ \{}
\DoxyCodeLine{00098\ \ \ \ \ \ \ big\ =\ 0.\ ;}
\DoxyCodeLine{00099\ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}=0;\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}<\mbox{\hyperlink{main-override-static_8c_a0240ac851181b84ac374872dc5434ee4}{N}};\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}++\ )\ \{}
\DoxyCodeLine{00100\ \ \ \ \ \textcolor{keywordflow}{if}(\ \mbox{\hyperlink{datatypes_8h_a3aa069ac3980707dae1e0530f50d59e4}{abs}}(\ LU(\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}},\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}\ )\ )>=big\ )\ big\ =\ \mbox{\hyperlink{datatypes_8h_a3aa069ac3980707dae1e0530f50d59e4}{abs}}(\ LU(\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}},\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}\ )\ )\ ;}
\DoxyCodeLine{00101\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00102\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ big==0.\ )\ \{}
\DoxyCodeLine{00103\ \ \ \ \ \mbox{\hyperlink{utilities_8h_a3f81b03f302e8c8bbbe04c578fecb78f}{INFOS}}(\ \textcolor{stringliteral}{"{}blitz\_LU\_factor::Singular\ matrix"{}}\ )\ ;}
\DoxyCodeLine{00104\ \ \ \ \ exit(\ 0\ )\ ;}
\DoxyCodeLine{00105\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00106\ \ \ \ \ \ \ ImplicitScaling(\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ )\ =\ 1./big\ ;}
\DoxyCodeLine{00107\ \ \ \ \ \}}
\DoxyCodeLine{00108\ \ \ \ \ \textcolor{comment}{//\ Loop\ over\ columns\ of\ Crout's\ method\ :}}
\DoxyCodeLine{00109\ \ \ \ \ \textcolor{keywordflow}{for}(\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}=0;\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}<\mbox{\hyperlink{main-override-static_8c_a0240ac851181b84ac374872dc5434ee4}{N}};\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}++\ )\ \{}
\DoxyCodeLine{00110\ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}=0;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}<\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}};\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}++\ )\ \{}
\DoxyCodeLine{00111\ \ \ \ \ theSum\ =\ LU(\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}},\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}\ )\ ;}
\DoxyCodeLine{00112\ \ \ \ \ theSum\ -\/=\ \mbox{\hyperlink{classblitz___l_u__solve__interface_afebfcffc1b05ad809cc704a0aa54a26e}{matrix\_matrix\_product\_sliced}}(LU,\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}},\ 0,\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}-\/1,\ LU,\ 0,\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}})\ ;}
\DoxyCodeLine{00113\ \ \ \ \ \textcolor{comment}{//\ \ theSum\ -\/=\ sum(\ LU(\ i,\ Range(\ fromStart,\ i-\/1\ )\ )*LU(\ Range(\ fromStart,\ i-\/1\ ),\ j\ )\ )\ ;}}
\DoxyCodeLine{00114\ \ \ \ \ LU(\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}},\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}\ )\ =\ theSum\ ;}
\DoxyCodeLine{00115\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00116\ \ \ \ \ \ \ }
\DoxyCodeLine{00117\ \ \ \ \ \ \ \textcolor{comment}{//\ Search\ for\ the\ largest\ pivot\ element\ :}}
\DoxyCodeLine{00118\ \ \ \ \ \ \ big\ =\ 0.\ ;}
\DoxyCodeLine{00119\ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}=\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}};\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}<\mbox{\hyperlink{main-override-static_8c_a0240ac851181b84ac374872dc5434ee4}{N}};\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}++\ )\ \{}
\DoxyCodeLine{00120\ \ \ \ \ theSum\ =\ LU(\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}},\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}\ )\ ;}
\DoxyCodeLine{00121\ \ \ \ \ theSum\ -\/=\ \mbox{\hyperlink{classblitz___l_u__solve__interface_afebfcffc1b05ad809cc704a0aa54a26e}{matrix\_matrix\_product\_sliced}}(LU,\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}},\ 0,\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}-\/1,\ LU,\ 0,\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}})\ ;}
\DoxyCodeLine{00122\ \ \ \ \ \textcolor{comment}{//\ \ theSum\ -\/=\ sum(\ LU(\ i,\ Range(\ fromStart,\ j-\/1\ )\ )*LU(\ Range(\ fromStart,\ j-\/1\ ),\ j\ )\ )\ ;}}
\DoxyCodeLine{00123\ \ \ \ \ LU(\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}},\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}\ )\ =\ theSum\ ;}
\DoxyCodeLine{00124\ \ \ \ \ \textcolor{keywordflow}{if}(\ (ImplicitScaling(\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ )*\mbox{\hyperlink{datatypes_8h_a3aa069ac3980707dae1e0530f50d59e4}{abs}}(\ theSum\ ))>=big\ )\ \{}
\DoxyCodeLine{00125\ \ \ \ \ \ \ dum\ =\ ImplicitScaling(\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ )*\mbox{\hyperlink{datatypes_8h_a3aa069ac3980707dae1e0530f50d59e4}{abs}}(\ theSum\ )\ ;}
\DoxyCodeLine{00126\ \ \ \ \ \ \ big\ =\ dum\ ;}
\DoxyCodeLine{00127\ \ \ \ \ \ \ index\_max\ =\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ ;}
\DoxyCodeLine{00128\ \ \ \ \ \}}
\DoxyCodeLine{00129\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00130\ \ \ \ \ \ \ \textcolor{comment}{//\ Interchanging\ rows\ and\ the\ scale\ factor\ :}}
\DoxyCodeLine{00131\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}!=index\_max\ )\ \{}
\DoxyCodeLine{00132\ \ \ \ \ \textcolor{keywordflow}{for}(\ \textcolor{keywordtype}{int}\ k=0;\ k<\mbox{\hyperlink{main-override-static_8c_a0240ac851181b84ac374872dc5434ee4}{N}};\ k++\ )\ \{}
\DoxyCodeLine{00133\ \ \ \ \ \ \ dum\ =\ LU(\ index\_max,\ k\ )\ ;}
\DoxyCodeLine{00134\ \ \ \ \ \ \ LU(\ index\_max,\ k\ )\ =\ LU(\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}},\ k\ )\ ;}
\DoxyCodeLine{00135\ \ \ \ \ \ \ LU(\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}},\ k\ )\ =\ dum\ ;}
\DoxyCodeLine{00136\ \ \ \ \ \}}
\DoxyCodeLine{00137\ \ \ \ \ ImplicitScaling(\ index\_max\ )\ =\ ImplicitScaling(\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}\ )\ ;}
\DoxyCodeLine{00138\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00139\ \ \ \ \ \ \ pivot(\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}\ )\ =\ index\_max\ ;}
\DoxyCodeLine{00140\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\ LU(\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}},\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}\ )==0.\ )\ LU(\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}},\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}\ )\ =\ 1.e-\/20\ ;}
\DoxyCodeLine{00141\ \ \ \ \ \ \ \textcolor{comment}{//\ Divide\ by\ the\ pivot\ element\ :}}
\DoxyCodeLine{00142\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}<\mbox{\hyperlink{main-override-static_8c_a0240ac851181b84ac374872dc5434ee4}{N}}\ )\ \{}
\DoxyCodeLine{00143\ \ \ \ \ dum\ =\ 1./LU(\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}},\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}\ )\ ;}
\DoxyCodeLine{00144\ \ \ \ \ \textcolor{keywordflow}{for}(\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}=\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}+1;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}<\mbox{\hyperlink{main-override-static_8c_a0240ac851181b84ac374872dc5434ee4}{N}};\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}++\ )\ LU(\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}},\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}\ )\ *=\ dum\ ;}
\DoxyCodeLine{00145\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00146\ \ \ \ \ \}}
\DoxyCodeLine{00147\ }
\DoxyCodeLine{00148\ \ \ \}}
\DoxyCodeLine{00149\ }
\DoxyCodeLine{00150\ \ \ \textcolor{keyword}{inline}\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classblitz___l_u__solve__interface_acb9e0965fe92bb88c1b6d4e2a78906be}{LU\_solve}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classblitz___l_u__solve__interface_a9cca961da94b2f5ab7c4153d90e6ed00}{gene\_matrix}}\ \&\ LU,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classblitz___l_u__solve__interface_a29fb02ff26df347be16bda17d851b47f}{Pivot\_Vector}}\ pivot,\ \mbox{\hyperlink{classblitz___l_u__solve__interface_ac862c1169c7df1756379a78763594345}{gene\_vector}}\ \&\mbox{\hyperlink{bench__gemm_8cpp_a37a83060ac796961b44991c836f083f7}{B}},\ \mbox{\hyperlink{classblitz___l_u__solve__interface_ac862c1169c7df1756379a78763594345}{gene\_vector}}\ \mbox{\hyperlink{icosphere_8cpp_a207fd5507206d307cd63f95374fcd00d}{X}},\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{main-override-static_8c_a0240ac851181b84ac374872dc5434ee4}{N}})}
\DoxyCodeLine{00151\ \ \ \{}
\DoxyCodeLine{00152\ }
\DoxyCodeLine{00153\ \ \ \ \ \textcolor{comment}{//\ Pour\ conserver\ le\ meme\ header,\ on\ travaille\ sur\ X,\ copie\ du\ second-\/membre\ B}}
\DoxyCodeLine{00154\ \ \ \ \ \mbox{\hyperlink{icosphere_8cpp_a207fd5507206d307cd63f95374fcd00d}{X}}\ =\ \mbox{\hyperlink{bench__gemm_8cpp_a37a83060ac796961b44991c836f083f7}{B}}.copy()\ ;}
\DoxyCodeLine{00155\ \ \ \ \ \mbox{\hyperlink{_mini_cpp_unit_8hxx_a092bd7bb2cb7fd9f483b6995cee61bc0}{ASSERT}}(\ LU.rows()==LU.cols()\ )\ ;}
\DoxyCodeLine{00156\ \ \ \ \ firstIndex\ indI\ ;}
\DoxyCodeLine{00157\ \ \ \ \ \textcolor{comment}{//\ Forward\ substitution\ :}}
\DoxyCodeLine{00158\ \ \ \ \ \textcolor{keywordtype}{int}\ ii\ =\ 0\ ;}
\DoxyCodeLine{00159\ \ \ \ \ \mbox{\hyperlink{datatypes_8h_a1bb7bda9eb99a2427c358ecb686be221}{real}}\ theSum\ =\ 0.\ ;}
\DoxyCodeLine{00160\ \ \ \ \ \textcolor{keywordflow}{for}(\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}=0;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}<\mbox{\hyperlink{main-override-static_8c_a0240ac851181b84ac374872dc5434ee4}{N}};\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}++\ )\ \{}
\DoxyCodeLine{00161\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ ip\ =\ pivot(\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ )\ ;}
\DoxyCodeLine{00162\ \ \ \ \ \ \ theSum\ =\ \mbox{\hyperlink{icosphere_8cpp_a207fd5507206d307cd63f95374fcd00d}{X}}(\ ip\ )\ ;}
\DoxyCodeLine{00163\ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ theSum\ =\ B(\ ip\ )\ ;}}
\DoxyCodeLine{00164\ \ \ \ \ \ \ \mbox{\hyperlink{icosphere_8cpp_a207fd5507206d307cd63f95374fcd00d}{X}}(\ ip\ )\ =\ \mbox{\hyperlink{icosphere_8cpp_a207fd5507206d307cd63f95374fcd00d}{X}}(\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ )\ ;}
\DoxyCodeLine{00165\ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ B(\ ip\ )\ =\ B(\ i\ )\ ;}}
\DoxyCodeLine{00166\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ ii\ )\ \{}
\DoxyCodeLine{00167\ \ \ \ \ theSum\ -\/=\ \mbox{\hyperlink{classblitz___l_u__solve__interface_a9ffd8f9541d9559c4b0f6d0532587e76}{matrix\_vector\_product\_sliced}}(LU,\ \mbox{\hyperlink{icosphere_8cpp_a207fd5507206d307cd63f95374fcd00d}{X}},\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}},\ ii-\/1,\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}-\/1)\ ;}
\DoxyCodeLine{00168\ \ \ \ \ \textcolor{comment}{//\ \ theSum\ -\/=\ sum(\ LU(\ i,\ Range(\ ii-\/1,\ i-\/1\ )\ )*X(\ Range(\ ii-\/1,\ i-\/1\ )\ )\ )\ ;}}
\DoxyCodeLine{00169\ \ \ \ \ \textcolor{comment}{//\ \ theSum\ -\/=\ sum(\ LU(\ i,\ Range(\ ii-\/1,\ i-\/1\ )\ )*B(\ Range(\ ii-\/1,\ i-\/1\ )\ )\ )\ ;}}
\DoxyCodeLine{00170\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(\ theSum\ )\ \{}
\DoxyCodeLine{00171\ \ \ \ \ ii\ =\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}+1\ ;}
\DoxyCodeLine{00172\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00173\ \ \ \ \ \ \ \mbox{\hyperlink{icosphere_8cpp_a207fd5507206d307cd63f95374fcd00d}{X}}(\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ )\ =\ theSum\ ;}
\DoxyCodeLine{00174\ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ B(\ i\ )\ =\ theSum\ ;}}
\DoxyCodeLine{00175\ \ \ \ \ \}}
\DoxyCodeLine{00176\ \ \ \ \ \textcolor{comment}{//\ Backsubstitution\ :}}
\DoxyCodeLine{00177\ \ \ \ \ \textcolor{keywordflow}{for}(\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}=\mbox{\hyperlink{main-override-static_8c_a0240ac851181b84ac374872dc5434ee4}{N}}-\/1;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}>=0;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}-\/-\/\ )\ \{}
\DoxyCodeLine{00178\ \ \ \ \ \ \ theSum\ =\ \mbox{\hyperlink{icosphere_8cpp_a207fd5507206d307cd63f95374fcd00d}{X}}(\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ )\ ;}
\DoxyCodeLine{00179\ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ theSum\ =\ B(\ i\ )\ ;}}
\DoxyCodeLine{00180\ \ \ \ \ \ \ theSum\ -\/=\ \mbox{\hyperlink{classblitz___l_u__solve__interface_a9ffd8f9541d9559c4b0f6d0532587e76}{matrix\_vector\_product\_sliced}}(LU,\ \mbox{\hyperlink{icosphere_8cpp_a207fd5507206d307cd63f95374fcd00d}{X}},\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}},\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}+1,\ \mbox{\hyperlink{main-override-static_8c_a0240ac851181b84ac374872dc5434ee4}{N}})\ ;}
\DoxyCodeLine{00181\ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ theSum\ -\/=\ sum(\ LU(\ i,\ Range(\ i+1,\ toEnd\ )\ )*X(\ Range(\ i+1,\ toEnd\ )\ )\ )\ ;}}
\DoxyCodeLine{00182\ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ theSum\ -\/=\ sum(\ LU(\ i,\ Range(\ i+1,\ toEnd\ )\ )*B(\ Range(\ i+1,\ toEnd\ )\ )\ )\ ;}}
\DoxyCodeLine{00183\ \ \ \ \ \ \ \textcolor{comment}{//\ Store\ a\ component\ of\ the\ solution\ vector\ :}}
\DoxyCodeLine{00184\ \ \ \ \ \ \ \mbox{\hyperlink{icosphere_8cpp_a207fd5507206d307cd63f95374fcd00d}{X}}(\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ )\ =\ theSum/LU(\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}},\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ )\ ;}
\DoxyCodeLine{00185\ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ B(\ i\ )\ =\ theSum/LU(\ i,\ i\ )\ ;}}
\DoxyCodeLine{00186\ \ \ \ \ \}}
\DoxyCodeLine{00187\ }
\DoxyCodeLine{00188\ \ \ \}}
\DoxyCodeLine{00189\ }
\DoxyCodeLine{00190\ \};}
\DoxyCodeLine{00191\ }
\DoxyCodeLine{00192\ \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
