\doxysection{external/libcds/build/cmake 目录参考}
\hypertarget{dir_d64cb4102407340268cc83100b37d7e9}{}\label{dir_d64cb4102407340268cc83100b37d7e9}\index{external/libcds/build/cmake 目录参考@{external/libcds/build/cmake 目录参考}}
cmake 的目录依赖关系图
% FIG 0


\doxysubsection{详细描述}
CDS suports both in-\/source and out-\/of-\/source cmake build types. Now project uses\+:


\begin{DoxyItemize}
\item CMake\+: general cross-\/platform building
\item CTest\+: all unit tests can be run in a standard way by {\itshape ctest} command
\item CPack\+: for making rpm/deb/nsys etc. packages
\end{DoxyItemize}\hypertarget{readme.md_autotoc_md466}{}\doxysubsection{\texorpdfstring{Compiling and testing}{Compiling and testing}}\label{readme.md_autotoc_md466}
{\bfseries{Building out-\/of-\/source in "{}\+RELEASE"{} mode ("{}\+DEBUG"{} is default)}}


\begin{DoxyItemize}
\item Wherever create empty directory for building, for instance {\ttfamily libcds-\/debug}
\item Prepare\+: {\ttfamily cmake -\/DCMAKE\+\_\+\+BUILD\+\_\+\+TYPE=RELEASE \texorpdfstring{$<$}{<}path to the project\textquotesingle{}s root directory with CMake\+Lists.\+txt\texorpdfstring{$>$}{>}}
\item Compile\+: {\ttfamily make -\/j4}
\item As a result you\textquotesingle{}ll see shared and static cds libraries in the build directory
\end{DoxyItemize}

{\bfseries{Warning}}\+: We strongly recommend not to use static cds library. \doxylink{class_static}{Static} library is not tested and not maintained. You can use it on own risk.

After using command cmake -\/L \texorpdfstring{$<$}{<}path to the project\textquotesingle{}s root directory with CMake\+Lists.\+txt\texorpdfstring{$>$}{>} one can see some additional variables, that can activate additional features\+:


\begin{DoxyItemize}
\item {\ttfamily LIBCDS\+\_\+\+WITH\+\_\+\+TESTS\+:BOOL=OFF}\+: if you want to build library with unit testing support use {\itshape -\/DLIBCDS\+\_\+\+WITH\+\_\+\+TESTS=ON} on prepare step. Be careful with this flag, because compile time will dramatically increase
\item {\ttfamily LIBCDS\+\_\+\+WITH\+\_\+\+TESTS\+\_\+\+COVERAGE\+:BOOL=OFF}\+: Analyze test coverage using gcov (only for gcc)
\item {\ttfamily LIBCDS\+\_\+\+WITH\+\_\+\+BOOST\+\_\+\+ATOMIC\+:BOOL=OFF}\+: Use boost atomics (only for boost \texorpdfstring{$>$}{>}= 1.\+54)
\item {\ttfamily LIBCDS\+\_\+\+WITH\+\_\+\+ASAN\+:BOOL=OFF}\+: compile libcds with Address\+Sanitizer instrumentation
\item {\ttfamily LIBCDS\+\_\+\+WITH\+\_\+\+TSAN\+:BOOL=OFF}\+: compile libcds with Thread\+Sanitizer instrumentation
\end{DoxyItemize}

Additional gtest hints (for unit and stress tests only)\+:
\begin{DoxyItemize}
\item {\ttfamily GTEST\+\_\+\+INCLUDE\+\_\+\+DIRS=path}\+: gives full {\ttfamily path} to gtest include dir.
\item {\ttfamily GTEST\+\_\+\+LIBRARY=path}\+: gives full {\ttfamily path} to {\ttfamily libgtest.\+a}.
\end{DoxyItemize}\hypertarget{readme.md_autotoc_md467}{}\doxysubsection{\texorpdfstring{Packaging}{Packaging}}\label{readme.md_autotoc_md467}
In order to package library {\itshape CPack} is used, command {\itshape cpack -\/\doxylink{struct_g}{G} $<$\+Generator$>$} should create correspondent packages for particular operating system. Now the project supports building the following package types\+:


\begin{DoxyItemize}
\item {\itshape RPM}\+: redhat-\/based linux distribs ~\newline

\item {\itshape DEB}\+: debian-\/based linux distribs
\item {\itshape TGZ}\+: simple "{}\texorpdfstring{$\ast$}{*}tgz\texorpdfstring{$\ast$}{*}"{} archive with library and headers
\item {\itshape NSYS}\+: windows installer package (NSYS should be installed) ~\newline

\end{DoxyItemize}\hypertarget{readme.md_autotoc_md468}{}\doxysubsection{\texorpdfstring{"{}\+Live"{} building and packaging example}{"{}\+Live"{} building and packaging example}}\label{readme.md_autotoc_md468}

\begin{DoxyItemize}
\item {\ttfamily git clone \href{https://github.com/khizmax/libcds.git}{\texttt{ https\+://github.\+com/khizmax/libcds.\+git}}}
\item {\ttfamily mkdir libcds-\/release}
\item {\ttfamily cd libcds-\/release}
\item {\ttfamily cmake -\/DLIBCDS\+\_\+\+WITH\+\_\+\+TESTS=ON -\/DCMAKE\+\_\+\+BUILD\+\_\+\+TYPE=RELEASE ../libcds} 
\begin{DoxyCode}{0}
\DoxyCodeLine{-\/-\/\ The\ C\ compiler\ identification\ is\ GNU\ 4.8.3}
\DoxyCodeLine{-\/-\/\ The\ CXX\ compiler\ identification\ is\ GNU\ 4.8.3}
\DoxyCodeLine{...}
\DoxyCodeLine{-\/-\/\ Found\ Threads:\ TRUE}
\DoxyCodeLine{-\/-\/\ Boost\ version:\ 1.54.0}
\DoxyCodeLine{-\/-\/\ Found\ the\ following\ Boost\ libraries:}
\DoxyCodeLine{-\/-\/\ \ \ system}
\DoxyCodeLine{-\/-\/\ \ \ thread}
\DoxyCodeLine{Build\ type\ -\/-\/\ RELEASE}
\DoxyCodeLine{-\/-\/\ Configuring\ done}
\DoxyCodeLine{-\/-\/\ Generating\ done}
\DoxyCodeLine{-\/-\/\ Build\ files\ have\ been\ written\ to:\ <...>/libcds-\/release}

\end{DoxyCode}

\item {\ttfamily make -\/j4} 
\begin{DoxyCode}{0}
\DoxyCodeLine{Scanning\ dependencies\ of\ target\ cds}
\DoxyCodeLine{Scanning\ dependencies\ of\ target\ test-\/common}
\DoxyCodeLine{Scanning\ dependencies\ of\ target\ cds-\/s}
\DoxyCodeLine{Scanning\ dependencies\ of\ target\ test-\/hdr-\/offsetof}
\DoxyCodeLine{[\ \ 1\%]\ Building\ CXX\ object\ CMakeFiles/cds-\/s.dir/src/hp\_gc.cpp.o}
\DoxyCodeLine{...}
\DoxyCodeLine{[100\%]\ Built\ target\ test-\/hdr}

\end{DoxyCode}

\item {\ttfamily ctest} 
\begin{DoxyCode}{0}
\DoxyCodeLine{Test\ project\ /home/kel/projects\_cds/libcds-\/debug}
\DoxyCodeLine{\ \ \ \ Start\ 1:\ test-\/hdr}
\DoxyCodeLine{1/7\ Test\ \#1:\ test-\/hdr\ .........................\ \ \ Passed\ \ 1352.24\ sec}
\DoxyCodeLine{\ \ \ \ Start\ 2:\ cdsu-\/misc}
\DoxyCodeLine{2/7\ Test\ \#2:\ cdsu-\/misc\ ........................\ \ \ Passed\ \ \ \ 0.00\ sec}
\DoxyCodeLine{\ \ \ \ Start\ 3:\ cdsu-\/map}
\DoxyCodeLine{...}

\end{DoxyCode}

\item {\ttfamily cpack -\/\doxylink{struct_g}{G} RPM} 
\begin{DoxyCode}{0}
\DoxyCodeLine{CPack:\ Create\ package\ using\ RPM}
\DoxyCodeLine{CPack:\ Install\ projects}
\DoxyCodeLine{CPack:\ -\/\ Run\ preinstall\ target\ for:\ cds}
\DoxyCodeLine{CPack:\ -\/\ Install\ project:\ cds}
\DoxyCodeLine{CPack:\ -\/\ \ \ Install\ component:\ devel}
\DoxyCodeLine{CPack:\ -\/\ \ \ Install\ component:\ lib}
\DoxyCodeLine{CPack:\ Create\ package}
\DoxyCodeLine{CPackRPM:Debug:\ Adding\ /usr/local\ to\ builtin\ omit\ list.}
\DoxyCodeLine{CPackRPM:\ Will\ use\ GENERATED\ spec\ file:\ /home/kel/projects\_cds/libcds-\/debug/\_CPack\_Packages/Linux/RPM/SPECS/cds-\/devel.spec}
\DoxyCodeLine{CPackRPM:\ Will\ use\ GENERATED\ spec\ file:\ /home/kel/projects\_cds/libcds-\/debug/\_CPack\_Packages/Linux/RPM/SPECS/cds-\/lib.spec}
\DoxyCodeLine{CPack:\ -\/\ package:\ /home/kel/projects\_cds/libcds-\/debug/cds-\/2.1.0-\/1-\/devel.rpm\ generated.}
\DoxyCodeLine{CPack:\ -\/\ package:\ /home/kel/projects\_cds/libcds-\/debug/cds-\/2.1.0-\/1-\/lib.rpm\ generated.}

\end{DoxyCode}

\end{DoxyItemize}\hypertarget{readme.md_autotoc_md469}{}\doxysubsection{\texorpdfstring{Future development}{Future development}}\label{readme.md_autotoc_md469}

\begin{DoxyItemize}
\item CDash\+: use CI system 
\end{DoxyItemize}