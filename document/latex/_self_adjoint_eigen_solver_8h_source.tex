\doxysection{Self\+Adjoint\+Eigen\+Solver.\+h}
\hypertarget{_self_adjoint_eigen_solver_8h_source}{}\label{_self_adjoint_eigen_solver_8h_source}\index{external/taskflow/3rd-\/party/eigen-\/3.3.7/Eigen/src/Eigenvalues/SelfAdjointEigenSolver.h@{external/taskflow/3rd-\/party/eigen-\/3.3.7/Eigen/src/Eigenvalues/SelfAdjointEigenSolver.h}}
\mbox{\hyperlink{_self_adjoint_eigen_solver_8h}{浏览该文件的文档.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ This\ file\ is\ part\ of\ Eigen,\ a\ lightweight\ C++\ template\ library}}
\DoxyCodeLine{00002\ \textcolor{comment}{//\ for\ linear\ algebra.}}
\DoxyCodeLine{00003\ \textcolor{comment}{//}}
\DoxyCodeLine{00004\ \textcolor{comment}{//\ Copyright\ (C)\ 2008-\/2010\ Gael\ Guennebaud\ <gael.guennebaud@inria.fr>}}
\DoxyCodeLine{00005\ \textcolor{comment}{//\ Copyright\ (C)\ 2010\ Jitse\ Niesen\ <jitse@maths.leeds.ac.uk>}}
\DoxyCodeLine{00006\ \textcolor{comment}{//}}
\DoxyCodeLine{00007\ \textcolor{comment}{//\ This\ Source\ Code\ Form\ is\ subject\ to\ the\ terms\ of\ the\ Mozilla}}
\DoxyCodeLine{00008\ \textcolor{comment}{//\ Public\ License\ v.\ 2.0.\ If\ a\ copy\ of\ the\ MPL\ was\ not\ distributed}}
\DoxyCodeLine{00009\ \textcolor{comment}{//\ with\ this\ file,\ You\ can\ obtain\ one\ at\ http://mozilla.org/MPL/2.0/.}}
\DoxyCodeLine{00010\ }
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#ifndef\ EIGEN\_SELFADJOINTEIGENSOLVER\_H}}
\DoxyCodeLine{00012\ \textcolor{preprocessor}{\#define\ EIGEN\_SELFADJOINTEIGENSOLVER\_H}}
\DoxyCodeLine{00013\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{_tridiagonalization_8h}{./Tridiagonalization.h}}"{}}}
\DoxyCodeLine{00015\ }
\DoxyCodeLine{00016\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespace_eigen}{Eigen}}\ \{\ }
\DoxyCodeLine{00017\ }
\DoxyCodeLine{00018\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ \_MatrixType>}
\DoxyCodeLine{00019\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_eigen_1_1_generalized_self_adjoint_eigen_solver}{GeneralizedSelfAdjointEigenSolver}};}
\DoxyCodeLine{00020\ }
\DoxyCodeLine{00021\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespace_eigen_1_1internal}{internal}}\ \{}
\DoxyCodeLine{00022\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ SolverType,\textcolor{keywordtype}{int}\ Size,\textcolor{keywordtype}{bool}\ IsComplex>\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_eigen_1_1internal_1_1direct__selfadjoint__eigenvalues}{direct\_selfadjoint\_eigenvalues}};}
\DoxyCodeLine{00023\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ MatrixType,\ \textcolor{keyword}{typename}\ DiagType,\ \textcolor{keyword}{typename}\ SubDiagType>}
\DoxyCodeLine{00024\ \mbox{\hyperlink{group__enums_ga85fad7b87587764e5cf6b513a9e0ee5e}{ComputationInfo}}\ \mbox{\hyperlink{namespace_eigen_1_1internal_a38da09fda4f78efb9723a482048c3d6c}{computeFromTridiagonal\_impl}}(DiagType\&\ diag,\ SubDiagType\&\ subdiag,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1traits}{Index}}\ maxIterations,\ \textcolor{keywordtype}{bool}\ computeEigenvectors,\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1traits}{MatrixType}}\&\ eivec);}
\DoxyCodeLine{00025\ \}}
\DoxyCodeLine{00026\ }
\DoxyCodeLine{00070\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ \_MatrixType>\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_af3466b3809be4a7738d84493d80d4737}{SelfAdjointEigenSolver}}}
\DoxyCodeLine{00071\ \{}
\DoxyCodeLine{00072\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00073\ }
\DoxyCodeLine{00074\ \ \ \ \ \textcolor{keyword}{typedef}\ \_MatrixType\ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_aa8238634587d40c56228848470acb4ef}{MatrixType}};}
\DoxyCodeLine{00075\ \ \ \ \ \textcolor{keyword}{enum}\ \{}
\DoxyCodeLine{00076\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a8c9a144c6f505e3e246015643130e622a12ecb6f6de5809c8abad46d995914e8a}{Size}}\ =\ MatrixType::RowsAtCompileTime,}
\DoxyCodeLine{00077\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a8c9a144c6f505e3e246015643130e622adc53ffa99e7500940f6f56e8fae7c3a9}{ColsAtCompileTime}}\ =\ MatrixType::ColsAtCompileTime,}
\DoxyCodeLine{00078\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a8c9a144c6f505e3e246015643130e622a9bebdb8fd135f2ed1cf56aa00e4b72e8}{Options}}\ =\ MatrixType::Options,}
\DoxyCodeLine{00079\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a8c9a144c6f505e3e246015643130e622af51d0afe7ca59ac789ac8dcb573e3c66}{MaxColsAtCompileTime}}\ =\ MatrixType::MaxColsAtCompileTime}
\DoxyCodeLine{00080\ \ \ \ \ \};}
\DoxyCodeLine{00081\ \ \ \ \ }
\DoxyCodeLine{00083\ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ MatrixType::Scalar\ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a0bfcedf4245b6846007ca4f01e4feb1f}{Scalar}};}
\DoxyCodeLine{00084\ \ \ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Eigen::Index}}\ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a8a59ab7734b6eae2754fd78bc7c3a360}{Index}};\ }
\DoxyCodeLine{00085\ \ \ \ \ }
\DoxyCodeLine{00086\ \ \ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{class_eigen_1_1_matrix}{Matrix<Scalar,Size,Size,ColMajor,MaxColsAtCompileTime,MaxColsAtCompileTime>}}\ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a0cbb16dc8baf4058188ea308fa37a803}{EigenvectorsType}};}
\DoxyCodeLine{00087\ }
\DoxyCodeLine{00094\ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{struct_eigen_1_1_generic_num_traits_abca8573812593670795c41f22aa9d5e2}{NumTraits<Scalar>::Real}}\ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a5dae5f422a3c71060e6bd31332bf64fd}{RealScalar}};}
\DoxyCodeLine{00095\ \ \ \ \ }
\DoxyCodeLine{00096\ \ \ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_eigen_1_1internal_1_1direct__selfadjoint__eigenvalues}{internal::direct\_selfadjoint\_eigenvalues}}<\mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_af3466b3809be4a7738d84493d80d4737}{SelfAdjointEigenSolver}},\mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a8c9a144c6f505e3e246015643130e622a12ecb6f6de5809c8abad46d995914e8a}{Size}},\mbox{\hyperlink{struct_eigen_1_1_num_traits}{NumTraits}}<\mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a0bfcedf4245b6846007ca4f01e4feb1f}{Scalar}}>::\mbox{\hyperlink{external_2taskflow_23rd-party_2eigen-3_83_87_2blas_2common_8h_aa430eede2197cbd34a7082f8fca83cd4a66d6dc5b929fc072f7dce7fdab0ee378}{IsComplex}}>;}
\DoxyCodeLine{00097\ }
\DoxyCodeLine{00103\ \ \ \ \ typedef\ typename\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1plain__col__type}{internal::plain\_col\_type}}<MatrixType,\ RealScalar>\mbox{\hyperlink{struct_eigen_1_1_packet_type}{::type}}\ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a7de905f63891e06c1b14242dbefa58d5}{RealVectorType}};}
\DoxyCodeLine{00104\ \ \ \ \ typedef\ \mbox{\hyperlink{class_eigen_1_1_tridiagonalization}{Tridiagonalization}}<MatrixType>\ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_aee7b34cdccc189fa836c20f55f8415dd}{TridiagonalizationType}};}
\DoxyCodeLine{00105\ \ \ \ \ typedef\ typename\ \mbox{\hyperlink{class_eigen_1_1_tridiagonalization_a68729d89d61edbae954fc7ad0b72a5b8}{TridiagonalizationType::SubDiagonalType}}\ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_aeef7348fa4e1c14b469fd26d17f7713e}{SubDiagonalType}};}
\DoxyCodeLine{00106\ }
\DoxyCodeLine{00117\ \ \ \ \ EIGEN\_DEVICE\_FUNC}
\DoxyCodeLine{00118\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_af3466b3809be4a7738d84493d80d4737}{SelfAdjointEigenSolver}}()}
\DoxyCodeLine{00119\ \ \ \ \ \ \ \ \ :\ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a4c86f72288084ac48c2b6493a893bae4}{m\_eivec}}(),}
\DoxyCodeLine{00120\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a1ba3c7fe4703ee7eed528a18e53b0289}{m\_eivalues}}(),}
\DoxyCodeLine{00121\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a5da95aa467ce0555d01a69ba357f62bb}{m\_subdiag}}(),}
\DoxyCodeLine{00122\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a7619df2065e46bde1f509cae1bc15a97}{m\_isInitialized}}(false)}
\DoxyCodeLine{00123\ \ \ \ \ \{\ \}}
\DoxyCodeLine{00124\ }
\DoxyCodeLine{00137\ \ \ \ \ EIGEN\_DEVICE\_FUNC}
\DoxyCodeLine{00138\ \ \ \ \ \textcolor{keyword}{explicit}\ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_af20f466a4c29477271e91841e3382b27}{SelfAdjointEigenSolver}}(\mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a8a59ab7734b6eae2754fd78bc7c3a360}{Index}}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}})}
\DoxyCodeLine{00139\ \ \ \ \ \ \ \ \ :\ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a4c86f72288084ac48c2b6493a893bae4}{m\_eivec}}(\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}},\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}}),}
\DoxyCodeLine{00140\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a1ba3c7fe4703ee7eed528a18e53b0289}{m\_eivalues}}(\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}}),}
\DoxyCodeLine{00141\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a5da95aa467ce0555d01a69ba357f62bb}{m\_subdiag}}(\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}}\ >\ 1\ ?\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}}\ -\/\ 1\ :\ 1),}
\DoxyCodeLine{00142\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a7619df2065e46bde1f509cae1bc15a97}{m\_isInitialized}}(\mbox{\hyperlink{yyjson_8h_a65e9886d74aaee76545e83dd09011727}{false}})}
\DoxyCodeLine{00143\ \ \ \ \ \{\}}
\DoxyCodeLine{00144\ }
\DoxyCodeLine{00160\ \ \ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ InputType>}
\DoxyCodeLine{00161\ \ \ \ \ EIGEN\_DEVICE\_FUNC}
\DoxyCodeLine{00162\ \ \ \ \ \textcolor{keyword}{explicit}\ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_ade694ed7b0a4d9da9480cedc849be76f}{SelfAdjointEigenSolver}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_eigen_1_1_eigen_base}{EigenBase<InputType>}}\&\ \mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}},\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{options_8c_a92a8d2cc6467e45662af606615851df8}{options}}\ =\ \mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a7f7d17fba3c9bb92158e346d5979d0f4}{ComputeEigenvectors}})}
\DoxyCodeLine{00163\ \ \ \ \ \ \ :\ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a4c86f72288084ac48c2b6493a893bae4}{m\_eivec}}(\mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}}.\mbox{\hyperlink{_tutorial__commainit__02_8cpp_a061459acc9e078fa4699e0e349887215}{rows}}(),\ \mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}}.\mbox{\hyperlink{_tutorial__commainit__02_8cpp_a4407a60bc4387adae24cee658711f2d9}{cols}}()),}
\DoxyCodeLine{00164\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a1ba3c7fe4703ee7eed528a18e53b0289}{m\_eivalues}}(\mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}}.\mbox{\hyperlink{_tutorial__commainit__02_8cpp_a4407a60bc4387adae24cee658711f2d9}{cols}}()),}
\DoxyCodeLine{00165\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a5da95aa467ce0555d01a69ba357f62bb}{m\_subdiag}}(\mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}}.\mbox{\hyperlink{_tutorial__commainit__02_8cpp_a061459acc9e078fa4699e0e349887215}{rows}}()\ >\ 1\ ?\ \mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}}.\mbox{\hyperlink{_tutorial__commainit__02_8cpp_a061459acc9e078fa4699e0e349887215}{rows}}()\ -\/\ 1\ :\ 1),}
\DoxyCodeLine{00166\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a7619df2065e46bde1f509cae1bc15a97}{m\_isInitialized}}(\mbox{\hyperlink{yyjson_8h_a65e9886d74aaee76545e83dd09011727}{false}})}
\DoxyCodeLine{00167\ \ \ \ \ \{}
\DoxyCodeLine{00168\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_aca7cecd3847bfea28e5984ab1c9e3921}{compute}}(\mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}}.derived(),\ \mbox{\hyperlink{options_8c_a92a8d2cc6467e45662af606615851df8}{options}});}
\DoxyCodeLine{00169\ \ \ \ \ \}}
\DoxyCodeLine{00170\ }
\DoxyCodeLine{00201\ \ \ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ InputType>}
\DoxyCodeLine{00202\ \ \ \ \ EIGEN\_DEVICE\_FUNC}
\DoxyCodeLine{00203\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_af3466b3809be4a7738d84493d80d4737}{SelfAdjointEigenSolver}}\&\ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_aca7cecd3847bfea28e5984ab1c9e3921}{compute}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_eigen_1_1_eigen_base}{EigenBase<InputType>}}\&\ \mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}},\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{options_8c_a92a8d2cc6467e45662af606615851df8}{options}}\ =\ \mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a7f7d17fba3c9bb92158e346d5979d0f4}{ComputeEigenvectors}});}
\DoxyCodeLine{00204\ \ \ \ \ }
\DoxyCodeLine{00223\ \ \ \ \ EIGEN\_DEVICE\_FUNC}
\DoxyCodeLine{00224\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_af3466b3809be4a7738d84493d80d4737}{SelfAdjointEigenSolver}}\&\ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a40b0a68841d6176b1ab98743cc82bef4}{computeDirect}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_aa8238634587d40c56228848470acb4ef}{MatrixType}}\&\ \mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}},\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{options_8c_a92a8d2cc6467e45662af606615851df8}{options}}\ =\ \mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a7f7d17fba3c9bb92158e346d5979d0f4}{ComputeEigenvectors}});}
\DoxyCodeLine{00225\ }
\DoxyCodeLine{00238\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_af3466b3809be4a7738d84493d80d4737}{SelfAdjointEigenSolver}}\&\ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a297893df7098c43278d385e4d4e23fe4}{computeFromTridiagonal}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a7de905f63891e06c1b14242dbefa58d5}{RealVectorType}}\&\ diag,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_aeef7348fa4e1c14b469fd26d17f7713e}{SubDiagonalType}}\&\ subdiag\ ,\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{options_8c_a92a8d2cc6467e45662af606615851df8}{options}}=\mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a7f7d17fba3c9bb92158e346d5979d0f4}{ComputeEigenvectors}});}
\DoxyCodeLine{00239\ }
\DoxyCodeLine{00258\ \ \ \ \ EIGEN\_DEVICE\_FUNC}
\DoxyCodeLine{00259\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a0cbb16dc8baf4058188ea308fa37a803}{EigenvectorsType}}\&\ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_aa6e650f65298c05b78942df39f6c9388}{eigenvectors}}()\textcolor{keyword}{\ const}}
\DoxyCodeLine{00260\ \textcolor{keyword}{\ \ \ \ }\{}
\DoxyCodeLine{00261\ \ \ \ \ \ \ \mbox{\hyperlink{eigen-3_83_87_2_eigen_2src_2_core_2util_2_macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(\mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a7619df2065e46bde1f509cae1bc15a97}{m\_isInitialized}}\ \&\&\ \textcolor{stringliteral}{"{}SelfAdjointEigenSolver\ is\ not\ initialized."{}});}
\DoxyCodeLine{00262\ \ \ \ \ \ \ \mbox{\hyperlink{eigen-3_83_87_2_eigen_2src_2_core_2util_2_macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(\mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a26697e6c17e490fd4f6315276c597fb1}{m\_eigenvectorsOk}}\ \&\&\ \textcolor{stringliteral}{"{}The\ eigenvectors\ have\ not\ been\ computed\ together\ with\ the\ eigenvalues."{}});}
\DoxyCodeLine{00263\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a4c86f72288084ac48c2b6493a893bae4}{m\_eivec}};}
\DoxyCodeLine{00264\ \ \ \ \ \}}
\DoxyCodeLine{00265\ }
\DoxyCodeLine{00281\ \ \ \ \ EIGEN\_DEVICE\_FUNC}
\DoxyCodeLine{00282\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a7de905f63891e06c1b14242dbefa58d5}{RealVectorType}}\&\ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_aea708eb6ecf37fcaa7d415fec2892d60}{eigenvalues}}()\textcolor{keyword}{\ const}}
\DoxyCodeLine{00283\ \textcolor{keyword}{\ \ \ \ }\{}
\DoxyCodeLine{00284\ \ \ \ \ \ \ \mbox{\hyperlink{eigen-3_83_87_2_eigen_2src_2_core_2util_2_macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(\mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a7619df2065e46bde1f509cae1bc15a97}{m\_isInitialized}}\ \&\&\ \textcolor{stringliteral}{"{}SelfAdjointEigenSolver\ is\ not\ initialized."{}});}
\DoxyCodeLine{00285\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a1ba3c7fe4703ee7eed528a18e53b0289}{m\_eivalues}};}
\DoxyCodeLine{00286\ \ \ \ \ \}}
\DoxyCodeLine{00287\ }
\DoxyCodeLine{00305\ \ \ \ \ EIGEN\_DEVICE\_FUNC}
\DoxyCodeLine{00306\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_aa8238634587d40c56228848470acb4ef}{MatrixType}}\ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a5c5158fd86366081bdabec38112c2c8a}{operatorSqrt}}()\textcolor{keyword}{\ const}}
\DoxyCodeLine{00307\ \textcolor{keyword}{\ \ \ \ }\{}
\DoxyCodeLine{00308\ \ \ \ \ \ \ \mbox{\hyperlink{eigen-3_83_87_2_eigen_2src_2_core_2util_2_macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(\mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a7619df2065e46bde1f509cae1bc15a97}{m\_isInitialized}}\ \&\&\ \textcolor{stringliteral}{"{}SelfAdjointEigenSolver\ is\ not\ initialized."{}});}
\DoxyCodeLine{00309\ \ \ \ \ \ \ \mbox{\hyperlink{eigen-3_83_87_2_eigen_2src_2_core_2util_2_macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(\mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a26697e6c17e490fd4f6315276c597fb1}{m\_eigenvectorsOk}}\ \&\&\ \textcolor{stringliteral}{"{}The\ eigenvectors\ have\ not\ been\ computed\ together\ with\ the\ eigenvalues."{}});}
\DoxyCodeLine{00310\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a4c86f72288084ac48c2b6493a893bae4}{m\_eivec}}\ *\ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a1ba3c7fe4703ee7eed528a18e53b0289}{m\_eivalues}}.cwiseSqrt().asDiagonal()\ *\ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a4c86f72288084ac48c2b6493a893bae4}{m\_eivec}}.adjoint();}
\DoxyCodeLine{00311\ \ \ \ \ \}}
\DoxyCodeLine{00312\ }
\DoxyCodeLine{00330\ \ \ \ \ EIGEN\_DEVICE\_FUNC}
\DoxyCodeLine{00331\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_aa8238634587d40c56228848470acb4ef}{MatrixType}}\ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a71fe0aea0b22d176efcea556c5c160f5}{operatorInverseSqrt}}()\textcolor{keyword}{\ const}}
\DoxyCodeLine{00332\ \textcolor{keyword}{\ \ \ \ }\{}
\DoxyCodeLine{00333\ \ \ \ \ \ \ \mbox{\hyperlink{eigen-3_83_87_2_eigen_2src_2_core_2util_2_macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(\mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a7619df2065e46bde1f509cae1bc15a97}{m\_isInitialized}}\ \&\&\ \textcolor{stringliteral}{"{}SelfAdjointEigenSolver\ is\ not\ initialized."{}});}
\DoxyCodeLine{00334\ \ \ \ \ \ \ \mbox{\hyperlink{eigen-3_83_87_2_eigen_2src_2_core_2util_2_macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(\mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a26697e6c17e490fd4f6315276c597fb1}{m\_eigenvectorsOk}}\ \&\&\ \textcolor{stringliteral}{"{}The\ eigenvectors\ have\ not\ been\ computed\ together\ with\ the\ eigenvalues."{}});}
\DoxyCodeLine{00335\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a4c86f72288084ac48c2b6493a893bae4}{m\_eivec}}\ *\ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a1ba3c7fe4703ee7eed528a18e53b0289}{m\_eivalues}}.cwiseInverse().cwiseSqrt().asDiagonal()\ *\ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a4c86f72288084ac48c2b6493a893bae4}{m\_eivec}}.adjoint();}
\DoxyCodeLine{00336\ \ \ \ \ \}}
\DoxyCodeLine{00337\ }
\DoxyCodeLine{00342\ \ \ \ \ EIGEN\_DEVICE\_FUNC}
\DoxyCodeLine{00343\ \ \ \ \ \mbox{\hyperlink{group__enums_ga85fad7b87587764e5cf6b513a9e0ee5e}{ComputationInfo}}\ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a56bd59b85a6f6f00ff7bff307ad0e015}{info}}()\textcolor{keyword}{\ const}}
\DoxyCodeLine{00344\ \textcolor{keyword}{\ \ \ \ }\{}
\DoxyCodeLine{00345\ \ \ \ \ \ \ \mbox{\hyperlink{eigen-3_83_87_2_eigen_2src_2_core_2util_2_macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(\mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a7619df2065e46bde1f509cae1bc15a97}{m\_isInitialized}}\ \&\&\ \textcolor{stringliteral}{"{}SelfAdjointEigenSolver\ is\ not\ initialized."{}});}
\DoxyCodeLine{00346\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a7d3a941711a788da32be6cc6126e698b}{m\_info}};}
\DoxyCodeLine{00347\ \ \ \ \ \}}
\DoxyCodeLine{00348\ }
\DoxyCodeLine{00354\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a9ba10b83f095b18dbea345db7304acfa}{m\_maxIterations}}\ =\ 30;}
\DoxyCodeLine{00355\ }
\DoxyCodeLine{00356\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00357\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a8992bfdbf1c6dbdd44dc8c4cfa1467a6}{check\_template\_parameters}}()}
\DoxyCodeLine{00358\ \ \ \ \ \{}
\DoxyCodeLine{00359\ \ \ \ \ \ \ \mbox{\hyperlink{external_2taskflow_23rd-party_2eigen-3_83_87_2_eigen_2src_2_core_2util_2_static_assert_8h_a9e3e7d3a7dc559b8b72aa535d3a555d9}{EIGEN\_STATIC\_ASSERT\_NON\_INTEGER}}(\mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a0bfcedf4245b6846007ca4f01e4feb1f}{Scalar}});}
\DoxyCodeLine{00360\ \ \ \ \ \}}
\DoxyCodeLine{00361\ \ \ \ \ }
\DoxyCodeLine{00362\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a0cbb16dc8baf4058188ea308fa37a803}{EigenvectorsType}}\ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a4c86f72288084ac48c2b6493a893bae4}{m\_eivec}};}
\DoxyCodeLine{00363\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a7de905f63891e06c1b14242dbefa58d5}{RealVectorType}}\ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a1ba3c7fe4703ee7eed528a18e53b0289}{m\_eivalues}};}
\DoxyCodeLine{00364\ \ \ \ \ \textcolor{keyword}{typename}\ \mbox{\hyperlink{class_eigen_1_1_tridiagonalization_a68729d89d61edbae954fc7ad0b72a5b8}{TridiagonalizationType::SubDiagonalType}}\ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a5da95aa467ce0555d01a69ba357f62bb}{m\_subdiag}};}
\DoxyCodeLine{00365\ \ \ \ \ \mbox{\hyperlink{group__enums_ga85fad7b87587764e5cf6b513a9e0ee5e}{ComputationInfo}}\ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a7d3a941711a788da32be6cc6126e698b}{m\_info}};}
\DoxyCodeLine{00366\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a7619df2065e46bde1f509cae1bc15a97}{m\_isInitialized}};}
\DoxyCodeLine{00367\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a26697e6c17e490fd4f6315276c597fb1}{m\_eigenvectorsOk}};}
\DoxyCodeLine{00368\ \};}
\DoxyCodeLine{00369\ }
\DoxyCodeLine{00370\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespaceinternal}{internal}}\ \{}
\DoxyCodeLine{00391\ \textcolor{keyword}{template}<\textcolor{keywordtype}{int}\ StorageOrder,\textcolor{keyword}{typename}\ RealScalar,\ \textcolor{keyword}{typename}\ Scalar,\ \textcolor{keyword}{typename}\ Index>}
\DoxyCodeLine{00392\ EIGEN\_DEVICE\_FUNC}
\DoxyCodeLine{00393\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{namespace_eigen_1_1internal_a20ef930f01b4a88b5587832cd9f4787a}{tridiagonal\_qr\_step}}(\mbox{\hyperlink{bench__gemm_8cpp_acb5c3dc237f99cf17167e8a629f01b43}{RealScalar}}*\ diag,\ \mbox{\hyperlink{bench__gemm_8cpp_acb5c3dc237f99cf17167e8a629f01b43}{RealScalar}}*\ subdiag,\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ \mbox{\hyperlink{cpq__pdes_8cpp_a455a4d1d80a69762a133ad026f1cba43}{start}},\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ \mbox{\hyperlink{ittnotify__static_8h_a30bf4ccd4623b7a8276bbc7f99e491c7}{end}},\ \mbox{\hyperlink{class_eigen_1_1_product}{Scalar}}*\ matrixQ,\ \mbox{\hyperlink{class_eigen_1_1_tensor}{Index}}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}});}
\DoxyCodeLine{00394\ \}}
\DoxyCodeLine{00395\ }
\DoxyCodeLine{00396\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ MatrixType>}
\DoxyCodeLine{00397\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ InputType>}
\DoxyCodeLine{00398\ EIGEN\_DEVICE\_FUNC}
\DoxyCodeLine{00399\ SelfAdjointEigenSolver<MatrixType>\&\ SelfAdjointEigenSolver<MatrixType>}
\DoxyCodeLine{00400\ ::compute(\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_eigen_1_1_eigen_base}{EigenBase<InputType>}}\&\ a\_matrix,\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{options_8c_a92a8d2cc6467e45662af606615851df8}{options}})}
\DoxyCodeLine{00401\ \{}
\DoxyCodeLine{00402\ \ \ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a8992bfdbf1c6dbdd44dc8c4cfa1467a6}{check\_template\_parameters}}();}
\DoxyCodeLine{00403\ \ \ }
\DoxyCodeLine{00404\ \ \ \textcolor{keyword}{const}\ InputType\ \&\mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}}(a\_matrix.\mbox{\hyperlink{struct_eigen_1_1_eigen_base_ab4cf3e6bb046a94a46b69b857bd3dbc9}{derived}}());}
\DoxyCodeLine{00405\ \ \ }
\DoxyCodeLine{00406\ \ \ \textcolor{keyword}{using\ }std::abs;}
\DoxyCodeLine{00407\ \ \ \mbox{\hyperlink{eigen-3_83_87_2_eigen_2src_2_core_2util_2_macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(\mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}}.cols()\ ==\ \mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}}.rows());}
\DoxyCodeLine{00408\ \ \ \mbox{\hyperlink{eigen-3_83_87_2_eigen_2src_2_core_2util_2_macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}((\mbox{\hyperlink{options_8c_a92a8d2cc6467e45662af606615851df8}{options}}\&\string~(\mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a58b2e52b6b46818217f67d2b38ee90e3}{EigVecMask}}|\mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a2cd73a7e08a5f26915a562a7f88c6465}{GenEigMask}}))==0}
\DoxyCodeLine{00409\ \ \ \ \ \ \ \ \ \ \ \&\&\ (\mbox{\hyperlink{options_8c_a92a8d2cc6467e45662af606615851df8}{options}}\&\mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a58b2e52b6b46818217f67d2b38ee90e3}{EigVecMask}})!=\mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a58b2e52b6b46818217f67d2b38ee90e3}{EigVecMask}}}
\DoxyCodeLine{00410\ \ \ \ \ \ \ \ \ \ \ \&\&\ \textcolor{stringliteral}{"{}invalid\ option\ parameter"{}});}
\DoxyCodeLine{00411\ \ \ \textcolor{keywordtype}{bool}\ computeEigenvectors\ =\ (\mbox{\hyperlink{options_8c_a92a8d2cc6467e45662af606615851df8}{options}}\&\mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a7f7d17fba3c9bb92158e346d5979d0f4}{ComputeEigenvectors}})==\mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a7f7d17fba3c9bb92158e346d5979d0f4}{ComputeEigenvectors}};}
\DoxyCodeLine{00412\ \ \ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a8a59ab7734b6eae2754fd78bc7c3a360}{Index}}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}\ =\ \mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}}.cols();}
\DoxyCodeLine{00413\ \ \ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a1ba3c7fe4703ee7eed528a18e53b0289}{m\_eivalues}}.resize(\mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}},1);}
\DoxyCodeLine{00414\ }
\DoxyCodeLine{00415\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}==1)}
\DoxyCodeLine{00416\ \ \ \{}
\DoxyCodeLine{00417\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a4c86f72288084ac48c2b6493a893bae4}{m\_eivec}}\ =\ \mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}};}
\DoxyCodeLine{00418\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a1ba3c7fe4703ee7eed528a18e53b0289}{m\_eivalues}}.coeffRef(0,0)\ =\ numext::real(\mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a4c86f72288084ac48c2b6493a893bae4}{m\_eivec}}.coeff(0,0));}
\DoxyCodeLine{00419\ \ \ \ \ \textcolor{keywordflow}{if}(computeEigenvectors)}
\DoxyCodeLine{00420\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a4c86f72288084ac48c2b6493a893bae4}{m\_eivec}}.setOnes(\mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}},\mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}});}
\DoxyCodeLine{00421\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a7d3a941711a788da32be6cc6126e698b}{m\_info}}\ =\ \mbox{\hyperlink{group__enums_gga85fad7b87587764e5cf6b513a9e0ee5ea671a2aeb0f527802806a441d58a80fcf}{Success}};}
\DoxyCodeLine{00422\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a7619df2065e46bde1f509cae1bc15a97}{m\_isInitialized}}\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00423\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a26697e6c17e490fd4f6315276c597fb1}{m\_eigenvectorsOk}}\ =\ computeEigenvectors;}
\DoxyCodeLine{00424\ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{00425\ \ \ \}}
\DoxyCodeLine{00426\ }
\DoxyCodeLine{00427\ \ \ \textcolor{comment}{//\ declare\ some\ aliases}}
\DoxyCodeLine{00428\ \ \ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a7de905f63891e06c1b14242dbefa58d5}{RealVectorType}}\&\ diag\ =\ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a1ba3c7fe4703ee7eed528a18e53b0289}{m\_eivalues}};}
\DoxyCodeLine{00429\ \ \ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a0cbb16dc8baf4058188ea308fa37a803}{EigenvectorsType}}\&\ \mbox{\hyperlink{_tutorial___advanced_initialization___comma_temporary_8cpp_a5d2ded7a4c8830608d7b218f5f27c0a0}{mat}}\ =\ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a4c86f72288084ac48c2b6493a893bae4}{m\_eivec}};}
\DoxyCodeLine{00430\ }
\DoxyCodeLine{00431\ \ \ \textcolor{comment}{//\ map\ the\ matrix\ coefficients\ to\ [-\/1:1]\ to\ avoid\ over-\/\ and\ underflow.}}
\DoxyCodeLine{00432\ \ \ \mbox{\hyperlink{_tutorial___advanced_initialization___comma_temporary_8cpp_a5d2ded7a4c8830608d7b218f5f27c0a0}{mat}}\ =\ \mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}}.template\ \mbox{\hyperlink{eigen-3_83_87_2lapack_2cholesky_8cpp_accba35e157cff07f839ca4634f76c472}{triangularView<Lower>}}();}
\DoxyCodeLine{00433\ \ \ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a5dae5f422a3c71060e6bd31332bf64fd}{RealScalar}}\ \mbox{\hyperlink{gnuplot__common__settings_8hh_a028be1055fb10c679b6153f8dcd0befa}{scale}}\ =\ \mbox{\hyperlink{_tutorial___advanced_initialization___comma_temporary_8cpp_a5d2ded7a4c8830608d7b218f5f27c0a0}{mat}}.cwiseAbs().maxCoeff();}
\DoxyCodeLine{00434\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{gnuplot__common__settings_8hh_a028be1055fb10c679b6153f8dcd0befa}{scale}}==\mbox{\hyperlink{bench__gemm_8cpp_acb5c3dc237f99cf17167e8a629f01b43}{RealScalar}}(0))\ \mbox{\hyperlink{gnuplot__common__settings_8hh_a028be1055fb10c679b6153f8dcd0befa}{scale}}\ =\ \mbox{\hyperlink{bench__gemm_8cpp_acb5c3dc237f99cf17167e8a629f01b43}{RealScalar}}(1);}
\DoxyCodeLine{00435\ \ \ \mbox{\hyperlink{_tutorial___advanced_initialization___comma_temporary_8cpp_a5d2ded7a4c8830608d7b218f5f27c0a0}{mat}}.template\ \mbox{\hyperlink{eigen-3_83_87_2lapack_2cholesky_8cpp_accba35e157cff07f839ca4634f76c472}{triangularView<Lower>}}()\ /=\ \mbox{\hyperlink{gnuplot__common__settings_8hh_a028be1055fb10c679b6153f8dcd0befa}{scale}};}
\DoxyCodeLine{00436\ \ \ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a5da95aa467ce0555d01a69ba357f62bb}{m\_subdiag}}.resize(\mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}-\/1);}
\DoxyCodeLine{00437\ \ \ \mbox{\hyperlink{namespace_eigen_1_1internal_a59076b7f3fda3580d0d8fdc34481b385}{internal::tridiagonalization\_inplace}}(\mbox{\hyperlink{_tutorial___advanced_initialization___comma_temporary_8cpp_a5d2ded7a4c8830608d7b218f5f27c0a0}{mat}},\ diag,\ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a5da95aa467ce0555d01a69ba357f62bb}{m\_subdiag}},\ computeEigenvectors);}
\DoxyCodeLine{00438\ }
\DoxyCodeLine{00439\ \ \ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a7d3a941711a788da32be6cc6126e698b}{m\_info}}\ =\ \mbox{\hyperlink{namespace_eigen_1_1internal_a38da09fda4f78efb9723a482048c3d6c}{internal::computeFromTridiagonal\_impl}}(diag,\ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a5da95aa467ce0555d01a69ba357f62bb}{m\_subdiag}},\ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a9ba10b83f095b18dbea345db7304acfa}{m\_maxIterations}},\ computeEigenvectors,\ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a4c86f72288084ac48c2b6493a893bae4}{m\_eivec}});}
\DoxyCodeLine{00440\ \ \ }
\DoxyCodeLine{00441\ \ \ \textcolor{comment}{//\ scale\ back\ the\ eigen\ values}}
\DoxyCodeLine{00442\ \ \ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a1ba3c7fe4703ee7eed528a18e53b0289}{m\_eivalues}}\ *=\ \mbox{\hyperlink{gnuplot__common__settings_8hh_a028be1055fb10c679b6153f8dcd0befa}{scale}};}
\DoxyCodeLine{00443\ }
\DoxyCodeLine{00444\ \ \ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a7619df2065e46bde1f509cae1bc15a97}{m\_isInitialized}}\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00445\ \ \ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a26697e6c17e490fd4f6315276c597fb1}{m\_eigenvectorsOk}}\ =\ computeEigenvectors;}
\DoxyCodeLine{00446\ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{00447\ \}}
\DoxyCodeLine{00448\ }
\DoxyCodeLine{00449\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ MatrixType>}
\DoxyCodeLine{00450\ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver}{SelfAdjointEigenSolver<MatrixType>}}\&\ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver}{SelfAdjointEigenSolver<MatrixType>}}}
\DoxyCodeLine{00451\ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver}{::computeFromTridiagonal}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a7de905f63891e06c1b14242dbefa58d5}{RealVectorType}}\&\ diag,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_aeef7348fa4e1c14b469fd26d17f7713e}{SubDiagonalType}}\&\ subdiag\ ,\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{options_8c_a92a8d2cc6467e45662af606615851df8}{options}})}
\DoxyCodeLine{00452\ \{}
\DoxyCodeLine{00453\ \ \ \textcolor{comment}{//TODO\ :\ Add\ an\ option\ to\ scale\ the\ values\ beforehand}}
\DoxyCodeLine{00454\ \ \ \textcolor{keywordtype}{bool}\ computeEigenvectors\ =\ (\mbox{\hyperlink{options_8c_a92a8d2cc6467e45662af606615851df8}{options}}\&\mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a7f7d17fba3c9bb92158e346d5979d0f4}{ComputeEigenvectors}})==\mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a7f7d17fba3c9bb92158e346d5979d0f4}{ComputeEigenvectors}};}
\DoxyCodeLine{00455\ }
\DoxyCodeLine{00456\ \ \ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a1ba3c7fe4703ee7eed528a18e53b0289}{m\_eivalues}}\ =\ diag;}
\DoxyCodeLine{00457\ \ \ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a5da95aa467ce0555d01a69ba357f62bb}{m\_subdiag}}\ =\ subdiag;}
\DoxyCodeLine{00458\ \ \ \textcolor{keywordflow}{if}\ (computeEigenvectors)}
\DoxyCodeLine{00459\ \ \ \{}
\DoxyCodeLine{00460\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a4c86f72288084ac48c2b6493a893bae4}{m\_eivec}}.setIdentity(diag.size(),\ diag.size());}
\DoxyCodeLine{00461\ \ \ \}}
\DoxyCodeLine{00462\ \ \ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a7d3a941711a788da32be6cc6126e698b}{m\_info}}\ =\ \mbox{\hyperlink{namespace_eigen_1_1internal_a38da09fda4f78efb9723a482048c3d6c}{internal::computeFromTridiagonal\_impl}}(\mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a1ba3c7fe4703ee7eed528a18e53b0289}{m\_eivalues}},\ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a5da95aa467ce0555d01a69ba357f62bb}{m\_subdiag}},\ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a9ba10b83f095b18dbea345db7304acfa}{m\_maxIterations}},\ computeEigenvectors,\ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a4c86f72288084ac48c2b6493a893bae4}{m\_eivec}});}
\DoxyCodeLine{00463\ }
\DoxyCodeLine{00464\ \ \ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a7619df2065e46bde1f509cae1bc15a97}{m\_isInitialized}}\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00465\ \ \ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_a26697e6c17e490fd4f6315276c597fb1}{m\_eigenvectorsOk}}\ =\ computeEigenvectors;}
\DoxyCodeLine{00466\ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{00467\ \}}
\DoxyCodeLine{00468\ }
\DoxyCodeLine{00469\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespaceinternal}{internal}}\ \{}
\DoxyCodeLine{00481\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ MatrixType,\ \textcolor{keyword}{typename}\ DiagType,\ \textcolor{keyword}{typename}\ SubDiagType>}
\DoxyCodeLine{00482\ \mbox{\hyperlink{group__enums_ga85fad7b87587764e5cf6b513a9e0ee5e}{ComputationInfo}}\ \mbox{\hyperlink{namespace_eigen_1_1internal_a38da09fda4f78efb9723a482048c3d6c}{computeFromTridiagonal\_impl}}(DiagType\&\ diag,\ SubDiagType\&\ subdiag,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1traits}{Index}}\ maxIterations,\ \textcolor{keywordtype}{bool}\ computeEigenvectors,\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1traits}{MatrixType}}\&\ eivec)}
\DoxyCodeLine{00483\ \{}
\DoxyCodeLine{00484\ \ \ \textcolor{keyword}{using\ }std::abs;}
\DoxyCodeLine{00485\ }
\DoxyCodeLine{00486\ \ \ \mbox{\hyperlink{group__enums_ga85fad7b87587764e5cf6b513a9e0ee5e}{ComputationInfo}}\ \mbox{\hyperlink{eigen-3_83_87_2lapack_2cholesky_8cpp_a19e186475eb822b276da4b357d68140d}{info}};}
\DoxyCodeLine{00487\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ MatrixType::Scalar\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1traits}{Scalar}};}
\DoxyCodeLine{00488\ }
\DoxyCodeLine{00489\ \ \ \mbox{\hyperlink{struct_eigen_1_1internal_1_1traits}{Index}}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}\ =\ diag.size();}
\DoxyCodeLine{00490\ \ \ \mbox{\hyperlink{struct_eigen_1_1internal_1_1traits}{Index}}\ \mbox{\hyperlink{ittnotify__static_8h_a30bf4ccd4623b7a8276bbc7f99e491c7}{end}}\ =\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}-\/1;}
\DoxyCodeLine{00491\ \ \ \mbox{\hyperlink{struct_eigen_1_1internal_1_1traits}{Index}}\ \mbox{\hyperlink{cpq__pdes_8cpp_a455a4d1d80a69762a133ad026f1cba43}{start}}\ =\ 0;}
\DoxyCodeLine{00492\ \ \ \mbox{\hyperlink{struct_eigen_1_1internal_1_1traits}{Index}}\ iter\ =\ 0;\ \textcolor{comment}{//\ total\ number\ of\ iterations}}
\DoxyCodeLine{00493\ \ \ }
\DoxyCodeLine{00494\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ DiagType::RealScalar\ \mbox{\hyperlink{bench__gemm_8cpp_acb5c3dc237f99cf17167e8a629f01b43}{RealScalar}};}
\DoxyCodeLine{00495\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{bench__gemm_8cpp_acb5c3dc237f99cf17167e8a629f01b43}{RealScalar}}\ considerAsZero\ =\ (std::numeric\_limits<RealScalar>::min)();}
\DoxyCodeLine{00496\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{bench__gemm_8cpp_acb5c3dc237f99cf17167e8a629f01b43}{RealScalar}}\ precision\ =\ \mbox{\hyperlink{bench__gemm_8cpp_acb5c3dc237f99cf17167e8a629f01b43}{RealScalar}}(2)*\mbox{\hyperlink{struct_eigen_1_1_generic_num_traits_aadcf7fa75b2bc9a0e461a3b851d836a7}{NumTraits<RealScalar>::epsilon}}();}
\DoxyCodeLine{00497\ \ \ }
\DoxyCodeLine{00498\ \ \ \textcolor{keywordflow}{while}\ (\mbox{\hyperlink{ittnotify__static_8h_a30bf4ccd4623b7a8276bbc7f99e491c7}{end}}>0)}
\DoxyCodeLine{00499\ \ \ \{}
\DoxyCodeLine{00500\ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{struct_eigen_1_1internal_1_1traits}{Index}}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ =\ \mbox{\hyperlink{cpq__pdes_8cpp_a455a4d1d80a69762a133ad026f1cba43}{start}};\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}<\mbox{\hyperlink{ittnotify__static_8h_a30bf4ccd4623b7a8276bbc7f99e491c7}{end}};\ ++\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})}
\DoxyCodeLine{00501\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespace_eigen_1_1internal_a84d9a116f1410c45670db495257f64ac}{internal::isMuchSmallerThan}}(\mbox{\hyperlink{datatypes_8h_a3aa069ac3980707dae1e0530f50d59e4}{abs}}(subdiag[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}]),(\mbox{\hyperlink{datatypes_8h_a3aa069ac3980707dae1e0530f50d59e4}{abs}}(diag[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}])+\mbox{\hyperlink{datatypes_8h_a3aa069ac3980707dae1e0530f50d59e4}{abs}}(diag[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}+1])),precision)\ ||\ \mbox{\hyperlink{datatypes_8h_a3aa069ac3980707dae1e0530f50d59e4}{abs}}(subdiag[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}])\ <=\ considerAsZero)}
\DoxyCodeLine{00502\ \ \ \ \ \ \ \ \ subdiag[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}]\ =\ 0;}
\DoxyCodeLine{00503\ }
\DoxyCodeLine{00504\ \ \ \ \ \textcolor{comment}{//\ find\ the\ largest\ unreduced\ block}}
\DoxyCodeLine{00505\ \ \ \ \ \textcolor{keywordflow}{while}\ (\mbox{\hyperlink{ittnotify__static_8h_a30bf4ccd4623b7a8276bbc7f99e491c7}{end}}>0\ \&\&\ subdiag[\mbox{\hyperlink{ittnotify__static_8h_a30bf4ccd4623b7a8276bbc7f99e491c7}{end}}-\/1]==\mbox{\hyperlink{bench__gemm_8cpp_acb5c3dc237f99cf17167e8a629f01b43}{RealScalar}}(0))}
\DoxyCodeLine{00506\ \ \ \ \ \{}
\DoxyCodeLine{00507\ \ \ \ \ \ \ \mbox{\hyperlink{ittnotify__static_8h_a30bf4ccd4623b7a8276bbc7f99e491c7}{end}}-\/-\/;}
\DoxyCodeLine{00508\ \ \ \ \ \}}
\DoxyCodeLine{00509\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{ittnotify__static_8h_a30bf4ccd4623b7a8276bbc7f99e491c7}{end}}<=0)}
\DoxyCodeLine{00510\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00511\ }
\DoxyCodeLine{00512\ \ \ \ \ \textcolor{comment}{//\ if\ we\ spent\ too\ many\ iterations,\ we\ give\ up}}
\DoxyCodeLine{00513\ \ \ \ \ iter++;}
\DoxyCodeLine{00514\ \ \ \ \ \textcolor{keywordflow}{if}(iter\ >\ maxIterations\ *\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}})\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00515\ }
\DoxyCodeLine{00516\ \ \ \ \ \mbox{\hyperlink{cpq__pdes_8cpp_a455a4d1d80a69762a133ad026f1cba43}{start}}\ =\ \mbox{\hyperlink{ittnotify__static_8h_a30bf4ccd4623b7a8276bbc7f99e491c7}{end}}\ -\/\ 1;}
\DoxyCodeLine{00517\ \ \ \ \ \textcolor{keywordflow}{while}\ (\mbox{\hyperlink{cpq__pdes_8cpp_a455a4d1d80a69762a133ad026f1cba43}{start}}>0\ \&\&\ subdiag[\mbox{\hyperlink{cpq__pdes_8cpp_a455a4d1d80a69762a133ad026f1cba43}{start}}-\/1]!=0)}
\DoxyCodeLine{00518\ \ \ \ \ \ \ \mbox{\hyperlink{cpq__pdes_8cpp_a455a4d1d80a69762a133ad026f1cba43}{start}}-\/-\/;}
\DoxyCodeLine{00519\ }
\DoxyCodeLine{00520\ \ \ \ \ \mbox{\hyperlink{namespace_eigen_1_1internal_a20ef930f01b4a88b5587832cd9f4787a}{internal::tridiagonal\_qr\_step<MatrixType::Flags\&RowMajorBit\ ?\ RowMajor\ :\ ColMajor>}}(diag.data(),\ subdiag.data(),\ \mbox{\hyperlink{cpq__pdes_8cpp_a455a4d1d80a69762a133ad026f1cba43}{start}},\ \mbox{\hyperlink{ittnotify__static_8h_a30bf4ccd4623b7a8276bbc7f99e491c7}{end}},\ computeEigenvectors\ ?\ eivec.data()\ :\ (\mbox{\hyperlink{struct_eigen_1_1internal_1_1traits}{Scalar}}*)0,\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}});}
\DoxyCodeLine{00521\ \ \ \}}
\DoxyCodeLine{00522\ \ \ \textcolor{keywordflow}{if}\ (iter\ <=\ maxIterations\ *\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}})}
\DoxyCodeLine{00523\ \ \ \ \ \mbox{\hyperlink{eigen-3_83_87_2lapack_2cholesky_8cpp_a19e186475eb822b276da4b357d68140d}{info}}\ =\ \mbox{\hyperlink{group__enums_gga85fad7b87587764e5cf6b513a9e0ee5ea671a2aeb0f527802806a441d58a80fcf}{Success}};}
\DoxyCodeLine{00524\ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00525\ \ \ \ \ \mbox{\hyperlink{eigen-3_83_87_2lapack_2cholesky_8cpp_a19e186475eb822b276da4b357d68140d}{info}}\ =\ \mbox{\hyperlink{group__enums_gga85fad7b87587764e5cf6b513a9e0ee5ea6a68dfb88a8336108a30588bdf356c57}{NoConvergence}};}
\DoxyCodeLine{00526\ }
\DoxyCodeLine{00527\ \ \ \textcolor{comment}{//\ Sort\ eigenvalues\ and\ corresponding\ vectors.}}
\DoxyCodeLine{00528\ \ \ \textcolor{comment}{//\ TODO\ make\ the\ sort\ optional\ ?}}
\DoxyCodeLine{00529\ \ \ \textcolor{comment}{//\ TODO\ use\ a\ better\ sort\ algorithm\ !!}}
\DoxyCodeLine{00530\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{eigen-3_83_87_2lapack_2cholesky_8cpp_a19e186475eb822b276da4b357d68140d}{info}}\ ==\ \mbox{\hyperlink{group__enums_gga85fad7b87587764e5cf6b513a9e0ee5ea671a2aeb0f527802806a441d58a80fcf}{Success}})}
\DoxyCodeLine{00531\ \ \ \{}
\DoxyCodeLine{00532\ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{struct_eigen_1_1internal_1_1traits}{Index}}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ =\ 0;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ <\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}-\/1;\ ++\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}})}
\DoxyCodeLine{00533\ \ \ \ \ \{}
\DoxyCodeLine{00534\ \ \ \ \ \ \ \mbox{\hyperlink{struct_eigen_1_1internal_1_1traits}{Index}}\ k;}
\DoxyCodeLine{00535\ \ \ \ \ \ \ diag.segment(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}},\mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}}-\/\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}).minCoeff(\&k);}
\DoxyCodeLine{00536\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (k\ >\ 0)}
\DoxyCodeLine{00537\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00538\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacestd_a3acbe51b6415e9284430194bf04944e1}{std::swap}}(diag[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}],\ diag[k+\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}]);}
\DoxyCodeLine{00539\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(computeEigenvectors)}
\DoxyCodeLine{00540\ \ \ \ \ \ \ \ \ \ \ eivec.col(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}).swap(eivec.col(k+\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}));}
\DoxyCodeLine{00541\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00542\ \ \ \ \ \}}
\DoxyCodeLine{00543\ \ \ \}}
\DoxyCodeLine{00544\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{eigen-3_83_87_2lapack_2cholesky_8cpp_a19e186475eb822b276da4b357d68140d}{info}};}
\DoxyCodeLine{00545\ \}}
\DoxyCodeLine{00546\ \ \ }
\DoxyCodeLine{00547\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ SolverType,\textcolor{keywordtype}{int}\ Size,\textcolor{keywordtype}{bool}\ IsComplex>\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_eigen_1_1internal_1_1direct__selfadjoint__eigenvalues}{direct\_selfadjoint\_eigenvalues}}}
\DoxyCodeLine{00548\ \{}
\DoxyCodeLine{00549\ \ \ EIGEN\_DEVICE\_FUNC}
\DoxyCodeLine{00550\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1direct__selfadjoint__eigenvalues_afbde78285f513af91c6f0430f005759a}{run}}(SolverType\&\ \mbox{\hyperlink{eigenvalues_8cpp_a2207d894607fb09f7abc525577172078}{eig}},\ \textcolor{keyword}{const}\ \textcolor{keyword}{typename}\ SolverType::MatrixType\&\ \mbox{\hyperlink{bench__gemm_8cpp_addc86e8508f14411ec98f521c520f875}{A}},\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{options_8c_a92a8d2cc6467e45662af606615851df8}{options}})}
\DoxyCodeLine{00551\ \ \ \{\ \mbox{\hyperlink{eigenvalues_8cpp_a2207d894607fb09f7abc525577172078}{eig}}.compute(\mbox{\hyperlink{bench__gemm_8cpp_addc86e8508f14411ec98f521c520f875}{A}},\mbox{\hyperlink{options_8c_a92a8d2cc6467e45662af606615851df8}{options}});\ \}}
\DoxyCodeLine{00552\ \};}
\DoxyCodeLine{00553\ }
\DoxyCodeLine{00554\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ SolverType>\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_eigen_1_1internal_1_1direct__selfadjoint__eigenvalues}{direct\_selfadjoint\_eigenvalues}}<SolverType,3,\mbox{\hyperlink{yyjson_8h_a65e9886d74aaee76545e83dd09011727}{false}}>}
\DoxyCodeLine{00555\ \{}
\DoxyCodeLine{00556\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ SolverType::MatrixType\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1direct__selfadjoint__eigenvalues_3_01_solver_type_00_013_00_01false_01_4_a91212db992185b6ee3909be97d545ca4}{MatrixType}};}
\DoxyCodeLine{00557\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ SolverType::RealVectorType\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1direct__selfadjoint__eigenvalues_3_01_solver_type_00_013_00_01false_01_4_a1a9f066507f5261a9facab5b21b28682}{VectorType}};}
\DoxyCodeLine{00558\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ SolverType::Scalar\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1direct__selfadjoint__eigenvalues_3_01_solver_type_00_013_00_01false_01_4_a3e0e253654e2bbdada60c064e3178bb8}{Scalar}};}
\DoxyCodeLine{00559\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ SolverType::EigenvectorsType\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1direct__selfadjoint__eigenvalues_3_01_solver_type_00_013_00_01false_01_4_a871dcddc6a2eccca1440ce2e4ed62b63}{EigenvectorsType}};}
\DoxyCodeLine{00560\ \ \ }
\DoxyCodeLine{00561\ }
\DoxyCodeLine{00566\ \ \ EIGEN\_DEVICE\_FUNC}
\DoxyCodeLine{00567\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1direct__selfadjoint__eigenvalues_3_01_solver_type_00_013_00_01false_01_4_abb216c5ee047da4b4d7b225948b5d666}{computeRoots}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1direct__selfadjoint__eigenvalues_3_01_solver_type_00_013_00_01false_01_4_a91212db992185b6ee3909be97d545ca4}{MatrixType}}\&\ \mbox{\hyperlink{_angle_axis__mimic__euler_8cpp_ab3cd915d758008bd19d0f2428fbb354a}{m}},\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1direct__selfadjoint__eigenvalues_3_01_solver_type_00_013_00_01false_01_4_a1a9f066507f5261a9facab5b21b28682}{VectorType}}\&\ roots)}
\DoxyCodeLine{00568\ \ \ \{}
\DoxyCodeLine{00569\ \ \ \ \ EIGEN\_USING\_STD\_MATH(\mbox{\hyperlink{_array_cwise_unary_ops_8h_a656b9217a2fcb6de59dc8d1eb3079cc7}{sqrt}})}
\DoxyCodeLine{00570\ \ \ \ \ EIGEN\_USING\_STD\_MATH(\mbox{\hyperlink{namespace_eigen_aabbac4a376874ce85e22f24da1845008}{atan2}})}
\DoxyCodeLine{00571\ \ \ \ \ EIGEN\_USING\_STD\_MATH(\mbox{\hyperlink{_array_cwise_unary_ops_8h_a92b03396990b0e9eea0731aa406e31a4}{cos}})}
\DoxyCodeLine{00572\ \ \ \ \ EIGEN\_USING\_STD\_MATH(\mbox{\hyperlink{_array_cwise_unary_ops_8h_a9cfb0ea58bd813510a9e2db18a5e49f0}{sin}})}
\DoxyCodeLine{00573\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1direct__selfadjoint__eigenvalues_3_01_solver_type_00_013_00_01false_01_4_a3e0e253654e2bbdada60c064e3178bb8}{Scalar}}\ s\_inv3\ =\ \mbox{\hyperlink{bench__gemm_8cpp_a052eb942d12b6404aade6fae4b075fb9}{Scalar}}(1)/\mbox{\hyperlink{bench__gemm_8cpp_a052eb942d12b6404aade6fae4b075fb9}{Scalar}}(3);}
\DoxyCodeLine{00574\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1direct__selfadjoint__eigenvalues_3_01_solver_type_00_013_00_01false_01_4_a3e0e253654e2bbdada60c064e3178bb8}{Scalar}}\ s\_sqrt3\ =\ \mbox{\hyperlink{_array_cwise_unary_ops_8h_a656b9217a2fcb6de59dc8d1eb3079cc7}{sqrt}}(\mbox{\hyperlink{bench__gemm_8cpp_a052eb942d12b6404aade6fae4b075fb9}{Scalar}}(3));}
\DoxyCodeLine{00575\ }
\DoxyCodeLine{00576\ \ \ \ \ \textcolor{comment}{//\ The\ characteristic\ equation\ is\ x\string^3\ -\/\ c2*x\string^2\ +\ c1*x\ -\/\ c0\ =\ 0.\ \ The}}
\DoxyCodeLine{00577\ \ \ \ \ \textcolor{comment}{//\ eigenvalues\ are\ the\ roots\ to\ this\ equation,\ all\ guaranteed\ to\ be}}
\DoxyCodeLine{00578\ \ \ \ \ \textcolor{comment}{//\ real-\/valued,\ because\ the\ matrix\ is\ symmetric.}}
\DoxyCodeLine{00579\ \ \ \ \ \mbox{\hyperlink{struct_eigen_1_1internal_1_1direct__selfadjoint__eigenvalues_3_01_solver_type_00_013_00_01false_01_4_a3e0e253654e2bbdada60c064e3178bb8}{Scalar}}\ c0\ =\ \mbox{\hyperlink{_angle_axis__mimic__euler_8cpp_ab3cd915d758008bd19d0f2428fbb354a}{m}}(0,0)*\mbox{\hyperlink{_angle_axis__mimic__euler_8cpp_ab3cd915d758008bd19d0f2428fbb354a}{m}}(1,1)*\mbox{\hyperlink{_angle_axis__mimic__euler_8cpp_ab3cd915d758008bd19d0f2428fbb354a}{m}}(2,2)\ +\ \mbox{\hyperlink{bench__gemm_8cpp_a052eb942d12b6404aade6fae4b075fb9}{Scalar}}(2)*\mbox{\hyperlink{_angle_axis__mimic__euler_8cpp_ab3cd915d758008bd19d0f2428fbb354a}{m}}(1,0)*\mbox{\hyperlink{_angle_axis__mimic__euler_8cpp_ab3cd915d758008bd19d0f2428fbb354a}{m}}(2,0)*\mbox{\hyperlink{_angle_axis__mimic__euler_8cpp_ab3cd915d758008bd19d0f2428fbb354a}{m}}(2,1)\ -\/\ \mbox{\hyperlink{_angle_axis__mimic__euler_8cpp_ab3cd915d758008bd19d0f2428fbb354a}{m}}(0,0)*\mbox{\hyperlink{_angle_axis__mimic__euler_8cpp_ab3cd915d758008bd19d0f2428fbb354a}{m}}(2,1)*\mbox{\hyperlink{_angle_axis__mimic__euler_8cpp_ab3cd915d758008bd19d0f2428fbb354a}{m}}(2,1)\ -\/\ \mbox{\hyperlink{_angle_axis__mimic__euler_8cpp_ab3cd915d758008bd19d0f2428fbb354a}{m}}(1,1)*\mbox{\hyperlink{_angle_axis__mimic__euler_8cpp_ab3cd915d758008bd19d0f2428fbb354a}{m}}(2,0)*\mbox{\hyperlink{_angle_axis__mimic__euler_8cpp_ab3cd915d758008bd19d0f2428fbb354a}{m}}(2,0)\ -\/\ \mbox{\hyperlink{_angle_axis__mimic__euler_8cpp_ab3cd915d758008bd19d0f2428fbb354a}{m}}(2,2)*\mbox{\hyperlink{_angle_axis__mimic__euler_8cpp_ab3cd915d758008bd19d0f2428fbb354a}{m}}(1,0)*\mbox{\hyperlink{_angle_axis__mimic__euler_8cpp_ab3cd915d758008bd19d0f2428fbb354a}{m}}(1,0);}
\DoxyCodeLine{00580\ \ \ \ \ \mbox{\hyperlink{struct_eigen_1_1internal_1_1direct__selfadjoint__eigenvalues_3_01_solver_type_00_013_00_01false_01_4_a3e0e253654e2bbdada60c064e3178bb8}{Scalar}}\ c1\ =\ \mbox{\hyperlink{_angle_axis__mimic__euler_8cpp_ab3cd915d758008bd19d0f2428fbb354a}{m}}(0,0)*\mbox{\hyperlink{_angle_axis__mimic__euler_8cpp_ab3cd915d758008bd19d0f2428fbb354a}{m}}(1,1)\ -\/\ \mbox{\hyperlink{_angle_axis__mimic__euler_8cpp_ab3cd915d758008bd19d0f2428fbb354a}{m}}(1,0)*\mbox{\hyperlink{_angle_axis__mimic__euler_8cpp_ab3cd915d758008bd19d0f2428fbb354a}{m}}(1,0)\ +\ \mbox{\hyperlink{_angle_axis__mimic__euler_8cpp_ab3cd915d758008bd19d0f2428fbb354a}{m}}(0,0)*\mbox{\hyperlink{_angle_axis__mimic__euler_8cpp_ab3cd915d758008bd19d0f2428fbb354a}{m}}(2,2)\ -\/\ \mbox{\hyperlink{_angle_axis__mimic__euler_8cpp_ab3cd915d758008bd19d0f2428fbb354a}{m}}(2,0)*\mbox{\hyperlink{_angle_axis__mimic__euler_8cpp_ab3cd915d758008bd19d0f2428fbb354a}{m}}(2,0)\ +\ \mbox{\hyperlink{_angle_axis__mimic__euler_8cpp_ab3cd915d758008bd19d0f2428fbb354a}{m}}(1,1)*\mbox{\hyperlink{_angle_axis__mimic__euler_8cpp_ab3cd915d758008bd19d0f2428fbb354a}{m}}(2,2)\ -\/\ \mbox{\hyperlink{_angle_axis__mimic__euler_8cpp_ab3cd915d758008bd19d0f2428fbb354a}{m}}(2,1)*\mbox{\hyperlink{_angle_axis__mimic__euler_8cpp_ab3cd915d758008bd19d0f2428fbb354a}{m}}(2,1);}
\DoxyCodeLine{00581\ \ \ \ \ \mbox{\hyperlink{struct_eigen_1_1internal_1_1direct__selfadjoint__eigenvalues_3_01_solver_type_00_013_00_01false_01_4_a3e0e253654e2bbdada60c064e3178bb8}{Scalar}}\ c2\ =\ \mbox{\hyperlink{_angle_axis__mimic__euler_8cpp_ab3cd915d758008bd19d0f2428fbb354a}{m}}(0,0)\ +\ \mbox{\hyperlink{_angle_axis__mimic__euler_8cpp_ab3cd915d758008bd19d0f2428fbb354a}{m}}(1,1)\ +\ \mbox{\hyperlink{_angle_axis__mimic__euler_8cpp_ab3cd915d758008bd19d0f2428fbb354a}{m}}(2,2);}
\DoxyCodeLine{00582\ }
\DoxyCodeLine{00583\ \ \ \ \ \textcolor{comment}{//\ Construct\ the\ parameters\ used\ in\ classifying\ the\ roots\ of\ the\ equation}}
\DoxyCodeLine{00584\ \ \ \ \ \textcolor{comment}{//\ and\ in\ solving\ the\ equation\ for\ the\ roots\ in\ closed\ form.}}
\DoxyCodeLine{00585\ \ \ \ \ \mbox{\hyperlink{struct_eigen_1_1internal_1_1direct__selfadjoint__eigenvalues_3_01_solver_type_00_013_00_01false_01_4_a3e0e253654e2bbdada60c064e3178bb8}{Scalar}}\ c2\_over\_3\ =\ c2*s\_inv3;}
\DoxyCodeLine{00586\ \ \ \ \ \mbox{\hyperlink{struct_eigen_1_1internal_1_1direct__selfadjoint__eigenvalues_3_01_solver_type_00_013_00_01false_01_4_a3e0e253654e2bbdada60c064e3178bb8}{Scalar}}\ a\_over\_3\ =\ (c2*c2\_over\_3\ -\/\ c1)*s\_inv3;}
\DoxyCodeLine{00587\ \ \ \ \ a\_over\_3\ =\ \mbox{\hyperlink{namespace_eigen_1_1numext_a29d502349f2ec9897c808e65e0f96eb4}{numext::maxi}}(a\_over\_3,\ \mbox{\hyperlink{bench__gemm_8cpp_a052eb942d12b6404aade6fae4b075fb9}{Scalar}}(0));}
\DoxyCodeLine{00588\ }
\DoxyCodeLine{00589\ \ \ \ \ \mbox{\hyperlink{struct_eigen_1_1internal_1_1direct__selfadjoint__eigenvalues_3_01_solver_type_00_013_00_01false_01_4_a3e0e253654e2bbdada60c064e3178bb8}{Scalar}}\ half\_b\ =\ \mbox{\hyperlink{bench__gemm_8cpp_a052eb942d12b6404aade6fae4b075fb9}{Scalar}}(0.5)*(c0\ +\ c2\_over\_3*(\mbox{\hyperlink{bench__gemm_8cpp_a052eb942d12b6404aade6fae4b075fb9}{Scalar}}(2)*c2\_over\_3*c2\_over\_3\ -\/\ c1));}
\DoxyCodeLine{00590\ }
\DoxyCodeLine{00591\ \ \ \ \ \mbox{\hyperlink{struct_eigen_1_1internal_1_1direct__selfadjoint__eigenvalues_3_01_solver_type_00_013_00_01false_01_4_a3e0e253654e2bbdada60c064e3178bb8}{Scalar}}\ \mbox{\hyperlink{som__graph_8cpp_ae900b2add8deca663438fb20de69acce}{q}}\ =\ a\_over\_3*a\_over\_3*a\_over\_3\ -\/\ half\_b*half\_b;}
\DoxyCodeLine{00592\ \ \ \ \ \mbox{\hyperlink{som__graph_8cpp_ae900b2add8deca663438fb20de69acce}{q}}\ =\ \mbox{\hyperlink{namespace_eigen_1_1numext_a29d502349f2ec9897c808e65e0f96eb4}{numext::maxi}}(\mbox{\hyperlink{som__graph_8cpp_ae900b2add8deca663438fb20de69acce}{q}},\ \mbox{\hyperlink{bench__gemm_8cpp_a052eb942d12b6404aade6fae4b075fb9}{Scalar}}(0));}
\DoxyCodeLine{00593\ }
\DoxyCodeLine{00594\ \ \ \ \ \textcolor{comment}{//\ Compute\ the\ eigenvalues\ by\ solving\ for\ the\ roots\ of\ the\ polynomial.}}
\DoxyCodeLine{00595\ \ \ \ \ \mbox{\hyperlink{struct_eigen_1_1internal_1_1direct__selfadjoint__eigenvalues_3_01_solver_type_00_013_00_01false_01_4_a3e0e253654e2bbdada60c064e3178bb8}{Scalar}}\ rho\ =\ \mbox{\hyperlink{_array_cwise_unary_ops_8h_a656b9217a2fcb6de59dc8d1eb3079cc7}{sqrt}}(a\_over\_3);}
\DoxyCodeLine{00596\ \ \ \ \ \mbox{\hyperlink{struct_eigen_1_1internal_1_1direct__selfadjoint__eigenvalues_3_01_solver_type_00_013_00_01false_01_4_a3e0e253654e2bbdada60c064e3178bb8}{Scalar}}\ theta\ =\ \mbox{\hyperlink{namespace_eigen_aabbac4a376874ce85e22f24da1845008}{atan2}}(\mbox{\hyperlink{_array_cwise_unary_ops_8h_a656b9217a2fcb6de59dc8d1eb3079cc7}{sqrt}}(\mbox{\hyperlink{som__graph_8cpp_ae900b2add8deca663438fb20de69acce}{q}}),half\_b)*s\_inv3;\ \ \textcolor{comment}{//\ since\ sqrt(q)\ >\ 0,\ atan2\ is\ in\ [0,\ pi]\ and\ theta\ is\ in\ [0,\ pi/3]}}
\DoxyCodeLine{00597\ \ \ \ \ \mbox{\hyperlink{struct_eigen_1_1internal_1_1direct__selfadjoint__eigenvalues_3_01_solver_type_00_013_00_01false_01_4_a3e0e253654e2bbdada60c064e3178bb8}{Scalar}}\ cos\_theta\ =\ \mbox{\hyperlink{_array_cwise_unary_ops_8h_a92b03396990b0e9eea0731aa406e31a4}{cos}}(theta);}
\DoxyCodeLine{00598\ \ \ \ \ \mbox{\hyperlink{struct_eigen_1_1internal_1_1direct__selfadjoint__eigenvalues_3_01_solver_type_00_013_00_01false_01_4_a3e0e253654e2bbdada60c064e3178bb8}{Scalar}}\ sin\_theta\ =\ \mbox{\hyperlink{_array_cwise_unary_ops_8h_a9cfb0ea58bd813510a9e2db18a5e49f0}{sin}}(theta);}
\DoxyCodeLine{00599\ \ \ \ \ \textcolor{comment}{//\ roots\ are\ already\ sorted,\ since\ cos\ is\ monotonically\ decreasing\ on\ [0,\ pi]}}
\DoxyCodeLine{00600\ \ \ \ \ roots(0)\ =\ c2\_over\_3\ -\/\ rho*(cos\_theta\ +\ s\_sqrt3*sin\_theta);\ \textcolor{comment}{//\ ==\ 2*rho*cos(theta+2pi/3)}}
\DoxyCodeLine{00601\ \ \ \ \ roots(1)\ =\ c2\_over\_3\ -\/\ rho*(cos\_theta\ -\/\ s\_sqrt3*sin\_theta);\ \textcolor{comment}{//\ ==\ 2*rho*cos(theta+\ pi/3)}}
\DoxyCodeLine{00602\ \ \ \ \ roots(2)\ =\ c2\_over\_3\ +\ \mbox{\hyperlink{bench__gemm_8cpp_a052eb942d12b6404aade6fae4b075fb9}{Scalar}}(2)*rho*cos\_theta;}
\DoxyCodeLine{00603\ \ \ \}}
\DoxyCodeLine{00604\ }
\DoxyCodeLine{00605\ \ \ EIGEN\_DEVICE\_FUNC}
\DoxyCodeLine{00606\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1direct__selfadjoint__eigenvalues_3_01_solver_type_00_013_00_01false_01_4_acd33edc4fec6df2b006ffcdd610f0a3b}{extract\_kernel}}(\mbox{\hyperlink{struct_eigen_1_1internal_1_1direct__selfadjoint__eigenvalues_3_01_solver_type_00_013_00_01false_01_4_a91212db992185b6ee3909be97d545ca4}{MatrixType}}\&\ \mbox{\hyperlink{_tutorial___advanced_initialization___comma_temporary_8cpp_a5d2ded7a4c8830608d7b218f5f27c0a0}{mat}},\ \mbox{\hyperlink{class_eigen_1_1_ref}{Ref<VectorType>}}\ \mbox{\hyperlink{_partial_redux__count_8cpp_acbe60897559b79afc28b79b0687b5f29}{res}},\ \mbox{\hyperlink{class_eigen_1_1_ref}{Ref<VectorType>}}\ representative)}
\DoxyCodeLine{00607\ \ \ \{}
\DoxyCodeLine{00608\ \ \ \ \ \textcolor{keyword}{using\ }std::abs;}
\DoxyCodeLine{00609\ \ \ \ \ \mbox{\hyperlink{struct_eigen_1_1internal_1_1traits}{Index}}\ i0;}
\DoxyCodeLine{00610\ \ \ \ \ \textcolor{comment}{//\ Find\ non-\/zero\ column\ i0\ (by\ construction,\ there\ must\ exist\ a\ non\ zero\ coefficient\ on\ the\ diagonal):}}
\DoxyCodeLine{00611\ \ \ \ \ \mbox{\hyperlink{_tutorial___advanced_initialization___comma_temporary_8cpp_a5d2ded7a4c8830608d7b218f5f27c0a0}{mat}}.diagonal().cwiseAbs().maxCoeff(\&i0);}
\DoxyCodeLine{00612\ \ \ \ \ \textcolor{comment}{//\ mat.col(i0)\ is\ a\ good\ candidate\ for\ an\ orthogonal\ vector\ to\ the\ current\ eigenvector,}}
\DoxyCodeLine{00613\ \ \ \ \ \textcolor{comment}{//\ so\ let's\ save\ it:}}
\DoxyCodeLine{00614\ \ \ \ \ representative\ =\ \mbox{\hyperlink{_tutorial___advanced_initialization___comma_temporary_8cpp_a5d2ded7a4c8830608d7b218f5f27c0a0}{mat}}.col(i0);}
\DoxyCodeLine{00615\ \ \ \ \ \mbox{\hyperlink{struct_eigen_1_1internal_1_1direct__selfadjoint__eigenvalues_3_01_solver_type_00_013_00_01false_01_4_a3e0e253654e2bbdada60c064e3178bb8}{Scalar}}\ n0,\ n1;}
\DoxyCodeLine{00616\ \ \ \ \ \mbox{\hyperlink{struct_eigen_1_1internal_1_1direct__selfadjoint__eigenvalues_3_01_solver_type_00_013_00_01false_01_4_a1a9f066507f5261a9facab5b21b28682}{VectorType}}\ c0,\ c1;}
\DoxyCodeLine{00617\ \ \ \ \ n0\ =\ (c0\ =\ representative.cross(\mbox{\hyperlink{_tutorial___advanced_initialization___comma_temporary_8cpp_a5d2ded7a4c8830608d7b218f5f27c0a0}{mat}}.col((i0+1)\%3))).squaredNorm();}
\DoxyCodeLine{00618\ \ \ \ \ n1\ =\ (c1\ =\ representative.cross(\mbox{\hyperlink{_tutorial___advanced_initialization___comma_temporary_8cpp_a5d2ded7a4c8830608d7b218f5f27c0a0}{mat}}.col((i0+2)\%3))).squaredNorm();}
\DoxyCodeLine{00619\ \ \ \ \ \textcolor{keywordflow}{if}(n0>n1)\ \mbox{\hyperlink{_partial_redux__count_8cpp_acbe60897559b79afc28b79b0687b5f29}{res}}\ =\ c0/std::sqrt(n0);}
\DoxyCodeLine{00620\ \ \ \ \ \textcolor{keywordflow}{else}\ \ \ \ \ \ \mbox{\hyperlink{_partial_redux__count_8cpp_acbe60897559b79afc28b79b0687b5f29}{res}}\ =\ c1/std::sqrt(n1);}
\DoxyCodeLine{00621\ }
\DoxyCodeLine{00622\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00623\ \ \ \}}
\DoxyCodeLine{00624\ }
\DoxyCodeLine{00625\ \ \ EIGEN\_DEVICE\_FUNC}
\DoxyCodeLine{00626\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1direct__selfadjoint__eigenvalues_3_01_solver_type_00_013_00_01false_01_4_a9bba7b5bd5aeb6d3ede0cd70ed18f231}{run}}(SolverType\&\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a209feb53f749fbb1b8caa36d3ee85979}{solver}},\ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1direct__selfadjoint__eigenvalues_3_01_solver_type_00_013_00_01false_01_4_a91212db992185b6ee3909be97d545ca4}{MatrixType}}\&\ \mbox{\hyperlink{_tutorial___advanced_initialization___comma_temporary_8cpp_a5d2ded7a4c8830608d7b218f5f27c0a0}{mat}},\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{options_8c_a92a8d2cc6467e45662af606615851df8}{options}})}
\DoxyCodeLine{00627\ \ \ \{}
\DoxyCodeLine{00628\ \ \ \ \ \mbox{\hyperlink{eigen-3_83_87_2_eigen_2src_2_core_2util_2_macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(\mbox{\hyperlink{_tutorial___advanced_initialization___comma_temporary_8cpp_a5d2ded7a4c8830608d7b218f5f27c0a0}{mat}}.cols()\ ==\ 3\ \&\&\ \mbox{\hyperlink{_tutorial___advanced_initialization___comma_temporary_8cpp_a5d2ded7a4c8830608d7b218f5f27c0a0}{mat}}.cols()\ ==\ \mbox{\hyperlink{_tutorial___advanced_initialization___comma_temporary_8cpp_a5d2ded7a4c8830608d7b218f5f27c0a0}{mat}}.rows());}
\DoxyCodeLine{00629\ \ \ \ \ \mbox{\hyperlink{eigen-3_83_87_2_eigen_2src_2_core_2util_2_macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}((\mbox{\hyperlink{options_8c_a92a8d2cc6467e45662af606615851df8}{options}}\&\string~(\mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a58b2e52b6b46818217f67d2b38ee90e3}{EigVecMask}}|\mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a2cd73a7e08a5f26915a562a7f88c6465}{GenEigMask}}))==0}
\DoxyCodeLine{00630\ \ \ \ \ \ \ \ \ \ \ \ \ \&\&\ (\mbox{\hyperlink{options_8c_a92a8d2cc6467e45662af606615851df8}{options}}\&\mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a58b2e52b6b46818217f67d2b38ee90e3}{EigVecMask}})!=\mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a58b2e52b6b46818217f67d2b38ee90e3}{EigVecMask}}}
\DoxyCodeLine{00631\ \ \ \ \ \ \ \ \ \ \ \ \ \&\&\ \textcolor{stringliteral}{"{}invalid\ option\ parameter"{}});}
\DoxyCodeLine{00632\ \ \ \ \ \textcolor{keywordtype}{bool}\ computeEigenvectors\ =\ (\mbox{\hyperlink{options_8c_a92a8d2cc6467e45662af606615851df8}{options}}\&\mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a7f7d17fba3c9bb92158e346d5979d0f4}{ComputeEigenvectors}})==\mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a7f7d17fba3c9bb92158e346d5979d0f4}{ComputeEigenvectors}};}
\DoxyCodeLine{00633\ \ \ \ \ }
\DoxyCodeLine{00634\ \ \ \ \ \mbox{\hyperlink{struct_eigen_1_1internal_1_1direct__selfadjoint__eigenvalues_3_01_solver_type_00_013_00_01false_01_4_a871dcddc6a2eccca1440ce2e4ed62b63}{EigenvectorsType}}\&\ eivecs\ =\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a209feb53f749fbb1b8caa36d3ee85979}{solver}}.m\_eivec;}
\DoxyCodeLine{00635\ \ \ \ \ \mbox{\hyperlink{struct_eigen_1_1internal_1_1direct__selfadjoint__eigenvalues_3_01_solver_type_00_013_00_01false_01_4_a1a9f066507f5261a9facab5b21b28682}{VectorType}}\&\ \mbox{\hyperlink{_matrix_base__eigenvalues_8cpp_a012f8ea8c5ace568b775c1d04de1233d}{eivals}}\ =\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a209feb53f749fbb1b8caa36d3ee85979}{solver}}.m\_eivalues;}
\DoxyCodeLine{00636\ \ \ }
\DoxyCodeLine{00637\ \ \ \ \ \textcolor{comment}{//\ Shift\ the\ matrix\ to\ the\ mean\ eigenvalue\ and\ map\ the\ matrix\ coefficients\ to\ [-\/1:1]\ to\ avoid\ over-\/\ and\ underflow.}}
\DoxyCodeLine{00638\ \ \ \ \ \mbox{\hyperlink{struct_eigen_1_1internal_1_1direct__selfadjoint__eigenvalues_3_01_solver_type_00_013_00_01false_01_4_a3e0e253654e2bbdada60c064e3178bb8}{Scalar}}\ shift\ =\ \mbox{\hyperlink{_tutorial___advanced_initialization___comma_temporary_8cpp_a5d2ded7a4c8830608d7b218f5f27c0a0}{mat}}.trace()\ /\ \mbox{\hyperlink{bench__gemm_8cpp_a052eb942d12b6404aade6fae4b075fb9}{Scalar}}(3);}
\DoxyCodeLine{00639\ \ \ \ \ \textcolor{comment}{//\ TODO\ Avoid\ this\ copy.\ Currently\ it\ is\ necessary\ to\ suppress\ bogus\ values\ when\ determining\ maxCoeff\ and\ for\ computing\ the\ eigenvectors\ later}}
\DoxyCodeLine{00640\ \ \ \ \ \mbox{\hyperlink{struct_eigen_1_1internal_1_1direct__selfadjoint__eigenvalues_3_01_solver_type_00_013_00_01false_01_4_a91212db992185b6ee3909be97d545ca4}{MatrixType}}\ scaledMat\ =\ \mbox{\hyperlink{_tutorial___advanced_initialization___comma_temporary_8cpp_a5d2ded7a4c8830608d7b218f5f27c0a0}{mat}}.template\ selfadjointView<Lower>();}
\DoxyCodeLine{00641\ \ \ \ \ scaledMat.diagonal().array()\ -\/=\ shift;}
\DoxyCodeLine{00642\ \ \ \ \ \mbox{\hyperlink{struct_eigen_1_1internal_1_1direct__selfadjoint__eigenvalues_3_01_solver_type_00_013_00_01false_01_4_a3e0e253654e2bbdada60c064e3178bb8}{Scalar}}\ \mbox{\hyperlink{gnuplot__common__settings_8hh_a028be1055fb10c679b6153f8dcd0befa}{scale}}\ =\ scaledMat.cwiseAbs().maxCoeff();}
\DoxyCodeLine{00643\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{gnuplot__common__settings_8hh_a028be1055fb10c679b6153f8dcd0befa}{scale}}\ >\ 0)\ scaledMat\ /=\ \mbox{\hyperlink{gnuplot__common__settings_8hh_a028be1055fb10c679b6153f8dcd0befa}{scale}};\ \ \ \textcolor{comment}{//\ TODO\ for\ scale==0\ we\ could\ save\ the\ remaining\ operations}}
\DoxyCodeLine{00644\ }
\DoxyCodeLine{00645\ \ \ \ \ \textcolor{comment}{//\ compute\ the\ eigenvalues}}
\DoxyCodeLine{00646\ \ \ \ \ \mbox{\hyperlink{eig33_8cpp_a9b30d5945effb5111b5c9d18c4c241ee}{computeRoots}}(scaledMat,\mbox{\hyperlink{_matrix_base__eigenvalues_8cpp_a012f8ea8c5ace568b775c1d04de1233d}{eivals}});}
\DoxyCodeLine{00647\ }
\DoxyCodeLine{00648\ \ \ \ \ \textcolor{comment}{//\ compute\ the\ eigenvectors}}
\DoxyCodeLine{00649\ \ \ \ \ \textcolor{keywordflow}{if}(computeEigenvectors)}
\DoxyCodeLine{00650\ \ \ \ \ \{}
\DoxyCodeLine{00651\ \ \ \ \ \ \ \textcolor{keywordflow}{if}((\mbox{\hyperlink{_matrix_base__eigenvalues_8cpp_a012f8ea8c5ace568b775c1d04de1233d}{eivals}}(2)-\/\mbox{\hyperlink{_matrix_base__eigenvalues_8cpp_a012f8ea8c5ace568b775c1d04de1233d}{eivals}}(0))<=\mbox{\hyperlink{struct_eigen_1_1_generic_num_traits_aadcf7fa75b2bc9a0e461a3b851d836a7}{Eigen::NumTraits<Scalar>::epsilon}}())}
\DoxyCodeLine{00652\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00653\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ All\ three\ eigenvalues\ are\ numerically\ the\ same}}
\DoxyCodeLine{00654\ \ \ \ \ \ \ \ \ eivecs.setIdentity();}
\DoxyCodeLine{00655\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00656\ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00657\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00658\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_eigen_1_1internal_1_1direct__selfadjoint__eigenvalues_3_01_solver_type_00_013_00_01false_01_4_a91212db992185b6ee3909be97d545ca4}{MatrixType}}\ tmp;}
\DoxyCodeLine{00659\ \ \ \ \ \ \ \ \ tmp\ =\ scaledMat;}
\DoxyCodeLine{00660\ }
\DoxyCodeLine{00661\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Compute\ the\ eigenvector\ of\ the\ most\ distinct\ eigenvalue}}
\DoxyCodeLine{00662\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_eigen_1_1internal_1_1direct__selfadjoint__eigenvalues_3_01_solver_type_00_013_00_01false_01_4_a3e0e253654e2bbdada60c064e3178bb8}{Scalar}}\ \mbox{\hyperlink{modp__b64__data_8h_a8152b5f844816c2baf91413706cbfc13}{d0}}\ =\ \mbox{\hyperlink{_matrix_base__eigenvalues_8cpp_a012f8ea8c5ace568b775c1d04de1233d}{eivals}}(2)\ -\/\ \mbox{\hyperlink{_matrix_base__eigenvalues_8cpp_a012f8ea8c5ace568b775c1d04de1233d}{eivals}}(1);}
\DoxyCodeLine{00663\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_eigen_1_1internal_1_1direct__selfadjoint__eigenvalues_3_01_solver_type_00_013_00_01false_01_4_a3e0e253654e2bbdada60c064e3178bb8}{Scalar}}\ \mbox{\hyperlink{modp__b64__data_8h_a248a83e479c6e2c404b65827fb26bbe2}{d1}}\ =\ \mbox{\hyperlink{_matrix_base__eigenvalues_8cpp_a012f8ea8c5ace568b775c1d04de1233d}{eivals}}(1)\ -\/\ \mbox{\hyperlink{_matrix_base__eigenvalues_8cpp_a012f8ea8c5ace568b775c1d04de1233d}{eivals}}(0);}
\DoxyCodeLine{00664\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_eigen_1_1internal_1_1traits}{Index}}\ k(0),\ l(2);}
\DoxyCodeLine{00665\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{modp__b64__data_8h_a8152b5f844816c2baf91413706cbfc13}{d0}}\ >\ \mbox{\hyperlink{modp__b64__data_8h_a248a83e479c6e2c404b65827fb26bbe2}{d1}})}
\DoxyCodeLine{00666\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00667\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_eigen_1_1numext_a3b617b6220683f86218071c40c41d381}{numext::swap}}(k,l);}
\DoxyCodeLine{00668\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{modp__b64__data_8h_a8152b5f844816c2baf91413706cbfc13}{d0}}\ =\ \mbox{\hyperlink{modp__b64__data_8h_a248a83e479c6e2c404b65827fb26bbe2}{d1}};}
\DoxyCodeLine{00669\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00670\ }
\DoxyCodeLine{00671\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Compute\ the\ eigenvector\ of\ index\ k}}
\DoxyCodeLine{00672\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00673\ \ \ \ \ \ \ \ \ \ \ tmp.diagonal().array\ ()\ -\/=\ \mbox{\hyperlink{_matrix_base__eigenvalues_8cpp_a012f8ea8c5ace568b775c1d04de1233d}{eivals}}(k);}
\DoxyCodeLine{00674\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ By\ construction,\ 'tmp'\ is\ of\ rank\ 2,\ and\ its\ kernel\ corresponds\ to\ the\ respective\ eigenvector.}}
\DoxyCodeLine{00675\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_eigen_1_1internal_1_1direct__selfadjoint__eigenvalues_3_01_solver_type_00_013_00_01false_01_4_acd33edc4fec6df2b006ffcdd610f0a3b}{extract\_kernel}}(tmp,\ eivecs.col(k),\ eivecs.col(l));}
\DoxyCodeLine{00676\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00677\ }
\DoxyCodeLine{00678\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Compute\ eigenvector\ of\ index\ l}}
\DoxyCodeLine{00679\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{modp__b64__data_8h_a8152b5f844816c2baf91413706cbfc13}{d0}}<=2*\mbox{\hyperlink{struct_eigen_1_1_generic_num_traits_aadcf7fa75b2bc9a0e461a3b851d836a7}{Eigen::NumTraits<Scalar>::epsilon}}()*\mbox{\hyperlink{modp__b64__data_8h_a248a83e479c6e2c404b65827fb26bbe2}{d1}})}
\DoxyCodeLine{00680\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00681\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ If\ d0\ is\ too\ small,\ then\ the\ two\ other\ eigenvalues\ are\ numerically\ the\ same,}}
\DoxyCodeLine{00682\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ and\ thus\ we\ only\ have\ to\ ortho-\/normalize\ the\ near\ orthogonal\ vector\ we\ saved\ above.}}
\DoxyCodeLine{00683\ \ \ \ \ \ \ \ \ \ \ eivecs.col(l)\ -\/=\ eivecs.col(k).dot(eivecs.col(l))*eivecs.col(l);}
\DoxyCodeLine{00684\ \ \ \ \ \ \ \ \ \ \ eivecs.col(l).normalize();}
\DoxyCodeLine{00685\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00686\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00687\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00688\ \ \ \ \ \ \ \ \ \ \ tmp\ =\ scaledMat;}
\DoxyCodeLine{00689\ \ \ \ \ \ \ \ \ \ \ tmp.diagonal().array\ ()\ -\/=\ \mbox{\hyperlink{_matrix_base__eigenvalues_8cpp_a012f8ea8c5ace568b775c1d04de1233d}{eivals}}(l);}
\DoxyCodeLine{00690\ }
\DoxyCodeLine{00691\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_eigen_1_1internal_1_1direct__selfadjoint__eigenvalues_3_01_solver_type_00_013_00_01false_01_4_a1a9f066507f5261a9facab5b21b28682}{VectorType}}\ dummy;}
\DoxyCodeLine{00692\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_eigen_1_1internal_1_1direct__selfadjoint__eigenvalues_3_01_solver_type_00_013_00_01false_01_4_acd33edc4fec6df2b006ffcdd610f0a3b}{extract\_kernel}}(tmp,\ eivecs.col(l),\ dummy);}
\DoxyCodeLine{00693\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00694\ }
\DoxyCodeLine{00695\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Compute\ last\ eigenvector\ from\ the\ other\ two}}
\DoxyCodeLine{00696\ \ \ \ \ \ \ \ \ eivecs.col(1)\ =\ eivecs.col(2).cross(eivecs.col(0)).normalized();}
\DoxyCodeLine{00697\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00698\ \ \ \ \ \}}
\DoxyCodeLine{00699\ }
\DoxyCodeLine{00700\ \ \ \ \ \textcolor{comment}{//\ Rescale\ back\ to\ the\ original\ size.}}
\DoxyCodeLine{00701\ \ \ \ \ \mbox{\hyperlink{_matrix_base__eigenvalues_8cpp_a012f8ea8c5ace568b775c1d04de1233d}{eivals}}\ *=\ \mbox{\hyperlink{gnuplot__common__settings_8hh_a028be1055fb10c679b6153f8dcd0befa}{scale}};}
\DoxyCodeLine{00702\ \ \ \ \ \mbox{\hyperlink{_matrix_base__eigenvalues_8cpp_a012f8ea8c5ace568b775c1d04de1233d}{eivals}}.array()\ +=\ shift;}
\DoxyCodeLine{00703\ \ \ \ \ }
\DoxyCodeLine{00704\ \ \ \ \ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a209feb53f749fbb1b8caa36d3ee85979}{solver}}.m\_info\ =\ \mbox{\hyperlink{group__enums_gga85fad7b87587764e5cf6b513a9e0ee5ea671a2aeb0f527802806a441d58a80fcf}{Success}};}
\DoxyCodeLine{00705\ \ \ \ \ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a209feb53f749fbb1b8caa36d3ee85979}{solver}}.m\_isInitialized\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00706\ \ \ \ \ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a209feb53f749fbb1b8caa36d3ee85979}{solver}}.m\_eigenvectorsOk\ =\ computeEigenvectors;}
\DoxyCodeLine{00707\ \ \ \}}
\DoxyCodeLine{00708\ \};}
\DoxyCodeLine{00709\ }
\DoxyCodeLine{00710\ \textcolor{comment}{//\ 2x2\ direct\ eigenvalues\ decomposition,\ code\ from\ Hauke\ Heibel}}
\DoxyCodeLine{00711\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ SolverType>\ }
\DoxyCodeLine{00712\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_eigen_1_1internal_1_1direct__selfadjoint__eigenvalues}{direct\_selfadjoint\_eigenvalues}}<SolverType,2,\mbox{\hyperlink{yyjson_8h_a65e9886d74aaee76545e83dd09011727}{false}}>}
\DoxyCodeLine{00713\ \{}
\DoxyCodeLine{00714\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ SolverType::MatrixType\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1direct__selfadjoint__eigenvalues_3_01_solver_type_00_012_00_01false_01_4_ad4737401b97adbb299ab4e64d5a13b79}{MatrixType}};}
\DoxyCodeLine{00715\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ SolverType::RealVectorType\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1direct__selfadjoint__eigenvalues_3_01_solver_type_00_012_00_01false_01_4_a9a515dab7880b222aff4847641c40ed2}{VectorType}};}
\DoxyCodeLine{00716\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ SolverType::Scalar\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1direct__selfadjoint__eigenvalues_3_01_solver_type_00_012_00_01false_01_4_a8494659a9d6ef5917f2b9063808b9214}{Scalar}};}
\DoxyCodeLine{00717\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ SolverType::EigenvectorsType\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1direct__selfadjoint__eigenvalues_3_01_solver_type_00_012_00_01false_01_4_ab88affec1ba41f7662e263fa86102255}{EigenvectorsType}};}
\DoxyCodeLine{00718\ \ \ }
\DoxyCodeLine{00719\ \ \ EIGEN\_DEVICE\_FUNC}
\DoxyCodeLine{00720\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1direct__selfadjoint__eigenvalues_3_01_solver_type_00_012_00_01false_01_4_a49dab7c21eb393c3c3d45890bd34f58e}{computeRoots}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1direct__selfadjoint__eigenvalues_3_01_solver_type_00_012_00_01false_01_4_ad4737401b97adbb299ab4e64d5a13b79}{MatrixType}}\&\ \mbox{\hyperlink{_angle_axis__mimic__euler_8cpp_ab3cd915d758008bd19d0f2428fbb354a}{m}},\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1direct__selfadjoint__eigenvalues_3_01_solver_type_00_012_00_01false_01_4_a9a515dab7880b222aff4847641c40ed2}{VectorType}}\&\ roots)}
\DoxyCodeLine{00721\ \ \ \{}
\DoxyCodeLine{00722\ \ \ \ \ \textcolor{keyword}{using\ }std::sqrt;}
\DoxyCodeLine{00723\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1direct__selfadjoint__eigenvalues_3_01_solver_type_00_012_00_01false_01_4_a8494659a9d6ef5917f2b9063808b9214}{Scalar}}\ \mbox{\hyperlink{dining__philosophers_8cpp_acaabb53c59c5d280a13be2cf359335a9}{t0}}\ =\ \mbox{\hyperlink{bench__gemm_8cpp_a052eb942d12b6404aade6fae4b075fb9}{Scalar}}(0.5)\ *\ \mbox{\hyperlink{_array_cwise_unary_ops_8h_a656b9217a2fcb6de59dc8d1eb3079cc7}{sqrt}}(\ numext::abs2(\mbox{\hyperlink{_angle_axis__mimic__euler_8cpp_ab3cd915d758008bd19d0f2428fbb354a}{m}}(0,0)-\/\mbox{\hyperlink{_angle_axis__mimic__euler_8cpp_ab3cd915d758008bd19d0f2428fbb354a}{m}}(1,1))\ +\ \mbox{\hyperlink{bench__gemm_8cpp_a052eb942d12b6404aade6fae4b075fb9}{Scalar}}(4)*numext::abs2(\mbox{\hyperlink{_angle_axis__mimic__euler_8cpp_ab3cd915d758008bd19d0f2428fbb354a}{m}}(1,0)));}
\DoxyCodeLine{00724\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1direct__selfadjoint__eigenvalues_3_01_solver_type_00_012_00_01false_01_4_a8494659a9d6ef5917f2b9063808b9214}{Scalar}}\ t1\ =\ \mbox{\hyperlink{bench__gemm_8cpp_a052eb942d12b6404aade6fae4b075fb9}{Scalar}}(0.5)\ *\ (\mbox{\hyperlink{_angle_axis__mimic__euler_8cpp_ab3cd915d758008bd19d0f2428fbb354a}{m}}(0,0)\ +\ \mbox{\hyperlink{_angle_axis__mimic__euler_8cpp_ab3cd915d758008bd19d0f2428fbb354a}{m}}(1,1));}
\DoxyCodeLine{00725\ \ \ \ \ roots(0)\ =\ t1\ -\/\ \mbox{\hyperlink{dining__philosophers_8cpp_acaabb53c59c5d280a13be2cf359335a9}{t0}};}
\DoxyCodeLine{00726\ \ \ \ \ roots(1)\ =\ t1\ +\ \mbox{\hyperlink{dining__philosophers_8cpp_acaabb53c59c5d280a13be2cf359335a9}{t0}};}
\DoxyCodeLine{00727\ \ \ \}}
\DoxyCodeLine{00728\ \ \ }
\DoxyCodeLine{00729\ \ \ EIGEN\_DEVICE\_FUNC}
\DoxyCodeLine{00730\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1direct__selfadjoint__eigenvalues_3_01_solver_type_00_012_00_01false_01_4_addc88bfeaab72fc09c5429df3d680bd7}{run}}(SolverType\&\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a209feb53f749fbb1b8caa36d3ee85979}{solver}},\ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1direct__selfadjoint__eigenvalues_3_01_solver_type_00_012_00_01false_01_4_ad4737401b97adbb299ab4e64d5a13b79}{MatrixType}}\&\ \mbox{\hyperlink{_tutorial___advanced_initialization___comma_temporary_8cpp_a5d2ded7a4c8830608d7b218f5f27c0a0}{mat}},\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{options_8c_a92a8d2cc6467e45662af606615851df8}{options}})}
\DoxyCodeLine{00731\ \ \ \{}
\DoxyCodeLine{00732\ \ \ \ \ EIGEN\_USING\_STD\_MATH(\mbox{\hyperlink{_array_cwise_unary_ops_8h_a656b9217a2fcb6de59dc8d1eb3079cc7}{sqrt}});}
\DoxyCodeLine{00733\ \ \ \ \ EIGEN\_USING\_STD\_MATH(\mbox{\hyperlink{datatypes_8h_a3aa069ac3980707dae1e0530f50d59e4}{abs}});}
\DoxyCodeLine{00734\ \ \ \ \ }
\DoxyCodeLine{00735\ \ \ \ \ \mbox{\hyperlink{eigen-3_83_87_2_eigen_2src_2_core_2util_2_macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(\mbox{\hyperlink{_tutorial___advanced_initialization___comma_temporary_8cpp_a5d2ded7a4c8830608d7b218f5f27c0a0}{mat}}.cols()\ ==\ 2\ \&\&\ \mbox{\hyperlink{_tutorial___advanced_initialization___comma_temporary_8cpp_a5d2ded7a4c8830608d7b218f5f27c0a0}{mat}}.cols()\ ==\ \mbox{\hyperlink{_tutorial___advanced_initialization___comma_temporary_8cpp_a5d2ded7a4c8830608d7b218f5f27c0a0}{mat}}.rows());}
\DoxyCodeLine{00736\ \ \ \ \ \mbox{\hyperlink{eigen-3_83_87_2_eigen_2src_2_core_2util_2_macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}((\mbox{\hyperlink{options_8c_a92a8d2cc6467e45662af606615851df8}{options}}\&\string~(\mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a58b2e52b6b46818217f67d2b38ee90e3}{EigVecMask}}|\mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a2cd73a7e08a5f26915a562a7f88c6465}{GenEigMask}}))==0}
\DoxyCodeLine{00737\ \ \ \ \ \ \ \ \ \ \ \ \ \&\&\ (\mbox{\hyperlink{options_8c_a92a8d2cc6467e45662af606615851df8}{options}}\&\mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a58b2e52b6b46818217f67d2b38ee90e3}{EigVecMask}})!=\mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a58b2e52b6b46818217f67d2b38ee90e3}{EigVecMask}}}
\DoxyCodeLine{00738\ \ \ \ \ \ \ \ \ \ \ \ \ \&\&\ \textcolor{stringliteral}{"{}invalid\ option\ parameter"{}});}
\DoxyCodeLine{00739\ \ \ \ \ \textcolor{keywordtype}{bool}\ computeEigenvectors\ =\ (\mbox{\hyperlink{options_8c_a92a8d2cc6467e45662af606615851df8}{options}}\&\mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a7f7d17fba3c9bb92158e346d5979d0f4}{ComputeEigenvectors}})==\mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a7f7d17fba3c9bb92158e346d5979d0f4}{ComputeEigenvectors}};}
\DoxyCodeLine{00740\ \ \ \ \ }
\DoxyCodeLine{00741\ \ \ \ \ \mbox{\hyperlink{struct_eigen_1_1internal_1_1direct__selfadjoint__eigenvalues_3_01_solver_type_00_012_00_01false_01_4_ab88affec1ba41f7662e263fa86102255}{EigenvectorsType}}\&\ eivecs\ =\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a209feb53f749fbb1b8caa36d3ee85979}{solver}}.m\_eivec;}
\DoxyCodeLine{00742\ \ \ \ \ \mbox{\hyperlink{struct_eigen_1_1internal_1_1direct__selfadjoint__eigenvalues_3_01_solver_type_00_012_00_01false_01_4_a9a515dab7880b222aff4847641c40ed2}{VectorType}}\&\ \mbox{\hyperlink{_matrix_base__eigenvalues_8cpp_a012f8ea8c5ace568b775c1d04de1233d}{eivals}}\ =\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a209feb53f749fbb1b8caa36d3ee85979}{solver}}.m\_eivalues;}
\DoxyCodeLine{00743\ \ \ }
\DoxyCodeLine{00744\ \ \ \ \ \textcolor{comment}{//\ Shift\ the\ matrix\ to\ the\ mean\ eigenvalue\ and\ map\ the\ matrix\ coefficients\ to\ [-\/1:1]\ to\ avoid\ over-\/\ and\ underflow.}}
\DoxyCodeLine{00745\ \ \ \ \ \mbox{\hyperlink{struct_eigen_1_1internal_1_1direct__selfadjoint__eigenvalues_3_01_solver_type_00_012_00_01false_01_4_a8494659a9d6ef5917f2b9063808b9214}{Scalar}}\ shift\ =\ \mbox{\hyperlink{_tutorial___advanced_initialization___comma_temporary_8cpp_a5d2ded7a4c8830608d7b218f5f27c0a0}{mat}}.trace()\ /\ \mbox{\hyperlink{bench__gemm_8cpp_a052eb942d12b6404aade6fae4b075fb9}{Scalar}}(2);}
\DoxyCodeLine{00746\ \ \ \ \ \mbox{\hyperlink{struct_eigen_1_1internal_1_1direct__selfadjoint__eigenvalues_3_01_solver_type_00_012_00_01false_01_4_ad4737401b97adbb299ab4e64d5a13b79}{MatrixType}}\ scaledMat\ =\ \mbox{\hyperlink{_tutorial___advanced_initialization___comma_temporary_8cpp_a5d2ded7a4c8830608d7b218f5f27c0a0}{mat}};}
\DoxyCodeLine{00747\ \ \ \ \ scaledMat.coeffRef(0,1)\ =\ \mbox{\hyperlink{_tutorial___advanced_initialization___comma_temporary_8cpp_a5d2ded7a4c8830608d7b218f5f27c0a0}{mat}}.coeff(1,0);}
\DoxyCodeLine{00748\ \ \ \ \ scaledMat.diagonal().array()\ -\/=\ shift;}
\DoxyCodeLine{00749\ \ \ \ \ \mbox{\hyperlink{struct_eigen_1_1internal_1_1direct__selfadjoint__eigenvalues_3_01_solver_type_00_012_00_01false_01_4_a8494659a9d6ef5917f2b9063808b9214}{Scalar}}\ \mbox{\hyperlink{gnuplot__common__settings_8hh_a028be1055fb10c679b6153f8dcd0befa}{scale}}\ =\ scaledMat.cwiseAbs().maxCoeff();}
\DoxyCodeLine{00750\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{gnuplot__common__settings_8hh_a028be1055fb10c679b6153f8dcd0befa}{scale}}\ >\ \mbox{\hyperlink{bench__gemm_8cpp_a052eb942d12b6404aade6fae4b075fb9}{Scalar}}(0))}
\DoxyCodeLine{00751\ \ \ \ \ \ \ scaledMat\ /=\ \mbox{\hyperlink{gnuplot__common__settings_8hh_a028be1055fb10c679b6153f8dcd0befa}{scale}};}
\DoxyCodeLine{00752\ }
\DoxyCodeLine{00753\ \ \ \ \ \textcolor{comment}{//\ Compute\ the\ eigenvalues}}
\DoxyCodeLine{00754\ \ \ \ \ \mbox{\hyperlink{eig33_8cpp_a9b30d5945effb5111b5c9d18c4c241ee}{computeRoots}}(scaledMat,\mbox{\hyperlink{_matrix_base__eigenvalues_8cpp_a012f8ea8c5ace568b775c1d04de1233d}{eivals}});}
\DoxyCodeLine{00755\ }
\DoxyCodeLine{00756\ \ \ \ \ \textcolor{comment}{//\ compute\ the\ eigen\ vectors}}
\DoxyCodeLine{00757\ \ \ \ \ \textcolor{keywordflow}{if}(computeEigenvectors)}
\DoxyCodeLine{00758\ \ \ \ \ \{}
\DoxyCodeLine{00759\ \ \ \ \ \ \ \textcolor{keywordflow}{if}((\mbox{\hyperlink{_matrix_base__eigenvalues_8cpp_a012f8ea8c5ace568b775c1d04de1233d}{eivals}}(1)-\/\mbox{\hyperlink{_matrix_base__eigenvalues_8cpp_a012f8ea8c5ace568b775c1d04de1233d}{eivals}}(0))<=\mbox{\hyperlink{datatypes_8h_a3aa069ac3980707dae1e0530f50d59e4}{abs}}(\mbox{\hyperlink{_matrix_base__eigenvalues_8cpp_a012f8ea8c5ace568b775c1d04de1233d}{eivals}}(1))*\mbox{\hyperlink{struct_eigen_1_1_generic_num_traits_aadcf7fa75b2bc9a0e461a3b851d836a7}{Eigen::NumTraits<Scalar>::epsilon}}())}
\DoxyCodeLine{00760\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00761\ \ \ \ \ \ \ \ \ eivecs.setIdentity();}
\DoxyCodeLine{00762\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00763\ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00764\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00765\ \ \ \ \ \ \ \ \ scaledMat.diagonal().array\ ()\ -\/=\ \mbox{\hyperlink{_matrix_base__eigenvalues_8cpp_a012f8ea8c5ace568b775c1d04de1233d}{eivals}}(1);}
\DoxyCodeLine{00766\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_eigen_1_1internal_1_1direct__selfadjoint__eigenvalues_3_01_solver_type_00_012_00_01false_01_4_a8494659a9d6ef5917f2b9063808b9214}{Scalar}}\ a2\ =\ numext::abs2(scaledMat(0,0));}
\DoxyCodeLine{00767\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_eigen_1_1internal_1_1direct__selfadjoint__eigenvalues_3_01_solver_type_00_012_00_01false_01_4_a8494659a9d6ef5917f2b9063808b9214}{Scalar}}\ c2\ =\ numext::abs2(scaledMat(1,1));}
\DoxyCodeLine{00768\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_eigen_1_1internal_1_1direct__selfadjoint__eigenvalues_3_01_solver_type_00_012_00_01false_01_4_a8494659a9d6ef5917f2b9063808b9214}{Scalar}}\ b2\ =\ numext::abs2(scaledMat(1,0));}
\DoxyCodeLine{00769\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(a2>c2)}
\DoxyCodeLine{00770\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00771\ \ \ \ \ \ \ \ \ \ \ eivecs.col(1)\ <<\ -\/scaledMat(1,0),\ scaledMat(0,0);}
\DoxyCodeLine{00772\ \ \ \ \ \ \ \ \ \ \ eivecs.col(1)\ /=\ \mbox{\hyperlink{_array_cwise_unary_ops_8h_a656b9217a2fcb6de59dc8d1eb3079cc7}{sqrt}}(a2+b2);}
\DoxyCodeLine{00773\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00774\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00775\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00776\ \ \ \ \ \ \ \ \ \ \ eivecs.col(1)\ <<\ -\/scaledMat(1,1),\ scaledMat(1,0);}
\DoxyCodeLine{00777\ \ \ \ \ \ \ \ \ \ \ eivecs.col(1)\ /=\ \mbox{\hyperlink{_array_cwise_unary_ops_8h_a656b9217a2fcb6de59dc8d1eb3079cc7}{sqrt}}(c2+b2);}
\DoxyCodeLine{00778\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00779\ }
\DoxyCodeLine{00780\ \ \ \ \ \ \ \ \ eivecs.col(0)\ <<\ eivecs.col(1).unitOrthogonal();}
\DoxyCodeLine{00781\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00782\ \ \ \ \ \}}
\DoxyCodeLine{00783\ }
\DoxyCodeLine{00784\ \ \ \ \ \textcolor{comment}{//\ Rescale\ back\ to\ the\ original\ size.}}
\DoxyCodeLine{00785\ \ \ \ \ \mbox{\hyperlink{_matrix_base__eigenvalues_8cpp_a012f8ea8c5ace568b775c1d04de1233d}{eivals}}\ *=\ \mbox{\hyperlink{gnuplot__common__settings_8hh_a028be1055fb10c679b6153f8dcd0befa}{scale}};}
\DoxyCodeLine{00786\ \ \ \ \ \mbox{\hyperlink{_matrix_base__eigenvalues_8cpp_a012f8ea8c5ace568b775c1d04de1233d}{eivals}}.array()\ +=\ shift;}
\DoxyCodeLine{00787\ }
\DoxyCodeLine{00788\ \ \ \ \ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a209feb53f749fbb1b8caa36d3ee85979}{solver}}.m\_info\ =\ \mbox{\hyperlink{group__enums_gga85fad7b87587764e5cf6b513a9e0ee5ea671a2aeb0f527802806a441d58a80fcf}{Success}};}
\DoxyCodeLine{00789\ \ \ \ \ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a209feb53f749fbb1b8caa36d3ee85979}{solver}}.m\_isInitialized\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00790\ \ \ \ \ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a209feb53f749fbb1b8caa36d3ee85979}{solver}}.m\_eigenvectorsOk\ =\ computeEigenvectors;}
\DoxyCodeLine{00791\ \ \ \}}
\DoxyCodeLine{00792\ \};}
\DoxyCodeLine{00793\ }
\DoxyCodeLine{00794\ \}}
\DoxyCodeLine{00795\ }
\DoxyCodeLine{00796\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ MatrixType>}
\DoxyCodeLine{00797\ EIGEN\_DEVICE\_FUNC}
\DoxyCodeLine{00798\ SelfAdjointEigenSolver<MatrixType>\&\ SelfAdjointEigenSolver<MatrixType>}
\DoxyCodeLine{00799\ ::computeDirect(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_self_adjoint_eigen_solver_aa8238634587d40c56228848470acb4ef}{MatrixType}}\&\ \mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}},\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{options_8c_a92a8d2cc6467e45662af606615851df8}{options}})}
\DoxyCodeLine{00800\ \{}
\DoxyCodeLine{00801\ \ \ \mbox{\hyperlink{struct_eigen_1_1internal_1_1direct__selfadjoint__eigenvalues}{internal::direct\_selfadjoint\_eigenvalues<SelfAdjointEigenSolver,Size,NumTraits<Scalar>::IsComplex}}>\mbox{\hyperlink{poisson_8cpp_ae12af222b820baf64e953be588c5bbbe}{::run}}(*\textcolor{keyword}{this},\mbox{\hyperlink{external_2taskflow_2benchmarks_2wavefront_2main_8cpp_aed60820750f2ab1bf9dd99bc0a9eaab8}{matrix}},\mbox{\hyperlink{options_8c_a92a8d2cc6467e45662af606615851df8}{options}});}
\DoxyCodeLine{00802\ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{00803\ \}}
\DoxyCodeLine{00804\ }
\DoxyCodeLine{00805\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespaceinternal}{internal}}\ \{}
\DoxyCodeLine{00806\ \textcolor{keyword}{template}<\textcolor{keywordtype}{int}\ StorageOrder,\textcolor{keyword}{typename}\ RealScalar,\ \textcolor{keyword}{typename}\ Scalar,\ \textcolor{keyword}{typename}\ Index>}
\DoxyCodeLine{00807\ EIGEN\_DEVICE\_FUNC}
\DoxyCodeLine{00808\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{namespace_eigen_1_1internal_a20ef930f01b4a88b5587832cd9f4787a}{tridiagonal\_qr\_step}}(\mbox{\hyperlink{bench__gemm_8cpp_acb5c3dc237f99cf17167e8a629f01b43}{RealScalar}}*\ diag,\ \mbox{\hyperlink{bench__gemm_8cpp_acb5c3dc237f99cf17167e8a629f01b43}{RealScalar}}*\ subdiag,\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1traits}{Index}}\ \mbox{\hyperlink{cpq__pdes_8cpp_a455a4d1d80a69762a133ad026f1cba43}{start}},\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1traits}{Index}}\ \mbox{\hyperlink{ittnotify__static_8h_a30bf4ccd4623b7a8276bbc7f99e491c7}{end}},\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1traits}{Scalar}}*\ matrixQ,\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1traits}{Index}}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}})}
\DoxyCodeLine{00809\ \{}
\DoxyCodeLine{00810\ \ \ \textcolor{keyword}{using\ }std::abs;}
\DoxyCodeLine{00811\ \ \ \mbox{\hyperlink{bench__gemm_8cpp_acb5c3dc237f99cf17167e8a629f01b43}{RealScalar}}\ td\ =\ (diag[\mbox{\hyperlink{ittnotify__static_8h_a30bf4ccd4623b7a8276bbc7f99e491c7}{end}}-\/1]\ -\/\ diag[\mbox{\hyperlink{ittnotify__static_8h_a30bf4ccd4623b7a8276bbc7f99e491c7}{end}}])*\mbox{\hyperlink{bench__gemm_8cpp_acb5c3dc237f99cf17167e8a629f01b43}{RealScalar}}(0.5);}
\DoxyCodeLine{00812\ \ \ \mbox{\hyperlink{bench__gemm_8cpp_acb5c3dc237f99cf17167e8a629f01b43}{RealScalar}}\ \mbox{\hyperlink{_cwise__array__power__array_8cpp_a9cb86ff854760bf91a154f2724a9101d}{e}}\ =\ subdiag[\mbox{\hyperlink{ittnotify__static_8h_a30bf4ccd4623b7a8276bbc7f99e491c7}{end}}-\/1];}
\DoxyCodeLine{00813\ \ \ \textcolor{comment}{//\ Note\ that\ thanks\ to\ scaling,\ e\string^2\ or\ td\string^2\ cannot\ overflow,\ however\ they\ can\ still}}
\DoxyCodeLine{00814\ \ \ \textcolor{comment}{//\ underflow\ thus\ leading\ to\ inf/NaN\ values\ when\ using\ the\ following\ commented\ code:}}
\DoxyCodeLine{00815\ \textcolor{comment}{//\ \ \ RealScalar\ e2\ =\ numext::abs2(subdiag[end-\/1]);}}
\DoxyCodeLine{00816\ \textcolor{comment}{//\ \ \ RealScalar\ mu\ =\ diag[end]\ -\/\ e2\ /\ (td\ +\ (td>0\ ?\ 1\ :\ -\/1)\ *\ sqrt(td*td\ +\ e2));}}
\DoxyCodeLine{00817\ \ \ \textcolor{comment}{//\ This\ explain\ the\ following,\ somewhat\ more\ complicated,\ version:}}
\DoxyCodeLine{00818\ \ \ \mbox{\hyperlink{bench__gemm_8cpp_acb5c3dc237f99cf17167e8a629f01b43}{RealScalar}}\ mu\ =\ diag[\mbox{\hyperlink{ittnotify__static_8h_a30bf4ccd4623b7a8276bbc7f99e491c7}{end}}];}
\DoxyCodeLine{00819\ \ \ \textcolor{keywordflow}{if}(td==\mbox{\hyperlink{bench__gemm_8cpp_acb5c3dc237f99cf17167e8a629f01b43}{RealScalar}}(0))}
\DoxyCodeLine{00820\ \ \ \ \ mu\ -\/=\ \mbox{\hyperlink{datatypes_8h_a3aa069ac3980707dae1e0530f50d59e4}{abs}}(\mbox{\hyperlink{_cwise__array__power__array_8cpp_a9cb86ff854760bf91a154f2724a9101d}{e}});}
\DoxyCodeLine{00821\ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00822\ \ \ \{}
\DoxyCodeLine{00823\ \ \ \ \ \mbox{\hyperlink{bench__gemm_8cpp_acb5c3dc237f99cf17167e8a629f01b43}{RealScalar}}\ \mbox{\hyperlink{modp__b64__data_8h_af07d21ca4ff9cfc16902b3cf8bac724e}{e2}}\ =\ numext::abs2(subdiag[\mbox{\hyperlink{ittnotify__static_8h_a30bf4ccd4623b7a8276bbc7f99e491c7}{end}}-\/1]);}
\DoxyCodeLine{00824\ \ \ \ \ \mbox{\hyperlink{bench__gemm_8cpp_acb5c3dc237f99cf17167e8a629f01b43}{RealScalar}}\ \mbox{\hyperlink{ittnotify__static_8h_ae68700d2ebda197674e2fdd0f916f00c}{h}}\ =\ numext::hypot(td,\mbox{\hyperlink{_cwise__array__power__array_8cpp_a9cb86ff854760bf91a154f2724a9101d}{e}});}
\DoxyCodeLine{00825\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{modp__b64__data_8h_af07d21ca4ff9cfc16902b3cf8bac724e}{e2}}==\mbox{\hyperlink{bench__gemm_8cpp_acb5c3dc237f99cf17167e8a629f01b43}{RealScalar}}(0))\ mu\ -\/=\ (\mbox{\hyperlink{_cwise__array__power__array_8cpp_a9cb86ff854760bf91a154f2724a9101d}{e}}\ /\ (td\ +\ (td>\mbox{\hyperlink{bench__gemm_8cpp_acb5c3dc237f99cf17167e8a629f01b43}{RealScalar}}(0)\ ?\ \mbox{\hyperlink{bench__gemm_8cpp_acb5c3dc237f99cf17167e8a629f01b43}{RealScalar}}(1)\ :\ \mbox{\hyperlink{bench__gemm_8cpp_acb5c3dc237f99cf17167e8a629f01b43}{RealScalar}}(-\/1))))\ *\ (\mbox{\hyperlink{_cwise__array__power__array_8cpp_a9cb86ff854760bf91a154f2724a9101d}{e}}\ /\ \mbox{\hyperlink{ittnotify__static_8h_ae68700d2ebda197674e2fdd0f916f00c}{h}});}
\DoxyCodeLine{00826\ \ \ \ \ \textcolor{keywordflow}{else}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mu\ -\/=\ \mbox{\hyperlink{modp__b64__data_8h_af07d21ca4ff9cfc16902b3cf8bac724e}{e2}}\ /\ (td\ +\ (td>\mbox{\hyperlink{bench__gemm_8cpp_acb5c3dc237f99cf17167e8a629f01b43}{RealScalar}}(0)\ ?\ \mbox{\hyperlink{ittnotify__static_8h_ae68700d2ebda197674e2fdd0f916f00c}{h}}\ :\ -\/\mbox{\hyperlink{ittnotify__static_8h_ae68700d2ebda197674e2fdd0f916f00c}{h}}));}
\DoxyCodeLine{00827\ \ \ \}}
\DoxyCodeLine{00828\ \ \ }
\DoxyCodeLine{00829\ \ \ \mbox{\hyperlink{bench__gemm_8cpp_acb5c3dc237f99cf17167e8a629f01b43}{RealScalar}}\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}}\ =\ diag[\mbox{\hyperlink{cpq__pdes_8cpp_a455a4d1d80a69762a133ad026f1cba43}{start}}]\ -\/\ mu;}
\DoxyCodeLine{00830\ \ \ \mbox{\hyperlink{bench__gemm_8cpp_acb5c3dc237f99cf17167e8a629f01b43}{RealScalar}}\ z\ =\ subdiag[\mbox{\hyperlink{cpq__pdes_8cpp_a455a4d1d80a69762a133ad026f1cba43}{start}}];}
\DoxyCodeLine{00831\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{struct_eigen_1_1internal_1_1traits}{Index}}\ k\ =\ \mbox{\hyperlink{cpq__pdes_8cpp_a455a4d1d80a69762a133ad026f1cba43}{start}};\ k\ <\ \mbox{\hyperlink{ittnotify__static_8h_a30bf4ccd4623b7a8276bbc7f99e491c7}{end}};\ ++k)}
\DoxyCodeLine{00832\ \ \ \{}
\DoxyCodeLine{00833\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_jacobi_rotation}{JacobiRotation<RealScalar>}}\ \mbox{\hyperlink{level1__real__impl_8h_a6085d1e47159b776e841c37e5c45f105}{rot}};}
\DoxyCodeLine{00834\ \ \ \ \ \mbox{\hyperlink{level1__real__impl_8h_a6085d1e47159b776e841c37e5c45f105}{rot}}.makeGivens(\mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}},\ z);}
\DoxyCodeLine{00835\ }
\DoxyCodeLine{00836\ \ \ \ \ \textcolor{comment}{//\ do\ T\ =\ G'\ T\ G}}
\DoxyCodeLine{00837\ \ \ \ \ \mbox{\hyperlink{bench__gemm_8cpp_acb5c3dc237f99cf17167e8a629f01b43}{RealScalar}}\ sdk\ =\ \mbox{\hyperlink{level1__real__impl_8h_a6085d1e47159b776e841c37e5c45f105}{rot}}.s()\ *\ diag[k]\ +\ \mbox{\hyperlink{level1__real__impl_8h_a6085d1e47159b776e841c37e5c45f105}{rot}}.c()\ *\ subdiag[k];}
\DoxyCodeLine{00838\ \ \ \ \ \mbox{\hyperlink{bench__gemm_8cpp_acb5c3dc237f99cf17167e8a629f01b43}{RealScalar}}\ dkp1\ =\ \mbox{\hyperlink{level1__real__impl_8h_a6085d1e47159b776e841c37e5c45f105}{rot}}.s()\ *\ subdiag[k]\ +\ \mbox{\hyperlink{level1__real__impl_8h_a6085d1e47159b776e841c37e5c45f105}{rot}}.c()\ *\ diag[k+1];}
\DoxyCodeLine{00839\ }
\DoxyCodeLine{00840\ \ \ \ \ diag[k]\ =\ \mbox{\hyperlink{level1__real__impl_8h_a6085d1e47159b776e841c37e5c45f105}{rot}}.c()\ *\ (\mbox{\hyperlink{level1__real__impl_8h_a6085d1e47159b776e841c37e5c45f105}{rot}}.c()\ *\ diag[k]\ -\/\ \mbox{\hyperlink{level1__real__impl_8h_a6085d1e47159b776e841c37e5c45f105}{rot}}.s()\ *\ subdiag[k])\ -\/\ \mbox{\hyperlink{level1__real__impl_8h_a6085d1e47159b776e841c37e5c45f105}{rot}}.s()\ *\ (\mbox{\hyperlink{level1__real__impl_8h_a6085d1e47159b776e841c37e5c45f105}{rot}}.c()\ *\ subdiag[k]\ -\/\ \mbox{\hyperlink{level1__real__impl_8h_a6085d1e47159b776e841c37e5c45f105}{rot}}.s()\ *\ diag[k+1]);}
\DoxyCodeLine{00841\ \ \ \ \ diag[k+1]\ =\ \mbox{\hyperlink{level1__real__impl_8h_a6085d1e47159b776e841c37e5c45f105}{rot}}.s()\ *\ sdk\ +\ \mbox{\hyperlink{level1__real__impl_8h_a6085d1e47159b776e841c37e5c45f105}{rot}}.c()\ *\ dkp1;}
\DoxyCodeLine{00842\ \ \ \ \ subdiag[k]\ =\ \mbox{\hyperlink{level1__real__impl_8h_a6085d1e47159b776e841c37e5c45f105}{rot}}.c()\ *\ sdk\ -\/\ \mbox{\hyperlink{level1__real__impl_8h_a6085d1e47159b776e841c37e5c45f105}{rot}}.s()\ *\ dkp1;}
\DoxyCodeLine{00843\ \ \ \ \ }
\DoxyCodeLine{00844\ }
\DoxyCodeLine{00845\ \ \ \ \ \textcolor{keywordflow}{if}\ (k\ >\ \mbox{\hyperlink{cpq__pdes_8cpp_a455a4d1d80a69762a133ad026f1cba43}{start}})}
\DoxyCodeLine{00846\ \ \ \ \ \ \ subdiag[k\ -\/\ 1]\ =\ \mbox{\hyperlink{level1__real__impl_8h_a6085d1e47159b776e841c37e5c45f105}{rot}}.c()\ *\ subdiag[k-\/1]\ -\/\ \mbox{\hyperlink{level1__real__impl_8h_a6085d1e47159b776e841c37e5c45f105}{rot}}.s()\ *\ z;}
\DoxyCodeLine{00847\ }
\DoxyCodeLine{00848\ \ \ \ \ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}}\ =\ subdiag[k];}
\DoxyCodeLine{00849\ }
\DoxyCodeLine{00850\ \ \ \ \ \textcolor{keywordflow}{if}\ (k\ <\ \mbox{\hyperlink{ittnotify__static_8h_a30bf4ccd4623b7a8276bbc7f99e491c7}{end}}\ -\/\ 1)}
\DoxyCodeLine{00851\ \ \ \ \ \{}
\DoxyCodeLine{00852\ \ \ \ \ \ \ z\ =\ -\/\mbox{\hyperlink{level1__real__impl_8h_a6085d1e47159b776e841c37e5c45f105}{rot}}.s()\ *\ subdiag[k+1];}
\DoxyCodeLine{00853\ \ \ \ \ \ \ subdiag[k\ +\ 1]\ =\ \mbox{\hyperlink{level1__real__impl_8h_a6085d1e47159b776e841c37e5c45f105}{rot}}.c()\ *\ subdiag[k+1];}
\DoxyCodeLine{00854\ \ \ \ \ \}}
\DoxyCodeLine{00855\ \ \ \ \ }
\DoxyCodeLine{00856\ \ \ \ \ \textcolor{comment}{//\ apply\ the\ givens\ rotation\ to\ the\ unit\ matrix\ Q\ =\ Q\ *\ G}}
\DoxyCodeLine{00857\ \ \ \ \ \textcolor{keywordflow}{if}\ (matrixQ)}
\DoxyCodeLine{00858\ \ \ \ \ \{}
\DoxyCodeLine{00859\ \ \ \ \ \ \ \textcolor{comment}{//\ FIXME\ if\ StorageOrder\ ==\ RowMajor\ this\ operation\ is\ not\ very\ efficient}}
\DoxyCodeLine{00860\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_map}{Map<Matrix<Scalar,Dynamic,Dynamic,StorageOrder>}}\ >\ \mbox{\hyperlink{som__graph_8cpp_ae900b2add8deca663438fb20de69acce}{q}}(matrixQ,\mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}},\mbox{\hyperlink{_bi_c_g_s_t_a_b__simple_8cpp_a5150192f625f4d7970d61169b9567f39}{n}});}
\DoxyCodeLine{00861\ \ \ \ \ \ \ \mbox{\hyperlink{som__graph_8cpp_ae900b2add8deca663438fb20de69acce}{q}}.applyOnTheRight(k,k+1,\mbox{\hyperlink{level1__real__impl_8h_a6085d1e47159b776e841c37e5c45f105}{rot}});}
\DoxyCodeLine{00862\ \ \ \ \ \}}
\DoxyCodeLine{00863\ \ \ \}}
\DoxyCodeLine{00864\ \}}
\DoxyCodeLine{00865\ }
\DoxyCodeLine{00866\ \}\ \textcolor{comment}{//\ end\ namespace\ internal}}
\DoxyCodeLine{00867\ }
\DoxyCodeLine{00868\ \}\ \textcolor{comment}{//\ end\ namespace\ Eigen}}
\DoxyCodeLine{00869\ }
\DoxyCodeLine{00870\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ EIGEN\_SELFADJOINTEIGENSOLVER\_H}}

\end{DoxyCode}
