\doxysection{cds\+::sync\+::spin\+\_\+lock\texorpdfstring{$<$}{<} Backoff \texorpdfstring{$>$}{>} 模板类 参考}
\hypertarget{classcds_1_1sync_1_1spin__lock}{}\label{classcds_1_1sync_1_1spin__lock}\index{cds::sync::spin\_lock$<$ Backoff $>$@{cds::sync::spin\_lock$<$ Backoff $>$}}


Spin lock  




{\ttfamily \#include $<$spinlock.\+h$>$}

\doxysubsubsection*{Public 类型}
\begin{DoxyCompactItemize}
\item 
typedef Backoff \mbox{\hyperlink{classcds_1_1sync_1_1spin__lock_a1d26e427c55ac064fed17193798010cc}{backoff\+\_\+strategy}}
\begin{DoxyCompactList}\small\item\em back-\/off strategy type \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Public 成员函数}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classcds_1_1sync_1_1spin__lock_ab3b5fa4021a4d67b3805eb33de6c3f13}{spin\+\_\+lock}} () noexcept
\begin{DoxyCompactList}\small\item\em Construct free (unlocked) spin-\/lock \end{DoxyCompactList}\item 
\mbox{\hyperlink{classcds_1_1sync_1_1spin__lock_a6c033276c851efeb6c131e66398b8c3e}{spin\+\_\+lock}} (\mbox{\hyperlink{sugar_8h_abb452686968e48b67397da5f97445f5b}{bool}} b\+Locked) noexcept
\begin{DoxyCompactList}\small\item\em Construct spin-\/lock in specified state \end{DoxyCompactList}\item 
\mbox{\hyperlink{classcds_1_1sync_1_1spin__lock_a9c19be65dc088e7a2bd733d1214fc3b5}{spin\+\_\+lock}} (const \mbox{\hyperlink{classcds_1_1sync_1_1spin__lock}{spin\+\_\+lock}}$<$ Backoff $>$ \&) noexcept
\begin{DoxyCompactList}\small\item\em Dummy copy constructor \end{DoxyCompactList}\item 
\mbox{\hyperlink{classcds_1_1sync_1_1spin__lock_a0ef18bafb43996affd645d2ef1bee395}{\texorpdfstring{$\sim$}{\string~}spin\+\_\+lock}} ()
\begin{DoxyCompactList}\small\item\em Destructor. On debug time it checks whether spin-\/lock is free \end{DoxyCompactList}\item 
\mbox{\hyperlink{sugar_8h_abb452686968e48b67397da5f97445f5b}{bool}} \mbox{\hyperlink{classcds_1_1sync_1_1spin__lock_a071384b9341edfc9d2f9345e88a5d7e4}{is\+\_\+locked}} () const noexcept
\begin{DoxyCompactList}\small\item\em \doxylink{struct_check}{Check} if the spin is locked \end{DoxyCompactList}\item 
\mbox{\hyperlink{sugar_8h_abb452686968e48b67397da5f97445f5b}{bool}} \mbox{\hyperlink{classcds_1_1sync_1_1spin__lock_a36a2449275fb733308cab70280c5ca45}{try\+\_\+lock}} () noexcept
\begin{DoxyCompactList}\small\item\em Try to lock the object \end{DoxyCompactList}\item 
\mbox{\hyperlink{sugar_8h_abb452686968e48b67397da5f97445f5b}{bool}} \mbox{\hyperlink{classcds_1_1sync_1_1spin__lock_a6530ece07c6da4768c486bf38df421e2}{try\+\_\+lock}} (unsigned \mbox{\hyperlink{sugar_8h_ae4f82344f573c70aa1066a2394bba345}{int}} n\+Try\+Count) noexcept(noexcept(\mbox{\hyperlink{classcds_1_1sync_1_1spin__lock_a1d26e427c55ac064fed17193798010cc}{backoff\+\_\+strategy}}()()))
\begin{DoxyCompactList}\small\item\em Try to lock the object, repeat {\ttfamily n\+Try\+Count} times if failed \end{DoxyCompactList}\item 
\mbox{\hyperlink{ittnotify__static_8h_a61af67d9d838a9497ca5b188dabc1aa0}{void}} \mbox{\hyperlink{classcds_1_1sync_1_1spin__lock_a094ec6f61743217e837ae069ab13625b}{lock}} () noexcept(noexcept(\mbox{\hyperlink{classcds_1_1sync_1_1spin__lock_a1d26e427c55ac064fed17193798010cc}{backoff\+\_\+strategy}}()()))
\begin{DoxyCompactList}\small\item\em Lock the spin-\/lock. Waits infinitely while spin-\/lock is locked. Debug version\+: deadlock may be detected \end{DoxyCompactList}\item 
\mbox{\hyperlink{ittnotify__static_8h_a61af67d9d838a9497ca5b188dabc1aa0}{void}} \mbox{\hyperlink{classcds_1_1sync_1_1spin__lock_a7fb785b5de7cf9df6e6101208c323c97}{unlock}} () noexcept
\begin{DoxyCompactList}\small\item\em Unlock the spin-\/lock. Debug version\+: deadlock may be detected \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Private 属性}
\begin{DoxyCompactItemize}
\item 
atomics\+::atomic$<$ \mbox{\hyperlink{sugar_8h_abb452686968e48b67397da5f97445f5b}{bool}} $>$ \mbox{\hyperlink{classcds_1_1sync_1_1spin__lock_a134ba6d996d3828c614263d43266ca7d}{m\+\_\+spin}}
\begin{DoxyCompactList}\small\item\em Spin \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{详细描述}
\subsubsection*{template$<$typename Backoff$>$\newline
class cds\+::sync\+::spin\+\_\+lock$<$ Backoff $>$}
Spin lock 

Simple and light-\/weight spin-\/lock critical section It is useful to gain access to small (short-\/timed) code

Algorithm\+: \begin{DoxyVerb}TATAS (test-and-test-and-lock)
[1984] L. Rudolph, Z. Segall. Dynamic Decentralized Cache Schemes for MIMD Parallel Processors.
\end{DoxyVerb}


No serialization performed -\/ any of waiting threads may owns the spin-\/lock. This spin-\/lock is NOT recursive\+: the thread owned the lock cannot call {\ttfamily \doxylink{classcds_1_1sync_1_1spin__lock_a094ec6f61743217e837ae069ab13625b}{lock()}} method without deadlock. The method {\ttfamily \doxylink{classcds_1_1sync_1_1spin__lock_a7fb785b5de7cf9df6e6101208c323c97}{unlock()}} can call any thread

DEBUG version\+: The spinlock stores owner thead id. Assertion is raised when\+:
\begin{DoxyItemize}
\item double lock attempt encountered by same thread (deadlock)
\item unlock by another thread
\end{DoxyItemize}

If spin-\/lock is locked the {\ttfamily Backoff} algorithm is called. Predefined {\ttfamily \doxylink{namespacecds_1_1backoff_a6ef2d516f4d1eca1d46c641fa5aabda3}{backoff\+::\+Lock\+Default}} class yields current thread and repeats lock attempts later

Template parameters\+:
\begin{DoxyItemize}
\item {\ttfamily Backoff} -\/ backoff strategy. Used when spin lock is locked 
\end{DoxyItemize}

\doxysubsection{成员类型定义说明}
\Hypertarget{classcds_1_1sync_1_1spin__lock_a1d26e427c55ac064fed17193798010cc}\index{cds::sync::spin\_lock$<$ Backoff $>$@{cds::sync::spin\_lock$<$ Backoff $>$}!backoff\_strategy@{backoff\_strategy}}
\index{backoff\_strategy@{backoff\_strategy}!cds::sync::spin\_lock$<$ Backoff $>$@{cds::sync::spin\_lock$<$ Backoff $>$}}
\doxysubsubsection{\texorpdfstring{backoff\_strategy}{backoff\_strategy}}
{\footnotesize\ttfamily \label{classcds_1_1sync_1_1spin__lock_a1d26e427c55ac064fed17193798010cc} 
template$<$typename Backoff$>$ \\
typedef Backoff \mbox{\hyperlink{classcds_1_1sync_1_1spin__lock}{cds\+::sync\+::spin\+\_\+lock}}$<$ Backoff $>$\+::backoff\+\_\+strategy}



back-\/off strategy type 



\doxysubsection{构造及析构函数说明}
\Hypertarget{classcds_1_1sync_1_1spin__lock_ab3b5fa4021a4d67b3805eb33de6c3f13}\index{cds::sync::spin\_lock$<$ Backoff $>$@{cds::sync::spin\_lock$<$ Backoff $>$}!spin\_lock@{spin\_lock}}
\index{spin\_lock@{spin\_lock}!cds::sync::spin\_lock$<$ Backoff $>$@{cds::sync::spin\_lock$<$ Backoff $>$}}
\doxysubsubsection{\texorpdfstring{spin\_lock()}{spin\_lock()}\hspace{0.1cm}{\footnotesize\ttfamily [1/3]}}
{\footnotesize\ttfamily \label{classcds_1_1sync_1_1spin__lock_ab3b5fa4021a4d67b3805eb33de6c3f13} 
template$<$typename Backoff$>$ \\
\mbox{\hyperlink{classcds_1_1sync_1_1spin__lock}{cds\+::sync\+::spin\+\_\+lock}}$<$ Backoff $>$\+::spin\+\_\+lock (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [noexcept]}}



Construct free (unlocked) spin-\/lock 

\Hypertarget{classcds_1_1sync_1_1spin__lock_a6c033276c851efeb6c131e66398b8c3e}\index{cds::sync::spin\_lock$<$ Backoff $>$@{cds::sync::spin\_lock$<$ Backoff $>$}!spin\_lock@{spin\_lock}}
\index{spin\_lock@{spin\_lock}!cds::sync::spin\_lock$<$ Backoff $>$@{cds::sync::spin\_lock$<$ Backoff $>$}}
\doxysubsubsection{\texorpdfstring{spin\_lock()}{spin\_lock()}\hspace{0.1cm}{\footnotesize\ttfamily [2/3]}}
{\footnotesize\ttfamily \label{classcds_1_1sync_1_1spin__lock_a6c033276c851efeb6c131e66398b8c3e} 
template$<$typename Backoff$>$ \\
\mbox{\hyperlink{classcds_1_1sync_1_1spin__lock}{cds\+::sync\+::spin\+\_\+lock}}$<$ Backoff $>$\+::spin\+\_\+lock (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{sugar_8h_abb452686968e48b67397da5f97445f5b}{bool}}}]{b\+Locked}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [explicit]}, {\ttfamily [noexcept]}}



Construct spin-\/lock in specified state 

In debug mode\+: if {\ttfamily b\+Locked} = true then spin-\/lock is made owned by current thread \Hypertarget{classcds_1_1sync_1_1spin__lock_a9c19be65dc088e7a2bd733d1214fc3b5}\index{cds::sync::spin\_lock$<$ Backoff $>$@{cds::sync::spin\_lock$<$ Backoff $>$}!spin\_lock@{spin\_lock}}
\index{spin\_lock@{spin\_lock}!cds::sync::spin\_lock$<$ Backoff $>$@{cds::sync::spin\_lock$<$ Backoff $>$}}
\doxysubsubsection{\texorpdfstring{spin\_lock()}{spin\_lock()}\hspace{0.1cm}{\footnotesize\ttfamily [3/3]}}
{\footnotesize\ttfamily \label{classcds_1_1sync_1_1spin__lock_a9c19be65dc088e7a2bd733d1214fc3b5} 
template$<$typename Backoff$>$ \\
\mbox{\hyperlink{classcds_1_1sync_1_1spin__lock}{cds\+::sync\+::spin\+\_\+lock}}$<$ Backoff $>$\+::spin\+\_\+lock (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{classcds_1_1sync_1_1spin__lock}{spin\+\_\+lock}}$<$ Backoff $>$ \&}]{}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [noexcept]}}



Dummy copy constructor 

The ctor initializes the spin to free (unlocked) state like the default ctor. \Hypertarget{classcds_1_1sync_1_1spin__lock_a0ef18bafb43996affd645d2ef1bee395}\index{cds::sync::spin\_lock$<$ Backoff $>$@{cds::sync::spin\_lock$<$ Backoff $>$}!````~spin\_lock@{\texorpdfstring{$\sim$}{\string~}spin\_lock}}
\index{````~spin\_lock@{\texorpdfstring{$\sim$}{\string~}spin\_lock}!cds::sync::spin\_lock$<$ Backoff $>$@{cds::sync::spin\_lock$<$ Backoff $>$}}
\doxysubsubsection{\texorpdfstring{\texorpdfstring{$\sim$}{\string~}spin\_lock()}{\string~spin\_lock()}}
{\footnotesize\ttfamily \label{classcds_1_1sync_1_1spin__lock_a0ef18bafb43996affd645d2ef1bee395} 
template$<$typename Backoff$>$ \\
\mbox{\hyperlink{classcds_1_1sync_1_1spin__lock}{cds\+::sync\+::spin\+\_\+lock}}$<$ Backoff $>$\+::\texorpdfstring{$\sim$}{\string~}\mbox{\hyperlink{classcds_1_1sync_1_1spin__lock}{spin\+\_\+lock}} (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Destructor. On debug time it checks whether spin-\/lock is free 



\doxysubsection{成员函数说明}
\Hypertarget{classcds_1_1sync_1_1spin__lock_a071384b9341edfc9d2f9345e88a5d7e4}\index{cds::sync::spin\_lock$<$ Backoff $>$@{cds::sync::spin\_lock$<$ Backoff $>$}!is\_locked@{is\_locked}}
\index{is\_locked@{is\_locked}!cds::sync::spin\_lock$<$ Backoff $>$@{cds::sync::spin\_lock$<$ Backoff $>$}}
\doxysubsubsection{\texorpdfstring{is\_locked()}{is\_locked()}}
{\footnotesize\ttfamily \label{classcds_1_1sync_1_1spin__lock_a071384b9341edfc9d2f9345e88a5d7e4} 
template$<$typename Backoff$>$ \\
\mbox{\hyperlink{sugar_8h_abb452686968e48b67397da5f97445f5b}{bool}} \mbox{\hyperlink{classcds_1_1sync_1_1spin__lock}{cds\+::sync\+::spin\+\_\+lock}}$<$ Backoff $>$\+::is\+\_\+locked (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [noexcept]}}



\doxylink{struct_check}{Check} if the spin is locked 

\Hypertarget{classcds_1_1sync_1_1spin__lock_a094ec6f61743217e837ae069ab13625b}\index{cds::sync::spin\_lock$<$ Backoff $>$@{cds::sync::spin\_lock$<$ Backoff $>$}!lock@{lock}}
\index{lock@{lock}!cds::sync::spin\_lock$<$ Backoff $>$@{cds::sync::spin\_lock$<$ Backoff $>$}}
\doxysubsubsection{\texorpdfstring{lock()}{lock()}}
{\footnotesize\ttfamily \label{classcds_1_1sync_1_1spin__lock_a094ec6f61743217e837ae069ab13625b} 
template$<$typename Backoff$>$ \\
\mbox{\hyperlink{ittnotify__static_8h_a61af67d9d838a9497ca5b188dabc1aa0}{void}} \mbox{\hyperlink{classcds_1_1sync_1_1spin__lock}{cds\+::sync\+::spin\+\_\+lock}}$<$ Backoff $>$\+::lock (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [noexcept]}}



Lock the spin-\/lock. Waits infinitely while spin-\/lock is locked. Debug version\+: deadlock may be detected 

\Hypertarget{classcds_1_1sync_1_1spin__lock_a36a2449275fb733308cab70280c5ca45}\index{cds::sync::spin\_lock$<$ Backoff $>$@{cds::sync::spin\_lock$<$ Backoff $>$}!try\_lock@{try\_lock}}
\index{try\_lock@{try\_lock}!cds::sync::spin\_lock$<$ Backoff $>$@{cds::sync::spin\_lock$<$ Backoff $>$}}
\doxysubsubsection{\texorpdfstring{try\_lock()}{try\_lock()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily \label{classcds_1_1sync_1_1spin__lock_a36a2449275fb733308cab70280c5ca45} 
template$<$typename Backoff$>$ \\
\mbox{\hyperlink{sugar_8h_abb452686968e48b67397da5f97445f5b}{bool}} \mbox{\hyperlink{classcds_1_1sync_1_1spin__lock}{cds\+::sync\+::spin\+\_\+lock}}$<$ Backoff $>$\+::try\+\_\+lock (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [noexcept]}}



Try to lock the object 

Returns {\ttfamily true} if locking is succeeded otherwise (if the spin is already locked) returns {\ttfamily false} 

Debug version\+: deadlock can be detected \Hypertarget{classcds_1_1sync_1_1spin__lock_a6530ece07c6da4768c486bf38df421e2}\index{cds::sync::spin\_lock$<$ Backoff $>$@{cds::sync::spin\_lock$<$ Backoff $>$}!try\_lock@{try\_lock}}
\index{try\_lock@{try\_lock}!cds::sync::spin\_lock$<$ Backoff $>$@{cds::sync::spin\_lock$<$ Backoff $>$}}
\doxysubsubsection{\texorpdfstring{try\_lock()}{try\_lock()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily \label{classcds_1_1sync_1_1spin__lock_a6530ece07c6da4768c486bf38df421e2} 
template$<$typename Backoff$>$ \\
\mbox{\hyperlink{sugar_8h_abb452686968e48b67397da5f97445f5b}{bool}} \mbox{\hyperlink{classcds_1_1sync_1_1spin__lock}{cds\+::sync\+::spin\+\_\+lock}}$<$ Backoff $>$\+::try\+\_\+lock (\begin{DoxyParamCaption}\item[{unsigned \mbox{\hyperlink{sugar_8h_ae4f82344f573c70aa1066a2394bba345}{int}}}]{n\+Try\+Count}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [noexcept]}}



Try to lock the object, repeat {\ttfamily n\+Try\+Count} times if failed 

Returns {\ttfamily true} if locking is succeeded otherwise (if the spin is already locked) returns {\ttfamily false} \Hypertarget{classcds_1_1sync_1_1spin__lock_a7fb785b5de7cf9df6e6101208c323c97}\index{cds::sync::spin\_lock$<$ Backoff $>$@{cds::sync::spin\_lock$<$ Backoff $>$}!unlock@{unlock}}
\index{unlock@{unlock}!cds::sync::spin\_lock$<$ Backoff $>$@{cds::sync::spin\_lock$<$ Backoff $>$}}
\doxysubsubsection{\texorpdfstring{unlock()}{unlock()}}
{\footnotesize\ttfamily \label{classcds_1_1sync_1_1spin__lock_a7fb785b5de7cf9df6e6101208c323c97} 
template$<$typename Backoff$>$ \\
\mbox{\hyperlink{ittnotify__static_8h_a61af67d9d838a9497ca5b188dabc1aa0}{void}} \mbox{\hyperlink{classcds_1_1sync_1_1spin__lock}{cds\+::sync\+::spin\+\_\+lock}}$<$ Backoff $>$\+::unlock (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [noexcept]}}



Unlock the spin-\/lock. Debug version\+: deadlock may be detected 



\doxysubsection{类成员变量说明}
\Hypertarget{classcds_1_1sync_1_1spin__lock_a134ba6d996d3828c614263d43266ca7d}\index{cds::sync::spin\_lock$<$ Backoff $>$@{cds::sync::spin\_lock$<$ Backoff $>$}!m\_spin@{m\_spin}}
\index{m\_spin@{m\_spin}!cds::sync::spin\_lock$<$ Backoff $>$@{cds::sync::spin\_lock$<$ Backoff $>$}}
\doxysubsubsection{\texorpdfstring{m\_spin}{m\_spin}}
{\footnotesize\ttfamily \label{classcds_1_1sync_1_1spin__lock_a134ba6d996d3828c614263d43266ca7d} 
template$<$typename Backoff$>$ \\
atomics\+::atomic$<$\mbox{\hyperlink{sugar_8h_abb452686968e48b67397da5f97445f5b}{bool}}$>$ \mbox{\hyperlink{classcds_1_1sync_1_1spin__lock}{cds\+::sync\+::spin\+\_\+lock}}$<$ Backoff $>$\+::m\+\_\+spin\hspace{0.3cm}{\ttfamily [private]}}



Spin 



该类的文档由以下文件生成\+:\begin{DoxyCompactItemize}
\item 
external/libcds/cds/sync/\mbox{\hyperlink{sync_2spinlock_8h}{spinlock.\+h}}\end{DoxyCompactItemize}
