\doxysection{ff\+\_\+dreceiver\+MPI.\+hpp}
\hypertarget{ff__dreceiver_m_p_i_8hpp_source}{}\label{ff__dreceiver_m_p_i_8hpp_source}\index{external/taskflow/3rd-\/party/ff/distributed/ff\_dreceiverMPI.hpp@{external/taskflow/3rd-\/party/ff/distributed/ff\_dreceiverMPI.hpp}}
\mbox{\hyperlink{ff__dreceiver_m_p_i_8hpp}{浏览该文件的文档.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#ifndef\ FF\_DRECEIVER\_MPI\_H}}
\DoxyCodeLine{00002\ \textcolor{preprocessor}{\#define\ FF\_DRECEIVER\_MPI\_H}}
\DoxyCodeLine{00003\ }
\DoxyCodeLine{00004\ }
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#include\ <iostream>}}
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#include\ <sstream>}}
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{ff_8hpp}{ff/ff.hpp}}>}}
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{ff__network_8hpp}{ff/distributed/ff\_network.hpp}}>}}
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#include\ <mpi.h>}}
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#include\ <cereal/cereal.hpp>}}
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#include\ <cereal/archives/portable\_binary.hpp>}}
\DoxyCodeLine{00012\ \textcolor{preprocessor}{\#include\ <cereal/types/vector.hpp>}}
\DoxyCodeLine{00013\ \textcolor{preprocessor}{\#include\ <cereal/types/polymorphic.hpp>}}
\DoxyCodeLine{00014\ }
\DoxyCodeLine{00015\ \textcolor{keyword}{using\ namespace\ }\mbox{\hyperlink{namespaceff}{ff}};}
\DoxyCodeLine{00016\ }
\DoxyCodeLine{00017\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classff__dreceiver_m_p_i_ab4a313fbd985fa8514e5b6daa6a7f761}{ff\_dreceiverMPI}}:\ \textcolor{keyword}{public}\ \mbox{\hyperlink{structff_1_1ff__monode__t_af884543f90b7d72bd7a918404f528b37}{ff\_monode\_t}}<message\_t>\ \{\ }
\DoxyCodeLine{00018\ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00019\ }
\DoxyCodeLine{00020\ \ \ \ \ \textcolor{comment}{/*static\ int\ sendRoutingTable(const\ int\ rank,\ const\ std::vector<int>\&\ dest)\{}}
\DoxyCodeLine{00021\ \textcolor{comment}{\ \ \ \ \ \ \ \ dataBuffer\ buff;\ std::ostream\ oss(\&buff);}}
\DoxyCodeLine{00022\ \textcolor{comment}{\ \ \ \ \ \ \ \ cereal::PortableBinaryOutputArchive\ oarchive(oss);}}
\DoxyCodeLine{00023\ \textcolor{comment}{\ \ \ \ \ \ \ \ oarchive\ <<\ dest;}}
\DoxyCodeLine{00024\ \textcolor{comment}{}}
\DoxyCodeLine{00025\ \textcolor{comment}{\ \ \ \ \ \ \ \ if\ (MPI\_Send(buff.getPtr(),\ buff.getLen(),\ MPI\_BYTE,\ rank,\ DFF\_ROUTING\_TABLE\_TAG,\ MPI\_COMM\_WORLD)\ !=\ MPI\_SUCCESS)\{}}
\DoxyCodeLine{00026\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ error("{}Something\ went\ wrong\ sending\ the\ routing\ table!\(\backslash\)n"{});}}
\DoxyCodeLine{00027\ \textcolor{comment}{\ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{00028\ \textcolor{comment}{}}
\DoxyCodeLine{00029\ \textcolor{comment}{\ \ \ \ \ \ \ \ return\ 0;}}
\DoxyCodeLine{00030\ \textcolor{comment}{\ \ \ \ \}*/}}
\DoxyCodeLine{00031\ }
\DoxyCodeLine{00032\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classff__dreceiver_m_p_i_a1a46ee7d23fde723d850cb60c5c865c4}{handshakeHandler}}()\{}
\DoxyCodeLine{00033\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ sz;}
\DoxyCodeLine{00034\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{ff__network_8hpp_a19a96edeeb9d37072c4ce9f862d19ba8}{ChannelType}}\ ct;}
\DoxyCodeLine{00035\ \ \ \ \ \ \ \ \ MPI\_Status\ status;}
\DoxyCodeLine{00036\ \ \ \ \ \ \ \ \ MPI\_Probe(MPI\_ANY\_SOURCE,\ DFF\_GROUP\_NAME\_TAG,\ MPI\_COMM\_WORLD,\ \&status);}
\DoxyCodeLine{00037\ \ \ \ \ \ \ \ \ MPI\_Get\_count(\&status,\ MPI\_BYTE,\ \&sz);}
\DoxyCodeLine{00038\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{char}*\ buff\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{char}\ [sz];}
\DoxyCodeLine{00039\ \ \ \ \ \ \ \ \ MPI\_Recv(buff,\ sz,\ MPI\_BYTE,\ status.MPI\_SOURCE,\ DFF\_GROUP\_NAME\_TAG,\ MPI\_COMM\_WORLD,\ MPI\_STATUS\_IGNORE);}
\DoxyCodeLine{00040\ \ \ \ \ \ \ \ \ MPI\_Recv(\&ct,\ \textcolor{keyword}{sizeof}(ct),\ MPI\_BYTE,\ status.MPI\_SOURCE,\ DFF\_CHANNEL\_TYPE\_TAG,\ MPI\_COMM\_WORLD,\ MPI\_STATUS\_IGNORE);}
\DoxyCodeLine{00041\ }
\DoxyCodeLine{00042\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classff__dreceiver_m_p_i_ac1dbcb1afedf345cfbfbc25b09c90fc4}{rank2ChannelType}}[status.MPI\_SOURCE]\ =\ ct;}
\DoxyCodeLine{00043\ }
\DoxyCodeLine{00044\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00045\ \ \ \ \ \}}
\DoxyCodeLine{00046\ }
\DoxyCodeLine{00047\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classff__dreceiver_m_p_i_a5a6f821cf3697f4576496d35e179fe75}{registerLogicalEOS}}(\textcolor{keywordtype}{int}\ sender)\{}
\DoxyCodeLine{00048\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ =\ 0;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ <\ this-\/>\mbox{\hyperlink{classff_1_1ff__monode_abe1b8acb3c5ce1e30e51dcdd8b8f1dfd}{get\_num\_outchannels}}();\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}++)}
\DoxyCodeLine{00049\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classff_1_1ff__monode_a6ef67c53214dde2219d9071c77ee99ee}{ff\_send\_out\_to}}(\textcolor{keyword}{new}\ \mbox{\hyperlink{structmessage__t}{message\_t}}(sender,\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}),\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}});}
\DoxyCodeLine{00050\ \ \ \ \ \}}
\DoxyCodeLine{00051\ }
\DoxyCodeLine{00052\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classff__dreceiver_m_p_i_a79fa773995926b39915a625e3aef1f6b}{registerEOS}}(\textcolor{keywordtype}{int}\ \mbox{\hyperlink{ittnotify__static_8h_a4d59258314b5b7d431d257e3a5a98b57}{rank}})\{}
\DoxyCodeLine{00053\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classff__dreceiver_m_p_i_a07a789ce6ef8b09a9db7bfd051ae0135}{neos}}++;}
\DoxyCodeLine{00054\ \ \ \ \ \}}
\DoxyCodeLine{00055\ }
\DoxyCodeLine{00056\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classff__dreceiver_m_p_i_a17bd058eeac2c10cc25c79a0e6bbe50c}{forward}}(\mbox{\hyperlink{structmessage__t}{message\_t}}*\ task,\ \textcolor{keywordtype}{int})\{}
\DoxyCodeLine{00057\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (task-\/>chid\ ==\ -\/1)\ \mbox{\hyperlink{classff_1_1ff__monode_ae59d2a9cd3ea5da022c8d0438cfe867d}{ff\_send\_out}}(task);}
\DoxyCodeLine{00058\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \mbox{\hyperlink{classff_1_1ff__monode_a6ef67c53214dde2219d9071c77ee99ee}{ff\_send\_out\_to}}(task,\ this-\/>\mbox{\hyperlink{classff__dreceiver_m_p_i_a51ea941ca144641b32cba8e3356c5a22}{routingTable}}[task-\/>chid]);\ \textcolor{comment}{//\ assume\ the\ routing\ table\ is\ consistent\ WARNING!!!}}
\DoxyCodeLine{00059\ \ \ \ \ \}}
\DoxyCodeLine{00060\ }
\DoxyCodeLine{00061\ }
\DoxyCodeLine{00062\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00063\ \ \ \ \ \mbox{\hyperlink{classff__dreceiver_m_p_i_ab4a313fbd985fa8514e5b6daa6a7f761}{ff\_dreceiverMPI}}(\textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classff__dreceiver_m_p_i_a57bf567d8cd7a7ba1c88aaca82e45984}{input\_channels}},\ std::map<int,\ int>\ \mbox{\hyperlink{classff__dreceiver_m_p_i_a51ea941ca144641b32cba8e3356c5a22}{routingTable}}\ =\ \{std::make\_pair(0,0)\},\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classff__dreceiver_m_p_i_a9e55e8452271f89867165296ce21c266}{coreid}}=-\/1)}
\DoxyCodeLine{00064\ \ \ \ \ \ \ \ \ :\ \mbox{\hyperlink{classff__dreceiver_m_p_i_a57bf567d8cd7a7ba1c88aaca82e45984}{input\_channels}}(\mbox{\hyperlink{classff__dreceiver_m_p_i_a57bf567d8cd7a7ba1c88aaca82e45984}{input\_channels}}),\ \mbox{\hyperlink{classff__dreceiver_m_p_i_a51ea941ca144641b32cba8e3356c5a22}{routingTable}}(\mbox{\hyperlink{classff__dreceiver_m_p_i_a51ea941ca144641b32cba8e3356c5a22}{routingTable}}),\ \mbox{\hyperlink{classff__dreceiver_m_p_i_a9e55e8452271f89867165296ce21c266}{coreid}}(\mbox{\hyperlink{classff__dreceiver_m_p_i_a9e55e8452271f89867165296ce21c266}{coreid}})\ \{\}}
\DoxyCodeLine{00065\ }
\DoxyCodeLine{00066\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classff__dreceiver_m_p_i_a180ac1f7dc243bc6cf0e51f50071375e}{svc\_init}}()\ \{}
\DoxyCodeLine{00067\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classff__dreceiver_m_p_i_a9e55e8452271f89867165296ce21c266}{coreid}}!=-\/1)}
\DoxyCodeLine{00068\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{mapping__utils_8hpp_a55cc056711b4071b978f875d18914b44}{ff\_mapThreadToCpu}}(\mbox{\hyperlink{classff__dreceiver_m_p_i_a9e55e8452271f89867165296ce21c266}{coreid}});}
\DoxyCodeLine{00069\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00070\ }
\DoxyCodeLine{00071\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ =\ 0;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ <\ \mbox{\hyperlink{classff__dreceiver_m_p_i_a57bf567d8cd7a7ba1c88aaca82e45984}{input\_channels}};\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}++)}
\DoxyCodeLine{00072\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classff__dreceiver_m_p_i_a1a46ee7d23fde723d850cb60c5c865c4}{handshakeHandler}}();}
\DoxyCodeLine{00073\ }
\DoxyCodeLine{00074\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00075\ \ \ \ \ \}}
\DoxyCodeLine{00076\ }
\DoxyCodeLine{00077\ \ \ \ \ \textcolor{comment}{/*\ }}
\DoxyCodeLine{00078\ \textcolor{comment}{\ \ \ \ \ \ \ \ Here\ i\ should\ not\ care\ of\ input\ type\ nor\ input\ data\ since\ they\ come\ from\ a\ socket\ listener.}}
\DoxyCodeLine{00079\ \textcolor{comment}{\ \ \ \ \ \ \ \ Everything\ will\ be\ handled\ inside\ a\ while\ true\ in\ the\ body\ of\ this\ node\ where\ data\ is\ pulled\ from\ network}}
\DoxyCodeLine{00080\ \textcolor{comment}{\ \ \ \ */}}
\DoxyCodeLine{00081\ \ \ \ \ \mbox{\hyperlink{structmessage__t}{message\_t}}\ *\mbox{\hyperlink{classff__dreceiver_m_p_i_a41b8315e38938d730128d156b48f3bf0}{svc}}(\mbox{\hyperlink{structmessage__t}{message\_t}}*\ task)\ \{}
\DoxyCodeLine{00082\ \ \ \ \ \ \ \ \ MPI\_Status\ status;}
\DoxyCodeLine{00083\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}(\mbox{\hyperlink{classff__dreceiver_m_p_i_a07a789ce6ef8b09a9db7bfd051ae0135}{neos}}\ <\ \mbox{\hyperlink{classff__dreceiver_m_p_i_a57bf567d8cd7a7ba1c88aaca82e45984}{input\_channels}})\{}
\DoxyCodeLine{00084\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00085\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ headersLen;}
\DoxyCodeLine{00086\ \ \ \ \ \ \ \ \ \ \ \ \ MPI\_Probe(MPI\_ANY\_SOURCE,\ DFF\_HEADER\_TAG,\ MPI\_COMM\_WORLD,\ \&status);}
\DoxyCodeLine{00087\ \ \ \ \ \ \ \ \ \ \ \ \ MPI\_Get\_count(\&status,\ MPI\_LONG,\ \&headersLen);}
\DoxyCodeLine{00088\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{long}\ headers[headersLen];}
\DoxyCodeLine{00089\ }
\DoxyCodeLine{00090\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (MPI\_Recv(headers,\ headersLen,\ MPI\_LONG,\ status.MPI\_SOURCE,\ DFF\_HEADER\_TAG,\ MPI\_COMM\_WORLD,\ \&status)\ !=\ MPI\_SUCCESS)}
\DoxyCodeLine{00091\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespaceff_a27d926d29b55e019eba5b70672301d82}{error}}(\textcolor{stringliteral}{"{}Error\ on\ Recv\ Receiver\ primo\ in\ alto\(\backslash\)n"{}});}
\DoxyCodeLine{00092\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ feedback\ =\ \mbox{\hyperlink{ff__network_8hpp_a19a96edeeb9d37072c4ce9f862d19ba8ac53d16911739e991ff812058af14979c}{ChannelType::FBK}}\ ==\ \mbox{\hyperlink{classff__dreceiver_m_p_i_ac1dbcb1afedf345cfbfbc25b09c90fc4}{rank2ChannelType}}[status.MPI\_SOURCE];}
\DoxyCodeLine{00093\ \ \ \ \ \ \ \ \ \ \ \ \ assert(headers[0]*3+1\ ==\ headersLen);}
\DoxyCodeLine{00094\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (headers[0]\ ==\ 1)\{}
\DoxyCodeLine{00095\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ sz\ =\ headers[3];}
\DoxyCodeLine{00096\ }
\DoxyCodeLine{00097\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (sz\ ==\ 0)\{}
\DoxyCodeLine{00098\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (headers[2]\ ==\ -\/2)\{}
\DoxyCodeLine{00099\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classff__dreceiver_m_p_i_a5a6f821cf3697f4576496d35e179fe75}{registerLogicalEOS}}(headers[1]);}
\DoxyCodeLine{00100\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00101\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00102\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classff__dreceiver_m_p_i_a79fa773995926b39915a625e3aef1f6b}{registerEOS}}(status.MPI\_SOURCE);}
\DoxyCodeLine{00103\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00104\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00105\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{char}*\ buff\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{char}[sz];}
\DoxyCodeLine{00106\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (MPI\_Recv(buff,sz,MPI\_BYTE,\ status.MPI\_SOURCE,\ DFF\_TASK\_TAG,\ MPI\_COMM\_WORLD,\ MPI\_STATUS\_IGNORE)\ !=\ MPI\_SUCCESS)}
\DoxyCodeLine{00107\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespaceff_a27d926d29b55e019eba5b70672301d82}{error}}(\textcolor{stringliteral}{"{}Error\ on\ Recv\ Receiver\ Payload\(\backslash\)n"{}});}
\DoxyCodeLine{00108\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00109\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structmessage__t}{message\_t}}*\ \mbox{\hyperlink{classff_1_1ff__node_a06adec50580f200b0edde2e66ae5152a}{out}}\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{structmessage__t}{message\_t}}(buff,\ sz,\ \textcolor{keyword}{true});}
\DoxyCodeLine{00110\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classff_1_1ff__node_a06adec50580f200b0edde2e66ae5152a}{out}}-\/>sender\ =\ headers[1];}
\DoxyCodeLine{00111\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classff_1_1ff__node_a06adec50580f200b0edde2e66ae5152a}{out}}-\/>chid\ \ \ =\ headers[2];}
\DoxyCodeLine{00112\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classff_1_1ff__node_a06adec50580f200b0edde2e66ae5152a}{out}}-\/>feedback\ =\ feedback;}
\DoxyCodeLine{00113\ }
\DoxyCodeLine{00114\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>\mbox{\hyperlink{classff__dreceiver_m_p_i_a17bd058eeac2c10cc25c79a0e6bbe50c}{forward}}(out,\ status.MPI\_SOURCE);}
\DoxyCodeLine{00115\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00116\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}};}
\DoxyCodeLine{00117\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ MPI\_Status\ localStatus;}
\DoxyCodeLine{00118\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ MPI\_Probe(status.MPI\_SOURCE,\ DFF\_TASK\_TAG,\ MPI\_COMM\_WORLD,\ \&localStatus);}
\DoxyCodeLine{00119\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ MPI\_Get\_count(\&localStatus,\ MPI\_BYTE,\ \&\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}});}
\DoxyCodeLine{00120\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{char}*\ buff\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{char}[\mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}}];\ \textcolor{comment}{//\ this\ can\ be\ reused!!\ }}
\DoxyCodeLine{00121\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ MPI\_Recv(buff,\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_ac42c05b5701aef6bab82675cf3b55fee}{size}},\ MPI\_BYTE,\ localStatus.MPI\_SOURCE,\ DFF\_TASK\_TAG,\ MPI\_COMM\_WORLD,\ MPI\_STATUS\_IGNORE);}
\DoxyCodeLine{00122\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{ittnotify__static_8h_ad492e8facf9b4113e52f1918fceb8804}{head}}\ =\ 0;}
\DoxyCodeLine{00123\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ =\ 0;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ <\ (size\_t)headers[0];\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}++)\{}
\DoxyCodeLine{00124\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ sz\ =\ headers[3*\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}+3];}
\DoxyCodeLine{00125\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (sz\ ==\ 0)\{}
\DoxyCodeLine{00126\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (headers[3*\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}+2]\ ==\ -\/2)\{}
\DoxyCodeLine{00127\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classff__dreceiver_m_p_i_a5a6f821cf3697f4576496d35e179fe75}{registerLogicalEOS}}(headers[3*\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}+1]);}
\DoxyCodeLine{00128\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00129\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00130\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classff__dreceiver_m_p_i_a79fa773995926b39915a625e3aef1f6b}{registerEOS}}(status.MPI\_SOURCE);}
\DoxyCodeLine{00131\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ assert(\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}+1\ ==\ (\textcolor{keywordtype}{size\_t})headers[0]);}
\DoxyCodeLine{00132\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00133\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00134\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{char}*\ outBuff\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{char}[sz];}
\DoxyCodeLine{00135\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ memcpy(outBuff,\ buff+\mbox{\hyperlink{ittnotify__static_8h_ad492e8facf9b4113e52f1918fceb8804}{head}},\ sz);}
\DoxyCodeLine{00136\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{ittnotify__static_8h_ad492e8facf9b4113e52f1918fceb8804}{head}}\ +=\ sz;}
\DoxyCodeLine{00137\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structmessage__t}{message\_t}}*\ \mbox{\hyperlink{classff_1_1ff__node_a06adec50580f200b0edde2e66ae5152a}{out}}\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{structmessage__t}{message\_t}}(outBuff,\ sz,\ \textcolor{keyword}{true});}
\DoxyCodeLine{00138\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classff_1_1ff__node_a06adec50580f200b0edde2e66ae5152a}{out}}-\/>sender\ =\ headers[3*\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}+1];}
\DoxyCodeLine{00139\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classff_1_1ff__node_a06adec50580f200b0edde2e66ae5152a}{out}}-\/>chid\ =\ headers[3*\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}+2];}
\DoxyCodeLine{00140\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classff_1_1ff__node_a06adec50580f200b0edde2e66ae5152a}{out}}-\/>feedback\ =\ feedback;}
\DoxyCodeLine{00141\ }
\DoxyCodeLine{00142\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>\mbox{\hyperlink{classff__dreceiver_m_p_i_a17bd058eeac2c10cc25c79a0e6bbe50c}{forward}}(out,\ status.MPI\_SOURCE);}
\DoxyCodeLine{00143\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00144\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{delete}\ []\ buff;}
\DoxyCodeLine{00145\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00146\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00147\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00148\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00149\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ this-\/>\mbox{\hyperlink{structff_1_1ff__monode__t_a4a57165500150f93c85b94ba82f6eacb}{EOS}};}
\DoxyCodeLine{00150\ \ \ \ \ \}}
\DoxyCodeLine{00151\ }
\DoxyCodeLine{00152\ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00153\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classff__dreceiver_m_p_i_a07a789ce6ef8b09a9db7bfd051ae0135}{neos}}\ =\ 0;}
\DoxyCodeLine{00154\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classff__dreceiver_m_p_i_a57bf567d8cd7a7ba1c88aaca82e45984}{input\_channels}};}
\DoxyCodeLine{00155\ \ \ \ \ std::map<int,\ int>\ \mbox{\hyperlink{classff__dreceiver_m_p_i_a51ea941ca144641b32cba8e3356c5a22}{routingTable}};}
\DoxyCodeLine{00156\ \ \ \ \ std::map<int,\ ChannelType>\ \mbox{\hyperlink{classff__dreceiver_m_p_i_ac1dbcb1afedf345cfbfbc25b09c90fc4}{rank2ChannelType}};}
\DoxyCodeLine{00157\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classff__dreceiver_m_p_i_a9e55e8452271f89867165296ce21c266}{coreid}};}
\DoxyCodeLine{00158\ \};}
\DoxyCodeLine{00159\ }
\DoxyCodeLine{00160\ }
\DoxyCodeLine{00161\ }
\DoxyCodeLine{00162\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classff__dreceiver_h_m_p_i_a178903f11d64895ec90646477f09966a}{ff\_dreceiverHMPI}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{classff__dreceiver_m_p_i_ab4a313fbd985fa8514e5b6daa6a7f761}{ff\_dreceiverMPI}}\ \{}
\DoxyCodeLine{00163\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classff__dreceiver_h_m_p_i_a741cda8c8b6e5f6d37715056499a426d}{internalNEos}}\ =\ 0,\ \mbox{\hyperlink{classff__dreceiver_h_m_p_i_ac390e63aae140e5ed6036450e55f5f93}{externalNEos}}\ =\ 0;}
\DoxyCodeLine{00164\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classff__dreceiver_h_m_p_i_aa81a44a52659d988a6d4c30cd8feda02}{next\_rr\_destination}}\ =\ 0;}
\DoxyCodeLine{00165\ }
\DoxyCodeLine{00166\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classff__dreceiver_h_m_p_i_aae964ff00cfb2d59f854af631fc5bc35}{registerLogicalEOS}}(\textcolor{keywordtype}{int}\ sender)\{}
\DoxyCodeLine{00167\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ =\ 0;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ <\ this-\/>\mbox{\hyperlink{classff_1_1ff__monode_abe1b8acb3c5ce1e30e51dcdd8b8f1dfd}{get\_num\_outchannels}}()-\/1;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}++)}
\DoxyCodeLine{00168\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classff_1_1ff__monode_a6ef67c53214dde2219d9071c77ee99ee}{ff\_send\_out\_to}}(\textcolor{keyword}{new}\ \mbox{\hyperlink{structmessage__t}{message\_t}}(sender,\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}),\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}});}
\DoxyCodeLine{00169\ \ \ \ \ \}}
\DoxyCodeLine{00170\ }
\DoxyCodeLine{00171\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classff__dreceiver_h_m_p_i_a04009bd68220e952dcbca77b95cd1ffb}{registerEOS}}(\textcolor{keywordtype}{int}\ \mbox{\hyperlink{ittnotify__static_8h_a4d59258314b5b7d431d257e3a5a98b57}{rank}})\{}
\DoxyCodeLine{00172\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classff__dreceiver_m_p_i_a07a789ce6ef8b09a9db7bfd051ae0135}{neos}}++;}
\DoxyCodeLine{00173\ }
\DoxyCodeLine{00174\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ internalConn\ =\ std::count\_if(\mbox{\hyperlink{namespacestd_aec76fc52a775d29bc4058c8e1405045a}{std::begin}}(\mbox{\hyperlink{classff__dreceiver_m_p_i_ac1dbcb1afedf345cfbfbc25b09c90fc4}{rank2ChannelType}}),}
\DoxyCodeLine{00175\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacestd_a35f71a4c49ddf38bb590177e3a4b2598}{std::end}}\ \ (\mbox{\hyperlink{classff__dreceiver_m_p_i_ac1dbcb1afedf345cfbfbc25b09c90fc4}{rank2ChannelType}}),}
\DoxyCodeLine{00176\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [](std::pair<int,\ ChannelType>\ \textcolor{keyword}{const}\ \&\mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}})\ \{\textcolor{keywordflow}{return}\ \mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}}.second\ ==\ \mbox{\hyperlink{ff__network_8hpp_a19a96edeeb9d37072c4ce9f862d19ba8afd5a5f51ce25953f3db2c7e93eb7864a}{ChannelType::INT}};\});}
\DoxyCodeLine{00177\ }
\DoxyCodeLine{00178\ \ \ }
\DoxyCodeLine{00179\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classff__dreceiver_m_p_i_ac1dbcb1afedf345cfbfbc25b09c90fc4}{rank2ChannelType}}[\mbox{\hyperlink{ittnotify__static_8h_a4d59258314b5b7d431d257e3a5a98b57}{rank}}]\ !=\ \mbox{\hyperlink{ff__network_8hpp_a19a96edeeb9d37072c4ce9f862d19ba8afd5a5f51ce25953f3db2c7e93eb7864a}{ChannelType::INT}})\{}
\DoxyCodeLine{00180\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (++\mbox{\hyperlink{classff__dreceiver_h_m_p_i_ac390e63aae140e5ed6036450e55f5f93}{externalNEos}}\ ==\ (\mbox{\hyperlink{classff__dreceiver_m_p_i_ac1dbcb1afedf345cfbfbc25b09c90fc4}{rank2ChannelType}}.size()-\/internalConn))}
\DoxyCodeLine{00181\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ =\ 0;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ <\ this-\/>\mbox{\hyperlink{classff_1_1ff__monode_abe1b8acb3c5ce1e30e51dcdd8b8f1dfd}{get\_num\_outchannels}}()-\/1;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}++)\ \mbox{\hyperlink{classff_1_1ff__monode_a6ef67c53214dde2219d9071c77ee99ee}{ff\_send\_out\_to}}(this-\/>\mbox{\hyperlink{structff_1_1ff__monode__t_a4a57165500150f93c85b94ba82f6eacb}{EOS}},\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}});}
\DoxyCodeLine{00182\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00183\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (++\mbox{\hyperlink{classff__dreceiver_h_m_p_i_a741cda8c8b6e5f6d37715056499a426d}{internalNEos}}\ ==\ internalConn)}
\DoxyCodeLine{00184\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classff_1_1ff__monode_a6ef67c53214dde2219d9071c77ee99ee}{ff\_send\_out\_to}}(this-\/>\mbox{\hyperlink{structff_1_1ff__monode__t_a4a57165500150f93c85b94ba82f6eacb}{EOS}},\ this-\/>\mbox{\hyperlink{classff_1_1ff__monode_abe1b8acb3c5ce1e30e51dcdd8b8f1dfd}{get\_num\_outchannels}}()-\/1);}
\DoxyCodeLine{00185\ \ \ \ \ \}}
\DoxyCodeLine{00186\ }
\DoxyCodeLine{00187\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classff__dreceiver_h_m_p_i_a6fac79b3858550bf7dd7627aea4ff872}{forward}}(\mbox{\hyperlink{structmessage__t}{message\_t}}*\ task,\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{ittnotify__static_8h_a4d59258314b5b7d431d257e3a5a98b57}{rank}})\{}
\DoxyCodeLine{00188\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classff__dreceiver_m_p_i_ac1dbcb1afedf345cfbfbc25b09c90fc4}{rank2ChannelType}}[\mbox{\hyperlink{ittnotify__static_8h_a4d59258314b5b7d431d257e3a5a98b57}{rank}}]\ ==\ \mbox{\hyperlink{ff__network_8hpp_a19a96edeeb9d37072c4ce9f862d19ba8afd5a5f51ce25953f3db2c7e93eb7864a}{ChannelType::INT}})\ \mbox{\hyperlink{classff_1_1ff__monode_a6ef67c53214dde2219d9071c77ee99ee}{ff\_send\_out\_to}}(task,\ this-\/>\mbox{\hyperlink{classff_1_1ff__monode_abe1b8acb3c5ce1e30e51dcdd8b8f1dfd}{get\_num\_outchannels}}()-\/1);}
\DoxyCodeLine{00189\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (task-\/>\mbox{\hyperlink{structmessage__t_a5ddf2f3048b3ea4711d079b6bfd8a77c}{chid}}\ !=\ -\/1)\ \mbox{\hyperlink{classff_1_1ff__monode_a6ef67c53214dde2219d9071c77ee99ee}{ff\_send\_out\_to}}(task,\ this-\/>\mbox{\hyperlink{classff__dreceiver_m_p_i_a51ea941ca144641b32cba8e3356c5a22}{routingTable}}[task-\/>chid]);}
\DoxyCodeLine{00190\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00191\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classff_1_1ff__monode_a6ef67c53214dde2219d9071c77ee99ee}{ff\_send\_out\_to}}(task,\ \mbox{\hyperlink{classff__dreceiver_h_m_p_i_aa81a44a52659d988a6d4c30cd8feda02}{next\_rr\_destination}});}
\DoxyCodeLine{00192\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classff__dreceiver_h_m_p_i_aa81a44a52659d988a6d4c30cd8feda02}{next\_rr\_destination}}\ =\ ((\mbox{\hyperlink{classff__dreceiver_h_m_p_i_aa81a44a52659d988a6d4c30cd8feda02}{next\_rr\_destination}}\ +\ 1)\ \%\ (this-\/>\mbox{\hyperlink{classff_1_1ff__monode_abe1b8acb3c5ce1e30e51dcdd8b8f1dfd}{get\_num\_outchannels}}()-\/1));}
\DoxyCodeLine{00193\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00194\ \ \ \ \ \}}
\DoxyCodeLine{00195\ }
\DoxyCodeLine{00196\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00197\ \ \ \ \ \mbox{\hyperlink{classff__dreceiver_h_m_p_i_a178903f11d64895ec90646477f09966a}{ff\_dreceiverHMPI}}(\textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classff__dreceiver_m_p_i_a57bf567d8cd7a7ba1c88aaca82e45984}{input\_channels}},\ std::map<int,\ int>\ \mbox{\hyperlink{classff__dreceiver_m_p_i_a51ea941ca144641b32cba8e3356c5a22}{routingTable}}\ =\ \{std::make\_pair(0,0)\},\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classff__dreceiver_m_p_i_a9e55e8452271f89867165296ce21c266}{coreid}}=-\/1)}
\DoxyCodeLine{00198\ \ \ \ \ \ \ \ \ :\ \mbox{\hyperlink{classff__dreceiver_m_p_i}{ff\_dreceiverMPI}}(\mbox{\hyperlink{classff__dreceiver_m_p_i_a57bf567d8cd7a7ba1c88aaca82e45984}{input\_channels}},\ \mbox{\hyperlink{classff__dreceiver_m_p_i_a51ea941ca144641b32cba8e3356c5a22}{routingTable}},\ \mbox{\hyperlink{classff__dreceiver_m_p_i_a9e55e8452271f89867165296ce21c266}{coreid}})\ \ \{\}}
\DoxyCodeLine{00199\ }
\DoxyCodeLine{00200\ \};}
\DoxyCodeLine{00201\ }
\DoxyCodeLine{00202\ }
\DoxyCodeLine{00203\ }
\DoxyCodeLine{00204\ }
\DoxyCodeLine{00206\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classff__dreceiver_m_p_i_o_d_ae94f6ad3aba6cab3d35d9bd5cb055c47}{ff\_dreceiverMPIOD}}:\ \textcolor{keyword}{public}\ \mbox{\hyperlink{classff__dreceiver_m_p_i_ab4a313fbd985fa8514e5b6daa6a7f761}{ff\_dreceiverMPI}}\ \{\ }
\DoxyCodeLine{00207\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00208\ \ \ \ \ \mbox{\hyperlink{classff__dreceiver_m_p_i_o_d_ae94f6ad3aba6cab3d35d9bd5cb055c47}{ff\_dreceiverMPIOD}}(\textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classff__dreceiver_m_p_i_a57bf567d8cd7a7ba1c88aaca82e45984}{input\_channels}},\ std::map<int,\ int>\ \mbox{\hyperlink{classff__dreceiver_m_p_i_a51ea941ca144641b32cba8e3356c5a22}{routingTable}}\ =\ \{std::make\_pair(0,0)\},\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classff__dreceiver_m_p_i_a9e55e8452271f89867165296ce21c266}{coreid}}=-\/1)}
\DoxyCodeLine{00209\ \ \ \ \ \ \ \ \ :\ \mbox{\hyperlink{classff__dreceiver_m_p_i}{ff\_dreceiverMPI}}(\mbox{\hyperlink{classff__dreceiver_m_p_i_a57bf567d8cd7a7ba1c88aaca82e45984}{input\_channels}},\ \mbox{\hyperlink{classff__dreceiver_m_p_i_a51ea941ca144641b32cba8e3356c5a22}{routingTable}},\ \mbox{\hyperlink{classff__dreceiver_m_p_i_a9e55e8452271f89867165296ce21c266}{coreid}})\ \{\}}
\DoxyCodeLine{00210\ \ \ \ \ \textcolor{comment}{/*\ }}
\DoxyCodeLine{00211\ \textcolor{comment}{\ \ \ \ \ \ \ \ Here\ i\ should\ not\ care\ of\ input\ type\ nor\ input\ data\ since\ they\ come\ from\ a\ socket\ listener.}}
\DoxyCodeLine{00212\ \textcolor{comment}{\ \ \ \ \ \ \ \ Everything\ will\ be\ handled\ inside\ a\ while\ true\ in\ the\ body\ of\ this\ node\ where\ data\ is\ pulled\ from\ network}}
\DoxyCodeLine{00213\ \textcolor{comment}{\ \ \ \ */}}
\DoxyCodeLine{00214\ \ \ \ \ \mbox{\hyperlink{structmessage__t}{message\_t}}\ *\mbox{\hyperlink{classff__dreceiver_m_p_i_o_d_a90ecd20e5fe00aaa974bd9a5dd88d4f6}{svc}}(\mbox{\hyperlink{structmessage__t}{message\_t}}*\ task)\ \{}
\DoxyCodeLine{00215\ \ \ \ \ \ \ \ \ MPI\_Request\ tmpAckReq;}
\DoxyCodeLine{00216\ \ \ \ \ \ \ \ \ MPI\_Status\ status;}
\DoxyCodeLine{00217\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{long}\ \mbox{\hyperlink{cblat1_8f_a410931b600854e6dd3e253731606117e}{header}}[3];}
\DoxyCodeLine{00218\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}(\mbox{\hyperlink{classff__dreceiver_m_p_i_a07a789ce6ef8b09a9db7bfd051ae0135}{neos}}\ <\ \mbox{\hyperlink{classff__dreceiver_m_p_i_a57bf567d8cd7a7ba1c88aaca82e45984}{input\_channels}})\{}
\DoxyCodeLine{00219\ \ \ \ \ \ \ \ \ \ \ \ \ MPI\_Recv(\mbox{\hyperlink{cblat1_8f_a410931b600854e6dd3e253731606117e}{header}},\ 3,\ MPI\_LONG,\ MPI\_ANY\_SOURCE,\ DFF\_HEADER\_TAG,\ MPI\_COMM\_WORLD,\ \&status);}
\DoxyCodeLine{00220\ }
\DoxyCodeLine{00221\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ sz\ =\ \mbox{\hyperlink{cblat1_8f_a410931b600854e6dd3e253731606117e}{header}}[0];}
\DoxyCodeLine{00222\ }
\DoxyCodeLine{00223\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (sz\ ==\ 0)\{}
\DoxyCodeLine{00224\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classff__dreceiver_m_p_i_a07a789ce6ef8b09a9db7bfd051ae0135}{neos}}++;}
\DoxyCodeLine{00225\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00226\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00227\ }
\DoxyCodeLine{00228\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{char}*\ buff\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{char}\ [sz];}
\DoxyCodeLine{00229\ \ \ \ \ \ \ \ \ \ \ \ \ assert(buff);}
\DoxyCodeLine{00230\ }
\DoxyCodeLine{00231\ \ \ \ \ \ \ \ \ \ \ \ \ MPI\_Recv(buff,sz,MPI\_BYTE,\ status.MPI\_SOURCE,\ DFF\_TASK\_TAG,\ MPI\_COMM\_WORLD,\ MPI\_STATUS\_IGNORE);}
\DoxyCodeLine{00232\ }
\DoxyCodeLine{00233\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structmessage__t}{message\_t}}*\ \mbox{\hyperlink{classff_1_1ff__node_a06adec50580f200b0edde2e66ae5152a}{out}}\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{structmessage__t}{message\_t}}(buff,\ sz,\ \textcolor{keyword}{true});}
\DoxyCodeLine{00234\ \ \ \ \ \ \ \ \ \ \ \ \ assert(\mbox{\hyperlink{classff_1_1ff__node_a06adec50580f200b0edde2e66ae5152a}{out}});}
\DoxyCodeLine{00235\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classff_1_1ff__node_a06adec50580f200b0edde2e66ae5152a}{out}}-\/>sender\ =\ \mbox{\hyperlink{cblat1_8f_a410931b600854e6dd3e253731606117e}{header}}[1];}
\DoxyCodeLine{00236\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classff_1_1ff__node_a06adec50580f200b0edde2e66ae5152a}{out}}-\/>chid\ \ \ =\ \mbox{\hyperlink{cblat1_8f_a410931b600854e6dd3e253731606117e}{header}}[2];}
\DoxyCodeLine{00237\ }
\DoxyCodeLine{00238\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//std::cout\ <<\ "{}received\ something\ from\ "{}\ <<\ sender\ <<\ "{}\ directed\ to\ "{}\ <<\ chid\ <<\ std::endl;}}
\DoxyCodeLine{00239\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classff_1_1ff__node_a06adec50580f200b0edde2e66ae5152a}{out}}-\/>chid\ !=\ -\/1)}
\DoxyCodeLine{00240\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classff_1_1ff__monode_a6ef67c53214dde2219d9071c77ee99ee}{ff\_send\_out\_to}}(\mbox{\hyperlink{classff_1_1ff__node_a06adec50580f200b0edde2e66ae5152a}{out}},\ this-\/>\mbox{\hyperlink{classff__dreceiver_m_p_i_a51ea941ca144641b32cba8e3356c5a22}{routingTable}}[\mbox{\hyperlink{classff_1_1ff__node_a06adec50580f200b0edde2e66ae5152a}{out}}-\/>chid]);\ \textcolor{comment}{//\ assume\ the\ routing\ table\ is\ consistent\ WARNING!!!}}
\DoxyCodeLine{00241\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00242\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classff_1_1ff__monode_ae59d2a9cd3ea5da022c8d0438cfe867d}{ff\_send\_out}}(\mbox{\hyperlink{classff_1_1ff__node_a06adec50580f200b0edde2e66ae5152a}{out}});}
\DoxyCodeLine{00243\ }
\DoxyCodeLine{00244\ \ \ \ \ \ \ \ \ \ \ \ \ MPI\_Isend(\&\mbox{\hyperlink{classff__dreceiver_m_p_i_o_d_ad527f8deb30fbb578fef23c8e322c7d9}{ACK}},\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structack__t}{ack\_t}}),\ MPI\_BYTE,\ status.MPI\_SOURCE,\ DFF\_ACK\_TAG,\ MPI\_COMM\_WORLD,\ \&tmpAckReq);}
\DoxyCodeLine{00245\ \ \ \ \ \ \ \ \ \ \ \ \ MPI\_Request\_free(\&tmpAckReq);}
\DoxyCodeLine{00246\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00247\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00248\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ this-\/>\mbox{\hyperlink{structff_1_1ff__monode__t_a4a57165500150f93c85b94ba82f6eacb}{EOS}};}
\DoxyCodeLine{00249\ \ \ \ \ \}}
\DoxyCodeLine{00250\ }
\DoxyCodeLine{00251\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00252\ \ \ \ \ \mbox{\hyperlink{structack__t}{ack\_t}}\ \mbox{\hyperlink{classff__dreceiver_m_p_i_o_d_ad527f8deb30fbb578fef23c8e322c7d9}{ACK}};}
\DoxyCodeLine{00253\ \};}
\DoxyCodeLine{00254\ }
\DoxyCodeLine{00255\ \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
