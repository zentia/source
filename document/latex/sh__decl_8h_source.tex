\doxysection{sh\+\_\+decl.\+h}
\hypertarget{sh__decl_8h_source}{}\label{sh__decl_8h_source}\index{external/libcds/cds/urcu/details/sh\_decl.h@{external/libcds/cds/urcu/details/sh\_decl.h}}
\mbox{\hyperlink{sh__decl_8h}{浏览该文件的文档.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ Copyright\ (c)\ 2006-\/2018\ Maxim\ Khizhinsky}}
\DoxyCodeLine{00002\ \textcolor{comment}{//}}
\DoxyCodeLine{00003\ \textcolor{comment}{//\ Distributed\ under\ the\ Boost\ Software\ License,\ Version\ 1.0.\ (See\ accompanying}}
\DoxyCodeLine{00004\ \textcolor{comment}{//\ file\ LICENSE\ or\ copy\ at\ http://www.boost.org/LICENSE\_1\_0.txt)}}
\DoxyCodeLine{00005\ }
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#ifndef\ CDSLIB\_URCU\_DETAILS\_SH\_DECL\_H}}
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#define\ CDSLIB\_URCU\_DETAILS\_SH\_DECL\_H}}
\DoxyCodeLine{00008\ }
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{external_2libcds_2cds_2urcu_2details_2base_8h}{cds/urcu/details/base.h}}>}}
\DoxyCodeLine{00010\ }
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#ifdef\ CDS\_URCU\_SIGNAL\_HANDLING\_ENABLED}}
\DoxyCodeLine{00012\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{cache__line_8h}{cds/user\_setup/cache\_line.h}}>}}
\DoxyCodeLine{00013\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ <signal.h>}}
\DoxyCodeLine{00015\ }
\DoxyCodeLine{00016\ \textcolor{comment}{//@cond}}
\DoxyCodeLine{00017\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespacecds}{cds}}\ \{\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespacecds_1_1urcu}{urcu}}\ \{\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespacecds_1_1urcu_1_1details}{details}}\ \{}
\DoxyCodeLine{00018\ }
\DoxyCodeLine{00019\ \ \ \ \ \textcolor{comment}{//\ We\ could\ derive\ thread\_data\ from\ thread\_list\_record}}
\DoxyCodeLine{00020\ \ \ \ \ \textcolor{comment}{//\ but\ in\ this\ case\ m\_nAccessControl\ would\ have\ offset\ !=\ 0}}
\DoxyCodeLine{00021\ \ \ \ \ \textcolor{comment}{//\ that\ is\ not\ so\ efficiently}}
\DoxyCodeLine{00022\ \textcolor{preprocessor}{\#\ \ \ define\ CDS\_SHURCU\_DECLARE\_THREAD\_DATA(tag\_)\ \(\backslash\)}}
\DoxyCodeLine{00023\ \textcolor{preprocessor}{\ \ \ \ template\ <>\ struct\ thread\_data<tag\_>\ \{\ \(\backslash\)}}
\DoxyCodeLine{00024\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ atomics::atomic<uint32\_t>\ \ \ \ \ \ \ \ m\_nAccessControl\ ;\ \(\backslash\)}}
\DoxyCodeLine{00025\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ atomics::atomic<bool>\ \ \ \ \ \ \ \ \ \ \ \ m\_bNeedMemBar\ \ \ \ ;\ \(\backslash\)}}
\DoxyCodeLine{00026\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ thread\_list\_record<\ thread\_data\ >\ \ \ m\_list\ ;\ \(\backslash\)}}
\DoxyCodeLine{00027\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ char\ pad\_[cds::c\_nCacheLineSize];\ \(\backslash\)}}
\DoxyCodeLine{00028\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ thread\_data():\ m\_nAccessControl(0),\ m\_bNeedMemBar(false)\ \{\}\ \(\backslash\)}}
\DoxyCodeLine{00029\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ explicit\ thread\_data(\ OS::ThreadId\ owner\ ):\ m\_nAccessControl(0),\ m\_bNeedMemBar(false),\ m\_list(owner)\ \{\}\ \(\backslash\)}}
\DoxyCodeLine{00030\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \string~thread\_data()\ \{\}\ \(\backslash\)}}
\DoxyCodeLine{00031\ \textcolor{preprocessor}{\ \ \ \ \}}}
\DoxyCodeLine{00032\ }
\DoxyCodeLine{00033\ \ \ \ \ CDS\_SHURCU\_DECLARE\_THREAD\_DATA(\ signal\_buffered\_tag\ );}
\DoxyCodeLine{00034\ }
\DoxyCodeLine{00035\ \textcolor{preprocessor}{\#\ \ \ undef\ CDS\_SHURCU\_DECLARE\_THREAD\_DATA}}
\DoxyCodeLine{00036\ }
\DoxyCodeLine{00037\ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ RCUtag>}
\DoxyCodeLine{00038\ \ \ \ \ \textcolor{keyword}{struct\ }sh\_singleton\_instance}
\DoxyCodeLine{00039\ \ \ \ \ \{}
\DoxyCodeLine{00040\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{compiler_2defs_8h_a4ac8e9c4ea6b38586b0189153d1f38c9}{CDS\_EXPORT\_API}}\ singleton\_vtbl\ *\ \ \ \ \ s\_pRCU;}
\DoxyCodeLine{00041\ \ \ \ \ \};}
\DoxyCodeLine{00042\ \textcolor{preprocessor}{\#if\ CDS\_COMPILER\ !=\ CDS\_COMPILER\_MSVC}}
\DoxyCodeLine{00043\ \ \ \ \ \textcolor{keyword}{template}<>\ \mbox{\hyperlink{compiler_2defs_8h_a4ac8e9c4ea6b38586b0189153d1f38c9}{CDS\_EXPORT\_API}}\ singleton\_vtbl\ *\ sh\_singleton\_instance<\ signal\_buffered\_tag\ >::s\_pRCU;}
\DoxyCodeLine{00044\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00045\ }
\DoxyCodeLine{00046\ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ SigRCUtag>}
\DoxyCodeLine{00047\ \ \ \ \ \textcolor{keyword}{class\ }sh\_thread\_gc}
\DoxyCodeLine{00048\ \ \ \ \ \{}
\DoxyCodeLine{00049\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00050\ \ \ \ \ \ \ \ \ \textcolor{keyword}{typedef}\ SigRCUtag\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ rcu\_tag;}
\DoxyCodeLine{00051\ \ \ \ \ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ rcu\_tag::rcu\_class\ rcu\_class;}
\DoxyCodeLine{00052\ \ \ \ \ \ \ \ \ \textcolor{keyword}{typedef}\ thread\_data<\ rcu\_tag\ >\ \ \ \ \ \ thread\_record;}
\DoxyCodeLine{00053\ \ \ \ \ \ \ \ \ \textcolor{keyword}{typedef}\ cds::urcu::details::scoped\_lock<\ sh\_thread\_gc\ >\ scoped\_lock;}
\DoxyCodeLine{00054\ }
\DoxyCodeLine{00055\ \ \ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00056\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ thread\_record\ *\ get\_thread\_record();}
\DoxyCodeLine{00057\ }
\DoxyCodeLine{00058\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00059\ \ \ \ \ \ \ \ \ sh\_thread\_gc();}
\DoxyCodeLine{00060\ \ \ \ \ \ \ \ \ \string~sh\_thread\_gc();}
\DoxyCodeLine{00061\ }
\DoxyCodeLine{00062\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00063\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ access\_lock();}
\DoxyCodeLine{00064\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ access\_unlock();}
\DoxyCodeLine{00065\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ is\_locked();}
\DoxyCodeLine{00066\ }
\DoxyCodeLine{00068\ \ \ \ \ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Disposer,\ \textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00069\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ retire(\ \mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}}\ *\ \mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}}\ )}
\DoxyCodeLine{00070\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00071\ \ \ \ \ \ \ \ \ \ \ \ \ retire(\ \mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}},\ +[](\ \textcolor{keywordtype}{void}*\ \mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}}\ )\ \{\ Disposer()(\ \textcolor{keyword}{static\_cast<}\mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}}*\textcolor{keyword}{>}(\ \mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}}\ ));\ \});}
\DoxyCodeLine{00072\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00073\ }
\DoxyCodeLine{00075\ \ \ \ \ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00076\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ retire(\ \mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}}\ *\ \mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}},\ \textcolor{keywordtype}{void}\ (*\ pFunc)(\mbox{\hyperlink{test__overwrite__node_8cpp_a0acb682b8260ab1c60b918599864e2e5}{T}}\ *))}
\DoxyCodeLine{00077\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00078\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacecds_1_1urcu_a9fd06318cc85d4d956ba7fb8152083c1}{retired\_ptr}}\ rp(\ \textcolor{keyword}{reinterpret\_cast<}\textcolor{keywordtype}{void}\ *\textcolor{keyword}{>}(\ \mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}}\ ),\ \textcolor{keyword}{reinterpret\_cast<}\mbox{\hyperlink{namespacecds_1_1urcu_a914791bb9ca62963d05a12cb5271f7d5}{free\_retired\_ptr\_func}}\textcolor{keyword}{>}(\ pFunc\ ));}
\DoxyCodeLine{00079\ \ \ \ \ \ \ \ \ \ \ \ \ retire(\ rp\ );}
\DoxyCodeLine{00080\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00081\ }
\DoxyCodeLine{00083\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ retire(\ retired\_ptr\&\ \mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}}\ )}
\DoxyCodeLine{00084\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00085\ \ \ \ \ \ \ \ \ \ \ \ \ assert(\ sh\_singleton\_instance<\ rcu\_tag\ >::s\_pRCU\ );}
\DoxyCodeLine{00086\ \ \ \ \ \ \ \ \ \ \ \ \ sh\_singleton\_instance<\ rcu\_tag\ >::s\_pRCU-\/>retire\_ptr(\ \mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}}\ );}
\DoxyCodeLine{00087\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00088\ \ \ \ \ \};}
\DoxyCodeLine{00089\ }
\DoxyCodeLine{00090\ \textcolor{preprocessor}{\#\ \ \ define\ CDS\_SH\_RCU\_DECLARE\_THREAD\_GC(\ tag\_\ )\ template\ <>\ class\ thread\_gc<tag\_>:\ public\ sh\_thread\_gc<tag\_>\ \{\}}}
\DoxyCodeLine{00091\ }
\DoxyCodeLine{00092\ \ \ \ \ CDS\_SH\_RCU\_DECLARE\_THREAD\_GC(\ signal\_buffered\_tag\ \ );}
\DoxyCodeLine{00093\ }
\DoxyCodeLine{00094\ \textcolor{preprocessor}{\#\ \ \ undef\ CDS\_SH\_RCU\_DECLARE\_THREAD\_GC}}
\DoxyCodeLine{00095\ }
\DoxyCodeLine{00096\ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ RCUtag>}
\DoxyCodeLine{00097\ \ \ \ \ \textcolor{keyword}{class\ }sh\_singleton:\ \textcolor{keyword}{public}\ singleton\_vtbl}
\DoxyCodeLine{00098\ \ \ \ \ \{}
\DoxyCodeLine{00099\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00100\ \ \ \ \ \ \ \ \ \textcolor{keyword}{typedef}\ RCUtag\ \ rcu\_tag;}
\DoxyCodeLine{00101\ \ \ \ \ \ \ \ \ \textcolor{keyword}{typedef}\ cds::urcu::details::thread\_gc<\ rcu\_tag\ >\ \ \ thread\_gc;}
\DoxyCodeLine{00102\ }
\DoxyCodeLine{00103\ \ \ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00104\ \ \ \ \ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ thread\_gc::thread\_record\ \ \ thread\_record;}
\DoxyCodeLine{00105\ \ \ \ \ \ \ \ \ \textcolor{keyword}{typedef}\ sh\_singleton\_instance<\ rcu\_tag\ >\ \ \ \ rcu\_instance;}
\DoxyCodeLine{00106\ }
\DoxyCodeLine{00107\ \ \ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00108\ \ \ \ \ \ \ \ \ atomics::atomic<uint32\_t>\ \ \ m\_nGlobalControl;}
\DoxyCodeLine{00109\ \ \ \ \ \ \ \ \ thread\_list<\ rcu\_tag\ >\ \ \ \ \ \ m\_ThreadList;}
\DoxyCodeLine{00110\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \textcolor{keyword}{const}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_nSigNo;}
\DoxyCodeLine{00111\ }
\DoxyCodeLine{00112\ \ \ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00113\ \ \ \ \ \ \ \ \ sh\_singleton(\ \textcolor{keywordtype}{int}\ nSignal\ )}
\DoxyCodeLine{00114\ \ \ \ \ \ \ \ \ \ \ \ \ :\ m\_nGlobalControl(1)}
\DoxyCodeLine{00115\ \ \ \ \ \ \ \ \ \ \ \ \ ,\ m\_nSigNo(\ nSignal\ )}
\DoxyCodeLine{00116\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00117\ \ \ \ \ \ \ \ \ \ \ \ \ set\_signal\_handler();}
\DoxyCodeLine{00118\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00119\ }
\DoxyCodeLine{00120\ \ \ \ \ \ \ \ \ \string~sh\_singleton()}
\DoxyCodeLine{00121\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00122\ \ \ \ \ \ \ \ \ \ \ \ \ clear\_signal\_handler();}
\DoxyCodeLine{00123\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00124\ }
\DoxyCodeLine{00125\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00126\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ sh\_singleton\ *\ \mbox{\hyperlink{ittnotify__static_8h_a73b55cf9365a83ac86bac9da2dada5ee}{instance}}()}
\DoxyCodeLine{00127\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00128\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{static\_cast<}\ sh\_singleton\ *\textcolor{keyword}{>}(\ rcu\_instance::s\_pRCU\ );}
\DoxyCodeLine{00129\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00130\ }
\DoxyCodeLine{00131\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ isUsed()}
\DoxyCodeLine{00132\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00133\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ rcu\_instance::s\_pRCU\ !=\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00134\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00135\ }
\DoxyCodeLine{00136\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ signal\_no()\textcolor{keyword}{\ const}}
\DoxyCodeLine{00137\ \textcolor{keyword}{\ \ \ \ \ \ \ \ }\{}
\DoxyCodeLine{00138\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ m\_nSigNo;}
\DoxyCodeLine{00139\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00140\ }
\DoxyCodeLine{00141\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00142\ \ \ \ \ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ retire\_ptr(\ retired\_ptr\&\ \mbox{\hyperlink{main-override_8cpp_a117104b82864d3b23ec174af6d392709}{p}}\ )\ =\ 0;}
\DoxyCodeLine{00143\ }
\DoxyCodeLine{00144\ \ \ \ \ \textcolor{keyword}{public}:\ \textcolor{comment}{//\ thread\_gc\ interface}}
\DoxyCodeLine{00145\ \ \ \ \ \ \ \ \ thread\_record\ *\ attach\_thread()}
\DoxyCodeLine{00146\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00147\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ m\_ThreadList.alloc();}
\DoxyCodeLine{00148\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00149\ }
\DoxyCodeLine{00150\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ detach\_thread(\ thread\_record\ *\ pRec\ )}
\DoxyCodeLine{00151\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00152\ \ \ \ \ \ \ \ \ \ \ \ \ m\_ThreadList.retire(\ pRec\ );}
\DoxyCodeLine{00153\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00154\ }
\DoxyCodeLine{00155\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{eabase_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t}}\ global\_control\_word(\ atomics::memory\_order\ mo\ )\textcolor{keyword}{\ const}}
\DoxyCodeLine{00156\ \textcolor{keyword}{\ \ \ \ \ \ \ \ }\{}
\DoxyCodeLine{00157\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ m\_nGlobalControl.load(\ mo\ );}
\DoxyCodeLine{00158\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00159\ }
\DoxyCodeLine{00160\ \ \ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00161\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ set\_signal\_handler();}
\DoxyCodeLine{00162\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ clear\_signal\_handler();}
\DoxyCodeLine{00163\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ signal\_handler(\ \textcolor{keywordtype}{int}\ signo,\ siginfo\_t\ *\ sigInfo,\ \textcolor{keywordtype}{void}\ *\ context\ );}
\DoxyCodeLine{00164\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ raise\_signal(\ \mbox{\hyperlink{namespacecds_1_1_o_s_1_1posix_aa5d1cef6c4dd410d6d21c851201bfc40}{cds::OS::ThreadId}}\ tid\ );}
\DoxyCodeLine{00165\ }
\DoxyCodeLine{00166\ \ \ \ \ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ Backoff>}
\DoxyCodeLine{00167\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ force\_membar\_all\_threads(\ Backoff\&\ bkOff\ );}
\DoxyCodeLine{00168\ }
\DoxyCodeLine{00169\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ switch\_next\_epoch()}
\DoxyCodeLine{00170\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00171\ \ \ \ \ \ \ \ \ \ \ \ \ m\_nGlobalControl.fetch\_xor(\ rcu\_tag::c\_nControlBit,\ atomics::memory\_order\_seq\_cst\ );}
\DoxyCodeLine{00172\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00173\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ check\_grace\_period(\ thread\_record\ *\ pRec\ )\ \textcolor{keyword}{const};}
\DoxyCodeLine{00174\ }
\DoxyCodeLine{00175\ \ \ \ \ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ Backoff>}
\DoxyCodeLine{00176\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ wait\_for\_quiescent\_state(\ Backoff\&\ bkOff\ );}
\DoxyCodeLine{00177\ \ \ \ \ \};}
\DoxyCodeLine{00178\ }
\DoxyCodeLine{00179\ \textcolor{preprocessor}{\#\ \ \ define\ CDS\_SIGRCU\_DECLARE\_SINGLETON(\ tag\_\ )\ \(\backslash\)}}
\DoxyCodeLine{00180\ \textcolor{preprocessor}{\ \ \ \ template\ <>\ class\ singleton<\ tag\_\ >\ \{\ \(\backslash\)}}
\DoxyCodeLine{00181\ \textcolor{preprocessor}{\ \ \ \ public:\ \(\backslash\)}}
\DoxyCodeLine{00182\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ typedef\ tag\_\ \ rcu\_tag\ ;\ \(\backslash\)}}
\DoxyCodeLine{00183\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ typedef\ cds::urcu::details::thread\_gc<\ rcu\_tag\ >\ \ \ thread\_gc\ ;\ \(\backslash\)}}
\DoxyCodeLine{00184\ \textcolor{preprocessor}{\ \ \ \ protected:\ \(\backslash\)}}
\DoxyCodeLine{00185\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ typedef\ thread\_gc::thread\_record\ \ \ \ \ \ \ \ \ \ \ \ thread\_record\ ;\ \(\backslash\)}}
\DoxyCodeLine{00186\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ typedef\ sh\_singleton\_instance<\ rcu\_tag\ >\ \ \ \ rcu\_instance\ \ ;\ \(\backslash\)}}
\DoxyCodeLine{00187\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ typedef\ sh\_singleton<\ rcu\_tag\ >\ \ \ \ \ \ \ \ \ \ \ \ \ rcu\_singleton\ ;\ \(\backslash\)}}
\DoxyCodeLine{00188\ \textcolor{preprocessor}{\ \ \ \ public:\ \(\backslash\)}}
\DoxyCodeLine{00189\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ static\ bool\ isUsed()\ \{\ return\ rcu\_singleton::isUsed()\ ;\ \}\ \(\backslash\)}}
\DoxyCodeLine{00190\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ static\ rcu\_singleton\ *\ instance()\ \{\ assert(\ rcu\_instance::s\_pRCU\ );\ return\ static\_cast<rcu\_singleton\ *>(\ rcu\_instance::s\_pRCU\ );\ \}\ \(\backslash\)}}
\DoxyCodeLine{00191\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ static\ thread\_record\ *\ attach\_thread()\ \{\ return\ instance()-\/>attach\_thread()\ ;\ \}\ \(\backslash\)}}
\DoxyCodeLine{00192\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ static\ void\ detach\_thread(\ thread\_record\ *\ pRec\ )\ \{\ return\ instance()-\/>detach\_thread(\ pRec\ )\ ;\ \}\ \(\backslash\)}}
\DoxyCodeLine{00193\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ static\ uint32\_t\ global\_control\_word(\ atomics::memory\_order\ mo\ )\ \{\ return\ instance()-\/>global\_control\_word(\ mo\ )\ ;\ \}\ \(\backslash\)}}
\DoxyCodeLine{00194\ \textcolor{preprocessor}{\ \ \ \ \}}}
\DoxyCodeLine{00195\ }
\DoxyCodeLine{00196\ \ \ \ \ CDS\_SIGRCU\_DECLARE\_SINGLETON(\ signal\_buffered\_tag\ \ );}
\DoxyCodeLine{00197\ }
\DoxyCodeLine{00198\ \textcolor{preprocessor}{\#\ \ \ undef\ CDS\_SIGRCU\_DECLARE\_SINGLETON}}
\DoxyCodeLine{00199\ }
\DoxyCodeLine{00200\ \}\}\}\ \textcolor{comment}{//\ namespace\ cds::urcu::details}}
\DoxyCodeLine{00201\ \textcolor{comment}{//@endcond}}
\DoxyCodeLine{00202\ }
\DoxyCodeLine{00203\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ \#ifdef\ CDS\_URCU\_SIGNAL\_HANDLING\_ENABLED}}
\DoxyCodeLine{00204\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ \#ifndef\ CDSLIB\_URCU\_DETAILS\_SH\_DECL\_H}}

\end{DoxyCode}
