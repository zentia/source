\doxysection{poisson.\+hpp}
\hypertarget{poisson_8hpp_source}{}\label{poisson_8hpp_source}\index{external/taskflow/sandbox/jacobi/poisson.hpp@{external/taskflow/sandbox/jacobi/poisson.hpp}}
\mbox{\hyperlink{poisson_8hpp}{浏览该文件的文档.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#ifndef\ KASTORS\_POISSON\_H}}
\DoxyCodeLine{00002\ \textcolor{preprocessor}{\#define\ KASTORS\_POISSON\_H}}
\DoxyCodeLine{00003\ \textcolor{preprocessor}{\#include\ <cassert>}}
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#include\ <string>}}
\DoxyCodeLine{00005\ }
\DoxyCodeLine{00006\ \textcolor{comment}{/******************************************************************************/}}
\DoxyCodeLine{00007\ \textcolor{comment}{/*}}
\DoxyCodeLine{00008\ \textcolor{comment}{\ \ Purpose:}}
\DoxyCodeLine{00009\ \textcolor{comment}{}}
\DoxyCodeLine{00010\ \textcolor{comment}{\ \ SWEEP\ carries\ out\ one\ step\ of\ the\ Jacobi\ iteration.}}
\DoxyCodeLine{00011\ \textcolor{comment}{}}
\DoxyCodeLine{00012\ \textcolor{comment}{\ \ Discussion:}}
\DoxyCodeLine{00013\ \textcolor{comment}{}}
\DoxyCodeLine{00014\ \textcolor{comment}{\ \ Assuming\ DX\ =\ DY,\ we\ can\ approximate}}
\DoxyCodeLine{00015\ \textcolor{comment}{}}
\DoxyCodeLine{00016\ \textcolor{comment}{\ \ -\/\ (d/dx\ d/dx\ +\ d/dy\ d/dy)\ U(X,Y)}}
\DoxyCodeLine{00017\ \textcolor{comment}{}}
\DoxyCodeLine{00018\ \textcolor{comment}{\ \ by}}
\DoxyCodeLine{00019\ \textcolor{comment}{}}
\DoxyCodeLine{00020\ \textcolor{comment}{\ \ (U(i-\/1,j)\ +\ U(i+1,j)\ +\ U(i,j-\/1)\ +\ U(i,j+1)\ -\/\ 4*U(i,j))\ /\ dx\ /\ dy}}
\DoxyCodeLine{00021\ \textcolor{comment}{}}
\DoxyCodeLine{00022\ \textcolor{comment}{\ \ The\ discretization\ employed\ below\ will\ not\ be\ correct\ in\ the\ general}}
\DoxyCodeLine{00023\ \textcolor{comment}{\ \ case\ where\ DX\ and\ DY\ are\ not\ equal.\ \ It's\ only\ a\ little\ more\ complicated}}
\DoxyCodeLine{00024\ \textcolor{comment}{\ \ to\ allow\ DX\ and\ DY\ to\ be\ different,\ but\ we're\ not\ going\ to\ worry\ about}}
\DoxyCodeLine{00025\ \textcolor{comment}{\ \ that\ right\ now.}}
\DoxyCodeLine{00026\ \textcolor{comment}{}}
\DoxyCodeLine{00027\ \textcolor{comment}{\ \ Licensing:}}
\DoxyCodeLine{00028\ \textcolor{comment}{}}
\DoxyCodeLine{00029\ \textcolor{comment}{\ \ This\ code\ is\ distributed\ under\ the\ GNU\ LGPL\ license.}}
\DoxyCodeLine{00030\ \textcolor{comment}{}}
\DoxyCodeLine{00031\ \textcolor{comment}{\ \ Modified:}}
\DoxyCodeLine{00032\ \textcolor{comment}{}}
\DoxyCodeLine{00033\ \textcolor{comment}{\ \ 14\ December\ 2011}}
\DoxyCodeLine{00034\ \textcolor{comment}{}}
\DoxyCodeLine{00035\ \textcolor{comment}{\ \ Author:}}
\DoxyCodeLine{00036\ \textcolor{comment}{}}
\DoxyCodeLine{00037\ \textcolor{comment}{\ \ John\ Burkardt}}
\DoxyCodeLine{00038\ \textcolor{comment}{}}
\DoxyCodeLine{00039\ \textcolor{comment}{\ \ Parameters:}}
\DoxyCodeLine{00040\ \textcolor{comment}{}}
\DoxyCodeLine{00041\ \textcolor{comment}{\ \ Input,\ int\ NX,\ NY,\ the\ X\ and\ Y\ grid\ dimensions.}}
\DoxyCodeLine{00042\ \textcolor{comment}{}}
\DoxyCodeLine{00043\ \textcolor{comment}{\ \ Input,\ double\ DX,\ DY,\ the\ spacing\ between\ grid\ points.}}
\DoxyCodeLine{00044\ \textcolor{comment}{}}
\DoxyCodeLine{00045\ \textcolor{comment}{\ \ Input,\ double\ F[NX][NY],\ the\ right\ hand\ side\ data.}}
\DoxyCodeLine{00046\ \textcolor{comment}{}}
\DoxyCodeLine{00047\ \textcolor{comment}{\ \ Input,\ int\ ITOLD,\ the\ iteration\ index\ on\ input.}}
\DoxyCodeLine{00048\ \textcolor{comment}{}}
\DoxyCodeLine{00049\ \textcolor{comment}{\ \ Input,\ int\ ITNEW,\ the\ desired\ iteration\ index}}
\DoxyCodeLine{00050\ \textcolor{comment}{\ \ on\ output.}}
\DoxyCodeLine{00051\ \textcolor{comment}{}}
\DoxyCodeLine{00052\ \textcolor{comment}{\ \ Input,\ double\ U[NX][NY],\ the\ solution\ estimate\ on}}
\DoxyCodeLine{00053\ \textcolor{comment}{\ \ iteration\ ITNEW-\/1.}}
\DoxyCodeLine{00054\ \textcolor{comment}{}}
\DoxyCodeLine{00055\ \textcolor{comment}{\ \ Input/output,\ double\ UNEW[NX][NY],\ on\ input,\ the\ solution}}
\DoxyCodeLine{00056\ \textcolor{comment}{\ \ estimate\ on\ iteration\ ITOLD.\ \ On\ output,\ the\ solution\ estimate\ on}}
\DoxyCodeLine{00057\ \textcolor{comment}{\ \ iteration\ ITNEW.}}
\DoxyCodeLine{00058\ \textcolor{comment}{*/}}
\DoxyCodeLine{00059\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{poisson_8hpp_a25e7eadd06e716c1dc7cceb47e5fd40d}{sweep}}(\textcolor{keywordtype}{int}\ nx,\ \textcolor{keywordtype}{int}\ ny,\ \textcolor{keywordtype}{double}\ dx,\ \textcolor{keywordtype}{double}\ dy,\ \textcolor{keywordtype}{double}\ *\mbox{\hyperlink{cxx11__tensor__map_8cpp_a7f507fea02198f6cb81c86640c7b1a4e}{f}},}
\DoxyCodeLine{00060\ \ \ \ \ \ \textcolor{keywordtype}{int}\ itold,\ \textcolor{keywordtype}{int}\ itnew,\ \textcolor{keywordtype}{double}\ *\mbox{\hyperlink{external_2taskflow_23rd-party_2tbb_2examples_2parallel__for_2seismic_2main_8cpp_a2a671aca47b8db55cef1dd7174adad6f}{u}},\ \textcolor{keywordtype}{double}\ *unew,\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{sugar_8h_a9766f5ceca5e25981858ec7384456072}{block\_size}});}
\DoxyCodeLine{00061\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{poisson_8hpp_a263e0f774ef013be333712ca3915448a}{sweep\_seq}}(\textcolor{keywordtype}{int}\ nx,\ \textcolor{keywordtype}{int}\ ny,\ \textcolor{keywordtype}{double}\ dx,\ \textcolor{keywordtype}{double}\ dy,\ \textcolor{keywordtype}{double}\ *\mbox{\hyperlink{cxx11__tensor__map_8cpp_a7f507fea02198f6cb81c86640c7b1a4e}{f}},}
\DoxyCodeLine{00062\ \ \ \ \ \ \textcolor{keywordtype}{int}\ itold,\ \textcolor{keywordtype}{int}\ itnew,\ \textcolor{keywordtype}{double}\ *\mbox{\hyperlink{external_2taskflow_23rd-party_2tbb_2examples_2parallel__for_2seismic_2main_8cpp_a2a671aca47b8db55cef1dd7174adad6f}{u}},\ \textcolor{keywordtype}{double}\ *unew);}
\DoxyCodeLine{00063\ }
\DoxyCodeLine{00064\ }
\DoxyCodeLine{00065\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structuser__parameters}{user\_parameters}}\ \{}
\DoxyCodeLine{00066\ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{structuser__parameters_afaa73c9637610bbe3a2f4e9da3b53655}{check}};}
\DoxyCodeLine{00067\ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{structuser__parameters_aec58b13338a800f9d5221d0c934baaa3}{succeed}};}
\DoxyCodeLine{00068\ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{structuser__parameters_a9ad77a437ba87c74dfffc8624a11cea4}{niter}};}
\DoxyCodeLine{00069\ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{structuser__parameters_a6830b74fbddbff85a95110a679dcb5e9}{titer}};}
\DoxyCodeLine{00070\ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{structuser__parameters_ab12f8d1ed3465fbbf99ec3230b1d4f98}{matrix\_size}};}
\DoxyCodeLine{00071\ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{structuser__parameters_a00969b75b23513d551a7bbfbb6aa561b}{blocksize}};}
\DoxyCodeLine{00072\ \};}
\DoxyCodeLine{00073\ }
\DoxyCodeLine{00074\ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{poisson_8hpp_ae12af222b820baf64e953be588c5bbbe}{run}}(\textcolor{keyword}{struct}\ \mbox{\hyperlink{structuser__parameters}{user\_parameters}}*\ \mbox{\hyperlink{imgui__impl__opengl3__loader_8h_a22557289048c77f6913601e8537ceeea}{params}},\ \textcolor{keywordtype}{unsigned}\ num\_threads,\ std::string\ model);}
\DoxyCodeLine{00075\ }
\DoxyCodeLine{00076\ }
\DoxyCodeLine{00078\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{poisson_8hpp_a318b6ce1a29608c4bc16838c81cd5382}{omp\_block\_for}}(\textcolor{keywordtype}{int}\ nx,\ \textcolor{keywordtype}{int}\ ny,\ \textcolor{keywordtype}{double}\ dx,\ \textcolor{keywordtype}{double}\ dy,\ \textcolor{keywordtype}{double}\ *\mbox{\hyperlink{cxx11__tensor__map_8cpp_a7f507fea02198f6cb81c86640c7b1a4e}{f}},}
\DoxyCodeLine{00079\ \ \ \ \ \ \textcolor{keywordtype}{int}\ itold,\ \textcolor{keywordtype}{int}\ itnew,\ \textcolor{keywordtype}{double}\ *\mbox{\hyperlink{external_2taskflow_23rd-party_2tbb_2examples_2parallel__for_2seismic_2main_8cpp_a2a671aca47b8db55cef1dd7174adad6f}{u}},\ \textcolor{keywordtype}{double}\ *unew,\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{sugar_8h_a9766f5ceca5e25981858ec7384456072}{block\_size}});}
\DoxyCodeLine{00080\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{poisson_8hpp_a802c225396f0f0434a552ba7d8ad94e3}{omp\_block\_task}}(\textcolor{keywordtype}{int}\ nx,\ \textcolor{keywordtype}{int}\ ny,\ \textcolor{keywordtype}{double}\ dx,\ \textcolor{keywordtype}{double}\ dy,\ \textcolor{keywordtype}{double}\ *\mbox{\hyperlink{cxx11__tensor__map_8cpp_a7f507fea02198f6cb81c86640c7b1a4e}{f}},}
\DoxyCodeLine{00081\ \ \ \ \ \ \textcolor{keywordtype}{int}\ itold,\ \textcolor{keywordtype}{int}\ itnew,\ \textcolor{keywordtype}{double}\ *\mbox{\hyperlink{external_2taskflow_23rd-party_2tbb_2examples_2parallel__for_2seismic_2main_8cpp_a2a671aca47b8db55cef1dd7174adad6f}{u}},\ \textcolor{keywordtype}{double}\ *unew,\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{sugar_8h_a9766f5ceca5e25981858ec7384456072}{block\_size}});}
\DoxyCodeLine{00082\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{poisson_8hpp_ae2b8d1dda3c9328994371a137f29afab}{omp\_block\_task\_dep}}(\textcolor{keywordtype}{int}\ nx,\ \textcolor{keywordtype}{int}\ ny,\ \textcolor{keywordtype}{double}\ dx,\ \textcolor{keywordtype}{double}\ dy,\ \textcolor{keywordtype}{double}\ *\mbox{\hyperlink{cxx11__tensor__map_8cpp_a7f507fea02198f6cb81c86640c7b1a4e}{f}},}
\DoxyCodeLine{00083\ \ \ \ \ \ \textcolor{keywordtype}{int}\ itold,\ \textcolor{keywordtype}{int}\ itnew,\ \textcolor{keywordtype}{double}\ *\mbox{\hyperlink{external_2taskflow_23rd-party_2tbb_2examples_2parallel__for_2seismic_2main_8cpp_a2a671aca47b8db55cef1dd7174adad6f}{u}},\ \textcolor{keywordtype}{double}\ *unew,\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{sugar_8h_a9766f5ceca5e25981858ec7384456072}{block\_size}});}
\DoxyCodeLine{00084\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{poisson_8hpp_ad9b09dd18bde7bb03b1bbbf36fa48c81}{omp\_task}}(\textcolor{keywordtype}{int}\ nx,\ \textcolor{keywordtype}{int}\ ny,\ \textcolor{keywordtype}{double}\ dx,\ \textcolor{keywordtype}{double}\ dy,\ \textcolor{keywordtype}{double}\ *\mbox{\hyperlink{cxx11__tensor__map_8cpp_a7f507fea02198f6cb81c86640c7b1a4e}{f}},}
\DoxyCodeLine{00085\ \ \ \ \ \ \textcolor{keywordtype}{int}\ itold,\ \textcolor{keywordtype}{int}\ itnew,\ \textcolor{keywordtype}{double}\ *\mbox{\hyperlink{external_2taskflow_23rd-party_2tbb_2examples_2parallel__for_2seismic_2main_8cpp_a2a671aca47b8db55cef1dd7174adad6f}{u}},\ \textcolor{keywordtype}{double}\ *unew,\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{sugar_8h_a9766f5ceca5e25981858ec7384456072}{block\_size}});}
\DoxyCodeLine{00086\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{poisson_8hpp_a26b4490578dee7589edf1dc08b0c84c2}{omp\_task\_dep}}(\textcolor{keywordtype}{int}\ nx,\ \textcolor{keywordtype}{int}\ ny,\ \textcolor{keywordtype}{double}\ dx,\ \textcolor{keywordtype}{double}\ dy,\ \textcolor{keywordtype}{double}\ *\mbox{\hyperlink{cxx11__tensor__map_8cpp_a7f507fea02198f6cb81c86640c7b1a4e}{f}},}
\DoxyCodeLine{00087\ \ \ \ \ \ \textcolor{keywordtype}{int}\ itold,\ \textcolor{keywordtype}{int}\ itnew,\ \textcolor{keywordtype}{double}\ *\mbox{\hyperlink{external_2taskflow_23rd-party_2tbb_2examples_2parallel__for_2seismic_2main_8cpp_a2a671aca47b8db55cef1dd7174adad6f}{u}},\ \textcolor{keywordtype}{double}\ *unew,\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{sugar_8h_a9766f5ceca5e25981858ec7384456072}{block\_size}});}
\DoxyCodeLine{00089\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{poisson_8hpp_aa56fe360bb0ae38e0082f49e394ff825}{taskflow}}(\textcolor{keywordtype}{int}\ nx,\ \textcolor{keywordtype}{int}\ ny,\ \textcolor{keywordtype}{double}\ dx,\ \textcolor{keywordtype}{double}\ dy,\ \textcolor{keywordtype}{double}\ *\mbox{\hyperlink{cxx11__tensor__map_8cpp_a7f507fea02198f6cb81c86640c7b1a4e}{f}},}
\DoxyCodeLine{00090\ \ \ \ \ \ \textcolor{keywordtype}{int}\ itold,\ \textcolor{keywordtype}{int}\ itnew,\ \textcolor{keywordtype}{double}\ *\mbox{\hyperlink{external_2taskflow_23rd-party_2tbb_2examples_2parallel__for_2seismic_2main_8cpp_a2a671aca47b8db55cef1dd7174adad6f}{u}},\ \textcolor{keywordtype}{double}\ *unew,\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{sugar_8h_a9766f5ceca5e25981858ec7384456072}{block\_size}},\ \textcolor{keywordtype}{unsigned}\ num\_threads);}
\DoxyCodeLine{00092\ }
\DoxyCodeLine{00093\ }
\DoxyCodeLine{00094\ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{poisson_8hpp_a3f26bf5b07553e73c4d4e4f52d512a9a}{copy\_block}}(\textcolor{keywordtype}{int}\ nx,\ \textcolor{keywordtype}{int}\ ny,\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{sugar_8h_ad57b2cf729b59e2aadcb8c1fbf97ea7f}{block\_x}},\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{sugar_8h_a1818f23f420e6cdcc72fcc326c655a62}{block\_y}},\ \textcolor{keywordtype}{double}\ *u\_,\ \textcolor{keywordtype}{double}\ *unew\_,\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{sugar_8h_a9766f5ceca5e25981858ec7384456072}{block\_size}})\ \{}
\DoxyCodeLine{00095\ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}},\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}},\ start\_i,\ start\_j;}
\DoxyCodeLine{00096\ \ \ double\ (*\mbox{\hyperlink{external_2taskflow_23rd-party_2tbb_2examples_2parallel__for_2seismic_2main_8cpp_a2a671aca47b8db55cef1dd7174adad6f}{u}})[nx][ny]\ =\ (double\ (*)[nx][ny])u\_;}
\DoxyCodeLine{00097\ \ \ double\ (*unew)[nx][ny]\ =\ (double\ (*)[nx][ny])unew\_;}
\DoxyCodeLine{00098\ \ \ start\_i\ =\ \mbox{\hyperlink{sugar_8h_ad57b2cf729b59e2aadcb8c1fbf97ea7f}{block\_x}}\ *\ \mbox{\hyperlink{sugar_8h_a9766f5ceca5e25981858ec7384456072}{block\_size}};}
\DoxyCodeLine{00099\ \ \ start\_j\ =\ \mbox{\hyperlink{sugar_8h_a1818f23f420e6cdcc72fcc326c655a62}{block\_y}}\ *\ \mbox{\hyperlink{sugar_8h_a9766f5ceca5e25981858ec7384456072}{block\_size}};}
\DoxyCodeLine{00100\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ =\ start\_i;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ <\ start\_i\ +\ \mbox{\hyperlink{sugar_8h_a9766f5ceca5e25981858ec7384456072}{block\_size}};\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}++)\ \{}
\DoxyCodeLine{00101\ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}\ =\ start\_j;\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}\ <\ start\_j\ +\ \mbox{\hyperlink{sugar_8h_a9766f5ceca5e25981858ec7384456072}{block\_size}};\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}++)\ \{}
\DoxyCodeLine{00102\ \ \ \ \ \ \ assert((\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ <\ nx)\ \&\&\ (\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}\ <\ ny));}
\DoxyCodeLine{00103\ \ \ \ \ \ \ (*u)[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}][\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}]\ =\ (*unew)[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}][\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}];}
\DoxyCodeLine{00104\ \ \ \ \ \}}
\DoxyCodeLine{00105\ \ \ \}}
\DoxyCodeLine{00106\ \}}
\DoxyCodeLine{00107\ }
\DoxyCodeLine{00108\ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{poisson_8hpp_a6e5c51cdf9dd1cc36690848be109f72a}{compute\_estimate}}(\textcolor{keywordtype}{int}\ \mbox{\hyperlink{sugar_8h_ad57b2cf729b59e2aadcb8c1fbf97ea7f}{block\_x}},\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{sugar_8h_a1818f23f420e6cdcc72fcc326c655a62}{block\_y}},\ \textcolor{keywordtype}{double}\ *u\_,}
\DoxyCodeLine{00109\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ *unew\_,\ \textcolor{keywordtype}{double}\ *f\_,\ \textcolor{keywordtype}{double}\ dx,}
\DoxyCodeLine{00110\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ dy,\ \textcolor{keywordtype}{int}\ nx,\ \textcolor{keywordtype}{int}\ ny,\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{sugar_8h_a9766f5ceca5e25981858ec7384456072}{block\_size}})\ \{}
\DoxyCodeLine{00111\ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}},\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}},\ start\_i,\ start\_j;}
\DoxyCodeLine{00112\ \ \ double\ (*\mbox{\hyperlink{cxx11__tensor__map_8cpp_a7f507fea02198f6cb81c86640c7b1a4e}{f}})[nx][ny]\ =\ (double\ (*)[nx][ny])f\_;}
\DoxyCodeLine{00113\ \ \ double\ (*\mbox{\hyperlink{external_2taskflow_23rd-party_2tbb_2examples_2parallel__for_2seismic_2main_8cpp_a2a671aca47b8db55cef1dd7174adad6f}{u}})[nx][ny]\ =\ (double\ (*)[nx][ny])u\_;}
\DoxyCodeLine{00114\ \ \ double\ (*unew)[nx][ny]\ =\ (double\ (*)[nx][ny])unew\_;}
\DoxyCodeLine{00115\ \ \ start\_i\ =\ \mbox{\hyperlink{sugar_8h_ad57b2cf729b59e2aadcb8c1fbf97ea7f}{block\_x}}\ *\ \mbox{\hyperlink{sugar_8h_a9766f5ceca5e25981858ec7384456072}{block\_size}};}
\DoxyCodeLine{00116\ \ \ start\_j\ =\ \mbox{\hyperlink{sugar_8h_a1818f23f420e6cdcc72fcc326c655a62}{block\_y}}\ *\ \mbox{\hyperlink{sugar_8h_a9766f5ceca5e25981858ec7384456072}{block\_size}};}
\DoxyCodeLine{00117\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ =\ start\_i;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ <\ start\_i\ +\ \mbox{\hyperlink{sugar_8h_a9766f5ceca5e25981858ec7384456072}{block\_size}};\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}++)\ \{}
\DoxyCodeLine{00118\ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}\ =\ start\_j;\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}\ <\ start\_j\ +\ \mbox{\hyperlink{sugar_8h_a9766f5ceca5e25981858ec7384456072}{block\_size}};\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}++)\ \{}
\DoxyCodeLine{00119\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ ==\ 0\ ||\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}\ ==\ 0\ ||\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ ==\ nx\ -\/\ 1\ ||\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}\ ==\ ny\ -\/\ 1)\ \{}
\DoxyCodeLine{00120\ \ \ \ \ \ \ \ \ (*unew)[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}][\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}]\ =\ (*f)[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}][\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}];}
\DoxyCodeLine{00121\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00122\ \ \ \ \ \ \ \ \ (*unew)[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}][\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}]\ =\ 0.25\ *\ ((*u)[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}-\/1][\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}]\ +\ (*u)[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}][\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}+1]}
\DoxyCodeLine{00123\ \ \ \ \ \ \ \ \ \ \ \ \ +\ (*u)[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}][\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}-\/1]\ +\ (*u)[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}+1][\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}]}
\DoxyCodeLine{00124\ \ \ \ \ \ \ \ \ \ \ \ \ +\ (*f)[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}][\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}]\ *\ dx\ *\ dy);}
\DoxyCodeLine{00125\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00126\ \ \ \ \ \}}
\DoxyCodeLine{00127\ \ \ \}}
\DoxyCodeLine{00128\ \}}
\DoxyCodeLine{00129\ }
\DoxyCodeLine{00130\ }
\DoxyCodeLine{00131\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{poisson_8hpp_a263e0f774ef013be333712ca3915448a}{sweep\_seq}}(\textcolor{keywordtype}{int}\ nx,\ \textcolor{keywordtype}{int}\ ny,\ \textcolor{keywordtype}{double}\ dx,\ \textcolor{keywordtype}{double}\ dy,\ \textcolor{keywordtype}{double}\ *f\_,}
\DoxyCodeLine{00132\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ itold,\ \textcolor{keywordtype}{int}\ itnew,\ \textcolor{keywordtype}{double}\ *u\_,\ \textcolor{keywordtype}{double}\ *unew\_)}
\DoxyCodeLine{00133\ \{}
\DoxyCodeLine{00134\ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}};}
\DoxyCodeLine{00135\ \ \ \textcolor{keywordtype}{int}\ it;}
\DoxyCodeLine{00136\ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}};}
\DoxyCodeLine{00137\ \ \ double\ (*\mbox{\hyperlink{cxx11__tensor__map_8cpp_a7f507fea02198f6cb81c86640c7b1a4e}{f}})[nx][ny]\ =\ (double\ (*)[nx][ny])f\_;}
\DoxyCodeLine{00138\ \ \ double\ (*\mbox{\hyperlink{external_2taskflow_23rd-party_2tbb_2examples_2parallel__for_2seismic_2main_8cpp_a2a671aca47b8db55cef1dd7174adad6f}{u}})[nx][ny]\ =\ (double\ (*)[nx][ny])u\_;}
\DoxyCodeLine{00139\ \ \ double\ (*unew)[nx][ny]\ =\ (double\ (*)[nx][ny])unew\_;}
\DoxyCodeLine{00140\ }
\DoxyCodeLine{00141\ \ \ \textcolor{keywordflow}{for}\ (it\ =\ itold\ +\ 1;\ it\ <=\ itnew;\ it++)\ \{}
\DoxyCodeLine{00142\ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ =\ 0;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ <\ nx;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}++)\ \{}
\DoxyCodeLine{00143\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}\ =\ 0;\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}\ <\ ny;\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}++)\ \{}
\DoxyCodeLine{00144\ \ \ \ \ \ \ \ \ (*u)[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}][\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}]\ =\ (*unew)[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}][\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}];}
\DoxyCodeLine{00145\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00146\ \ \ \ \ \}}
\DoxyCodeLine{00147\ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ =\ 0;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ <\ nx;\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}++)\ \{}
\DoxyCodeLine{00148\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}\ =\ 0;\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}\ <\ ny;\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}++)\ \{}
\DoxyCodeLine{00149\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ ==\ 0\ ||\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}\ ==\ 0\ ||\ \mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}\ ==\ nx\ -\/\ 1\ ||\ \mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}\ ==\ ny\ -\/\ 1)\ \{}
\DoxyCodeLine{00150\ \ \ \ \ \ \ \ \ \ \ (*unew)[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}][\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}]\ =\ (*f)[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}][\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}];}
\DoxyCodeLine{00151\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00152\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00153\ \ \ \ \ \ \ \ \ \ \ (*unew)[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}][\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}]\ =\ 0.25\ *\ ((*u)[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}-\/1][\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}]\ +\ (*u)[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}][\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}+1]}
\DoxyCodeLine{00154\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ +\ (*u)[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}][\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}-\/1]\ +\ (*u)[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}+1][\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}]}
\DoxyCodeLine{00155\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ +\ (*f)[\mbox{\hyperlink{_bi_c_g_s_t_a_b__step__by__step_8cpp_acb559820d9ca11295b4500f179ef6392}{i}}][\mbox{\hyperlink{tut__arithmetic__redux__minmax_8cpp_a39513f0f8d942bf9ef17b2e87ac6d34e}{j}}]\ *\ dx\ *\ dy);}
\DoxyCodeLine{00156\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00157\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00158\ \ \ \ \ \}}
\DoxyCodeLine{00159\ \ \ \}}
\DoxyCodeLine{00160\ \}}
\DoxyCodeLine{00161\ }
\DoxyCodeLine{00162\ \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
