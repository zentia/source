\doxysection{transform.\+hpp}
\hypertarget{algorithm_2transform_8hpp_source}{}\label{algorithm_2transform_8hpp_source}\index{external/taskflow/taskflow/algorithm/transform.hpp@{external/taskflow/taskflow/algorithm/transform.hpp}}
\mbox{\hyperlink{algorithm_2transform_8hpp}{浏览该文件的文档.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00002\ }
\DoxyCodeLine{00003\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{taskflow_8hpp}{../taskflow.hpp}}"{}}}
\DoxyCodeLine{00004\ }
\DoxyCodeLine{00005\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespacetf}{tf}}\ \{}
\DoxyCodeLine{00006\ }
\DoxyCodeLine{00007\ \textcolor{comment}{//\ Function:\ make\_transform\_task}}
\DoxyCodeLine{00008\ \textcolor{keyword}{template}\ <}
\DoxyCodeLine{00009\ \ \ \textcolor{keyword}{typename}\ \mbox{\hyperlink{bench__gemm_8cpp_a37a83060ac796961b44991c836f083f7}{B}},\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{sandbox_2strassen_2omp_8cpp_a4bfa035cad7c3258704669810cd5de5d}{E}},\ \textcolor{keyword}{typename}\ O,\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}},\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{_direction_wise__hnormalized_8cpp_a98fb883180cbb2e5412955dfd6edb605}{P}}\ =\ \mbox{\hyperlink{namespacetf_ace2c5adcd5039483eebb6dbdbb6f33e3}{DefaultPartitioner}},}
\DoxyCodeLine{00010\ \ \ std::enable\_if\_t<is\_partitioner\_v<std::decay\_t<P>>,\ \textcolor{keywordtype}{void}>*\ =\ \textcolor{keyword}{nullptr}}
\DoxyCodeLine{00011\ >}
\DoxyCodeLine{00012\ \textcolor{keyword}{auto}\ \mbox{\hyperlink{namespacetf_a58c3a7d1ee010c70bce6d945bc80cf05}{make\_transform\_task}}(\mbox{\hyperlink{bench__gemm_8cpp_a37a83060ac796961b44991c836f083f7}{B}}\ first1,\ \mbox{\hyperlink{sandbox_2strassen_2omp_8cpp_a4bfa035cad7c3258704669810cd5de5d}{E}}\ last1,\ O\ d\_first,\ \mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}}\ \mbox{\hyperlink{bench_vec_add_8cpp_a41689956983587b085f9da3e48f31d99}{c}},\ \mbox{\hyperlink{namespace_p}{P}}\ part\ =\ \mbox{\hyperlink{namespace_p}{P}}())\ \{}
\DoxyCodeLine{00013\ \ \ }
\DoxyCodeLine{00014\ \ \ \textcolor{keyword}{using\ namespace\ }std::string\_literals;}
\DoxyCodeLine{00015\ }
\DoxyCodeLine{00016\ \ \ \textcolor{keyword}{using\ }B\_t\ =\ std::decay\_t<unwrap\_ref\_decay\_t<B>>;}
\DoxyCodeLine{00017\ \ \ \textcolor{keyword}{using\ }E\_t\ =\ std::decay\_t<unwrap\_ref\_decay\_t<E>>;}
\DoxyCodeLine{00018\ \ \ \textcolor{keyword}{using\ }O\_t\ =\ std::decay\_t<unwrap\_ref\_decay\_t<O>>;}
\DoxyCodeLine{00019\ \ \ }
\DoxyCodeLine{00020\ \ \ \textcolor{keywordflow}{return}\ [=]\ (\mbox{\hyperlink{classtf_1_1_runtime}{Runtime}}\&\ rt)\ \textcolor{keyword}{mutable}\ \{}
\DoxyCodeLine{00021\ }
\DoxyCodeLine{00022\ \ \ \ \ \textcolor{comment}{//\ fetch\ the\ stateful\ values}}
\DoxyCodeLine{00023\ \ \ \ \ B\_t\ beg\ \ \ =\ first1;}
\DoxyCodeLine{00024\ \ \ \ \ E\_t\ \mbox{\hyperlink{ittnotify__static_8h_a30bf4ccd4623b7a8276bbc7f99e491c7}{end}}\ \ \ =\ last1;}
\DoxyCodeLine{00025\ \ \ \ \ O\_t\ d\_beg\ =\ d\_first;}
\DoxyCodeLine{00026\ }
\DoxyCodeLine{00027\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{test__flow__graph_8cpp_ab21b528bc38899d04d3a7053e52fb797}{W}}\ =\ rt.executor().num\_workers();}
\DoxyCodeLine{00028\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{main-override-static_8c_a0240ac851181b84ac374872dc5434ee4}{N}}\ =\ std::distance(beg,\ \mbox{\hyperlink{ittnotify__static_8h_a30bf4ccd4623b7a8276bbc7f99e491c7}{end}});}
\DoxyCodeLine{00029\ }
\DoxyCodeLine{00030\ \ \ \ \ \textcolor{comment}{//\ only\ myself\ -\/\ no\ need\ to\ spawn\ another\ graph}}
\DoxyCodeLine{00031\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{test__flow__graph_8cpp_ab21b528bc38899d04d3a7053e52fb797}{W}}\ <=\ 1\ ||\ \mbox{\hyperlink{main-override-static_8c_a0240ac851181b84ac374872dc5434ee4}{N}}\ <=\ part.chunk\_size())\ \{}
\DoxyCodeLine{00032\ \ \ \ \ \ \ part([=]()\ \textcolor{keyword}{mutable}\ \{\ std::transform(beg,\ \mbox{\hyperlink{ittnotify__static_8h_a30bf4ccd4623b7a8276bbc7f99e491c7}{end}},\ d\_beg,\ \mbox{\hyperlink{bench_vec_add_8cpp_a41689956983587b085f9da3e48f31d99}{c}});\ \})();}
\DoxyCodeLine{00033\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00034\ \ \ \ \ \}}
\DoxyCodeLine{00035\ }
\DoxyCodeLine{00036\ \ \ \ \ \mbox{\hyperlink{classtf_1_1_preemption_guard}{PreemptionGuard}}\ preemption\_guard(rt);}
\DoxyCodeLine{00037\ \ \ \ \ }
\DoxyCodeLine{00038\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{main-override-static_8c_a0240ac851181b84ac374872dc5434ee4}{N}}\ <\ \mbox{\hyperlink{test__flow__graph_8cpp_ab21b528bc38899d04d3a7053e52fb797}{W}})\ \{}
\DoxyCodeLine{00039\ \ \ \ \ \ \ \mbox{\hyperlink{test__flow__graph_8cpp_ab21b528bc38899d04d3a7053e52fb797}{W}}\ =\ \mbox{\hyperlink{main-override-static_8c_a0240ac851181b84ac374872dc5434ee4}{N}};}
\DoxyCodeLine{00040\ \ \ \ \ \}}
\DoxyCodeLine{00041\ }
\DoxyCodeLine{00042\ \ \ \ \ \textcolor{comment}{//\ static\ partitioner}}
\DoxyCodeLine{00043\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}(part.type()\ ==\ \mbox{\hyperlink{namespacetf_a32d51425fa23cd0dc3518c16cf3bb6c0afe6f99ef1ec99efbdc19a9786cf1facc}{PartitionerType::STATIC}})\ \{}
\DoxyCodeLine{00044\ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{_matrix__resize__int_8cpp_aab236ce080522c9832217fd5f157541b}{w}}=0,\ curr\_b=0;\ \mbox{\hyperlink{_matrix__resize__int_8cpp_aab236ce080522c9832217fd5f157541b}{w}}<\mbox{\hyperlink{test__flow__graph_8cpp_ab21b528bc38899d04d3a7053e52fb797}{W}}\ \&\&\ curr\_b\ <\ \mbox{\hyperlink{main-override-static_8c_a0240ac851181b84ac374872dc5434ee4}{N}};)\ \{}
\DoxyCodeLine{00045\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ chunk\_size\ =\ part.adjusted\_chunk\_size(\mbox{\hyperlink{main-override-static_8c_a0240ac851181b84ac374872dc5434ee4}{N}},\ \mbox{\hyperlink{test__flow__graph_8cpp_ab21b528bc38899d04d3a7053e52fb797}{W}},\ \mbox{\hyperlink{_matrix__resize__int_8cpp_aab236ce080522c9832217fd5f157541b}{w}});}
\DoxyCodeLine{00046\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ \mbox{\hyperlink{test__partitioner__whitebox_8h_a5c4cf3d37a4eee22275de22cb9619863}{task}}\ =\ part([=]\ ()\ \textcolor{keyword}{mutable}\ \{}
\DoxyCodeLine{00047\ \ \ \ \ \ \ \ \ \ \ part.loop(\mbox{\hyperlink{main-override-static_8c_a0240ac851181b84ac374872dc5434ee4}{N}},\ \mbox{\hyperlink{test__flow__graph_8cpp_ab21b528bc38899d04d3a7053e52fb797}{W}},\ curr\_b,\ chunk\_size,\ [=,\ prev\_e=\textcolor{keywordtype}{size\_t}\{0\}](\textcolor{keywordtype}{size\_t}\ part\_b,\ \textcolor{keywordtype}{size\_t}\ part\_e)\ \textcolor{keyword}{mutable}\ \{}
\DoxyCodeLine{00048\ \ \ \ \ \ \ \ \ \ \ \ \ std::advance(beg,\ part\_b\ -\/\ prev\_e);}
\DoxyCodeLine{00049\ \ \ \ \ \ \ \ \ \ \ \ \ std::advance(d\_beg,\ part\_b\ -\/\ prev\_e);}
\DoxyCodeLine{00050\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}}\ =\ part\_b;\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}}<part\_e;\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}}++)\ \{}
\DoxyCodeLine{00051\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *d\_beg++\ =\ \mbox{\hyperlink{bench_vec_add_8cpp_a41689956983587b085f9da3e48f31d99}{c}}(*beg++);}
\DoxyCodeLine{00052\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00053\ \ \ \ \ \ \ \ \ \ \ \ \ prev\_e\ =\ part\_e;}
\DoxyCodeLine{00054\ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{00055\ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{00056\ \ \ \ \ \ \ \ \ (++\mbox{\hyperlink{_matrix__resize__int_8cpp_aab236ce080522c9832217fd5f157541b}{w}}\ ==\ \mbox{\hyperlink{test__flow__graph_8cpp_ab21b528bc38899d04d3a7053e52fb797}{W}}\ ||\ (curr\_b\ +=\ chunk\_size)\ >=\ \mbox{\hyperlink{main-override-static_8c_a0240ac851181b84ac374872dc5434ee4}{N}})\ ?\ \mbox{\hyperlink{test__partitioner__whitebox_8h_a5c4cf3d37a4eee22275de22cb9619863}{task}}()\ :\ rt.silent\_async(\mbox{\hyperlink{test__partitioner__whitebox_8h_a5c4cf3d37a4eee22275de22cb9619863}{task}});}
\DoxyCodeLine{00057\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00058\ \ \ \ \ \}}
\DoxyCodeLine{00059\ \ \ \ \ \textcolor{comment}{//\ dynamic\ partitioner}}
\DoxyCodeLine{00060\ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00061\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ next\ =\ std::make\_shared<std::atomic<size\_t>>(0);}
\DoxyCodeLine{00062\ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{_matrix__resize__int_8cpp_aab236ce080522c9832217fd5f157541b}{w}}=0;\ \mbox{\hyperlink{_matrix__resize__int_8cpp_aab236ce080522c9832217fd5f157541b}{w}}<\mbox{\hyperlink{test__flow__graph_8cpp_ab21b528bc38899d04d3a7053e52fb797}{W}};)\ \{}
\DoxyCodeLine{00063\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ \mbox{\hyperlink{test__partitioner__whitebox_8h_a5c4cf3d37a4eee22275de22cb9619863}{task}}\ =\ part([=]\ ()\ \textcolor{keyword}{mutable}\ \{}
\DoxyCodeLine{00064\ \ \ \ \ \ \ \ \ \ \ part.loop(\mbox{\hyperlink{main-override-static_8c_a0240ac851181b84ac374872dc5434ee4}{N}},\ \mbox{\hyperlink{test__flow__graph_8cpp_ab21b528bc38899d04d3a7053e52fb797}{W}},\ *next,\ [=,\ prev\_e=\textcolor{keywordtype}{size\_t}\{0\}](\textcolor{keywordtype}{size\_t}\ part\_b,\ \textcolor{keywordtype}{size\_t}\ part\_e)\ \textcolor{keyword}{mutable}\ \{}
\DoxyCodeLine{00065\ \ \ \ \ \ \ \ \ \ \ \ \ std::advance(beg,\ part\_b\ -\/\ prev\_e);}
\DoxyCodeLine{00066\ \ \ \ \ \ \ \ \ \ \ \ \ std::advance(d\_beg,\ part\_b\ -\/\ prev\_e);}
\DoxyCodeLine{00067\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}}\ =\ part\_b;\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}}<part\_e;\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}}++)\ \{}
\DoxyCodeLine{00068\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *d\_beg++\ =\ \mbox{\hyperlink{bench_vec_add_8cpp_a41689956983587b085f9da3e48f31d99}{c}}(*beg++);}
\DoxyCodeLine{00069\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00070\ \ \ \ \ \ \ \ \ \ \ \ \ prev\_e\ =\ part\_e;}
\DoxyCodeLine{00071\ \ \ \ \ \ \ \ \ \ \ \});\ }
\DoxyCodeLine{00072\ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{00073\ \ \ \ \ \ \ \ \ (++\mbox{\hyperlink{_matrix__resize__int_8cpp_aab236ce080522c9832217fd5f157541b}{w}}\ ==\ \mbox{\hyperlink{test__flow__graph_8cpp_ab21b528bc38899d04d3a7053e52fb797}{W}})\ ?\ \mbox{\hyperlink{test__partitioner__whitebox_8h_a5c4cf3d37a4eee22275de22cb9619863}{task}}()\ :\ rt.silent\_async(\mbox{\hyperlink{test__partitioner__whitebox_8h_a5c4cf3d37a4eee22275de22cb9619863}{task}});}
\DoxyCodeLine{00074\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00075\ \ \ \ \ \}}
\DoxyCodeLine{00076\ \ \ \};}
\DoxyCodeLine{00077\ \}}
\DoxyCodeLine{00078\ }
\DoxyCodeLine{00079\ \textcolor{comment}{//\ Function:\ make\_transform\_task}}
\DoxyCodeLine{00080\ \textcolor{keyword}{template}\ <}
\DoxyCodeLine{00081\ \ \ \textcolor{keyword}{typename}\ B1,\ \textcolor{keyword}{typename}\ E1,\ \textcolor{keyword}{typename}\ B2,\ \textcolor{keyword}{typename}\ O,\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}},\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{namespace_p}{P}}\ =\ \mbox{\hyperlink{namespacetf_ace2c5adcd5039483eebb6dbdbb6f33e3}{DefaultPartitioner}},}
\DoxyCodeLine{00082\ \ \ std::enable\_if\_t<!is\_partitioner\_v<std::decay\_t<C>>,\ \textcolor{keywordtype}{void}>*\ =\ \textcolor{keyword}{nullptr}}
\DoxyCodeLine{00083\ >}
\DoxyCodeLine{00084\ \textcolor{keyword}{auto}\ \mbox{\hyperlink{namespacetf_a58c3a7d1ee010c70bce6d945bc80cf05}{make\_transform\_task}}(B1\ first1,\ E1\ last1,\ B2\ first2,\ O\ d\_first,\ \mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}}\ \mbox{\hyperlink{bench_vec_add_8cpp_a41689956983587b085f9da3e48f31d99}{c}},\ \mbox{\hyperlink{namespace_p}{P}}\ part\ =\ \mbox{\hyperlink{namespace_p}{P}}())\ \{}
\DoxyCodeLine{00085\ \ \ }
\DoxyCodeLine{00086\ \ \ \textcolor{keyword}{using\ namespace\ }std::string\_literals;}
\DoxyCodeLine{00087\ }
\DoxyCodeLine{00088\ \ \ \textcolor{keyword}{using\ }B1\_t\ =\ std::decay\_t<unwrap\_ref\_decay\_t<B1>>;}
\DoxyCodeLine{00089\ \ \ \textcolor{keyword}{using\ }E1\_t\ =\ std::decay\_t<unwrap\_ref\_decay\_t<E1>>;}
\DoxyCodeLine{00090\ \ \ \textcolor{keyword}{using\ }B2\_t\ =\ std::decay\_t<unwrap\_ref\_decay\_t<B2>>;}
\DoxyCodeLine{00091\ \ \ \textcolor{keyword}{using\ }O\_t\ =\ std::decay\_t<unwrap\_ref\_decay\_t<O>>;}
\DoxyCodeLine{00092\ }
\DoxyCodeLine{00093\ \ \ \textcolor{keywordflow}{return}\ [=]\ (\mbox{\hyperlink{classtf_1_1_runtime}{Runtime}}\&\ rt)\ \textcolor{keyword}{mutable}\ \{}
\DoxyCodeLine{00094\ }
\DoxyCodeLine{00095\ \ \ \ \ \textcolor{comment}{//\ fetch\ the\ stateful\ values}}
\DoxyCodeLine{00096\ \ \ \ \ B1\_t\ beg1\ =\ first1;}
\DoxyCodeLine{00097\ \ \ \ \ E1\_t\ end1\ =\ last1;}
\DoxyCodeLine{00098\ \ \ \ \ B2\_t\ beg2\ =\ first2;}
\DoxyCodeLine{00099\ \ \ \ \ O\_t\ d\_beg\ =\ d\_first;}
\DoxyCodeLine{00100\ }
\DoxyCodeLine{00101\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{test__flow__graph_8cpp_ab21b528bc38899d04d3a7053e52fb797}{W}}\ =\ rt.executor().num\_workers();}
\DoxyCodeLine{00102\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{main-override-static_8c_a0240ac851181b84ac374872dc5434ee4}{N}}\ =\ std::distance(beg1,\ end1);}
\DoxyCodeLine{00103\ }
\DoxyCodeLine{00104\ \ \ \ \ \textcolor{comment}{//\ only\ myself\ -\/\ no\ need\ to\ spawn\ another\ graph}}
\DoxyCodeLine{00105\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{test__flow__graph_8cpp_ab21b528bc38899d04d3a7053e52fb797}{W}}\ <=\ 1\ ||\ \mbox{\hyperlink{main-override-static_8c_a0240ac851181b84ac374872dc5434ee4}{N}}\ <=\ part.chunk\_size())\ \{}
\DoxyCodeLine{00106\ \ \ \ \ \ \ part([=]()\ \textcolor{keyword}{mutable}\ \{\ std::transform(beg1,\ end1,\ beg2,\ d\_beg,\ \mbox{\hyperlink{bench_vec_add_8cpp_a41689956983587b085f9da3e48f31d99}{c}});\ \})();}
\DoxyCodeLine{00107\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00108\ \ \ \ \ \}}
\DoxyCodeLine{00109\ \ \ \ \ }
\DoxyCodeLine{00110\ \ \ \ \ \mbox{\hyperlink{classtf_1_1_preemption_guard}{PreemptionGuard}}\ preemption\_guard(rt);}
\DoxyCodeLine{00111\ }
\DoxyCodeLine{00112\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{main-override-static_8c_a0240ac851181b84ac374872dc5434ee4}{N}}\ <\ \mbox{\hyperlink{test__flow__graph_8cpp_ab21b528bc38899d04d3a7053e52fb797}{W}})\ \{}
\DoxyCodeLine{00113\ \ \ \ \ \ \ \mbox{\hyperlink{test__flow__graph_8cpp_ab21b528bc38899d04d3a7053e52fb797}{W}}\ =\ \mbox{\hyperlink{main-override-static_8c_a0240ac851181b84ac374872dc5434ee4}{N}};}
\DoxyCodeLine{00114\ \ \ \ \ \}}
\DoxyCodeLine{00115\ }
\DoxyCodeLine{00116\ \ \ \ \ \textcolor{comment}{//\ static\ partitioner}}
\DoxyCodeLine{00117\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}(part.type()\ ==\ \mbox{\hyperlink{namespacetf_a32d51425fa23cd0dc3518c16cf3bb6c0afe6f99ef1ec99efbdc19a9786cf1facc}{PartitionerType::STATIC}})\ \{}
\DoxyCodeLine{00118\ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{_matrix__resize__int_8cpp_aab236ce080522c9832217fd5f157541b}{w}}=0,\ curr\_b=0;\ \mbox{\hyperlink{_matrix__resize__int_8cpp_aab236ce080522c9832217fd5f157541b}{w}}<\mbox{\hyperlink{test__flow__graph_8cpp_ab21b528bc38899d04d3a7053e52fb797}{W}}\ \&\&\ curr\_b\ <\ \mbox{\hyperlink{main-override-static_8c_a0240ac851181b84ac374872dc5434ee4}{N}};)\ \{}
\DoxyCodeLine{00119\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ chunk\_size\ =\ part.adjusted\_chunk\_size(\mbox{\hyperlink{main-override-static_8c_a0240ac851181b84ac374872dc5434ee4}{N}},\ \mbox{\hyperlink{test__flow__graph_8cpp_ab21b528bc38899d04d3a7053e52fb797}{W}},\ \mbox{\hyperlink{_matrix__resize__int_8cpp_aab236ce080522c9832217fd5f157541b}{w}});}
\DoxyCodeLine{00120\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ \mbox{\hyperlink{test__partitioner__whitebox_8h_a5c4cf3d37a4eee22275de22cb9619863}{task}}\ =\ part([=]\ ()\ \textcolor{keyword}{mutable}\ \{}
\DoxyCodeLine{00121\ \ \ \ \ \ \ \ \ \ \ part.loop(\mbox{\hyperlink{main-override-static_8c_a0240ac851181b84ac374872dc5434ee4}{N}},\ \mbox{\hyperlink{test__flow__graph_8cpp_ab21b528bc38899d04d3a7053e52fb797}{W}},\ curr\_b,\ chunk\_size,\ [=,\ prev\_e=\textcolor{keywordtype}{size\_t}\{0\}](\textcolor{keywordtype}{size\_t}\ part\_b,\ \textcolor{keywordtype}{size\_t}\ part\_e)\ \textcolor{keyword}{mutable}\ \{}
\DoxyCodeLine{00122\ \ \ \ \ \ \ \ \ \ \ \ \ std::advance(beg1,\ part\_b\ -\/\ prev\_e);}
\DoxyCodeLine{00123\ \ \ \ \ \ \ \ \ \ \ \ \ std::advance(beg2,\ part\_b\ -\/\ prev\_e);}
\DoxyCodeLine{00124\ \ \ \ \ \ \ \ \ \ \ \ \ std::advance(d\_beg,\ part\_b\ -\/\ prev\_e);}
\DoxyCodeLine{00125\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}}\ =\ part\_b;\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}}<part\_e;\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}}++)\ \{}
\DoxyCodeLine{00126\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *d\_beg++\ =\ \mbox{\hyperlink{bench_vec_add_8cpp_a41689956983587b085f9da3e48f31d99}{c}}(*beg1++,\ *beg2++);}
\DoxyCodeLine{00127\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00128\ \ \ \ \ \ \ \ \ \ \ \ \ prev\_e\ =\ part\_e;}
\DoxyCodeLine{00129\ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{00130\ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{00131\ \ \ \ \ \ \ \ \ (++\mbox{\hyperlink{_matrix__resize__int_8cpp_aab236ce080522c9832217fd5f157541b}{w}}\ ==\ \mbox{\hyperlink{test__flow__graph_8cpp_ab21b528bc38899d04d3a7053e52fb797}{W}}\ ||\ (curr\_b\ +=\ chunk\_size)\ >=\ \mbox{\hyperlink{main-override-static_8c_a0240ac851181b84ac374872dc5434ee4}{N}})\ ?\ \mbox{\hyperlink{test__partitioner__whitebox_8h_a5c4cf3d37a4eee22275de22cb9619863}{task}}()\ :\ rt.silent\_async(\mbox{\hyperlink{test__partitioner__whitebox_8h_a5c4cf3d37a4eee22275de22cb9619863}{task}});}
\DoxyCodeLine{00132\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00133\ \ \ \ \ \}}
\DoxyCodeLine{00134\ \ \ \ \ \textcolor{comment}{//\ dynamic\ partitioner}}
\DoxyCodeLine{00135\ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00136\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ next\ =\ std::make\_shared<std::atomic<size\_t>>(0);}
\DoxyCodeLine{00137\ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{_matrix__resize__int_8cpp_aab236ce080522c9832217fd5f157541b}{w}}=0;\ \mbox{\hyperlink{_matrix__resize__int_8cpp_aab236ce080522c9832217fd5f157541b}{w}}<\mbox{\hyperlink{test__flow__graph_8cpp_ab21b528bc38899d04d3a7053e52fb797}{W}};)\ \{}
\DoxyCodeLine{00138\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ \mbox{\hyperlink{test__partitioner__whitebox_8h_a5c4cf3d37a4eee22275de22cb9619863}{task}}\ =\ part([=]\ ()\ \textcolor{keyword}{mutable}\ \{}
\DoxyCodeLine{00139\ \ \ \ \ \ \ \ \ \ \ part.loop(\mbox{\hyperlink{main-override-static_8c_a0240ac851181b84ac374872dc5434ee4}{N}},\ \mbox{\hyperlink{test__flow__graph_8cpp_ab21b528bc38899d04d3a7053e52fb797}{W}},\ *next,\ [=,\ prev\_e=\textcolor{keywordtype}{size\_t}\{0\}](\textcolor{keywordtype}{size\_t}\ part\_b,\ \textcolor{keywordtype}{size\_t}\ part\_e)\ \textcolor{keyword}{mutable}\ \{}
\DoxyCodeLine{00140\ \ \ \ \ \ \ \ \ \ \ \ \ std::advance(beg1,\ part\_b\ -\/\ prev\_e);}
\DoxyCodeLine{00141\ \ \ \ \ \ \ \ \ \ \ \ \ std::advance(beg2,\ part\_b\ -\/\ prev\_e);}
\DoxyCodeLine{00142\ \ \ \ \ \ \ \ \ \ \ \ \ std::advance(d\_beg,\ part\_b\ -\/\ prev\_e);}
\DoxyCodeLine{00143\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}}\ =\ part\_b;\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}}<part\_e;\ \mbox{\hyperlink{offscreen_8c_a5fd331c99e778f04762be6d8173eb4d2}{x}}++)\ \{}
\DoxyCodeLine{00144\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *d\_beg++\ =\ \mbox{\hyperlink{bench_vec_add_8cpp_a41689956983587b085f9da3e48f31d99}{c}}(*beg1++,\ *beg2++);}
\DoxyCodeLine{00145\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00146\ \ \ \ \ \ \ \ \ \ \ \ \ prev\_e\ =\ part\_e;}
\DoxyCodeLine{00147\ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{00148\ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{00149\ \ \ \ \ \ \ \ \ (++\mbox{\hyperlink{_matrix__resize__int_8cpp_aab236ce080522c9832217fd5f157541b}{w}}\ ==\ \mbox{\hyperlink{test__flow__graph_8cpp_ab21b528bc38899d04d3a7053e52fb797}{W}})\ ?\ \mbox{\hyperlink{test__partitioner__whitebox_8h_a5c4cf3d37a4eee22275de22cb9619863}{task}}()\ :\ rt.silent\_async(\mbox{\hyperlink{test__partitioner__whitebox_8h_a5c4cf3d37a4eee22275de22cb9619863}{task}});}
\DoxyCodeLine{00150\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00151\ \ \ \ \ \}}
\DoxyCodeLine{00152\ \ \ \};}
\DoxyCodeLine{00153\ \}}
\DoxyCodeLine{00154\ }
\DoxyCodeLine{00155\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00156\ \textcolor{comment}{//\ transform}}
\DoxyCodeLine{00157\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00158\ }
\DoxyCodeLine{00159\ \textcolor{comment}{//\ Function:\ transform}}
\DoxyCodeLine{00160\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ \mbox{\hyperlink{bench__gemm_8cpp_a37a83060ac796961b44991c836f083f7}{B}},\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{sandbox_2strassen_2omp_8cpp_a4bfa035cad7c3258704669810cd5de5d}{E}},\ \textcolor{keyword}{typename}\ O,\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}},\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{namespace_p}{P}},}
\DoxyCodeLine{00161\ \ \ std::enable\_if\_t<is\_partitioner\_v<std::decay\_t<P>>,\ \textcolor{keywordtype}{void}>*}
\DoxyCodeLine{00162\ >}
\DoxyCodeLine{00163\ \mbox{\hyperlink{classtf_1_1_task}{Task}}\ \mbox{\hyperlink{classtf_1_1_flow_builder_a97be7ceef6fa4276e3b074c10c13b826}{FlowBuilder::transform}}(\mbox{\hyperlink{bench__gemm_8cpp_a37a83060ac796961b44991c836f083f7}{B}}\ first1,\ \mbox{\hyperlink{sandbox_2strassen_2omp_8cpp_a4bfa035cad7c3258704669810cd5de5d}{E}}\ last1,\ O\ d\_first,\ \mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}}\ \mbox{\hyperlink{bench_vec_add_8cpp_a41689956983587b085f9da3e48f31d99}{c}},\ \mbox{\hyperlink{namespace_p}{P}}\ part)\ \{}
\DoxyCodeLine{00164\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classtf_1_1_flow_builder_a60d7a666cab71ecfa3010b2efb0d6b57}{emplace}}(}
\DoxyCodeLine{00165\ \ \ \ \ \mbox{\hyperlink{namespacetf_a58c3a7d1ee010c70bce6d945bc80cf05}{make\_transform\_task}}(first1,\ last1,\ d\_first,\ \mbox{\hyperlink{bench_vec_add_8cpp_a41689956983587b085f9da3e48f31d99}{c}},\ part)}
\DoxyCodeLine{00166\ \ \ );}
\DoxyCodeLine{00167\ \}}
\DoxyCodeLine{00168\ }
\DoxyCodeLine{00169\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00170\ \textcolor{comment}{//\ transform2}}
\DoxyCodeLine{00171\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00172\ \ \ }
\DoxyCodeLine{00173\ \textcolor{comment}{//\ Function:\ transform}}
\DoxyCodeLine{00174\ \textcolor{keyword}{template}\ <}
\DoxyCodeLine{00175\ \ \ \textcolor{keyword}{typename}\ B1,\ \textcolor{keyword}{typename}\ E1,\ \textcolor{keyword}{typename}\ B2,\ \textcolor{keyword}{typename}\ O,\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}},\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{namespace_p}{P}},}
\DoxyCodeLine{00176\ \ \ std::enable\_if\_t<!is\_partitioner\_v<std::decay\_t<C>>,\ \textcolor{keywordtype}{void}>*}
\DoxyCodeLine{00177\ >}
\DoxyCodeLine{00178\ \mbox{\hyperlink{classtf_1_1_task}{Task}}\ \mbox{\hyperlink{classtf_1_1_flow_builder_a97be7ceef6fa4276e3b074c10c13b826}{FlowBuilder::transform}}(}
\DoxyCodeLine{00179\ \ \ B1\ first1,\ E1\ last1,\ B2\ first2,\ O\ d\_first,\ \mbox{\hyperlink{test__buffer__node_8cpp_ac4cf4b2ab929bd23951a8676eeac086b}{C}}\ \mbox{\hyperlink{bench_vec_add_8cpp_a41689956983587b085f9da3e48f31d99}{c}},\ \mbox{\hyperlink{namespace_p}{P}}\ part}
\DoxyCodeLine{00180\ )\ \{}
\DoxyCodeLine{00181\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classtf_1_1_flow_builder_a60d7a666cab71ecfa3010b2efb0d6b57}{emplace}}(\mbox{\hyperlink{namespacetf_a58c3a7d1ee010c70bce6d945bc80cf05}{make\_transform\_task}}(}
\DoxyCodeLine{00182\ \ \ \ \ first1,\ last1,\ first2,\ d\_first,\ \mbox{\hyperlink{bench_vec_add_8cpp_a41689956983587b085f9da3e48f31d99}{c}},\ part}
\DoxyCodeLine{00183\ \ \ ));}
\DoxyCodeLine{00184\ \}}
\DoxyCodeLine{00185\ }
\DoxyCodeLine{00186\ }
\DoxyCodeLine{00187\ \}\ \ \textcolor{comment}{//\ end\ of\ namespace\ tf\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00188\ }
\DoxyCodeLine{00189\ }
\DoxyCodeLine{00190\ }

\end{DoxyCode}
