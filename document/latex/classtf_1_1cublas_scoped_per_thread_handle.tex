\doxysection{tf\+::cublas\+Scoped\+Per\+Thread\+Handle类 参考}
\hypertarget{classtf_1_1cublas_scoped_per_thread_handle}{}\label{classtf_1_1cublas_scoped_per_thread_handle}\index{tf::cublasScopedPerThreadHandle@{tf::cublasScopedPerThreadHandle}}


class to provide RAII-\/styled guard of cublas handle acquisition  




{\ttfamily \#include $<$cublas\+\_\+handle.\+hpp$>$}

\doxysubsubsection*{Public 成员函数}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classtf_1_1cublas_scoped_per_thread_handle_ab38a12915fc954f3c3527fcbc74bc6b7}{cublas\+Scoped\+Per\+Thread\+Handle}} (\mbox{\hyperlink{sugar_8h_ae4f82344f573c70aa1066a2394bba345}{int}} \mbox{\hyperlink{ittnotify__static_8h_a5f135fd1e66a03efd5275434478e0d97}{d}})
\begin{DoxyCompactList}\small\item\em constructs a scoped handle under the given device context \end{DoxyCompactList}\item 
\mbox{\hyperlink{classtf_1_1cublas_scoped_per_thread_handle_a3389f3b54d3ff91ae65cf843d1335ab5}{cublas\+Scoped\+Per\+Thread\+Handle}} ()
\begin{DoxyCompactList}\small\item\em constructs a scoped handle under caller\textquotesingle{}s device context \end{DoxyCompactList}\item 
\mbox{\hyperlink{classtf_1_1cublas_scoped_per_thread_handle_a82fa514493e7ac4299a00242ca8cc37c}{\texorpdfstring{$\sim$}{\string~}cublas\+Scoped\+Per\+Thread\+Handle}} ()
\begin{DoxyCompactList}\small\item\em destructs the scoped handle guard \end{DoxyCompactList}\item 
\mbox{\hyperlink{classtf_1_1cublas_scoped_per_thread_handle_a07929a1c8b1d465ad41619a836041df8}{operator cublas\+Handle\+\_\+t}} () const
\begin{DoxyCompactList}\small\item\em implicit conversion to the native cublas handle (cublas\+Handle\+\_\+t) \end{DoxyCompactList}\item 
long \mbox{\hyperlink{classtf_1_1cublas_scoped_per_thread_handle_a006ac650347d4ac7091c0b4a2c4aaa54}{use\+\_\+count}} () const
\begin{DoxyCompactList}\small\item\em returns the number of shared owners \end{DoxyCompactList}\item 
\mbox{\hyperlink{classtf_1_1cublas_scoped_per_thread_handle_aa4e48a9c2bf023c80bd1d23252e7194f}{cublas\+Scoped\+Per\+Thread\+Handle}} (const \mbox{\hyperlink{classtf_1_1cublas_scoped_per_thread_handle}{cublas\+Scoped\+Per\+Thread\+Handle}} \&)=delete
\begin{DoxyCompactList}\small\item\em disabled copy constructor \end{DoxyCompactList}\item 
\mbox{\hyperlink{classtf_1_1cublas_scoped_per_thread_handle_a6213c011866158b7f12b900e1b1604f1}{cublas\+Scoped\+Per\+Thread\+Handle}} (\mbox{\hyperlink{classtf_1_1cublas_scoped_per_thread_handle}{cublas\+Scoped\+Per\+Thread\+Handle}} \&\&)=\mbox{\hyperlink{sugar_8h_a6face89e97cccad5464dd9bb9c7efd23}{default}}
\begin{DoxyCompactList}\small\item\em default move constructor \end{DoxyCompactList}\item 
\mbox{\hyperlink{classtf_1_1cublas_scoped_per_thread_handle}{cublas\+Scoped\+Per\+Thread\+Handle}} \& \mbox{\hyperlink{classtf_1_1cublas_scoped_per_thread_handle_aec17ee5f5cd0463f4091de5f72084c78}{operator=}} (const \mbox{\hyperlink{classtf_1_1cublas_scoped_per_thread_handle}{cublas\+Scoped\+Per\+Thread\+Handle}} \&)=delete
\begin{DoxyCompactList}\small\item\em disabled copy assignment \end{DoxyCompactList}\item 
\mbox{\hyperlink{classtf_1_1cublas_scoped_per_thread_handle}{cublas\+Scoped\+Per\+Thread\+Handle}} \& \mbox{\hyperlink{classtf_1_1cublas_scoped_per_thread_handle_a74f3322bf4f85a8d3c310d1dec4de16c}{operator=}} (\mbox{\hyperlink{classtf_1_1cublas_scoped_per_thread_handle}{cublas\+Scoped\+Per\+Thread\+Handle}} \&\&)=delete
\begin{DoxyCompactList}\small\item\em default move assignment \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Private 属性}
\begin{DoxyCompactItemize}
\item 
std\+::shared\+\_\+ptr$<$ cublas\+Per\+Thread\+Handle\+Pool\+::\+Object $>$ \mbox{\hyperlink{classtf_1_1cublas_scoped_per_thread_handle_aa1a0eb136f4e140e0f565650cf45d79c}{\+\_\+ptr}}
\end{DoxyCompactItemize}


\doxysubsection{详细描述}
class to provide RAII-\/styled guard of cublas handle acquisition 

Sample usage\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{\{}
\DoxyCodeLine{\ \ tf::cublasScopedPerThreadHandle\ handle(1);\ \ \textcolor{comment}{//\ acquires\ a\ cublas\ handle\ on\ device\ 1}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \textcolor{comment}{//\ use\ handle\ as\ a\ normal\ cublas\ handle\ (cublasHandle\_t)}}
\DoxyCodeLine{\ \ cublasSetStream(handle,\ stream);}
\DoxyCodeLine{}
\DoxyCodeLine{\}\ \ \textcolor{comment}{//\ leaving\ the\ scope\ to\ release\ the\ handle\ back\ to\ the\ pool\ on\ device\ 1}}

\end{DoxyCode}


By default, the cublas handle has a pointer mode set to device (i.\+e., {\ttfamily CUBLAS\+\_\+\+POINTER\+\_\+\+MODE\+\_\+\+DEVICE}), that is required for capturing cublas kernels. The scoped per-\/thread cublas handle is primarily used by \doxylink{classtf_1_1cublas_flow_capturer}{tf\+::cublas\+Flow\+Capturer}.

cublas\+Scoped\+Per\+Thread\+Handle is non-\/copyable. 

\doxysubsection{构造及析构函数说明}
\Hypertarget{classtf_1_1cublas_scoped_per_thread_handle_ab38a12915fc954f3c3527fcbc74bc6b7}\index{tf::cublasScopedPerThreadHandle@{tf::cublasScopedPerThreadHandle}!cublasScopedPerThreadHandle@{cublasScopedPerThreadHandle}}
\index{cublasScopedPerThreadHandle@{cublasScopedPerThreadHandle}!tf::cublasScopedPerThreadHandle@{tf::cublasScopedPerThreadHandle}}
\doxysubsubsection{\texorpdfstring{cublasScopedPerThreadHandle()}{cublasScopedPerThreadHandle()}\hspace{0.1cm}{\footnotesize\ttfamily [1/4]}}
{\footnotesize\ttfamily \label{classtf_1_1cublas_scoped_per_thread_handle_ab38a12915fc954f3c3527fcbc74bc6b7} 
tf\+::cublas\+Scoped\+Per\+Thread\+Handle\+::cublas\+Scoped\+Per\+Thread\+Handle (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{sugar_8h_ae4f82344f573c70aa1066a2394bba345}{int}}}]{d}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [explicit]}}



constructs a scoped handle under the given device context 

The constructor acquires a handle from a per-\/thread handle pool. 函数调用图\+:
% FIG 0
\Hypertarget{classtf_1_1cublas_scoped_per_thread_handle_a3389f3b54d3ff91ae65cf843d1335ab5}\index{tf::cublasScopedPerThreadHandle@{tf::cublasScopedPerThreadHandle}!cublasScopedPerThreadHandle@{cublasScopedPerThreadHandle}}
\index{cublasScopedPerThreadHandle@{cublasScopedPerThreadHandle}!tf::cublasScopedPerThreadHandle@{tf::cublasScopedPerThreadHandle}}
\doxysubsubsection{\texorpdfstring{cublasScopedPerThreadHandle()}{cublasScopedPerThreadHandle()}\hspace{0.1cm}{\footnotesize\ttfamily [2/4]}}
{\footnotesize\ttfamily \label{classtf_1_1cublas_scoped_per_thread_handle_a3389f3b54d3ff91ae65cf843d1335ab5} 
tf\+::cublas\+Scoped\+Per\+Thread\+Handle\+::cublas\+Scoped\+Per\+Thread\+Handle (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



constructs a scoped handle under caller\textquotesingle{}s device context 

The constructor acquires a handle from a per-\/thread handle pool. 函数调用图\+:
% FIG 1
\Hypertarget{classtf_1_1cublas_scoped_per_thread_handle_a82fa514493e7ac4299a00242ca8cc37c}\index{tf::cublasScopedPerThreadHandle@{tf::cublasScopedPerThreadHandle}!````~cublasScopedPerThreadHandle@{\texorpdfstring{$\sim$}{\string~}cublasScopedPerThreadHandle}}
\index{````~cublasScopedPerThreadHandle@{\texorpdfstring{$\sim$}{\string~}cublasScopedPerThreadHandle}!tf::cublasScopedPerThreadHandle@{tf::cublasScopedPerThreadHandle}}
\doxysubsubsection{\texorpdfstring{\texorpdfstring{$\sim$}{\string~}cublasScopedPerThreadHandle()}{\string~cublasScopedPerThreadHandle()}}
{\footnotesize\ttfamily \label{classtf_1_1cublas_scoped_per_thread_handle_a82fa514493e7ac4299a00242ca8cc37c} 
tf\+::cublas\+Scoped\+Per\+Thread\+Handle\+::\texorpdfstring{$\sim$}{\string~}cublas\+Scoped\+Per\+Thread\+Handle (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



destructs the scoped handle guard 

The destructor releases the handle to the per-\/thread handle pool. 函数调用图\+:
% FIG 2
\Hypertarget{classtf_1_1cublas_scoped_per_thread_handle_aa4e48a9c2bf023c80bd1d23252e7194f}\index{tf::cublasScopedPerThreadHandle@{tf::cublasScopedPerThreadHandle}!cublasScopedPerThreadHandle@{cublasScopedPerThreadHandle}}
\index{cublasScopedPerThreadHandle@{cublasScopedPerThreadHandle}!tf::cublasScopedPerThreadHandle@{tf::cublasScopedPerThreadHandle}}
\doxysubsubsection{\texorpdfstring{cublasScopedPerThreadHandle()}{cublasScopedPerThreadHandle()}\hspace{0.1cm}{\footnotesize\ttfamily [3/4]}}
{\footnotesize\ttfamily \label{classtf_1_1cublas_scoped_per_thread_handle_aa4e48a9c2bf023c80bd1d23252e7194f} 
tf\+::cublas\+Scoped\+Per\+Thread\+Handle\+::cublas\+Scoped\+Per\+Thread\+Handle (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{classtf_1_1cublas_scoped_per_thread_handle}{cublas\+Scoped\+Per\+Thread\+Handle}} \&}]{}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [delete]}}



disabled copy constructor 

函数调用图\+:
% FIG 3
\Hypertarget{classtf_1_1cublas_scoped_per_thread_handle_a6213c011866158b7f12b900e1b1604f1}\index{tf::cublasScopedPerThreadHandle@{tf::cublasScopedPerThreadHandle}!cublasScopedPerThreadHandle@{cublasScopedPerThreadHandle}}
\index{cublasScopedPerThreadHandle@{cublasScopedPerThreadHandle}!tf::cublasScopedPerThreadHandle@{tf::cublasScopedPerThreadHandle}}
\doxysubsubsection{\texorpdfstring{cublasScopedPerThreadHandle()}{cublasScopedPerThreadHandle()}\hspace{0.1cm}{\footnotesize\ttfamily [4/4]}}
{\footnotesize\ttfamily \label{classtf_1_1cublas_scoped_per_thread_handle_a6213c011866158b7f12b900e1b1604f1} 
tf\+::cublas\+Scoped\+Per\+Thread\+Handle\+::cublas\+Scoped\+Per\+Thread\+Handle (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classtf_1_1cublas_scoped_per_thread_handle}{cublas\+Scoped\+Per\+Thread\+Handle}} \&\&}]{}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [default]}}



default move constructor 

函数调用图\+:
% FIG 4


\doxysubsection{成员函数说明}
\Hypertarget{classtf_1_1cublas_scoped_per_thread_handle_a07929a1c8b1d465ad41619a836041df8}\index{tf::cublasScopedPerThreadHandle@{tf::cublasScopedPerThreadHandle}!operator cublasHandle\_t@{operator cublasHandle\_t}}
\index{operator cublasHandle\_t@{operator cublasHandle\_t}!tf::cublasScopedPerThreadHandle@{tf::cublasScopedPerThreadHandle}}
\doxysubsubsection{\texorpdfstring{operator cublasHandle\_t()}{operator cublasHandle\_t()}}
{\footnotesize\ttfamily \label{classtf_1_1cublas_scoped_per_thread_handle_a07929a1c8b1d465ad41619a836041df8} 
tf\+::cublas\+Scoped\+Per\+Thread\+Handle\+::operator cublas\+Handle\+\_\+t (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



implicit conversion to the native cublas handle (cublas\+Handle\+\_\+t) 

\Hypertarget{classtf_1_1cublas_scoped_per_thread_handle_aec17ee5f5cd0463f4091de5f72084c78}\index{tf::cublasScopedPerThreadHandle@{tf::cublasScopedPerThreadHandle}!operator=@{operator=}}
\index{operator=@{operator=}!tf::cublasScopedPerThreadHandle@{tf::cublasScopedPerThreadHandle}}
\doxysubsubsection{\texorpdfstring{operator=()}{operator=()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily \label{classtf_1_1cublas_scoped_per_thread_handle_aec17ee5f5cd0463f4091de5f72084c78} 
\mbox{\hyperlink{classtf_1_1cublas_scoped_per_thread_handle}{cublas\+Scoped\+Per\+Thread\+Handle}} \& tf\+::cublas\+Scoped\+Per\+Thread\+Handle\+::operator= (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{classtf_1_1cublas_scoped_per_thread_handle}{cublas\+Scoped\+Per\+Thread\+Handle}} \&}]{}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [delete]}}



disabled copy assignment 

函数调用图\+:
% FIG 5
\Hypertarget{classtf_1_1cublas_scoped_per_thread_handle_a74f3322bf4f85a8d3c310d1dec4de16c}\index{tf::cublasScopedPerThreadHandle@{tf::cublasScopedPerThreadHandle}!operator=@{operator=}}
\index{operator=@{operator=}!tf::cublasScopedPerThreadHandle@{tf::cublasScopedPerThreadHandle}}
\doxysubsubsection{\texorpdfstring{operator=()}{operator=()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily \label{classtf_1_1cublas_scoped_per_thread_handle_a74f3322bf4f85a8d3c310d1dec4de16c} 
\mbox{\hyperlink{classtf_1_1cublas_scoped_per_thread_handle}{cublas\+Scoped\+Per\+Thread\+Handle}} \& tf\+::cublas\+Scoped\+Per\+Thread\+Handle\+::operator= (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classtf_1_1cublas_scoped_per_thread_handle}{cublas\+Scoped\+Per\+Thread\+Handle}} \&\&}]{}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [delete]}}



default move assignment 

函数调用图\+:
% FIG 6
\Hypertarget{classtf_1_1cublas_scoped_per_thread_handle_a006ac650347d4ac7091c0b4a2c4aaa54}\index{tf::cublasScopedPerThreadHandle@{tf::cublasScopedPerThreadHandle}!use\_count@{use\_count}}
\index{use\_count@{use\_count}!tf::cublasScopedPerThreadHandle@{tf::cublasScopedPerThreadHandle}}
\doxysubsubsection{\texorpdfstring{use\_count()}{use\_count()}}
{\footnotesize\ttfamily \label{classtf_1_1cublas_scoped_per_thread_handle_a006ac650347d4ac7091c0b4a2c4aaa54} 
long tf\+::cublas\+Scoped\+Per\+Thread\+Handle\+::use\+\_\+count (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



returns the number of shared owners 



\doxysubsection{类成员变量说明}
\Hypertarget{classtf_1_1cublas_scoped_per_thread_handle_aa1a0eb136f4e140e0f565650cf45d79c}\index{tf::cublasScopedPerThreadHandle@{tf::cublasScopedPerThreadHandle}!\_ptr@{\_ptr}}
\index{\_ptr@{\_ptr}!tf::cublasScopedPerThreadHandle@{tf::cublasScopedPerThreadHandle}}
\doxysubsubsection{\texorpdfstring{\_ptr}{\_ptr}}
{\footnotesize\ttfamily \label{classtf_1_1cublas_scoped_per_thread_handle_aa1a0eb136f4e140e0f565650cf45d79c} 
std\+::shared\+\_\+ptr$<$cublas\+Per\+Thread\+Handle\+Pool\+::\+Object$>$ tf\+::cublas\+Scoped\+Per\+Thread\+Handle\+::\+\_\+ptr\hspace{0.3cm}{\ttfamily [private]}}



该类的文档由以下文件生成\+:\begin{DoxyCompactItemize}
\item 
external/taskflow/sandbox/cublas\+\_\+core/\mbox{\hyperlink{cublas__handle_8hpp}{cublas\+\_\+handle.\+hpp}}\end{DoxyCompactItemize}
