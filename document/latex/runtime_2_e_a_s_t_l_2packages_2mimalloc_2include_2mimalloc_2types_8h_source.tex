\doxysection{types.\+h}
\hypertarget{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_source}{}\label{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_source}\index{runtime/EASTL/packages/mimalloc/include/mimalloc/types.h@{runtime/EASTL/packages/mimalloc/include/mimalloc/types.h}}
\mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h}{浏览该文件的文档.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{/*\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00002\ \textcolor{comment}{Copyright\ (c)\ 2018-\/2024,\ Microsoft\ Research,\ Daan\ Leijen}}
\DoxyCodeLine{00003\ \textcolor{comment}{This\ is\ free\ software;\ you\ can\ redistribute\ it\ and/or\ modify\ it\ under\ the}}
\DoxyCodeLine{00004\ \textcolor{comment}{terms\ of\ the\ MIT\ license.\ A\ copy\ of\ the\ license\ can\ be\ found\ in\ the\ file}}
\DoxyCodeLine{00005\ \textcolor{comment}{"{}LICENSE"{}\ at\ the\ root\ of\ this\ distribution.}}
\DoxyCodeLine{00006\ \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/*/}}
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#ifndef\ MI\_TYPES\_H}}
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#define\ MI\_TYPES\_H}}
\DoxyCodeLine{00010\ }
\DoxyCodeLine{00011\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00012\ \textcolor{comment}{//\ This\ file\ contains\ the\ main\ type\ definitions\ for\ mimalloc:}}
\DoxyCodeLine{00013\ \textcolor{comment}{//\ mi\_heap\_t\ \ \ \ \ \ :\ all\ data\ for\ a\ thread-\/local\ heap,\ contains}}
\DoxyCodeLine{00014\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lists\ of\ all\ managed\ heap\ pages.}}
\DoxyCodeLine{00015\ \textcolor{comment}{//\ mi\_page\_t\ \ \ \ \ \ :\ a\ mimalloc\ page\ (usually\ 64KiB\ or\ 512KiB)\ from}}
\DoxyCodeLine{00016\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ where\ objects\ of\ a\ single\ size\ are\ allocated.}}
\DoxyCodeLine{00017\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Note:\ we\ write\ "{}OS\ page"{}\ for\ OS\ memory\ pages\ while}}
\DoxyCodeLine{00018\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ using\ plain\ "{}page"{}\ for\ mimalloc\ pages\ (`mi\_page\_t`).}}
\DoxyCodeLine{00019\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00020\ }
\DoxyCodeLine{00021\ }
\DoxyCodeLine{00022\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{mimalloc-stats_8h}{mimalloc-\/stats.h}}>}}
\DoxyCodeLine{00023\ \textcolor{preprocessor}{\#include\ <stddef.h>}\ \ \ \textcolor{comment}{//\ ptrdiff\_t}}
\DoxyCodeLine{00024\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{stdint_8h}{stdint.h}}>}\ \ \ \textcolor{comment}{//\ uintptr\_t,\ uint16\_t,\ etc}}
\DoxyCodeLine{00025\ \textcolor{preprocessor}{\#include\ <errno.h>}\ \ \ \ \textcolor{comment}{//\ error\ codes}}
\DoxyCodeLine{00026\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{bits_8h}{bits.h}}"{}}\ \ \ \ \ \textcolor{comment}{//\ size\ defines\ (MI\_INTPTR\_SIZE\ etc),\ bit\ operations}}
\DoxyCodeLine{00027\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2atomic_8h}{atomic.h}}"{}}\ \ \ \textcolor{comment}{//\ \_Atomic\ primitives}}
\DoxyCodeLine{00028\ }
\DoxyCodeLine{00029\ \textcolor{comment}{//\ Minimal\ alignment\ necessary.\ On\ most\ platforms\ 16\ bytes\ are\ needed}}
\DoxyCodeLine{00030\ \textcolor{comment}{//\ due\ to\ SSE\ registers\ for\ example.\ This\ must\ be\ at\ least\ \`{}sizeof(void*)`}}
\DoxyCodeLine{00031\ \textcolor{preprocessor}{\#ifndef\ MI\_MAX\_ALIGN\_SIZE}}
\DoxyCodeLine{00032\ \textcolor{preprocessor}{\#define\ MI\_MAX\_ALIGN\_SIZE\ \ 16\ \ \ }\textcolor{comment}{//\ sizeof(max\_align\_t)}}
\DoxyCodeLine{00033\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00034\ }
\DoxyCodeLine{00035\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00036\ \textcolor{comment}{//\ Variants}}
\DoxyCodeLine{00037\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00038\ }
\DoxyCodeLine{00039\ \textcolor{comment}{//\ Define\ NDEBUG\ in\ the\ release\ version\ to\ disable\ assertions.}}
\DoxyCodeLine{00040\ \textcolor{comment}{//\ \#define\ NDEBUG}}
\DoxyCodeLine{00041\ }
\DoxyCodeLine{00042\ \textcolor{comment}{//\ Define\ MI\_TRACK\_<tool>\ to\ enable\ tracking\ support}}
\DoxyCodeLine{00043\ \textcolor{comment}{//\ \#define\ MI\_TRACK\_VALGRIND\ 1}}
\DoxyCodeLine{00044\ \textcolor{comment}{//\ \#define\ MI\_TRACK\_ASAN\ \ \ \ \ 1}}
\DoxyCodeLine{00045\ \textcolor{comment}{//\ \#define\ MI\_TRACK\_ETW\ \ \ \ \ \ 1}}
\DoxyCodeLine{00046\ }
\DoxyCodeLine{00047\ \textcolor{comment}{//\ Define\ MI\_STAT\ as\ 1\ to\ maintain\ statistics;\ set\ it\ to\ 2\ to\ have\ detailed\ statistics\ (but\ costs\ some\ performance).}}
\DoxyCodeLine{00048\ \textcolor{comment}{//\ \#define\ MI\_STAT\ 1}}
\DoxyCodeLine{00049\ }
\DoxyCodeLine{00050\ \textcolor{comment}{//\ Define\ MI\_SECURE\ to\ enable\ security\ mitigations.\ Level\ 1\ has\ minimal\ performance\ impact,}}
\DoxyCodeLine{00051\ \textcolor{comment}{//\ but\ protects\ most\ metadata\ with\ guard\ pages:}}
\DoxyCodeLine{00052\ \textcolor{comment}{//\ \ \ \#define\ MI\_SECURE\ 1\ \ //\ guard\ page\ around\ metadata}}
\DoxyCodeLine{00053\ \textcolor{comment}{//}}
\DoxyCodeLine{00054\ \textcolor{comment}{//\ Level\ 2\ has\ more\ performance\ impact\ but\ protect\ well\ against\ various\ buffer\ overflows}}
\DoxyCodeLine{00055\ \textcolor{comment}{//\ by\ surrounding\ all\ mimalloc\ pages\ with\ guard\ pages:}}
\DoxyCodeLine{00056\ \textcolor{comment}{//\ \ \ \#define\ MI\_SECURE\ 2\ \ //\ guard\ page\ around\ each\ mimalloc\ page\ (can\ fragment\ VMA's\ with\ large\ heaps..)}}
\DoxyCodeLine{00057\ \textcolor{comment}{//}}
\DoxyCodeLine{00058\ \textcolor{comment}{//\ The\ next\ two\ levels\ can\ have\ more\ performance\ cost:}}
\DoxyCodeLine{00059\ \textcolor{comment}{//\ \ \ \#define\ MI\_SECURE\ 3\ \ //\ randomize\ allocations,\ encode\ free\ lists\ (detect\ corrupted\ free\ list\ (buffer\ overflow),\ and\ invalid\ pointer\ free)}}
\DoxyCodeLine{00060\ \textcolor{comment}{//\ \ \ \#define\ MI\_SECURE\ 4\ \ //\ checks\ for\ double\ free.\ (may\ be\ more\ expensive)}}
\DoxyCodeLine{00061\ }
\DoxyCodeLine{00062\ \textcolor{preprocessor}{\#if\ !defined(MI\_SECURE)}}
\DoxyCodeLine{00063\ \textcolor{preprocessor}{\#define\ MI\_SECURE\ 0}}
\DoxyCodeLine{00064\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00065\ }
\DoxyCodeLine{00066\ \textcolor{comment}{//\ Define\ MI\_DEBUG\ for\ debug\ mode}}
\DoxyCodeLine{00067\ \textcolor{comment}{//\ \#define\ MI\_DEBUG\ 1\ \ //\ basic\ assertion\ checks\ and\ statistics,\ check\ double\ free,\ corrupted\ free\ list,\ and\ invalid\ pointer\ free.}}
\DoxyCodeLine{00068\ \textcolor{comment}{//\ \#define\ MI\_DEBUG\ 2\ \ //\ +\ internal\ assertion\ checks}}
\DoxyCodeLine{00069\ \textcolor{comment}{//\ \#define\ MI\_DEBUG\ 3\ \ //\ +\ extensive\ internal\ invariant\ checking\ (cmake\ -\/DMI\_DEBUG\_FULL=ON)}}
\DoxyCodeLine{00070\ \textcolor{preprocessor}{\#if\ !defined(MI\_DEBUG)}}
\DoxyCodeLine{00071\ \textcolor{preprocessor}{\#if\ !defined(NDEBUG)\ ||\ defined(\_DEBUG)}}
\DoxyCodeLine{00072\ \textcolor{preprocessor}{\#define\ MI\_DEBUG\ 2}}
\DoxyCodeLine{00073\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00074\ \textcolor{preprocessor}{\#define\ MI\_DEBUG\ 0}}
\DoxyCodeLine{00075\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00076\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00077\ }
\DoxyCodeLine{00078\ \textcolor{comment}{//\ Use\ guard\ pages\ behind\ objects\ of\ a\ certain\ size\ (set\ by\ the\ MIMALLOC\_DEBUG\_GUARDED\_MIN/MAX\ options)}}
\DoxyCodeLine{00079\ \textcolor{comment}{//\ Padding\ should\ be\ disabled\ when\ using\ guard\ pages}}
\DoxyCodeLine{00080\ \textcolor{comment}{//\ \#define\ MI\_GUARDED\ 1}}
\DoxyCodeLine{00081\ \textcolor{preprocessor}{\#if\ defined(MI\_GUARDED)}}
\DoxyCodeLine{00082\ \textcolor{preprocessor}{\#define\ MI\_PADDING\ \ 0}}
\DoxyCodeLine{00083\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00084\ }
\DoxyCodeLine{00085\ \textcolor{comment}{//\ Reserve\ extra\ padding\ at\ the\ end\ of\ each\ block\ to\ be\ more\ resilient\ against\ heap\ block\ overflows.}}
\DoxyCodeLine{00086\ \textcolor{comment}{//\ The\ padding\ can\ detect\ buffer\ overflow\ on\ free.}}
\DoxyCodeLine{00087\ \textcolor{preprocessor}{\#if\ !defined(MI\_PADDING)\ \&\&\ (MI\_SECURE>=3\ ||\ MI\_DEBUG>=1\ ||\ (MI\_TRACK\_VALGRIND\ ||\ MI\_TRACK\_ASAN\ ||\ MI\_TRACK\_ETW))}}
\DoxyCodeLine{00088\ \textcolor{preprocessor}{\#define\ MI\_PADDING\ \ 1}}
\DoxyCodeLine{00089\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00090\ }
\DoxyCodeLine{00091\ \textcolor{comment}{//\ Check\ padding\ bytes;\ allows\ byte-\/precise\ buffer\ overflow\ detection}}
\DoxyCodeLine{00092\ \textcolor{preprocessor}{\#if\ !defined(MI\_PADDING\_CHECK)\ \&\&\ MI\_PADDING\ \&\&\ (MI\_SECURE>=3\ ||\ MI\_DEBUG>=1)}}
\DoxyCodeLine{00093\ \textcolor{preprocessor}{\#define\ MI\_PADDING\_CHECK\ 1}}
\DoxyCodeLine{00094\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00095\ }
\DoxyCodeLine{00096\ }
\DoxyCodeLine{00097\ \textcolor{comment}{//\ Encoded\ free\ lists\ allow\ detection\ of\ corrupted\ free\ lists}}
\DoxyCodeLine{00098\ \textcolor{comment}{//\ and\ can\ detect\ buffer\ overflows,\ modify\ after\ free,\ and\ double\ \`{}free`s.}}
\DoxyCodeLine{00099\ \textcolor{preprocessor}{\#if\ (MI\_SECURE>=3\ ||\ MI\_DEBUG>=1)}}
\DoxyCodeLine{00100\ \textcolor{preprocessor}{\#define\ MI\_ENCODE\_FREELIST\ \ 1}}
\DoxyCodeLine{00101\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00102\ }
\DoxyCodeLine{00103\ \textcolor{comment}{//\ Enable\ large\ pages\ for\ objects\ between\ 64KiB\ and\ 512KiB.}}
\DoxyCodeLine{00104\ \textcolor{comment}{//\ Disabled\ by\ default\ as\ for\ many\ workloads\ the\ block\ sizes\ above\ 64\ KiB\ are\ quite\ random\ which\ can\ lead\ to\ too\ many\ partially\ used\ large\ pages.}}
\DoxyCodeLine{00105\ \textcolor{preprocessor}{\#ifndef\ MI\_ENABLE\_LARGE\_PAGES}}
\DoxyCodeLine{00106\ \textcolor{preprocessor}{\#define\ MI\_ENABLE\_LARGE\_PAGES\ \ 0}}
\DoxyCodeLine{00107\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00108\ }
\DoxyCodeLine{00109\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00110\ \textcolor{comment}{//\ Sizes\ of\ internal\ data-\/structures}}
\DoxyCodeLine{00111\ \textcolor{comment}{//\ (comments\ specify\ sizes\ on\ 64-\/bit,\ usually\ 32-\/bit\ is\ halved)}}
\DoxyCodeLine{00112\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00113\ }
\DoxyCodeLine{00114\ \textcolor{comment}{//\ Sizes\ are\ for\ 64-\/bit}}
\DoxyCodeLine{00115\ \textcolor{preprocessor}{\#ifndef\ MI\_ARENA\_SLICE\_SHIFT}}
\DoxyCodeLine{00116\ \textcolor{preprocessor}{\#ifdef\ \ MI\_SMALL\_PAGE\_SHIFT\ \ \ }\textcolor{comment}{//\ backward\ compatibility}}
\DoxyCodeLine{00117\ \textcolor{preprocessor}{\#define\ MI\_ARENA\_SLICE\_SHIFT\ \ \ \ \ \ \ \ \ \ \ \ \ \ MI\_SMALL\_PAGE\_SHIFT}}
\DoxyCodeLine{00118\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00119\ \textcolor{preprocessor}{\#define\ MI\_ARENA\_SLICE\_SHIFT\ \ \ \ \ \ \ \ \ \ \ \ \ \ (13\ +\ MI\_SIZE\_SHIFT)\ \ \ \ \ \ \ \ }\textcolor{comment}{//\ 64\ KiB\ (32\ KiB\ on\ 32-\/bit)}}
\DoxyCodeLine{00120\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00121\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00122\ \textcolor{preprocessor}{\#ifndef\ MI\_BCHUNK\_BITS\_SHIFT}}
\DoxyCodeLine{00123\ \textcolor{preprocessor}{\#define\ MI\_BCHUNK\_BITS\_SHIFT\ \ \ \ \ \ \ \ \ \ \ \ \ \ (6\ +\ MI\_SIZE\_SHIFT)\ \ \ \ \ \ \ \ \ }\textcolor{comment}{//\ optimized\ for\ 512\ bits\ per\ chunk\ (avx512)}}
\DoxyCodeLine{00124\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00125\ }
\DoxyCodeLine{00126\ \textcolor{preprocessor}{\#define\ MI\_BCHUNK\_BITS\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (1\ <<\ MI\_BCHUNK\_BITS\_SHIFT)\ \ \ \ \ \ \ \ \ }\textcolor{comment}{//\ sub-\/bitmaps\ are\ "{}bchunks"{}\ of\ 512\ bits}}
\DoxyCodeLine{00127\ \textcolor{preprocessor}{\#define\ MI\_ARENA\_SLICE\_SIZE\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (MI\_ZU(1)\ <<\ MI\_ARENA\_SLICE\_SHIFT)\ \ }\textcolor{comment}{//\ arena's\ allocate\ in\ slices\ of\ 64\ KiB}}
\DoxyCodeLine{00128\ \textcolor{preprocessor}{\#define\ MI\_ARENA\_SLICE\_ALIGN\ \ \ \ \ \ \ \ \ \ \ \ \ \ (MI\_ARENA\_SLICE\_SIZE)}}
\DoxyCodeLine{00129\ }
\DoxyCodeLine{00130\ \textcolor{preprocessor}{\#define\ MI\_ARENA\_MIN\_OBJ\_SLICES\ \ \ \ \ \ \ \ \ \ \ (1)}}
\DoxyCodeLine{00131\ \textcolor{preprocessor}{\#define\ MI\_ARENA\_MAX\_OBJ\_SLICES\ \ \ \ \ \ \ \ \ \ \ (MI\_BCHUNK\_BITS)\ \ \ \ \ \ \ \ \ \ \ \ }\textcolor{comment}{//\ 32\ MiB\ (for\ now,\ cannot\ cross\ chunk\ boundaries)}}
\DoxyCodeLine{00132\ }
\DoxyCodeLine{00133\ \textcolor{preprocessor}{\#define\ MI\_ARENA\_MIN\_OBJ\_SIZE\ \ \ \ \ \ \ \ \ \ \ \ \ (MI\_ARENA\_MIN\_OBJ\_SLICES\ *\ MI\_ARENA\_SLICE\_SIZE)}}
\DoxyCodeLine{00134\ \textcolor{preprocessor}{\#define\ MI\_ARENA\_MAX\_OBJ\_SIZE\ \ \ \ \ \ \ \ \ \ \ \ \ (MI\_ARENA\_MAX\_OBJ\_SLICES\ *\ MI\_ARENA\_SLICE\_SIZE)}}
\DoxyCodeLine{00135\ }
\DoxyCodeLine{00136\ \textcolor{preprocessor}{\#define\ MI\_SMALL\_PAGE\_SIZE\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ MI\_ARENA\_MIN\_OBJ\_SIZE\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }\textcolor{comment}{//\ 64\ KiB}}
\DoxyCodeLine{00137\ \textcolor{preprocessor}{\#define\ MI\_MEDIUM\_PAGE\_SIZE\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (8*MI\_SMALL\_PAGE\_SIZE)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }\textcolor{comment}{//\ 512\ KiB\ \ (=byte\ in\ the\ bchunk\ bitmap)}}
\DoxyCodeLine{00138\ \textcolor{preprocessor}{\#define\ MI\_LARGE\_PAGE\_SIZE\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (MI\_SIZE\_SIZE*MI\_MEDIUM\_PAGE\_SIZE)\ \ \ \ \ \ \ }\textcolor{comment}{//\ 4\ MiB\ \ \ \ (=word\ in\ the\ bchunk\ bitmap)}}
\DoxyCodeLine{00139\ }
\DoxyCodeLine{00140\ }
\DoxyCodeLine{00141\ \textcolor{comment}{//\ Maximum\ number\ of\ size\ classes.\ (spaced\ exponentially\ in\ 12.5\%\ increments)}}
\DoxyCodeLine{00142\ \textcolor{preprocessor}{\#if\ MI\_BIN\_HUGE\ !=\ 73U}}
\DoxyCodeLine{00143\ \textcolor{preprocessor}{\#error\ "{}mimalloc\ internal:\ expecting\ 73\ bins"{}}}
\DoxyCodeLine{00144\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00145\ \textcolor{preprocessor}{\#define\ MI\_BIN\_FULL\ \ (MI\_BIN\_HUGE+1)}}
\DoxyCodeLine{00146\ \textcolor{preprocessor}{\#define\ MI\_BIN\_COUNT\ (MI\_BIN\_FULL+1)}}
\DoxyCodeLine{00147\ }
\DoxyCodeLine{00148\ \textcolor{comment}{//\ We\ never\ allocate\ more\ than\ PTRDIFF\_MAX\ (see\ also\ <https://sourceware.org/ml/libc-\/announce/2019/msg00001.html>)}}
\DoxyCodeLine{00149\ \textcolor{preprocessor}{\#define\ MI\_MAX\_ALLOC\_SIZE\ \ \ \ \ \ \ \ PTRDIFF\_MAX}}
\DoxyCodeLine{00150\ }
\DoxyCodeLine{00151\ \textcolor{comment}{//\ Minimal\ commit\ for\ a\ page\ on-\/demand\ commit\ (should\ be\ >=\ OS\ page\ size)}}
\DoxyCodeLine{00152\ \textcolor{preprocessor}{\#define\ MI\_PAGE\_MIN\_COMMIT\_SIZE\ \ MI\_ARENA\_SLICE\_SIZE\ }\textcolor{comment}{//\ (4*MI\_KiB)}}
\DoxyCodeLine{00153\ }
\DoxyCodeLine{00154\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00155\ \textcolor{comment}{//\ Arena's\ are\ large\ reserved\ areas\ of\ memory\ allocated\ from}}
\DoxyCodeLine{00156\ \textcolor{comment}{//\ the\ OS\ that\ are\ managed\ by\ mimalloc\ to\ efficiently}}
\DoxyCodeLine{00157\ \textcolor{comment}{//\ allocate\ MI\_ARENA\_SLICE\_SIZE\ slices\ of\ memory\ for\ the}}
\DoxyCodeLine{00158\ \textcolor{comment}{//\ mimalloc\ pages.}}
\DoxyCodeLine{00159\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00160\ }
\DoxyCodeLine{00161\ \textcolor{comment}{//\ A\ large\ memory\ arena\ where\ pages\ are\ allocated\ in.}}
\DoxyCodeLine{00162\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structmi__arena__s}{mi\_arena\_s}}\ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_a4187c38d7fe26f37558a31eb935dfe2d}{mi\_arena\_t}};\ \ \ \ \ \textcolor{comment}{//\ defined\ in\ \`{}arena.c`}}
\DoxyCodeLine{00163\ }
\DoxyCodeLine{00164\ }
\DoxyCodeLine{00165\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00166\ \textcolor{comment}{//\ a\ memory\ id\ tracks\ the\ provenance\ of\ arena/OS\ allocated\ memory}}
\DoxyCodeLine{00167\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00168\ }
\DoxyCodeLine{00169\ \textcolor{comment}{//\ Memory\ can\ reside\ in\ arena's,\ direct\ OS\ allocated,\ meta-\/data\ pages,\ or\ statically\ allocated.}}
\DoxyCodeLine{00170\ \textcolor{comment}{//\ The\ memid\ keeps\ track\ of\ this.}}
\DoxyCodeLine{00171\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{enum}\ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_ac6c1ef0bff44bbd4da79dae9914f40fa}{mi\_memkind\_e}}\ \{}
\DoxyCodeLine{00172\ \ \ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_ac6c1ef0bff44bbd4da79dae9914f40faa81ae9cfe7f07a7d1e29b5c1f663f7c11}{MI\_MEM\_NONE}},\ \ \ \ \ \ \textcolor{comment}{//\ not\ allocated}}
\DoxyCodeLine{00173\ \ \ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_ac6c1ef0bff44bbd4da79dae9914f40faa491ffb516c98699e8612a26e9b431829}{MI\_MEM\_EXTERNAL}},\ \ \textcolor{comment}{//\ not\ owned\ by\ mimalloc\ but\ provided\ externally\ (via\ \`{}mi\_manage\_os\_memory`\ for\ example)}}
\DoxyCodeLine{00174\ \ \ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_ac6c1ef0bff44bbd4da79dae9914f40faa3f3040c6af5ac6cd3c6dd2baf741c452}{MI\_MEM\_STATIC}},\ \ \ \ \textcolor{comment}{//\ allocated\ in\ a\ static\ area\ and\ should\ not\ be\ freed\ (the\ initial\ main\ heap\ data\ for\ example\ (`init.c`))}}
\DoxyCodeLine{00175\ \ \ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_ac6c1ef0bff44bbd4da79dae9914f40faa96ff9d981835831bf9364f2b121fb4ab}{MI\_MEM\_META}},\ \ \ \ \ \ \textcolor{comment}{//\ allocated\ with\ the\ meta\ data\ allocator\ (`arena-\/meta.c`)}}
\DoxyCodeLine{00176\ \ \ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_ac6c1ef0bff44bbd4da79dae9914f40faa3624937a706def54155dfc0a7fb015d7}{MI\_MEM\_OS}},\ \ \ \ \ \ \ \ \textcolor{comment}{//\ allocated\ from\ the\ OS}}
\DoxyCodeLine{00177\ \ \ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_ac6c1ef0bff44bbd4da79dae9914f40faa1827ef3f939d8e7285a61adabf6d824e}{MI\_MEM\_OS\_HUGE}},\ \ \ \textcolor{comment}{//\ allocated\ as\ huge\ OS\ pages\ (usually\ 1GiB,\ pinned\ to\ physical\ memory)}}
\DoxyCodeLine{00178\ \ \ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_ac6c1ef0bff44bbd4da79dae9914f40faaafc538eb5a6847e12a447cff21fc0f1b}{MI\_MEM\_OS\_REMAP}},\ \ \textcolor{comment}{//\ allocated\ in\ a\ remapable\ area\ (i.e.\ using\ \`{}mremap`)}}
\DoxyCodeLine{00179\ \ \ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_ac6c1ef0bff44bbd4da79dae9914f40faadc38b2c201eaa1c34610a21d07d642f3}{MI\_MEM\_ARENA}}\ \ \ \ \ \ \textcolor{comment}{//\ allocated\ from\ an\ arena\ (the\ usual\ case)\ (`arena.c`)}}
\DoxyCodeLine{00180\ \}\ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_a79f74a576251f2073135a4124d6d32f1}{mi\_memkind\_t}};}
\DoxyCodeLine{00181\ }
\DoxyCodeLine{00182\ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_a7b53315c793e6a0934fb369cfb0dc388}{mi\_memkind\_is\_os}}(\mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_a79f74a576251f2073135a4124d6d32f1}{mi\_memkind\_t}}\ memkind)\ \{}
\DoxyCodeLine{00183\ \ \ \textcolor{keywordflow}{return}\ (memkind\ >=\ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_ac6c1ef0bff44bbd4da79dae9914f40faa3624937a706def54155dfc0a7fb015d7}{MI\_MEM\_OS}}\ \&\&\ memkind\ <=\ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_ac6c1ef0bff44bbd4da79dae9914f40faaafc538eb5a6847e12a447cff21fc0f1b}{MI\_MEM\_OS\_REMAP}});}
\DoxyCodeLine{00184\ \}}
\DoxyCodeLine{00185\ }
\DoxyCodeLine{00186\ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_addbf2d90f0dbd0c3baf3f54a2a8b6292}{mi\_memkind\_needs\_no\_free}}(\mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_a79f74a576251f2073135a4124d6d32f1}{mi\_memkind\_t}}\ memkind)\ \{}
\DoxyCodeLine{00187\ \ \ \textcolor{keywordflow}{return}\ (memkind\ <=\ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_ac6c1ef0bff44bbd4da79dae9914f40faa3f3040c6af5ac6cd3c6dd2baf741c452}{MI\_MEM\_STATIC}});}
\DoxyCodeLine{00188\ \}}
\DoxyCodeLine{00189\ }
\DoxyCodeLine{00190\ }
\DoxyCodeLine{00191\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structmi__memid__os__info}{mi\_memid\_os\_info}}\ \{}
\DoxyCodeLine{00192\ \ \ \textcolor{keywordtype}{void}*\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structmi__memid__os__info_a7800011c14b5cc138b934345cf4d0dab}{base}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ actual\ base\ address\ of\ the\ block\ (used\ for\ offset\ aligned\ allocations)}}
\DoxyCodeLine{00193\ \ \ \textcolor{keywordtype}{size\_t}\ \ \ \ \ \ \ \ \mbox{\hyperlink{structmi__memid__os__info_aa2d631565042826758012d35e55ce465}{size}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ allocated\ full\ size}}
\DoxyCodeLine{00194\ \ \ \textcolor{comment}{//\ size\_t\ \ \ \ \ \ \ \ alignment;\ \ \ \ \ \ \ //\ alignment\ at\ allocation}}
\DoxyCodeLine{00195\ \}\ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_a70931ac8fdefe190edaa2148f9120bc2}{mi\_memid\_os\_info\_t}};}
\DoxyCodeLine{00196\ }
\DoxyCodeLine{00197\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structmi__memid__arena__info}{mi\_memid\_arena\_info}}\ \{}
\DoxyCodeLine{00198\ \ \ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_a4187c38d7fe26f37558a31eb935dfe2d}{mi\_arena\_t}}*\ \ \ \mbox{\hyperlink{structmi__memid__arena__info_a2750a6487588f3a4380e2592c9b63140}{arena}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ arena\ that\ contains\ this\ memory}}
\DoxyCodeLine{00199\ \ \ \mbox{\hyperlink{eabase_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t}}\ \ \ \ \ \ \mbox{\hyperlink{structmi__memid__arena__info_a224936d01288141a18d7119aef5d29c2}{slice\_index}};\ \ \ \ \ \ \ \ \textcolor{comment}{//\ slice\ index\ in\ the\ arena}}
\DoxyCodeLine{00200\ \ \ \mbox{\hyperlink{eabase_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t}}\ \ \ \ \ \ \mbox{\hyperlink{structmi__memid__arena__info_a24883a7dc0ce6309245d9760ada9210d}{slice\_count}};\ \ \ \ \ \ \ \ \textcolor{comment}{//\ allocated\ slices}}
\DoxyCodeLine{00201\ \}\ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_ac695d1b0235e9eb16eba57304be42afe}{mi\_memid\_arena\_info\_t}};}
\DoxyCodeLine{00202\ }
\DoxyCodeLine{00203\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structmi__memid__meta__info}{mi\_memid\_meta\_info}}\ \{}
\DoxyCodeLine{00204\ \ \ \textcolor{keywordtype}{void}*\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structmi__memid__meta__info_a86683fab83f709a309bb417080c5b6d3}{meta\_page}};\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ meta-\/page\ that\ contains\ the\ block}}
\DoxyCodeLine{00205\ \ \ \mbox{\hyperlink{eabase_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t}}\ \ \ \ \ \ \mbox{\hyperlink{structmi__memid__meta__info_aa9967e3a5ab3503fd48e2878fa07909b}{block\_index}};\ \ \ \ \ \ \ \ \textcolor{comment}{//\ block\ index\ in\ the\ meta-\/data\ page}}
\DoxyCodeLine{00206\ \ \ \mbox{\hyperlink{eabase_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t}}\ \ \ \ \ \ \mbox{\hyperlink{structmi__memid__meta__info_ab47d59983b8a535da669ac0dd1f7bab6}{block\_count}};\ \ \ \ \ \ \ \ \textcolor{comment}{//\ allocated\ blocks}}
\DoxyCodeLine{00207\ \}\ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_a8708a9393a0145269930aff3abc74fe2}{mi\_memid\_meta\_info\_t}};}
\DoxyCodeLine{00208\ }
\DoxyCodeLine{00209\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structmi__memid__s}{mi\_memid\_s}}\ \{}
\DoxyCodeLine{00210\ \ \ \textcolor{keyword}{union\ }\{}
\DoxyCodeLine{00211\ \ \ \ \ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_a70931ac8fdefe190edaa2148f9120bc2}{mi\_memid\_os\_info\_t}}\ \ \ \ \mbox{\hyperlink{structmi__memid__s_a0d25b7fe835ace64c0d7a48985226b2a}{os}};\ \ \ \ \ \ \ \textcolor{comment}{//\ only\ used\ for\ MI\_MEM\_OS}}
\DoxyCodeLine{00212\ \ \ \ \ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_ac695d1b0235e9eb16eba57304be42afe}{mi\_memid\_arena\_info\_t}}\ \mbox{\hyperlink{structmi__memid__s_ab37324e8c450c726d0455f2107fb70c8}{arena}};\ \ \ \ \textcolor{comment}{//\ only\ used\ for\ MI\_MEM\_ARENA}}
\DoxyCodeLine{00213\ \ \ \ \ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_a8708a9393a0145269930aff3abc74fe2}{mi\_memid\_meta\_info\_t}}\ \ \mbox{\hyperlink{structmi__memid__s_af9016b18125e21644f61209b8602ff16}{meta}};\ \ \ \ \ \textcolor{comment}{//\ only\ used\ for\ MI\_MEM\_META}}
\DoxyCodeLine{00214\ \ \ \}\ \mbox{\hyperlink{structmi__memid__s_af2f5c4ffe67f2c97781d5c15346de01a}{mem}};}
\DoxyCodeLine{00215\ \ \ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_a79f74a576251f2073135a4124d6d32f1}{mi\_memkind\_t}}\ \ \mbox{\hyperlink{structmi__memid__s_a6f3573b226287cf7875980e33029e0d9}{memkind}};}
\DoxyCodeLine{00216\ \ \ \textcolor{keywordtype}{bool}\ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structmi__memid__s_ac91743de3a74ed0c22ff2cbeddd265eb}{is\_pinned}};\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ \`{}true`\ if\ we\ cannot\ decommit/reset/protect\ in\ this\ memory\ (e.g.\ when\ allocated\ using\ large\ (2Mib)\ or\ huge\ (1GiB)\ OS\ pages)}}
\DoxyCodeLine{00217\ \ \ \textcolor{keywordtype}{bool}\ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structmi__memid__s_a8cc880466e89310084c27af2c0dc3e3e}{initially\_committed}};\textcolor{comment}{//\ \`{}true`\ if\ the\ memory\ was\ originally\ allocated\ as\ committed}}
\DoxyCodeLine{00218\ \ \ \textcolor{keywordtype}{bool}\ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structmi__memid__s_a6e612a9fceb896ba741a1b171bf81a4d}{initially\_zero}};\ \ \ \ \ \textcolor{comment}{//\ \`{}true`\ if\ the\ memory\ was\ originally\ zero\ initialized}}
\DoxyCodeLine{00219\ \}\ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_a56a2cb6eed720cdd1fa4b9907c44d7d0}{mi\_memid\_t}};}
\DoxyCodeLine{00220\ }
\DoxyCodeLine{00221\ }
\DoxyCodeLine{00222\ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_a0fce4866e7339d1cd95866a54d2bc197}{mi\_memid\_is\_os}}(\mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_a56a2cb6eed720cdd1fa4b9907c44d7d0}{mi\_memid\_t}}\ memid)\ \{}
\DoxyCodeLine{00223\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_a7b53315c793e6a0934fb369cfb0dc388}{mi\_memkind\_is\_os}}(memid.\mbox{\hyperlink{structmi__memid__s_a6f3573b226287cf7875980e33029e0d9}{memkind}});}
\DoxyCodeLine{00224\ \}}
\DoxyCodeLine{00225\ }
\DoxyCodeLine{00226\ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_a15f0edf992702ab13e8ec2bd51df4c31}{mi\_memid\_needs\_no\_free}}(\mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_a56a2cb6eed720cdd1fa4b9907c44d7d0}{mi\_memid\_t}}\ memid)\ \{}
\DoxyCodeLine{00227\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_addbf2d90f0dbd0c3baf3f54a2a8b6292}{mi\_memkind\_needs\_no\_free}}(memid.\mbox{\hyperlink{structmi__memid__s_a6f3573b226287cf7875980e33029e0d9}{memkind}});}
\DoxyCodeLine{00228\ \}}
\DoxyCodeLine{00229\ }
\DoxyCodeLine{00230\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00231\ \textcolor{comment}{//\ Mimalloc\ pages\ contain\ allocated\ blocks}}
\DoxyCodeLine{00232\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00233\ }
\DoxyCodeLine{00234\ \textcolor{comment}{//\ The\ free\ lists\ use\ encoded\ next\ fields}}
\DoxyCodeLine{00235\ \textcolor{comment}{//\ (Only\ actually\ encodes\ when\ MI\_ENCODED\_FREELIST\ is\ defined.)}}
\DoxyCodeLine{00236\ \textcolor{keyword}{typedef}\ uintptr\_t\ \ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_a968c427ff38812f02da6c27b6aefc6c4}{mi\_encoded\_t}};}
\DoxyCodeLine{00237\ }
\DoxyCodeLine{00238\ \textcolor{comment}{//\ thread\ id's}}
\DoxyCodeLine{00239\ \textcolor{keyword}{typedef}\ \textcolor{keywordtype}{size\_t}\ \ \ \ \ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_ae3342b51ed88dd82fa3903ca1727e8a8}{mi\_threadid\_t}};}
\DoxyCodeLine{00240\ }
\DoxyCodeLine{00241\ \textcolor{comment}{//\ free\ lists\ contain\ blocks}}
\DoxyCodeLine{00242\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structmi__block__s}{mi\_block\_s}}\ \{}
\DoxyCodeLine{00243\ \ \ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_a968c427ff38812f02da6c27b6aefc6c4}{mi\_encoded\_t}}\ \mbox{\hyperlink{structmi__block__s_afb3ffbb3933c1377dbbc9afa4f622371}{next}};}
\DoxyCodeLine{00244\ \}\ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_a9a69f9a34bc130b6a51162b980e9c631}{mi\_block\_t}};}
\DoxyCodeLine{00245\ }
\DoxyCodeLine{00246\ }
\DoxyCodeLine{00247\ \textcolor{comment}{//\ The\ page\ flags\ are\ put\ in\ the\ bottom\ 2\ bits\ of\ the\ thread\_id\ (for\ a\ fast\ test\ in\ \`{}mi\_free`)}}
\DoxyCodeLine{00248\ \textcolor{comment}{//\ \`{}has\_aligned`\ is\ true\ if\ the\ page\ has\ pointers\ at\ an\ offset\ in\ a\ block\ (so\ we\ unalign\ before\ free-\/ing)}}
\DoxyCodeLine{00249\ \textcolor{comment}{//\ \`{}in\_full\_queue`\ is\ true\ if\ the\ page\ is\ full\ and\ resides\ in\ the\ full\ queue\ (so\ we\ move\ it\ to\ a\ regular\ queue\ on\ free-\/ing)}}
\DoxyCodeLine{00250\ \textcolor{preprocessor}{\#define\ MI\_PAGE\_IN\_FULL\_QUEUE\ \ \ \ \ \ \ \ \ MI\_ZU(0x01)}}
\DoxyCodeLine{00251\ \textcolor{preprocessor}{\#define\ MI\_PAGE\_HAS\_ALIGNED\ \ \ \ \ \ \ \ \ \ \ MI\_ZU(0x02)}}
\DoxyCodeLine{00252\ \textcolor{preprocessor}{\#define\ MI\_PAGE\_FLAG\_MASK\ \ \ \ \ \ \ \ \ \ \ \ \ MI\_ZU(0x03)}}
\DoxyCodeLine{00253\ \textcolor{keyword}{typedef}\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_a51667553cd4742a0347962ca04143a59}{mi\_page\_flags\_t}};}
\DoxyCodeLine{00254\ }
\DoxyCodeLine{00255\ \textcolor{comment}{//\ There\ are\ two\ special\ threadid's:\ 0\ for\ abandoned\ threads,\ and\ 4\ for\ abandoned\ \&\ mapped\ threads\ -\/-\/}}
\DoxyCodeLine{00256\ \textcolor{comment}{//\ abandoned-\/mapped\ pages\ are\ abandoned\ but\ also\ mapped\ in\ an\ arena\ so\ can\ be\ quickly\ found\ for\ reuse.}}
\DoxyCodeLine{00257\ \textcolor{preprocessor}{\#define\ MI\_THREADID\_ABANDONED\ \ \ \ \ \ \ \ \ MI\_ZU(0)}}
\DoxyCodeLine{00258\ \textcolor{preprocessor}{\#define\ MI\_THREADID\_ABANDONED\_MAPPED\ \ (MI\_PAGE\_FLAG\_MASK\ +\ 1)}}
\DoxyCodeLine{00259\ }
\DoxyCodeLine{00260\ \textcolor{comment}{//\ Thread\ free\ list.}}
\DoxyCodeLine{00261\ \textcolor{comment}{//\ Points\ to\ a\ list\ of\ blocks\ that\ are\ freed\ by\ other\ threads.}}
\DoxyCodeLine{00262\ \textcolor{comment}{//\ The\ least-\/bit\ is\ set\ if\ the\ page\ is\ owned\ by\ the\ current\ thread.\ (`mi\_page\_is\_owned`).}}
\DoxyCodeLine{00263\ \textcolor{comment}{//\ Ownership\ is\ required\ before\ we\ can\ read\ any\ non-\/atomic\ fields\ in\ the\ page.}}
\DoxyCodeLine{00264\ \textcolor{comment}{//\ This\ way\ we\ can\ push\ a\ block\ on\ the\ thread\ free\ list\ and\ try\ to\ claim\ ownership\ atomically\ in\ \`{}free.c:mi\_free\_block\_mt`.}}
\DoxyCodeLine{00265\ \textcolor{keyword}{typedef}\ uintptr\_t\ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_aa9fb16bc3b4469d57c7b2747c6718b15}{mi\_thread\_free\_t}};}
\DoxyCodeLine{00266\ }
\DoxyCodeLine{00267\ \textcolor{comment}{//\ A\ heap\ can\ serve\ only\ specific\ objects\ signified\ by\ its\ heap\ tag\ (e.g.\ various\ object\ types\ in\ CPython)}}
\DoxyCodeLine{00268\ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{eabase_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_a4e05bcab5a6832b213e85e7186bd24bd}{mi\_heaptag\_t}};}
\DoxyCodeLine{00269\ }
\DoxyCodeLine{00270\ \textcolor{comment}{//\ A\ page\ contains\ blocks\ of\ one\ specific\ size\ (`block\_size`).}}
\DoxyCodeLine{00271\ \textcolor{comment}{//\ Each\ page\ has\ three\ list\ of\ free\ blocks:}}
\DoxyCodeLine{00272\ \textcolor{comment}{//\ \`{}free`\ for\ blocks\ that\ can\ be\ allocated,}}
\DoxyCodeLine{00273\ \textcolor{comment}{//\ \`{}local\_free`\ for\ freed\ blocks\ that\ are\ not\ yet\ available\ to\ \`{}mi\_malloc`}}
\DoxyCodeLine{00274\ \textcolor{comment}{//\ \`{}thread\_free`\ for\ freed\ blocks\ by\ other\ threads}}
\DoxyCodeLine{00275\ \textcolor{comment}{//\ The\ \`{}local\_free`\ and\ \`{}thread\_free`\ lists\ are\ migrated\ to\ the\ \`{}free`\ list}}
\DoxyCodeLine{00276\ \textcolor{comment}{//\ when\ it\ is\ exhausted.\ The\ separate\ \`{}local\_free`\ list\ is\ necessary\ to}}
\DoxyCodeLine{00277\ \textcolor{comment}{//\ implement\ a\ monotonic\ heartbeat.\ The\ \`{}thread\_free`\ list\ is\ needed\ for}}
\DoxyCodeLine{00278\ \textcolor{comment}{//\ avoiding\ atomic\ operations\ when\ allocating\ from\ the\ owning\ thread.}}
\DoxyCodeLine{00279\ \textcolor{comment}{//}}
\DoxyCodeLine{00280\ \textcolor{comment}{//\ \`{}used\ -\/\ |thread\_free|`\ ==\ actual\ blocks\ that\ are\ in\ use\ (alive)}}
\DoxyCodeLine{00281\ \textcolor{comment}{//\ \`{}used\ -\/\ |thread\_free|\ +\ |free|\ +\ |local\_free|\ ==\ capacity`}}
\DoxyCodeLine{00282\ \textcolor{comment}{//}}
\DoxyCodeLine{00283\ \textcolor{comment}{//\ We\ don't\ count\ "{}freed"{}\ (as\ |free|)\ but\ use\ only\ the\ \`{}used`\ field\ to\ reduce}}
\DoxyCodeLine{00284\ \textcolor{comment}{//\ the\ number\ of\ memory\ accesses\ in\ the\ \`{}mi\_page\_all\_free`\ function(s).}}
\DoxyCodeLine{00285\ \textcolor{comment}{//\ Use\ \`{}\_mi\_page\_free\_collect`\ to\ collect\ the\ thread\_free\ list\ and\ update\ the\ \`{}used`\ count.}}
\DoxyCodeLine{00286\ \textcolor{comment}{//}}
\DoxyCodeLine{00287\ \textcolor{comment}{//\ Notes:}}
\DoxyCodeLine{00288\ \textcolor{comment}{//\ -\/\ Non-\/atomic\ fields\ can\ only\ be\ accessed\ if\ having\ \_ownership\_\ (low\ bit\ of\ \`{}xthread\_free`\ is\ 1).}}
\DoxyCodeLine{00289\ \textcolor{comment}{//\ \ \ Combining\ the\ \`{}thread\_free`\ list\ with\ an\ ownership\ bit\ allows\ a\ concurrent\ \`{}free`\ to\ atomically}}
\DoxyCodeLine{00290\ \textcolor{comment}{//\ \ \ free\ an\ object\ and\ (re)claim\ ownership\ if\ the\ page\ was\ abandoned.}}
\DoxyCodeLine{00291\ \textcolor{comment}{//\ -\/\ If\ a\ page\ is\ not\ part\ of\ a\ heap\ it\ is\ called\ "{}abandoned"{}\ \ (`heap==NULL`)\ -\/-\/\ in}}
\DoxyCodeLine{00292\ \textcolor{comment}{//\ \ \ that\ case\ the\ \`{}xthreadid`\ is\ 0\ or\ 4\ (4\ is\ for\ abandoned\ pages\ that}}
\DoxyCodeLine{00293\ \textcolor{comment}{//\ \ \ are\ in\ the\ abandoned\ page\ lists\ of\ an\ arena,\ these\ are\ called\ "{}mapped"{}\ abandoned\ pages).}}
\DoxyCodeLine{00294\ \textcolor{comment}{//\ -\/\ page\ flags\ are\ in\ the\ bottom\ 3\ bits\ of\ \`{}xthread\_id`\ for\ the\ fast\ path\ in\ \`{}mi\_free`.}}
\DoxyCodeLine{00295\ \textcolor{comment}{//\ -\/\ The\ layout\ is\ optimized\ for\ \`{}free.c:mi\_free`\ and\ \`{}alloc.c:mi\_page\_alloc`}}
\DoxyCodeLine{00296\ \textcolor{comment}{//\ -\/\ Using\ \`{}uint16\_t`\ does\ not\ seem\ to\ slow\ things\ down}}
\DoxyCodeLine{00297\ }
\DoxyCodeLine{00298\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structmi__page__s}{mi\_page\_s}}\ \{}
\DoxyCodeLine{00299\ \ \ \mbox{\hyperlink{structmi__page__s_aa9e66437888bcd10255bed10b8eeed96}{\_Atomic}}(\mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_ae3342b51ed88dd82fa3903ca1727e8a8}{mi\_threadid\_t}})\ \ \ \ xthread\_id;\ \ \ \ \ \ \ \ \textcolor{comment}{//\ thread\ this\ page\ belongs\ to.\ (=\ \`{}heap-\/>thread\_id\ (or\ 0\ or\ 4\ if\ abandoned)\ |\ page\_flags`)}}
\DoxyCodeLine{00300\ }
\DoxyCodeLine{00301\ \ \ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_a9a69f9a34bc130b6a51162b980e9c631}{mi\_block\_t}}*\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structmi__page__s_ae2d4b1c483d94e3624319bbca00d3da3}{free}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ list\ of\ available\ free\ blocks\ (`malloc`\ allocates\ from\ this\ list)}}
\DoxyCodeLine{00302\ \ \ \mbox{\hyperlink{eabase_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structmi__page__s_ad1194a6cecba67ba2cf1952eb337968c}{used}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ number\ of\ blocks\ in\ use\ (including\ blocks\ in\ \`{}thread\_free`)}}
\DoxyCodeLine{00303\ \ \ \mbox{\hyperlink{eabase_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structmi__page__s_a9ed1099a997d9c4e42b3bbe631705e41}{capacity}};\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ number\ of\ blocks\ committed}}
\DoxyCodeLine{00304\ \ \ \mbox{\hyperlink{eabase_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structmi__page__s_acf15d96ab2462c10365859158a84bb72}{reserved}};\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ number\ of\ blocks\ reserved\ in\ memory}}
\DoxyCodeLine{00305\ \ \ \mbox{\hyperlink{eabase_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structmi__page__s_a1be9844192c793c997a041ccea53e726}{block\_size\_shift}};\ \ \textcolor{comment}{//\ if\ not\ zero,\ then\ \`{}(1\ <<\ block\_size\_shift)\ ==\ block\_size`\ (only\ used\ for\ fast\ path\ in\ \`{}free.c:\_mi\_page\_ptr\_unalign`)}}
\DoxyCodeLine{00306\ \ \ \mbox{\hyperlink{eabase_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structmi__page__s_a0a5d0c55c032201268976344519a6842}{retire\_expire}};\ \ \ \ \ \textcolor{comment}{//\ expiration\ count\ for\ retired\ blocks}}
\DoxyCodeLine{00307\ }
\DoxyCodeLine{00308\ \ \ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_a9a69f9a34bc130b6a51162b980e9c631}{mi\_block\_t}}*\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structmi__page__s_a9ed7774dcbd4de583d1594d698128830}{local\_free}};\ \ \ \ \ \ \ \ \textcolor{comment}{//\ list\ of\ deferred\ free\ blocks\ by\ this\ thread\ (migrates\ to\ \`{}free`)}}
\DoxyCodeLine{00309\ \ \ \mbox{\hyperlink{structmi__page__s_a1e90baf31a9e006f20e6fecf6fdb9471}{\_Atomic}}(\mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_aa9fb16bc3b4469d57c7b2747c6718b15}{mi\_thread\_free\_t}})\ xthread\_free;\ \ \ \ \ \ \textcolor{comment}{//\ list\ of\ deferred\ free\ blocks\ freed\ by\ other\ threads\ (=\ \`{}mi\_block\_t*\ |\ (1\ if\ owned)`)}}
\DoxyCodeLine{00310\ }
\DoxyCodeLine{00311\ \ \ \textcolor{keywordtype}{size\_t}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structmi__page__s_a35f5ba0cc587381ac8cffc3e97c27fc0}{block\_size}};\ \ \ \ \ \ \ \ \textcolor{comment}{//\ size\ available\ in\ each\ block\ (always\ \`{}>0`)}}
\DoxyCodeLine{00312\ \ \ \mbox{\hyperlink{eabase_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}*\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structmi__page__s_ad25899641cb8380f19fba005b05293ea}{page\_start}};\ \ \ \ \ \ \ \ \textcolor{comment}{//\ start\ of\ the\ blocks}}
\DoxyCodeLine{00313\ \ \ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_a4e05bcab5a6832b213e85e7186bd24bd}{mi\_heaptag\_t}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structmi__page__s_a7a497670246f95df7e1191b9dde1667c}{heap\_tag}};\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ tag\ of\ the\ owning\ heap,\ used\ to\ separate\ heaps\ by\ object\ type}}
\DoxyCodeLine{00314\ \ \ \textcolor{keywordtype}{bool}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structmi__page__s_ad01f597f484f95c73fd5085168e4be34}{free\_is\_zero}};\ \ \ \ \ \ \textcolor{comment}{//\ \`{}true`\ if\ the\ blocks\ in\ the\ free\ list\ are\ zero\ initialized}}
\DoxyCodeLine{00315\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ padding}}
\DoxyCodeLine{00316\ \textcolor{preprocessor}{\ \ \#if\ (MI\_ENCODE\_FREELIST\ ||\ MI\_PADDING)}}
\DoxyCodeLine{00317\ \ \ uintptr\_t\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structmi__page__s_a720620090a6e049d89c015c647900034}{keys}}[2];\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ two\ random\ keys\ to\ encode\ the\ free\ lists\ (see\ \`{}\_mi\_block\_next`)\ or\ padding\ canary}}
\DoxyCodeLine{00318\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{00319\ }
\DoxyCodeLine{00320\ \ \ \mbox{\hyperlink{group__heap_ga34a47cde5a5b38c29f1aa3c5e76943c2}{mi\_heap\_t}}*\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structmi__page__s_a629f6d941b563c85042782dedf1f6301}{heap}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ the\ heap\ owning\ this\ page\ (or\ NULL\ for\ abandoned\ pages)}}
\DoxyCodeLine{00321\ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structmi__page__s}{mi\_page\_s}}*\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structmi__page__s_a3cb74f9debb9c29f48990a6b39ec4233}{next}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ next\ page\ owned\ by\ the\ heap\ with\ the\ same\ \`{}block\_size`}}
\DoxyCodeLine{00322\ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structmi__page__s}{mi\_page\_s}}*\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structmi__page__s_a5d6c37ca83250fdb2b58cb2767cb0f4c}{prev}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ previous\ page\ owned\ by\ the\ heap\ with\ the\ same\ \`{}block\_size`}}
\DoxyCodeLine{00323\ \ \ \textcolor{keywordtype}{size\_t}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structmi__page__s_a3a1365636f40fd98ed2a26d16472d8d8}{slice\_committed}};\ \ \ \textcolor{comment}{//\ committed\ size\ relative\ to\ the\ first\ arena\ slice\ of\ the\ page\ data\ (or\ 0\ if\ the\ page\ is\ fully\ committed\ already)}}
\DoxyCodeLine{00324\ \ \ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_a56a2cb6eed720cdd1fa4b9907c44d7d0}{mi\_memid\_t}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structmi__page__s_a38337bec0f42cdba61acbf5eded5eddb}{memid}};\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ provenance\ of\ the\ page\ memory}}
\DoxyCodeLine{00325\ \}\ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_a98e3d539b4113aac496ebe3d379ebe5b}{mi\_page\_t}};}
\DoxyCodeLine{00326\ }
\DoxyCodeLine{00327\ }
\DoxyCodeLine{00328\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00329\ \textcolor{comment}{//\ Object\ sizes}}
\DoxyCodeLine{00330\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00331\ }
\DoxyCodeLine{00332\ \textcolor{preprocessor}{\#define\ MI\_PAGE\_ALIGN\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ MI\_ARENA\_SLICE\_ALIGN\ }\textcolor{comment}{//\ pages\ must\ be\ aligned\ on\ this\ for\ the\ page\ map.}}
\DoxyCodeLine{00333\ \textcolor{preprocessor}{\#define\ MI\_PAGE\_MIN\_START\_BLOCK\_ALIGN\ \ \ \ \ MI\_MAX\_ALIGN\_SIZE\ \ \ \ }\textcolor{comment}{//\ minimal\ block\ alignment\ for\ the\ first\ block\ in\ a\ page\ (16b)}}
\DoxyCodeLine{00334\ \textcolor{preprocessor}{\#define\ MI\_PAGE\_MAX\_START\_BLOCK\_ALIGN2\ \ \ \ MI\_KiB\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }\textcolor{comment}{//\ maximal\ block\ alignment\ for\ "{}power\ of\ 2"{}-\/sized\ blocks\ (such\ that\ we\ guarantee\ natural\ alignment)}}
\DoxyCodeLine{00335\ \textcolor{preprocessor}{\#define\ MI\_PAGE\_MAX\_OVERALLOC\_ALIGN\ \ \ \ \ \ \ MI\_ARENA\_SLICE\_SIZE\ \ }\textcolor{comment}{//\ (64\ KiB)\ limit\ for\ which\ we\ overallocate\ in\ arena\ pages,\ beyond\ this\ use\ OS\ allocation}}
\DoxyCodeLine{00336\ }
\DoxyCodeLine{00337\ \textcolor{preprocessor}{\#if\ (MI\_ENCODE\_FREELIST\ ||\ MI\_PADDING)\ \&\&\ MI\_SIZE\_SIZE\ ==\ 8}}
\DoxyCodeLine{00338\ \textcolor{preprocessor}{\#define\ MI\_PAGE\_INFO\_SIZE\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ((MI\_INTPTR\_SHIFT+2)*32)\ \ }\textcolor{comment}{//\ 160\ \ \ \ >=\ sizeof(mi\_page\_t)}}
\DoxyCodeLine{00339\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00340\ \textcolor{preprocessor}{\#define\ MI\_PAGE\_INFO\_SIZE\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ((MI\_INTPTR\_SHIFT+1)*32)\ \ }\textcolor{comment}{//\ 128/96\ >=\ sizeof(mi\_page\_t)}}
\DoxyCodeLine{00341\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00342\ }
\DoxyCodeLine{00343\ \textcolor{comment}{//\ The\ max\ object\ size\ are\ checked\ to\ not\ waste\ more\ than\ 12.5\%\ internally\ over\ the\ page\ sizes.}}
\DoxyCodeLine{00344\ \textcolor{preprocessor}{\#define\ MI\_SMALL\_MAX\_OBJ\_SIZE\ \ \ \ \ \ \ \ \ \ \ \ \ ((MI\_SMALL\_PAGE\_SIZE-\/MI\_PAGE\_INFO\_SIZE)/8)\ \ \ }\textcolor{comment}{//\ <\ \string~8\ KiB}}
\DoxyCodeLine{00345\ \textcolor{preprocessor}{\#if\ MI\_ENABLE\_LARGE\_PAGES}}
\DoxyCodeLine{00346\ \textcolor{preprocessor}{\#define\ MI\_MEDIUM\_MAX\_OBJ\_SIZE\ \ \ \ \ \ \ \ \ \ \ \ ((MI\_MEDIUM\_PAGE\_SIZE-\/MI\_PAGE\_INFO\_SIZE)/8)\ \ }\textcolor{comment}{//\ <\ \string~64\ KiB}}
\DoxyCodeLine{00347\ \textcolor{preprocessor}{\#define\ MI\_LARGE\_MAX\_OBJ\_SIZE\ \ \ \ \ \ \ \ \ \ \ \ \ (MI\_LARGE\_PAGE\_SIZE/8)\ \ \ \ }\textcolor{comment}{//\ <=\ 512KiB\ //\ note:\ this\ must\ be\ a\ nice\ power\ of\ 2\ or\ we\ get\ rounding\ issues\ with\ \`{}\_mi\_bin`}}
\DoxyCodeLine{00348\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00349\ \textcolor{preprocessor}{\#define\ MI\_MEDIUM\_MAX\_OBJ\_SIZE\ \ \ \ \ \ \ \ \ \ \ \ (MI\_MEDIUM\_PAGE\_SIZE/8)\ \ \ }\textcolor{comment}{//\ <=\ 64\ KiB}}
\DoxyCodeLine{00350\ \textcolor{preprocessor}{\#define\ MI\_LARGE\_MAX\_OBJ\_SIZE\ \ \ \ \ \ \ \ \ \ \ \ \ MI\_MEDIUM\_MAX\_OBJ\_SIZE\ \ \ \ }\textcolor{comment}{//\ note:\ this\ must\ be\ a\ nice\ power\ of\ 2\ or\ we\ get\ rounding\ issues\ with\ \`{}\_mi\_bin`}}
\DoxyCodeLine{00351\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00352\ \textcolor{preprocessor}{\#define\ MI\_LARGE\_MAX\_OBJ\_WSIZE\ \ \ \ \ \ \ \ \ \ \ \ (MI\_LARGE\_MAX\_OBJ\_SIZE/MI\_SIZE\_SIZE)}}
\DoxyCodeLine{00353\ }
\DoxyCodeLine{00354\ \textcolor{preprocessor}{\#if\ (MI\_LARGE\_MAX\_OBJ\_WSIZE\ >=\ 655360)}}
\DoxyCodeLine{00355\ \textcolor{preprocessor}{\#error\ "{}mimalloc\ internal:\ define\ more\ bins"{}}}
\DoxyCodeLine{00356\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00357\ }
\DoxyCodeLine{00358\ }
\DoxyCodeLine{00359\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00360\ \textcolor{comment}{//\ Page\ kinds}}
\DoxyCodeLine{00361\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00362\ }
\DoxyCodeLine{00363\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{enum}\ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_a40707b37a1cde84f070801cb1d0ebabf}{mi\_page\_kind\_e}}\ \{}
\DoxyCodeLine{00364\ \ \ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_a40707b37a1cde84f070801cb1d0ebabfab4d4880401b29ee82a6d962d07cdce78}{MI\_PAGE\_SMALL}},\ \ \ \ \textcolor{comment}{//\ small\ blocks\ go\ into\ 64KiB\ pages}}
\DoxyCodeLine{00365\ \ \ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_a40707b37a1cde84f070801cb1d0ebabfa74390e0f38960d3ce03f45d793f00a72}{MI\_PAGE\_MEDIUM}},\ \ \ \textcolor{comment}{//\ medium\ blocks\ go\ into\ 512KiB\ pages}}
\DoxyCodeLine{00366\ \ \ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_a40707b37a1cde84f070801cb1d0ebabfae5b16218315d436d47520f8d2aede8f1}{MI\_PAGE\_LARGE}},\ \ \ \ \textcolor{comment}{//\ larger\ blocks\ go\ into\ 4MiB\ pages\ (if\ \`{}MI\_ENABLE\_LARGE\_PAGES==1`)}}
\DoxyCodeLine{00367\ \ \ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_a40707b37a1cde84f070801cb1d0ebabfabc95ed1e84f11d7d3dc7e3eab4c8bb48}{MI\_PAGE\_SINGLETON}}\ \textcolor{comment}{//\ page\ containing\ a\ single\ block.}}
\DoxyCodeLine{00368\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ used\ for\ blocks\ \`{}>\ MI\_LARGE\_MAX\_OBJ\_SIZE`\ or\ an\ aligment\ \`{}>\ MI\_PAGE\_MAX\_OVERALLOC\_ALIGN`.}}
\DoxyCodeLine{00369\ \}\ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_a8a9b58b501aa6adda5c0219a0cacbbff}{mi\_page\_kind\_t}};}
\DoxyCodeLine{00370\ }
\DoxyCodeLine{00371\ }
\DoxyCodeLine{00372\ }
\DoxyCodeLine{00373\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00374\ \textcolor{comment}{//\ Heaps}}
\DoxyCodeLine{00375\ \textcolor{comment}{//}}
\DoxyCodeLine{00376\ \textcolor{comment}{//\ Provide\ first-\/class\ heaps\ to\ allocate\ from.}}
\DoxyCodeLine{00377\ \textcolor{comment}{//\ A\ heap\ just\ owns\ a\ set\ of\ pages\ for\ allocation\ and}}
\DoxyCodeLine{00378\ \textcolor{comment}{//\ can\ only\ be\ allocate/reallocate\ from\ the\ thread\ that\ created\ it.}}
\DoxyCodeLine{00379\ \textcolor{comment}{//\ Freeing\ blocks\ can\ be\ done\ from\ any\ thread\ though.}}
\DoxyCodeLine{00380\ \textcolor{comment}{//}}
\DoxyCodeLine{00381\ \textcolor{comment}{//\ Per\ thread,\ there\ is\ always\ a\ default\ heap\ that\ is}}
\DoxyCodeLine{00382\ \textcolor{comment}{//\ used\ for\ allocation;\ it\ is\ initialized\ to\ statically}}
\DoxyCodeLine{00383\ \textcolor{comment}{//\ point\ to\ an\ empty\ heap\ to\ avoid\ initialization\ checks}}
\DoxyCodeLine{00384\ \textcolor{comment}{//\ in\ the\ fast\ path.}}
\DoxyCodeLine{00385\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00386\ }
\DoxyCodeLine{00387\ \textcolor{comment}{//\ Thread\ local\ data}}
\DoxyCodeLine{00388\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structmi__tld__s}{mi\_tld\_s}}\ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_af498cfcb63d2378172fc14f59d134fca}{mi\_tld\_t}};}
\DoxyCodeLine{00389\ }
\DoxyCodeLine{00390\ \textcolor{comment}{//\ Pages\ of\ a\ certain\ block\ size\ are\ held\ in\ a\ queue.}}
\DoxyCodeLine{00391\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structmi__page__queue__s}{mi\_page\_queue\_s}}\ \{}
\DoxyCodeLine{00392\ \ \ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_a98e3d539b4113aac496ebe3d379ebe5b}{mi\_page\_t}}*\ \mbox{\hyperlink{structmi__page__queue__s_a2ac5077507dc4bf25a1a8df36955469a}{first}};}
\DoxyCodeLine{00393\ \ \ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_a98e3d539b4113aac496ebe3d379ebe5b}{mi\_page\_t}}*\ \mbox{\hyperlink{structmi__page__queue__s_a92703b3d44e0581c4037345a93081446}{last}};}
\DoxyCodeLine{00394\ \ \ \textcolor{keywordtype}{size\_t}\ \ \ \ \ \mbox{\hyperlink{structmi__page__queue__s_a299da47cff98a62bd197dbf283ddedac}{count}};}
\DoxyCodeLine{00395\ \ \ \textcolor{keywordtype}{size\_t}\ \ \ \ \ \mbox{\hyperlink{structmi__page__queue__s_a650100de75005e34566b2d170db7c0e8}{block\_size}};}
\DoxyCodeLine{00396\ \}\ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_a9646624e7de8587984ec8e8cd5c5d780}{mi\_page\_queue\_t}};}
\DoxyCodeLine{00397\ }
\DoxyCodeLine{00398\ \textcolor{comment}{//\ Random\ context}}
\DoxyCodeLine{00399\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structmi__random__cxt__s}{mi\_random\_cxt\_s}}\ \{}
\DoxyCodeLine{00400\ \ \ \mbox{\hyperlink{eabase_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t}}\ \mbox{\hyperlink{structmi__random__cxt__s_aaa3a2fbc83f257ecf03bfe6544641eef}{input}}[16];}
\DoxyCodeLine{00401\ \ \ \mbox{\hyperlink{eabase_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t}}\ \mbox{\hyperlink{structmi__random__cxt__s_a2521a8c031d58f5c328ac62f30a274e9}{output}}[16];}
\DoxyCodeLine{00402\ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \mbox{\hyperlink{structmi__random__cxt__s_ae0250a5125e5675b6cd979bc724cf2cc}{output\_available}};}
\DoxyCodeLine{00403\ \ \ \textcolor{keywordtype}{bool}\ \ \ \ \ \mbox{\hyperlink{structmi__random__cxt__s_a75dae3593d850880ba00dbedb3d23186}{weak}};}
\DoxyCodeLine{00404\ \}\ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_a31cfd49f9f6f9e40f1a46c9879203e71}{mi\_random\_ctx\_t}};}
\DoxyCodeLine{00405\ }
\DoxyCodeLine{00406\ }
\DoxyCodeLine{00407\ \textcolor{comment}{//\ In\ debug\ mode\ there\ is\ a\ padding\ structure\ at\ the\ end\ of\ the\ blocks\ to\ check\ for\ buffer\ overflows}}
\DoxyCodeLine{00408\ \textcolor{preprocessor}{\#if\ MI\_PADDING}}
\DoxyCodeLine{00409\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structmi__padding__s}{mi\_padding\_s}}\ \{}
\DoxyCodeLine{00410\ \ \ \mbox{\hyperlink{eabase_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t}}\ \mbox{\hyperlink{structmi__padding__s_a227a1074f8f9ab4c2e4e1dba83da4164}{canary}};\ \textcolor{comment}{//\ encoded\ block\ value\ to\ check\ validity\ of\ the\ padding\ (in\ case\ of\ overflow)}}
\DoxyCodeLine{00411\ \ \ \mbox{\hyperlink{eabase_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t}}\ \mbox{\hyperlink{structmi__padding__s_a68c8d1f1912c6b5a9c040e77094cb5ec}{delta}};\ \ \textcolor{comment}{//\ padding\ bytes\ before\ the\ block.\ (mi\_usable\_size(p)\ -\/\ delta\ ==\ exact\ allocated\ bytes)}}
\DoxyCodeLine{00412\ \}\ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_ac07397b1cfdc81657699d5fc21610aa4}{mi\_padding\_t}};}
\DoxyCodeLine{00413\ \textcolor{preprocessor}{\#define\ MI\_PADDING\_SIZE\ \ \ (sizeof(mi\_padding\_t))}}
\DoxyCodeLine{00414\ \textcolor{preprocessor}{\#define\ MI\_PADDING\_WSIZE\ \ ((MI\_PADDING\_SIZE\ +\ MI\_INTPTR\_SIZE\ -\/\ 1)\ /\ MI\_INTPTR\_SIZE)}}
\DoxyCodeLine{00415\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00416\ \textcolor{preprocessor}{\#define\ MI\_PADDING\_SIZE\ \ \ 0}}
\DoxyCodeLine{00417\ \textcolor{preprocessor}{\#define\ MI\_PADDING\_WSIZE\ \ 0}}
\DoxyCodeLine{00418\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00419\ }
\DoxyCodeLine{00420\ \textcolor{preprocessor}{\#define\ MI\_PAGES\_DIRECT\ \ \ (MI\_SMALL\_WSIZE\_MAX\ +\ MI\_PADDING\_WSIZE\ +\ 1)}}
\DoxyCodeLine{00421\ }
\DoxyCodeLine{00422\ }
\DoxyCodeLine{00423\ \textcolor{comment}{//\ A\ heap\ owns\ a\ set\ of\ pages.}}
\DoxyCodeLine{00424\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structmi__heap__s}{mi\_heap\_s}}\ \{}
\DoxyCodeLine{00425\ \ \ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_af498cfcb63d2378172fc14f59d134fca}{mi\_tld\_t}}*\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structmi__heap__s_a2e524aeb1b30f344a4f0b70e6cf6cb3a}{tld}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ thread-\/local\ data}}
\DoxyCodeLine{00426\ \ \ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_a4187c38d7fe26f37558a31eb935dfe2d}{mi\_arena\_t}}*\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structmi__heap__s_a4eec2cb7a91ef34810687b013d1dab77}{exclusive\_arena}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ if\ the\ heap\ should\ only\ allocate\ from\ a\ specific\ arena\ (or\ NULL)}}
\DoxyCodeLine{00427\ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structmi__heap__s_a6d7737e586be3ac1c4a89f117898093b}{numa\_node}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ preferred\ numa\ node\ (or\ -\/1\ for\ no\ preference)}}
\DoxyCodeLine{00428\ \ \ uintptr\_t\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structmi__heap__s_ab6774a8a1c46ae4b726541fb1ebb4298}{cookie}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ random\ cookie\ to\ verify\ pointers\ (see\ \`{}\_mi\_ptr\_cookie`)}}
\DoxyCodeLine{00429\ \ \ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_a31cfd49f9f6f9e40f1a46c9879203e71}{mi\_random\_ctx\_t}}\ \ \ \ \ \ \ \mbox{\hyperlink{structmi__heap__s_a90b8564d889dcda571bc31188e16778d}{random}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ random\ number\ context\ used\ for\ secure\ allocation}}
\DoxyCodeLine{00430\ \ \ \textcolor{keywordtype}{size\_t}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structmi__heap__s_a4d139f61ef10d6ef25a0d1f99fcdf18c}{page\_count}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ total\ number\ of\ pages\ in\ the\ \`{}pages`\ queues.}}
\DoxyCodeLine{00431\ \ \ \textcolor{keywordtype}{size\_t}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structmi__heap__s_a36bccfd0ae24a8358846037cb31f5c08}{page\_retired\_min}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ smallest\ retired\ index\ (retired\ pages\ are\ fully\ free,\ but\ still\ in\ the\ page\ queues)}}
\DoxyCodeLine{00432\ \ \ \textcolor{keywordtype}{size\_t}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structmi__heap__s_abee70406811029ca76f2609160b9c82b}{page\_retired\_max}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ largest\ retired\ index\ into\ the\ \`{}pages`\ array.}}
\DoxyCodeLine{00433\ \ \ \textcolor{keywordtype}{long}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structmi__heap__s_a4beb269b3a172ef5aef39e1a2c7ee4ed}{generic\_count}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ how\ often\ is\ \`{}\_mi\_malloc\_generic`\ called?}}
\DoxyCodeLine{00434\ \ \ \textcolor{keywordtype}{long}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structmi__heap__s_a159fd643ee154732390d4b2582140ba3}{generic\_collect\_count}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ how\ often\ is\ \`{}\_mi\_malloc\_generic`\ called\ without\ collecting?}}
\DoxyCodeLine{00435\ \ \ \mbox{\hyperlink{group__heap_ga34a47cde5a5b38c29f1aa3c5e76943c2}{mi\_heap\_t}}*\ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structmi__heap__s_a1ccd0d74420921e2aa92fa9c9474f497}{next}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ list\ of\ heaps\ per\ thread}}
\DoxyCodeLine{00436\ \ \ \textcolor{keywordtype}{long}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structmi__heap__s_a3ff36ed80a0b89a0e0e913e57b028cb3}{page\_full\_retain}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ how\ many\ full\ pages\ can\ be\ retained\ per\ queue\ (before\ abondoning\ them)}}
\DoxyCodeLine{00437\ \ \ \textcolor{keywordtype}{bool}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structmi__heap__s_a14d0f3925d40afb54ed89983fdefb805}{allow\_page\_reclaim}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ \`{}true`\ if\ this\ heap\ should\ not\ reclaim\ abandoned\ pages}}
\DoxyCodeLine{00438\ \ \ \textcolor{keywordtype}{bool}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structmi__heap__s_a8d500d2e3ccde6de4e60682df8ea58ea}{allow\_page\_abandon}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ \`{}true`\ if\ this\ heap\ can\ abandon\ pages\ to\ reduce\ memory\ footprint}}
\DoxyCodeLine{00439\ \ \ \mbox{\hyperlink{eabase_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structmi__heap__s_aa0c7026d19f12f8d3a2539aa030c77cc}{tag}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ custom\ tag,\ can\ be\ used\ for\ separating\ heaps\ based\ on\ the\ object\ types}}
\DoxyCodeLine{00440\ \textcolor{preprocessor}{\ \ \#if\ MI\_GUARDED}}
\DoxyCodeLine{00441\ \ \ \textcolor{keywordtype}{size\_t}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ guarded\_size\_min;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ minimal\ size\ for\ guarded\ objects}}
\DoxyCodeLine{00442\ \ \ \textcolor{keywordtype}{size\_t}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ guarded\_size\_max;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ maximal\ size\ for\ guarded\ objects}}
\DoxyCodeLine{00443\ \ \ \textcolor{keywordtype}{size\_t}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ guarded\_sample\_rate;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ sample\ rate\ (set\ to\ 0\ to\ disable\ guarded\ pages)}}
\DoxyCodeLine{00444\ \ \ \textcolor{keywordtype}{size\_t}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ guarded\_sample\_seed;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ starting\ sample\ count}}
\DoxyCodeLine{00445\ \ \ \textcolor{keywordtype}{size\_t}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ guarded\_sample\_count;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ current\ sample\ count\ (counting\ down\ to\ 0)}}
\DoxyCodeLine{00446\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{00447\ \ \ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_a98e3d539b4113aac496ebe3d379ebe5b}{mi\_page\_t}}*\ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structmi__heap__s_a7a6716ebf08933f56921f8e1a582c30e}{pages\_free\_direct}}[\mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_a2b13309fa6e4af2213033754e0cfcddc}{MI\_PAGES\_DIRECT}}];\ \ \textcolor{comment}{//\ optimize:\ array\ where\ every\ entry\ points\ a\ page\ with\ possibly\ free\ blocks\ in\ the\ corresponding\ queue\ for\ that\ size.}}
\DoxyCodeLine{00448\ \ \ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_a9646624e7de8587984ec8e8cd5c5d780}{mi\_page\_queue\_t}}\ \ \ \ \ \ \ \mbox{\hyperlink{structmi__heap__s_a132c64106a2662761ee57ea5dd4a996b}{pages}}[\mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_a2928685f9d87bc3bd9e0fdac2a7f39ad}{MI\_BIN\_COUNT}}];\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ queue\ of\ pages\ for\ each\ size\ class\ (or\ "{}bin"{})}}
\DoxyCodeLine{00449\ \ \ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_a56a2cb6eed720cdd1fa4b9907c44d7d0}{mi\_memid\_t}}\ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structmi__heap__s_a8939a8e836711da20849d9d5ae92f383}{memid}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ provenance\ of\ the\ heap\ struct\ itself\ (meta\ or\ os)}}
\DoxyCodeLine{00450\ \};}
\DoxyCodeLine{00451\ }
\DoxyCodeLine{00452\ }
\DoxyCodeLine{00453\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00454\ \textcolor{comment}{//\ Sub\ processes\ do\ not\ reclaim\ or\ visit\ segments}}
\DoxyCodeLine{00455\ \textcolor{comment}{//\ from\ other\ sub\ processes.\ These\ are\ essentially\ the}}
\DoxyCodeLine{00456\ \textcolor{comment}{//\ static\ variables\ of\ a\ process.}}
\DoxyCodeLine{00457\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00458\ }
\DoxyCodeLine{00459\ \textcolor{preprocessor}{\#define\ MI\_MAX\_ARENAS\ \ \ (160)\ \ \ }\textcolor{comment}{//\ Limited\ for\ now\ (and\ takes\ up\ .bss)..\ but\ arena's\ scale\ up\ exponentially\ (see\ \`{}mi\_arena\_reserve`)}}
\DoxyCodeLine{00460\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ 160\ arenas\ is\ enough\ for\ \string~2\ TiB\ memory}}
\DoxyCodeLine{00461\ }
\DoxyCodeLine{00462\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structmi__subproc__s}{mi\_subproc\_s}}\ \{}
\DoxyCodeLine{00463\ \ \ \mbox{\hyperlink{structmi__subproc__s_a00d9de72d8c4d63fb218023cb1256ce5}{\_Atomic}}(\textcolor{keywordtype}{size\_t})\ \ \ \ \ \ \ arena\_count;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ current\ count\ of\ arena's}}
\DoxyCodeLine{00464\ \ \ \mbox{\hyperlink{structmi__subproc__s_a56367b5a16d2f3dc91b833d2f6989083}{\_Atomic}}(\mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_a4187c38d7fe26f37558a31eb935dfe2d}{mi\_arena\_t}}*)\ \ arenas[\mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_a8b9cb8ae8d6040191de432544fa94e50}{MI\_MAX\_ARENAS}}];\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ arena's\ of\ this\ sub-\/process}}
\DoxyCodeLine{00465\ \ \ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2atomic_8h_a92081a4edfc511f636a01a647daa81da}{mi\_lock\_t}}\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structmi__subproc__s_ac6dd2cb1893222b0062128cfd857b702}{arena\_reserve\_lock}};\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ lock\ to\ ensure\ arena's\ get\ reserved\ one\ at\ a\ time}}
\DoxyCodeLine{00466\ \ \ \mbox{\hyperlink{structmi__subproc__s_a227fabf66cb4b7345566880ff449e22d}{\_Atomic}}(\mbox{\hyperlink{eabase_8h_adec1df1b8b51cb32b77e5b86fff46471}{int64\_t}})\ \ \ \ \ \ purge\_expire;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ expiration\ is\ set\ if\ any\ arenas\ can\ be\ purged}}
\DoxyCodeLine{00467\ }
\DoxyCodeLine{00468\ \ \ \mbox{\hyperlink{structmi__subproc__s_af14d94e34543d0e9af28f1a155561b5c}{\_Atomic}}(\textcolor{keywordtype}{size\_t})\ \ \ \ \ \ \ abandoned\_count[\mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_a2928685f9d87bc3bd9e0fdac2a7f39ad}{MI\_BIN\_COUNT}}];\ \ \textcolor{comment}{//\ total\ count\ of\ abandoned\ pages\ for\ this\ sub-\/process}}
\DoxyCodeLine{00469\ \ \ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_a98e3d539b4113aac496ebe3d379ebe5b}{mi\_page\_t}}*\ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structmi__subproc__s_a3bbd7dfd7132a702383618abbaa18d96}{os\_abandoned\_pages}};\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ list\ of\ pages\ that\ OS\ allocated\ and\ not\ in\ an\ arena\ (only\ used\ if\ \`{}mi\_option\_visit\_abandoned`\ is\ on)}}
\DoxyCodeLine{00470\ \ \ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2atomic_8h_a92081a4edfc511f636a01a647daa81da}{mi\_lock\_t}}\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structmi__subproc__s_a6080e14abd10c35ea4c28ddc6020e50f}{os\_abandoned\_pages\_lock}};\ \ \ \ \ \ \ \ \textcolor{comment}{//\ lock\ for\ the\ os\ abandoned\ pages\ list\ (this\ lock\ protects\ list\ operations)}}
\DoxyCodeLine{00471\ }
\DoxyCodeLine{00472\ \ \ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_a56a2cb6eed720cdd1fa4b9907c44d7d0}{mi\_memid\_t}}\ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structmi__subproc__s_add483b0f2bad78f2fc0e8e06b5a784e3}{memid}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ provenance\ of\ this\ memory\ block\ (meta\ or\ OS)}}
\DoxyCodeLine{00473\ \ \ \mbox{\hyperlink{mimalloc-stats_8h_ae899fc419d2db1af97887b3f8c049dc1}{mi\_stats\_t}}\ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structmi__subproc__s_aafce415669e240716f751c2e303f9805}{stats}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ sub-\/process\ statistics\ (tld\ stats\ are\ merged\ in\ on\ thread\ termination)}}
\DoxyCodeLine{00474\ \}\ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_ae3f8c09a1b54aa7ab2a9f0dbd7e201d9}{mi\_subproc\_t}};}
\DoxyCodeLine{00475\ }
\DoxyCodeLine{00476\ }
\DoxyCodeLine{00477\ }
\DoxyCodeLine{00478\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00479\ \textcolor{comment}{//\ Thread\ Local\ data}}
\DoxyCodeLine{00480\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00481\ }
\DoxyCodeLine{00482\ \textcolor{comment}{//\ Milliseconds\ as\ in\ \`{}int64\_t`\ to\ avoid\ overflows}}
\DoxyCodeLine{00483\ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{eabase_8h_adec1df1b8b51cb32b77e5b86fff46471}{int64\_t}}\ \ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_af67e75b6480efa6e87b2a3a118e58031}{mi\_msecs\_t}};}
\DoxyCodeLine{00484\ }
\DoxyCodeLine{00485\ \textcolor{comment}{//\ Thread\ local\ data}}
\DoxyCodeLine{00486\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structmi__tld__s}{mi\_tld\_s}}\ \{}
\DoxyCodeLine{00487\ \ \ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_ae3342b51ed88dd82fa3903ca1727e8a8}{mi\_threadid\_t}}\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structmi__tld__s_a6629720f4a37c9dd71417ead57fdd8e7}{thread\_id}};\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ thread\ id\ of\ this\ thread}}
\DoxyCodeLine{00488\ \ \ \textcolor{keywordtype}{size\_t}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structmi__tld__s_ab55771fc6a4f02c50fe229bd358d2ddb}{thread\_seq}};\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ thread\ sequence\ id\ (linear\ count\ of\ created\ threads)}}
\DoxyCodeLine{00489\ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structmi__tld__s_ae38f5cc1bd07652954e007955fd3402d}{numa\_node}};\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ thread\ preferred\ numa\ node}}
\DoxyCodeLine{00490\ \ \ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_ae3f8c09a1b54aa7ab2a9f0dbd7e201d9}{mi\_subproc\_t}}*\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structmi__tld__s_ad62d6e1ac58c413f7d6fb0f9b8ae6ea1}{subproc}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ sub-\/process\ this\ thread\ belongs\ to.}}
\DoxyCodeLine{00491\ \ \ \mbox{\hyperlink{group__heap_ga34a47cde5a5b38c29f1aa3c5e76943c2}{mi\_heap\_t}}*\ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structmi__tld__s_a825d2bc68ca9880193f717fecdfc499e}{heap\_backing}};\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ backing\ heap\ of\ this\ thread\ (cannot\ be\ deleted)}}
\DoxyCodeLine{00492\ \ \ \mbox{\hyperlink{group__heap_ga34a47cde5a5b38c29f1aa3c5e76943c2}{mi\_heap\_t}}*\ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structmi__tld__s_a5c40faac5f2f37cdfe93f42efa697481}{heaps}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ list\ of\ heaps\ in\ this\ thread\ (so\ we\ can\ abandon\ all\ when\ the\ thread\ terminates)}}
\DoxyCodeLine{00493\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{long}\ \textcolor{keywordtype}{long}\ \ \ \ \mbox{\hyperlink{structmi__tld__s_a791f263fc6b2e272af2dcaaab8b99f5b}{heartbeat}};\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ monotonic\ heartbeat\ count}}
\DoxyCodeLine{00494\ \ \ \textcolor{keywordtype}{bool}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structmi__tld__s_a5aad0f33a6a8704dcce59752fa3c2797}{recurse}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ true\ if\ deferred\ was\ called;\ used\ to\ prevent\ infinite\ recursion.}}
\DoxyCodeLine{00495\ \ \ \textcolor{keywordtype}{bool}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structmi__tld__s_a1ba88188c587e503fb860aefd69aefd1}{is\_in\_threadpool}};\ \ \ \ \ \textcolor{comment}{//\ true\ if\ this\ thread\ is\ part\ of\ a\ threadpool\ (and\ can\ run\ arbitrary\ tasks)}}
\DoxyCodeLine{00496\ \ \ \mbox{\hyperlink{mimalloc-stats_8h_ae899fc419d2db1af97887b3f8c049dc1}{mi\_stats\_t}}\ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structmi__tld__s_a08407f89848bb130648aed09b0b33948}{stats}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ statistics}}
\DoxyCodeLine{00497\ \ \ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_a56a2cb6eed720cdd1fa4b9907c44d7d0}{mi\_memid\_t}}\ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structmi__tld__s_a8b9072f5930d393d8e144081b666c5a6}{memid}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ provenance\ of\ the\ tld\ memory\ itself\ (meta\ or\ OS)}}
\DoxyCodeLine{00498\ \};}
\DoxyCodeLine{00499\ }
\DoxyCodeLine{00500\ }
\DoxyCodeLine{00501\ \textcolor{comment}{/*\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00502\ \textcolor{comment}{\ \ Error\ codes\ passed\ to\ \`{}\_mi\_fatal\_error`}}
\DoxyCodeLine{00503\ \textcolor{comment}{\ \ All\ are\ recoverable\ but\ EFAULT\ is\ a\ serious\ error\ and\ aborts\ by\ default\ in\ secure\ mode.}}
\DoxyCodeLine{00504\ \textcolor{comment}{\ \ For\ portability\ define\ undefined\ error\ codes\ using\ common\ Unix\ codes:}}
\DoxyCodeLine{00505\ \textcolor{comment}{\ \ <https://www-\/numi.fnal.gov/offline\_software/srt\_public\_context/WebDocs/Errors/unix\_system\_errors.html>}}
\DoxyCodeLine{00506\ \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\ */}}
\DoxyCodeLine{00507\ }
\DoxyCodeLine{00508\ \textcolor{preprocessor}{\#ifndef\ EAGAIN\ \ \ \ \ \ \ \ \ }\textcolor{comment}{//\ double\ free}}
\DoxyCodeLine{00509\ \textcolor{preprocessor}{\#define\ EAGAIN\ (11)}}
\DoxyCodeLine{00510\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00511\ \textcolor{preprocessor}{\#ifndef\ ENOMEM\ \ \ \ \ \ \ \ \ }\textcolor{comment}{//\ out\ of\ memory}}
\DoxyCodeLine{00512\ \textcolor{preprocessor}{\#define\ ENOMEM\ (12)}}
\DoxyCodeLine{00513\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00514\ \textcolor{preprocessor}{\#ifndef\ EFAULT\ \ \ \ \ \ \ \ \ }\textcolor{comment}{//\ corrupted\ free-\/list\ or\ meta-\/data}}
\DoxyCodeLine{00515\ \textcolor{preprocessor}{\#define\ EFAULT\ (14)}}
\DoxyCodeLine{00516\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00517\ \textcolor{preprocessor}{\#ifndef\ EINVAL\ \ \ \ \ \ \ \ \ }\textcolor{comment}{//\ trying\ to\ free\ an\ invalid\ pointer}}
\DoxyCodeLine{00518\ \textcolor{preprocessor}{\#define\ EINVAL\ (22)}}
\DoxyCodeLine{00519\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00520\ \textcolor{preprocessor}{\#ifndef\ EOVERFLOW\ \ \ \ \ \ }\textcolor{comment}{//\ count*size\ overflow}}
\DoxyCodeLine{00521\ \textcolor{preprocessor}{\#define\ EOVERFLOW\ (75)}}
\DoxyCodeLine{00522\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00523\ }
\DoxyCodeLine{00524\ }
\DoxyCodeLine{00525\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00526\ \textcolor{comment}{//\ Debug}}
\DoxyCodeLine{00527\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00528\ }
\DoxyCodeLine{00529\ \textcolor{preprocessor}{\#if\ !defined(MI\_DEBUG\_UNINIT)}}
\DoxyCodeLine{00530\ \textcolor{preprocessor}{\#define\ MI\_DEBUG\_UNINIT\ \ \ \ \ (0xD0)}}
\DoxyCodeLine{00531\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00532\ \textcolor{preprocessor}{\#if\ !defined(MI\_DEBUG\_FREED)}}
\DoxyCodeLine{00533\ \textcolor{preprocessor}{\#define\ MI\_DEBUG\_FREED\ \ \ \ \ \ (0xDF)}}
\DoxyCodeLine{00534\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00535\ \textcolor{preprocessor}{\#if\ !defined(MI\_DEBUG\_PADDING)}}
\DoxyCodeLine{00536\ \textcolor{preprocessor}{\#define\ MI\_DEBUG\_PADDING\ \ \ \ (0xDE)}}
\DoxyCodeLine{00537\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00538\ }
\DoxyCodeLine{00539\ \textcolor{preprocessor}{\#if\ (MI\_DEBUG)}}
\DoxyCodeLine{00540\ \textcolor{comment}{//\ use\ our\ own\ assertion\ to\ print\ without\ memory\ allocation}}
\DoxyCodeLine{00541\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_a4fb36f039870b2afad400eff3201e13b}{\_mi\_assert\_fail}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ assertion,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ fname,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ line,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ \mbox{\hyperlink{structfunc}{func}}\ );}
\DoxyCodeLine{00542\ \textcolor{preprocessor}{\#define\ mi\_assert(expr)\ \ \ \ \ ((expr)\ ?\ (void)0\ :\ \_mi\_assert\_fail(\#expr,\_\_FILE\_\_,\_\_LINE\_\_,\_\_func\_\_))}}
\DoxyCodeLine{00543\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00544\ \textcolor{preprocessor}{\#define\ mi\_assert(x)}}
\DoxyCodeLine{00545\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00546\ }
\DoxyCodeLine{00547\ \textcolor{preprocessor}{\#if\ (MI\_DEBUG>1)}}
\DoxyCodeLine{00548\ \textcolor{preprocessor}{\#define\ mi\_assert\_internal\ \ \ \ mi\_assert}}
\DoxyCodeLine{00549\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00550\ \textcolor{preprocessor}{\#define\ mi\_assert\_internal(x)}}
\DoxyCodeLine{00551\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00552\ }
\DoxyCodeLine{00553\ \textcolor{preprocessor}{\#if\ (MI\_DEBUG>2)}}
\DoxyCodeLine{00554\ \textcolor{preprocessor}{\#define\ mi\_assert\_expensive\ \ \ mi\_assert}}
\DoxyCodeLine{00555\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00556\ \textcolor{preprocessor}{\#define\ mi\_assert\_expensive(x)}}
\DoxyCodeLine{00557\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00558\ }
\DoxyCodeLine{00559\ }
\DoxyCodeLine{00560\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00561\ \textcolor{comment}{//\ Statistics}}
\DoxyCodeLine{00562\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00563\ \textcolor{preprocessor}{\#ifndef\ MI\_STAT}}
\DoxyCodeLine{00564\ \textcolor{preprocessor}{\#if\ (MI\_DEBUG>0)}}
\DoxyCodeLine{00565\ \textcolor{preprocessor}{\#define\ MI\_STAT\ 2}}
\DoxyCodeLine{00566\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00567\ \textcolor{preprocessor}{\#define\ MI\_STAT\ 0}}
\DoxyCodeLine{00568\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00569\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00570\ }
\DoxyCodeLine{00571\ }
\DoxyCodeLine{00572\ \textcolor{comment}{//\ add\ to\ stat\ keeping\ track\ of\ the\ peak}}
\DoxyCodeLine{00573\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_a78cab267c91f2ba1d3994dfee6821326}{\_\_mi\_stat\_increase}}(\mbox{\hyperlink{mimalloc-stats_8h_ae2a74ada89b66a45fafbe34d9c7a55ee}{mi\_stat\_count\_t}}*\ stat,\ \textcolor{keywordtype}{size\_t}\ amount);}
\DoxyCodeLine{00574\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_a55a388d4a2806c86539aaeeca75c78c3}{\_\_mi\_stat\_decrease}}(\mbox{\hyperlink{mimalloc-stats_8h_ae2a74ada89b66a45fafbe34d9c7a55ee}{mi\_stat\_count\_t}}*\ stat,\ \textcolor{keywordtype}{size\_t}\ amount);}
\DoxyCodeLine{00575\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_aef0883bafa972b5d7263cb3626fba5a5}{\_\_mi\_stat\_increase\_mt}}(\mbox{\hyperlink{mimalloc-stats_8h_ae2a74ada89b66a45fafbe34d9c7a55ee}{mi\_stat\_count\_t}}*\ stat,\ \textcolor{keywordtype}{size\_t}\ amount);}
\DoxyCodeLine{00576\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_a1eb4baa0a412eeec666e6c7f345af60c}{\_\_mi\_stat\_decrease\_mt}}(\mbox{\hyperlink{mimalloc-stats_8h_ae2a74ada89b66a45fafbe34d9c7a55ee}{mi\_stat\_count\_t}}*\ stat,\ \textcolor{keywordtype}{size\_t}\ amount);}
\DoxyCodeLine{00577\ }
\DoxyCodeLine{00578\ \textcolor{comment}{//\ adjust\ stat\ in\ special\ cases\ to\ compensate\ for\ double\ counting\ (and\ does\ not\ adjust\ peak\ values\ and\ can\ decrease\ the\ total)}}
\DoxyCodeLine{00579\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_ab8a5fcbc9d2e24f252027d1288a3b010}{\_\_mi\_stat\_adjust\_increase}}(\mbox{\hyperlink{mimalloc-stats_8h_ae2a74ada89b66a45fafbe34d9c7a55ee}{mi\_stat\_count\_t}}*\ stat,\ \textcolor{keywordtype}{size\_t}\ amount);}
\DoxyCodeLine{00580\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_a4e22fac15cdffa2e3ccfbdbde7e02846}{\_\_mi\_stat\_adjust\_decrease}}(\mbox{\hyperlink{mimalloc-stats_8h_ae2a74ada89b66a45fafbe34d9c7a55ee}{mi\_stat\_count\_t}}*\ stat,\ \textcolor{keywordtype}{size\_t}\ amount);}
\DoxyCodeLine{00581\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_a0d2c97aee5ebeee74a3930e9f5f6d199}{\_\_mi\_stat\_adjust\_increase\_mt}}(\mbox{\hyperlink{mimalloc-stats_8h_ae2a74ada89b66a45fafbe34d9c7a55ee}{mi\_stat\_count\_t}}*\ stat,\ \textcolor{keywordtype}{size\_t}\ amount);}
\DoxyCodeLine{00582\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_a2541e87891c28f62c67d1f076e48924c}{\_\_mi\_stat\_adjust\_decrease\_mt}}(\mbox{\hyperlink{mimalloc-stats_8h_ae2a74ada89b66a45fafbe34d9c7a55ee}{mi\_stat\_count\_t}}*\ stat,\ \textcolor{keywordtype}{size\_t}\ amount);}
\DoxyCodeLine{00583\ }
\DoxyCodeLine{00584\ \textcolor{comment}{//\ counters\ can\ just\ be\ increased}}
\DoxyCodeLine{00585\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_a0f867e3be3c96ad4b4ef34ff46b621dc}{\_\_mi\_stat\_counter\_increase}}(\mbox{\hyperlink{mimalloc-stats_8h_ab484eb2f2d08706c801718f31e749fcb}{mi\_stat\_counter\_t}}*\ stat,\ \textcolor{keywordtype}{size\_t}\ amount);}
\DoxyCodeLine{00586\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{runtime_2_e_a_s_t_l_2packages_2mimalloc_2include_2mimalloc_2types_8h_ae679ed153e6c382b7685c0fa81d6cffb}{\_\_mi\_stat\_counter\_increase\_mt}}(\mbox{\hyperlink{mimalloc-stats_8h_ab484eb2f2d08706c801718f31e749fcb}{mi\_stat\_counter\_t}}*\ stat,\ \textcolor{keywordtype}{size\_t}\ amount);}
\DoxyCodeLine{00587\ }
\DoxyCodeLine{00588\ \textcolor{preprocessor}{\#if\ (MI\_STAT)}}
\DoxyCodeLine{00589\ \textcolor{preprocessor}{\#define\ mi\_debug\_stat\_increase(stat,amount)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_mi\_stat\_increase(\ \&(stat),\ amount)}}
\DoxyCodeLine{00590\ \textcolor{preprocessor}{\#define\ mi\_debug\_stat\_decrease(stat,amount)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_mi\_stat\_decrease(\ \&(stat),\ amount)}}
\DoxyCodeLine{00591\ \textcolor{preprocessor}{\#define\ mi\_debug\_stat\_counter\_increase(stat,amount)\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_mi\_stat\_counter\_increase(\ \&(stat),\ amount)}}
\DoxyCodeLine{00592\ \textcolor{preprocessor}{\#define\ mi\_debug\_stat\_increase\_mt(stat,amount)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_mi\_stat\_increase\_mt(\ \&(stat),\ amount)}}
\DoxyCodeLine{00593\ \textcolor{preprocessor}{\#define\ mi\_debug\_stat\_decrease\_mt(stat,amount)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_mi\_stat\_decrease\_mt(\ \&(stat),\ amount)}}
\DoxyCodeLine{00594\ \textcolor{preprocessor}{\#define\ mi\_debug\_stat\_counter\_increase\_mt(stat,amount)\ \ \ \ \ \ \ \ \ \ \_\_mi\_stat\_counter\_increase\_mt(\ \&(stat),\ amount)}}
\DoxyCodeLine{00595\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00596\ \textcolor{preprocessor}{\#define\ mi\_debug\_stat\_increase(stat,amount)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ((void)0)}}
\DoxyCodeLine{00597\ \textcolor{preprocessor}{\#define\ mi\_debug\_stat\_decrease(stat,amount)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ((void)0)}}
\DoxyCodeLine{00598\ \textcolor{preprocessor}{\#define\ mi\_debug\_stat\_counter\_increase(stat,amount)\ \ \ \ \ \ \ \ \ \ \ \ \ ((void)0)}}
\DoxyCodeLine{00599\ \textcolor{preprocessor}{\#define\ mi\_debug\_stat\_increase\_mt(stat,amount)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ((void)0)}}
\DoxyCodeLine{00600\ \textcolor{preprocessor}{\#define\ mi\_debug\_stat\_decrease\_mt(stat,amount)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ((void)0)}}
\DoxyCodeLine{00601\ \textcolor{preprocessor}{\#define\ mi\_debug\_stat\_counter\_increase\_mt(stat,amount)\ \ \ \ \ \ \ \ \ \ ((void)0)}}
\DoxyCodeLine{00602\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00603\ }
\DoxyCodeLine{00604\ \textcolor{preprocessor}{\#define\ mi\_subproc\_stat\_counter\_increase(subproc,stat,amount)\ \ \ \_\_mi\_stat\_counter\_increase\_mt(\ \&(subproc)-\/>stats.stat,\ amount)}}
\DoxyCodeLine{00605\ \textcolor{preprocessor}{\#define\ mi\_subproc\_stat\_increase(subproc,stat,amount)\ \ \ \ \ \ \ \ \ \ \ \_\_mi\_stat\_increase\_mt(\ \&(subproc)-\/>stats.stat,\ amount)}}
\DoxyCodeLine{00606\ \textcolor{preprocessor}{\#define\ mi\_subproc\_stat\_decrease(subproc,stat,amount)\ \ \ \ \ \ \ \ \ \ \ \_\_mi\_stat\_decrease\_mt(\ \&(subproc)-\/>stats.stat,\ amount)}}
\DoxyCodeLine{00607\ \textcolor{preprocessor}{\#define\ mi\_subproc\_stat\_adjust\_increase(subproc,stat,amnt)\ \ \ \ \ \ \_\_mi\_stat\_adjust\_increase\_mt(\ \&(subproc)-\/>stats.stat,\ amnt)}}
\DoxyCodeLine{00608\ \textcolor{preprocessor}{\#define\ mi\_subproc\_stat\_adjust\_decrease(subproc,stat,amnt)\ \ \ \ \ \ \_\_mi\_stat\_adjust\_decrease\_mt(\ \&(subproc)-\/>stats.stat,\ amnt)}}
\DoxyCodeLine{00609\ }
\DoxyCodeLine{00610\ \textcolor{preprocessor}{\#define\ mi\_tld\_stat\_counter\_increase(tld,stat,amount)\ \ \ \ \ \ \ \ \ \ \ \_\_mi\_stat\_counter\_increase(\ \&(tld)-\/>stats.stat,\ amount)}}
\DoxyCodeLine{00611\ \textcolor{preprocessor}{\#define\ mi\_tld\_stat\_increase(tld,stat,amount)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_mi\_stat\_increase(\ \&(tld)-\/>stats.stat,\ amount)}}
\DoxyCodeLine{00612\ \textcolor{preprocessor}{\#define\ mi\_tld\_stat\_decrease(tld,stat,amount)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_mi\_stat\_decrease(\ \&(tld)-\/>stats.stat,\ amount)}}
\DoxyCodeLine{00613\ \textcolor{preprocessor}{\#define\ mi\_tld\_stat\_adjust\_increase(tld,stat,amnt)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_mi\_stat\_adjust\_increase(\ \&(tld)-\/>stats.stat,\ amnt)}}
\DoxyCodeLine{00614\ \textcolor{preprocessor}{\#define\ mi\_tld\_stat\_adjust\_decrease(tld,stat,amnt)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_mi\_stat\_adjust\_decrease(\ \&(tld)-\/>stats.stat,\ amnt)}}
\DoxyCodeLine{00615\ }
\DoxyCodeLine{00616\ \textcolor{preprocessor}{\#define\ mi\_os\_stat\_counter\_increase(stat,amount)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mi\_subproc\_stat\_counter\_increase(\_mi\_subproc(),stat,amount)}}
\DoxyCodeLine{00617\ \textcolor{preprocessor}{\#define\ mi\_os\_stat\_increase(stat,amount)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mi\_subproc\_stat\_increase(\_mi\_subproc(),stat,amount)}}
\DoxyCodeLine{00618\ \textcolor{preprocessor}{\#define\ mi\_os\_stat\_decrease(stat,amount)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mi\_subproc\_stat\_decrease(\_mi\_subproc(),stat,amount)}}
\DoxyCodeLine{00619\ }
\DoxyCodeLine{00620\ \textcolor{preprocessor}{\#define\ mi\_heap\_stat\_counter\_increase(heap,stat,amount)\ \ \ \ \ \ \ \ \ mi\_tld\_stat\_counter\_increase(heap-\/>tld,\ stat,\ amount)}}
\DoxyCodeLine{00621\ \textcolor{preprocessor}{\#define\ mi\_heap\_stat\_increase(heap,stat,amount)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mi\_tld\_stat\_increase(\ heap-\/>tld,\ stat,\ amount)}}
\DoxyCodeLine{00622\ \textcolor{preprocessor}{\#define\ mi\_heap\_stat\_decrease(heap,stat,amount)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mi\_tld\_stat\_decrease(\ heap-\/>tld,\ stat,\ amount)}}
\DoxyCodeLine{00623\ }
\DoxyCodeLine{00624\ \textcolor{preprocessor}{\#define\ mi\_debug\_heap\_stat\_counter\_increase(heap,stat,amount)\ \ \ mi\_debug\_stat\_counter\_increase(\ (heap)-\/>tld-\/>stats.stat,\ amount)}}
\DoxyCodeLine{00625\ \textcolor{preprocessor}{\#define\ mi\_debug\_heap\_stat\_increase(heap,stat,amount)\ \ \ \ \ \ \ \ \ \ \ mi\_debug\_stat\_increase(\ (heap)-\/>tld-\/>stats.stat,\ amount)}}
\DoxyCodeLine{00626\ \textcolor{preprocessor}{\#define\ mi\_debug\_heap\_stat\_decrease(heap,stat,amount)\ \ \ \ \ \ \ \ \ \ \ mi\_debug\_stat\_decrease(\ (heap)-\/>tld-\/>stats.stat,\ amount)}}
\DoxyCodeLine{00627\ }
\DoxyCodeLine{00628\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ MI\_TYPES\_H}}

\end{DoxyCode}
