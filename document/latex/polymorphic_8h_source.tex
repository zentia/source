\doxysection{polymorphic.\+h}
\hypertarget{polymorphic_8h_source}{}\label{polymorphic_8h_source}\index{runtime/dsl/polymorphic.h@{runtime/dsl/polymorphic.h}}
\mbox{\hyperlink{polymorphic_8h}{浏览该文件的文档.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00002\ }
\DoxyCodeLine{00003\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{core_2stl_2algorithm_8h}{runtime/core/stl/algorithm.h}}>}}
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{expr__traits_8h}{runtime/dsl/expr\_traits.h}}>}}
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{builtin_8h}{runtime/dsl/builtin.h}}>}}
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{stmt_8h}{runtime/dsl/stmt.h}}>}}
\DoxyCodeLine{00007\ }
\DoxyCodeLine{00008\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespaceluisa_1_1compute}{luisa::compute}}\ \{}
\DoxyCodeLine{00009\ }
\DoxyCodeLine{00010\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespaceluisa_1_1compute_1_1detail}{detail}}\ \{}
\DoxyCodeLine{00011\ \mbox{\hyperlink{dll__export_8h_a0f23f409f57fcf93535a1f02ca7586b9}{LC\_DSL\_API}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{namespaceluisa_1_1compute_1_1detail_a63609d30bd222c8c3db480d27f304662}{polymorphic\_warning\_no\_implementation\_registered}}()\ noexcept;}
\DoxyCodeLine{00012\ \mbox{\hyperlink{dll__export_8h_a0f23f409f57fcf93535a1f02ca7586b9}{LC\_DSL\_API}}\ \textcolor{keywordtype}{void}\ polymorphic\_warning\_empty\_tag\_range(\mbox{\hyperlink{sugar_8h_ad46b2ebcd4c426b06cda147ddc1001e7}{uint}}\ lo,\ \mbox{\hyperlink{sugar_8h_ad46b2ebcd4c426b06cda147ddc1001e7}{uint}}\ hi)\ noexcept;}
\DoxyCodeLine{00013\ \mbox{\hyperlink{dll__export_8h_a0f23f409f57fcf93535a1f02ca7586b9}{LC\_DSL\_API}}\ \textcolor{keywordtype}{void}\ polymorphic\_warning\_empty\_tag\_group()\ noexcept;}
\DoxyCodeLine{00014\ \mbox{\hyperlink{dll__export_8h_a0f23f409f57fcf93535a1f02ca7586b9}{LC\_DSL\_API}}\ \textcolor{keywordtype}{void}\ polymorphic\_error\_unordered\_tag\_range(\mbox{\hyperlink{sugar_8h_ad46b2ebcd4c426b06cda147ddc1001e7}{uint}}\ lo,\ \mbox{\hyperlink{sugar_8h_ad46b2ebcd4c426b06cda147ddc1001e7}{uint}}\ hi)\ noexcept;}
\DoxyCodeLine{00015\ \mbox{\hyperlink{dll__export_8h_a0f23f409f57fcf93535a1f02ca7586b9}{LC\_DSL\_API}}\ \textcolor{keywordtype}{void}\ polymorphic\_error\_overflowed\_tag\_range(\mbox{\hyperlink{sugar_8h_ad46b2ebcd4c426b06cda147ddc1001e7}{uint}}\ lo,\ \mbox{\hyperlink{sugar_8h_ad46b2ebcd4c426b06cda147ddc1001e7}{uint}}\ hi,\ \mbox{\hyperlink{sugar_8h_ad46b2ebcd4c426b06cda147ddc1001e7}{uint}}\ tag\_count)\ noexcept;}
\DoxyCodeLine{00016\ \}\textcolor{comment}{//\ namespace\ detail}}
\DoxyCodeLine{00017\ }
\DoxyCodeLine{00018\ template<typename\ T>}
\DoxyCodeLine{00019\ class\ \mbox{\hyperlink{classluisa_1_1compute_1_1_polymorphic}{Polymorphic}}\ \{}
\DoxyCodeLine{00020\ }
\DoxyCodeLine{00021\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00022\ \ \ \ \ luisa::vector<luisa::unique\_ptr<T>>\ \mbox{\hyperlink{classluisa_1_1compute_1_1_polymorphic_a20e14d66938cde80e4ad5111ac083bb1}{\_impl}};}
\DoxyCodeLine{00023\ }
\DoxyCodeLine{00024\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00025\ \ \ \ \ [[nodiscard]]\ \textcolor{keyword}{auto}\ \mbox{\hyperlink{classluisa_1_1compute_1_1_polymorphic_a00721a88c264e45be2485ac7182247fa}{empty}}()\ const\ noexcept\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classluisa_1_1compute_1_1_polymorphic_a20e14d66938cde80e4ad5111ac083bb1}{\_impl}}.empty();\ \}}
\DoxyCodeLine{00026\ \ \ \ \ [[nodiscard]]\ \textcolor{keyword}{auto}\ \mbox{\hyperlink{classluisa_1_1compute_1_1_polymorphic_aade20178a6e1dd406ef22f28c46f3129}{size}}()\ const\ noexcept\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classluisa_1_1compute_1_1_polymorphic_a20e14d66938cde80e4ad5111ac083bb1}{\_impl}}.size();\ \}}
\DoxyCodeLine{00027\ \ \ \ \ [[nodiscard]]\ \textcolor{keyword}{auto}\ \mbox{\hyperlink{classluisa_1_1compute_1_1_polymorphic_a153d7bae09b358a80dc5b8df180a1624}{impl}}(\textcolor{keywordtype}{size\_t}\ i)\ \textcolor{keyword}{noexcept}\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classluisa_1_1compute_1_1_polymorphic_a20e14d66938cde80e4ad5111ac083bb1}{\_impl}}.at(i).get();\ \}}
\DoxyCodeLine{00028\ \ \ \ \ [[nodiscard]]\ \textcolor{keyword}{auto}\ \mbox{\hyperlink{classluisa_1_1compute_1_1_polymorphic_a3124723bb2dc00c008dfefe3d1537824}{impl}}(\textcolor{keywordtype}{size\_t}\ i)\ \textcolor{keyword}{const}\ \textcolor{keyword}{noexcept}\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classluisa_1_1compute_1_1_polymorphic_a20e14d66938cde80e4ad5111ac083bb1}{\_impl}}.at(i).get();\ \}}
\DoxyCodeLine{00029\ }
\DoxyCodeLine{00030\ \ \ \ \ [[nodiscard]]\ \textcolor{keyword}{auto}\ \mbox{\hyperlink{classluisa_1_1compute_1_1_polymorphic_a6cdd32e62805f24acf9d11b9530591af}{emplace}}(luisa::unique\_ptr<T>\ \mbox{\hyperlink{classluisa_1_1compute_1_1_polymorphic_a153d7bae09b358a80dc5b8df180a1624}{impl}})\ \textcolor{keyword}{noexcept}\ \{}
\DoxyCodeLine{00031\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ tag\ =\ \textcolor{keyword}{static\_cast<}\mbox{\hyperlink{namespaceluisa_a70f466a8a407b18f0870c81f4bd3bf66}{uint}}\textcolor{keyword}{>}(\mbox{\hyperlink{classluisa_1_1compute_1_1_polymorphic_a20e14d66938cde80e4ad5111ac083bb1}{\_impl}}.size());}
\DoxyCodeLine{00032\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classluisa_1_1compute_1_1_polymorphic_a20e14d66938cde80e4ad5111ac083bb1}{\_impl}}.emplace\_back(std::move(\mbox{\hyperlink{classluisa_1_1compute_1_1_polymorphic_a153d7bae09b358a80dc5b8df180a1624}{impl}}));}
\DoxyCodeLine{00033\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ tag;}
\DoxyCodeLine{00034\ \ \ \ \ \}}
\DoxyCodeLine{00035\ }
\DoxyCodeLine{00036\ \ \ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ Impl,\ \textcolor{keyword}{typename}...\ Args>}
\DoxyCodeLine{00037\ \ \ \ \ \ \ \ \ \textcolor{keyword}{requires}\ std::derived\_from<Impl,\ T>}
\DoxyCodeLine{00038\ \ \ \ \ [[nodiscard]]\ \textcolor{keyword}{auto}\ \mbox{\hyperlink{classluisa_1_1compute_1_1_polymorphic_a42c1623867c5ce2f04083ef23967d72e}{create}}(Args\ \&\&...args)\ \textcolor{keyword}{noexcept}\ \{}
\DoxyCodeLine{00039\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classluisa_1_1compute_1_1_polymorphic_a6cdd32e62805f24acf9d11b9530591af}{emplace}}(luisa::make\_unique<Impl>(std::forward<Args>(args)...));}
\DoxyCodeLine{00040\ \ \ \ \ \}}
\DoxyCodeLine{00041\ }
\DoxyCodeLine{00042\ \ \ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ Tag>}
\DoxyCodeLine{00043\ \ \ \ \ \ \ \ \ \textcolor{keyword}{requires}\ \mbox{\hyperlink{namespaceluisa_1_1compute_a2e4127befb5af9644bdabcf03206d9a0}{is\_integral\_expr\_v<Tag>}}}
\DoxyCodeLine{00044\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classluisa_1_1compute_1_1_polymorphic_a745221e4784ca33cd575ee21fa84fd19}{dispatch\_with\_default}}(Tag\ \&\&tag,}
\DoxyCodeLine{00045\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ luisa::function<\textcolor{keywordtype}{void}(\textcolor{keyword}{const}\ T\ *)>\ \&f,}
\DoxyCodeLine{00046\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ luisa::function<\textcolor{keywordtype}{void}()>\ \&default\_case\ =\ ([]\ \{\}))\ \textcolor{keyword}{const}\ \textcolor{keyword}{noexcept}\ \{}
\DoxyCodeLine{00047\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (empty())\ [[unlikely]]\ \{}
\DoxyCodeLine{00048\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespaceluisa_1_1compute_1_1detail_a63609d30bd222c8c3db480d27f304662}{detail::polymorphic\_warning\_no\_implementation\_registered}}();}
\DoxyCodeLine{00049\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00050\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_impl.size()\ ==\ 1u\ \&\&\ !default\_case)\ \{}
\DoxyCodeLine{00051\ \ \ \ \ \ \ \ \ \ \ \ \ f(impl(0u));}
\DoxyCodeLine{00052\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00053\ \ \ \ \ \ \ \ \ \ \ \ \ detail::SwitchStmtBuilder\{std::forward<Tag>(tag)\}\ \%\ [\&]\ \{}
\DoxyCodeLine{00054\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ i\ =\ 0u;\ i\ <\ \_impl.size();\ i++)\ \{}
\DoxyCodeLine{00055\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ detail::SwitchCaseStmtBuilder\{i\}\ \%\ [\&f,\ \textcolor{keyword}{this},\ i]\ \{\ f(impl(i));\ \};}
\DoxyCodeLine{00056\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00057\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (default\_case)\ \{}
\DoxyCodeLine{00058\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ detail::SwitchDefaultStmtBuilder\{\}\ \%\ default\_case;}
\DoxyCodeLine{00059\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00060\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ detail::SwitchDefaultStmtBuilder\{\}\ \%}
\DoxyCodeLine{00061\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ []\ \{\ \mbox{\hyperlink{namespaceluisa_1_1compute_1_1dsl_aa965ae2c2532d6170044ea191eef3f5d}{unreachable}}();\ \};}
\DoxyCodeLine{00062\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00063\ \ \ \ \ \ \ \ \ \ \ \ \ \};}
\DoxyCodeLine{00064\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00065\ \ \ \ \ \}}
\DoxyCodeLine{00066\ }
\DoxyCodeLine{00067\ \ \ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ Tag>}
\DoxyCodeLine{00068\ \ \ \ \ \ \ \ \ \textcolor{keyword}{requires}\ is\_integral\_expr\_v<Tag>}
\DoxyCodeLine{00069\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classluisa_1_1compute_1_1_polymorphic_a2790a57dcb76a8d81ea5b9b79c4e54ec}{dispatch\_range\_with\_default}}(Tag\ \&\&tag,\ \mbox{\hyperlink{namespaceluisa_a70f466a8a407b18f0870c81f4bd3bf66}{uint}}\ lo,\ \mbox{\hyperlink{namespaceluisa_a70f466a8a407b18f0870c81f4bd3bf66}{uint}}\ hi,}
\DoxyCodeLine{00070\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ luisa::function<\textcolor{keywordtype}{void}(\textcolor{keyword}{const}\ T\ *)>\ \&f,}
\DoxyCodeLine{00071\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ luisa::function<\textcolor{keywordtype}{void}()>\ \&default\_case\ =\ ([]\ \{\}))\ \textcolor{keyword}{const}\ \textcolor{keyword}{noexcept}\ \{}
\DoxyCodeLine{00072\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (lo\ >\ hi)\ \{\ \mbox{\hyperlink{namespaceluisa_1_1compute_1_1detail_a639c60d71d184d34470e19e030536c05}{detail::polymorphic\_error\_unordered\_tag\_range}}(lo,\ hi);\ \}}
\DoxyCodeLine{00073\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (hi\ >\ \_impl.size())\ [[unlikely]]\ \{}
\DoxyCodeLine{00074\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{logging_8h_ac52e85580c07cf5fa43d322299d154df}{LUISA\_WARNING\_WITH\_LOCATION}}(}
\DoxyCodeLine{00075\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Out-\/of-\/bound\ polymorphic\ tag\ range\ [\{\},\ \{\}).\ "{}}}
\DoxyCodeLine{00076\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Registered\ tag\ count:\ \{\}."{}},}
\DoxyCodeLine{00077\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lo,\ hi,\ \_impl.size());}
\DoxyCodeLine{00078\ \ \ \ \ \ \ \ \ \ \ \ \ hi\ =\ \_impl.size();}
\DoxyCodeLine{00079\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00080\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (hi\ ==\ lo)\ [[unlikely]]\ \{}
\DoxyCodeLine{00081\ \ \ \ \ \ \ \ \ \ \ \ \ detail::polymorphic\_warning\_empty\_tag\_range(lo,\ hi);}
\DoxyCodeLine{00082\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00083\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (hi\ ==\ lo\ +\ 1u\ \&\&\ !default\_case)\ \{\textcolor{comment}{//\ only\ one\ implementation}}
\DoxyCodeLine{00084\ \ \ \ \ \ \ \ \ \ \ \ \ f(impl(lo));}
\DoxyCodeLine{00085\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00086\ \ \ \ \ \ \ \ \ \ \ \ \ detail::SwitchStmtBuilder\{std::forward<Tag>(tag)\}\ \%\ [\&]\ \{}
\DoxyCodeLine{00087\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ i\ =\ lo;\ i\ <\ hi;\ i++)\ \{}
\DoxyCodeLine{00088\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ detail::SwitchCaseStmtBuilder\{i\}\ \%\ [\&f,\ \textcolor{keyword}{this},\ i]\ \{\ f(impl(i));\ \};}
\DoxyCodeLine{00089\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00090\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (default\_case)\ \{}
\DoxyCodeLine{00091\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ detail::SwitchDefaultStmtBuilder\{\}\ \%\ default\_case;}
\DoxyCodeLine{00092\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00093\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ detail::SwitchDefaultStmtBuilder\{\}\ \%}
\DoxyCodeLine{00094\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ []\ \{\ \mbox{\hyperlink{namespaceluisa_1_1compute_1_1dsl_aa965ae2c2532d6170044ea191eef3f5d}{unreachable}}();\ \};}
\DoxyCodeLine{00095\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00096\ \ \ \ \ \ \ \ \ \ \ \ \ \};}
\DoxyCodeLine{00097\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00098\ \ \ \ \ \}}
\DoxyCodeLine{00099\ }
\DoxyCodeLine{00100\ \ \ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ Tag,\ \textcolor{keyword}{typename}\ Group>}
\DoxyCodeLine{00101\ \ \ \ \ \ \ \ \ \textcolor{keyword}{requires}\ is\_integral\_expr\_v<Tag>}
\DoxyCodeLine{00102\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classluisa_1_1compute_1_1_polymorphic_a6d8c6ae13bba661224f2f456c6feea20}{dispatch\_group\_with\_default}}(Tag\ \&\&tag,\ \textcolor{keyword}{const}\ Group\ \&group,}
\DoxyCodeLine{00103\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ luisa::function<\textcolor{keywordtype}{void}(\textcolor{keyword}{const}\ T\ *)>\ \&f,}
\DoxyCodeLine{00104\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ luisa::function<\textcolor{keywordtype}{void}()>\ \&default\_case\ =\ ([]\ \{\}))\ \textcolor{keyword}{const}\ \textcolor{keyword}{noexcept}\ \{}
\DoxyCodeLine{00105\ \ \ \ \ \ \ \ \ luisa::vector<uint>\ tags;}
\DoxyCodeLine{00106\ \ \ \ \ \ \ \ \ tags.reserve(std::size(group));}
\DoxyCodeLine{00107\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ \&\&t\ :\ group)\ \{}
\DoxyCodeLine{00108\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (t\ <\ \_impl.size())\ \{}
\DoxyCodeLine{00109\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tags.emplace\_back(t);}
\DoxyCodeLine{00110\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00111\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{logging_8h_ac52e85580c07cf5fa43d322299d154df}{LUISA\_WARNING\_WITH\_LOCATION}}(}
\DoxyCodeLine{00112\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Out-\/of-\/bound\ polymorphic\ tag\ \{\}.\ "{}}}
\DoxyCodeLine{00113\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Registered\ tag\ count:\ \{\}."{}},}
\DoxyCodeLine{00114\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ t,\ \_impl.size());}
\DoxyCodeLine{00115\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00116\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00117\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespaceluisa_a08fa599f3509804d7ec363f0901af3fa}{luisa::sort}}(tags.begin(),\ tags.end());}
\DoxyCodeLine{00118\ \ \ \ \ \ \ \ \ tags.erase(std::unique(tags.begin(),\ tags.end()),\ tags.end());}
\DoxyCodeLine{00119\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (tags.empty())\ [[unlikely]]\ \{}
\DoxyCodeLine{00120\ \ \ \ \ \ \ \ \ \ \ \ \ detail::polymorphic\_warning\_empty\_tag\_group();}
\DoxyCodeLine{00121\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00122\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{logging_8h_ae59e4db6330864927cedf8726bd36f0c}{LUISA\_ASSERT}}(group.size()\ >\ 0,\ \textcolor{stringliteral}{"{}Empty\ polymorphic\ tag\ group."{}});}
\DoxyCodeLine{00123\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (tags.size()\ ==\ 1u\ \&\&\ !default\_case)\ \{}
\DoxyCodeLine{00124\ \ \ \ \ \ \ \ \ \ \ \ \ f(impl(tags.front()));}
\DoxyCodeLine{00125\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00126\ \ \ \ \ \ \ \ \ \ \ \ \ detail::SwitchStmtBuilder\{std::forward<Tag>(tag)\}\ \%\ [\&]\ \{}
\DoxyCodeLine{00127\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ \mbox{\hyperlink{boing_8c_a87accd1af8e0aff4b818d891374f7cec}{t}}\ :\ tags)\ \{}
\DoxyCodeLine{00128\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ detail::SwitchCaseStmtBuilder\{\mbox{\hyperlink{boing_8c_a87accd1af8e0aff4b818d891374f7cec}{t}}\}\ \%\ [\&f,\ \textcolor{keyword}{this},\ \mbox{\hyperlink{boing_8c_a87accd1af8e0aff4b818d891374f7cec}{t}}]\ \{\ f(impl(\mbox{\hyperlink{boing_8c_a87accd1af8e0aff4b818d891374f7cec}{t}}));\ \};}
\DoxyCodeLine{00129\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00130\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (default\_case)\ \{}
\DoxyCodeLine{00131\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ detail::SwitchDefaultStmtBuilder\{\}\ \%\ default\_case;}
\DoxyCodeLine{00132\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00133\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ detail::SwitchDefaultStmtBuilder\{\}\ \%}
\DoxyCodeLine{00134\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ []\ \{\ \mbox{\hyperlink{namespaceluisa_1_1compute_1_1dsl_aa965ae2c2532d6170044ea191eef3f5d}{unreachable}}();\ \};}
\DoxyCodeLine{00135\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00136\ \ \ \ \ \ \ \ \ \ \ \ \ \};}
\DoxyCodeLine{00137\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00138\ \ \ \ \ \}}
\DoxyCodeLine{00139\ }
\DoxyCodeLine{00140\ \ \ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ Tag>}
\DoxyCodeLine{00141\ \ \ \ \ \ \ \ \ \textcolor{keyword}{requires}\ is\_integral\_expr\_v<Tag>}
\DoxyCodeLine{00142\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classluisa_1_1compute_1_1_polymorphic_a9ef2affd830245601f21877cf6a2b7fe}{dispatch}}(Tag\ \&\&tag,\ \textcolor{keyword}{const}\ luisa::function<\textcolor{keywordtype}{void}(\textcolor{keyword}{const}\ T\ *)>\ \&f)\ \textcolor{keyword}{const}\ \textcolor{keyword}{noexcept}\ \{}
\DoxyCodeLine{00143\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classluisa_1_1compute_1_1_polymorphic_a745221e4784ca33cd575ee21fa84fd19}{dispatch\_with\_default}}(std::forward<Tag>(tag),\ f,\ \{\});}
\DoxyCodeLine{00144\ \ \ \ \ \}}
\DoxyCodeLine{00145\ }
\DoxyCodeLine{00146\ \ \ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ Tag>}
\DoxyCodeLine{00147\ \ \ \ \ \ \ \ \ \textcolor{keyword}{requires}\ \mbox{\hyperlink{namespaceluisa_1_1compute_a2e4127befb5af9644bdabcf03206d9a0}{is\_integral\_expr\_v<Tag>}}}
\DoxyCodeLine{00148\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classluisa_1_1compute_1_1_polymorphic_aa5f8e16f349750e04b47250d51de1efe}{dispatch\_range}}(Tag\ \&\&tag,\ \mbox{\hyperlink{namespaceluisa_a70f466a8a407b18f0870c81f4bd3bf66}{uint}}\ lo,\ \mbox{\hyperlink{namespaceluisa_a70f466a8a407b18f0870c81f4bd3bf66}{uint}}\ hi,}
\DoxyCodeLine{00149\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ luisa::function<\textcolor{keywordtype}{void}(\textcolor{keyword}{const}\ T\ *)>\ \&f)\ \textcolor{keyword}{const}\ \textcolor{keyword}{noexcept}\ \{}
\DoxyCodeLine{00150\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classluisa_1_1compute_1_1_polymorphic_a2790a57dcb76a8d81ea5b9b79c4e54ec}{dispatch\_range\_with\_default}}(std::forward<Tag>(tag),\ lo,\ hi,\ f,\ \{\});}
\DoxyCodeLine{00151\ \ \ \ \ \}}
\DoxyCodeLine{00152\ }
\DoxyCodeLine{00153\ \ \ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ Tag,\ \textcolor{keyword}{typename}\ Group>}
\DoxyCodeLine{00154\ \ \ \ \ \ \ \ \ \textcolor{keyword}{requires}\ \mbox{\hyperlink{namespaceluisa_1_1compute_a2e4127befb5af9644bdabcf03206d9a0}{is\_integral\_expr\_v<Tag>}}}
\DoxyCodeLine{00155\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classluisa_1_1compute_1_1_polymorphic_acbe0fa1d270fcc74f857567ba791eb1b}{dispatch\_group}}(Tag\ \&\&tag,\ \textcolor{keyword}{const}\ Group\ \&group,}
\DoxyCodeLine{00156\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ luisa::function<\textcolor{keywordtype}{void}(\textcolor{keyword}{const}\ T\ *)>\ \&f)\ \textcolor{keyword}{const}\ \textcolor{keyword}{noexcept}\ \{}
\DoxyCodeLine{00157\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classluisa_1_1compute_1_1_polymorphic_a6d8c6ae13bba661224f2f456c6feea20}{dispatch\_group\_with\_default}}(std::forward<Tag>(tag),\ group,\ f,\ \{\});}
\DoxyCodeLine{00158\ \ \ \ \ \}}
\DoxyCodeLine{00159\ \};}
\DoxyCodeLine{00160\ }
\DoxyCodeLine{00161\ \}\textcolor{comment}{//\ namespace\ luisa::compute}}

\end{DoxyCode}
