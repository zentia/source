\doxysection{Parallel Scan}
\hypertarget{_parallel_scan}{}\label{_parallel_scan}\index{Parallel Scan@{Parallel Scan}}
Taskflow provide template methods that construct tasks to perform parallel scan over a range of items.\hypertarget{_parallel_scan_ParallelScanInclude}{}\doxysubsection{\texorpdfstring{Include the Header}{Include the Header}}\label{_parallel_scan_ParallelScanInclude}
You need to include the header file, {\ttfamily \doxylink{taskflow_2algorithm_2scan_8hpp}{taskflow/algorithm/scan.\+hpp}}, for creating a parallel-\/scan task.


\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{taskflow_2algorithm_2scan_8hpp}{taskflow/algorithm/scan.hpp}}>}}

\end{DoxyCode}
\hypertarget{_parallel_scan_WhatIsAScanOperation}{}\doxysubsection{\texorpdfstring{What is a Scan Operation?}{What is a Scan Operation?}}\label{_parallel_scan_WhatIsAScanOperation}
\doxylink{bench__gemm_8cpp_addc86e8508f14411ec98f521c520f875}{A} parallel scan task performs the cumulative sum, also known as {\itshape prefix sum} or {\itshape scan}, of the input range and writes the result to the output range. Each element of the output range contains the running total of all earlier elements using the given binary operator for summation.

\hypertarget{_parallel_scan_CreateAParallelInclusiveScanTask}{}\doxysubsection{\texorpdfstring{Create a Parallel Inclusive Scan Task}{Create a Parallel Inclusive Scan Task}}\label{_parallel_scan_CreateAParallelInclusiveScanTask}
\doxylink{classtf_1_1_flow_builder_a1c2ace9290d83c2a006614a4d66ad588}{tf\+::\+Taskflow\+::inclusive\+\_\+scan(\+B first, E last, D d\+\_\+first, BOP bop)} generates an {\itshape inclusive} scan, meaning that the N-\/th element of the output range is the sum of the first N input elements, so the N-\/th input element is included. For example, the code below performs an inclusive scan over five elements\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{std::vector<int>\ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_ab7e6955a695fad0be513586926040b1a}{input}}\ =\ \{1,\ 2,\ 3,\ 4,\ 5\};}
\DoxyCodeLine{std::vector<int>\ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}}(\mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_ab7e6955a695fad0be513586926040b1a}{input}}.size())}
\DoxyCodeLine{\mbox{\hyperlink{poisson_8hpp_aa56fe360bb0ae38e0082f49e394ff825}{taskflow}}.\mbox{\hyperlink{benchmarks_2scan_2tbb_8cpp_a9df94e2a15e55692c7dfbacdc9b838fd}{inclusive\_scan}}(}
\DoxyCodeLine{\ \ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_ab7e6955a695fad0be513586926040b1a}{input}}.\mbox{\hyperlink{ittnotify__static_8h_a50deeaccd8b2b4be185e1befc7860258}{begin}}(),\ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_ab7e6955a695fad0be513586926040b1a}{input}}.\mbox{\hyperlink{ittnotify__static_8h_a30bf4ccd4623b7a8276bbc7f99e491c7}{end}}(),\ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}}.\mbox{\hyperlink{ittnotify__static_8h_a50deeaccd8b2b4be185e1befc7860258}{begin}}(),\ \mbox{\hyperlink{namespacestd}{std}}::\mbox{\hyperlink{runtime_2spdlog_2include_2spdlog_2fmt_2bundled_2base_8h_a8c33592060c5e5568b3fa116c71610baad7d18cfb3a0d8293e2f5d94ea30e04d2}{plus}}<\textcolor{keywordtype}{int}>\{\}}
\DoxyCodeLine{);}
\DoxyCodeLine{\mbox{\hyperlink{thread__pool_8cpp_a543e564a8407bbeac15cb2d929fec755}{executor}}.\mbox{\hyperlink{classtf_1_1_executor_a519777f5783981d534e9e53b99712069}{run}}(\mbox{\hyperlink{poisson_8hpp_aa56fe360bb0ae38e0082f49e394ff825}{taskflow}}).wait();}
\DoxyCodeLine{\textcolor{comment}{//\ output\ is\ \{1,\ 3,\ 6,\ 10,\ 15\}}}

\end{DoxyCode}


The output range may be the same as the input range, in which the scan operation is {\itshape in-\/place} with results written to the input range. For example, the code below performs an in-\/place inclusive scan over five elements\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{std::vector<int>\ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_ab7e6955a695fad0be513586926040b1a}{input}}\ =\ \{1,\ 2,\ 3,\ 4,\ 5\};}
\DoxyCodeLine{\mbox{\hyperlink{poisson_8hpp_aa56fe360bb0ae38e0082f49e394ff825}{taskflow}}.inclusive\_scan(}
\DoxyCodeLine{\ \ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_ab7e6955a695fad0be513586926040b1a}{input}}.begin(),\ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_ab7e6955a695fad0be513586926040b1a}{input}}.end(),\ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_ab7e6955a695fad0be513586926040b1a}{input}}.begin(),\ std::plus<int>\{\}}
\DoxyCodeLine{);}
\DoxyCodeLine{\mbox{\hyperlink{thread__pool_8cpp_a543e564a8407bbeac15cb2d929fec755}{executor}}.run(\mbox{\hyperlink{poisson_8hpp_aa56fe360bb0ae38e0082f49e394ff825}{taskflow}}).wait();}
\DoxyCodeLine{\textcolor{comment}{//\ input\ is\ \{1,\ 3,\ 6,\ 10,\ 15\}}}

\end{DoxyCode}


Similar to \doxylink{classtf_1_1_flow_builder_a1c2ace9290d83c2a006614a4d66ad588}{tf\+::\+Taskflow\+::inclusive\+\_\+scan(\+B first, E last, D d\+\_\+first, BOP bop)}, \doxylink{classtf_1_1_flow_builder_a0b589a5bbf9b18e6484fa9e554d39a39}{tf\+::\+Taskflow\+::inclusive\+\_\+scan(\+B first, E last, D d\+\_\+first, BOP bop, T init)} performs an inclusive scan but with an additional initial value {\ttfamily init}. For example, the code below performs an inclusive scan over five elements plus an initial value\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{std::vector<int>\ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_ab7e6955a695fad0be513586926040b1a}{input}}\ =\ \{1,\ 2,\ 3,\ 4,\ 5\};}
\DoxyCodeLine{std::vector<int>\ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}}(\mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_ab7e6955a695fad0be513586926040b1a}{input}}.size());}
\DoxyCodeLine{\textcolor{comment}{//\ performs\ inclusive\ scan\ with\ an\ initial\ value}}
\DoxyCodeLine{\mbox{\hyperlink{poisson_8hpp_aa56fe360bb0ae38e0082f49e394ff825}{taskflow}}.inclusive\_scan(}
\DoxyCodeLine{\ \ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_ab7e6955a695fad0be513586926040b1a}{input}}.begin(),\ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_ab7e6955a695fad0be513586926040b1a}{input}}.end(),\ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}}.begin(),\ std::plus<int>\{\},\ -\/1}
\DoxyCodeLine{);}
\DoxyCodeLine{\mbox{\hyperlink{thread__pool_8cpp_a543e564a8407bbeac15cb2d929fec755}{executor}}.run(\mbox{\hyperlink{poisson_8hpp_aa56fe360bb0ae38e0082f49e394ff825}{taskflow}}).wait();}
\DoxyCodeLine{\textcolor{comment}{//\ output\ is\ \{0,\ 2,\ 5,\ 9,\ 14\}}}

\end{DoxyCode}
\hypertarget{_parallel_scan_CreateAParallelTransformInclusiveScanTask}{}\doxysubsection{\texorpdfstring{Create a Parallel Transform-\/\+Inclusive Scan Task}{Create a Parallel Transform-\/\+Inclusive Scan Task}}\label{_parallel_scan_CreateAParallelTransformInclusiveScanTask}
You can transform elements in the input range before running inclusive scan using \doxylink{classtf_1_1_flow_builder_a82f3c3f49a2d52cd52f6eac07a659e9c}{tf\+::\+Taskflow\+::transform\+\_\+inclusive\+\_\+scan(\+B first, E last, D d\+\_\+first, BOP bop, UOP uop)} and \doxylink{classtf_1_1_flow_builder_a49f7e17d02c708035b9134d8c6c89f90}{tf\+::\+Taskflow\+::transform\+\_\+inclusive\+\_\+scan(\+B first, E last, D d\+\_\+first, BOP bop, UOP uop, T init)}. For example, the code below performs an inclusive scan over five transformed elements\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{std::vector<int>\ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_ab7e6955a695fad0be513586926040b1a}{input}}\ =\ \{1,\ 2,\ 3,\ 4,\ 5\};}
\DoxyCodeLine{std::vector<int>\ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}}(\mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_ab7e6955a695fad0be513586926040b1a}{input}}.size());}
\DoxyCodeLine{\mbox{\hyperlink{poisson_8hpp_aa56fe360bb0ae38e0082f49e394ff825}{taskflow}}.transform\_inclusive\_scan(}
\DoxyCodeLine{\ \ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_ab7e6955a695fad0be513586926040b1a}{input}}.begin(),\ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_ab7e6955a695fad0be513586926040b1a}{input}}.end(),\ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}}.begin(),\ std::plus<int>\{\},\ }
\DoxyCodeLine{\ \ []\ (\textcolor{keywordtype}{int}\ item)\ \{\ return\ -\/item;\ \}}
\DoxyCodeLine{);}
\DoxyCodeLine{\mbox{\hyperlink{thread__pool_8cpp_a543e564a8407bbeac15cb2d929fec755}{executor}}.run(\mbox{\hyperlink{poisson_8hpp_aa56fe360bb0ae38e0082f49e394ff825}{taskflow}}).wait();}
\DoxyCodeLine{\textcolor{comment}{//\ output\ is\ \{-\/1,\ -\/3,\ -\/6,\ -\/10,\ -\/15\}}}

\end{DoxyCode}


You can also associate the transform-\/inclusive scan with an initial value using \doxylink{classtf_1_1_flow_builder_a49f7e17d02c708035b9134d8c6c89f90}{tf\+::\+Taskflow\+::transform\+\_\+inclusive\+\_\+scan(\+B first, E last, D d\+\_\+first, BOP bop, UOP uop, T init)}. Only elements in the input range will be transformed using {\ttfamily uop}, i.\+e., the initial value {\ttfamily init} does not participate in {\ttfamily uop}.


\begin{DoxyCode}{0}
\DoxyCodeLine{std::vector<int>\ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_ab7e6955a695fad0be513586926040b1a}{input}}\ =\ \{1,\ 2,\ 3,\ 4,\ 5\};}
\DoxyCodeLine{std::vector<int>\ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}}(\mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_ab7e6955a695fad0be513586926040b1a}{input}}.size());}
\DoxyCodeLine{\mbox{\hyperlink{poisson_8hpp_aa56fe360bb0ae38e0082f49e394ff825}{taskflow}}.transform\_inclusive\_scan(}
\DoxyCodeLine{\ \ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_ab7e6955a695fad0be513586926040b1a}{input}}.begin(),\ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_ab7e6955a695fad0be513586926040b1a}{input}}.end(),\ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}}.begin(),\ std::plus<int>\{\},\ }
\DoxyCodeLine{\ \ []\ (\textcolor{keywordtype}{int}\ item)\ \{\ return\ -\/item;\ \},}
\DoxyCodeLine{\ \ -\/1}
\DoxyCodeLine{);}
\DoxyCodeLine{\mbox{\hyperlink{thread__pool_8cpp_a543e564a8407bbeac15cb2d929fec755}{executor}}.run(\mbox{\hyperlink{poisson_8hpp_aa56fe360bb0ae38e0082f49e394ff825}{taskflow}}).wait();}
\DoxyCodeLine{\textcolor{comment}{//\ output\ is\ \{-\/2,\ -\/4,\ -\/7,\ -\/11,\ -\/16\}}}

\end{DoxyCode}
\hypertarget{_parallel_scan_CreateAParallelExclusiveScanTask}{}\doxysubsection{\texorpdfstring{Create a Parallel Exclusive Scan Task}{Create a Parallel Exclusive Scan Task}}\label{_parallel_scan_CreateAParallelExclusiveScanTask}
\doxylink{classtf_1_1_flow_builder_a4e0d618d8eb0b3b2e5e00443a10bf512}{tf\+::\+Taskflow\+::exclusive\+\_\+scan(\+B first, E last, D d\+\_\+first, T init, BOP bop)} generates an {\itshape exclusive} scan with the given initial value. The N-\/th element of the output range is the sum of the first N-\/1 input elements, so the N-\/th input element is included. For example, the code below performs an exclusive scan over five elements with an initial value -\/1\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{std::vector<int>\ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_ab7e6955a695fad0be513586926040b1a}{input}}\ =\ \{1,\ 2,\ 3,\ 4,\ 5\};}
\DoxyCodeLine{std::vector<int>\ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}}(\mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_ab7e6955a695fad0be513586926040b1a}{input}}.size())}
\DoxyCodeLine{\mbox{\hyperlink{poisson_8hpp_aa56fe360bb0ae38e0082f49e394ff825}{taskflow}}.\mbox{\hyperlink{benchmarks_2scan_2tbb_8cpp_a54b86a30e8eb88ad96d3cff44cb960c0}{exclusive\_scan}}(}
\DoxyCodeLine{\ \ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_ab7e6955a695fad0be513586926040b1a}{input}}.\mbox{\hyperlink{ittnotify__static_8h_a50deeaccd8b2b4be185e1befc7860258}{begin}}(),\ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_ab7e6955a695fad0be513586926040b1a}{input}}.\mbox{\hyperlink{ittnotify__static_8h_a30bf4ccd4623b7a8276bbc7f99e491c7}{end}}(),\ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}}.\mbox{\hyperlink{ittnotify__static_8h_a50deeaccd8b2b4be185e1befc7860258}{begin}}(),\ -\/1,\ \mbox{\hyperlink{namespacestd}{std}}::\mbox{\hyperlink{runtime_2spdlog_2include_2spdlog_2fmt_2bundled_2base_8h_a8c33592060c5e5568b3fa116c71610baad7d18cfb3a0d8293e2f5d94ea30e04d2}{plus}}<\textcolor{keywordtype}{int}>\{\}}
\DoxyCodeLine{);}
\DoxyCodeLine{\mbox{\hyperlink{thread__pool_8cpp_a543e564a8407bbeac15cb2d929fec755}{executor}}.\mbox{\hyperlink{classtf_1_1_executor_a519777f5783981d534e9e53b99712069}{run}}(\mbox{\hyperlink{poisson_8hpp_aa56fe360bb0ae38e0082f49e394ff825}{taskflow}}).wait();}
\DoxyCodeLine{\textcolor{comment}{//\ output\ is\ \{-\/1,\ 0,\ 2,\ 5,\ 9\}}}

\end{DoxyCode}


The output range may be the same as the input range, in which the scan operation is {\itshape in-\/place} with results written to the input range. For example, the code below performs an in-\/place exclusive scan over five elements with an initial -\/1\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{std::vector<int>\ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_ab7e6955a695fad0be513586926040b1a}{input}}\ =\ \{1,\ 2,\ 3,\ 4,\ 5\};}
\DoxyCodeLine{std::vector<int>\ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}}(\mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_ab7e6955a695fad0be513586926040b1a}{input}}.size());}
\DoxyCodeLine{\mbox{\hyperlink{poisson_8hpp_aa56fe360bb0ae38e0082f49e394ff825}{taskflow}}.exclusive\_scan(}
\DoxyCodeLine{\ \ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_ab7e6955a695fad0be513586926040b1a}{input}}.begin(),\ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_ab7e6955a695fad0be513586926040b1a}{input}}.end(),\ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}}.begin(),\ -\/1,\ std::plus<int>\{\}}
\DoxyCodeLine{);}
\DoxyCodeLine{\mbox{\hyperlink{thread__pool_8cpp_a543e564a8407bbeac15cb2d929fec755}{executor}}.run(\mbox{\hyperlink{poisson_8hpp_aa56fe360bb0ae38e0082f49e394ff825}{taskflow}}).wait();}
\DoxyCodeLine{\textcolor{comment}{//\ output\ is\ \{-\/1,\ 0,\ 2,\ 5,\ 9\}}}

\end{DoxyCode}
\hypertarget{_parallel_scan_CreateAParallelTransformExclusiveScanTask}{}\doxysubsection{\texorpdfstring{Create a Parallel Transform-\/\+Exclusive Scan Task}{Create a Parallel Transform-\/\+Exclusive Scan Task}}\label{_parallel_scan_CreateAParallelTransformExclusiveScanTask}
You can transform elements in the input range before running exclusive scan using \doxylink{classtf_1_1_flow_builder_a8549478ef819699b30f8daf88f04d577}{tf\+::\+Taskflow\+::transform\+\_\+exclusive\+\_\+scan(\+B first, E last, D d\+\_\+first, T init, BOP bop, UOP uop)}. For example, the code below performs an exclusive scan over five transformed elements\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{std::vector<int>\ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_ab7e6955a695fad0be513586926040b1a}{input}}\ =\ \{1,\ 2,\ 3,\ 4,\ 5\};}
\DoxyCodeLine{std::vector<int>\ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_a8390452002ecc7a0dadc5ae0dccc9b6c}{output}}(\mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_ab7e6955a695fad0be513586926040b1a}{input}}.size());}
\DoxyCodeLine{\mbox{\hyperlink{poisson_8hpp_aa56fe360bb0ae38e0082f49e394ff825}{taskflow}}.transform\_exclusive\_scan(}
\DoxyCodeLine{\ \ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_ab7e6955a695fad0be513586926040b1a}{input}}.begin(),\ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_ab7e6955a695fad0be513586926040b1a}{input}}.end(),\ \mbox{\hyperlink{benchmarks_2scan_2scan_8hpp_ab7e6955a695fad0be513586926040b1a}{input}}.begin(),\ -\/1,\ std::plus<int>\{\},}
\DoxyCodeLine{\ \ [](\textcolor{keywordtype}{int}\ item)\ \{\ return\ -\/item;\ \}}
\DoxyCodeLine{);}
\DoxyCodeLine{\mbox{\hyperlink{thread__pool_8cpp_a543e564a8407bbeac15cb2d929fec755}{executor}}.run(\mbox{\hyperlink{poisson_8hpp_aa56fe360bb0ae38e0082f49e394ff825}{taskflow}}).wait();}
\DoxyCodeLine{\textcolor{comment}{//\ output\ is\ \{-\/1,\ -\/2,\ -\/4,\ -\/7,\ -\/11\}}}

\end{DoxyCode}
 